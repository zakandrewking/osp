!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){n(1),e.exports=n(191)},function(e,t,n){(function(e){"use strict";if(n(2),n(189),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0}).call(t,function(){return this}())},function(e,t,n){n(3),n(36),n(42),n(44),n(46),n(48),n(50),n(52),n(53),n(54),n(55),n(56),n(57),n(58),n(59),n(60),n(61),n(62),n(63),n(66),n(67),n(68),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(78),n(79),n(80),n(82),n(83),n(84),n(86),n(87),n(88),n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(104),n(105),n(109),n(110),n(112),n(113),n(118),n(119),n(122),n(124),n(126),n(128),n(129),n(130),n(132),n(133),n(135),n(136),n(137),n(138),n(145),n(148),n(149),n(151),n(152),n(153),n(154),n(155),n(156),n(157),n(158),n(159),n(160),n(161),n(162),n(164),n(165),n(166),n(167),n(168),n(169),n(171),n(172),n(173),n(174),n(176),n(177),n(179),n(180),n(182),n(183),n(184),n(187),n(188),e.exports=n(7)},function(e,t,n){"use strict";var i,r=n(4),o=n(5),a=n(10),s=n(9),l=n(16),u=n(17),c=n(19),h=n(20),d=n(21),f=n(11),p=n(22),_=n(15),g=n(18),m=n(23),v=n(25),y=n(27),b=n(28),x=n(29),w=n(26),S=n(13)("__proto__"),A=n(30),k=n(35)(!1),C=Object.prototype,T=Array.prototype,E=T.slice,M=T.join,L=r.setDesc,R=r.getDesc,O=r.setDescs,P={};a||(i=!f(function(){return 7!=L(u("div"),"a",{get:function(){return 7}}).a}),r.setDesc=function(e,t,n){if(i)try{return L(e,t,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(p(e)[t]=n.value),e},r.getDesc=function(e,t){if(i)try{return R(e,t)}catch(n){}return c(e,t)?s(!C.propertyIsEnumerable.call(e,t),e[t]):void 0},r.setDescs=O=function(e,t){p(e);for(var n,i=r.getKeys(t),o=i.length,a=0;o>a;)r.setDesc(e,n=i[a++],t[n]);return e}),o(o.S+o.F*!a,"Object",{getOwnPropertyDescriptor:r.getDesc,defineProperty:r.setDesc,defineProperties:O});var D="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),I=D.concat("length","prototype"),N=D.length,F=function(){var e,t=u("iframe"),n=N,i=">";for(t.style.display="none",l.appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object</script"+i),e.close(),F=e.F;n--;)delete F.prototype[D[n]];return F()},B=function(e,t){return function(n){var i,r=v(n),o=0,a=[];for(i in r)i!=S&&c(r,i)&&a.push(i);for(;t>o;)c(r,i=e[o++])&&(~k(a,i)||a.push(i));return a}},z=function(){};o(o.S,"Object",{getPrototypeOf:r.getProto=r.getProto||function(e){return e=m(e),c(e,S)?e[S]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?C:null},getOwnPropertyNames:r.getNames=r.getNames||B(I,I.length,!0),create:r.create=r.create||function(e,t){var n;return null!==e?(z.prototype=p(e),n=new z,z.prototype=null,n[S]=e):n=F(),void 0===t?n:O(n,t)},keys:r.getKeys=r.getKeys||B(D,N,!1)});var H=function(e,t,n){if(!(t in P)){for(var i=[],r=0;t>r;r++)i[r]="a["+r+"]";P[t]=Function("F,a","return new F("+i.join(",")+")")}return P[t](e,n)};o(o.P,"Function",{bind:function(e){var t=_(this),n=E.call(arguments,1),i=function(){var r=n.concat(E.call(arguments));return this instanceof i?H(t,r.length,r):d(t,r,e)};return g(t.prototype)&&(i.prototype=t.prototype),i}}),o(o.P+o.F*f(function(){l&&E.call(l)}),"Array",{slice:function(e,t){var n=x(this.length),i=h(this);if(t=void 0===t?n:t,"Array"==i)return E.call(this,e,t);for(var r=b(e,n),o=b(t,n),a=x(o-r),s=Array(a),l=0;a>l;l++)s[l]="String"==i?this.charAt(r+l):this[r+l];return s}}),o(o.P+o.F*(w!=Object),"Array",{join:function(e){return M.call(w(this),void 0===e?",":e)}}),o(o.S,"Array",{isArray:n(32)});var q=function(e){return function(t,n){_(t);var i=w(this),r=x(i.length),o=e?r-1:0,a=e?-1:1;if(arguments.length<2)for(;;){if(o in i){n=i[o],o+=a;break}if(o+=a,e?0>o:o>=r)throw TypeError("Reduce of empty array with no initial value")}for(;e?o>=0:r>o;o+=a)o in i&&(n=t(n,i[o],o,this));return n}},G=function(e){return function(t){return e(this,t,arguments[1])}};o(o.P,"Array",{forEach:r.each=r.each||G(A(0)),map:G(A(1)),filter:G(A(2)),some:G(A(3)),every:G(A(4)),reduce:q(!1),reduceRight:q(!0),indexOf:G(k),lastIndexOf:function(e,t){var n=v(this),i=x(n.length),r=i-1;for(arguments.length>1&&(r=Math.min(r,y(t))),0>r&&(r=x(i+r));r>=0;r--)if(r in n&&n[r]===e)return r;return-1}}),o(o.S,"Date",{now:function(){return+new Date}});var j=function(e){return e>9?e:"0"+e};o(o.P+o.F*(f(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!f(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){if(!isFinite(this))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),i=0>t?"-":t>9999?"+":"";return i+("00000"+Math.abs(t)).slice(i?-6:-4)+"-"+j(e.getUTCMonth()+1)+"-"+j(e.getUTCDate())+"T"+j(e.getUTCHours())+":"+j(e.getUTCMinutes())+":"+j(e.getUTCSeconds())+"."+(n>99?n:"0"+j(n))+"Z"}})},function(e,t){var n=Object;e.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(e,t,n){var i=n(6),r=n(7),o=n(8),a=n(12),s=n(14),l="prototype",u=function(e,t,n){var c,h,d,f,p=e&u.F,_=e&u.G,g=e&u.S,m=e&u.P,v=e&u.B,y=_?i:g?i[t]||(i[t]={}):(i[t]||{})[l],b=_?r:r[t]||(r[t]={}),x=b[l]||(b[l]={});_&&(n=t);for(c in n)h=!p&&y&&c in y,d=(h?y:n)[c],f=v&&h?s(d,i):m&&"function"==typeof d?s(Function.call,d):d,y&&!h&&a(y,c,d),b[c]!=d&&o(b,c,f),m&&x[c]!=d&&(x[c]=d)};i.core=r,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,e.exports=u},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},function(e,t,n){var i=n(4),r=n(9);e.exports=n(10)?function(e,t,n){return i.setDesc(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){e.exports=!n(11)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,n){var i=n(6),r=n(8),o=n(13)("src"),a="toString",s=Function[a],l=(""+s).split(a);n(7).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,a){"function"==typeof n&&(n.hasOwnProperty(o)||r(n,o,e[t]?""+e[t]:l.join(String(t))),n.hasOwnProperty("name")||r(n,"name",t)),e===i?e[t]=n:(a||delete e[t],r(e,t,n))})(Function.prototype,a,function(){return"function"==typeof this&&this[o]||s.call(this)})},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,n){var i=n(15);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){e.exports=n(6).document&&document.documentElement},function(e,t,n){var i=n(18),r=n(6).document,o=i(r)&&i(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var i=n(18);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var i=n(24);e.exports=function(e){return Object(i(e))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var i=n(26),r=n(24);e.exports=function(e){return i(r(e))}},function(e,t,n){var i=n(20);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){var i=n(27),r=Math.max,o=Math.min;e.exports=function(e,t){return e=i(e),0>e?r(e+t,0):o(e,t)}},function(e,t,n){var i=n(27),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t,n){var i=n(14),r=n(26),o=n(23),a=n(29),s=n(31);e.exports=function(e){var t=1==e,n=2==e,l=3==e,u=4==e,c=6==e,h=5==e||c;return function(d,f,p){for(var _,g,m=o(d),v=r(m),y=i(f,p,3),b=a(v.length),x=0,w=t?s(d,b):n?s(d,0):void 0;b>x;x++)if((h||x in v)&&(_=v[x],g=y(_,x,m),e))if(t)w[x]=g;else if(g)switch(e){case 3:return!0;case 5:return _;case 6:return x;case 2:w.push(_)}else if(u)return!1;return c?-1:l||u?u:w}}},function(e,t,n){var i=n(18),r=n(32),o=n(33)("species");e.exports=function(e,t){var n;return r(e)&&(n=e.constructor,"function"!=typeof n||n!==Array&&!r(n.prototype)||(n=void 0),i(n)&&(n=n[o],null===n&&(n=void 0))),new(void 0===n?Array:n)(t)}},function(e,t,n){var i=n(20);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){var i=n(34)("wks"),r=n(13),o=n(6).Symbol;e.exports=function(e){return i[e]||(i[e]=o&&o[e]||(o||r)("Symbol."+e))}},function(e,t,n){var i=n(6),r="__core-js_shared__",o=i[r]||(i[r]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t,n){var i=n(25),r=n(29),o=n(28);e.exports=function(e){return function(t,n,a){var s,l=i(t),u=r(l.length),c=o(a,u);if(e&&n!=n){for(;u>c;)if(s=l[c++],s!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c;return!e&&-1}}},function(e,t,n){"use strict";var i=n(4),r=n(6),o=n(19),a=n(10),s=n(5),l=n(12),u=n(11),c=n(34),h=n(37),d=n(13),f=n(33),p=n(38),_=n(39),g=n(40),m=n(32),v=n(22),y=n(25),b=n(9),x=i.getDesc,w=i.setDesc,S=i.create,A=_.get,k=r.Symbol,C=r.JSON,T=C&&C.stringify,E=!1,M=f("_hidden"),L=i.isEnum,R=c("symbol-registry"),O=c("symbols"),P="function"==typeof k,D=Object.prototype,I=a&&u(function(){return 7!=S(w({},"a",{get:function(){return w(this,"a",{value:7}).a}})).a})?function(e,t,n){var i=x(D,t);i&&delete D[t],w(e,t,n),i&&e!==D&&w(D,t,i)}:w,N=function(e){var t=O[e]=S(k.prototype);return t._k=e,a&&E&&I(D,e,{configurable:!0,set:function(t){o(this,M)&&o(this[M],e)&&(this[M][e]=!1),I(this,e,b(1,t))}}),t},F=function(e){return"symbol"==typeof e},B=function(e,t,n){return n&&o(O,t)?(n.enumerable?(o(e,M)&&e[M][t]&&(e[M][t]=!1),n=S(n,{enumerable:b(0,!1)})):(o(e,M)||w(e,M,b(1,{})),e[M][t]=!0),I(e,t,n)):w(e,t,n)},z=function(e,t){v(e);for(var n,i=g(t=y(t)),r=0,o=i.length;o>r;)B(e,n=i[r++],t[n]);return e},H=function(e,t){return void 0===t?S(e):z(S(e),t)},q=function(e){var t=L.call(this,e);return t||!o(this,e)||!o(O,e)||o(this,M)&&this[M][e]?t:!0},G=function(e,t){var n=x(e=y(e),t);return!n||!o(O,t)||o(e,M)&&e[M][t]||(n.enumerable=!0),n},j=function(e){for(var t,n=A(y(e)),i=[],r=0;n.length>r;)o(O,t=n[r++])||t==M||i.push(t);return i},U=function(e){for(var t,n=A(y(e)),i=[],r=0;n.length>r;)o(O,t=n[r++])&&i.push(O[t]);return i},V=function(e){if(void 0!==e&&!F(e)){for(var t,n,i=[e],r=1,o=arguments;o.length>r;)i.push(o[r++]);return t=i[1],"function"==typeof t&&(n=t),(n||!m(t))&&(t=function(e,t){return n&&(t=n.call(this,e,t)),F(t)?void 0:t}),i[1]=t,T.apply(C,i)}},W=u(function(){var e=k();return"[null]"!=T([e])||"{}"!=T({a:e})||"{}"!=T(Object(e))});P||(k=function(){if(F(this))throw TypeError("Symbol is not a constructor");return N(d(arguments.length>0?arguments[0]:void 0))},l(k.prototype,"toString",function(){return this._k}),F=function(e){return e instanceof k},i.create=H,i.isEnum=q,i.getDesc=G,i.setDesc=B,i.setDescs=z,i.getNames=_.get=j,i.getSymbols=U,a&&!n(41)&&l(D,"propertyIsEnumerable",q,!0));var X={"for":function(e){return o(R,e+="")?R[e]:R[e]=k(e)},keyFor:function(e){return p(R,e)},useSetter:function(){E=!0},useSimple:function(){E=!1}};i.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=f(e);X[e]=P?t:N(t)}),E=!0,s(s.G+s.W,{Symbol:k}),s(s.S,"Symbol",X),s(s.S+s.F*!P,"Object",{create:H,defineProperty:B,defineProperties:z,getOwnPropertyDescriptor:G,getOwnPropertyNames:j,getOwnPropertySymbols:U}),C&&s(s.S+s.F*(!P||W),"JSON",{stringify:V}),h(k,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(e,t,n){var i=n(4).setDesc,r=n(19),o=n(33)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},function(e,t,n){var i=n(4),r=n(25);e.exports=function(e,t){for(var n,o=r(e),a=i.getKeys(o),s=a.length,l=0;s>l;)if(o[n=a[l++]]===t)return n}},function(e,t,n){var i=n(25),r=n(4).getNames,o={}.toString,a="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return r(e)}catch(t){return a.slice()}};e.exports.get=function(e){return a&&"[object Window]"==o.call(e)?s(e):r(i(e))}},function(e,t,n){var i=n(4);e.exports=function(e){var t=i.getKeys(e),n=i.getSymbols;if(n)for(var r,o=n(e),a=i.isEnum,s=0;o.length>s;)a.call(e,r=o[s++])&&t.push(r);return t}},function(e,t){e.exports=!1},function(e,t,n){var i=n(5);i(i.S+i.F,"Object",{assign:n(43)})},function(e,t,n){var i=n(4),r=n(23),o=n(26);e.exports=n(11)(function(){var e=Object.assign,t={},n={},i=Symbol(),r="abcdefghijklmnopqrst";return t[i]=7,r.split("").forEach(function(e){n[e]=e}),7!=e({},t)[i]||Object.keys(e({},n)).join("")!=r})?function(e,t){for(var n=r(e),a=arguments,s=a.length,l=1,u=i.getKeys,c=i.getSymbols,h=i.isEnum;s>l;)for(var d,f=o(a[l++]),p=c?u(f).concat(c(f)):u(f),_=p.length,g=0;_>g;)h.call(f,d=p[g++])&&(n[d]=f[d]);return n}:Object.assign},function(e,t,n){var i=n(5);i(i.S,"Object",{is:n(45)})},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},function(e,t,n){var i=n(5);i(i.S,"Object",{setPrototypeOf:n(47).set})},function(e,t,n){var i=n(4).getDesc,r=n(18),o=n(22),a=function(e,t){if(o(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=n(14)(Function.call,i(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(o){t=!0}return function(e,n){return a(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:a}},function(e,t,n){"use strict";var i=n(49),r={};r[n(33)("toStringTag")]="z",r+""!="[object z]"&&n(12)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(e,t,n){var i=n(20),r=n(33)("toStringTag"),o="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=(t=Object(e))[r])?n:o?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var i=n(18);n(51)("freeze",function(e){return function(t){return e&&i(t)?e(t):t}})},function(e,t,n){var i=n(5),r=n(7),o=n(11);e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],a={};a[e]=t(n),i(i.S+i.F*o(function(){n(1)}),"Object",a)}},function(e,t,n){var i=n(18);n(51)("seal",function(e){return function(t){return e&&i(t)?e(t):t}})},function(e,t,n){var i=n(18);n(51)("preventExtensions",function(e){return function(t){return e&&i(t)?e(t):t}})},function(e,t,n){var i=n(18);n(51)("isFrozen",function(e){return function(t){return i(t)?e?e(t):!1:!0}})},function(e,t,n){var i=n(18);n(51)("isSealed",function(e){return function(t){return i(t)?e?e(t):!1:!0}})},function(e,t,n){var i=n(18);n(51)("isExtensible",function(e){return function(t){return i(t)?e?e(t):!0:!1}})},function(e,t,n){var i=n(25);n(51)("getOwnPropertyDescriptor",function(e){return function(t,n){return e(i(t),n)}})},function(e,t,n){var i=n(23);n(51)("getPrototypeOf",function(e){return function(t){return e(i(t))}})},function(e,t,n){var i=n(23);n(51)("keys",function(e){return function(t){return e(i(t))}})},function(e,t,n){n(51)("getOwnPropertyNames",function(){return n(39).get})},function(e,t,n){var i=n(4).setDesc,r=n(9),o=n(19),a=Function.prototype,s=/^\s*function ([^ (]*)/,l="name";l in a||n(10)&&i(a,l,{configurable:!0,get:function(){var e=(""+this).match(s),t=e?e[1]:"";return o(this,l)||i(this,l,r(5,t)),t}})},function(e,t,n){"use strict";var i=n(4),r=n(18),o=n(33)("hasInstance"),a=Function.prototype;o in a||i.setDesc(a,o,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i.getProto(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){"use strict";var i=n(4),r=n(6),o=n(19),a=n(20),s=n(64),l=n(11),u=n(65).trim,c="Number",h=r[c],d=h,f=h.prototype,p=a(i.create(f))==c,_="trim"in String.prototype,g=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){t=_?t.trim():u(t,3);var n,i,r,o=t.charCodeAt(0);if(43===o||45===o){if(n=t.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+t}for(var a,l=t.slice(2),c=0,h=l.length;h>c;c++)if(a=l.charCodeAt(c),48>a||a>r)return NaN;return parseInt(l,i)}}return+t};h(" 0o1")&&h("0b1")&&!h("+0x1")||(h=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof h&&(p?l(function(){f.valueOf.call(n)}):a(n)!=c)?new d(g(t)):g(t)},i.each.call(n(10)?i.getNames(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),function(e){o(d,e)&&!o(h,e)&&i.setDesc(h,e,i.getDesc(d,e))}),h.prototype=f,f.constructor=h,n(12)(r,c,h))},function(e,t,n){var i=n(18);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var i=n(5),r=n(24),o=n(11),a="	\n\x0B\f\r   ᠎             　\u2028\u2029\ufeff",s="["+a+"]",l="​",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),h=function(e,t){var n={};n[e]=t(d),i(i.P+i.F*o(function(){return!!a[e]()||l[e]()!=l}),"String",n)},d=h.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(u,"")),2&t&&(e=e.replace(c,"")),e};e.exports=h},function(e,t,n){var i=n(5);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var i=n(5),r=n(6).isFinite;i(i.S,"Number",{isFinite:function(e){return"number"==typeof e&&r(e)}})},function(e,t,n){var i=n(5);i(i.S,"Number",{isInteger:n(69)})},function(e,t,n){var i=n(18),r=Math.floor;e.exports=function(e){return!i(e)&&isFinite(e)&&r(e)===e}},function(e,t,n){var i=n(5);i(i.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var i=n(5),r=n(69),o=Math.abs;i(i.S,"Number",{isSafeInteger:function(e){return r(e)&&o(e)<=9007199254740991}})},function(e,t,n){var i=n(5);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var i=n(5);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var i=n(5);i(i.S,"Number",{parseFloat:parseFloat})},function(e,t,n){var i=n(5);i(i.S,"Number",{parseInt:parseInt})},function(e,t,n){var i=n(5),r=n(77),o=Math.sqrt,a=Math.acosh;i(i.S+i.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:r(e-1+o(e-1)*o(e+1))}})},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&1e-8>e?e-e*e/2:Math.log(1+e)}},function(e,t,n){function i(e){return isFinite(e=+e)&&0!=e?0>e?-i(-e):Math.log(e+Math.sqrt(e*e+1)):e}var r=n(5);r(r.S,"Math",{asinh:i})},function(e,t,n){var i=n(5);i(i.S,"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var i=n(5),r=n(81);i(i.S,"Math",{cbrt:function(e){return r(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:0>e?-1:1}},function(e,t,n){var i=n(5);i(i.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var i=n(5),r=Math.exp;i(i.S,"Math",{cosh:function(e){return(r(e=+e)+r(-e))/2}})},function(e,t,n){var i=n(5);i(i.S,"Math",{expm1:n(85)})},function(e,t){e.exports=Math.expm1||function(e){return 0==(e=+e)?e:e>-1e-6&&1e-6>e?e+e*e/2:Math.exp(e)-1}},function(e,t,n){var i=n(5),r=n(81),o=Math.pow,a=o(2,-52),s=o(2,-23),l=o(2,127)*(2-s),u=o(2,-126),c=function(e){return e+1/a-1/a};i(i.S,"Math",{fround:function(e){var t,n,i=Math.abs(e),o=r(e);return u>i?o*c(i/u/s)*u*s:(t=(1+s/a)*i,n=t-(t-i),n>l||n!=n?o*(1/0):o*n)}})},function(e,t,n){var i=n(5),r=Math.abs;i(i.S,"Math",{hypot:function(e,t){for(var n,i,o=0,a=0,s=arguments,l=s.length,u=0;l>a;)n=r(s[a++]),n>u?(i=u/n,o=o*i*i+1,u=n):n>0?(i=n/u,o+=i*i):o+=n;return u===1/0?1/0:u*Math.sqrt(o)}})},function(e,t,n){var i=n(5),r=Math.imul;i(i.S+i.F*n(11)(function(){return-5!=r(4294967295,5)||2!=r.length}),"Math",{imul:function(e,t){var n=65535,i=+e,r=+t,o=n&i,a=n&r;return 0|o*a+((n&i>>>16)*a+o*(n&r>>>16)<<16>>>0)}})},function(e,t,n){var i=n(5);i(i.S,"Math",{log10:function(e){return Math.log(e)/Math.LN10}})},function(e,t,n){var i=n(5);i(i.S,"Math",{log1p:n(77)})},function(e,t,n){var i=n(5);i(i.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var i=n(5);i(i.S,"Math",{sign:n(81)})},function(e,t,n){var i=n(5),r=n(85),o=Math.exp;i(i.S+i.F*n(11)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(r(e)-r(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},function(e,t,n){var i=n(5),r=n(85),o=Math.exp;i(i.S,"Math",{tanh:function(e){var t=r(e=+e),n=r(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},function(e,t,n){var i=n(5);i(i.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var i=n(5),r=n(28),o=String.fromCharCode,a=String.fromCodePoint;i(i.S+i.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,n=[],i=arguments,a=i.length,s=0;a>s;){if(t=+i[s++],r(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(65536>t?o(t):o(((t-=65536)>>10)+55296,t%1024+56320))}return n.join("")}})},function(e,t,n){var i=n(5),r=n(25),o=n(29);i(i.S,"String",{raw:function(e){for(var t=r(e.raw),n=o(t.length),i=arguments,a=i.length,s=[],l=0;n>l;)s.push(String(t[l++])),a>l&&s.push(String(i[l]));return s.join("")}})},function(e,t,n){"use strict";n(65)("trim",function(e){return function(){return e(this,3)}})},function(e,t,n){"use strict";var i=n(100)(!0);n(101)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var i=n(27),r=n(24);e.exports=function(e){return function(t,n){var o,a,s=String(r(t)),l=i(n),u=s.length;return 0>l||l>=u?e?"":void 0:(o=s.charCodeAt(l),55296>o||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):(o-55296<<10)+(a-56320)+65536)}}},function(e,t,n){"use strict";var i=n(41),r=n(5),o=n(12),a=n(8),s=n(19),l=n(102),u=n(103),c=n(37),h=n(4).getProto,d=n(33)("iterator"),f=!([].keys&&"next"in[].keys()),p="@@iterator",_="keys",g="values",m=function(){return this};e.exports=function(e,t,n,v,y,b,x){u(n,t,v);var w,S,A=function(e){if(!f&&e in E)return E[e];switch(e){case _:return function(){return new n(this,e)};case g:return function(){return new n(this,e)}}return function(){return new n(this,e)}},k=t+" Iterator",C=y==g,T=!1,E=e.prototype,M=E[d]||E[p]||y&&E[y],L=M||A(y);if(M){var R=h(L.call(new e));c(R,k,!0),!i&&s(E,p)&&a(R,d,m),C&&M.name!==g&&(T=!0,L=function(){return M.call(this)})}if(i&&!x||!f&&!T&&E[d]||a(E,d,L),l[t]=L,l[k]=m,y)if(w={values:C?L:A(g),keys:b?L:A(_),entries:C?A("entries"):L},x)for(S in w)S in E||o(E,S,w[S]);else r(r.P+r.F*(f||T),t,w);return w}},function(e,t){e.exports={}},function(e,t,n){"use strict";var i=n(4),r=n(9),o=n(37),a={};n(8)(a,n(33)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i.create(a,{next:r(1,n)}),o(e,t+" Iterator")}},function(e,t,n){"use strict";var i=n(5),r=n(100)(!1);i(i.P,"String",{codePointAt:function(e){return r(this,e)}})},function(e,t,n){"use strict";var i=n(5),r=n(29),o=n(106),a="endsWith",s=""[a];i(i.P+i.F*n(108)(a),"String",{endsWith:function(e){var t=o(this,e,a),n=arguments,i=n.length>1?n[1]:void 0,l=r(t.length),u=void 0===i?l:Math.min(r(i),l),c=String(e);return s?s.call(t,c,u):t.slice(u-c.length,u)===c}})},function(e,t,n){var i=n(107),r=n(24);e.exports=function(e,t,n){if(i(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(e))}},function(e,t,n){var i=n(18),r=n(20),o=n(33)("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==r(e))}},function(e,t,n){var i=n(33)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,!"/./"[e](t)}catch(r){}}return!0}},function(e,t,n){"use strict";var i=n(5),r=n(106),o="includes";i(i.P+i.F*n(108)(o),"String",{includes:function(e){return!!~r(this,e,o).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var i=n(5);i(i.P,"String",{repeat:n(111)})},function(e,t,n){"use strict";var i=n(27),r=n(24);e.exports=function(e){var t=String(r(this)),n="",o=i(e);if(0>o||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t,n){"use strict";var i=n(5),r=n(29),o=n(106),a="startsWith",s=""[a];i(i.P+i.F*n(108)(a),"String",{startsWith:function(e){var t=o(this,e,a),n=arguments,i=r(Math.min(n.length>1?n[1]:void 0,t.length)),l=String(e);return s?s.call(t,l,i):t.slice(i,i+l.length)===l}})},function(e,t,n){"use strict";var i=n(14),r=n(5),o=n(23),a=n(114),s=n(115),l=n(29),u=n(116);r(r.S+r.F*!n(117)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,c,h=o(e),d="function"==typeof this?this:Array,f=arguments,p=f.length,_=p>1?f[1]:void 0,g=void 0!==_,m=0,v=u(h);if(g&&(_=i(_,p>2?f[2]:void 0,2)),void 0==v||d==Array&&s(v))for(t=l(h.length),n=new d(t);t>m;m++)n[m]=g?_(h[m],m):h[m];else for(c=v.call(h),n=new d;!(r=c.next()).done;m++)n[m]=g?a(c,_,[r.value,m],!0):r.value;return n.length=m,n}})},function(e,t,n){var i=n(22);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(o){var a=e["return"];throw void 0!==a&&i(a.call(e)),o}}},function(e,t,n){var i=n(102),r=n(33)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[r]===e)}},function(e,t,n){var i=n(49),r=n(33)("iterator"),o=n(102);e.exports=n(7).getIteratorMethod=function(e){return void 0!=e?e[r]||e["@@iterator"]||o[i(e)]:void 0}},function(e,t,n){var i=n(33)("iterator"),r=!1;try{var o=[7][i]();o["return"]=function(){r=!0},Array.from(o,function(){throw 2})}catch(a){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){n=!0},o[i]=function(){return a},e(o)}catch(s){}return n}},function(e,t,n){"use strict";var i=n(5);i(i.S+i.F*n(11)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments,n=t.length,i=new("function"==typeof this?this:Array)(n);n>e;)i[e]=t[e++];return i.length=n,i}})},function(e,t,n){"use strict";var i=n(120),r=n(121),o=n(102),a=n(25);e.exports=n(101)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):"keys"==t?r(0,n):"values"==t?r(0,e[n]):r(0,[n,e[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,n){var i=n(33)("unscopables"),r=Array.prototype;void 0==r[i]&&n(8)(r,i,{}),e.exports=function(e){r[i][e]=!0}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){n(123)("Array")},function(e,t,n){"use strict";var i=n(6),r=n(4),o=n(10),a=n(33)("species");e.exports=function(e){var t=i[e];o&&t&&!t[a]&&r.setDesc(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){var i=n(5);i(i.P,"Array",{copyWithin:n(125)}),n(120)("copyWithin")},function(e,t,n){"use strict";var i=n(23),r=n(28),o=n(29);e.exports=[].copyWithin||function(e,t){var n=i(this),a=o(n.length),s=r(e,a),l=r(t,a),u=arguments,c=u.length>2?u[2]:void 0,h=Math.min((void 0===c?a:r(c,a))-l,a-s),d=1;for(s>l&&l+h>s&&(d=-1,l+=h-1,s+=h-1);h-- >0;)l in n?n[s]=n[l]:delete n[s],s+=d,l+=d;return n}},function(e,t,n){var i=n(5);i(i.P,"Array",{fill:n(127)}),n(120)("fill")},function(e,t,n){"use strict";var i=n(23),r=n(28),o=n(29);e.exports=[].fill||function(e){for(var t=i(this),n=o(t.length),a=arguments,s=a.length,l=r(s>1?a[1]:void 0,n),u=s>2?a[2]:void 0,c=void 0===u?n:r(u,n);c>l;)t[l++]=e;return t}},function(e,t,n){"use strict";var i=n(5),r=n(30)(5),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),i(i.P+i.F*a,"Array",{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n(120)(o)},function(e,t,n){"use strict";var i=n(5),r=n(30)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),i(i.P+i.F*a,"Array",{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n(120)(o)},function(e,t,n){var i=n(4),r=n(6),o=n(107),a=n(131),s=r.RegExp,l=s,u=s.prototype,c=/a/g,h=/a/g,d=new s(c)!==c;!n(10)||d&&!n(11)(function(){return h[n(33)("match")]=!1,s(c)!=c||s(h)==h||"/a/i"!=s(c,"i")})||(s=function(e,t){var n=o(e),i=void 0===t;return this instanceof s||!n||e.constructor!==s||!i?d?new l(n&&!i?e.source:e,t):l((n=e instanceof s)?e.source:e,n&&i?a.call(e):t):e},i.each.call(i.getNames(l),function(e){e in s||i.setDesc(s,e,{configurable:!0,get:function(){return l[e]},set:function(t){l[e]=t}})}),u.constructor=s,s.prototype=u,n(12)(r,"RegExp",s)),n(123)("RegExp")},function(e,t,n){"use strict";var i=n(22);e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var i=n(4);n(10)&&"g"!=/./g.flags&&i.setDesc(RegExp.prototype,"flags",{configurable:!0,get:n(131)})},function(e,t,n){n(134)("match",1,function(e,t){return function(n){"use strict";var i=e(this),r=void 0==n?void 0:n[t];return void 0!==r?r.call(n,i):new RegExp(n)[t](String(i))}})},function(e,t,n){"use strict";var i=n(8),r=n(12),o=n(11),a=n(24),s=n(33);e.exports=function(e,t,n){var l=s(e),u=""[e];o(function(){var t={};return t[l]=function(){return 7},7!=""[e](t)})&&(r(String.prototype,e,n(a,l,u)),i(RegExp.prototype,l,2==t?function(e,t){return u.call(e,this,t)}:function(e){return u.call(e,this)}))}},function(e,t,n){n(134)("replace",2,function(e,t,n){return function(i,r){"use strict";var o=e(this),a=void 0==i?void 0:i[t];return void 0!==a?a.call(i,o,r):n.call(String(o),i,r)}})},function(e,t,n){n(134)("search",1,function(e,t){return function(n){"use strict";var i=e(this),r=void 0==n?void 0:n[t];return void 0!==r?r.call(n,i):new RegExp(n)[t](String(i))}})},function(e,t,n){n(134)("split",2,function(e,t,n){return function(i,r){"use strict";var o=e(this),a=void 0==i?void 0:i[t];return void 0!==a?a.call(i,o,r):n.call(String(o),i,r)}})},function(e,t,n){"use strict";var i,r=n(4),o=n(41),a=n(6),s=n(14),l=n(49),u=n(5),c=n(18),h=n(22),d=n(15),f=n(139),p=n(140),_=n(47).set,g=n(45),m=n(33)("species"),v=n(141),y=n(142),b="Promise",x=a.process,w="process"==l(x),S=a[b],A=function(e){var t=new S(function(){});return e&&(t.constructor=Object),S.resolve(t)===t},k=function(){function e(t){var n=new S(t);return _(n,e.prototype),n}var t=!1;try{if(t=S&&S.resolve&&A(),_(e,S),e.prototype=r.create(S.prototype,{constructor:{
value:e}}),e.resolve(5).then(function(){})instanceof e||(t=!1),t&&n(10)){var i=!1;S.resolve(r.setDesc({},"then",{get:function(){i=!0}})),t=i}}catch(o){t=!1}return t}(),C=function(e,t){return o&&e===S&&t===i?!0:g(e,t)},T=function(e){var t=h(e)[m];return void 0!=t?t:e},E=function(e){var t;return c(e)&&"function"==typeof(t=e.then)?t:!1},M=function(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i}),this.resolve=d(t),this.reject=d(n)},L=function(e){try{e()}catch(t){return{error:t}}},R=function(e,t){if(!e.n){e.n=!0;var n=e.c;y(function(){for(var i=e.v,r=1==e.s,o=0,s=function(t){var n,o,a=r?t.ok:t.fail,s=t.resolve,l=t.reject;try{a?(r||(e.h=!0),n=a===!0?i:a(i),n===t.promise?l(TypeError("Promise-chain cycle")):(o=E(n))?o.call(n,s,l):s(n)):l(i)}catch(u){l(u)}};n.length>o;)s(n[o++]);n.length=0,e.n=!1,t&&setTimeout(function(){var t,n,r=e.p;O(r)&&(w?x.emit("unhandledRejection",i,r):(t=a.onunhandledrejection)?t({promise:r,reason:i}):(n=a.console)&&n.error&&n.error("Unhandled promise rejection",i)),e.a=void 0},1)})}},O=function(e){var t,n=e._d,i=n.a||n.c,r=0;if(n.h)return!1;for(;i.length>r;)if(t=i[r++],t.fail||!O(t.promise))return!1;return!0},P=function(e){var t=this;t.d||(t.d=!0,t=t.r||t,t.v=e,t.s=2,t.a=t.c.slice(),R(t,!0))},D=function(e){var t,n=this;if(!n.d){n.d=!0,n=n.r||n;try{if(n.p===e)throw TypeError("Promise can't be resolved itself");(t=E(e))?y(function(){var i={r:n,d:!1};try{t.call(e,s(D,i,1),s(P,i,1))}catch(r){P.call(i,r)}}):(n.v=e,n.s=1,R(n,!1))}catch(i){P.call({r:n,d:!1},i)}}};k||(S=function(e){d(e);var t=this._d={p:f(this,S,b),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{e(s(D,t,1),s(P,t,1))}catch(n){P.call(t,n)}},n(144)(S.prototype,{then:function(e,t){var n=new M(v(this,S)),i=n.promise,r=this._d;return n.ok="function"==typeof e?e:!0,n.fail="function"==typeof t&&t,r.c.push(n),r.a&&r.a.push(n),r.s&&R(r,!1),i},"catch":function(e){return this.then(void 0,e)}})),u(u.G+u.W+u.F*!k,{Promise:S}),n(37)(S,b),n(123)(b),i=n(7)[b],u(u.S+u.F*!k,b,{reject:function(e){var t=new M(this),n=t.reject;return n(e),t.promise}}),u(u.S+u.F*(!k||A(!0)),b,{resolve:function(e){if(e instanceof S&&C(e.constructor,this))return e;var t=new M(this),n=t.resolve;return n(e),t.promise}}),u(u.S+u.F*!(k&&n(117)(function(e){S.all(e)["catch"](function(){})})),b,{all:function(e){var t=T(this),n=new M(t),i=n.resolve,o=n.reject,a=[],s=L(function(){p(e,!1,a.push,a);var n=a.length,s=Array(n);n?r.each.call(a,function(e,r){var a=!1;t.resolve(e).then(function(e){a||(a=!0,s[r]=e,--n||i(s))},o)}):i(s)});return s&&o(s.error),n.promise},race:function(e){var t=T(this),n=new M(t),i=n.reject,r=L(function(){p(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return r&&i(r.error),n.promise}})},function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError(n+": use the 'new' operator!");return e}},function(e,t,n){var i=n(14),r=n(114),o=n(115),a=n(22),s=n(29),l=n(116);e.exports=function(e,t,n,u){var c,h,d,f=l(e),p=i(n,u,t?2:1),_=0;if("function"!=typeof f)throw TypeError(e+" is not iterable!");if(o(f))for(c=s(e.length);c>_;_++)t?p(a(h=e[_])[0],h[1]):p(e[_]);else for(d=f.call(e);!(h=d.next()).done;)r(d,p,h.value,t)}},function(e,t,n){var i=n(22),r=n(15),o=n(33)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||void 0==(n=i(a)[o])?t:r(n)}},function(e,t,n){var i,r,o,a=n(6),s=n(143).set,l=a.MutationObserver||a.WebKitMutationObserver,u=a.process,c=a.Promise,h="process"==n(20)(u),d=function(){var e,t,n;for(h&&(e=u.domain)&&(u.domain=null,e.exit());i;)t=i.domain,n=i.fn,t&&t.enter(),n(),t&&t.exit(),i=i.next;r=void 0,e&&e.enter()};if(h)o=function(){u.nextTick(d)};else if(l){var f=1,p=document.createTextNode("");new l(d).observe(p,{characterData:!0}),o=function(){p.data=f=-f}}else o=c&&c.resolve?function(){c.resolve().then(d)}:function(){s.call(a,d)};e.exports=function(e){var t={fn:e,next:void 0,domain:h&&u.domain};r&&(r.next=t),i||(i=t,o()),r=t}},function(e,t,n){var i,r,o,a=n(14),s=n(21),l=n(16),u=n(17),c=n(6),h=c.process,d=c.setImmediate,f=c.clearImmediate,p=c.MessageChannel,_=0,g={},m="onreadystatechange",v=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},y=function(e){v.call(e.data)};d&&f||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++_]=function(){s("function"==typeof e?e:Function(e),t)},i(_),_},f=function(e){delete g[e]},"process"==n(20)(h)?i=function(e){h.nextTick(a(v,e,1))}:p?(r=new p,o=r.port2,r.port1.onmessage=y,i=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(e){c.postMessage(e+"","*")},c.addEventListener("message",y,!1)):i=m in u("script")?function(e){l.appendChild(u("script"))[m]=function(){l.removeChild(this),v.call(e)}}:function(e){setTimeout(a(v,e,1),0)}),e.exports={set:d,clear:f}},function(e,t,n){var i=n(12);e.exports=function(e,t){for(var n in t)i(e,n,t[n]);return e}},function(e,t,n){"use strict";var i=n(146);n(147)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=i.getEntry(this,e);return t&&t.v},set:function(e,t){return i.def(this,0===e?0:e,t)}},i,!0)},function(e,t,n){"use strict";var i=n(4),r=n(8),o=n(144),a=n(14),s=n(139),l=n(24),u=n(140),c=n(101),h=n(121),d=n(13)("id"),f=n(19),p=n(18),_=n(123),g=n(10),m=Object.isExtensible||p,v=g?"_s":"size",y=0,b=function(e,t){if(!p(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!f(e,d)){if(!m(e))return"F";if(!t)return"E";r(e,d,++y)}return"O"+e[d]},x=function(e,t){var n,i=b(t);if("F"!==i)return e._i[i];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,r){var c=e(function(e,o){s(e,c,t),e._i=i.create(null),e._f=void 0,e._l=void 0,e[v]=0,void 0!=o&&u(o,n,e[r],e)});return o(c.prototype,{clear:function(){for(var e=this,t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[v]=0},"delete":function(e){var t=this,n=x(t,e);if(n){var i=n.n,r=n.p;delete t._i[n.i],n.r=!0,r&&(r.n=i),i&&(i.p=r),t._f==n&&(t._f=i),t._l==n&&(t._l=r),t[v]--}return!!n},forEach:function(e){for(var t,n=a(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!x(this,e)}}),g&&i.setDesc(c.prototype,"size",{get:function(){return l(this[v])}}),c},def:function(e,t,n){var i,r,o=x(e,t);return o?o.v=n:(e._l=o={i:r=b(t,!0),k:t,v:n,p:i=e._l,n:void 0,r:!1},e._f||(e._f=o),i&&(i.n=o),e[v]++,"F"!==r&&(e._i[r]=o)),e},getEntry:x,setStrong:function(e,t,n){c(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?h(0,n.k):"values"==t?h(0,n.v):h(0,[n.k,n.v]):(e._t=void 0,h(1))},n?"entries":"values",!n,!0),_(t)}}},function(e,t,n){"use strict";var i=n(6),r=n(5),o=n(12),a=n(144),s=n(140),l=n(139),u=n(18),c=n(11),h=n(117),d=n(37);e.exports=function(e,t,n,f,p,_){var g=i[e],m=g,v=p?"set":"add",y=m&&m.prototype,b={},x=function(e){var t=y[e];o(y,e,"delete"==e?function(e){return _&&!u(e)?!1:t.call(this,0===e?0:e)}:"has"==e?function(e){return _&&!u(e)?!1:t.call(this,0===e?0:e)}:"get"==e?function(e){return _&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof m&&(_||y.forEach&&!c(function(){(new m).entries().next()}))){var w,S=new m,A=S[v](_?{}:-0,1)!=S,k=c(function(){S.has(1)}),C=h(function(e){new m(e)});C||(m=t(function(t,n){l(t,m,e);var i=new g;return void 0!=n&&s(n,p,i[v],i),i}),m.prototype=y,y.constructor=m),_||S.forEach(function(e,t){w=1/t===-(1/0)}),(k||w)&&(x("delete"),x("has"),p&&x("get")),(w||A)&&x(v),_&&y.clear&&delete y.clear}else m=f.getConstructor(t,e,p,v),a(m.prototype,n);return d(m,e),b[e]=m,r(r.G+r.W+r.F*(m!=g),b),_||f.setStrong(m,e,p),m}},function(e,t,n){"use strict";var i=n(146);n(147)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return i.def(this,e=0===e?0:e,e)}},i)},function(e,t,n){"use strict";var i=n(4),r=n(12),o=n(150),a=n(18),s=n(19),l=o.frozenStore,u=o.WEAK,c=Object.isExtensible||a,h={},d=n(147)("WeakMap",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){if(a(e)){if(!c(e))return l(this).get(e);if(s(e,u))return e[u][this._i]}},set:function(e,t){return o.def(this,e,t)}},o,!0,!0);7!=(new d).set((Object.freeze||Object)(h),7).get(h)&&i.each.call(["delete","has","get","set"],function(e){var t=d.prototype,n=t[e];r(t,e,function(t,i){if(a(t)&&!c(t)){var r=l(this)[e](t,i);return"set"==e?this:r}return n.call(this,t,i)})})},function(e,t,n){"use strict";var i=n(8),r=n(144),o=n(22),a=n(18),s=n(139),l=n(140),u=n(30),c=n(19),h=n(13)("weak"),d=Object.isExtensible||a,f=u(5),p=u(6),_=0,g=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},v=function(e,t){return f(e.a,function(e){return e[0]===t})};m.prototype={get:function(e){var t=v(this,e);return t?t[1]:void 0},has:function(e){return!!v(this,e)},set:function(e,t){var n=v(this,e);n?n[1]=t:this.a.push([e,t])},"delete":function(e){var t=p(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,i){var o=e(function(e,r){s(e,o,t),e._i=_++,e._l=void 0,void 0!=r&&l(r,n,e[i],e)});return r(o.prototype,{"delete":function(e){return a(e)?d(e)?c(e,h)&&c(e[h],this._i)&&delete e[h][this._i]:g(this)["delete"](e):!1},has:function(e){return a(e)?d(e)?c(e,h)&&c(e[h],this._i):g(this).has(e):!1}}),o},def:function(e,t,n){return d(o(t))?(c(t,h)||i(t,h,{}),t[h][e._i]=n):g(e).set(t,n),e},frozenStore:g,WEAK:h}},function(e,t,n){"use strict";var i=n(150);n(147)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return i.def(this,e,!0)}},i,!1,!0)},function(e,t,n){var i=n(5),r=Function.apply;i(i.S,"Reflect",{apply:function(e,t,n){return r.call(e,t,n)}})},function(e,t,n){var i=n(4),r=n(5),o=n(15),a=n(22),s=n(18),l=Function.bind||n(7).Function.prototype.bind;r(r.S+r.F*n(11)(function(){function e(){}return!(Reflect.construct(function(){},[],e)instanceof e)}),"Reflect",{construct:function(e,t){o(e);var n=arguments.length<3?e:o(arguments[2]);if(e==n){if(void 0!=t)switch(a(t).length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(l.apply(e,r))}var u=n.prototype,c=i.create(s(u)?u:Object.prototype),h=Function.apply.call(e,c,t);return s(h)?h:c}})},function(e,t,n){var i=n(4),r=n(5),o=n(22);r(r.S+r.F*n(11)(function(){Reflect.defineProperty(i.setDesc({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,n){o(e);try{return i.setDesc(e,t,n),!0}catch(r){return!1}}})},function(e,t,n){var i=n(5),r=n(4).getDesc,o=n(22);i(i.S,"Reflect",{deleteProperty:function(e,t){var n=r(o(e),t);return n&&!n.configurable?!1:delete e[t]}})},function(e,t,n){"use strict";var i=n(5),r=n(22),o=function(e){this._t=r(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(103)(o,"Object",function(){var e,t=this,n=t._k;do if(t._i>=n.length)return{value:void 0,done:!0};while(!((e=n[t._i++])in t._t));return{value:e,done:!1}}),i(i.S,"Reflect",{enumerate:function(e){return new o(e)}})},function(e,t,n){function i(e,t){var n,a,u=arguments.length<3?e:arguments[2];return l(e)===u?e[t]:(n=r.getDesc(e,t))?o(n,"value")?n.value:void 0!==n.get?n.get.call(u):void 0:s(a=r.getProto(e))?i(a,t,u):void 0}var r=n(4),o=n(19),a=n(5),s=n(18),l=n(22);a(a.S,"Reflect",{get:i})},function(e,t,n){var i=n(4),r=n(5),o=n(22);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return i.getDesc(o(e),t)}})},function(e,t,n){var i=n(5),r=n(4).getProto,o=n(22);i(i.S,"Reflect",{getPrototypeOf:function(e){return r(o(e))}})},function(e,t,n){var i=n(5);i(i.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var i=n(5),r=n(22),o=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(e){return r(e),o?o(e):!0}})},function(e,t,n){var i=n(5);i(i.S,"Reflect",{ownKeys:n(163)})},function(e,t,n){var i=n(4),r=n(22),o=n(6).Reflect;e.exports=o&&o.ownKeys||function(e){var t=i.getNames(r(e)),n=i.getSymbols;return n?t.concat(n(e)):t}},function(e,t,n){var i=n(5),r=n(22),o=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(e){r(e);try{return o&&o(e),!0}catch(t){return!1}}})},function(e,t,n){function i(e,t,n){var a,c,h=arguments.length<4?e:arguments[3],d=r.getDesc(l(e),t);if(!d){if(u(c=r.getProto(e)))return i(c,t,n,h);d=s(0)}return o(d,"value")?d.writable!==!1&&u(h)?(a=r.getDesc(h,t)||s(0),a.value=n,r.setDesc(h,t,a),!0):!1:void 0===d.set?!1:(d.set.call(h,n),!0)}var r=n(4),o=n(19),a=n(5),s=n(9),l=n(22),u=n(18);a(a.S,"Reflect",{set:i})},function(e,t,n){var i=n(5),r=n(47);r&&i(i.S,"Reflect",{setPrototypeOf:function(e,t){r.check(e,t);try{return r.set(e,t),!0}catch(n){return!1}}})},function(e,t,n){"use strict";var i=n(5),r=n(35)(!0);i(i.P,"Array",{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n(120)("includes")},function(e,t,n){"use strict";var i=n(5),r=n(100)(!0);i(i.P,"String",{at:function(e){return r(this,e)}})},function(e,t,n){"use strict";var i=n(5),r=n(170);i(i.P,"String",{padLeft:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){var i=n(29),r=n(111),o=n(24);e.exports=function(e,t,n,a){var s=String(o(e)),l=s.length,u=void 0===n?" ":String(n),c=i(t);if(l>=c)return s;""==u&&(u=" ");var h=c-l,d=r.call(u,Math.ceil(h/u.length));return d.length>h&&(d=d.slice(0,h)),a?d+s:s+d}},function(e,t,n){"use strict";var i=n(5),r=n(170);i(i.P,"String",{padRight:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){"use strict";n(65)("trimLeft",function(e){return function(){return e(this,1)}})},function(e,t,n){"use strict";n(65)("trimRight",function(e){return function(){return e(this,2)}})},function(e,t,n){var i=n(5),r=n(175)(/[\\^$*+?.()|[\]{}]/g,"\\$&");i(i.S,"RegExp",{escape:function(e){return r(e)}})},function(e,t){e.exports=function(e,t){var n=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,n)}}},function(e,t,n){var i=n(4),r=n(5),o=n(163),a=n(25),s=n(9);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=a(e),l=i.setDesc,u=i.getDesc,c=o(r),h={},d=0;c.length>d;)n=u(r,t=c[d++]),t in h?l(h,t,s(0,n)):h[t]=n;return h}})},function(e,t,n){var i=n(5),r=n(178)(!1);i(i.S,"Object",{values:function(e){return r(e)}})},function(e,t,n){var i=n(4),r=n(25),o=i.isEnum;e.exports=function(e){return function(t){for(var n,a=r(t),s=i.getKeys(a),l=s.length,u=0,c=[];l>u;)o.call(a,n=s[u++])&&c.push(e?[n,a[n]]:a[n]);return c}}},function(e,t,n){var i=n(5),r=n(178)(!0);i(i.S,"Object",{entries:function(e){return r(e)}})},function(e,t,n){var i=n(5);i(i.P,"Map",{toJSON:n(181)("Map")})},function(e,t,n){var i=n(140),r=n(49);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");var t=[];return i(this,!1,t.push,t),t}}},function(e,t,n){var i=n(5);i(i.P,"Set",{toJSON:n(181)("Set")})},function(e,t,n){var i=n(4),r=n(5),o=n(14),a=n(7).Array||Array,s={},l=function(e,t){i.each.call(e.split(","),function(e){void 0==t&&e in a?s[e]=a[e]:e in[]&&(s[e]=o(Function.call,[][e],t))})};l("pop,reverse,shift,keys,values,entries",1),l("indexOf,every,some,forEach,map,filter,find,findIndex,includes",3),l("join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill"),r(r.S,"Array",s)},function(e,t,n){var i=n(6),r=n(5),o=n(21),a=n(185),s=i.navigator,l=!!s&&/MSIE .\./.test(s.userAgent),u=function(e){return l?function(t,n){return e(o(a,[].slice.call(arguments,2),"function"==typeof t?t:Function(t)),n)}:e};r(r.G+r.B+r.F*l,{setTimeout:u(i.setTimeout),setInterval:u(i.setInterval)})},function(e,t,n){"use strict";var i=n(186),r=n(21),o=n(15);e.exports=function(){for(var e=o(this),t=arguments.length,n=Array(t),a=0,s=i._,l=!1;t>a;)(n[a]=arguments[a++])===s&&(l=!0);return function(){var i,o=this,a=arguments,u=a.length,c=0,h=0;if(!l&&!u)return r(e,n,o);if(i=n.slice(),l)for(;t>c;c++)i[c]===s&&(i[c]=a[h++]);for(;u>h;)i.push(a[h++]);return r(e,i,o)}}},function(e,t,n){e.exports=n(6)},function(e,t,n){var i=n(5),r=n(143);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},function(e,t,n){n(119);var i=n(6),r=n(8),o=n(102),a=n(33)("iterator"),s=i.NodeList,l=i.HTMLCollection,u=s&&s.prototype,c=l&&l.prototype,h=o.NodeList=o.HTMLCollection=o.Array;u&&!u[a]&&r(u,a,h),c&&!c[a]&&r(c,a,h)},function(e,t,n){(function(t,n){!function(t){"use strict";function i(e,t,n,i){var r=Object.create((t||o).prototype),a=new p(i||[]);return r._invoke=h(e,n,a),r}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}function o(){}function a(){}function s(){}function l(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function u(e){this.arg=e}function c(e){function t(t,n){var i=e[t](n),r=i.value;return r instanceof u?Promise.resolve(r.arg).then(o,a):Promise.resolve(r).then(function(e){return i.value=e,i})}function i(e,n){function i(){return t(e,n)}return r=r?r.then(i,i):new Promise(function(e){e(i())})}"object"==typeof n&&n.domain&&(t=n.domain.bind(t));var r,o=t.bind(e,"next"),a=t.bind(e,"throw");t.bind(e,"return");this._invoke=i}function h(e,t,n){var i=w;return function(o,a){if(i===A)throw new Error("Generator is already running");if(i===k){if("throw"===o)throw a;return g()}for(;;){var s=n.delegate;if(s){if("return"===o||"throw"===o&&s.iterator[o]===m){n.delegate=null;var l=s.iterator["return"];if(l){var u=r(l,s.iterator,a);if("throw"===u.type){o="throw",a=u.arg;continue}}if("return"===o)continue}var u=r(s.iterator[o],s.iterator,a);if("throw"===u.type){n.delegate=null,o="throw",a=u.arg;continue}o="next",a=m;var c=u.arg;if(!c.done)return i=S,c;n[s.resultName]=c.value,n.next=s.nextLoc,n.delegate=null}if("next"===o)n._sent=a,i===S?n.sent=a:n.sent=m;else if("throw"===o){if(i===w)throw i=k,a;n.dispatchException(a)&&(o="next",a=m)}else"return"===o&&n.abrupt("return",a);i=A;var u=r(e,t,n);if("normal"===u.type){i=n.done?k:S;var c={value:u.arg,done:n.done};if(u.arg!==C)return c;n.delegate&&"next"===o&&(a=m)}else"throw"===u.type&&(i=k,o="throw",a=u.arg)}}}function d(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function f(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function p(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(d,this),this.reset(!0)}function _(e){if(e){var t=e[y];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(v.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=m,r.done=!0,r};return i.next=i}}return{next:g}}function g(){return{value:m,done:!0}}var m,v=Object.prototype.hasOwnProperty,y="function"==typeof Symbol&&Symbol.iterator||"@@iterator",b="object"==typeof e,x=t.regeneratorRuntime;if(x)return void(b&&(e.exports=x));x=t.regeneratorRuntime=b?e.exports:{},x.wrap=i;var w="suspendedStart",S="suspendedYield",A="executing",k="completed",C={},T=s.prototype=o.prototype;a.prototype=T.constructor=s,s.constructor=a,a.displayName="GeneratorFunction",x.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===a||"GeneratorFunction"===(t.displayName||t.name):!1},x.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):e.__proto__=s,e.prototype=Object.create(T),e},x.awrap=function(e){return new u(e)},l(c.prototype),x.async=function(e,t,n,r){var o=new c(i(e,t,n,r));return x.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},l(T),T[y]=function(){return this},T.toString=function(){return"[object Generator]"},x.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var n=t.pop();if(n in e)return i.value=n,i.done=!1,i}return i.done=!0,i}},x.values=_,p.prototype={constructor:p,reset:function(e){if(this.prev=0,this.next=0,this.sent=m,this.done=!1,this.delegate=null,this.tryEntries.forEach(f),!e)for(var t in this)"t"===t.charAt(0)&&v.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=m)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,i){return o.type="throw",o.arg=e,n.next=t,!!i}if(this.done)throw e;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var a=v.call(r,"catchLoc"),s=v.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&v.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?this.next=r.finallyLoc:this.complete(o),C},complete:function(e,t){if("throw"===e.type)throw e.arg;"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t)},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),f(n),C}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;f(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:_(e),resultName:t,nextLoc:n},C}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(t,function(){return this}(),n(190))},function(e,t){function n(){u=!1,a.length?l=a.concat(l):c=-1,l.length&&i()}function i(){if(!u){var e=setTimeout(n);u=!0;for(var t=l.length;t;){for(a=l,l=[];++c<t;)a&&a[c].run();c=-1,t=l.length}a=null,u=!1,clearTimeout(e)}}function r(e,t){this.fun=e,this.array=t}function o(){}var a,s=e.exports={},l=[],u=!1,c=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new r(e,t)),1!==l.length||u||setTimeout(i,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=o,s.addListener=o,s.once=o,s.off=o,s.removeListener=o,s.removeAllListeners=o,s.emit=o,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var r=(n(192),n(231)),o=i(r),a=n(232),s=n(234),l=n(244),u=i(l);n(318);var c=(0,s.applyMiddleware)((0,a.createMiddleware)(u["default"]))(s.createStore),h=o["default"].select("body").append("div").attr("class","fill").style("display","block"),d=(0,a.run)(u["default"],h.node(),c,u["default"].init(4));o["default"].select(document).on("keydown",function(){38===o["default"].event.keyCode?d.goIn():40===o["default"].event.keyCode&&d.goOut()}),window.setTimeout(function(){d.change(0),o["default"].select("#spinner").style("display","none")},3e3)},function(e,t,n){/**
	* @license
	*
	* Escher
	* Author: Zachary King
	*
	* The MIT License (MIT)
	*
	* This software is Copyright © 2015 The Regents of the University of
	* California. All Rights Reserved.
	*
	* Permission is hereby granted, free of charge, to any person obtaining a copy
	* of this software and associated documentation files (the "Software"), to deal
	* in the Software without restriction, including without limitation the rights
	* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	* copies of the Software, and to permit persons to whom the Software is
	* furnished to do so, subject to the following conditions:
	*
	* The above copyright notice and this permission notice shall be included in
	* all copies or substantial portions of the Software.
	*
	* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	* THE SOFTWARE.
	*/
e.exports={version:n(193).version,Builder:n(194),Map:n(209),Behavior:n(211),KeyManager:n(215),DataMenu:n(229),UndoStack:n(214),CobraModel:n(205),utils:n(195),SearchIndex:n(218),Settings:n(224),data_styles:n(206),ui:n(222),"static":n(230),ZoomContainer:n(207)}},function(e,t){e.exports={version:"1.4.0-beta.6",builder_embed:"svg.escher-svg .gene-label,svg.escher-svg .label{text-rendering:optimizelegibility;cursor:default}svg.escher-svg #mouse-node{fill:none}svg.escher-svg #canvas{stroke:#ccc;stroke-width:7px;fill:#fff}svg.escher-svg .resize-rect{fill:#000;opacity:0;stroke:none}svg.escher-svg .label{font-family:sans-serif;font-style:italic;font-weight:700;font-size:8px;fill:#000;stroke:none}svg.escher-svg .reaction-label{font-size:30px;fill:#202078;text-rendering:optimizelegibility}svg.escher-svg .node-label{font-size:20px}svg.escher-svg .gene-label{font-size:18px;fill:#202078}svg.escher-svg .text-label .label,svg.escher-svg .text-label-input{font-size:50px}svg.escher-svg .node-circle{stroke-width:2px}svg.escher-svg .midmarker-circle,svg.escher-svg .multimarker-circle{fill:#fff;fill-opacity:.2;stroke:#323232}svg.escher-svg g.selected .node-circle{stroke-width:6px;stroke:#1471c7}svg.escher-svg g.selected .label{fill:#1471c7}svg.escher-svg .metabolite-circle{stroke:#a24510;fill:#e0865b}svg.escher-svg g.selected .metabolite-circle{stroke:#050200}svg.escher-svg .segment{stroke:#334E75;stroke-width:10px;fill:none}svg.escher-svg .arrowhead{fill:#334E75}svg.escher-svg .stoichiometry-label-rect{fill:#fff;opacity:.5}svg.escher-svg .stoichiometry-label{fill:#334E75;font-size:17px}svg.escher-svg .membrane{fill:none;stroke:#fb0}svg.escher-svg .brush .extent{fill-opacity:.1;fill:#000;stroke:#fff;shape-rendering:crispEdges}svg.escher-svg #brush-container .background{fill:none}svg.escher-svg .bezier-circle{fill:#fff}svg.escher-svg .bezier-circle.b1{stroke:red}svg.escher-svg .bezier-circle.b2{stroke:#00f}svg.escher-svg .connect-line{stroke:#c8c8c8}svg.escher-svg .direction-arrow{stroke:#000;stroke-width:1px;fill:#fff;opacity:.3}svg.escher-svg .start-reaction-cursor{cursor:pointer}svg.escher-svg .start-reaction-target{stroke:#646464;fill:none;opacity:.5}svg.escher-svg .rotation-center-line{stroke:red;stroke-width:5px}svg.escher-svg .highlight{fill:#D97000;text-decoration:underline}svg.escher-svg .cursor-grab{cursor:grab;cursor:-webkit-grab}svg.escher-svg .cursor-grabbing{cursor:grabbing;cursor:-webkit-grabbing}svg.escher-svg .edit-text-cursor{cursor:text}"}},function(e,t,n){function i(e,t,n,i,r){if(i||(i=d3.select("body").append("div")),r||(r={}),n||(n=z),this.map_data=e,this.model_data=t,this.embedded_css=n,this.selection=i,this.selection.datum(this),this.options=k.set_options(r,{menu:"all",scroll_behavior:"pan",use_3d_transform:!k.check_browser("safari"),enable_editing:!0,enable_keys:!0,enable_search:!0,fill_screen:!1,zoom_to_element:null,full_screen_button:!1,ignore_bootstrap:!1,starting_reaction:null,never_ask_before_quit:!1,unique_map_id:null,primary_metabolite_radius:20,secondary_metabolite_radius:10,marker_radius:5,gene_font_size:18,hide_secondary_metabolites:!1,show_gene_reaction_rules:!1,hide_all_labels:!1,reaction_data:null,reaction_styles:["color","size","text"],reaction_compare_style:"log2_fold",reaction_scale:[{type:"min",color:"#c8c8c8",size:12},{type:"median",color:"#9696ff",size:20},{type:"max",color:"#ff0000",size:25}],reaction_no_data_color:"#dcdcdc",reaction_no_data_size:8,gene_data:null,and_method_in_gene_reaction_rule:"mean",metabolite_data:null,metabolite_styles:["color","size","text"],metabolite_compare_style:"log2_fold",metabolite_scale:[{type:"min",color:"#fffaf0",size:20},{type:"median",color:"#f1c470",size:30},{type:"max",color:"#800000",size:40}],metabolite_no_data_color:"#ffffff",metabolite_no_data_size:10,identifiers_on_map:"bigg_id",highlight_missing:!1,allow_building_duplicate_reactions:!1,cofactors:["atp","adp","nad","nadh","nadp","nadph","gtp","gdp","h","coa","ump","h20","ppi"],first_load_callback:null},{primary_metabolite_radius:!0,secondary_metabolite_radius:!0,marker_radius:!0,gene_font_size:!0,reaction_no_data_size:!0,metabolite_no_data_size:!0}),k.check_for_parent_tag(this.selection,"svg"))throw new Error("Builder cannot be placed within an svg node becuase UI elements are html-based.");var o=function(e,t){this.options[e]=t}.bind(this),a=function(e){return this.options[e]}.bind(this),s=["hide_secondary_metabolites","show_gene_reaction_rules","hide_all_labels","scroll_behavior","reaction_styles","reaction_compare_style","reaction_scale","reaction_no_data_color","reaction_no_data_size","and_method_in_gene_reaction_rule","metabolite_styles","metabolite_compare_style","metabolite_scale","metabolite_no_data_color","metabolite_no_data_size","identifiers_on_map","highlight_missing","allow_building_duplicate_reactions"];this.settings=new D(o,a,s),["reaction_scale","metabolite_scale"].forEach(function(e){this.settings.streams[e].onValue(function(t){["min","max"].forEach(function(n){var i=t.reduce(function(e,t){return e||t.type==n},!1);i||(t.push({type:n,color:"#ffffff",size:10}),this.settings.set_conditional(e,t))}.bind(this))}.bind(this))}.bind(this)),this.callback_manager=R(),null!==this.options.first_load_callback&&this.callback_manager.set("first_load",this.options.first_load_callback),this.load_model(this.model_data,!1),this.load_map(this.map_data,!1),this._update_data(!0,!0),this.settings.status_bus.onValue(function(e){if("accepted"===e){if(this._update_data(!0,!0,["reaction","metabolite"],!1),null!==this.zoom_container){var t=this.settings.get_option("scroll_behavior");this.zoom_container.set_scroll_behavior(t)}null!==this.map&&(this.map.draw_all_nodes(!1),this.map.draw_all_reactions(!0,!1))}}.bind(this)),this.callback_manager.run("first_load",this)}function r(e,t){void 0===t&&(t=!0),null===e?this.cobra_model=null:this.cobra_model=M.from_cobra_json(e),this.map&&(this.map.cobra_model=this.cobra_model,t&&this._update_data(!0,!1),this.settings.get_option("highlight_missing")&&this.map.draw_all_reactions(!1,!1)),this.callback_manager.run("load_model",null,e,t)}function o(e,t){void 0===t&&(t=!0);k.remove_child_nodes(this.selection),this.zoom_container=new T(this.selection,this.options.scroll_behavior,this.options.use_3d_transform,this.options.fill_screen);var n=this.zoom_container.zoomed_sel,i=this.zoom_container.svg;null!==e?this.map=E.from_data(e,i,this.embedded_css,n,this.zoom_container,this.settings,this.cobra_model,this.options.enable_search):this.map=new E(i,this.embedded_css,n,this.zoom_container,this.settings,this.cobra_model,null,this.options.enable_search),this.zoom_container.callback_manager.set("svg_start",function(){this.map.set_status("Drawing ...")}.bind(this)),this.zoom_container.callback_manager.set("svg_finish",function(){this.map.set_status("")}.bind(this)),t&&this._update_data(!1,!0),this.build_input=C(this.selection,this.map,this.zoom_container,this.settings),this.text_edit_input=N(this.selection,this.map,this.zoom_container),this.brush=new L(n,!1,this.map,".canvas-group"),this.map.canvas.callback_manager.set("resize",function(){this.brush.toggle(!0)}.bind(this)),this._setup_modes(this.map,this.brush,this.zoom_container);var r=this.selection.append("div").attr("class","search-menu-container").append("div").attr("class","search-menu-container-inline"),o=r.append("div"),a=r.append("div"),s=this.selection.append("div");this.search_bar=P(a,this.map.search_index,this.map),this.search_bar.callback_manager.set("show",function(){this.settings_bar.toggle(!1)}.bind(this));var l=this.selection.append("div");this.settings_bar=I(l,this.settings,this.map,function(e,t){var n=this.options[e+"_styles"];if(t&&-1==n.indexOf("abs"))n.push("abs");else if(!t){var i=n.indexOf("abs");-1!=i&&(this.options[e+"_styles"]=n.slice(0,i).concat(n.slice(i+1)))}this._update_data(!1,!0,e)}.bind(this)),this.settings_bar.callback_manager.set("show",function(){this.search_bar.toggle(!1)}.bind(this));var u=this._get_keys(this.map,this.zoom_container,this.search_bar,this.settings_bar,this.options.enable_editing,this.options.full_screen_button);if(this.map.key_manager.assigned_keys=u,this.map.key_manager.input_list=[this.build_input,this.search_bar,this.settings_bar,this.text_edit_input],this.map.key_manager.update(),this.map.key_manager.toggle(this.options.enable_keys),"all"===this.options.menu&&(this.options.ignore_bootstrap?console.error("Cannot create the dropdown menus if ignore_bootstrap = true"):this._set_up_menu(o,this.map,this.map.key_manager,u,this.options.enable_editing,this.options.enable_keys,this.options.full_screen_button)),this._set_up_button_panel(s,u,this.options.enable_editing,this.options.enable_keys,this.options.full_screen_button,this.options.menu,this.options.ignore_bootstrap),this.options.zoom_to_element){var c=this.options.zoom_to_element.type,h=this.options.zoom_to_element.id;if("undefined"==typeof c||-1==["reaction","node"].indexOf(c))throw new Error('zoom_to_element type must be "reaction" or "node"');if("undefined"==typeof h)throw new Error("zoom_to_element must include id");"reaction"==c?this.map.zoom_to_reaction(h):"node"==c&&this.map.zoom_to_node(h)}else if(null!==e)this.map.zoom_extent_canvas();else if(null!==this.options.starting_reaction&&null!==this.cobra_model){var d=this.zoom_container.get_size(),f={x:d.width/2,y:d.height/4};this.map.new_reaction_from_scratch(this.options.starting_reaction,f,90),this.map.zoom_extent_nodes()}else this.map.zoom_extent_canvas();this._setup_status(this.selection,this.map);this._setup_quick_jump(this.selection),this.options.enable_editing?this.zoom_mode():this.view_mode(),this.options.enable_editing&&this._setup_confirm_before_exit(),this.map.draw_everything()}function a(e){this.search_bar.toggle(!1),this.build_input.toggle("build"==e),this.build_input.direction_arrow.toggle("build"==e),"all"==this.options.menu&&this.options.enable_editing&&this._toggle_direction_buttons("build"==e),this.brush.toggle("brush"==e),this.zoom_container.toggle_pan_drag("zoom"==e||"view"==e),this.map.canvas.toggle_resize("zoom"==e||"brush"==e),"rotate"==e?(this.map.behavior.toggle_selectable_drag(!1),this.map.behavior.toggle_rotation_mode(!0)):(this.map.behavior.toggle_rotation_mode("rotate"==e),this.map.behavior.toggle_selectable_drag("brush"==e)),this.map.behavior.toggle_selectable_click("build"==e||"brush"==e),this.map.behavior.toggle_label_drag("brush"==e),this.map.behavior.toggle_label_mousedown("brush"==e),this.map.behavior.toggle_text_label_edit("text"==e),this.map.behavior.toggle_bezier_drag("brush"==e),("view"==e||"text"==e)&&this.map.select_none(),"rotate"==e&&this.map.deselect_text_labels(),this.map.draw_everything()}function s(){this.callback_manager.run("view_mode"),this._set_mode("view")}function l(){this.callback_manager.run("build_mode"),this._set_mode("build")}function u(){this.callback_manager.run("brush_mode"),this._set_mode("brush")}function c(){this.callback_manager.run("zoom_mode"),this._set_mode("zoom")}function h(){this.callback_manager.run("rotate_mode"),this._set_mode("rotate")}function d(){this.callback_manager.run("text_mode"),this._set_mode("text")}function f(e){this.options.reaction_data=e,this._update_data(!0,!0,"reaction"),this.map.set_status("")}function p(e,t){t&&this.settings.set_conditional("show_gene_reaction_rules",!1),this.options.gene_data=e,this._update_data(!0,!0,"reaction"),this.map.set_status("")}function _(e){this.options.metabolite_data=e,this._update_data(!0,!0,"metabolite"),this.map.set_status("")}function g(e,t,n,i){function r(e,t,n){var i={};return null!==t&&k.extend(i,t.reactions),null!==n&&k.extend(i,n.reactions,!0),B.import_and_check(e,"gene_data",i)}void 0===n&&(n=["reaction","metabolite"]),void 0===i&&(i=!0);var o,a,s,l=-1!=n.indexOf("metabolite"),u=-1!=n.indexOf("reaction");l&&t&&null!==this.map&&(o=B.import_and_check(this.options.metabolite_data,"metabolite_data"),this.map.apply_metabolite_data_to_map(o),i&&this.map.draw_all_nodes(!1)),u&&(null!==this.options.reaction_data&&t&&null!==this.map?(a=B.import_and_check(this.options.reaction_data,"reaction_data"),this.map.apply_reaction_data_to_map(a),i&&this.map.draw_all_reactions(!1,!1)):null!==this.options.gene_data&&t&&null!==this.map?(s=r(this.options.gene_data,this.cobra_model,this.map),this.map.apply_gene_data_to_map(s),i&&this.map.draw_all_reactions(!1,!1)):t&&null!==this.map&&(this.map.apply_reaction_data_to_map(null),i&&this.map.draw_all_reactions(!1,!1))),this.update_model_timer&&clearTimeout(this.update_model_timer);var c=5;this.update_model_timer=setTimeout(function(){l&&e&&null!==this.cobra_model&&(o||(o=B.import_and_check(this.options.metabolite_data,"metabolite_data")),this.cobra_model.apply_metabolite_data(o,this.options.metabolite_styles,this.options.metabolite_compare_style)),u&&(null!==this.options.reaction_data&&e&&null!==this.cobra_model?(a||(a=B.import_and_check(this.options.reaction_data,"reaction_data")),this.cobra_model.apply_reaction_data(a,this.options.reaction_styles,this.options.reaction_compare_style)):null!==this.options.gene_data&&e&&null!==this.cobra_model?(s||(s=r(this.options.gene_data,this.cobra_model,this.map)),this.cobra_model.apply_gene_data(s,this.options.reaction_styles,this.options.identifiers_on_map,this.options.reaction_compare_style,this.options.and_method_in_gene_reaction_rule)):e&&null!==this.cobra_model&&this.cobra_model.apply_reaction_data(null,this.options.reaction_styles,this.options.reaction_compare_style)),this.callback_manager.run("update_data",null,e,t,n,i)}.bind(this),c)}function m(e,t,n,i,r,o,a,s){function l(e,t){function n(e){if(!("map_id"in e[0]&&"reactions"in e[1]&&"nodes"in e[1]&&"canvas"in e[1]))throw new Error("Bad map data.")}if(e)return console.warn(e),void this.map.set_status("Error loading map: "+e,2e3);try{n(t),this.load_map(t),this.map.set_status("Loaded map "+t[0].map_name,3e3)}catch(i){console.warn(i),this.map.set_status("Error loading map: "+i,2e3)}}function u(e,t){if(e)return console.warn(e),void this.map.set_status("Error loading model: "+e,2e3);try{this.load_model(t,!0),this.build_input.toggle(!1),"id"in t?this.map.set_status("Loaded model "+t.id,3e3):this.map.set_status("Loaded model (no model id)",3e3)}catch(n){console.warn(n),this.map.set_status("Error loading model: "+n,2e3)}}function c(e,t){return e?(console.warn(e),void this.map.set_status("Could not parse file as JSON or CSV",2e3)):(null!==t&&this.set_gene_data(null),void this.set_reaction_data(t))}function h(e,t){return e?(console.warn(e),void this.map.set_status("Could not parse file as JSON or CSV",2e3)):void this.set_metabolite_data(t)}function d(e,t){return e?(console.warn(e),void this.map.set_status("Could not parse file as JSON or CSV",2e3)):(null!==t&&this.set_reaction_data(null),this.settings.set_conditional("show_gene_reaction_rules",!0),void this.set_gene_data(t))}var f=e.attr("id","menu").append("ul").attr("class","nav nav-pills");O.dropdown_menu(f,"Map").button({key:i.save,text:"Save map JSON",key_text:o?" (Ctrl+S)":null}).button({text:"Load map JSON",key_text:o?" (Ctrl+O)":null,input:{assign:n.assigned_keys.load,key:"fn",fn:l.bind(this),pre_fn:function(){t.set_status("Loading map ...")},failure_fn:function(){t.set_status("")}}}).button({key:i.save_svg,text:"Export as SVG",key_text:o?" (Ctrl+Shift+S)":null}).button({key:i.clear_map,text:"Clear map"});var p=O.dropdown_menu(f,"Model").button({text:"Load COBRA model JSON",key_text:o?" (Ctrl+M)":null,input:{assign:n.assigned_keys.load_model,key:"fn",fn:u.bind(this),pre_fn:function(){t.set_status("Loading model ...")},failure_fn:function(){t.set_status("")}}}).button({id:"convert_map",key:i.convert_map,text:"Update names and gene reaction rules using model"}).button({id:"clear_model",key:i.clear_model,text:"Clear model"}),_=function(){p.dropdown.selectAll("li").classed("escher-disabled",function(e){return"clear_model"!=e.id&&"convert_map"!=e.id||null!==this.cobra_model?null:!0}.bind(this))}.bind(this);_(),this.callback_manager.set("load_model",_);var g=O.dropdown_menu(f,"Data").button({input:{assign:n.assigned_keys.load_reaction_data,key:"fn",fn:c.bind(this),accept_csv:!0,pre_fn:function(){t.set_status("Loading reaction data ...")},failure_fn:function(){t.set_status("")}},text:"Load reaction data"}).button({key:i.clear_reaction_data,text:"Clear reaction data"}).divider().button({input:{fn:d.bind(this),accept_csv:!0,pre_fn:function(){t.set_status("Loading gene data ...")},failure_fn:function(){t.set_status("")}},text:"Load gene data"}).button({key:i.clear_gene_data,text:"Clear gene data"}).divider().button({input:{fn:h.bind(this),accept_csv:!0,pre_fn:function(){t.set_status("Loading metabolite data ...")},failure_fn:function(){t.set_status("")}},text:"Load metabolite data"}).button({key:i.clear_metabolite_data,text:"Clear metabolite data"}),m=function(){g.dropdown.selectAll("li").classed("escher-disabled",function(e){return e?"Clear reaction data"==e.text&&null===this.options.reaction_data?!0:"Clear gene data"==e.text&&null===this.options.gene_data?!0:"Clear metabolite data"==e.text&&null===this.options.metabolite_data?!0:null:null}.bind(this))}.bind(this);m(),this.callback_manager.set("update_data",m);var v=O.dropdown_menu(f,"Edit",!0);r?v.button({key:i.zoom_mode,id:"zoom-mode-menu-button",text:"Pan mode",key_text:o?" (Z)":null}).button({key:i.brush_mode,id:"brush-mode-menu-button",text:"Select mode",key_text:o?" (V)":null}).button({key:i.build_mode,id:"build-mode-menu-button",text:"Add reaction mode",key_text:o?" (N)":null}).button({key:i.rotate_mode,id:"rotate-mode-menu-button",text:"Rotate mode",key_text:o?" (R)":null}).button({key:i.text_mode,id:"text-mode-menu-button",text:"Text mode",key_text:o?" (T)":null}).divider().button({key:i["delete"],text:"Delete",key_text:o?" (Del)":null}).button({key:i.undo,text:"Undo",key_text:o?" (Ctrl+Z)":null}).button({key:i.redo,text:"Redo",key_text:o?" (Ctrl+Shift+Z)":null}).button({key:i.toggle_primary,text:"Toggle primary/secondary",key_text:o?" (P)":null}).button({key:i.cycle_primary,text:"Rotate reactant locations",key_text:o?" (C)":null}).button({key:i.select_all,text:"Select all",key_text:o?" (Ctrl+A)":null}).button({key:i.select_none,text:"Select none",key_text:o?" (Ctrl+Shift+A)":null}).button({key:i.invert_selection,text:"Invert selection"}):v.button({key:i.view_mode,id:"view-mode-menu-button",text:"View mode"});var y=O.dropdown_menu(f,"View",!0).button({key:i.zoom_in,text:"Zoom in",key_text:o?" (Ctrl and +)":null}).button({key:i.zoom_out,text:"Zoom out",key_text:o?" (Ctrl and -)":null}).button({key:i.extent_nodes,text:"Zoom to nodes",key_text:o?" (Ctrl+0)":null}).button({key:i.extent_canvas,text:"Zoom to canvas",key_text:o?" (Ctrl+1)":null}).button({key:i.search,text:"Find",key_text:o?" (Ctrl+F)":null});a&&y.button({key:i.full_screen,text:"Full screen",key_text:o?" (Ctrl+2)":null}),r&&(y.button({key:i.toggle_beziers,id:"bezier-button",text:"Show control points",key_text:o?" (B)":null}),t.callback_manager.set("toggle_beziers.button",function(e){f.select("#bezier-button").select(".dropdown-button-text").text((e?"Hide":"Show")+" control points"+(o?" (B)":""))})),y.divider().button({key:i.show_settings,text:"Settings",key_text:o?" (Ctrl+,)":null}),f.append("a").attr("class","help-button").attr("target","#").attr("href","https://escher.readthedocs.org").text("?");var b=function(e){$(this.selection.node()).find("#"+e).button("toggle");var t=["zoom-mode-menu-button","brush-mode-menu-button","build-mode-menu-button","rotate-mode-menu-button","view-mode-menu-button","text-mode-menu-button"];t.forEach(function(t){var n=t.replace("-menu","");this.selection.select("#"+t).select("span").classed("glyphicon",n==e).classed("glyphicon-ok",n==e)}.bind(this))};this.callback_manager.set("zoom_mode",b.bind(this,"zoom-mode-button")),this.callback_manager.set("brush_mode",b.bind(this,"brush-mode-button")),this.callback_manager.set("build_mode",b.bind(this,"build-mode-button")),this.callback_manager.set("rotate_mode",b.bind(this,"rotate-mode-button")),this.callback_manager.set("view_mode",b.bind(this,"view-mode-button")),this.callback_manager.set("text_mode",b.bind(this,"text-mode-button"))}function v(e,t,n,i,r,o,a){var s=e.append("ul").attr("class","nav nav-pills nav-stacked").attr("id","button-panel");if(O.individual_button(s.append("li"),{key:t.zoom_in,text:"+",icon:"glyphicon glyphicon-plus-sign",tooltip:"Zoom in",key_text:i?" (Ctrl and +)":null,ignore_bootstrap:a}),O.individual_button(s.append("li"),{key:t.zoom_out,text:"–",icon:"glyphicon glyphicon-minus-sign",tooltip:"Zoom out",key_text:i?" (Ctrl and -)":null,ignore_bootstrap:a}),O.individual_button(s.append("li"),{key:t.extent_canvas,text:"↔",icon:"glyphicon glyphicon-resize-full",tooltip:"Zoom to canvas",key_text:i?" (Ctrl+1)":null,ignore_bootstrap:a}),r&&O.individual_button(s.append("li"),{key:t.full_screen,text:"▣",icon:"glyphicon glyphicon-fullscreen",tooltip:"Full screen",key_text:i?" (Ctrl+2)":null,ignore_bootstrap:a}),n&&"all"===o){O.radio_button_group(s.append("li")).button({key:t.zoom_mode,id:"zoom-mode-button",text:"Z",icon:"glyphicon glyphicon-move",tooltip:"Pan mode",key_text:i?" (Z)":null,ignore_bootstrap:a}).button({key:t.brush_mode,text:"V",id:"brush-mode-button",icon:"glyphicon glyphicon-hand-up",tooltip:"Select mode",key_text:i?" (V)":null,ignore_bootstrap:a}).button({key:t.build_mode,text:"N",id:"build-mode-button",icon:"glyphicon glyphicon-plus",tooltip:"Add reaction mode",key_text:i?" (N)":null,ignore_bootstrap:a}).button({key:t.rotate_mode,text:"R",id:"rotate-mode-button",icon:"glyphicon glyphicon-repeat",tooltip:"Rotate mode",key_text:i?" (R)":null,ignore_bootstrap:a}).button({key:t.text_mode,text:"T",id:"text-mode-button",icon:"glyphicon glyphicon-font",tooltip:"Text mode",key_text:i?" (T)":null,ignore_bootstrap:a}),this.direction_buttons=s.append("li");O.button_group(this.direction_buttons).button({key:t.direction_arrow_left,text:"←",icon:"glyphicon glyphicon-arrow-left",tooltip:"Direction arrow (←)",ignore_bootstrap:a}).button({key:t.direction_arrow_right,text:"→",icon:"glyphicon glyphicon-arrow-right",tooltip:"Direction arrow (→)",ignore_bootstrap:a}).button({key:t.direction_arrow_up,text:"↑",icon:"glyphicon glyphicon-arrow-up",tooltip:"Direction arrow (↑)",ignore_bootstrap:a}).button({key:t.direction_arrow_down,text:"↓",icon:"glyphicon glyphicon-arrow-down",tooltip:"Direction arrow (↓)",ignore_bootstrap:a})}}function y(e){H.isUndefined(e)&&(e="block"===!this.direction_buttons.style("display")),this.direction_buttons.style("display",e?"block":"none")}function b(e,t){var n=e.append("div").attr("id","status");return t.callback_manager.set("set_status",function(e){n.html(e)}),n}function x(e){var t=function(e,t,n){if(this.options.enable_editing&&!this.options.never_ask_before_quit&&!confirm("You will lose any unsaved changes.\n\nAre you sure you want to switch maps?"))return void(n&&n(!1));this.map.set_status("Loading map "+e+" ...");var i=k.name_to_url(e,t);d3.json(i,function(e,t){return e?(console.warn("Could not load data: "+e),this.map.set_status("Could not load map",2e3),void(n&&n(!1))):(n&&n(!0),this.load_map(t),void this.map.set_status(""))}.bind(this))}.bind(this);this.quick_jump=F(e,t)}function w(e,t,n){var i={};e.callback_manager.set("start_rotation",function(){i.brush=t.enabled,t.toggle(!1),i.zoom=n.zoom_on,n.toggle_pan_drag(!1),i.selectable_mousedown=null!=e.behavior.selectable_mousedown,e.behavior.toggle_selectable_click(!1),i.label_mousedown=null!=e.behavior.label_mousedown,e.behavior.toggle_label_mousedown(!1)}),e.callback_manager.set("end_rotation",function(){t.toggle(i.brush),n.toggle_pan_drag(i.zoom),e.behavior.toggle_selectable_click(i.selectable_mousedown),e.behavior.toggle_label_mousedown(i.label_mousedown),i={}})}function S(e,t,n,i,r,o){var a={save:{key:"ctrl+s",target:e,fn:e.save},save_svg:{key:"ctrl+shift+s",target:e,fn:e.save_svg},load:{key:"ctrl+o",fn:null},convert_map:{target:e,fn:e.convert_map},clear_map:{target:e,fn:e.clear_map},load_model:{key:"ctrl+m",fn:null},clear_model:{fn:this.load_model.bind(this,null,!0)},load_reaction_data:{fn:null},clear_reaction_data:{target:this,fn:function(){this.set_reaction_data(null)}},load_metabolite_data:{fn:null},clear_metabolite_data:{target:this,fn:function(){this.set_metabolite_data(null)}},load_gene_data:{fn:null},clear_gene_data:{target:this,fn:function(){this.set_gene_data(null,!0)}},zoom_in:{key:"ctrl+=",target:t,fn:t.zoom_in},zoom_out:{key:"ctrl+-",target:t,fn:t.zoom_out},extent_nodes:{key:"ctrl+0",target:e,fn:e.zoom_extent_nodes},extent_canvas:{key:"ctrl+1",target:e,fn:e.zoom_extent_canvas},search:{key:"ctrl+f",fn:n.toggle.bind(n,!0)},view_mode:{target:this,fn:this.view_mode,ignore_with_input:!0},show_settings:{key:"ctrl+,",target:i,fn:i.toggle}};return o&&k.extend(a,{full_screen:{key:"ctrl+2",target:e,fn:e.full_screen}}),r&&k.extend(a,{build_mode:{key:"n",target:this,fn:this.build_mode,ignore_with_input:!0},zoom_mode:{key:"z",target:this,fn:this.zoom_mode,ignore_with_input:!0},brush_mode:{key:"v",target:this,fn:this.brush_mode,ignore_with_input:!0},rotate_mode:{key:"r",target:this,fn:this.rotate_mode,ignore_with_input:!0},text_mode:{key:"t",target:this,fn:this.text_mode,ignore_with_input:!0},toggle_beziers:{key:"b",target:e,fn:e.toggle_beziers,ignore_with_input:!0},"delete":{key:"ctrl+backspace",target:e,fn:e.delete_selected,ignore_with_input:!0},delete_del:{key:"del",target:e,fn:e.delete_selected,ignore_with_input:!0},toggle_primary:{key:"p",target:e,fn:e.toggle_selected_node_primary,ignore_with_input:!0},cycle_primary:{key:"c",target:e,fn:e.cycle_primary_node,ignore_with_input:!0},direction_arrow_right:{key:"right",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.right,ignore_with_input:!0},direction_arrow_down:{key:"down",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.down,ignore_with_input:!0},direction_arrow_left:{key:"left",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.left,ignore_with_input:!0},direction_arrow_up:{key:"up",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.up,ignore_with_input:!0},undo:{key:"ctrl+z",target:e.undo_stack,fn:e.undo_stack.undo},redo:{key:"ctrl+shift+z",target:e.undo_stack,fn:e.undo_stack.redo},select_all:{key:"ctrl+a",target:e,fn:e.select_all},select_none:{key:"ctrl+shift+a",target:e,fn:e.select_none},invert_selection:{target:e,fn:e.invert_selection}}),a}function A(){window.onbeforeunload=function(e){return e=e||window.event,this.options.never_ask_before_quit?null:"You will lose any unsaved changes."}.bind(this)}var k=n(195),C=n(201),T=n(207),E=n(209),M=n(205),L=n(221),R=n(208),O=n(222),P=n(223),D=n(224),I=n(225),N=n(227),F=n(228),B=n(206),z=n(193).builder_embed,H=n(197),q=k.make_class();q.prototype={init:i,load_map:o,load_model:r,_set_mode:a,view_mode:s,build_mode:l,brush_mode:u,zoom_mode:c,rotate_mode:h,text_mode:d,set_reaction_data:f,set_metabolite_data:_,set_gene_data:p,_update_data:g,_toggle_direction_buttons:y,_set_up_menu:m,_set_up_button_panel:v,_setup_status:b,_setup_quick_jump:x,_setup_modes:w,_get_keys:S,_setup_confirm_before_exit:A},e.exports=q},function(e,t,n){function i(){try{!!new Blob}catch(e){alert("Blob not supported")}}function r(e,t,n){if(void 0===e||null===e)return t;var i={};for(var r in t){var o=r in e&&null!==e[r]&&void 0!==e[r],a=o?e[r]:t[r];n&&r in n&&(a=parseFloat(a),isNaN(a)&&(o?(console.warn("Bad float for option "+r),a=parseFloat(t[r]),isNaN(a)&&(console.warn("Bad float for default "+r),a=null)):(console.warn("Bad float for default "+r),a=null))),i[r]=a}return i}function o(e){for(var t=e.node();t.hasChildNodes();)t.removeChild(t.lastChild)}function a(e,t){var n="";return e&&d3.text(e,function(e,i){e&&console.warn(e),n=i,t(n)}),!1}function s(e,t,n,i){function r(e,t){return-1!==e.indexOf(t,e.length-t.length)}return i?(t&&console.warn("File "+t+" overridden by value."),void n.call(e,null,i)):t?void(r(t,"json")?d3.json(t,function(t,i){n.call(e,t,i)}):r(t,"css")?d3.text(t,function(t,i){n.call(e,t,i)}):n.call(e,"Unrecognized file type",null)):void n.call(e,"No filename",null)}function l(e,t,n){0===t.length&&n.call(e);for(var i=-1,r=t.length;++i<t.length;)s(e,t[i].file,function(t,i){this.call(e,t,i),--r||n.call(e)}.bind(t[i].callback),t[i].value)}function u(){var e,t=function(n){if(!(this instanceof t)){e=!0;var i=new t(arguments);return e=!1,i}"function"==typeof this.init&&this.init.apply(this,e?n:arguments)};return t}function c(e,t){e.select("defs").remove();var n=e.append("defs"),i=n.node();return i.parentNode.insertBefore(i,i.parentNode.firstChild),n.append("style").attr("type","text/css").text(t),n}function h(e,t,n,i,r,o,a,s){var l={};for(var u in i)void 0===i[u]?console.warn("Undefined value for id "+u+" in object. Ignoring."):l[u]=i[u];var c=e.select(t).selectAll(n).data(p(l,r),function(e){return e[r]});o&&c.enter().call(o),a&&c.call(a),s&&c.exit().call(s)}function d(e,t,n,i,r,o,a){var s=e.selectAll(t).data(function(e){return p(e[n],i)},function(e){return e[i]});r&&s.enter().call(r),o&&s.call(o),a&&s.exit().call(a)}function f(e,t){var n=[];for(var i in e){var r=m(e[i]);r[t]=i,n.push(r)}return n}function p(e,t){var n=[];for(var i in e){var r=e[i];r[t]=i,n.push(r)}return n}function _(e,t){if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var n=0,i=e.length;i>n;n++)if(e[n]!=t[n])return!1;return!0}function g(e){for(var t={},n=0,i=e.length;i>n;n++)for(var r=e[n],o=Object.keys(r),a=0,s=o.length;s>a;a++){var l=o[a];if(l in t)t[l][n]=r[l];else{for(var u=[],c=0;i>c;c++)u[c]=null;u[n]=r[l],t[l]=u}}return t}function m(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Array){for(var t=[],n=0,i=e.length;i>n;n++)t[n]=m(e[n]);return t}if(e instanceof Object){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=m(e[r]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")}function v(e,t,n){void 0===n&&(n=!1);for(var i in t){if(i in e&&!n)throw new Error("Attribute "+i+" already in object.");e[i]=t[i]}}function y(e){var t=[];return e.forEach(function(e){e.forEach(function(e){t.indexOf(e)<0&&t.push(e)})}),t}function b(e){for(var t=[],n=0,i=e.length;i>n;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}function x(e,t,n){var i;return function(){var r=this,o=arguments,a=function(){i=null,n||e.apply(r,o)},s=n&&!i;clearTimeout(i),i=setTimeout(a,t),s&&e.apply(r,o)}}function w(e,t){for(var n={},i=-1;++i<t.length;)n[t[i]]=m(e[t[i]]);return t.length!=Object.keys(n).length&&console.warn("did not find correct reaction subset"),n}function S(e,t){for(var n={},i=-1;++i<t.length;)n[t[i]]=e[t[i]];return t.length!=Object.keys(n).length&&console.warn("did not find correct reaction subset"),n}function A(e,t){return null===e||null===t||void 0===e||void 0===t?null:{x:e.x+t.x,y:e.y+t.y}}function k(e,t){return null===e||null===t||void 0===e||void 0===t?null:{x:e.x-t.x,y:e.y-t.y}}function C(e,t){return{x:e.x*t,y:e.y*t}}function T(e,t){i();var n=JSON.stringify(e),r=new Blob([n],{type:"application/json"});ee(r,t+".json")}function E(e,t,n,i){window.File&&window.FileReader&&window.FileList&&window.Blob||t("The File APIs are not fully supported in this browser.",null);var r=new window.FileReader;if(r.onload=function(e){var n,i=e.target.result;try{n=JSON.parse(i)}catch(r){return void t(r,null)}t(null,n)},void 0!==n&&null!==n)try{n()}catch(o){console.warn(o)}r.onabort=function(e){try{i()}catch(t){console.warn(t)}},r.onerror=function(e){try{i()}catch(t){console.warn(t)}},r.readAsText(e)}function M(e,t,n,i,r,o){var a=function(e){var i,r,o=e.target.result;try{i=JSON.parse(o)}catch(a){r="JSON error: "+a;try{i=t(d3.csv.parseRows(o))}catch(a){return void n(r+"\nCSV error: "+a,null)}}n(null,i)};if(void 0!==o&&null!==o)return console.warn("Debugging load_json_or_csv"),a(o);window.File&&window.FileReader&&window.FileList&&window.Blob||n("The File APIs are not fully supported in this browser.",null);var s=new window.FileReader;if(void 0!==i&&null!==i)try{i()}catch(l){console.warn(l)}s.onabort=function(e){try{r()}catch(t){console.warn(t);
}},s.onerror=function(e){try{r()}catch(t){console.warn(t)}},s.onload=a,s.readAsText(e)}function L(e,t,n){i();var r=(new XMLSerializer).serializeToString(t.node());n&&(r=J.xml(r)),r='<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"\n "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n'+r;var o=new Blob([r],{type:"image/svg+xml"});ee(o,e+".svg")}function R(e,t,n){var i=function(e){return O(e,t,n)};return e.map(i)}function O(e,t,n){var i=Math.cos(-t)*(e.x-n.x)+Math.sin(-t)*(e.y-n.y)+n.x-e.x,r=-Math.sin(-t)*(e.x-n.x)+Math.cos(-t)*(e.y-n.y)+n.y-e.y;return{x:i,y:r}}function P(e){var t=e[1].x-e[0].x,n=e[1].y-e[0].y;return 0==t&&n>=0?Math.PI/2:0==t&&0>n?3*Math.PI/2:t>=0&&n>=0?Math.atan(n/t):t>=0?Math.atan(n/t)+2*Math.PI:Math.atan(n/t)+Math.PI}function D(e){return 180*e/Math.PI}function I(e,t,n){var i=Math.atan2(t.x-n.x,n.y-t.y),r=Math.atan2(t.x-n.x+e.x,n.y-t.y-e.y),o=r-i;return o}function N(e,t){return Math.sqrt(Math.pow(t.y-e.y,2)+Math.pow(t.x-e.x,2))}function F(e,t){t.map(function(n,i){void 0===e[i]&&console.error("Argument is undefined: "+String(t[i]))})}function B(e,t){return e+"_"+t}function z(e){function t(e){var t=/(.*)_([a-z0-9]{1,2})$/,n=t.exec(e);return null===n?null:n.slice(1,3)}var n=t(e);return null===n&&(n=[e,null]),n}function H(e){var t=e.reduce(function(e,t){return e+t}),n=t/e.length;return n}function q(e){e.sort(function(e,t){return e-t});var t=Math.floor(e.length/2);return e.length%2==1?e[t]:(e[t-1]+e[t])/2}function G(e){e.sort(function(e,t){return e-t});var t=Math.floor(e.length/2);return 1==e.length?[e[0],e[0],e[0]]:e.length%2==1?[q(e.slice(0,t)),e[t],q(e.slice(t+1))]:[q(e.slice(0,t)),(e[t-1]+e[t])/2,q(e.slice(t))]}function j(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;e>i;i++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function U(){return j(12)}function V(e,t){for(e instanceof Array&&(e=e.node());null!==e.parentNode;)if(e=e.parentNode,void 0!==e.tagName&&e.tagName.toLowerCase()===t.toLowerCase())return!0;return!1}function W(e,t){return void 0!==t&&null!==t&&(t=t.replace(/^\/|\/$/g,""),e=[t,e].join("/")),e.replace(/^\/|\/$/g,"")+".json"}function X(e,t){Q.isUndefined(t)&&(t={});for(var n=e.location.search.substring(1),i=n.split("&"),r=0;r<i.length;r++){var o=i[r].split("="),a=decodeURIComponent(o[1]);if(o[0].indexOf("[]")==o[0].length-2){var s=o[0].replace("[]","");s in t||(t[s]=[]),t[s].push(a)}else t[o[0]]=a}return t}function K(e){return e.ownerDocument}function Y(e){return K(e).defaultView}function Z(e){try{return d3.transform(e)}catch(t){return console.error("Cannot run d3.transform, probably becuase this is a node/jsdom test. Returning a tranform object for testing."),{translate:[0,0],rotate:0}}}function $(e){var t=function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(e[1]||"")):"Chrome"===n[1]&&(e=t.match(/\b(OPR|Edge)\/(\d+)/),null!=e)?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))};try{return t().toLowerCase().indexOf(e)>-1}catch(n){return!1}}var J=n(196),Q=n(197);try{var ee=n(198).saveAs}catch(te){console.warn("filesaverjs not available")}e.exports={set_options:r,remove_child_nodes:o,load_css:a,load_files:l,load_the_file:s,make_class:u,setup_defs:c,draw_an_object:h,draw_a_nested_object:d,make_array:f,make_array_ref:p,compare_arrays:_,array_to_object:g,clone:m,extend:v,unique_concat:y,unique_strings_array:b,debounce:x,object_slice_for_ids:w,object_slice_for_ids_ref:S,c_plus_c:A,c_minus_c:k,c_times_scalar:C,download_json:T,load_json:E,load_json_or_csv:M,download_svg:L,rotate_coords_recursive:R,rotate_coords:O,get_angle:P,to_degrees:D,angle_for_event:I,distance:N,check_undefined:F,compartmentalize:B,decompartmentalize:z,mean:H,median:q,quartiles:G,random_characters:j,generate_map_id:U,check_for_parent_tag:V,name_to_url:W,parse_url_components:X,get_document:K,get_window:Y,d3_transform_catch:Z,check_browser:$}},function(e,t){/**
	* vkBeautify - javascript plugin to pretty-print or minify text in XML, JSON, CSS and SQL formats.
	*  
	* Version - 0.99.00.beta 
	* Copyright (c) 2012 Vadim Kiryukhin
	* vkiryukhin @ gmail.com
	* http://www.eslinstructor.net/vkbeautify/
	* 
	* Dual licensed under the MIT and GPL licenses:
	*   http://www.opensource.org/licenses/mit-license.php
	*   http://www.gnu.org/licenses/gpl.html
	*
	*   Pretty print
	*
	*        vkbeautify.xml(text [,indent_pattern]);
	*        vkbeautify.json(text [,indent_pattern]);
	*        vkbeautify.css(text [,indent_pattern]);
	*        vkbeautify.sql(text [,indent_pattern]);
	*
	*        @text - String; text to beatufy;
	*        @indent_pattern - Integer | String;
	*                Integer:  number of white spaces;
	*                String:   character string to visualize indentation ( can also be a set of white spaces )
	*   Minify
	*
	*        vkbeautify.xmlmin(text [,preserve_comments]);
	*        vkbeautify.jsonmin(text);
	*        vkbeautify.cssmin(text [,preserve_comments]);
	*        vkbeautify.sqlmin(text);
	*
	*        @text - String; text to minify;
	*        @preserve_comments - Bool; [optional];
	*                Set this flag to true to prevent removing comments from @text ( minxml and mincss functions only. )
	*
	*   Examples:
	*        vkbeautify.xml(text); // pretty print XML
	*        vkbeautify.json(text, 4 ); // pretty print JSON
	*        vkbeautify.css(text, '. . . .'); // pretty print CSS
	*        vkbeautify.sql(text, '----'); // pretty print SQL
	*
	*        vkbeautify.xmlmin(text, true);// minify XML, preserve comments
	*        vkbeautify.jsonmin(text);// minify JSON
	*        vkbeautify.cssmin(text);// minify CSS, remove comments ( default )
	*        vkbeautify.sqlmin(text);// minify SQL
	*
	*/
function n(e){var t="    ";if(isNaN(parseInt(e)))t=e;else switch(e){case 1:t=" ";break;case 2:t="  ";break;case 3:t="   ";break;case 4:t="    ";break;case 5:t="     ";break;case 6:t="      ";break;case 7:t="       ";break;case 8:t="        ";break;case 9:t="         ";break;case 10:t="          ";break;case 11:t="           ";break;case 12:t="            "}var n=["\n"];for(ix=0;ix<100;ix++)n.push(n[ix]+t);return n}function i(){this.step="    ",this.shift=n(this.step)}function r(e,t){return t-(e.replace(/\(/g,"").length-e.replace(/\)/g,"").length)}function o(e,t){return e.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+t+t+"AND ").replace(/ BETWEEN /gi,"~::~"+t+"BETWEEN ").replace(/ CASE /gi,"~::~"+t+"CASE ").replace(/ ELSE /gi,"~::~"+t+"ELSE ").replace(/ END /gi,"~::~"+t+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+t+"ON ").replace(/ OR /gi,"~::~"+t+t+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+t+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+t).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+t+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}i.prototype.xml=function(e,t){var i=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),r=i.length,o=!1,a=0,s="",l=0,u=t?n(t):this.shift;for(l=0;r>l;l++)i[l].search(/<!/)>-1?(s+=u[a]+i[l],o=!0,(i[l].search(/-->/)>-1||i[l].search(/\]>/)>-1||i[l].search(/!DOCTYPE/)>-1)&&(o=!1)):i[l].search(/-->/)>-1||i[l].search(/\]>/)>-1?(s+=i[l],o=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(s+=i[l],o||a--):i[l].search(/<\w/)>-1&&-1==i[l].search(/<\//)&&-1==i[l].search(/\/>/)?s=s+=o?i[l]:u[a++]+i[l]:i[l].search(/<\w/)>-1&&i[l].search(/<\//)>-1?s=s+=o?i[l]:u[a]+i[l]:i[l].search(/<\//)>-1?s=s+=o?i[l]:u[--a]+i[l]:i[l].search(/\/>/)>-1?s=s+=o?i[l]:u[a]+i[l]:s+=i[l].search(/<\?/)>-1?u[a]+i[l]:i[l].search(/xmlns\:/)>-1||i[l].search(/xmlns\=/)>-1?u[a]+i[l]:i[l];return"\n"==s[0]?s.slice(1):s},i.prototype.json=function(e,t){var t=t?t:this.step;return"undefined"==typeof JSON?e:"string"==typeof e?JSON.stringify(JSON.parse(e),null,t):"object"==typeof e?JSON.stringify(e,null,t):e},i.prototype.css=function(e,t){var i=e.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),r=i.length,o=0,a="",s=0,l=t?n(t):this.shift;for(s=0;r>s;s++)a+=/\{/.exec(i[s])?l[o++]+i[s]:/\}/.exec(i[s])?l[--o]+i[s]:/\*\\/.exec(i[s])?l[o]+i[s]:l[o]+i[s];return a.replace(/^\n{1,}/,"")},i.prototype.sql=function(e,t){var i=e.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),a=i.length,s=[],l=0,u=this.step,c=0,h="",d=0,f=t?n(t):this.shift;for(d=0;a>d;d++)s=d%2?s.concat(i[d]):s.concat(o(i[d],u));for(a=s.length,d=0;a>d;d++){c=r(s[d],c),/\s{0,}\s{0,}SELECT\s{0,}/.exec(s[d])&&(s[d]=s[d].replace(/\,/g,",\n"+u+u)),/\s{0,}\s{0,}SET\s{0,}/.exec(s[d])&&(s[d]=s[d].replace(/\,/g,",\n"+u+u)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(s[d])?(l++,h+=f[l]+s[d]):/\'/.exec(s[d])?(1>c&&l&&l--,h+=s[d]):(h+=f[l]+s[d],1>c&&l&&l--)}return h=h.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},i.prototype.xmlmin=function(e,t){var n=t?e:e.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns");return n.replace(/>\s{0,}</g,"><")},i.prototype.jsonmin=function(e){return"undefined"==typeof JSON?e:JSON.stringify(JSON.parse(e),null,0)},i.prototype.cssmin=function(e,t){var n=t?e:e.replace(/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//g,"");return n.replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},i.prototype.sqlmin=function(e){return e.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},e.exports=new i},function(e,t,n){var i,r;(function(){function n(e){function t(t,n,i,r,o,a){for(;o>=0&&a>o;o+=e){var s=r?r[o]:o;i=n(i,t[s],s,t)}return i}return function(n,i,r,o){i=S(i,o,4);var a=!L(n)&&w.keys(n),s=(a||n).length,l=e>0?0:s-1;return arguments.length<3&&(r=n[a?a[l]:l],l+=e),t(n,i,r,a,l,s)}}function o(e){return function(t,n,i){n=A(n,i);for(var r=M(t),o=e>0?0:r-1;o>=0&&r>o;o+=e)if(n(t[o],o,t))return o;return-1}}function a(e,t,n){return function(i,r,o){var a=0,s=M(i);if("number"==typeof o)e>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return o=n(i,r),i[o]===r?o:-1;if(r!==r)return o=t(p.call(i,a,s),w.isNaN),o>=0?o+a:-1;for(o=e>0?a:s-1;o>=0&&s>o;o+=e)if(i[o]===r)return o;return-1}}function s(e,t){var n=I.length,i=e.constructor,r=w.isFunction(i)&&i.prototype||h,o="constructor";for(w.has(e,o)&&!w.contains(t,o)&&t.push(o);n--;)o=I[n],o in e&&e[o]!==r[o]&&!w.contains(t,o)&&t.push(o)}var l=this,u=l._,c=Array.prototype,h=Object.prototype,d=Function.prototype,f=c.push,p=c.slice,_=h.toString,g=h.hasOwnProperty,m=Array.isArray,v=Object.keys,y=d.bind,b=Object.create,x=function(){},w=function(e){return e instanceof w?e:this instanceof w?void(this._wrapped=e):new w(e)};"undefined"!=typeof e&&e.exports&&(t=e.exports=w),t._=w,w.VERSION="1.8.3";var S=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return function(){return e.apply(t,arguments)}},A=function(e,t,n){return null==e?w.identity:w.isFunction(e)?S(e,t,n):w.isObject(e)?w.matcher(e):w.property(e)};w.iteratee=function(e,t){return A(e,t,1/0)};var k=function(e,t){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var r=1;i>r;r++)for(var o=arguments[r],a=e(o),s=a.length,l=0;s>l;l++){var u=a[l];t&&void 0!==n[u]||(n[u]=o[u])}return n}},C=function(e){if(!w.isObject(e))return{};if(b)return b(e);x.prototype=e;var t=new x;return x.prototype=null,t},T=function(e){return function(t){return null==t?void 0:t[e]}},E=Math.pow(2,53)-1,M=T("length"),L=function(e){var t=M(e);return"number"==typeof t&&t>=0&&E>=t};w.each=w.forEach=function(e,t,n){t=S(t,n);var i,r;if(L(e))for(i=0,r=e.length;r>i;i++)t(e[i],i,e);else{var o=w.keys(e);for(i=0,r=o.length;r>i;i++)t(e[o[i]],o[i],e)}return e},w.map=w.collect=function(e,t,n){t=A(t,n);for(var i=!L(e)&&w.keys(e),r=(i||e).length,o=Array(r),a=0;r>a;a++){var s=i?i[a]:a;o[a]=t(e[s],s,e)}return o},w.reduce=w.foldl=w.inject=n(1),w.reduceRight=w.foldr=n(-1),w.find=w.detect=function(e,t,n){var i;return i=L(e)?w.findIndex(e,t,n):w.findKey(e,t,n),void 0!==i&&-1!==i?e[i]:void 0},w.filter=w.select=function(e,t,n){var i=[];return t=A(t,n),w.each(e,function(e,n,r){t(e,n,r)&&i.push(e)}),i},w.reject=function(e,t,n){return w.filter(e,w.negate(A(t)),n)},w.every=w.all=function(e,t,n){t=A(t,n);for(var i=!L(e)&&w.keys(e),r=(i||e).length,o=0;r>o;o++){var a=i?i[o]:o;if(!t(e[a],a,e))return!1}return!0},w.some=w.any=function(e,t,n){t=A(t,n);for(var i=!L(e)&&w.keys(e),r=(i||e).length,o=0;r>o;o++){var a=i?i[o]:o;if(t(e[a],a,e))return!0}return!1},w.contains=w.includes=w.include=function(e,t,n,i){return L(e)||(e=w.values(e)),("number"!=typeof n||i)&&(n=0),w.indexOf(e,t,n)>=0},w.invoke=function(e,t){var n=p.call(arguments,2),i=w.isFunction(t);return w.map(e,function(e){var r=i?t:e[t];return null==r?r:r.apply(e,n)})},w.pluck=function(e,t){return w.map(e,w.property(t))},w.where=function(e,t){return w.filter(e,w.matcher(t))},w.findWhere=function(e,t){return w.find(e,w.matcher(t))},w.max=function(e,t,n){var i,r,o=-(1/0),a=-(1/0);if(null==t&&null!=e){e=L(e)?e:w.values(e);for(var s=0,l=e.length;l>s;s++)i=e[s],i>o&&(o=i)}else t=A(t,n),w.each(e,function(e,n,i){r=t(e,n,i),(r>a||r===-(1/0)&&o===-(1/0))&&(o=e,a=r)});return o},w.min=function(e,t,n){var i,r,o=1/0,a=1/0;if(null==t&&null!=e){e=L(e)?e:w.values(e);for(var s=0,l=e.length;l>s;s++)i=e[s],o>i&&(o=i)}else t=A(t,n),w.each(e,function(e,n,i){r=t(e,n,i),(a>r||r===1/0&&o===1/0)&&(o=e,a=r)});return o},w.shuffle=function(e){for(var t,n=L(e)?e:w.values(e),i=n.length,r=Array(i),o=0;i>o;o++)t=w.random(0,o),t!==o&&(r[o]=r[t]),r[t]=n[o];return r},w.sample=function(e,t,n){return null==t||n?(L(e)||(e=w.values(e)),e[w.random(e.length-1)]):w.shuffle(e).slice(0,Math.max(0,t))},w.sortBy=function(e,t,n){return t=A(t,n),w.pluck(w.map(e,function(e,n,i){return{value:e,index:n,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index-t.index}),"value")};var R=function(e){return function(t,n,i){var r={};return n=A(n,i),w.each(t,function(i,o){var a=n(i,o,t);e(r,i,a)}),r}};w.groupBy=R(function(e,t,n){w.has(e,n)?e[n].push(t):e[n]=[t]}),w.indexBy=R(function(e,t,n){e[n]=t}),w.countBy=R(function(e,t,n){w.has(e,n)?e[n]++:e[n]=1}),w.toArray=function(e){return e?w.isArray(e)?p.call(e):L(e)?w.map(e,w.identity):w.values(e):[]},w.size=function(e){return null==e?0:L(e)?e.length:w.keys(e).length},w.partition=function(e,t,n){t=A(t,n);var i=[],r=[];return w.each(e,function(e,n,o){(t(e,n,o)?i:r).push(e)}),[i,r]},w.first=w.head=w.take=function(e,t,n){return null!=e?null==t||n?e[0]:w.initial(e,e.length-t):void 0},w.initial=function(e,t,n){return p.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},w.last=function(e,t,n){return null!=e?null==t||n?e[e.length-1]:w.rest(e,Math.max(0,e.length-t)):void 0},w.rest=w.tail=w.drop=function(e,t,n){return p.call(e,null==t||n?1:t)},w.compact=function(e){return w.filter(e,w.identity)};var O=function(e,t,n,i){for(var r=[],o=0,a=i||0,s=M(e);s>a;a++){var l=e[a];if(L(l)&&(w.isArray(l)||w.isArguments(l))){t||(l=O(l,t,n));var u=0,c=l.length;for(r.length+=c;c>u;)r[o++]=l[u++]}else n||(r[o++]=l)}return r};w.flatten=function(e,t){return O(e,t,!1)},w.without=function(e){return w.difference(e,p.call(arguments,1))},w.uniq=w.unique=function(e,t,n,i){w.isBoolean(t)||(i=n,n=t,t=!1),null!=n&&(n=A(n,i));for(var r=[],o=[],a=0,s=M(e);s>a;a++){var l=e[a],u=n?n(l,a,e):l;t?(a&&o===u||r.push(l),o=u):n?w.contains(o,u)||(o.push(u),r.push(l)):w.contains(r,l)||r.push(l)}return r},w.union=function(){return w.uniq(O(arguments,!0,!0))},w.intersection=function(e){for(var t=[],n=arguments.length,i=0,r=M(e);r>i;i++){var o=e[i];if(!w.contains(t,o)){for(var a=1;n>a&&w.contains(arguments[a],o);a++);a===n&&t.push(o)}}return t},w.difference=function(e){var t=O(arguments,!0,!0,1);return w.filter(e,function(e){return!w.contains(t,e)})},w.zip=function(){return w.unzip(arguments)},w.unzip=function(e){for(var t=e&&w.max(e,M).length||0,n=Array(t),i=0;t>i;i++)n[i]=w.pluck(e,i);return n},w.object=function(e,t){for(var n={},i=0,r=M(e);r>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},w.findIndex=o(1),w.findLastIndex=o(-1),w.sortedIndex=function(e,t,n,i){n=A(n,i,1);for(var r=n(t),o=0,a=M(e);a>o;){var s=Math.floor((o+a)/2);n(e[s])<r?o=s+1:a=s}return o},w.indexOf=a(1,w.findIndex,w.sortedIndex),w.lastIndexOf=a(-1,w.findLastIndex),w.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var i=Math.max(Math.ceil((t-e)/n),0),r=Array(i),o=0;i>o;o++,e+=n)r[o]=e;return r};var P=function(e,t,n,i,r){if(!(i instanceof t))return e.apply(n,r);var o=C(e.prototype),a=e.apply(o,r);return w.isObject(a)?a:o};w.bind=function(e,t){if(y&&e.bind===y)return y.apply(e,p.call(arguments,1));if(!w.isFunction(e))throw new TypeError("Bind must be called on a function");var n=p.call(arguments,2),i=function(){return P(e,i,t,this,n.concat(p.call(arguments)))};return i},w.partial=function(e){var t=p.call(arguments,1),n=function(){for(var i=0,r=t.length,o=Array(r),a=0;r>a;a++)o[a]=t[a]===w?arguments[i++]:t[a];for(;i<arguments.length;)o.push(arguments[i++]);return P(e,n,this,this,o)};return n},w.bindAll=function(e){var t,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(t=1;i>t;t++)n=arguments[t],e[n]=w.bind(e[n],e);return e},w.memoize=function(e,t){var n=function(i){var r=n.cache,o=""+(t?t.apply(this,arguments):i);return w.has(r,o)||(r[o]=e.apply(this,arguments)),r[o]};return n.cache={},n},w.delay=function(e,t){var n=p.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},w.defer=w.partial(w.delay,w,1),w.throttle=function(e,t,n){var i,r,o,a=null,s=0;n||(n={});var l=function(){s=n.leading===!1?0:w.now(),a=null,o=e.apply(i,r),a||(i=r=null)};return function(){var u=w.now();s||n.leading!==!1||(s=u);var c=t-(u-s);return i=this,r=arguments,0>=c||c>t?(a&&(clearTimeout(a),a=null),s=u,o=e.apply(i,r),a||(i=r=null)):a||n.trailing===!1||(a=setTimeout(l,c)),o}},w.debounce=function(e,t,n){var i,r,o,a,s,l=function(){var u=w.now()-a;t>u&&u>=0?i=setTimeout(l,t-u):(i=null,n||(s=e.apply(o,r),i||(o=r=null)))};return function(){o=this,r=arguments,a=w.now();var u=n&&!i;return i||(i=setTimeout(l,t)),u&&(s=e.apply(o,r),o=r=null),s}},w.wrap=function(e,t){return w.partial(t,e)},w.negate=function(e){return function(){return!e.apply(this,arguments)}},w.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}},w.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},w.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=null),n}},w.once=w.partial(w.before,2);var D=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];w.keys=function(e){if(!w.isObject(e))return[];if(v)return v(e);var t=[];for(var n in e)w.has(e,n)&&t.push(n);return D&&s(e,t),t},w.allKeys=function(e){if(!w.isObject(e))return[];var t=[];for(var n in e)t.push(n);return D&&s(e,t),t},w.values=function(e){for(var t=w.keys(e),n=t.length,i=Array(n),r=0;n>r;r++)i[r]=e[t[r]];return i},w.mapObject=function(e,t,n){t=A(t,n);for(var i,r=w.keys(e),o=r.length,a={},s=0;o>s;s++)i=r[s],a[i]=t(e[i],i,e);return a},w.pairs=function(e){for(var t=w.keys(e),n=t.length,i=Array(n),r=0;n>r;r++)i[r]=[t[r],e[t[r]]];return i},w.invert=function(e){for(var t={},n=w.keys(e),i=0,r=n.length;r>i;i++)t[e[n[i]]]=n[i];return t},w.functions=w.methods=function(e){var t=[];for(var n in e)w.isFunction(e[n])&&t.push(n);return t.sort()},w.extend=k(w.allKeys),w.extendOwn=w.assign=k(w.keys),w.findKey=function(e,t,n){t=A(t,n);for(var i,r=w.keys(e),o=0,a=r.length;a>o;o++)if(i=r[o],t(e[i],i,e))return i},w.pick=function(e,t,n){var i,r,o={},a=e;if(null==a)return o;w.isFunction(t)?(r=w.allKeys(a),i=S(t,n)):(r=O(arguments,!1,!1,1),i=function(e,t,n){return t in n},a=Object(a));for(var s=0,l=r.length;l>s;s++){var u=r[s],c=a[u];i(c,u,a)&&(o[u]=c)}return o},w.omit=function(e,t,n){if(w.isFunction(t))t=w.negate(t);else{var i=w.map(O(arguments,!1,!1,1),String);t=function(e,t){return!w.contains(i,t)}}return w.pick(e,t,n)},w.defaults=k(w.allKeys,!0),w.create=function(e,t){var n=C(e);return t&&w.extendOwn(n,t),n},w.clone=function(e){return w.isObject(e)?w.isArray(e)?e.slice():w.extend({},e):e},w.tap=function(e,t){return t(e),e},w.isMatch=function(e,t){var n=w.keys(t),i=n.length;if(null==e)return!i;for(var r=Object(e),o=0;i>o;o++){var a=n[o];if(t[a]!==r[a]||!(a in r))return!1}return!0};var N=function(e,t,n,i){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof w&&(e=e._wrapped),t instanceof w&&(t=t._wrapped);var r=_.call(e);if(r!==_.call(t))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var o="[object Array]"===r;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,s=t.constructor;if(a!==s&&!(w.isFunction(a)&&a instanceof a&&w.isFunction(s)&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],i=i||[];for(var l=n.length;l--;)if(n[l]===e)return i[l]===t;if(n.push(e),i.push(t),o){if(l=e.length,l!==t.length)return!1;for(;l--;)if(!N(e[l],t[l],n,i))return!1}else{var u,c=w.keys(e);if(l=c.length,w.keys(t).length!==l)return!1;for(;l--;)if(u=c[l],!w.has(t,u)||!N(e[u],t[u],n,i))return!1}return n.pop(),i.pop(),!0};w.isEqual=function(e,t){return N(e,t)},w.isEmpty=function(e){return null==e?!0:L(e)&&(w.isArray(e)||w.isString(e)||w.isArguments(e))?0===e.length:0===w.keys(e).length},w.isElement=function(e){return!(!e||1!==e.nodeType)},w.isArray=m||function(e){return"[object Array]"===_.call(e)},w.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},w.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){w["is"+e]=function(t){return _.call(t)==="[object "+e+"]"}}),w.isArguments(arguments)||(w.isArguments=function(e){return w.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(w.isFunction=function(e){return"function"==typeof e||!1}),w.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},w.isNaN=function(e){return w.isNumber(e)&&e!==+e},w.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===_.call(e)},w.isNull=function(e){return null===e},w.isUndefined=function(e){return void 0===e},w.has=function(e,t){return null!=e&&g.call(e,t)},w.noConflict=function(){return l._=u,this},w.identity=function(e){return e},w.constant=function(e){return function(){return e}},w.noop=function(){},w.property=T,w.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},w.matcher=w.matches=function(e){return e=w.extendOwn({},e),function(t){return w.isMatch(t,e)}},w.times=function(e,t,n){var i=Array(Math.max(0,e));t=S(t,n,1);for(var r=0;e>r;r++)i[r]=t(r);return i},w.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},w.now=Date.now||function(){return(new Date).getTime()};var F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},B=w.invert(F),z=function(e){var t=function(t){return e[t]},n="(?:"+w.keys(e).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(e){return e=null==e?"":""+e,i.test(e)?e.replace(r,t):e}};w.escape=z(F),w.unescape=z(B),w.result=function(e,t,n){var i=null==e?void 0:e[t];return void 0===i&&(i=n),w.isFunction(i)?i.call(e):i};var H=0;w.uniqueId=function(e){var t=++H+"";return e?e+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\u2028|\u2029/g,U=function(e){return"\\"+G[e]};w.template=function(e,t,n){!t&&n&&(t=n),t=w.defaults({},t,w.templateSettings);var i=RegExp([(t.escape||q).source,(t.interpolate||q).source,(t.evaluate||q).source].join("|")+"|$","g"),r=0,o="__p+='";e.replace(i,function(t,n,i,a,s){return o+=e.slice(r,s).replace(j,U),r=s+t.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),t}),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(t.variable||"obj","_",o)}catch(s){throw s.source=o,s}var l=function(e){return a.call(this,e,w)},u=t.variable||"obj";return l.source="function("+u+"){\n"+o+"}",l},w.chain=function(e){var t=w(e);return t._chain=!0,t};var V=function(e,t){return e._chain?w(t).chain():t};w.mixin=function(e){w.each(w.functions(e),function(t){var n=w[t]=e[t];w.prototype[t]=function(){var e=[this._wrapped];return f.apply(e,arguments),V(this,n.apply(w,e))}})},w.mixin(w),w.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=c[e];w.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],V(this,n)}}),w.each(["concat","join","slice"],function(e){var t=c[e];w.prototype[e]=function(){return V(this,t.apply(this._wrapped,arguments))}}),w.prototype.value=function(){return this._wrapped},w.prototype.valueOf=w.prototype.toJSON=w.prototype.value,w.prototype.toString=function(){return""+this._wrapped},i=[],r=function(){return w}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(this)},function(e,t,n){var i,r,o=o||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},i=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in i,o=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},a=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),s=e.webkitRequestFileSystem,l=e.requestFileSystem||s||e.mozRequestFileSystem,u=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},c="application/octet-stream",h=0,d=500,f=function(t){var i=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};e.chrome?i():setTimeout(i,d)},p=function(e,t,n){t=[].concat(t);for(var i=t.length;i--;){var r=e["on"+t[i]];if("function"==typeof r)try{r.call(e,n||e)}catch(o){u(o)}}},_=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},g=function(t,u,d){d||(t=_(t));var g,m,v,y=this,b=t.type,x=!1,w=function(){p(y,"writestart progress write writeend".split(" "))},S=function(){if(m&&a&&"undefined"!=typeof FileReader){var i=new FileReader;return i.onloadend=function(){var e=i.result;m.location.href="data:attachment/file"+e.slice(e.search(/[,;]/)),y.readyState=y.DONE,w()},i.readAsDataURL(t),void(y.readyState=y.INIT)}if((x||!g)&&(g=n().createObjectURL(t)),m)m.location.href=g;else{var r=e.open(g,"_blank");void 0==r&&a&&(e.location.href=g)}y.readyState=y.DONE,w(),f(g)},A=function(e){return function(){return y.readyState!==y.DONE?e.apply(this,arguments):void 0}},k={create:!0,exclusive:!1};return y.readyState=y.INIT,u||(u="download"),r?(g=n().createObjectURL(t),i.href=g,i.download=u,void setTimeout(function(){o(i),w(),f(g),y.readyState=y.DONE})):(e.chrome&&b&&b!==c&&(v=t.slice||t.webkitSlice,t=v.call(t,0,t.size,c),x=!0),s&&"download"!==u&&(u+=".download"),(b===c||s)&&(m=e),l?(h+=t.size,void l(e.TEMPORARY,h,A(function(e){e.root.getDirectory("saved",k,A(function(e){var n=function(){e.getFile(u,k,A(function(e){e.createWriter(A(function(n){n.onwriteend=function(t){m.location.href=e.toURL(),y.readyState=y.DONE,p(y,"writeend",t),f(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&S()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=y["on"+e]}),n.write(t),y.abort=function(){n.abort(),y.readyState=y.DONE},y.readyState=y.WRITING}),S)}),S)};e.getFile(u,{create:!1},A(function(e){e.remove(),n()}),A(function(e){e.code===e.NOT_FOUND_ERR?n():S()}))}),S)}),S)):void S())},m=g.prototype,v=function(e,t,n){return new g(e,t,n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return n||(e=_(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(m.abort=function(){var e=this;e.readyState=e.DONE,p(e,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,v)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof e&&e.exports?e.exports.saveAs=o:null!==n(199)&&null!=n(200)&&(i=[],r=function(){return o}.apply(t,i),!(void 0!==r&&(e.exports=r)))},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){function i(e,t,n,i){var r=e.append("div").attr("id","rxn-input");this.placed_div=v(r,t,{x:240,y:0}),this.placed_div.hide();var o=y(r.node(),{backgroundColor:"#eee"});d3.select(o.input),this.completely=o,r.append("button").attr("class","button input-close-button").text("×").on("mousedown",function(){this.hide_dropdown()}.bind(this)),this.map=t;var a=90;this.direction_arrow=new b(t.sel),this.direction_arrow.set_rotation(a),this.setup_map_callbacks(t),this.zoom_container=n,this.setup_zoom_callbacks(n),this.settings=i,this.toggle(!1),this.target_coords=null}function r(e){e.callback_manager.set("select_metabolite_with_id.input",function(e,t){this.is_active&&(this.reload(e,t,!1),this.show_dropdown(t)),this.hide_target()}.bind(this)),e.callback_manager.set("select_selectable.input",function(e,t,n){this.hide_target(),1==e&&this.is_active&&n?(this.reload(t,n,!1),this.show_dropdown(n)):this.toggle(!1)}.bind(this)),e.callback_manager.set("deselect_nodes",function(){this.direction_arrow.hide(),this.hide_dropdown()}.bind(this)),e.callback_manager.set("before_svg_export",function(){this.direction_arrow.hide(),this.hide_target()}.bind(this))}function o(e){e.callback_manager.set("zoom.input",function(){this.is_active&&this.place_at_selected()}.bind(this))}function a(){return this.placed_div.is_visible()}function s(e){void 0===e?this.is_active=!this.is_active:this.is_active=e,this.is_active?(this.toggle_start_reaction_listener(!0),w.isNull(this.target_coords)?this.reload_at_selected():this.placed_div.place(this.target_coords),this.show_dropdown(),this.map.set_status("Click on the canvas or an existing metabolite"),this.direction_arrow.show()):(this.toggle_start_reaction_listener(!1),this.hide_dropdown(),this.map.set_status(null),this.direction_arrow.hide())}function l(e){this.clear_escape=this.map.key_manager.add_escape_listener(function(){this.hide_dropdown()}.bind(this),!0),this.completely.input.blur(),this.completely.repaint(),this.completely.setText(""),this.completely.input.focus()}function u(){this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.placed_div.hide(),this.completely.input.blur(),this.completely.hideDropDown()}function c(){this.map.deselect_text_labels();var e=this.map.select_single_node();if(null!=e){var t={x:e.x,y:e.y};this.place(t)}}function h(e){this.placed_div.place(e),this.direction_arrow.set_location(e),this.direction_arrow.show()}function d(){this.map.deselect_text_labels();var e=this.map.select_single_node();if(null==e)return!1;var t={x:e.x,y:e.y};return this.reload(e,t,!1),!0}function f(e,t,n){function i(e,t){for(var n in t)if(t[n].bigg_id==e)return!0;return!1}if(!n&&!e)return void console.error("No selected node, and not starting from scratch");if(this.place(t),null===this.map.cobra_model)return void this.completely.setText("Cannot add: No model.");var r="name"==this.settings.get_option("identifiers_on_map"),o=this.settings.get_option("allow_building_duplicate_reactions"),a=[],s=this.map.cobra_model.reactions,l=this.map.cobra_model.metabolites,u=this.map.reactions,c=this.map.has_data_on_reactions,h=(this.map.reaction_data,this.map.reaction_data_styles,e?r?e.name:e.bigg_id:""),d=function(e,t){return e.replace(new RegExp("(^| )("+t.join("|")+")($| )","g"),"$1<b>$2</b>$3")},f={};for(var p in s){var _=s[p],g=_.name,v=r?g:p;if(o||!i(p,u))for(var y in _.metabolites)if(n||y==e.bigg_id){if(p in f)continue;l[y].name;if(c)a.push({reaction_data:_.data,html:"<b>"+v+"</b>: "+_.data_string,matches:[v],id:p}),f[p]=!0;else{var b,S={},A=[];if(r)for(b in _.metabolites){var k=l[b].name;S[k]=_.metabolites[b],A.push(k)}else{S=m.clone(_.metabolites);for(b in _.metabolites)A.push(b)}var C=w.flatten(_.genes.map(function(e){return[e.name,e.bigg_id]})),T=x.build_reaction_string(S,_.reversibility,_.lower_bound,_.upper_bound);a.push({html:"<b>"+v+"</b>	"+d(T,[h]),matches:[v].concat(A).concat(C),id:p}),f[p]=!0}}}var E;E=c?function(e,t){return Math.abs(t.reaction_data)-Math.abs(e.reaction_data)}:function(e,t){return e.html.toLowerCase()<t.html.toLowerCase()?-1:1},a=a.sort(E);var M=this.completely;M.options=a,M.setText("");var L=this.direction_arrow,R=function(i){if(null!==i)if(n)this.map.new_reaction_from_scratch(i,t,L.get_rotation());else{if(!(e.node_id in this.map.nodes))return console.error("Selected node no longer exists"),void this.hide_dropdown();this.map.new_reaction_for_metabolite(i,e.node_id,L.get_rotation())}}.bind(this);M.onEnter=function(e){this.setText(""),this.onChange(""),R(e)}}function p(e){if(void 0===e)this.start_reaction_listener=!this.start_reaction_listener;else{if(this.start_reaction_listener==e)return;this.start_reaction_listener=e}this.start_reaction_listener?(this.map.sel.on("click.start_reaction",function(e){if(!this.direction_arrow.dragging){var t={x:d3.mouse(e)[0],y:d3.mouse(e)[1]};this.map.deselect_nodes(),this.map.deselect_text_labels(),this.reload(null,t,!0),this.show_target(this.map,t),this.show_dropdown(t)}}.bind(this,this.map.sel.node())),this.map.sel.classed("start-reaction-cursor",!0)):(this.map.sel.on("click.start_reaction",null),this.map.sel.classed("start-reaction-cursor",!1),this.hide_target())}function _(){this.target_coords&&this.map.sel.selectAll(".start-reaction-target").remove(),this.target_coords=null}function g(e,t){var n=e.sel.selectAll(".start-reaction-target").data([12,5]);n.enter().append("circle").classed("start-reaction-target",!0).attr("r",function(e){return e}).style("stroke-width",4),n.style("visibility","visible").attr("transform","translate("+t.x+","+t.y+")"),this.target_coords=t}var m=n(195),v=n(202),y=n(203),b=n(204),x=n(205),w=n(197),S=m.make_class();S.prototype={init:i,setup_map_callbacks:r,setup_zoom_callbacks:o,is_visible:a,toggle:s,show_dropdown:l,hide_dropdown:u,place_at_selected:c,place:h,reload_at_selected:d,reload:f,toggle_start_reaction_listener:p,hide_target:_,show_target:g},e.exports=S},function(e,t,n){function i(e,t,n){this.div=e,void 0===n&&(n={x:0,y:0}),this.displacement=n,this.map=t}function r(){return"none"!=this.div.style("display")}function o(e){this.div.style("display",null);var t=this.map.zoom_container.window_translate,n=this.map.zoom_container.window_scale,i=this.map.get_size(),r=Math.max(20,Math.min(i.width-270,n*e.x+t.x-this.displacement.x)),o=Math.max(20,Math.min(i.height-40,n*e.y+t.y-this.displacement.y));this.div.style("position","absolute").style("display","block").style("left",r+"px").style("top",o+"px")}function a(){this.div.style("display","none")}var s=n(195),l=s.make_class();l.prototype={init:i,is_visible:r,place:o,hide:a},e.exports=l},function(e,t,n){/**
	 * @license
	 *
	 * complete.ly 1.0.0
	 * MIT Licensing
	 * Copyright (c) 2013 Lorenzo Puccetti
	 *
	 * This Software shall be used for doing good things, not bad things.
	 *
	 *
	 * Modified by Zachary King (c) 2014.
	 *
	 **/
var i=n(195);e.exports=function(e,t){function n(e){return void 0===d&&(d=document.createElement("span"),d.style.visibility="hidden",d.style.position="fixed",d.style.outline="0",d.style.margin="0",d.style.padding="0",d.style.border="0",d.style.left="0",d.style.whiteSpace="pre",d.style.fontSize=t.fontSize,d.style.fontFamily=t.fontFamily,d.style.fontWeight="normal",document.body.appendChild(d)),d.innerHTML=String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),d.getBoundingClientRect().right}document=i.get_document(e),window=i.get_window(e),t=t||{},t.fontSize=t.fontSize||"13px",t.fontFamily=t.fontFamily||"sans-serif",t.promptInnerHTML=t.promptInnerHTML||"",t.color=t.color||"#333",t.hintColor=t.hintColor||"#aaa",t.backgroundColor=t.backgroundColor||"#fff",t.dropDownBorderColor=t.dropDownBorderColor||"#aaa",t.dropDownZIndex=t.dropDownZIndex||"100",t.dropDownOnHoverBackgroundColor=t.dropDownOnHoverBackgroundColor||"#ddd";var r=document.createElement("input");r.type="text",r.spellcheck=!1,r.style.fontSize=t.fontSize,r.style.fontFamily=t.fontFamily,r.style.color=t.color,r.style.backgroundColor=t.backgroundColor,r.style.width="100%",r.style.outline="0",r.style.border="0",r.style.margin="0",r.style.padding="0";var o=r.cloneNode();o.disabled="",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.borderColor="transparent",o.style.boxShadow="none",o.style.color=t.hintColor,r.style.backgroundColor="transparent",r.style.verticalAlign="top",r.style.position="relative";var a=document.createElement("div");a.style.position="relative",a.style.outline="0",a.style.border="0",a.style.margin="0",a.style.padding="0";var s=document.createElement("div");if(s.style.position="absolute",s.style.outline="0",s.style.margin="0",s.style.padding="0",s.style.border="0",s.style.fontSize=t.fontSize,s.style.fontFamily=t.fontFamily,s.style.color=t.color,s.style.backgroundColor=t.backgroundColor,s.style.top="0",s.style.left="0",s.style.overflow="hidden",s.innerHTML=t.promptInnerHTML,s.style.background="transparent",void 0===document.body)throw"document.body is undefined. The library was wired up incorrectly.";document.body.appendChild(s);var l=s.getBoundingClientRect().right;a.appendChild(s),s.style.visibility="visible",s.style.left="-"+l+"px",a.style.marginLeft=l+"px",a.appendChild(o),a.appendChild(r);var u=document.createElement("div");u.style.position="absolute",u.style.visibility="hidden",u.style.outline="0",u.style.margin="0",u.style.padding="0",u.style.textAlign="left",u.style.fontSize=t.fontSize,u.style.fontFamily=t.fontFamily,u.style.backgroundColor=t.backgroundColor,u.style.zIndex=t.dropDownZIndex,u.style.cursor="default",u.style.borderStyle="solid",u.style.borderWidth="1px",u.style.borderColor=t.dropDownBorderColor,u.style.overflowX="hidden",u.style.whiteSpace="pre",u.style.overflowY="scroll";var c=function(e){var n=[],i=0,r=-1,o=null,a=function(){this.style.outline="1px solid #ddd"},s=function(){this.style.outline="0"},l=function(e){e.preventDefault(),u.onmouseselection(this.id)},u={hide:function(){e.style.visibility="hidden"},refresh:function(r,o){e.style.visibility="hidden",i=0,e.innerHTML="";var c=window.innerHeight||document.documentElement.clientHeight,h=e.parentNode.getBoundingClientRect(),d=h.top-6,f=c-h.bottom-6;n=[];for(var p=0;p<o.length;p++){var g=o[p].matches.filter(function(e){return 0==e.toLowerCase().indexOf(r.toLowerCase())});if(0!=g.length){var m=document.createElement("div");if(m.style.color=t.color,m.onmouseover=a,m.onmouseout=s,m.onmousedown=function(e){e.preventDefault()},m.ondblclick=l,m.__hint=g[0],m.id=o[p].id,m.innerHTML=o[p].html,n.push(m),e.appendChild(m),n.length>=_.display_limit){var v=document.createElement("div");v.innerHTML=" "+(o.length-n.length)+" more",n.push(v),e.appendChild(v);break}}}0!==n.length&&(u.highlight(0),d>3*f?(e.style.maxHeight=d+"px",e.style.top="",e.style.bottom="100%"):(e.style.top="100%",e.style.bottom="",e.style.maxHeight=f+"px"),e.style.visibility="visible")},highlight:function(e){-1!=r&&n[r]&&(n[r].style.backgroundColor=t.backgroundColor),n[e].style.backgroundColor=t.dropDownOnHoverBackgroundColor,r=e,o=n[e]},move:function(t){return"hidden"===e.style.visibility?"":i+t===-1||i+t===n.length?n[i].__hint:(i+=t,u.highlight(i),n[i].__hint)},onmouseselection:function(){},get_current_row:function(){return o}};return u},h=c(u);h.onmouseselection=function(e){_.onEnter(e),_.input.focus()},a.appendChild(u),e.appendChild(a);var d,f,p,_={get_hint:function(e){return e},display_limit:1e3,onArrowDown:function(){},onArrowUp:function(){},onEnter:function(){},onTab:function(){},onChange:function(){_.repaint()},startFrom:0,options:[],wrapper:a,input:r,hint:o,dropDown:u,prompt:s,setText:function(e){o.value=e,r.value=e},getText:function(){return r.value},hideDropDown:function(){h.hide()},repaint:function(){var e=r.value,t=_.startFrom,i=_.options,a=i.length,s=e.substring(t);f=e.substring(0,t),o.value="";for(var l=0;a>l;l++){var c=i[l].matches.filter(function(e){return 0==e.toLowerCase().indexOf(s.toLowerCase())});if(0!=c.length){o.value=_.get_hint(c[0]);break}}u.style.left=n(f)+"px",h.refresh(s,_.options)}},g=function(e,t){p=e.value;var n=function(){var n=e.value;p!==n&&(p=n,t(n))};e.addEventListener("input",n,!1),e.addEventListener("keyup",n,!1),e.addEventListener("change",n,!1)};g(r,function(e){_.onChange(e),_.repaint()});var m=function(e){e=e||window.event;var t=e.keyCode;if(33!=t&&34!=t)if(39!=t&&35!=t&&9!=t){if(13==t){var n=h.get_current_row().id;return void _.onEnter(n)}if(40==t){var i=h.move(1);return""==i&&_.onArrowDown(),void(o.value=_.get_hint(i))}if(38==t){var i=h.move(-1);return""==i&&_.onArrowUp(),o.value=_.get_hint(i),e.preventDefault(),void e.stopPropagation()}o.value=""}else if(9==t&&(e.preventDefault(),e.stopPropagation(),0==o.value.length&&_.onTab()),o.value.length>0){r.value=o.value;var a=p!=r.value;p=r.value,a&&_.onChange(r.value)}};return r.addEventListener("keydown",m,!1),_}},function(e,t,n){function i(e){function t(){return"M0 -5 L0 5 L20 5 L20 10 L30 0 L20 -10 L20 -5 Z"}this.arrow_container=e.append("g").attr("id","direction-arrow-container").attr("transform","translate(0,0)rotate(0)"),this.arrow=this.arrow_container.append("path").classed("direction-arrow",!0).attr("d",t()).style("visibility","hidden").attr("transform","translate(30,0)scale(2.5)"),this.sel=e,this.center={x:0,y:0},this._setup_drag(),this.dragging=!1,this.is_visible=!1,this.show()}function r(e){this.center=e;var t=g.d3_transform_catch(this.arrow_container.attr("transform"));this.arrow_container.attr("transform","translate("+e.x+","+e.y+")rotate("+t.rotate+")")}function o(e){var t=g.d3_transform_catch(this.arrow_container.attr("transform"));this.arrow_container.attr("transform","translate("+t.translate+")rotate("+e+")")}function a(e){var t=g.d3_transform_catch(this.arrow_container.attr("transform"));this.arrow_container.attr("transform","translate("+t.translate+")rotate("+(t.rotate+e)+")")}function s(){return g.d3_transform_catch(this.arrow_container.attr("transform")).rotate}function l(e){void 0===e?this.is_visible=!this.is_visible:this.is_visible=e,this.arrow.style("visibility",this.is_visible?"visible":"hidden")}function u(){this.toggle(!0)}function c(){this.toggle(!1)}function h(){this.set_rotation(0)}function d(){this.set_rotation(90)}function f(){this.set_rotation(180)}function p(){this.set_rotation(270)}function _(){var e=d3.behavior.drag().on("dragstart",function(e){d3.event.sourceEvent.stopPropagation(),this.dragging=!0}.bind(this)).on("drag.direction_arrow",function(e){var t={x:d3.event.dx,y:d3.event.dy},n={x:d3.mouse(this.sel.node())[0],y:d3.mouse(this.sel.node())[1]},i=g.angle_for_event(t,n,this.center);this.displace_rotation(g.to_degrees(i))}.bind(this)).on("dragend",function(e){setTimeout(function(){this.dragging=!1}.bind(this),200)}.bind(this));this.arrow_container.call(e)}var g=n(195),m=g.make_class();m.prototype={init:i,set_location:r,set_rotation:o,displace_rotation:a,get_rotation:s,toggle:l,show:u,hide:c,right:h,left:f,up:p,down:d,_setup_drag:_},e.exports=m},function(e,t,n){function i(e,t){var n=function(e){return 1==e?"":String(e)+" "},i=[],r=[];for(var o in e){var a=e[o];a>0?r.push(n(a)+o):i.push(n(Math.abs(a))+o)}var s=i.join(" + ");return s+=t?" ↔ ":" → ",s+=r.join(" + ")}function r(e){if(!e.reactions||!e.metabolites)throw new Error("Bad model data.");var t=new f;return t.reactions=e.reactions,t.metabolites=e.metabolites,t}function o(e){if(!e.reactions||!e.metabolites)throw new Error("Bad model data.");for(var t={},n=0,i=e.genes.length;i>n;n++){var r=e.genes[n],o=r.id;t[o]=r}var a=new f;a.reactions={};for(var n=0,i=e.reactions.length;i>n;n++){var r=e.reactions[n],o=r.id,s=h.clone(r);if(delete s.id,s.bigg_id=o,s.genes=[],s.reversibility=s.lower_bound<0&&s.upper_bound>0,s.upper_bound<=0&&s.lower_bound<0)for(var l in s.metabolites)s.metabolites[l]=-s.metabolites[l];if(delete s.lower_bound,delete s.upper_bound,"gene_reaction_rule"in s){var u=d.genes_for_gene_reaction_rule(s.gene_reaction_rule);u.forEach(function(e){if(e in t){var n=h.clone(t[e]);n.bigg_id=n.id,delete n.id,s.genes.push(n)}else console.warn("Could not find gene for gene_id "+e)})}a.reactions[o]=s}a.metabolites={};for(var n=0,i=e.metabolites.length;i>n;n++){var r=e.metabolites[n],o=r.id,c=h.clone(r);delete c.id,c.bigg_id=o,a.metabolites[o]=c}return a}function a(){this.reactions={},this.metabolites={}}function s(e,t,n){d.apply_reaction_data_to_reactions(this.reactions,e,t,n)}function l(e,t,n){d.apply_metabolite_data_to_nodes(this.metabolites,e,t,n)}function u(e,t,n,i,r){d.apply_gene_data_to_reactions(this.reactions,e,t,n,i,r)}function c(){return{reactions:this.reactions,metabolites:this.metabolites}}var h=n(195),d=n(206),f=h.make_class();f.from_exported_data=r,f.from_cobra_json=o,f.build_reaction_string=i,f.prototype={init:a,apply_reaction_data:s,apply_metabolite_data:l,apply_gene_data:u,model_for_export:c},e.exports=f},function(e,t,n){function i(e,t,n){function i(e,t){var n={},i=[null];for(var r in e){i=e[r].map(function(){return null});break}for(var o in t){var a=t[o],s=a.bigg_id,l={};a.genes.forEach(function(t){["bigg_id","name"].forEach(function(n){var r=e[t[n]]||g.clone(i),o=l[t.bigg_id];if("undefined"==typeof o)l[t.bigg_id]=r;else for(var a=0;a<r.length;a++){var s=r[a];null!==s&&(o[a]=s)}})}),n[s]=l}return n}if(null===e)return null;if(-1==["reaction_data","metabolite_data","gene_data"].indexOf(t))throw new Error("Invalid name argument: "+t);e instanceof Array||(e=[e]);var r=function(){return null===e?null:1==e.length?null:2==e.length?null:console.warn("Bad data style: "+t)};if(r(),e=g.array_to_object(e),"gene_data"==t){if(void 0===n)throw new Error("Must pass all_reactions argument for gene_data");e=i(e,n)}return e}function r(e,t,n){function i(e){return isFinite(e)?e:null}function r(e,t){return t?Math.abs(e):e}function o(e,t,n){return n?Math.abs(t-e):t-e}function a(e,t,n){if(0==e||0==t)return null;var i=t>=e?t/e:-e/t;return n?Math.abs(i):i}function s(e,t,n){if(0==e)return null;if(0>t/e)return null;var i=Math.log(t/e)/Math.log(2);return n?Math.abs(i):i}if(null===e)return null;var l=-1!=t.indexOf("abs");if(1==e.length){var u=_(e[0]);return null===u?null:r(u,l)}if(2!=e.length)throw new Error("Data array must be of length 1 or 2");var c=e.map(_);if(null===c[0]||null===c[1])return null;if("diff"==n)return o(c[0],c[1],l);if("fold"==n)return i(a(c[0],c[1],l));if("log2_fold"==n)return i(s(c[0],c[1],l));throw new Error("Bad data compare_style: "+n)}function o(e){return null===e||null===e[0]?!1:e[0]<0}function a(e,t,n,i,o,a){function s(e,t){return null===e?"nd":t(e)}var l=e,u=null===t,c={};n.forEach(function(e){var n=e[o];if("undefined"==typeof n)throw new Error("Bad value for identifiers_on_map: "+o);if("undefined"==typeof c[n])if(c[n]=!0,u)l=h(l,e.bigg_id,n+"\n");else{var d=t[e.bigg_id];"undefined"==typeof d&&(d=null);var f=r(d,i,a),p=null===f?m:d3.format(".3g");if(1==d.length)l=h(l,e.bigg_id,n+" ("+s(d[0],p)+")\n");else if(2==d.length){var g,v=d.reduce(function(e,t){return e||null!==_(t)},!1);g=v?n+" ("+s(d[0],p)+", "+s(d[1],p)+": "+s(f,p)+")\n":n+" ("+s(d[0],p)+", "+s(d[1],p)+")\n",l=h(l,e.bigg_id,g)}}}),l=l.replace(y,"\n").replace(b,"$1");var d=l.split("\n").map(function(e){for(var t=0,i=n.length;i>t;t++){var r=n[t];if(-1!=e.indexOf(r[o]))return{bigg_id:r.bigg_id,name:r.name,text:e}}return{bigg_id:null,name:null,text:e}});return d}function s(e,t){function n(e,t){return null===e?"(nd)":t(e)}if(null===e)return n(null);if(1==e.length){var i=null===t?m:d3.format(".3g");return n(e[0],i)}if(2==e.length){var i=null===t?m:d3.format(".3g"),r=n(e[0],i);return r+=", "+n(e[1],i),r+=": "+n(t,i)}return""}function l(e){var t=e[0].length,n=[];if(2>t||t>3)throw new Error("CSV file must have 2 or 3 columns");for(var i=1;t>i;i++)n[i-1]={};return e.slice(1).forEach(function(e){for(var t=1,i=e.length;i>t;t++)n[t-1][e[0]]=e[t]}),n}function u(e){var t=e.replace(x,"$1$2").replace(w,"").split(" ").filter(function(e){return""!=e});return g.unique_strings_array(t)}function c(e,t,n){var i=[null],r=1;for(var o in t){i=t[o].map(function(){return null}),r=i.length;break}if(""==e)return g.clone(i);for(var a=[],s=0;r>s;s++){var l=e,u=!0;for(var o in t){var c=_(t[o][s]);null===c?c=0:u=!1,l=h(l,o,c)}if(u)a.push(null);else{for(;;){var d=l;if(d=d.replace(S," $1 "),d=d.replace(C,function(e,t,n,i){var r=n.split(A).map(parseFloat),o=r.reduce(function(e,t){return e+t});return t+o+i}),d=d.replace(T,function(e,t,i,r){var o=i.split(k).map(parseFloat),a="min"==n?Math.min.apply(null,o):o.reduce(function(e,t){return e+t})/o.length;return t+a+r}),d==l)break;l=d}var f=Number(l);isNaN(f)?(console.warn("Could not evaluate "+e),a.push(null)):a.push(f)}}return a}function h(e,t,n){function i(e){return e.replace(v,"\\$1")}var r="(^|[\\s\\(\\)])",o="([\\s\\(\\)]|$)",a=r+i(t)+o;return e.replace(new RegExp(a,"g"),"$1"+n+"$2")}function d(e,t,n,i){var a,l,u,c;if(null===t){for(a in e){l=e[a],l.data=null,l.data_string="";for(u in l.segments)c=l.segments[u],c.data=null;l.gene_string=null}return!1}for(a in e){l=e[a];var h=t[l.bigg_id]||t[l.name]||null,d=r(h,n,i),f=o(h),p=s(h,d);l.data=d,l.data_string=p,l.reverse_flux=f,l.gene_string=null;for(u in l.segments)c=l.segments[u],c.data=l.data,c.reverse_flux=l.reverse_flux}return!0}function f(e,t,n,i){var o;if(null===t){for(o in e)e[o].data=null,e[o].data_string="";return!1}for(o in e){var a=e[o],l=t[a.bigg_id]||t[a.name]||null,u=r(l,n,i),c=s(l,u);a.data=u,a.data_string=c}return!0}function p(e,t,n,i,l,u){if(null===t){for(var h in e){var d=e[h];d.data=null,d.data_string="",d.reverse_flux=!1;for(var f in d.segments){var p=d.segments[f];p.data=null}d.gene_string=null}return!1}var _=[null];for(var h in t){for(var m in t[h]){_=t[h][m].map(function(){return null});break}break}for(var h in e){var v,y,d=e[h],b=d.gene_reaction_rule,x=t[d.bigg_id];"undefined"!=typeof x?(y=x,v=c(b,y,u)):(y={},v=g.clone(_));var w=r(v,n,l),S=o(v),A=s(v,w);d.data=w,d.data_string=A,d.reverse_flux=S;for(var f in d.segments){var p=d.segments[f];p.data=d.data,p.reverse_flux=d.reverse_flux}d.gene_string=a(b,y,d.genes,n,i,l)}return!0}function _(e){var t=Number(e);return isNaN(t)||parseFloat(e)!=t?null:t}var g=n(195);e.exports={import_and_check:i,text_for_data:s,float_for_data:r,reverse_flux_for_data:o,gene_string_for_data:a,csv_converter:l,genes_for_gene_reaction_rule:u,evaluate_gene_reaction_rule:c,replace_gene_in_rule:h,apply_reaction_data_to_reactions:d,apply_metabolite_data_to_nodes:f,apply_gene_data_to_reactions:p};var m=function(e){return e},v=/([.*+?^=!:${}()|\[\]\/\\])/g,y=/\n\s*\n/g,b=/\n\s*(\)*)\s*$/,x=/([\(\) ])(?:and|or)([\)\( ])/gi,w=/[\(\)]/g,S=/\(\s*(\S+)\s*\)/g,A=/\s+or\s+/i,k=/\s+and\s+/i,C=/(^|\()(\s*-?[0-9.]+\s+(?:or\s+-?[0-9.]+\s*)+)(\)|$)/gi,T=/(^|\(|or\s)(\s*-?[0-9.]+\s+(?:and\s+-?[0-9.]+\s*)+)(\sor|\)|$)/gi},function(e,t,n){function i(e,t,n,i){e.classed("escher-container",!0),i&&(d3.select("html").classed("fill-screen",!0),d3.select("body").classed("fill-screen",!0),e.classed("fill-screen-div",!0));var r=e.append("div").attr("class","escher-zoom-container"),o=r.append("div").attr("class","escher-3d-transform-container"),a=o.append("svg").attr("class","escher-svg").attr("xmlns","http://www.w3.org/2000/svg");a.select(".zoom-g").remove();var s=a.append("g").attr("class","zoom-g");this.selection=e,this.zoom_container=r,this.css3_transform_container=o,this.svg=a,this.zoomed_sel=s,this.window_translate={x:0,y:0},this.window_scale=1,this._scroll_behavior=t,this._use_3d_transform=n,this._pan_drag_on=!0,this._zoom_behavior=null,this._zoom_timeout=null,this._svg_scale=this.window_scale,this._svg_translate=this.window_translate,this.callback_manager=new v,this._update_scroll()}function r(e){this._scroll_behavior=e,this._update_scroll()}function o(e){this._use_3d_transform=e}function a(e){y.isUndefined(e)?this._pan_drag_on=!this._pan_drag_on:this._pan_drag_on=e,this._pan_drag_on?(this.zoomed_sel.classed("cursor-grab",!0).classed("cursor-grabbing",!1),this.zoomed_sel.on("mousedown.cursor",function(e){e.classed("cursor-grab",!1).classed("cursor-grabbing",!0)}.bind(null,this.zoomed_sel)).on("mouseup.cursor",function(e){e.classed("cursor-grab",!0).classed("cursor-grabbing",!1)}.bind(null,this.zoomed_sel))):(this.zoomed_sel.style("cursor",null).classed("cursor-grab",!1).classed("cursor-grabbing",!1),this.zoomed_sel.on("mousedown.cursor",null),this.zoomed_sel.on("mouseup.cursor",null)),this._update_scroll()}function s(){if(!y.contains(["zoom","pan","none"],this._scroll_behavior))throw Error("Bad value for scroll_behavior: "+this._scroll_behavior);this.zoom_container.on("mousewheel.zoom",null).on("DOMMouseScroll.zoom",null).on("wheel.zoom",null).on("dblclick.zoom",null).on("mousewheel.escher",null).on("DOMMouseScroll.escher",null).on("wheel.escher",null).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null);try{this._zoom_behavior=d3.behavior.zoom().on("zoom",function(){this.go_to(d3.event.scale,{x:d3.event.translate[0],y:d3.event.translate[1]})}.bind(this))}catch(e){return console.log("Not in a browser, so d3.behavior.zoom does not work."),void(this._zoom_behavior=null)}if(this._zoom_behavior.scale(this.window_scale),this._zoom_behavior.translate([this.window_translate.x,this.window_translate.y]),this.zoom_container.call(this._zoom_behavior),this.zoom_container.on("dblclick.zoom",null),this._pan_drag_on||this.zoom_container.on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null),"zoom"!==this._scroll_behavior&&this.zoom_container.on("mousewheel.zoom",null).on("DOMMouseScroll.zoom",null).on("wheel.zoom",null),"pan"===this._scroll_behavior){var t=function(){var e=d3.event,t=.5;e.stopPropagation(),e.preventDefault(),e.returnValue=!1;var n=function(e,n){var i=y.isUndefined(e)?n:-e/1.5;return i*t},i={x:this.window_translate.x-n(e.wheelDeltaX,e.deltaX),y:this.window_translate.y-n(e.wheelDeltaY,e.deltaY)};this.go_to(this.window_scale,i)}.bind(this);this.zoom_container.on("mousewheel.escher",t),this.zoom_container.on("DOMMouseScroll.escher",t),this.zoom_container.on("wheel.escher",t)}}function l(e,t){m.check_undefined(arguments,["scale","translate"]);var n=this._use_3d_transform;if(!e)throw new Error("Bad scale value");if(!t||!("x"in t)||!("y"in t)||isNaN(t.x)||isNaN(t.y))return console.error("Bad translate value");if(this.window_scale=e,this.window_translate=t,!y.isNull(this._zoom_behavior)){this._zoom_behavior.scale(e);var i=[t.x,t.y];this._zoom_behavior.translate(i)}n?(y.isNull(this._zoom_timeout)||clearTimeout(this._zoom_timeout),this._go_to_3d(e,t,this._svg_scale,this._svg_translate),this._zoom_timeout=y.delay(function(){this._go_to_svg(e,t)}.bind(this),100)):this._go_to_svg(e,t),this.callback_manager.run("go_to")}function u(e,t,n,i){var r=e/n,o=m.c_minus_c(t,m.c_times_scalar(i,r)),a="translate("+o.x+"px,"+o.y+"px) scale("+r+")";this.css3_transform_container.style("transform",a),this.css3_transform_container.style("-webkit-transform",a),this.css3_transform_container.style("transform-origin","0 0"),this.css3_transform_container.style("-webkit-transform-origin","0 0")}function c(){this.css3_transform_container.style("transform",null),this.css3_transform_container.style("-webkit-transform",null),this.css3_transform_container.style("transform-origin",null),this.css3_transform_container.style("-webkit-transform-origin",null)}function h(e,t,n){this.callback_manager.run("svg_start"),y.defer(function(){this._clear_3d(),this.zoomed_sel.attr("transform","translate("+t.x+","+t.y+") scale("+e+")"),this._svg_scale=this.window_scale,this._svg_translate=this.window_translate,y.defer(function(){this.callback_manager.run("svg_finish"),y.isUndefined(n)||n()}.bind(this))}.bind(this))}function d(e){var t=this.get_size(),n={x:t.width/2-((t.width/2-this.window_translate.x)*e+this.window_translate.x),y:t.height/2-((t.height/2-this.window_translate.y)*e+this.window_translate.y)};this.go_to(this.window_scale*e,m.c_plus_c(this.window_translate,n))}function f(){this.zoom_by(1.5)}function p(){this.zoom_by(.667)}function _(){return{width:parseInt(this.selection.style("width"),10),height:parseInt(this.selection.style("height"),10)}}function g(e){var t=120,n=this.get_size(),i={x:{min:-this.window_translate.x/this.window_scale+t/this.window_scale,max:-this.window_translate.x/this.window_scale+(n.width-t)/this.window_scale},y:{min:-this.window_translate.y/this.window_scale+t/this.window_scale,max:-this.window_translate.y/this.window_scale+(n.height-t)/this.window_scale}};e.x<i.x.min?(this.window_translate.x=this.window_translate.x-(e.x-i.x.min)*this.window_scale,this.go_to(this.window_scale,this.window_translate)):e.x>i.x.max&&(this.window_translate.x=this.window_translate.x-(e.x-i.x.max)*this.window_scale,this.go_to(this.window_scale,this.window_translate)),e.y<i.y.min?(this.window_translate.y=this.window_translate.y-(e.y-i.y.min)*this.window_scale,this.go_to(this.window_scale,this.window_translate)):e.y>i.y.max&&(this.window_translate.y=this.window_translate.y-(e.y-i.y.max)*this.window_scale,this.go_to(this.window_scale,this.window_translate))}var m=n(195),v=n(208),y=n(197),b=m.make_class();b.prototype={init:i,set_scroll_behavior:r,set_use_3d_transform:o,_update_scroll:s,toggle_pan_drag:a,go_to:l,_go_to_3d:u,_clear_3d:c,_go_to_svg:h,zoom_by:d,zoom_in:f,zoom_out:p,get_size:_,translate_off_screen:g},e.exports=b},function(e,t,n){function i(){}function r(e,t){return void 0===this.callbacks&&(this.callbacks={}),void 0===this.callbacks[e]&&(this.callbacks[e]=[]),this.callbacks[e].push(t),this}function o(e){return(void 0===this.callbacks||0==Object.keys(this.callbacks).length)&&console.warn("No callbacks to remove"),delete this.callbacks[e],this}function a(e,t){if(l.isUndefined(this.callbacks))return this;l.isUndefined(t)&&(t=null);var n=Array.prototype.slice.call(arguments,2);for(var i in this.callbacks){var r=i.split(".")[0];r==e&&this.callbacks[i].forEach(function(e){e.apply(t,n)})}return this}var s=n(195),l=n(197),u=s.make_class();u.prototype={init:i,set:r,remove:o,run:a},e.exports=u},function(e,t,n){function i(e,t,n,i,r,o,a,s,l,u,c){if(null===a){var h=i.get_size();a={x:-h.width,y:-h.height,width:3*h.width,height:3*h.height}}l=void 0===l||null===l||""==l?"new_map":String(l),u=void 0===u||null===u||""==u?Ae.generate_map_id():String(u),c=void 0===c||null===c?"":String(c),this.callback_manager=new Le,this.svg=e,this.defs=Ae.setup_defs(e,t),this.canvas=new Oe(n,a),this.setup_containers(n),this.sel=n,this.zoom_container=i,this.settings=r,this.cobra_model=o,this.largest_ids={reactions:-1,nodes:-1,segments:-1,text_labels:-1},this.scale=new Te,this.calc_data_stats("reaction"),this.calc_data_stats("metabolite"),this.scale.connect_to_settings(this.settings,this,M.bind(this)),this.undo_stack=new Me,this.behavior=new Ce(this,this.undo_stack),this.draw=new ke(this.behavior,this.settings),this.key_manager=new Re,this.key_manager.ctrl_equals_cmd=!0,this.enable_search=s,this.search_index=new De,this.map_name=l,this.map_id=u,this.map_description=c;this.beziers_enabled=!1,this.has_data_on_reactions=!1,this.has_data_on_nodes=!1,this.nodes={},this.reactions={},this.beziers={},this.text_labels={},this.apply_reaction_data_to_map(null),this.apply_metabolite_data_to_map(null),this.apply_gene_data_to_map(null),this.rotation_on=!1,this.listen_for_full_screen(function(){setTimeout(function(){this.zoom_extent_canvas()}.bind(this),50)}.bind(this))}function r(e,t,n,i,r,o,a,s){function l(e,t){return Ie.isUndefined(t)&&(t=0),Ie.isUndefined(e)?t:Math.max.apply(null,Object.keys(e).map(function(e){return parseInt(e)}).concat([t]))}var u=e[1].canvas,c=e[0].map_name,h=e[0].map_id,d=e[0].map_description.replace(/(\nLast Modified.*)+$/g,"")+"\nLast Modified "+Date(Date.now()).toString(),f=new Ne(t,n,i,r,o,a,u,s,c,h,d);f.reactions=e[1].reactions,f.nodes=e[1].nodes,f.text_labels=e[1].text_labels;for(var p in f.nodes){var _=f.nodes[p];if(_.connected_segments=[],s){if("metabolite"!=_.node_type)continue;f.search_index.insert("n"+p,{name:_.bigg_id,data:{type:"metabolite",node_id:p}}),f.search_index.insert("n_name"+p,{name:_.name,data:{type:"metabolite",node_id:p}})}}for(var g in f.reactions){var m=f.reactions[g];if(s){f.search_index.insert("r"+g,{name:m.bigg_id,data:{type:"reaction",reaction_id:g}}),f.search_index.insert("r_name"+g,{name:m.name,data:{type:"reaction",reaction_id:g}});for(var v in m.genes){var y=m.genes[v];f.search_index.insert("r"+g+"_g"+v,{name:y.bigg_id,data:{type:"reaction",reaction_id:g}}),f.search_index.insert("r"+g+"_g_name"+v,{name:y.name,data:{type:"reaction",reaction_id:g}})}}var b=[];for(var x in m.segments){var w=m.segments[x];if(w.reversibility=m.reversibility,w.from_node_id in f.nodes&&w.to_node_id in f.nodes){var S=f.nodes[w.from_node_id],A=f.nodes[w.to_node_id];m.metabolites.forEach(function(e){e.bigg_id==S.bigg_id?w.from_node_coefficient=e.coefficient:e.bigg_id==A.bigg_id&&(w.to_node_coefficient=e.coefficient)}),[S,A].forEach(function(e){e.connected_segments.push({segment_id:x,reaction_id:g})});var k=f.nodes[w.from_node_id],C=f.nodes[w.to_node_id];if("metabolite"==k.node_type||"metabolite"==C.node_type){var T=Ae.c_plus_c(k,Ae.c_times_scalar(Ae.c_minus_c(C,k),.5));null===w.b1&&(w.b1=T),null===w.b2&&(w.b2=T)}}else console.warn("Bad node references in segment "+x+". Deleting segment."),b.push(x)}b.forEach(function(e){delete m.segments[e]})}if(s)for(var E in f.text_labels){var M=f.text_labels[E];f.search_index.insert("l"+E,{name:M.text,data:{type:"text_label",text_label_id:E}})}f.beziers=Ee.new_beziers_for_reactions(f.reactions),f.largest_ids.reactions=l(f.reactions),f.largest_ids.nodes=l(f.nodes),f.largest_ids.text_labels=l(f.text_labels);var L=0;for(var R in f.reactions)L=l(f.reactions[R].segments,L);return f.largest_ids.segments=L,f.apply_reaction_data_to_map(null),f.apply_metabolite_data_to_map(null),f.apply_gene_data_to_map(null),f}function o(e){e.append("g").attr("id","reactions"),e.append("g").attr("id","nodes"),e.append("g").attr("id","beziers"),e.append("g").attr("id","text-labels")}function a(){this.sel.select("#reactions").selectAll(".reaction").remove(),this.sel.select("#nodes").selectAll(".node").remove(),this.sel.select("#beziers").selectAll(".bezier").remove(),this.sel.select("#text-labels").selectAll(".text-label").remove()}function s(e,t){this.callback_manager.run("set_status",null,e),clearTimeout(this._status_timer),this._status_timer=null,void 0!==t&&(this._status_timer=setTimeout(function(){this.callback_manager.run("set_status",null,"")}.bind(this),t))}function l(){this.reactions={},this.beziers={},this.nodes={},this.text_labels={},this.map_name="new_map",this.map_id=Ae.generate_map_id(),this.map_description="",this.apply_reaction_data_to_map(null),this.apply_metabolite_data_to_map(null),this.apply_gene_data_to_map(null),this.draw_everything()}function u(){return null!==this.cobra_model}function c(){this.draw_all_reactions(!0,!0),this.draw_all_nodes(!0),this.draw_all_text_labels()}function h(e,t){Ie.isUndefined(e)&&(e=!0),Ie.isUndefined(t)&&(t=!0);var n=[];for(var i in this.reactions)n.push(i);this.draw_these_reactions(n,!1),e&&this.beziers_enabled&&this.draw_all_beziers(),t&&this.clear_deleted_reactions(e)}function d(e,t){Ie.isUndefined(t)&&(t=!0);var n=Ae.object_slice_for_ids_ref(this.reactions,e),i=function(e){return this.draw.update_reaction(e,this.scale,this.cobra_model,this.nodes,this.defs,this.has_data_on_reactions)}.bind(this);if(Ae.draw_an_object(this.sel,"#reactions",".reaction",n,"reaction_id",this.draw.create_reaction.bind(this.draw),i),t){var r=Ee.bezier_ids_for_reaction_ids(n);this.draw_these_beziers(r)}}function f(e){function t(e){Ae.draw_a_nested_object(e,".segment-group","segments","segment_id",null,null,function(e){e.remove()})}Ie.isUndefined(e)&&(e=!0),Ae.draw_an_object(this.sel,"#reactions",".reaction",this.reactions,"reaction_id",null,t,function(e){e.remove()}),1==e&&this.clear_deleted_beziers()}function p(e){void 0===e&&(e=!0);var t=[];for(var n in this.nodes)t.push(n);this.draw_these_nodes(t),e&&this.clear_deleted_nodes()}function _(e){var t=Ae.object_slice_for_ids_ref(this.nodes,e),n=function(e){return this.draw.create_node(e,this.nodes,this.reactions)}.bind(this),i=function(e){return this.draw.update_node(e,this.scale,this.has_data_on_nodes,this.behavior.selectable_mousedown,this.behavior.selectable_click,this.behavior.node_mouseover,this.behavior.node_mouseout,this.behavior.selectable_drag,this.behavior.node_label_drag)}.bind(this);Ae.draw_an_object(this.sel,"#nodes",".node",t,"node_id",n,i)}function g(){Ae.draw_an_object(this.sel,"#nodes",".node",this.nodes,"node_id",null,null,function(e){e.remove()})}function m(){var e=[];for(var t in this.text_labels)e.push(t);this.draw_these_text_labels(e),this.clear_deleted_text_labels()}function v(e){var t=Ae.object_slice_for_ids_ref(this.text_labels,e),n=function(e){return this.draw.update_text_label(e,this.behavior)}.bind(this);Ae.draw_an_object(this.sel,"#text-labels",".text-label",t,"text_label_id",this.draw.create_text_label.bind(this.draw),n)}function y(){Ae.draw_an_object(this.sel,"#text-labels",".text-label",this.text_labels,"text_label_id",null,null,function(e){e.remove()})}function b(){var e=[];for(var t in this.beziers)e.push(t);this.draw_these_beziers(e),this.clear_deleted_beziers()}function x(e){var t=Ae.object_slice_for_ids_ref(this.beziers,e),n=function(e){return this.draw.update_bezier(e,this.beziers_enabled,this.behavior.bezier_drag,this.behavior.bezier_mouseover,this.behavior.bezier_mouseout,this.nodes,this.reactions)}.bind(this);Ae.draw_an_object(this.sel,"#beziers",".bezier",t,"bezier_id",this.draw.create_bezier.bind(this.draw),n)}function w(){Ae.draw_an_object(this.sel,"#beziers",".bezier",this.beziers,"bezier_id",null,null,function(e){e.remove()})}function S(){this.toggle_beziers(!0)}function A(){this.toggle_beziers(!1)}function k(e){Ie.isUndefined(e)?this.beziers_enabled=!this.beziers_enabled:this.beziers_enabled=e,this.draw_all_beziers(),this.callback_manager.run("toggle_beziers",null,this.beziers_enabled)}function C(e){var t=this.settings.get_option("reaction_styles"),n=this.settings.get_option("reaction_compare_style"),i=Pe.apply_reaction_data_to_reactions(this.reactions,e,t,n);return this.has_data_on_reactions=i,this.calc_data_stats("reaction")}function T(e){var t=this.settings.get_option("metabolite_styles"),n=this.settings.get_option("metabolite_compare_style"),i=Pe.apply_metabolite_data_to_nodes(this.nodes,e,t,n);return this.has_data_on_nodes=i,this.calc_data_stats("metabolite")}function E(e){var t=this.settings.get_option("reaction_styles"),n=this.settings.get_option("reaction_compare_style"),i=this.settings.get_option("identifiers_on_map"),r=this.settings.get_option("and_method_in_gene_reaction_rule"),o=Pe.apply_gene_data_to_reactions(this.reactions,e,t,i,n,r);return this.has_data_on_reactions=o,this.calc_data_stats("reaction")}function M(){return this.data_statistics}function L(e){function t(e){return function(t){return e.apply(null,t);
}}if(-1==["reaction","metabolite"].indexOf(e))throw new Error("Bad type "+e);"data_statistics"in this?e in this.data_statistics||(this.data_statistics[e]={}):(this.data_statistics={},this.data_statistics[e]={});var n=!0,i=[];if("metabolite"==e)for(var r in this.nodes){var o=this.nodes[r];null!==o.data&&i.push(o.data)}else if("reaction"==e)for(var a in this.reactions){var s=this.reactions[a];null!==s.data&&i.push(s.data)}var l=Ae.quartiles(i),u=[["min",t(Math.min)],["max",t(Math.max)],["mean",Ae.mean],["Q1",function(){return l[0]}],["median",function(){return l[1]}],["Q3",function(){return l[2]}]];return u.forEach(function(t){var r,o=t[0];if(0==i.length)r=null;else{var a=t[1];r=a(i)}r!=this.data_statistics[e][o]&&(n=!1),this.data_statistics[e][o]=r}.bind(this)),"reaction"==e?this.callback_manager.run("calc_data_stats__reaction",null,!n):this.callback_manager.run("calc_data_stats__metabolite",null,!n),!n}function R(){var e=[];return this.sel.select("#nodes").selectAll(".selected").each(function(t){e.push(t.node_id)}),e}function O(){var e={};return this.sel.select("#nodes").selectAll(".selected").each(function(t){e[t.node_id]=this.nodes[t.node_id]}.bind(this)),e}function P(){var e=[];return this.sel.select("#text-labels").selectAll(".selected").each(function(t){e.push(t.text_label_id)}),e}function D(){var e={};return this.sel.select("#text-labels").selectAll(".selected").each(function(t){e[t.text_label_id]=this.text_labels[t.text_label_id]}.bind(this)),e}function I(){this.sel.selectAll("#nodes,#text-labels").selectAll(".node,.text-label").classed("selected",!0)}function N(){this.sel.selectAll(".selected").classed("selected",!1)}function F(){var e=this.sel.selectAll("#nodes,#text-labels").selectAll(".node,.text-label");e.classed("selected",function(){return!d3.select(this).classed("selected")})}function B(e){this.deselect_text_labels();var t,n,i=this.sel.select("#nodes").selectAll(".node");i.classed("selected",function(i){var r=String(i.node_id)==String(e);return r&&(n=i,t={x:i.x,y:i.y}),r}),this.sel.selectAll(".start-reaction-target").style("visibility","hidden"),this.callback_manager.run("select_metabolite_with_id",null,n,t)}function z(e,t,n){n=Ie.isUndefined(n)?!1:n;var i,r=this.sel.selectAll("#nodes,#text-labels").selectAll(".node,.text-label");i=-1==d3.select(e).attr("class").indexOf("text-label")?e.parentNode:e,n?d3.select(i).classed("selected",!d3.select(i).classed("selected")):(r.classed("selected",!1),d3.select(i).classed("selected",!0));var o,a,s=this.sel.select("#nodes").selectAll(".selected"),l=0;s.each(function(e){a=e,o={x:e.x,y:e.y},l++}),this.callback_manager.run("select_selectable",null,l,a,o)}function H(){var e=null,t=this.sel.select("#nodes").selectAll(".selected");return t.classed("selected",function(t,n){return 0==n?(e=t,!0):!1}),e}function q(){var e=this.sel.select("#nodes").selectAll(".node");e.classed("selected",!1),this.callback_manager.run("deselect_nodes")}function G(e,t){this.deselect_nodes();var n=this.sel.select("#text-labels").selectAll(".text-label");n.classed("selected",function(e){return t===e});var i,r=this.sel.select("#text-labels").selectAll(".selected");r.each(function(e){i={x:e.x,y:e.y}}),this.callback_manager.run("select_text_label")}function j(){var e=this.sel.select("#text-labels").selectAll(".text-label");e.classed("selected",!1)}function U(){var e=this.get_selected_nodes(),t=this.get_selected_text_labels();(Object.keys(e).length>=1||Object.keys(t).length>=1)&&this.delete_selectable(e,t,!0)}function V(e,t,n){var i=this.segments_and_reactions_for_nodes(e),r=i.segment_objs_w_segments,o=i.reactions,a=Ae.clone(e),s=Ae.clone(r),l=Ae.clone(o),u=Ae.clone(t),c=function(t,i,r,o){this.delete_node_data(Object.keys(e)),this.delete_segment_data(r),this.delete_reaction_data(Object.keys(i)),this.delete_text_label_data(Object.keys(o));var a=!1,s=!1;this.has_data_on_reactions&&(a=this.calc_data_stats("reaction")),this.has_data_on_nodes&&(s=this.calc_data_stats("metabolite")),n&&(a?this.draw_all_reactions(!0,!0):this.clear_deleted_reactions(),s?this.draw_all_nodes(!0):this.clear_deleted_nodes(),this.clear_deleted_text_labels())}.bind(this);c(e,o,r,t),this.undo_stack.push(function(){this.extend_nodes(a),this.extend_reactions(l);var i=Object.keys(l);for(var c in s){var h=s[c],d=h.segment;this.reactions[h.reaction_id].segments[h.segment_id]=d,[d.from_node_id,d.to_node_id].forEach(function(e){if(!(e in a)){var t=this.nodes[e];t.connected_segments.push({reaction_id:h.reaction_id,segment_id:h.segment_id})}}.bind(this));var f=h.segment_id,p=h.reaction_id,_={};_[f]=h.segment,Ae.extend(this.beziers,Ee.new_beziers_for_segments(_,p)),-1==i.indexOf(h.reaction_id)&&i.push(h.reaction_id)}if(this.has_data_on_reactions){var g=this.calc_data_stats("reaction");g?this.draw_all_reactions(!0,!1):this.draw_these_reactions(i)}else n&&this.draw_these_reactions(i);if(this.has_data_on_nodes){var g=this.calc_data_stats("metabolite");n&&(g?this.draw_all_nodes(!1):this.draw_these_nodes(Object.keys(a)))}else n&&this.draw_these_nodes(Object.keys(a));Ae.extend(this.text_labels,u),n&&this.draw_these_text_labels(Object.keys(u)),t=Ae.clone(u),e=Ae.clone(a),r=Ae.clone(s),o=Ae.clone(l)}.bind(this),function(){c(e,o,r,t)}.bind(this))}function W(e){e.forEach(function(e){if(this.enable_search&&"metabolite"==this.nodes[e].node_type){var t=this.search_index.remove("n"+e)&&this.search_index.remove("n_name"+e);t||console.warn("Could not find deleted metabolite in search index")}delete this.nodes[e]}.bind(this))}function X(e){for(var t in e){var n=e[t],i=this.reactions[n.reaction_id];if(!(n.segment_id in i.segments))return;var r=i.segments[n.segment_id];[r.from_node_id,r.to_node_id].forEach(function(e){if(e in this.nodes){var t=this.nodes[e];t.connected_segments=t.connected_segments.filter(function(e){return e.segment_id!=n.segment_id})}}.bind(this)),["b1","b2"].forEach(function(e){var t=Ee.bezier_id_for_segment_id(n.segment_id,e);delete this.beziers[t]}.bind(this)),delete i.segments[n.segment_id]}}function K(e){e.forEach(function(e){var t=this.reactions[e];for(var n in t.segments)["b1","b2"].forEach(function(e){var t=Ee.bezier_id_for_segment_id(n,e);delete this.beziers[t]}.bind(this));delete this.reactions[e];var i=this.search_index.remove("r"+e)&&this.search_index.remove("r_name"+e);i||console.warn("Could not find deleted reaction "+e+" in search index");for(var r in t.genes){var i=this.search_index.remove("r"+e+"_g"+r)&&this.search_index.remove("r"+e+"_g_name"+r);i||console.warn("Could not find deleted gene "+r+" in search index")}}.bind(this))}function Y(e){e.forEach(function(e){delete this.text_labels[e];var t=this.search_index.remove("l"+e);t||console.warn("Could not find deleted text label in search index")}.bind(this))}function Z(e,t,n){function i(e,t){if(this.extend_nodes(e),this.has_data_on_nodes){var n=this.apply_metabolite_data_to_nodes(e);n?this.draw_all_nodes(!1):this.draw_these_nodes([t])}else this.draw_these_nodes([t])}if(!this.cobra_model)return console.error("No CobraModel. Cannot build new reaction");var r=Ae.clone(this.cobra_model.reactions[e]);for(var o in r.metabolites){var a=r.metabolites[o],s=this.cobra_model.metabolites[o];if(0>a){var l=String(++this.largest_ids.nodes),u={x:30,y:10},c={connected_segments:[],x:t.x,y:t.y,node_is_primary:!0,label_x:t.x+u.x,label_y:t.y+u.y,name:s.name,bigg_id:o,node_type:"metabolite"},h={};h[l]=c;break}}i.apply(this,[h,l]);var d=Ae.clone(h),f=this.new_reaction_for_metabolite(e,l,n,!1),p=f.redo,_=f.undo;return this.undo_stack.push(function(){_(),this.delete_node_data(Object.keys(h)),h=Ae.clone(d),this.clear_deleted_nodes(),this.deselect_nodes()}.bind(this),function(){i.apply(this,[h,l]),p()}.bind(this)),null}function $(e){if(this.enable_search)for(var t in e){var n=e[t];"metabolite"==n.node_type&&(this.search_index.insert("n"+t,{name:n.bigg_id,data:{type:"metabolite",node_id:t}}),this.search_index.insert("n_name"+t,{name:n.name,data:{type:"metabolite",node_id:t}}))}Ae.extend(this.nodes,e)}function J(e){if(this.enable_search)for(var t in e){var n=e[t];this.search_index.insert("r"+t,{name:n.bigg_id,data:{type:"reaction",reaction_id:t}}),this.search_index.insert("r_name"+t,{name:n.name,data:{type:"reaction",reaction_id:t}});for(var i in n.genes){var r=n.genes[i];this.search_index.insert("r"+t+"_g"+i,{name:r.bigg_id,data:{type:"reaction",reaction_id:t}}),this.search_index.insert("r"+t+"_g_name"+i,{name:r.name,data:{type:"reaction",reaction_id:t}})}}Ae.extend(this.reactions,e)}function Q(e,t,n,i){function r(e,t,n,i){if(this.extend_reactions(t),Ae.extend(this.beziers,n),this.delete_node_data([i]),this.extend_nodes(e),this.has_data_on_reactions){var r=this.calc_data_stats("reaction");r?this.draw_all_reactions(!0,!1):this.draw_these_reactions(Object.keys(t))}else this.draw_these_reactions(Object.keys(t));if(this.has_data_on_nodes){var r=this.calc_data_stats("metabolite");r?this.draw_all_nodes(!1):this.draw_these_nodes(Object.keys(e))}else this.draw_these_nodes(Object.keys(e));for(var o in e){var a=e[o];if(a.node_is_primary&&o!=i){this.select_metabolite_with_id(o);var s={x:a.x,y:a.y};this.zoom_container&&this.zoom_container.translate_off_screen(s)}}}void 0===i&&(i=!0);var o=this.nodes[t],a=this.cobra_model.reactions[e],s=Ee.new_reaction(e,a,this.cobra_model.metabolites,t,Ae.clone(o),this.largest_ids,this.settings.get_option("cofactors"),n),l=s.new_nodes,u=s.new_reactions,c=s.new_beziers;r.apply(this,[l,u,c,t]);var h=Ae.clone(l),d=Ae.clone(u),f=Ae.clone(c),p=function(){if(delete l[t],this.delete_node_data(Object.keys(l)),this.delete_reaction_data(Object.keys(u)),B.apply(this,[t]),l=Ae.clone(h),u=Ae.clone(d),c=Ae.clone(f),this.has_data_on_reactions){var e=this.calc_data_stats("reaction");e?this.draw_all_reactions(!0,!0):this.draw_these_reactions(Object.keys(u))}else this.clear_deleted_reactions(!0);if(this.has_data_on_nodes){var e=this.calc_data_stats("metabolite");e?this.draw_all_nodes(!0):this.draw_these_nodes(Object.keys(l))}else this.clear_deleted_nodes()}.bind(this),_=function(){r.apply(this,[l,u,c,t])}.bind(this);return i&&this.undo_stack.push(p,_),{undo:p,redo:_}}function ee(){var e,t=this.get_selected_nodes(),n=Object.keys(t)[0],i=(t[n],this.reactions),r=this.nodes,o=[];if(r[n].connected_segments.forEach(function(t){e=[t.reaction_id];var r;try{if(r=i[t.reaction_id].segments[t.segment_id],void 0===r)throw new Error("undefined segment")}catch(a){return void console.warn("Could not find connected segment "+t.segment_id)}o.push(r.from_node_id==n?r.to_node_id:r.from_node_id)}),1!=o.length)return void console.error("Only connected nodes with a single reaction can be selected");var a=o[0],s=[n];r[a].connected_segments.forEach(function(e){var t;try{if(t=i[e.reaction_id].segments[e.segment_id],void 0===t)throw new Error("undefined segment")}catch(o){return void console.warn("Could not find connected segment "+e.segment_id)}var l=t.from_node_id==a?t.to_node_id:t.from_node_id,u=r[l];"metabolite"==u.node_type&&l!=n&&s.push(String(l))});for(var l=0;l<s.length;l++)if(r[s[l]].connected_segments.length>1)return void console.error("Only connected nodes with a single reaction can be selected");for(var u in t)if(u!=n&&-1==s.indexOf(u))return void console.warn("Selected nodes are not on the same reaction");var c=[],h=s.length-1,d=r[s[h]],f=d.node_is_primary,p={x:d.x,y:d.y,label_x:d.label_x,label_y:d.label_y};d.connected_segments.length>1&&console.warn("Too many connected segments for node "+d.node_id);var _,g=d.connected_segments[0];try{if(_=i[g.reaction_id].segments[g.segment_id],void 0===_)throw new Error("undefined segment")}catch(m){return void console.error("Could not find connected segment "+g.segment_id)}var v,y={b1:_.b1,b2:_.b2};s.forEach(function(e){var t=r[e],n=t.node_is_primary,o={x:t.x,y:t.y,label_x:t.label_x,label_y:t.label_y},a=t.connected_segments[0],s=i[a.reaction_id].segments[a.segment_id],l={b1:s.b1,b2:s.b2};t.node_is_primary=f,t.x=p.x,t.y=p.y,t.label_x=p.label_x,t.label_y=p.label_y,s.b1=y.b1,s.b2=y.b2,f=n,p=o,y=l,t.node_is_primary&&(v=e),c.push(e)});var b=r[a].connected_segments,h=b.length-1,x=[b[h]];b.forEach(function(e,t){h!=t&&x.push(e)}),r[a].connected_segments=x,this.draw_these_nodes(c),this.draw_these_reactions(e),this.select_metabolite_with_id(v)}function te(){var e=this.get_selected_node_ids(),t=function(e){var t={},n=this.settings.get_option("hide_secondary_metabolites");if(e.forEach(function(e){if(!(e in this.nodes))return void console.warn("Could not find node: "+e);var n=this.nodes[e];"metabolite"==n.node_type&&(n.node_is_primary=!n.node_is_primary,t[e]=n)}.bind(this)),this.draw_these_nodes(Object.keys(t)),n){var i=this.segments_and_reactions_for_nodes(t),r={};for(var o in i.segment_objs_w_segments){var a=i.segment_objs_w_segments[o].reaction_id;r[a]=!0}this.draw_these_reactions(Object.keys(r))}}.bind(this);t(e),this.undo_stack.push(function(){t(e)},function(){t(e)})}function ne(e){var t={},n={},i={},r=this.reactions;for(var o in e){var a=e[o];a.connected_segments.forEach(function(e){var n;try{if(n=r[e.reaction_id].segments[e.segment_id],void 0===n)throw new Error("undefined segment")}catch(o){return void console.warn("Could not find connected segments for node")}var a=Ae.clone(e);a.segment=Ae.clone(n),t[e.segment_id]=a,e.reaction_id in i||(i[e.reaction_id]=[]),i[e.reaction_id].push(e.segment_id)})}for(var s in i){var l=r[s],u=i[s],c=!0;for(var h in l.segments)-1==u.indexOf(h)&&(c=!1);c&&(n[s]=l)}return{segment_objs_w_segments:t,reactions:n}}function ie(e,t){var n=Ee.new_text_label(this.largest_ids,t,e);this.text_labels[n.id]=n.label;this.draw_these_text_labels([n.id]);return this.search_index.insert("l"+n.id,{name:t,data:{type:"text_label",text_label_id:n.id}}),n.id}function re(e,t,n){var i=this.text_labels[e].text,r=function(t,n){this.text_labels[e].text=t,n&&this.draw_these_text_labels([e]);var i="l"+e,r=this.search_index.remove(i);r||console.warn("Could not find modified text label in search index"),this.search_index.insert(i,{name:t,data:{type:"text_label",text_label_id:e}})}.bind(this);r(t,n),this.undo_stack.push(function(){r(i,n)},function(){r(t,n)})}function oe(e){this._zoom_extent(e,"nodes")}function ae(e){this._zoom_extent(e,"canvas")}function se(e,t){Ie.isUndefined(e)&&(e="nodes"==t?.2:0),Ie.isUndefined(t)&&(t="canvas");var n,i,r=this.get_size();if(e*=r.height,"nodes"==t){var o={x:null,y:null},a={x:null,y:null};for(var s in this.nodes){var l=this.nodes[s];null===o.x&&(o.x=l.x),null===o.y&&(o.y=l.y),null===a.x&&(a.x=l.x),null===a.y&&(a.y=l.y),o.x=Math.min(o.x,l.x),o.y=Math.min(o.y,l.y),a.x=Math.max(a.x,l.x),a.y=Math.max(a.y,l.y)}n=Math.min((r.width-2*e)/(a.x-o.x),(r.height-2*e)/(a.y-o.y)),i={x:-(o.x*n)+e+(r.width-2*e-(a.x-o.x)*n)/2,y:-(o.y*n)+e+(r.height-2*e-(a.y-o.y)*n)/2}}else{if("canvas"!=t)return console.error("Did not recognize mode");n=Math.min((r.width-2*e)/this.canvas.width,(r.height-2*e)/this.canvas.height),i={x:-(this.canvas.x*n)+e+(r.width-2*e-this.canvas.width*n)/2,y:-(this.canvas.y*n)+e+(r.height-2*e-this.canvas.height*n)/2}}return this.zoom_container.go_to(n,i),null}function le(){return this.zoom_container.get_size()}function ue(e){var t=this.reactions[e],n=.5,i=this.get_size(),r={x:-t.label_x*n+i.width/2,y:-t.label_y*n+i.height/2};this.zoom_container.go_to(n,r)}function ce(e){var t=this.nodes[e],n=.5,i=this.get_size(),r={x:-t.label_x*n+i.width/2,y:-t.label_y*n+i.height/2};this.zoom_container.go_to(n,r)}function he(e){var t=this.text_labels[e],n=.5,i=this.get_size(),r={x:-t.x*n+i.width/2,y:-t.y*n+i.height/2};this.zoom_container.go_to(n,r)}function de(e){this.highlight(this.sel.selectAll("#r"+e).selectAll("text"))}function fe(e){this.highlight(this.sel.selectAll("#n"+e).selectAll("text"))}function pe(e){this.highlight(this.sel.selectAll("#l"+e).selectAll("text"))}function _e(e){this.sel.selectAll(".highlight").classed("highlight",!1),null!==e&&e.classed("highlight",!0)}function ge(){return document.fullscreenEnabled?"fullscreenchange":document.mozFullScreenEnabled?"mozfullscreenchange":document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":null}function me(e){document.addEventListener(ge(),e),this.full_screen_listener=e}function ve(){document.removeEventListener(ge(),this.full_screen_listener)}function ye(){var e=this.zoom_container.selection,t=e.node(),n=document,i=n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement;if(i)if(e.classed("full-screen-on",!1),n.exitFullscreen)n.exitFullscreen();else if(n.mozCancelFullScreen)n.mozCancelFullScreen();else if(n.webkitExitFullscreen)n.webkitExitFullscreen();else{if(!n.msExitFullscreen)throw Error("Cannot exit full screen");n.msExitFullscreen()}else if(e.classed("full-screen-on",!0),t.requestFullscreen)t.requestFullscreen();else if(t.mozRequestFullScreen)t.mozRequestFullScreen();else if(t.webkitRequestFullscreen)t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);else{if(!t.msRequestFullscreen)throw Error("Full screen does not seem to be supported on this system.");t.msRequestFullscreen()}}function be(){Ae.download_json(this.map_for_export(),this.map_name)}function xe(){var e=[{map_name:this.map_name,map_id:this.map_id,map_description:this.map_description,homepage:"https://escher.github.io",schema:"https://escher.github.io/escher/jsonschema/1-0-0#"},{reactions:Ae.clone(this.reactions),nodes:Ae.clone(this.nodes),text_labels:Ae.clone(this.text_labels),canvas:this.canvas.size_and_location()}];for(var t in e[1].reactions){var n=e[1].reactions[t],i={};["name","bigg_id","reversibility","label_x","label_y","gene_reaction_rule","genes","metabolites"].forEach(function(e){i[e]=n[e]}),i.segments={};for(var r in n.segments){var o=n.segments[r],a={};["from_node_id","to_node_id","b1","b2"].forEach(function(e){a[e]=o[e]}),i.segments[r]=a}e[1].reactions[t]=i}for(var s in e[1].nodes){var l,u=e[1].nodes[s],c={};l="metabolite"==u.node_type?["node_type","x","y","bigg_id","name","label_x","label_y","node_is_primary"]:["node_type","x","y"],l.forEach(function(e){c[e]=u[e]}),e[1].nodes[s]=c}for(var h in e[1].text_labels){var d=e[1].text_labels[h],f={},l=["x","y","text"];l.forEach(function(e){f[e]=d[e]}),e[1].text_labels[h]=f}var p=e[1].canvas,_={},l=["x","y","width","height"];return l.forEach(function(e){_[e]=p[e]}),e[1].canvas=_,e}function we(){this.callback_manager.run("before_svg_export");var e=this.zoom_container.window_scale,t=this.zoom_container.window_translate,n=this.canvas.size_and_location(),i={w:this.canvas.mouse_node.attr("width"),h:this.canvas.mouse_node.attr("height"),transform:this.canvas.mouse_node.attr("transform")};this.zoom_container._go_to_svg(1,{x:-n.x,y:-n.y},function(){this.svg.attr("width",n.width),this.svg.attr("height",n.height),this.canvas.mouse_node.attr("width","0px"),this.canvas.mouse_node.attr("height","0px"),this.canvas.mouse_node.attr("transform",null);var r=this.sel.selectAll(".multimarker-circle,.midmarker-circle,#canvas").style("visibility","hidden");Ae.download_svg("saved_map",this.svg,!0),this.zoom_container._go_to_svg(e,t,function(){this.svg.attr("width",null),this.svg.attr("height",null),this.canvas.mouse_node.attr("width",i.w),this.canvas.mouse_node.attr("height",i.h),this.canvas.mouse_node.attr("transform",i.transform),r.style("visibility",null),this.callback_manager.run("after_svg_export")}.bind(this))}.bind(this))}function Se(){if(this.callback_manager.run("before_convert_map"),!this.has_cobra_model())throw Error("No COBRA model loaded.");var e,t=this.cobra_model,n={},i=["name","gene_reaction_rule","genes"],r={},o=["name"];for(var a in this.reactions){var s=this.reactions[a];e=!1;for(var l in t.reactions){var u=t.reactions[l];u.bigg_id==s.bigg_id&&(i.forEach(function(e){s[e]=u[e]}),e=!0)}e||(n[a]=!0)}for(var c in this.nodes){var h=this.nodes[c];if("metabolite"==h.node_type){e=!1;for(var d in t.metabolites){var f=t.metabolites[d];f.bigg_id==h.bigg_id&&(o.forEach(function(e){h[e]=f[e]}),e=!0)}e||(r[c]=!0)}}var p=Object.keys(n).length,_=Object.keys(r).length,g=3e3;0==p&&0==_?this.set_status("Successfully converted attributes.",g):0==_?(this.set_status("Converted attributes, but count not find "+p+" reactions in the model.",g),this.settings.set_conditional("highlight_missing",!0)):0==p?(this.set_status("Converted attributes, but count not find "+_+" metabolites in the model.",g),this.settings.set_conditional("highlight_missing",!0)):(this.set_status("Converted attributes, but count not find "+p+" reactions and "+_+" metabolites in the model.",g),this.settings.set_conditional("highlight_missing",!0)),this.draw_everything(),this.callback_manager.run("after_convert_map")}var Ae=n(195),ke=n(210),Ce=n(211),Te=n(213),Ee=n(212),Me=n(214),Le=n(208),Re=n(215),Oe=n(217),Pe=n(206),De=n(218),Ie=(n(219),n(197)),Ne=Ae.make_class();Ne.from_data=r,Ne.prototype={init:i,setup_containers:o,reset_containers:a,set_status:s,clear_map:l,select_all:I,select_none:N,invert_selection:F,select_selectable:z,select_metabolite_with_id:B,select_single_node:H,deselect_nodes:q,select_text_label:G,deselect_text_labels:j,new_reaction_from_scratch:Z,extend_nodes:$,extend_reactions:J,new_reaction_for_metabolite:Q,cycle_primary_node:ee,toggle_selected_node_primary:te,new_text_label:ie,edit_text_label:re,delete_selected:U,delete_selectable:V,delete_node_data:W,delete_segment_data:X,delete_reaction_data:K,delete_text_label_data:Y,get_selected_node_ids:R,get_selected_nodes:O,get_selected_text_label_ids:P,get_selected_text_labels:D,segments_and_reactions_for_nodes:ne,draw_everything:c,draw_all_reactions:h,draw_these_reactions:d,clear_deleted_reactions:f,draw_all_nodes:p,draw_these_nodes:_,clear_deleted_nodes:g,draw_all_text_labels:m,draw_these_text_labels:v,clear_deleted_text_labels:y,draw_all_beziers:b,draw_these_beziers:x,clear_deleted_beziers:w,toggle_beziers:k,hide_beziers:A,show_beziers:S,has_cobra_model:u,apply_reaction_data_to_map:C,apply_metabolite_data_to_map:T,apply_gene_data_to_map:E,get_data_statistics:M,calc_data_stats:L,zoom_extent_nodes:oe,zoom_extent_canvas:ae,_zoom_extent:se,get_size:le,zoom_to_reaction:ue,zoom_to_node:ce,zoom_to_text_label:he,highlight_reaction:de,highlight_node:fe,highlight_text_label:pe,highlight:_e,listen_for_full_screen:me,unlisten_for_full_screen:ve,full_screen:ye,save:be,map_for_export:xe,save_svg:we,convert_map:Se},e.exports=Ne},function(e,t,n){function i(e,t){this.behavior=e,this.settings=t,this.callback_manager=new x}function r(e){e.append("rect").attr("class","membrane"),this.callback_manager.run("create_membrane",this,e)}function o(e){e.attr("width",function(e){return e.width}).attr("height",function(e){return e.height}).attr("transform",function(e){return"translate("+e.x+","+e.y+")"}).style("stroke-width",function(e){return 10}).attr("rx",function(e){return 20}).attr("ry",function(e){return 20}),this.callback_manager.run("update_membrane",this,e)}function a(e){e.append("g").attr("id",function(e){return"r"+e.reaction_id}).attr("class","reaction").call(this.create_reaction_label.bind(this)),this.callback_manager.run("create_reaction",this,e)}function s(e,t,n,i,r,o){e.select(".reaction-label-group").call(function(e){return this.update_reaction_label(e,o)}.bind(this)),y.draw_a_nested_object(e,".segment-group","segments","segment_id",this.create_segment.bind(this),function(e){return this.update_segment(e,t,n,i,r,o)}.bind(this),function(e){e.remove()}),this.callback_manager.run("update_reaction",this,e)}function l(e){var t=e.append("g").attr("class","reaction-label-group");t.append("title"),t.append("text").attr("class","reaction-label label"),t.append("g").attr("class","all-genes-label-group"),this.callback_manager.run("create_reaction_label",this,e)}function u(e,t){var n=(d3.format(".4g"),this.settings.get_option("identifiers_on_map")),i="bigg_id"==n?"name":"bigg_id",r=this.settings.get_option("reaction_styles"),o=this.settings.get_option("show_gene_reaction_rules"),a=this.settings.get_option("hide_all_labels"),s=this.settings.get_option("gene_font_size"),l=this.behavior.label_mousedown,u=this.behavior.label_mouseover,c=this.behavior.label_mouseout;e.attr("transform",function(e){return"translate("+e.label_x+","+e.label_y+")"}).call(this.behavior.turn_off_drag).call(this.behavior.reaction_label_drag);var h=e.select(".reaction-label").attr("visibility",a?"hidden":"visible");a||(h.text(function(e){var i=e[n];return t&&-1!=r.indexOf("text")&&(i+=" "+e.data_string),i}).on("mousedown",l).on("mouseover",u).on("mouseout",c),e.select("title").text(function(e){return e[i]}));var d=e.select(".all-genes-label-group").selectAll(".gene-label-group").data(function(e){var t="gene_string"in e&&null!==e.gene_string&&o&&!a&&-1!==r.indexOf("text"),i="gene_reaction_rule"in e&&null!==e.gene_reaction_rule&&o&&!a;return t?e.gene_string:i?b.gene_string_for_data(e.gene_reaction_rule,null,e.genes,null,n,null):[]}),f=d.enter().append("g").attr("class","gene-label-group");f.append("text").attr("class","gene-label").style("font-size",s+"px"),f.append("title"),d.attr("transform",function(e,t){return"translate(0, "+1.5*s*(t+1)+")"}),d.select("text").text(function(e){return e.text}),d.select("title").text(function(e){return e[i]}),d.exit().remove(),this.callback_manager.run("update_reaction_label",this,e)}function c(e){var t=e.append("g").attr("class","segment-group").attr("id",function(e){return"s"+e.segment_id});t.append("path").attr("class","segment"),t.append("g").attr("class","arrowheads"),t.append("g").attr("class","stoichiometry-labels"),this.callback_manager.run("create_segment",this,e)}function h(e,t,n,i,r,o){var a=this.settings.get_option("reaction_styles"),s=o&&-1!=a.indexOf("size"),l=o&&-1!=a.indexOf("color"),u=this.settings.get_option("reaction_no_data_size"),c=this.settings.get_option("reaction_no_data_color"),h=this.settings.get_option("highlight_missing"),d=this.settings.get_option("hide_secondary_metabolites"),f=this.settings.get_option("primary_metabolite_radius"),p=this.settings.get_option("secondary_metabolite_radius"),_=function(e,n){var i=20,r=13;return n&&(r=null===e?u:t.reaction_size(e),isNaN(r)&&(r=u),i=2*r),{width:i,height:r}},g=function(e,t,n,i){var r=t||n>0?e.height:0,o=i?f:p;return o+r+10};e.selectAll(".segment").datum(function(){return this.parentNode.__data__}).style("visibility",function(e){var t=i[e.from_node_id],n=i[e.to_node_id];return d&&("metabolite"==n.node_type&&!n.node_is_primary||"metabolite"==t.node_type&&!t.node_is_primary)?"hidden":null}).attr("d",function(e){if(null===e.from_node_id||null===e.to_node_id)return null;var t=i[e.from_node_id],n=i[e.to_node_id],r=e.b1,o=e.b2;if("metabolite"==t.node_type){var a=_(e.data,s),l=g(a,e.reversibility,e.from_node_coefficient,t.node_is_primary),u=null===r?n:r;t=v(l,t,u,"start")}if("metabolite"==n.node_type){var a=_(e.data,s),l=g(a,e.reversibility,e.to_node_coefficient,n.node_is_primary),u=null===o?t:o;n=v(l,u,n,"end")}var c="M"+t.x+","+t.y+" ";return null!==r&&null!==o&&(c+="C"+r.x+","+r.y+" "+o.x+","+o.y+" "),c+=n.x+","+n.y}).style("stroke",function(e){var i=this.parentNode.parentNode.__data__.bigg_id,r=h&&null!==n&&!(i in n.reactions);if(r)return"red";if(l){var o=e.data;return null===o?c:t.reaction_color(o)}return null}).style("stroke-width",function(e){if(s){var n=e.data;return null===n?u:t.reaction_size(n)}return null});var m=e.select(".arrowheads").selectAll(".arrowhead").data(function(e){var t=[],n=i[e.from_node_id],r=e.b1,o=i[e.to_node_id],a=e.b2;if(d&&("metabolite"==o.node_type&&!o.node_is_primary||"metabolite"==n.node_type&&!n.node_is_primary))return t;if("metabolite"==n.node_type&&(e.reversibility||e.from_node_coefficient>0)){var l=_(e.data,s),u=g(l,e.reversibility,e.from_node_coefficient,n.node_is_primary),c=null===r?o:r,h=y.to_degrees(y.get_angle([n,c]))+90,f=v(u,n,c,"start");t.push({data:e.data,x:f.x,y:f.y,size:l,rotation:h,show_arrowhead_flux:e.from_node_coefficient<0==e.reverse_flux||0==e.data})}if("metabolite"==o.node_type&&(e.reversibility||e.to_node_coefficient>0)){var l=_(e.data,s),u=g(l,e.reversibility,e.to_node_coefficient,o.node_is_primary),c=null===a?n:a,h=y.to_degrees(y.get_angle([o,c]))+90,f=v(u,c,o,"end");t.push({data:e.data,x:f.x,y:f.y,size:l,rotation:h,show_arrowhead_flux:e.to_node_coefficient<0==e.reverse_flux||0==e.data})}return t});m.enter().append("path").classed("arrowhead",!0),m.attr("d",function(e){return"M"+[-e.size.width/2,0]+" L"+[0,e.size.height]+" L"+[e.size.width/2,0]+" Z"}).attr("transform",function(e){return"translate("+e.x+","+e.y+")rotate("+e.rotation+")"}).style("fill",function(e){if(l){if(e.show_arrowhead_flux){var n=e.data;return null===n?c:t.reaction_color(n)}return"#FFFFFF"}return null}).style("stroke",function(e){if(l){var n=e.data;return null===n?c:t.reaction_color(n)}return null}),m.exit().remove();var b=e.select(".stoichiometry-labels").selectAll(".stoichiometry-label").data(function(e){var t=[],n=i[e.from_node_id],r=e.b1,o=i[e.to_node_id],a=e.b2,l=1.5;if(d&&("metabolite"==o.node_type&&!o.node_is_primary||"metabolite"==n.node_type&&!n.node_is_primary))return t;if("metabolite"==n.node_type&&1!=Math.abs(e.from_node_coefficient)){var u=_(e.data,s),c=l*g(u,!1,0,o.node_is_primary),h=null===r?o:r;h=y.c_plus_c(h,y.rotate_coords(h,.5,n));var f=v(c,n,h,"start");f=y.c_plus_c(f,{x:0,y:7}),t.push({coefficient:Math.abs(e.from_node_coefficient),x:f.x,y:f.y,data:e.data})}if("metabolite"==o.node_type&&1!=Math.abs(e.to_node_coefficient)){var u=_(e.data,s),c=l*g(u,!1,0,o.node_is_primary),h=null===a?n:a;h=y.c_plus_c(h,y.rotate_coords(h,.5,o));var f=v(c,h,o,"end");f=y.c_plus_c(f,{x:0,y:7}),t.push({coefficient:Math.abs(e.to_node_coefficient),x:f.x,y:f.y,data:e.data})}return t});b.enter().append("text").attr("class","stoichiometry-label").attr("text-anchor","middle"),b.attr("transform",function(e){return"translate("+e.x+","+e.y+")"}).text(function(e){return e.coefficient}).style("fill",function(e){if(l){var n=e.data;return null===n?c:t.reaction_color(n)}return null}),b.exit().remove(),this.callback_manager.run("update_segment",this,e)}function d(e){var t=e.append("g").attr("id",function(e){return e.bezier_id}).attr("class",function(e){return"bezier"});t.append("path").attr("class","connect-line"),t.append("circle").attr("class",function(e){return"bezier-circle "+e.bezier}).style("stroke-width",String(1)+"px").attr("r",String(7)+"px"),this.callback_manager.run("create_bezier",this,e)}function f(e,t,n,i,r,o,a){var s=this.settings.get_option("hide_secondary_metabolites");return t?(e.attr("visibility","visible"),e.style("visibility",function(e){var t=a[e.reaction_id].segments[e.segment_id],n=o[t.from_node_id],i=o[t.to_node_id];return s&&("metabolite"==i.node_type&&!i.node_is_primary||"metabolite"==n.node_type&&!n.node_is_primary)?"hidden":null}),e.select(".bezier-circle").call(this.behavior.turn_off_drag).call(n).on("mouseover",i).on("mouseout",r).attr("transform",function(e){return null==e.x||null==e.y?"":"translate("+e.x+","+e.y+")"}),e.select(".connect-line").attr("d",function(e){var t,n=a[e.reaction_id].segments[e.segment_id];return t="b1"==e.bezier?o[n.from_node_id]:o[n.to_node_id],null==e.x||null==e.y||null==t.x||null==t.y?"":"M"+e.x+", "+e.y+" "+t.x+","+t.y}),void this.callback_manager.run("update_bezier",this,e)):void e.attr("visibility","hidden")}function p(e,t,n){var i=e.append("g").attr("class","node").attr("id",function(e){return"n"+e.node_id});i.append("circle").attr("class",function(e){var t="node-circle";return null!==e.node_type&&(t+=" "+e.node_type+"-circle"),t});var r=i.filter(function(e){return"metabolite"==e.node_type});r.append("text").attr("class","node-label label"),r.append("title"),this.callback_manager.run("create_node",this,e)}function _(e,t,n,i,r,o,a,s,l){var u=this.settings.get_option("hide_secondary_metabolites"),c=this.settings.get_option("primary_metabolite_radius"),h=this.settings.get_option("secondary_metabolite_radius"),d=this.settings.get_option("marker_radius"),f=this.settings.get_option("hide_all_labels"),p=this.settings.get_option("identifiers_on_map"),_="bigg_id"==p?"name":"bigg_id",g=this.settings.get_option("metabolite_styles"),m={color:this.settings.get_option("metabolite_no_data_color"),
size:this.settings.get_option("metabolite_no_data_size")},v=(e.select(".node-circle").attr("transform",function(e){return"translate("+e.x+","+e.y+")"}).style("visibility",function(e){return u&&!e.node_is_primary?"hidden":null}).attr("r",function(e){if("metabolite"==e.node_type){var i=n&&-1!=g.indexOf("size");if(i){var r=e.data;return null===r?m.size:t.metabolite_size(r)}return e.node_is_primary?c:h}return d}).style("fill",function(e){if("metabolite"==e.node_type){var i=n&&-1!=g.indexOf("color");if(i){var r=e.data;return null===r?m.color:t.metabolite_color(r)}return null}return null}).call(this.behavior.turn_off_drag).call(s).on("mousedown",i).on("click",r).on("mouseover",o).on("mouseout",a),e.select(".node-label").attr("visibility",f?"hidden":"visible"));f||(v.style("visibility",function(e){return u&&!e.node_is_primary?"hidden":null}).attr("transform",function(e){return"translate("+e.label_x+","+e.label_y+")"}).text(function(e){var t=e[p];return n&&-1!=g.indexOf("text")&&(t+=" "+e.data_string),t}).call(this.behavior.turn_off_drag).call(l),e.select("title").text(function(e){return e[_]})),this.callback_manager.run("update_node",this,e)}function g(e){e.append("g").attr("id",function(e){return"l"+e.text_label_id}).attr("class","text-label").append("text").attr("class","label"),this.callback_manager.run("create_text_label",this,e)}function m(e){var t=this.behavior.text_label_mousedown,n=this.behavior.text_label_click,i=this.behavior.selectable_drag,r=this.behavior.turn_off_drag;e.select(".label").text(function(e){return e.text}).attr("transform",function(e){return"translate("+e.x+","+e.y+")"}).on("mousedown",t).on("click",n).call(r).call(i),this.callback_manager.run("update_text_label",this,e)}function v(e,t,n,i){y.check_undefined(arguments,["reaction_arrow_displacement","start","end","displace"]);var r,o,a=e,s=y.distance(t,n);return a&&s||console.error("Bad value"),"start"==i?(r=t.x+a*(n.x-t.x)/s,o=t.y+a*(n.y-t.y)/s):"end"==i?(r=n.x-a*(n.x-t.x)/s,o=n.y-a*(n.y-t.y)/s):console.error("bad displace value: "+i),{x:r,y:o}}var y=n(195),b=n(206),x=n(208),w=y.make_class();w.prototype={init:i,create_reaction:a,update_reaction:s,create_bezier:d,update_bezier:f,create_node:p,update_node:_,create_text_label:g,update_text_label:m,create_membrane:r,update_membrane:o,create_reaction_label:l,update_reaction_label:u,create_segment:c,update_segment:h},e.exports=w},function(e,t,n){function i(e,t){this.map=e,this.undo_stack=t,this.empty_behavior=function(){},this.rotation_mode_enabled=!1,this.rotation_drag=d3.behavior.drag(),this.selectable_mousedown=null,this.text_label_mousedown=null,this.text_label_click=null,this.selectable_drag=this.empty_behavior,this.node_mouseover=null,this.node_mouseout=null,this.label_mousedown=null,this.label_mouseover=null,this.label_mouseout=null,this.bezier_drag=this.empty_behavior,this.bezier_mouseover=null,this.bezier_mouseout=null,this.reaction_label_drag=this.empty_behavior,this.node_label_drag=this.empty_behavior,this.turn_everything_on()}function r(){this.toggle_selectable_click(!0),this.toggle_selectable_drag(!0),this.toggle_label_drag(!0),this.toggle_label_mousedown(!0)}function o(){this.toggle_selectable_click(!1),this.toggle_selectable_drag(!1),this.toggle_label_drag(!1),this.toggle_label_mousedown(!1)}function a(e){function t(){var e=this.map.sel.selectAll("#rotation-center").data([0]),t=e.enter().append("g").attr("id","rotation-center");t.append("path").attr("d","M-32 0 L32 0").attr("class","rotation-center-line"),t.append("path").attr("d","M0 -32 L0 32").attr("class","rotation-center-line"),e.attr("transform","translate("+this.center.x+","+this.center.y+")").attr("visibility","visible"),e.call(d3.behavior.drag().on("drag",function(e){var t=b.d3_transform_catch(e.attr("transform")),n=[d3.event.dx+t.translate[0],d3.event.dy+t.translate[1]];e.attr("transform","translate("+n+")"),this.center={x:n[0],y:n[1]}}.bind(this,e))),e.on("mouseover",function(){var e=parseFloat(this.selectAll("path").style("stroke-width"));this.selectAll("path").style("stroke-width",2*e+"px")}.bind(e)),e.on("mouseout",function(){this.selectAll("path").style("stroke-width",null)}.bind(e))}function n(e){this.map.sel.select("#rotation-center").attr("visibility","hidden")}function i(e){var t=[],n=[];for(var i in e){var r=e[i];void 0!==r.x&&t.push(r.x),void 0!==r.y&&n.push(r.y)}return{x:b.mean(t),y:b.mean(n)}}void 0===e?this.rotation_mode_enabled=!this.rotation_mode_enabled:this.rotation_mode_enabled=e;var r=this.map.sel.selectAll(".node-circle"),o=this.map.sel.selectAll("#canvas");if(this.rotation_mode_enabled){this.map.callback_manager.run("start_rotation");var a=this.map.get_selected_nodes();if(0==Object.keys(a).length)return void console.warn("No selected nodes");this.center=i(a),t.call(this);var s=this.map,l=Object.keys(a),u=this.map.reactions,c=this.map.nodes,h=this.map.beziers,d=function(e){d3.event.sourceEvent.stopPropagation()},f=function(e,t,n,i){var r=x.rotate_nodes(a,u,h,t,i);s.draw_these_nodes(r.node_ids),s.draw_these_reactions(r.reaction_ids)},p=function(e){},_=function(e,t,n){var i={};l.forEach(function(e){i[e]=c[e]});var r=x.rotate_nodes(i,u,h,-t,n);s.draw_these_nodes(r.node_ids),s.draw_these_reactions(r.reaction_ids)},g=function(e,t,n){var i={};l.forEach(function(e){i[e]=c[e]});var r=x.rotate_nodes(i,u,h,t,n);s.draw_these_nodes(r.node_ids),s.draw_these_reactions(r.reaction_ids)},m=function(){return this.center}.bind(this);this.rotation_drag=this._get_generic_angular_drag(d,f,p,_,g,m,this.map.sel),o.call(this.rotation_drag),this.selectable_drag=this.rotation_drag}else n.call(this),r.on("mousedown.center",null),o.on("mousedown.center",null),o.on("mousedown.drag",null),o.on("touchstart.drag",null),this.rotation_drag=null,this.selectable_drag=null}function s(e){if(void 0===e&&(e=null===this.selectable_mousedown),e){var t=this.map;this.selectable_mousedown=function(e){d3.event.stopPropagation()},this.selectable_click=function(e){d3.event.stopPropagation(),d3.event.defaultPrevented||t.select_selectable(this,e,d3.event.shiftKey)},this.node_mouseover=function(e){d3.select(this).style("stroke-width",null);var t=parseFloat(d3.select(this).style("stroke-width"));d3.select(this.parentNode).classed("selected")||d3.select(this).style("stroke-width",3*t+"px")},this.node_mouseout=function(e){d3.select(this).style("stroke-width",null)}}else this.selectable_mousedown=null,this.selectable_click=null,this.node_mouseover=null,this.node_mouseout=null,this.map.sel.select("#nodes").selectAll(".node-circle").style("stroke-width",null)}function l(e){if(void 0===e&&(e=null==this.text_edit_mousedown),e){var t=this.map;this.selection;this.text_label_mousedown=function(){if(!d3.event.defaultPrevented){var e=b.d3_transform_catch(d3.select(this).attr("transform")).translate,n={x:e[0],y:e[1]};t.callback_manager.run("edit_text_label",null,d3.select(this),n),d3.event.stopPropagation()}},this.text_label_click=null,this.map.sel.select("#text-labels").selectAll(".label").classed("edit-text-cursor",!0),this.map.sel.on("mousedown.new_text_label",function(e){d3.event.preventDefault();var t={x:d3.mouse(e)[0],y:d3.mouse(e)[1]};this.map.callback_manager.run("new_text_label",null,t)}.bind(this,this.map.sel.node()))}else this.text_label_mousedown=this.selectable_mousedown,this.text_label_click=this.selectable_click,this.map.sel.select("#text-labels").selectAll(".label").classed("edit-text-cursor",!1),this.map.sel.on("mousedown.new_text_label",null),this.map.callback_manager.run("hide_text_label_editor")}function u(e){void 0===e&&(e=this.selectable_drag===this.empty_behavior),e?(this.selectable_drag=this._get_selectable_drag(this.map,this.undo_stack),this.bezier_drag=this._get_bezier_drag(this.map,this.undo_stack)):(this.selectable_drag=this.empty_behavior,this.bezier_drag=this.empty_behavior)}function c(e){void 0===e&&(e=this.label_drag===this.empty_behavior),e?(this.reaction_label_drag=this._get_reaction_label_drag(this.map),this.node_label_drag=this._get_node_label_drag(this.map)):(this.reaction_label_drag=this.empty_behavior,this.node_label_drag=this.empty_behavior)}function h(e){if(void 0===e&&(e=null==this.label_mousedown),e){this.map;this.label_mousedown=function(e){},this.label_mouseover=function(e){},this.label_mouseout=function(e){}}else this.label_mousedown=null,this.label_mouseover=null,this.label_mouseout=null,this.map.sel.select(".node-label,.reaction-label").style("fill",null)}function d(e){void 0===e&&(e=this.bezier_drag===this.empty_behavior),e?(this.bezier_drag=this._get_bezier_drag(this.map),this.bezier_mouseover=function(e){d3.select(this).style("stroke-width",String(3)+"px")},this.bezier_mouseout=function(e){d3.select(this).style("stroke-width",String(1)+"px")}):(this.bezier_drag=this.empty_behavior,this.bezier_mouseover=null,this.bezier_mouseout=null)}function f(e){e.on("mousedown.drag",null),e.on("touchstart.drag",null)}function p(e,t){function n(t,n){var i=e.nodes[n],r=e.nodes[t],o=[];return i.connected_segments.forEach(function(i){var a;try{if(a=e.reactions[i.reaction_id].segments[i.segment_id],void 0===a)throw new Error("undefined segment")}catch(s){return void console.warn("Could not find connected segment "+i.segment_id)}if(a.from_node_id==n)a.from_node_id=t;else{if(a.to_node_id!=n)return void console.error("Segment does not connect to dragged node");a.to_node_id=t}r.connected_segments.push(i),o.push(b.clone(i))}),e.delete_node_data([n]),e.sel.selectAll(".node-to-combine").classed("node-to-combine",!1),e.draw_everything(),o}var i=d3.behavior.drag(),r=null,o=null,a=null,s=null,l=null,u=function(t,n){var i=e.text_labels[t];i.x=i.x+n.x,i.y=i.y+n.y};return i.on("dragstart",function(t){if(d3.event.sourceEvent.stopPropagation(),o={x:0,y:0},-1==d3.select(this).attr("class").indexOf("label")){var n=this.parentNode.__data__,i=n.bigg_id,a=this.parentNode;r=setTimeout(function(){a.parentNode.insertBefore(a,a.parentNode.firstChild)},200),e.sel.selectAll(".metabolite-circle").on("mouseover.combine",function(e){e.bigg_id==i&&e.node_id!=n.node_id&&d3.select(this).style("stroke-width",String(12)+"px").classed("node-to-combine",!0)}).on("mouseout.combine",function(t){t.bigg_id==i&&e.sel.selectAll(".node-to-combine").style("stroke-width",String(2)+"px").classed("node-to-combine",!1)})}}),i.on("drag",function(t){d3.select(this.parentNode).classed("selected")||e.select_selectable(this,t);var n={};-1===d3.select(this).attr("class").indexOf("label")?(n.type="node",n.id=this.parentNode.__data__.node_id):(n.type="label",n.id=this.__data__.text_label_id);var i=e.get_selected_node_ids(),r=e.get_selected_text_label_ids();a=[],l=[],"node"==n.type&&-1==i.indexOf(n.id)?a.push(n.id):"label"==n.type&&-1==r.indexOf(n.id)?l.push(n.id):(a=i,l=r),s=[];var c={x:d3.event.dx,y:d3.event.dy};o=b.c_plus_c(o,c),a.forEach(function(t){var n=e.nodes[t],i=x.move_node_and_dependents(n,t,e.reactions,e.beziers,c);s=b.unique_concat([s,i.reaction_ids])}),l.forEach(function(e){u(e,c)}),e.draw_these_nodes(a),e.draw_these_reactions(s),e.draw_these_text_labels(l)}),i.on("dragend",function(){if(null===a)return o=null,a=null,l=null,s=null,void(r=null);var i=[];if(e.sel.selectAll(".node-to-combine").each(function(e){i.push(e.node_id)}),1==i.length){var c=i[0],h=this.parentNode.__data__.node_id,d=b.clone(e.nodes[h]),f=n(c,h);t.push(function(){e.nodes[h]=d;var t=e.nodes[c],n=[];f.forEach(function(i){var r=e.reactions[i.reaction_id].segments[i.segment_id];r.from_node_id==c?r.from_node_id=h:r.to_node_id==c?r.to_node_id=h:console.error("Segment does not connect to fixed node"),t.connected_segments=t.connected_segments.filter(function(e){return!(e.reaction_id==i.reaction_id&&e.segment_id==i.segment_id)}),-1==n.indexOf(i.reaction_id)&&n.push(i.reaction_id)}),e.draw_these_nodes([h]),e.draw_these_reactions(n)},function(){n(c,h)})}else{var p=b.clone(o),_=b.clone(a),g=b.clone(l),m=b.clone(s);t.push(function(){_.forEach(function(t){var n=e.nodes[t];x.move_node_and_dependents(n,t,e.reactions,e.beziers,b.c_times_scalar(p,-1))}),g.forEach(function(e){u(e,b.c_times_scalar(p,-1))}),e.draw_these_nodes(_),e.draw_these_reactions(m),e.draw_these_text_labels(g)},function(){_.forEach(function(t){var n=e.nodes[t];x.move_node_and_dependents(n,t,e.reactions,e.beziers,p)}),g.forEach(function(e){u(e,p)}),e.draw_these_nodes(_),e.draw_these_reactions(m),e.draw_these_text_labels(g)})}e.sel.selectAll(".metabolite-circle").on("mouseover.combine",null).on("mouseout.combine",null),clearTimeout(r),o=null,a=null,l=null,s=null,r=null}),i}function _(e){var t=function(t,n,i,r,o){var a=e.reactions[t].segments[n];a[i]=b.c_plus_c(a[i],o),e.beziers[r].x=a[i].x,e.beziers[r].y=a[i].y},n=function(e){e.dragging=!0},i=function(n,i,r){t(n.reaction_id,n.segment_id,n.bezier,n.bezier_id,i),e.draw_these_reactions([n.reaction_id],!1),e.draw_these_beziers([n.bezier_id])},r=function(e){e.dragging=!1},o=function(n,i){t(n.reaction_id,n.segment_id,n.bezier,n.bezier_id,b.c_times_scalar(i,-1)),e.draw_these_reactions([n.reaction_id],!1),e.draw_these_beziers([n.bezier_id])},a=function(n,i){t(n.reaction_id,n.segment_id,n.bezier,n.bezier_id,i),e.draw_these_reactions([n.reaction_id],!1),e.draw_these_beziers([n.bezier_id])};return this._get_generic_drag(n,i,r,o,a,this.map.sel)}function g(e){var t=function(t,n){var i=e.reactions[t];i.label_x=i.label_x+n.x,i.label_y=i.label_y+n.y},n=function(e){},i=function(n,i,r){t(n.reaction_id,i),e.draw_these_reactions([n.reaction_id])},r=function(e){},o=function(n,i){t(n.reaction_id,b.c_times_scalar(i,-1)),e.draw_these_reactions([n.reaction_id])},a=function(n,i){t(n.reaction_id,i),e.draw_these_reactions([n.reaction_id])};return this._get_generic_drag(n,i,r,o,a,this.map.sel)}function m(e){var t=function(t,n){var i=e.nodes[t];i.label_x=i.label_x+n.x,i.label_y=i.label_y+n.y},n=function(e){},i=function(n,i,r){t(n.node_id,i),e.draw_these_nodes([n.node_id])},r=function(e){},o=function(n,i){t(n.node_id,b.c_times_scalar(i,-1)),e.draw_these_nodes([n.node_id])},a=function(n,i){t(n.node_id,i),e.draw_these_nodes([n.node_id])};return this._get_generic_drag(n,i,r,o,a,this.map.sel)}function v(e,t,n,i,r,o){var a,s=d3.behavior.drag(),l=this.undo_stack,u=o.node();return s.on("dragstart",function(t){d3.event.sourceEvent.stopPropagation(),a={x:0,y:0},e(t)}),s.on("drag",function(e){var n={x:d3.event.dx,y:d3.event.dy},i={x:d3.mouse(u)[0],y:d3.mouse(u)[1]};a=b.c_plus_c(a,n),t(e,n,a,i)}),s.on("dragend",function(e){var t=b.clone(e),o=b.clone(a),s={x:d3.mouse(u)[0],y:d3.mouse(u)[1]};l.push(function(){i(t,o,s)},function(){r(t,o,s)}),n(e)}),s}function y(e,t,n,i,r,o,a){var s,l=d3.behavior.drag(),u=this.undo_stack,c=a.node();return l.on("dragstart",function(t){d3.event.sourceEvent.stopPropagation(),s=0,e(t)}),l.on("drag",function(e){var n={x:d3.event.dx,y:d3.event.dy},i={x:d3.mouse(c)[0],y:d3.mouse(c)[1]},r=o(),a=b.angle_for_event(n,i,r);s+=a,t(e,a,s,r)}),l.on("dragend",function(e){var t=b.clone(e),a=s,l=b.clone(o());u.push(function(){i(t,a,l)},function(){r(t,a,l)}),n(e)}),l}var b=n(195),x=n(212),w=b.make_class();w.prototype={init:i,toggle_rotation_mode:a,turn_everything_on:r,turn_everything_off:o,toggle_selectable_click:s,toggle_text_label_edit:l,toggle_selectable_drag:u,toggle_label_drag:c,toggle_label_mousedown:h,toggle_bezier_drag:d,turn_off_drag:f,_get_selectable_drag:p,_get_bezier_drag:_,_get_reaction_label_drag:g,_get_node_label_drag:m,_get_generic_drag:v,_get_generic_angular_drag:y},e.exports=w},function(e,t,n){function i(e,t,n,i,o,a,l,u){u=Math.PI/180*u;var c,h=String(++a.reactions),p={x:o.x,y:o.y},_=300,g=[p,f.c_plus_c(p,{x:_,y:0})],m={x:(g[0].x+g[1].x)/2,y:(g[0].y+g[1].y)/2};c=Math.abs(u)<Math.PI/4||Math.abs(u-Math.PI)<Math.PI/4?{x:-50,y:-40}:{x:30,y:10};var v=20,y=f.clone(t);f.extend(y,{label_x:m.x+c.x,label_y:m.y+c.y,segments:{}});var b=[],x=[],w=0,S=0,A=!1;for(var k in y.metabolites){var C=n[k],T=y.metabolites[k],E=C.formula,M={coefficient:T,bigg_id:k,name:C.name};if(0>T){M.index=w;var L=/C([0-9]+)/.exec(E);o.bigg_id==M.bigg_id?b.push([M.index,1/0]):L&&-1==l.indexOf(f.decompartmentalize(M.bigg_id)[0])&&b.push([M.index,parseInt(L[1])]),w++}else{M.index=S;var L=/C([0-9]+)/.exec(E);o.bigg_id==M.bigg_id?(x.push([M.index,1/0]),A=!0):L&&-1==l.indexOf(f.decompartmentalize(M.bigg_id)[0])&&x.push([M.index,parseInt(L[1])]),S++}y.metabolites[k]=M}var R=function(e,t){return t[1]>e[1]?t:e},O=b.reduce(R,[0,0])[0],P=x.reduce(R,[0,0])[0];for(var k in y.metabolites){var C=y.metabolites[k];C.coefficient<0?(C.index==O&&(C.is_primary=!0),C.count=w+1):(C.index==P&&(C.is_primary=!0),C.count=S+1)}var D={},I=[{node_type:"anchor_reactants",dis:{x:v*(A?1:-1),y:0}},{node_type:"center",dis:{x:0,y:0}},{node_type:"anchor_products",dis:{x:v*(A?-1:1),y:0}}],N={};I.map(function(e){var t=String(++a.nodes),n="center"==e.node_type?"midmarker":"multimarker";D[t]={node_type:n,x:m.x+e.dis.x,y:m.y+e.dis.y,connected_segments:[],name:null,bigg_id:null,label_x:null,label_y:null,node_is_primary:null},N[e.node_type]=t});var F=[[N.anchor_reactants,N.center],[N.anchor_products,N.center]];F.map(function(e){var t=e[0],n=e[1],i=String(++a.segments);y.segments[i]={b1:null,b2:null,from_node_id:t,to_node_id:n,from_node_coefficient:null,to_node_coefficient:null,reversibility:y.reversibility,data:y.data,reverse_flux:y.reverse_flux},D[t].connected_segments.push({segment_id:i,reaction_id:h}),D[n].connected_segments.push({segment_id:i,reaction_id:h})});var B=D;for(var k in y.metabolites){var z,H,C=y.metabolites[k];C.coefficient<0?(z=O,H=N.anchor_reactants):(z=P,H=N.anchor_products);var q=s(C,z,g,m,_,A);if(o.bigg_id==C.bigg_id){var G=String(++a.segments);y.segments[G]={b1:q.b1,b2:q.b2,from_node_id:H,to_node_id:i,from_node_coefficient:null,to_node_coefficient:C.coefficient,reversibility:y.reversibility,data:y.data,reverse_flux:y.reverse_flux},o.connected_segments.push({segment_id:G,reaction_id:h}),B[H].connected_segments.push({segment_id:G,reaction_id:h})}else{var G=String(++a.segments),j=String(++a.nodes);y.segments[G]={b1:q.b1,b2:q.b2,from_node_id:H,to_node_id:j,from_node_coefficient:null,to_node_coefficient:C.coefficient,reversibility:y.reversibility,data:y.data,reverse_flux:y.reverse_flux},B[j]={connected_segments:[{segment_id:G,reaction_id:h}],x:q.circle.x,y:q.circle.y,node_is_primary:Boolean(C.is_primary),label_x:q.circle.x+c.x,label_y:q.circle.y+c.y,name:C.name,bigg_id:C.bigg_id,node_type:"metabolite"},B[H].connected_segments.push({segment_id:G,reaction_id:h})}}var U=[];for(var e in y.metabolites)U.push({bigg_id:e,coefficient:y.metabolites[e].coefficient});y.metabolites=U;var V={};V[h]=y;var W=d(V);return B[i]=o,r(B,V,W,u,p),{new_reactions:V,new_beziers:W,new_nodes:B}}function r(e,t,n,i,r){var o=function(e){return null===e?null:f.rotate_coords(e,i,r)},s=[],l=[];for(var c in e){var h=e[c],d=o({x:h.x,y:h.y}),p=a(h,t,d);h.connected_segments.map(function(e){var i=t[e.reaction_id];if(void 0!==i){var r=e.segment_id,a=i.segments[r];if(a.to_node_id==c&&a.b2){var s=o(a.b2),l=u(r,"b2");a.b2=f.c_plus_c(a.b2,s),n[l].x=a.b2.x,n[l].y=a.b2.y}else if(a.from_node_id==c&&a.b1){var s=o(a.b1),l=u(r,"b1");a.b1=f.c_plus_c(a.b1,s),n[l].x=a.b1.x,n[l].y=a.b1.y}}}),l=f.unique_concat([l,p.reaction_ids]),s.push(c)}return{node_ids:s,reaction_ids:l}}function o(e,t,n,i,r){var o=a(e,n,r);return e.connected_segments.map(function(e){var a=n[e.reaction_id];if(void 0!==a){var s=e.segment_id,l=a.segments[s];[["b1","from_node_id"],["b2","to_node_id"]].forEach(function(e){var n=e[0],o=e[1];if(l[o]==t&&l[n]){l[n]=f.c_plus_c(l[n],r);var a=i[u(s,n)];a.x=l[n].x,a.y=l[n].y}}),o.reaction_ids.indexOf(e.reaction_id)<0&&o.reaction_ids.push(e.reaction_id)}}),o}function a(e,t,n){e.x=e.x+n.x,e.y=e.y+n.y,e.label_x=e.label_x+n.x,e.label_y=e.label_y+n.y;var i=[];return e.connected_segments.map(function(r){var o=t[r.reaction_id];i.indexOf(r.reaction_id)<0&&(i.push(r.reaction_id),"midmarker"==e.node_type&&(o.label_x=o.label_x+n.x,o.label_y=o.label_y+n.y))}),{reaction_ids:i}}function s(e,t,n,i,r,o){var a,s,l=n[0],n=[f.c_minus_c(n[0],l),f.c_minus_c(n[1],l)],i=f.c_minus_c(i,l),u=80,c=.4,h=.25,d=.7*u,p=40,_=Math.min(2,e.count-1);e.is_primary?a=20:(a=10,s=e.index>t?e.index-1:e.index);var g,m,v,y,b=r-a,x=[{x:a,y:0},{x:b,y:0}];e.coefficient<0!=o&&e.is_primary?(g={x:x[0].x,y:x[0].y},v={x:i.x*(1-c)+x[0].x*c,y:i.y*(1-c)+x[0].y*c},y={x:i.x*h+g.x*(1-h),y:i.y*h+g.y*(1-h)},m={x:n[0].x,y:n[0].y}):e.coefficient<0!=o?(g={x:x[0].x+p,y:x[0].y+(d*s-d*(_-1)/2)},v={x:i.x*(1-c)+x[0].x*c,y:i.y*(1-c)+x[0].y*c},y={x:i.x*h+g.x*(1-h),y:i.y*h+g.y*(1-h)},m={x:n[0].x+p,y:n[0].y+(u*s-u*(_-1)/2)}):e.coefficient>0!=o&&e.is_primary?(g={x:x[1].x,y:x[1].y},v={x:i.x*(1-c)+x[1].x*c,y:i.y*(1-c)+x[1].y*c},y={x:i.x*h+g.x*(1-h),y:i.y*h+g.y*(1-h)},m={x:n[1].x,y:n[1].y}):e.coefficient>0!=o&&(g={x:x[1].x-p,y:x[1].y+(d*s-d*(_-1)/2)},v={x:i.x*(1-c)+x[1].x*c,y:i.y*(1-c)+x[1].y*c},y={x:i.x*h+g.x*(1-h),y:i.y*h+g.y*(1-h)},m={x:n[1].x-p,y:n[1].y+(u*s-u*(_-1)/2)});var w={};return w.b1=f.c_plus_c(l,v),w.b2=f.c_plus_c(l,y),w.circle=f.c_plus_c(l,m),w}function l(e,t,n){var i=String(++e.text_labels),r={text:t,x:n.x,y:n.y};return{id:i,label:r}}function u(e,t){return e+"_"+t}function c(e){var t=[];for(var n in e){var i=e[n];for(var r in i.segments){var o=i.segments[r];["b1","b2"].forEach(function(e){var n=o[e];null!==n&&t.push(u(r,e))})}}return t}function h(e,t){var n={};for(var i in e){var r=e[i];["b1","b2"].forEach(function(e){var o=r[e];if(null!==o){var a=u(i,e);n[a]={bezier:e,x:o.x,y:o.y,reaction_id:t,segment_id:i}}})}return n}function d(e){var t={};for(var n in e){var i=e[n],r=h(i.segments,n);f.extend(t,r)}return t}var f=n(195);e.exports={new_reaction:i,rotate_nodes:r,move_node_and_dependents:o,new_text_label:l,bezier_id_for_segment_id:u,bezier_ids_for_reaction_ids:c,new_beziers_for_segments:h,new_beziers_for_reactions:d}},function(e,t,n){function i(){this.x=d3.scale.linear(),this.y=d3.scale.linear(),this.x_size=d3.scale.linear(),this.y_size=d3.scale.linear(),this.size=d3.scale.linear(),this.reaction_color=d3.scale.linear().clamp(!0),this.reaction_size=d3.scale.linear().clamp(!0),this.metabolite_color=d3.scale.linear().clamp(!0),this.metabolite_size=d3.scale.linear().clamp(!0),this.scale_path=function(e){var t=this.x,n=this.y,i=d3.format(".2f"),e=e.replace(/(M|L)([0-9-.]+),?\s*([0-9-.]+)/g,function(e,r,o,a){return r+[i(t(parseFloat(o))),i(n(parseFloat(a)))].join(", ")}),r=/C([0-9-.]+),?\s*([0-9-.]+)\s*([0-9-.]+),?\s*([0-9-.]+)\s*([0-9-.]+),?\s*([0-9-.]+)/g;return e=e.replace(r,function(e,r,o,a,s,l,u){return"C"+i(t(parseFloat(r)))+","+i(n(parseFloat(o)))+" "+i(t(parseFloat(a)))+","+i(n(parseFloat(s)))+" "+[i(t(parseFloat(l)))+","+i(n(parseFloat(u)))]})}.bind(this),this.scale_decimals=function(e,t,n){var i=d3.format("."+String(n)+"f");return e=e.replace(/([0-9.]+)/g,function(e,n){return i(t(parseFloat(n)))})}}function r(e,t,n){function i(e,t){var n=e.map(function(e){var n;if(e.type in t)n=t[e.type];else{if("value"!=e.type)throw new Error("Bad domain type "+e.type);n=e.value}return{v:n,color:e.color,size:e.size}}).sort(function(e,t){return e.v-t.v});return{domain:n.map(function(e){return e.v}),color_range:n.map(function(e){return e.color}),size_range:n.map(function(e){return e.size})}}var r=function(e){var t=i(e,n().reaction);this.reaction_color.domain(t.domain),this.reaction_size.domain(t.domain),this.reaction_color.range(t.color_range),this.reaction_size.range(t.size_range)}.bind(this),o=function(e){var t=i(e,n().metabolite);this.metabolite_color.domain(t.domain),this.metabolite_size.domain(t.domain),this.metabolite_color.range(t.color_range),this.metabolite_size.range(t.size_range)}.bind(this);e.streams.reaction_scale.onValue(r),e.streams.metabolite_scale.onValue(o),t.callback_manager.set("calc_data_stats__reaction",function(t){t&&r(e.get_option("reaction_scale"))}),t.callback_manager.set("calc_data_stats__metabolite",function(t){t&&o(e.get_option("metabolite_scale"))})}var o=n(195),a=o.make_class();a.prototype={init:i,connect_to_settings:r},e.exports=a},function(e,t,n){function i(){var e=40;this.stack=Array(e),this.current=-1,this.oldest=-1,this.newest=-1,this.end_of_stack=!0,this.top_of_stack=!0}function r(e,t){return e+1>t-1?0:e+1}function o(e,t){return 0>e-1?t-1:e-1}function a(e,t){this.current=r(this.current,this.stack.length),this.end_of_stack?this.oldest=this.current:this.oldest==this.current&&(this.oldest=r(this.oldest,this.stack.length)),this.stack[this.current]={undo:e,redo:t},this.newest=this.current,this.top_of_stack=!0,this.end_of_stack=!1}function s(){return this.end_of_stack?console.warn("End of stack."):(this.stack[this.current].undo(),this.current==this.oldest?this.end_of_stack=!0:this.current=o(this.current,this.stack.length),void(this.top_of_stack=!1))}function l(){return this.top_of_stack?console.warn("Top of stack."):(this.end_of_stack||(this.current=r(this.current,this.stack.length)),this.stack[this.current].redo(),this.current==this.newest&&(this.top_of_stack=!0),void(this.end_of_stack=!1))}var u=n(195),c=u.make_class();c.prototype={init:i,push:a,undo:s,redo:l},e.exports=c},function(e,t,n){function i(e,t,n,i){this.assigned_keys=e||{},this.input_list=t||[],this.mousetrap=n?new h(n):new h,this.ctrl_equals_cmd=d.isBoolean(i)?i:!1,this.mousetrap.stopCallback=function(){return!1},this.enabled=!0,this.update()}function r(e,t){if(!t)return e;var n=d.isArray(e)?e:[e],i=n.reduce(function(e,t){var n=t.replace("ctrl+","meta+");return n!==t&&e.push(n),e},n.slice());return i.length===n.length?e:i}function o(){if(this.mousetrap.reset(),this.enabled)for(var e in this.assigned_keys){var t=this.assigned_keys[e];if(t.key){var n=r(t.key,this.ctrl_equals_cmd);t.input_list=this.input_list,this.mousetrap.bind(n,function(e){var t=!1;if(this.ignore_with_input)for(var n=0,i=this.input_list.length;i>n;n++)if(this.input_list[n].is_visible()){t=!0;break}t||(this.fn?this.fn.call(this.target):console.warn("No function for key: "+this.key),e.preventDefault())}.bind(t),"keydown")}}}function a(e){d.isUndefined(e)&&(e=!this.enabled),this.enabled=e,this.update()}function s(e,t){return this.add_key_listener("enter",e,t)}function l(e,t){return this.add_key_listener("escape",e,t)}function u(e,t,n){d.isUndefined(n)&&(n=!1);var i=this.mousetrap.unbind.bind(this.mousetrap,e);return this.mousetrap.bind(r(e,this.ctrl_equals_cmd),function(e){e.preventDefault(),t(),n&&i()}),i}var c=n(195),h=n(216),d=n(197),f=c.make_class();f.prototype={init:i,update:o,toggle:a,add_escape_listener:l,add_enter_listener:s,add_key_listener:u},e.exports=f},function(e,t,n){var i;!function(r,o,a){function s(e,t,n){return e.addEventListener?void e.addEventListener(t,n,!1):void e.attachEvent("on"+t,n)}function l(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return x[e.which]?x[e.which]:w[e.which]?w[e.which]:String.fromCharCode(e.which).toLowerCase()}function u(e,t){return e.sort().join(",")===t.sort().join(",")}function c(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function h(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function d(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function f(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function p(){if(!b){b={};for(var e in x)e>95&&112>e||x.hasOwnProperty(e)&&(b[x[e]]=e)}return b}function _(e,t,n){return n||(n=p()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function g(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus"),e.split("+"))}function m(e,t){var n,i,r,o=[];for(n=g(e),r=0;r<n.length;++r)i=n[r],A[i]&&(i=A[i]),t&&"keypress"!=t&&S[i]&&(i=S[i],o.push("shift")),f(i)&&o.push(i);return t=_(i,o,t),{key:i,modifiers:o,action:t}}function v(e,t){return null===e||e===o?!1:e===t?!0:v(e.parentNode,t)}function y(e){function t(e){e=e||{};var t,n=!1;for(t in b)e[t]?n=!0:b[t]=0;n||(S=!1)}function n(e,t,n,i,r,o){var a,s,l=[],c=n.type;if(!g._callbacks[e])return[];for("keyup"==c&&f(e)&&(t=[e]),a=0;a<g._callbacks[e].length;++a)if(s=g._callbacks[e][a],(i||!s.seq||b[s.seq]==s.level)&&c==s.action&&("keypress"==c&&!n.metaKey&&!n.ctrlKey||u(t,s.modifiers))){var h=!i&&s.combo==r,d=i&&s.seq==i&&s.level==o;(h||d)&&g._callbacks[e].splice(a,1),l.push(s)}return l}function i(e,t,n,i){g.stopCallback(t,t.target||t.srcElement,n,i)||e(t,n)===!1&&(h(t),d(t))}function r(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=l(e);if(t)return"keyup"==e.type&&x===t?void(x=!1):void g.handleKey(t,c(e),e)}function a(){clearTimeout(v),v=setTimeout(t,1e3)}function p(e,n,r,o){function s(t){return function(){S=t,++b[e],a()}}function u(n){i(r,n,e),"keyup"!==o&&(x=l(n)),setTimeout(t,10)}b[e]=0;for(var c=0;c<n.length;++c){var h=c+1===n.length,d=h?u:s(o||m(n[c+1]).action);_(n[c],d,o,e,c)}}function _(e,t,i,r,o){g._directMap[e+":"+i]=t,e=e.replace(/\s+/g," ");var a,s=e.split(" ");return s.length>1?void p(e,s,t,i):(a=m(e,i),g._callbacks[a.key]=g._callbacks[a.key]||[],n(a.key,a.modifiers,{type:a.action},r,e,o),void g._callbacks[a.key][r?"unshift":"push"]({callback:t,modifiers:a.modifiers,action:a.action,seq:r,level:o,combo:e}))}var g=this;if(e=e||o,!(g instanceof y))return new y(e);g.target=e,g._callbacks={},g._directMap={};var v,b={},x=!1,w=!1,S=!1;g._handleKey=function(e,r,o){var a,s=n(e,r,o),l={},u=0,c=!1;for(a=0;a<s.length;++a)s[a].seq&&(u=Math.max(u,s[a].level));for(a=0;a<s.length;++a)if(s[a].seq){if(s[a].level!=u)continue;c=!0,l[s[a].seq]=1,i(s[a].callback,o,s[a].combo,s[a].seq)}else c||i(s[a].callback,o,s[a].combo);var h="keypress"==o.type&&w;o.type!=S||f(e)||h||t(l),w=c&&"keydown"==o.type},g._bindMultiple=function(e,t,n){for(var i=0;i<e.length;++i)_(e[i],t,n)},s(e,"keypress",r),s(e,"keydown",r),s(e,"keyup",r)}for(var b,x={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},w={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},S={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},A={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},k=1;20>k;++k)x[111+k]="f"+k;for(k=0;9>=k;++k)x[k+96]=k;y.prototype.bind=function(e,t,n){var i=this;return e=e instanceof Array?e:[e],i._bindMultiple.call(i,e,t,n),i},y.prototype.unbind=function(e,t){var n=this;return n.bind.call(n,e,function(){},t)},y.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},y.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},y.prototype.stopCallback=function(e,t){var n=this;return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:v(t,n.target)?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},y.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},y.init=function(){var e=y(o);for(var t in e)"_"!==t.charAt(0)&&(y[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},y.init(),r.Mousetrap=y,"undefined"!=typeof e&&e.exports&&(e.exports=y),i=function(){return y}.call(t,n,t,e),!(i!==a&&(e.exports=i))}(window,document)},function(e,t,n){function i(e,t){this.selection=e,this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.resize_enabled=!0,this.callback_manager=new l,this.setup()}function r(e){void 0===e&&(e=!this.resize_enabled),e?this.selection.selectAll(".drag-rect").style("pointer-events","auto"):this.selection.selectAll(".drag-rect").style("pointer-events","none")}function o(){function e(){d3.event.sourceEvent.stopPropagation()}function t(e,t,n){var i=s.d3_transform_catch(n),r=i.translate;return null!==e&&(r[0]=e),null!==t&&(r[1]=t),"translate("+r+")"}function n(e){var n=e.x;e.x=Math.min(e.x+a.width-l/2,d3.event.x),a.x=e.x,a.width=a.width+(n-e.x),m.attr("transform",function(e){return t(e.x-l/2,null,m.attr("transform"))}),h.attr("transform",function(e){
return t(e.x,null,h.attr("transform"))}).attr("width",a.width*u),d.attr("transform",function(e){return t(e.x,null,d.attr("transform"))}).attr("width",a.width),y.attr("transform",function(e){return t(e.x+l/2,null,y.attr("transform"))}).attr("width",a.width-l),b.attr("transform",function(e){return t(e.x+l/2,null,b.attr("transform"))}).attr("width",a.width-l),a.callback_manager.run("resize")}function i(e){d3.event.sourceEvent.stopPropagation();var n=Math.max(e.x+l/2,e.x+a.width+d3.event.dx);a.width=n-e.x,v.attr("transform",function(e){return t(n-l/2,null,v.attr("transform"))}),h.attr("width",a.width*u),d.attr("width",a.width),y.attr("width",a.width-l),b.attr("width",a.width-l),a.callback_manager.run("resize")}function r(e){d3.event.sourceEvent.stopPropagation();var n=e.y;e.y=Math.min(e.y+a.height-l/2,d3.event.y),a.y=e.y,a.height=a.height+(n-e.y),y.attr("transform",function(e){return t(null,e.y-l/2,y.attr("transform"))}),h.attr("transform",function(e){return t(null,e.y,h.attr("transform"))}).attr("width",a.height*u),d.attr("transform",function(e){return t(null,e.y,d.attr("transform"))}).attr("height",a.height),m.attr("transform",function(e){return t(null,e.y+l/2,m.attr("transform"))}).attr("height",a.height-l),v.attr("transform",function(e){return t(null,e.y+l/2,v.attr("transform"))}).attr("height",a.height-l),a.callback_manager.run("resize")}function o(e){d3.event.sourceEvent.stopPropagation();var n=Math.max(e.y+l/2,e.y+a.height+d3.event.dy);a.height=n-e.y,b.attr("transform",function(e){return t(null,n-l/2,b.attr("transform"))}),h.attr("height",a.height*u),d.attr("height",a.height),m.attr("height",a.height-l),v.attr("height",a.height-l),a.callback_manager.run("resize")}var a=this,l=({x:this.width,y:this.height},100),u=10,c=this.selection.append("g").classed("canvas-group",!0).data([{x:this.x,y:this.y}]),h=c.append("rect").attr("id","mouse-node").attr("width",this.width*u).attr("height",this.height*u).attr("transform","translate("+[a.x-this.width*u/2,a.y-this.height*u/2]+")").attr("pointer-events","all");this.mouse_node=h;var d=c.append("rect").attr("id","canvas").attr("width",this.width).attr("height",this.height).attr("transform","translate("+[a.x,a.y]+")"),f=d3.behavior.drag().origin(Object).on("dragstart",e).on("drag",i),p=d3.behavior.drag().origin(Object).on("dragstart",e).on("drag",n),_=d3.behavior.drag().origin(Object).on("dragstart",e).on("drag",r),g=d3.behavior.drag().origin(Object).on("dragstart",e).on("drag",o),m=c.append("rect").classed("drag-rect",!0).attr("transform",function(e){return"translate("+[e.x-l/2,e.y+l/2]+")"}).attr("height",this.height-l).attr("id","dragleft").attr("width",l).attr("cursor","ew-resize").classed("resize-rect",!0).call(p),v=c.append("rect").classed("drag-rect",!0).attr("transform",function(e){return"translate("+[e.x+a.width-l/2,e.y+l/2]+")"}).attr("id","dragright").attr("height",this.height-l).attr("width",l).attr("cursor","ew-resize").classed("resize-rect",!0).call(f),y=c.append("rect").classed("drag-rect",!0).attr("transform",function(e){return"translate("+[e.x+l/2,e.y-l/2]+")"}).attr("height",l).attr("id","dragtop").attr("width",this.width-l).attr("cursor","ns-resize").classed("resize-rect",!0).call(_),b=c.append("rect").classed("drag-rect",!0).attr("transform",function(e){return"translate("+[e.x+l/2,e.y+a.height-l/2]+")"}).attr("id","dragbottom").attr("height",l).attr("width",this.width-l).attr("cursor","ns-resize").classed("resize-rect",!0).call(g)}function a(){return{x:this.x,y:this.y,width:this.width,height:this.height}}var s=n(195),l=n(208),u=s.make_class();u.prototype={init:i,toggle_resize:r,setup:o,size_and_location:a},e.exports=u},function(e,t,n){function i(){this.index={}}function r(e,t,n,i){if(!n&&e in this.index)throw new Error("id is already in the index");if(i&&!("name"in t&&"data"in t))throw new Error("malformed record");this.index[e]=t}function o(e){return e in this.index?(delete this.index[e],!0):!1}function a(e){var t=RegExp(e,"i"),n=[];for(var i in this.index){var r=this.index[i];t.exec(r.name)&&n.push(r.data)}return n}var s=n(195),l=s.make_class();l.prototype={init:i,insert:r,remove:o,find:a},e.exports=l},function(e,t,n){var i,r;(function(e,o){(function(){function a(e,t){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];this.obs=e,this.sync=t,this.lazy=n,this.queue=[]}function s(){a.apply(this,arguments)}function l(e){a.call(this,e,!0)}function u(e,t,n){this.context=e,this.method=t,this.args=n}function c(e){this.value=e}function h(){this.id=++ae}function d(e,t){return this instanceof d?(h.call(this),void(!t&&q.isFunction(e)||(null!=e?e._isNext:void 0)?(this.valueF=e,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=e))):new d(e,t)}function f(e,t){return this instanceof f?void d.call(this,e,t):new f(e,t)}function p(){return this instanceof p?void h.call(this):new p}function _(e){return this instanceof _?(this.error=e,void h.call(this)):new _(e)}function g(e){this.desc=e,this.id=++he,this.initialDesc=this.desc}function m(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];this.unsubscribe=q.bind(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[];for(var t,n=0;n<e.length;n++)t=e[n],this.add(t)}function v(e,t){this._subscribe=e,this._handleEvent=t,this.subscribe=q.bind(this.subscribe,this),this.handleEvent=q.bind(this.handleEvent,this),this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0,this.subscriptions=[],this.queue=[]}function y(e,t,n){return this instanceof y?(q.isFunction(e)&&(n=t,t=e,e=u.empty),g.call(this,e),D(t),this.dispatcher=new v(t,n),void de(this)):new y(e,t,n)}function b(e,t,n){v.call(this,t,n),this.property=e,this.subscribe=q.bind(this.subscribe,this),this.current=re,this.currentValueRootId=void 0,this.propertyEnded=!1}function x(e,t,n){g.call(this,e),D(t),this.dispatcher=new b(this,t,n),de(this)}function w(){return this instanceof w?(this.unsubAll=q.bind(this.unsubAll,this),this.subscribeAll=q.bind(this.subscribeAll,this),this.guardedSink=q.bind(this.guardedSink,this),this.sink=void 0,this.subscriptions=[],this.ended=!1,void y.call(this,new k.Desc(k,"Bus",[]),this.subscribeAll)):new w}function S(e){return[e,ue()]}var A=Array.prototype.slice,k={toString:function(){return"Bacon"}};k.version="0.7.83";var C=("undefined"!=typeof e&&null!==e?e:this).Error,T=function(){},E=function(e,t){return e},M=function(e){return e.slice(0)},L=function(e,t){if(!t)throw new C(e)},R=function(e){if((null!=e?e._isObservable:void 0)&&!(null!=e?e._isProperty:void 0))throw new C("Observable is not a Property : "+e)},O=function(e){if(!(null!=e?e._isEventStream:void 0))throw new C("not an EventStream : "+e)},P=function(e){if(!(null!=e?e._isObservable:void 0))throw new C("not an Observable : "+e)},D=function(e){return L("not a function : "+e,q.isFunction(e))},I=function(e){return e instanceof Array},N=function(e){return e&&e._isObservable},F=function(e){if(!I(e))throw new C("not an array : "+e)},B=function(e){return L("no arguments supported",0===e.length)},z=function(e){for(var t=arguments.length,n=1;t>1?t>n:n>t;t>1?n++:n--)for(var i in arguments[n])e[i]=arguments[n][i];return e},H=function(e,t){var n={}.hasOwnProperty,i=function(){};i.prototype=t.prototype,e.prototype=new i;for(var r in t)n.call(t,r)&&(e[r]=t[r]);return e},q={indexOf:function(){return Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n,i=0;i<e.length;i++)if(n=e[i],t===n)return i;return-1}}(),indexWhere:function(e,t){for(var n,i=0;i<e.length;i++)if(n=e[i],t(n))return i;return-1},head:function(e){return e[0]},always:function(e){return function(){return e}},negate:function(e){return function(t){return!e(t)}},empty:function(e){return 0===e.length},tail:function(e){return e.slice(1,e.length)},filter:function(e,t){for(var n,i=[],r=0;r<t.length;r++)n=t[r],e(n)&&i.push(n);return i},map:function(e,t){return function(){for(var n,i=[],r=0;r<t.length;r++)n=t[r],i.push(e(n));return i}()},each:function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=e[n];t(n,i)}},toArray:function(e){return I(e)?e:[e]},contains:function(e,t){return-1!==q.indexOf(e,t)},id:function(e){return e},last:function(e){return e[e.length-1]},all:function(e){for(var t,n=arguments.length<=1||void 0===arguments[1]?q.id:arguments[1],i=0;i<e.length;i++)if(t=e[i],!n(t))return!1;return!0},any:function(e){for(var t,n=arguments.length<=1||void 0===arguments[1]?q.id:arguments[1],i=0;i<e.length;i++)if(t=e[i],n(t))return!0;return!1},without:function(e,t){return q.filter(function(t){return t!==e},t)},remove:function(e,t){var n=q.indexOf(t,e);return n>=0?t.splice(n,1):void 0},fold:function(e,t,n){for(var i,r=0;r<e.length;r++)i=e[r],t=n(t,i);return t},flatMap:function(e,t){return q.fold(t,[],function(t,n){return t.concat(e(n))})},cached:function(e){var t=re;return function(){return("undefined"!=typeof t&&null!==t?t._isNone:void 0)&&(t=e(),e=void 0),t}},bind:function(e,t){return function(){return e.apply(t,arguments)}},isFunction:function(e){return"function"==typeof e},toString:function(e){var t,n,i,r={}.hasOwnProperty;try{return G++,null==e?"undefined":q.isFunction(e)?"function":I(e)?G>5?"[..]":"["+q.map(q.toString,e).toString()+"]":null!=(null!=e?e.toString:void 0)&&e.toString!==Object.prototype.toString?e.toString():"object"==typeof e?G>5?"{..}":(t=function(){var t=[];for(n in e)r.call(e,n)&&(i=function(){var t;try{return e[n]}catch(t){return t}}(),t.push(q.toString(n)+":"+q.toString(i)));return t}(),"{"+t+"}"):e}finally{G--}}},G=0;k._=q;var j=k.UpdateBarrier=function(){var e,t=[],n={},i=[],r=0,o={},a=function(t){return e?i.push(t):t()},s=function(i,r){if(e){var o=n[i.id];return"undefined"==typeof o||null===o?(o=n[i.id]=[r],t.push(i)):o.push(r)}return r()},l=function(){for(;t.length>0;)u(0,!0);o={}},u=function(e,i){var r=t[e],o=r.id,a=n[o];t.splice(e,1),delete n[o],i&&t.length>0&&c(r);for(var s,l=0;l<a.length;l++)(s=a[l])()},c=function(e){if(!o[e.id]){for(var i,r=e.internalDeps(),a=0;a<r.length;a++)if(i=r[a],c(i),n[i.id]){var s=q.indexOf(t,i);u(s,!1)}o[e.id]=!0}},h=function(t,n,o,a){if(e)return o.apply(n,a);e=t;try{var s=o.apply(n,a);l()}finally{for(e=void 0;r<i.length;){var u=i[r];r++,u()}r=0,i=[]}return s},d=function(){return e?e.id:void 0},f=function(e,t){var n=!1,i=!1,r=function(){return i=!0},o=function(){return n=!0,r()};return r=e.dispatcher.subscribe(function(e){return a(function(){if(!n){var i=t(e);if(i===k.noMore)return o()}})}),i&&r(),o},p=function(){return t.length>0};return{whenDoneWith:s,hasWaiters:p,inTransaction:h,currentEventId:d,wrappedSubscribe:f,afterTransaction:a}}();z(a.prototype,{_isSource:!0,subscribe:function(e){return this.obs.dispatcher.subscribe(e)},toString:function(){return this.obs.toString()},markEnded:function(){return this.ended=!0,!0},consume:function(){return this.lazy?{value:q.always(this.queue[0])}:this.queue[0]},push:function(e){return this.queue=[e],[e]},mayHave:function(){return!0},hasAtLeast:function(){return this.queue.length},flatten:!0}),H(s,a),z(s.prototype,{consume:function(){return this.queue.shift()},push:function(e){return this.queue.push(e)},mayHave:function(e){return!this.ended||this.queue.length>=e},hasAtLeast:function(e){return this.queue.length>=e},flatten:!1}),H(l,a),z(l.prototype,{consume:function(){var e=this.queue;return this.queue=[],{value:function(){return e}}},push:function(e){return this.queue.push(e.value())},hasAtLeast:function(){return!0}}),a.isTrigger=function(e){return(null!=e?e._isSource:void 0)?e.sync:null!=e?e._isEventStream:void 0},a.fromObservable=function(e){return(null!=e?e._isSource:void 0)?e:(null!=e?e._isProperty:void 0)?new a(e,!1):new s(e,!0)},z(u.prototype,{_isDesc:!0,deps:function(){return this.cached||(this.cached=W([this.context].concat(this.args))),this.cached},toString:function(){return q.toString(this.context)+"."+q.toString(this.method)+"("+q.map(q.toString,this.args)+")"}});var U=function(e,t){var n=e||t;if(n&&n._isDesc)return e||t;for(var i=arguments.length,r=Array(i>2?i-2:0),o=2;i>o;o++)r[o-2]=arguments[o];return new u(e,t,r)},V=function(e,t){return t.desc=e,t},W=function(e){return I(e)?q.flatMap(W,e):N(e)?[e]:("undefined"!=typeof e&&null!==e?e._isSource:void 0)?[e.obs]:[]};k.Desc=u,k.Desc.empty=new k.Desc("","",[]);var X=function(e){return function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];if("object"==typeof t&&i.length){var o=t,a=i[0];t=function(){return o[a].apply(o,arguments)},i=i.slice(1)}return e.apply(void 0,[t].concat(i))}},K=function(e){return e=Array.prototype.slice.call(e),Q.apply(void 0,e)},Y=function(e,t){return function(){for(var n=arguments.length,i=Array(n),r=0;n>r;r++)i[r]=arguments[r];return e.apply(void 0,t.concat(i))}},Z=function(e){return function(t){return function(n){if("undefined"!=typeof n&&null!==n){var i=n[t];return q.isFunction(i)?i.apply(n,e):i}}}},$=function(e,t){var n=e.slice(1).split("."),i=q.map(Z(t),n);return function(e){for(var t,n=0;n<i.length;n++)t=i[n],e=t(e);return e}},J=function(e){return"string"==typeof e&&e.length>1&&"."===e.charAt(0)},Q=X(function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return q.isFunction(e)?n.length?Y(e,n):e:J(e)?$(e,n):q.always(e)}),ee=function(e,t){return Q.apply(void 0,[e].concat(t))},te=function(e,t,n,i){if("undefined"!=typeof t&&null!==t?t._isProperty:void 0){var r=t.sampledBy(e,function(e,t){return[e,t]});return i.call(r,function(e){var t=e[0];e[1];return t}).map(function(e){var t=(e[0],e[1]);return t})}return t=ee(t,n),i.call(e,t)},ne=function(e){if(q.isFunction(e))return e;if(J(e)){var t=ie(e);return function(e,n){return e[t](n)}}throw new C("not a function or a field key: "+e)},ie=function(e){return e.slice(1)};z(c.prototype,{_isSome:!0,getOrElse:function(){return this.value},get:function(){return this.value},filter:function(e){return e(this.value)?new c(this.value):re},map:function(e){return new c(e(this.value))},forEach:function(e){return e(this.value)},isDefined:!0,toArray:function(){return[this.value]},inspect:function(){return"Some("+this.value+")"},toString:function(){return this.inspect()}});var re={_isNone:!0,getOrElse:function(e){return e},filter:function(){return re},map:function(){return re},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},oe=function(e){return("undefined"!=typeof e&&null!==e?e._isSome:void 0)||("undefined"!=typeof e&&null!==e?e._isNone:void 0)?e:new c(e)};k.noMore="<no-more>",k.more="<more>";var ae=0;h.prototype._isEvent=!0,h.prototype.isEvent=function(){return!0},h.prototype.isEnd=function(){return!1},h.prototype.isInitial=function(){return!1},h.prototype.isNext=function(){return!1},h.prototype.isError=function(){return!1},h.prototype.hasValue=function(){return!1},h.prototype.filter=function(){return!0},h.prototype.inspect=function(){return this.toString()},h.prototype.log=function(){return this.toString()},H(d,h),d.prototype.isNext=function(){return!0},d.prototype.hasValue=function(){return!0},d.prototype.value=function(){var e;return(null!=(e=this.valueF)?e._isNext:void 0)?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},d.prototype.fmap=function(e){var t,n;return this.valueInternal?(n=this.valueInternal,this.apply(function(){return e(n)})):(t=this,this.apply(function(){return e(t.value())}))},d.prototype.apply=function(e){return new d(e)},d.prototype.filter=function(e){return e(this.value())},d.prototype.toString=function(){return q.toString(this.value())},d.prototype.log=function(){return this.value()},d.prototype._isNext=!0,H(f,d),f.prototype._isInitial=!0,f.prototype.isInitial=function(){return!0},f.prototype.isNext=function(){return!1},f.prototype.apply=function(e){return new f(e)},f.prototype.toNext=function(){return new d(this)},H(p,h),p.prototype.isEnd=function(){return!0},p.prototype.fmap=function(){return this},p.prototype.apply=function(){return this},p.prototype.toString=function(){return"<end>"},H(_,h),_.prototype.isError=function(){return!0},_.prototype.fmap=function(){return this},_.prototype.apply=function(){return this},_.prototype.toString=function(){return"<error> "+q.toString(this.error)},k.Event=h,k.Initial=f,k.Next=d,k.End=p,k.Error=_;var se=function(e){return new f(e,!0)},le=function(e){return new d(e,!0)},ue=function(){return new p},ce=function(e){return e&&e._isEvent?e:le(e)},he=0,de=function(){};z(g.prototype,{_isObservable:!0,subscribe:function(e){return j.wrappedSubscribe(this,e)},subscribeInternal:function(e){return this.dispatcher.subscribe(e)},onValue:function(){var e=K(arguments);return this.subscribe(function(t){return t.hasValue()?e(t.value()):void 0})},onValues:function(e){return this.onValue(function(t){return e.apply(void 0,t)})},onError:function(){var e=K(arguments);return this.subscribe(function(t){return t.isError()?e(t.error):void 0})},onEnd:function(){var e=K(arguments);return this.subscribe(function(t){return t.isEnd()?e():void 0})},name:function(e){return this._name=e,this},withDescription:function(){return this.desc=U.apply(void 0,arguments),this},toString:function(){return this._name?this._name:this.desc.toString()},internalDeps:function(){return this.initialDesc.deps()}}),g.prototype.assign=g.prototype.onValue,g.prototype.forEach=g.prototype.onValue,g.prototype.inspect=g.prototype.toString,k.Observable=g,z(m.prototype,{add:function(e){var t=this;if(!this.unsubscribed){var n=!1,i=T;this.starting.push(e);var r=function(){return t.unsubscribed?void 0:(n=!0,t.remove(i),q.remove(e,t.starting))};return i=e(this.unsubscribe,r),this.unsubscribed||n?i():this.subscriptions.push(i),q.remove(e,this.starting),i}},remove:function(e){return this.unsubscribed?void 0:void 0!==q.remove(e,this.subscriptions)?e():void 0},unsubscribe:function(){if(!this.unsubscribed){this.unsubscribed=!0;for(var e=this.subscriptions,t=0;t<e.length;t++)e[t]();return this.subscriptions=[],this.starting=[],[]}},count:function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},empty:function(){return 0===this.count()}}),k.CompositeUnsubscribe=m,v.prototype.hasSubscribers=function(){return this.subscriptions.length>0},v.prototype.removeSub=function(e){return this.subscriptions=q.without(e,this.subscriptions),this.subscriptions},v.prototype.push=function(e){return e.isEnd()&&(this.ended=!0),j.inTransaction(e,this,this.pushIt,[e])},v.prototype.pushToSubscriptions=function(e){try{for(var t=this.subscriptions,n=t.length,i=0;n>i;i++){var r=t[i],o=r.sink(e);(o===k.noMore||e.isEnd())&&this.removeSub(r)}return!0}catch(a){throw this.pushing=!1,this.queue=[],a}},v.prototype.pushIt=function(e){if(this.pushing)return this.queue.push(e),k.more;if(e!==this.prevError){for(e.isError()&&(this.prevError=e),this.pushing=!0,this.pushToSubscriptions(e),this.pushing=!1;this.queue.length;)e=this.queue.shift(),this.push(e);return this.hasSubscribers()?k.more:(this.unsubscribeFromSource(),k.noMore)}},v.prototype.handleEvent=function(e){return this._handleEvent?this._handleEvent(e):this.push(e)},v.prototype.unsubscribeFromSource=function(){this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},v.prototype.subscribe=function(e){var t;return this.ended?(e(ue()),T):(D(e),t={sink:e},this.subscriptions.push(t),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),D(this.unsubSrc)),function(e){return function(){return e.removeSub(t),e.hasSubscribers()?void 0:e.unsubscribeFromSource()}}(this))},k.Dispatcher=v,H(y,g),z(y.prototype,{_isEventStream:!0,toProperty:function(e){var t=0===arguments.length?re:oe(function(){return e}),n=this.dispatcher,i=new k.Desc(this,"toProperty",[e]);return new x(i,function(e){var i=!1,r=!1,o=T,a=k.more,s=function(){return i?void 0:t.forEach(function(t){return i=!0,a=e(new f(t)),a===k.noMore?(o(),o=T,T):void 0})};return o=n.subscribe(function(n){return n.hasValue()?n.isInitial()&&!r?(t=new c(function(){return n.value()}),k.more):(n.isInitial()||s(),i=!0,t=new c(n),e(n)):(n.isEnd()&&(a=s()),a!==k.noMore?e(n):void 0)}),r=!0,s(),o})},toEventStream:function(){return this},withHandler:function(e){return new y(new k.Desc(this,"withHandler",[e]),this.dispatcher.subscribe,e)}}),k.EventStream=y,k.never=function(){return new y(U(k,"never"),function(e){return e(ue()),T})},k.when=function(){if(0===arguments.length)return k.never();var e=arguments.length,t="when: expecting arguments in the form (Observable+,function)+";L(t,e%2===0);for(var n=[],i=[],r=0,o=[];e>r;){o[r]=arguments[r],o[r+1]=arguments[r+1];for(var s,l=q.toArray(arguments[r]),u=pe(arguments[r+1]),c={f:u,ixs:[]},h=!1,d=0;d<l.length;d++){s=l[d];var f=q.indexOf(n,s);h||(h=a.isTrigger(s)),0>f&&(n.push(s),f=n.length-1);for(var p,_=0;_<c.ixs.length;_++)p=c.ixs[_],p.index===f&&p.count++;c.ixs.push({index:f,count:1})}L("At least one EventStream required",h||!l.length),l.length>0&&i.push(c),r+=2}if(!n.length)return k.never();n=q.map(a.fromObservable,n);var g=q.any(n,function(e){return e.flatten})&&fe(q.map(function(e){return e.obs},n)),m=new k.Desc(k,"when",o),v=new y(m,function(e){var t=[],r=!1,o=function(e){for(var t,i=0;i<e.ixs.length;i++)if(t=e.ixs[i],!n[t.index].hasAtLeast(t.count))return!1;return!0},a=function(e){return!e.sync||e.ended},s=function(e){for(var t,i=0;i<e.ixs.length;i++)if(t=e.ixs[i],!n[t.index].mayHave(t.count))return!0},l=function(e){return!e.source.flatten},u=function(u){return function(c){var h=function(){return j.whenDoneWith(v,f)},d=function(){if(!(t.length>0))return k.more;for(var r,a=k.more,s=t.pop(),u=0;u<i.length;u++)if(r=i[u],o(r)){var c=function(){for(var e,t=[],i=0;i<r.ixs.length;i++)e=r.ixs[i],t.push(n[e.index].consume());return t}();return a=e(s.e.apply(function(){var e,t=function(){for(var e,t=[],n=0;n<c.length;n++)e=c[n],t.push(e.value());return t}();return(e=r).f.apply(e,t)})),t.length&&(t=q.filter(l,t)),a===k.noMore?a:d()}},f=function(){var t=d();return r&&(q.all(n,a)||q.all(i,s))&&(t=k.noMore,e(ue())),t===k.noMore&&c(),t};return u.subscribe(function(n){if(n.isEnd())r=!0,u.markEnded(),h();else if(n.isError())var i=e(n);else u.push(n),u.sync&&(t.push({source:u,e:n}),g||j.hasWaiters()?h():f());return i===k.noMore&&c(),i||k.more})}};return new k.CompositeUnsubscribe(function(){for(var e,t=[],i=0;i<n.length;i++)e=n[i],t.push(u(e));return t}()).unsubscribe});return v};var fe=function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],n=function(e){if(q.contains(t,e))return!0;var i=e.internalDeps();return i.length?(t.push(e),q.any(i,n)):(t.push(e),!1)};return q.any(e,n)},pe=function(e){return q.isFunction(e)?e:q.always(e)};k.groupSimultaneous=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];1===t.length&&I(t[0])&&(t=t[0]);var i=function(){for(var e,n=[],i=0;i<t.length;i++)e=t[i],n.push(new l(e));return n}();return V(new k.Desc(k,"groupSimultaneous",t),k.when(i,function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return t}))},H(b,v),z(b.prototype,{push:function(e){return e.isEnd()&&(this.propertyEnded=!0),e.hasValue()&&(this.current=new c(e),this.currentValueRootId=j.currentEventId()),v.prototype.push.call(this,e)},maybeSubSource:function(e,t){return t===k.noMore?T:this.propertyEnded?(e(ue()),T):v.prototype.subscribe.call(this,e)},subscribe:function(e){var t=this,n=k.more;if(this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)){var i=j.currentEventId(),r=this.currentValueRootId;return!this.propertyEnded&&r&&i&&i!==r?(j.whenDoneWith(this.property,function(){return t.currentValueRootId===r?e(se(t.current.get().value())):void 0}),this.maybeSubSource(e,n)):(j.inTransaction(void 0,this,function(){return n=e(se(this.current.get().value()))},[]),this.maybeSubSource(e,n))}return this.maybeSubSource(e,n)}}),H(x,g),z(x.prototype,{_isProperty:!0,changes:function(){var e=this;return new y(new k.Desc(this,"changes",[]),function(t){return e.dispatcher.subscribe(function(e){return e.isInitial()?void 0:t(e)})})},withHandler:function(e){return new x(new k.Desc(this,"withHandler",[e]),this.dispatcher.subscribe,e)},toProperty:function(){return B(arguments),this},toEventStream:function(){var e=this;return new y(new k.Desc(this,"toEventStream",[]),function(t){return e.dispatcher.subscribe(function(e){return e.isInitial()&&(e=e.toNext()),t(e)})})}}),k.Property=x,k.constant=function(e){return new x(new k.Desc(k,"constant",[e]),function(t){return t(se(e)),t(ue()),T})},k.fromBinder=function(e){var t=arguments.length<=1||void 0===arguments[1]?q.id:arguments[1],n=new k.Desc(k,"fromBinder",[e,t]);return new y(n,function(n){var i=!1,r=!1,o=function(){return i?void 0:"undefined"!=typeof a&&null!==a?(a(),i=!0):r=!0},a=e(function(){for(var e,i=arguments.length,r=Array(i),a=0;i>a;a++)r[a]=arguments[a];var s=t.apply(this,r);I(s)&&(null!=(e=q.last(s))?e._isEvent:void 0)||(s=[s]);for(var l,u=k.more,c=0;c<s.length;c++)if(l=s[c],u=n(l=ce(l)),u===k.noMore||l.isEnd())return o(),u;return u});return r&&o(),o})},k.Observable.prototype.map=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return te(this,e,n,function(e){return V(new k.Desc(this,"map",[e]),this.withHandler(function(t){return this.push(t.fmap(e))}))})};var _e=function(e){return I(e[0])?e[0]:Array.prototype.slice.call(e)},ge=function(e){return q.isFunction(e[0])?[_e(Array.prototype.slice.call(e,1)),e[0]]:[_e(Array.prototype.slice.call(e,0,e.length-1)),q.last(e)]};k.combineAsArray=function(){for(var e,t=_e(arguments),n=0;n<t.length;n++)e=t[n],N(e)||(t[n]=k.constant(e));if(t.length){var i=function(){for(var e,n=[],i=0;i<t.length;i++)e=t[i],n.push(new a(e,!0));return n}();return V(new k.Desc(k,"combineAsArray",t),k.when(i,function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return t}).toProperty())}return k.constant([])},k.onValues=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return k.combineAsArray(t.slice(0,t.length-1)).onValues(t[t.length-1])},k.combineWith=function(){var e=ge(arguments),t=e[0],n=e[1],i=new k.Desc(k,"combineWith",[n].concat(t));return V(i,k.combineAsArray(t).map(function(e){return n.apply(void 0,e)}))},k.Observable.prototype.combine=function(e,t){var n=ne(t),i=new k.Desc(this,"combine",[e,t]);return V(i,k.combineAsArray(this,e).map(function(e){return n(e[0],e[1])}))},k.Observable.prototype.withStateMachine=function(e,t){var n=e,i=new k.Desc(this,"withStateMachine",[e,t]);return V(i,this.withHandler(function(e){var i=t(n,e),r=i[0],o=i[1];n=r;for(var a,s=k.more,l=0;l<o.length;l++)if(a=o[l],s=this.push(a),s===k.noMore)return s;return s}))};var me=function(e,t){return e===t},ve=function(e){return"undefined"!=typeof e&&null!==e?e._isNone:!1};k.Observable.prototype.skipDuplicates=function(){var e=arguments.length<=0||void 0===arguments[0]?me:arguments[0],t=new k.Desc(this,"skipDuplicates",[]);return V(t,this.withStateMachine(re,function(t,n){return n.hasValue()?n.isInitial()||ve(t)||!e(t.get(),n.value())?[new c(n.value()),[n]]:[t,[]]:[t,[n]]}))},k.Observable.prototype.awaiting=function(e){var t=new k.Desc(this,"awaiting",[e]);return V(t,k.groupSimultaneous(this,e).map(function(e){return 0===e[1].length}).toProperty(!1).skipDuplicates())},k.Observable.prototype.not=function(){return V(new k.Desc(this,"not",[]),this.map(function(e){return!e}))},k.Property.prototype.and=function(e){return V(new k.Desc(this,"and",[e]),this.combine(e,function(e,t){return e&&t}))},k.Property.prototype.or=function(e){return V(new k.Desc(this,"or",[e]),this.combine(e,function(e,t){return e||t}))},k.scheduler={setTimeout:function(e,t){return setTimeout(e,t)},setInterval:function(e,t){return setInterval(e,t)},clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)},now:function(){return(new Date).getTime()}},k.EventStream.prototype.bufferWithTime=function(e){return V(new k.Desc(this,"bufferWithTime",[e]),this.bufferWithTimeOrCount(e,Number.MAX_VALUE))},k.EventStream.prototype.bufferWithCount=function(e){return V(new k.Desc(this,"bufferWithCount",[e]),this.bufferWithTimeOrCount(void 0,e))},k.EventStream.prototype.bufferWithTimeOrCount=function(e,t){var n=function(n){return n.values.length===t?n.flush():void 0!==e?n.schedule():void 0},i=new k.Desc(this,"bufferWithTimeOrCount",[e,t]);return V(i,this.buffer(e,n,n))},k.EventStream.prototype.buffer=function(e){var t=arguments.length<=1||void 0===arguments[1]?T:arguments[1],n=arguments.length<=2||void 0===arguments[2]?T:arguments[2],i={scheduled:null,end:void 0,values:[],flush:function(){if(this.scheduled&&(k.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){var e=this.values;this.values=[];var t=this.push(le(e));if(null!=this.end)return this.push(this.end);if(t!==k.noMore)return n(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){var t=this;return this.scheduled?void 0:this.scheduled=e(function(){return t.flush()})}},r=k.more;if(!q.isFunction(e)){var o=e;e=function(e){return k.scheduler.setTimeout(e,o)}}return V(new k.Desc(this,"buffer",[]),this.withHandler(function(e){var n=this;return i.push=function(e){return n.push(e)},e.isError()?r=this.push(e):e.isEnd()?(i.end=e,i.scheduled||i.flush()):(i.values.push(e.value()),t(i)),r}))},k.Observable.prototype.filter=function(e){R(e);for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return te(this,e,n,function(e){return V(new k.Desc(this,"filter",[e]),this.withHandler(function(t){return t.filter(e)?this.push(t):k.more}))})},k.once=function(e){return new y(new u(k,"once",[e]),function(t){return t(ce(e)),t(ue()),T})},k.EventStream.prototype.concat=function(e){var t=this;return new y(new k.Desc(t,"concat",[e]),function(n){var i=T,r=t.dispatcher.subscribe(function(t){return t.isEnd()?i=e.dispatcher.subscribe(n):n(t)});return function(){return r(),i()}})},k.Observable.prototype.flatMap=function(){return xe(this,ye(arguments))},k.Observable.prototype.flatMapFirst=function(){return xe(this,ye(arguments),!0)};var ye=function(e){return 1===e.length&&N(e[0])?q.always(e[0]):K(e)},be=function(e){return N(e)?e:k.once(e)},xe=function(e,t,n,i){var r=[e],o=[],a=new k.Desc(e,"flatMap"+(n?"First":""),[t]),s=new y(a,function(r){var a=new m,s=[],l=function(e){var n=be(t(e.value()));return o.push(n),a.add(function(e,t){return n.dispatcher.subscribe(function(i){if(i.isEnd())return q.remove(n,o),u(),c(t),k.noMore;("undefined"!=typeof i&&null!==i?i._isInitial:void 0)&&(i=i.toNext());var a=r(i);return a===k.noMore&&e(),a})})},u=function(){var e=s.shift();return e?l(e):void 0},c=function(e){return e(),a.empty()?r(ue()):void 0};return a.add(function(t,o){return e.dispatcher.subscribe(function(e){return e.isEnd()?c(o):e.isError()?r(e):n&&a.count()>1?k.more:a.unsubscribed?k.noMore:i&&a.count()>i?s.push(e):l(e)})}),a.unsubscribe});return s.internalDeps=function(){return o.length?r.concat(o):r},s};k.Observable.prototype.flatMapWithConcurrencyLimit=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];var r=new k.Desc(this,"flatMapWithConcurrencyLimit",[e].concat(n));return V(r,xe(this,ye(n),!1,e))},k.Observable.prototype.flatMapConcat=function(){var e=new k.Desc(this,"flatMapConcat",Array.prototype.slice.call(arguments,0));return V(e,this.flatMapWithConcurrencyLimit.apply(this,[1].concat(A.call(arguments))))},k.later=function(e,t){return V(new k.Desc(k,"later",[e,t]),k.fromBinder(function(n){var i=function(){return n([t,ue()])},r=k.scheduler.setTimeout(i,e);return function(){return k.scheduler.clearTimeout(r)}}))},k.Observable.prototype.bufferingThrottle=function(e){var t=new k.Desc(this,"bufferingThrottle",[e]);return V(t,this.flatMapConcat(function(t){return k.once(t).concat(k.later(e).filter(!1))}))},k.Property.prototype.bufferingThrottle=function(){return k.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()},H(w,y),z(w.prototype,{unsubAll:function(){for(var e,t=this.subscriptions,n=0;n<t.length;n++)e=t[n],
"function"==typeof e.unsub&&e.unsub()},subscribeAll:function(e){if(this.ended)e(ue());else{this.sink=e;for(var t,n=M(this.subscriptions),i=0;i<n.length;i++)t=n[i],this.subscribeInput(t)}return this.unsubAll},guardedSink:function(e){var t=this;return function(n){return n.isEnd()?(t.unsubscribeInput(e),k.noMore):t.sink(n)}},subscribeInput:function(e){return e.unsub=e.input.dispatcher.subscribe(this.guardedSink(e.input)),e.unsub},unsubscribeInput:function(e){for(var t,n=this.subscriptions,i=0;i<n.length;i++)if(t=n[i],t.input===e)return"function"==typeof t.unsub&&t.unsub(),void this.subscriptions.splice(i,1)},plug:function(e){var t=this;if(P(e),!this.ended){var n={input:e};return this.subscriptions.push(n),"undefined"!=typeof this.sink&&this.subscribeInput(n),function(){return t.unsubscribeInput(e)}}},end:function(){return this.ended=!0,this.unsubAll(),"function"==typeof this.sink?this.sink(ue()):void 0},push:function(e){return this.ended||"function"!=typeof this.sink?void 0:this.sink(le(e))},error:function(e){return"function"==typeof this.sink?this.sink(new _(e)):void 0}}),k.Bus=w;var we=function(e,t){return X(function(n){for(var i=Y(t,[function(e,t){return n.apply(void 0,e.concat([t]))}]),r=arguments.length,o=Array(r>1?r-1:0),a=1;r>a;a++)o[a-1]=arguments[a];return V(new k.Desc(k,e,[n].concat(o)),k.combineAsArray(o).flatMap(i))})};k.fromCallback=we("fromCallback",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return k.fromBinder(function(t){return ee(e,n)(t),T},function(e){return[e,ue()]})}),k.fromNodeCallback=we("fromNodeCallback",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return k.fromBinder(function(t){return ee(e,n)(t),T},function(e,t){return e?[new _(e),ue()]:[t,ue()]})}),k.combineTemplate=function(e){function t(e){return e[e.length-1]}function n(e,n,i){return t(e)[n]=i,i}function i(e,t){return function(i,r){return n(i,e,r[t])}}function r(e,t){return function(i){return n(i,e,t)}}function o(e){return I(e)?[]:{}}function a(e,t){return function(i){var r=o(t);return n(i,e,r),i.push(r)}}function s(e,t){if(N(t))return h.push(t),c.push(i(e,h.length-1));if(!t||t.constructor!=Object&&t.constructor!=Array)return c.push(r(e,t));var n=function(e){return e.pop()};return c.push(a(e,t)),u(t),c.push(n)}function l(t){for(var n,i=o(e),r=[i],a=0;a<c.length;a++)(n=c[a])(r,t);return i}function u(e){return q.each(e,s)}var c=[],h=[];return u(e),V(new k.Desc(k,"combineTemplate",[e]),k.combineAsArray(h).map(l))};var Se=function(e,t){var n=new y(U(e,"justInitValue"),function(t){var i=void 0,r=e.dispatcher.subscribe(function(e){return e.isEnd()||(i=e),k.noMore});return j.whenDoneWith(n,function(){return"undefined"!=typeof i&&null!==i&&t(i),t(ue())}),r});return n.concat(t).toProperty()};k.Observable.prototype.mapEnd=function(){var e=K(arguments);return V(new k.Desc(this,"mapEnd",[e]),this.withHandler(function(t){return t.isEnd()?(this.push(le(e(t))),this.push(ue()),k.noMore):this.push(t)}))},k.Observable.prototype.skipErrors=function(){return V(new k.Desc(this,"skipErrors",[]),this.withHandler(function(e){return e.isError()?k.more:this.push(e)}))},k.EventStream.prototype.takeUntil=function(e){var t={};return V(new k.Desc(this,"takeUntil",[e]),k.groupSimultaneous(this.mapEnd(t),e.skipErrors()).withHandler(function(e){if(e.hasValue()){var n=e.value(),i=n[0],r=n[1];if(r.length)return this.push(ue());for(var o,a=k.more,s=0;s<i.length;s++)o=i[s],a=o===t?this.push(ue()):this.push(le(o));return a}return this.push(e)}))},k.Property.prototype.takeUntil=function(e){var t=this.changes().takeUntil(e);return V(new k.Desc(this,"takeUntil",[e]),Se(this,t))},k.Observable.prototype.flatMapLatest=function(){var e=ye(arguments),t=this.toEventStream();return V(new k.Desc(this,"flatMapLatest",[e]),t.flatMap(function(n){return be(e(n)).takeUntil(t)}))},k.Property.prototype.delayChanges=function(e,t){return V(e,Se(this,t(this.changes())))},k.EventStream.prototype.delay=function(e){return V(new k.Desc(this,"delay",[e]),this.flatMap(function(t){return k.later(e,t)}))},k.Property.prototype.delay=function(e){return this.delayChanges(new k.Desc(this,"delay",[e]),function(t){return t.delay(e)})},k.EventStream.prototype.debounce=function(e){return V(new k.Desc(this,"debounce",[e]),this.flatMapLatest(function(t){return k.later(e,t)}))},k.Property.prototype.debounce=function(e){return this.delayChanges(new k.Desc(this,"debounce",[e]),function(t){return t.debounce(e)})},k.EventStream.prototype.debounceImmediate=function(e){return V(new k.Desc(this,"debounceImmediate",[e]),this.flatMapFirst(function(t){return k.once(t).concat(k.later(e).filter(!1))}))},k.Observable.prototype.decode=function(e){return V(new k.Desc(this,"decode",[e]),this.combine(k.combineTemplate(e),function(e,t){return t[e]}))},k.Observable.prototype.scan=function(e,t){var n,i=this;t=ne(t);var r=oe(e),o=!1,a=function(e){var a=!1,s=T,l=k.more,u=function(){return a?void 0:r.forEach(function(t){return a=o=!0,l=e(new f(function(){return t})),l===k.noMore?(s(),s=T):void 0})};return s=i.dispatcher.subscribe(function(n){if(n.hasValue()){if(o&&n.isInitial())return k.more;n.isInitial()||u(),a=o=!0;var i=r.getOrElse(void 0),s=t(i,n.value());return r=new c(s),e(n.apply(function(){return s}))}return n.isEnd()&&(l=u()),l!==k.noMore?e(n):void 0}),j.whenDoneWith(n,u),s};return n=new x(new k.Desc(this,"scan",[e,t]),a)},k.Observable.prototype.diff=function(e,t){return t=ne(t),V(new k.Desc(this,"diff",[e,t]),this.scan([e],function(e,n){return[n,t(e[0],n)]}).filter(function(e){return 2===e.length}).map(function(e){return e[1]}))},k.Observable.prototype.doAction=function(){var e=K(arguments);return V(new k.Desc(this,"doAction",[e]),this.withHandler(function(t){return t.hasValue()&&e(t.value()),this.push(t)}))},k.Observable.prototype.doEnd=function(){var e=K(arguments);return V(new k.Desc(this,"doEnd",[e]),this.withHandler(function(t){return t.isEnd()&&e(),this.push(t)}))},k.Observable.prototype.doError=function(){var e=K(arguments);return V(new k.Desc(this,"doError",[e]),this.withHandler(function(t){return t.isError()&&e(t.error),this.push(t)}))},k.Observable.prototype.doLog=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return V(new k.Desc(this,"doLog",t),this.withHandler(function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,t.concat([e.log()])),this.push(e)}))},k.Observable.prototype.endOnError=function(e){("undefined"==typeof e||null===e)&&(e=!0);for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return te(this,e,n,function(e){return V(new k.Desc(this,"endOnError",[]),this.withHandler(function(t){return t.isError()&&e(t.error)?(this.push(t),this.push(ue())):this.push(t)}))})},g.prototype.errors=function(){return V(new k.Desc(this,"errors",[]),this.filter(function(){return!1}))},k.Observable.prototype.take=function(e){return 0>=e?k.never():V(new k.Desc(this,"take",[e]),this.withHandler(function(t){return t.hasValue()?(e--,e>0?this.push(t):(0===e&&this.push(t),this.push(ue()),k.noMore)):this.push(t)}))},k.Observable.prototype.first=function(){return V(new k.Desc(this,"first",[]),this.take(1))},k.Observable.prototype.mapError=function(){var e=K(arguments);return V(new k.Desc(this,"mapError",[e]),this.withHandler(function(t){return t.isError()?this.push(le(e(t.error))):this.push(t)}))},k.Observable.prototype.flatMapError=function(e){var t=new k.Desc(this,"flatMapError",[e]);return V(t,this.mapError(function(e){return new _(e)}).flatMap(function(t){return t instanceof _?e(t.error):k.once(t)}))},k.EventStream.prototype.sampledBy=function(e,t){return V(new k.Desc(this,"sampledBy",[e,t]),this.toProperty().sampledBy(e,t))},k.Property.prototype.sampledBy=function(e,t){var n=!1;"undefined"!=typeof t&&null!==t?t=ne(t):(n=!0,t=function(e){return e.value()});var i=new a(this,!1,n),r=new a(e,!0,n),o=k.when([i,r],t),s=e._isProperty?o.toProperty():o;return V(new k.Desc(this,"sampledBy",[e,t]),s)},k.Property.prototype.sample=function(e){return V(new k.Desc(this,"sample",[e]),this.sampledBy(k.interval(e,{})))},k.Observable.prototype.map=function(e){if(e&&e._isProperty)return e.sampledBy(this,E);for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return te(this,e,n,function(e){return V(new k.Desc(this,"map",[e]),this.withHandler(function(t){return this.push(t.fmap(e))}))})},k.Observable.prototype.fold=function(e,t){return V(new k.Desc(this,"fold",[e,t]),this.scan(e,t).sampledBy(this.filter(!1).mapEnd().toProperty()))},g.prototype.reduce=g.prototype.fold;var Ae=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]],ke=function(e){for(var t,n=0;n<Ae.length;n++){t=Ae[n];var i=[e[t[0]],e[t[1]]];if(i[0]&&i[1])return i}for(var r=0;r<Ae.length;r++){t=Ae[r];var o=e[t[0]];if(o)return[o,function(){}]}throw new _("No suitable event methods in "+e)};k.fromEventTarget=function(e,t,n){var i=ke(e),r=i[0],o=i[1],a=new k.Desc(k,"fromEvent",[e,t]);return V(a,k.fromBinder(function(n){return r.call(e,t,n),function(){return o.call(e,t,n)}},n))},k.fromEvent=k.fromEventTarget,k.fromPoll=function(e,t){var n=new k.Desc(k,"fromPoll",[e,t]);return V(n,k.fromBinder(function(t){var n=k.scheduler.setInterval(t,e);return function(){return k.scheduler.clearInterval(n)}},t))},k.fromPromise=function(e,t){var n=arguments.length<=2||void 0===arguments[2]?S:arguments[2];return V(new k.Desc(k,"fromPromise",[e]),k.fromBinder(function(n){var i=e.then(n,function(e){return n(new _(e))});return i&&"function"==typeof i.done&&i.done(),t?function(){return"function"==typeof e.abort?e.abort():void 0}:function(){}},n))},k.Observable.prototype.groupBy=function(e){var t=arguments.length<=1||void 0===arguments[1]?k._.id:arguments[1],n={},i=this;return i.filter(function(t){return!n[e(t)]}).map(function(r){var o=e(r),a=i.filter(function(t){return e(t)===o}),s=k.once(r).concat(a),l=t(s,r).withHandler(function(e){return this.push(e),e.isEnd()?delete n[o]:void 0});return n[o]=l,l})},k.fromArray=function(e){if(F(e),e.length){var t=0;return new y(new k.Desc(k,"fromArray",[e]),function(n){var i=!1,r=k.more,o=!1,a=!1,s=function(){if(a=!0,!o){for(o=!0;a;)if(a=!1,r!==k.noMore&&!i){var l=e[t++];r=n(ce(l)),r!==k.noMore&&(t===e.length?n(ue()):j.afterTransaction(s))}return o=!1}};return s(),function(){return i=!0}})}return V(new k.Desc(k,"fromArray",e),k.never())},k.EventStream.prototype.holdWhen=function(e){var t=!1,n=[],i=this;return new y(new k.Desc(this,"holdWhen",[e]),function(r){var o=new m,a=!1,s=function(e){return"function"==typeof e&&e(),o.empty()&&a?r(ue()):void 0};return o.add(function(i,o){return e.subscribeInternal(function(e){if(!e.hasValue())return e.isEnd()?s(o):r(e);if(t=e.value(),!t){var i=n;return n=[],function(){for(var e,t=[],n=0;n<i.length;n++)e=i[n],t.push(r(le(e)));return t}()}})}),o.add(function(e,o){return i.subscribeInternal(function(e){return t&&e.hasValue()?n.push(e.value()):e.isEnd()&&n.length?s(o):r(e)})}),a=!0,s(),o.unsubscribe})},k.interval=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return V(new k.Desc(k,"interval",[e,t]),k.fromPoll(e,function(){return le(t)}))},k.$={},k.$.asEventStream=function(e,t,n){var i=this;return q.isFunction(t)&&(n=t,t=void 0),V(new k.Desc(this.selector||this,"asEventStream",[e]),k.fromBinder(function(n){return i.on(e,t,n),function(){return i.off(e,t,n)}},n))},"undefined"!=typeof jQuery&&jQuery&&(jQuery.fn.asEventStream=k.$.asEventStream),"undefined"!=typeof Zepto&&Zepto&&(Zepto.fn.asEventStream=k.$.asEventStream),k.Observable.prototype.last=function(){var e;return V(new k.Desc(this,"last",[]),this.withHandler(function(t){return t.isEnd()?(e&&this.push(e),this.push(ue()),k.noMore):void(e=t)}))},k.Observable.prototype.log=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return this.subscribe(function(e){"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,t.concat([e.log()]))}),this},k.EventStream.prototype.merge=function(e){O(e);var t=this;return V(new k.Desc(t,"merge",[e]),k.mergeAll(this,e))},k.mergeAll=function(){var e=_e(arguments);return e.length?new y(new k.Desc(k,"mergeAll",e),function(t){var n=0,i=function(i){return function(r){return i.dispatcher.subscribe(function(i){if(i.isEnd())return n++,n===e.length?t(ue()):k.more;var o=t(i);return o===k.noMore&&r(),o})}},r=q.map(i,e);return new k.CompositeUnsubscribe(r).unsubscribe}):k.never()},k.repeatedly=function(e,t){var n=0;return V(new k.Desc(k,"repeatedly",[e,t]),k.fromPoll(e,function(){return t[n++%t.length]}))},k.repeat=function(e){var t=0;return k.fromBinder(function(n){function i(e){return e.isEnd()?o?r():o=!0:a=n(e)}function r(){var r;for(o=!0;o&&a!==k.noMore;)r=e(t++),o=!1,r?s=r.subscribeInternal(i):n(ue());return o=!0}var o=!1,a=k.more,s=function(){};return r(),function(){return s()}})},k.retry=function(e){if(!q.isFunction(e.source))throw new C("'source' option has to be a function");var t=e.source,n=e.retries||0,i=e.maxRetries||n,r=e.delay||function(){return 0},o=e.isRetryable||function(){return!0},a=!1,s=null;return V(new k.Desc(k,"retry",[e]),k.repeat(function(){function e(){return t().endOnError().withHandler(function(e){return e.isError()?(s=e,o(s.error)&&n>0?void 0:(a=!0,this.push(e))):(e.hasValue()&&(s=null,a=!0),this.push(e))})}if(a)return null;if(s){var l={error:s.error,retriesDone:i-n},u=k.later(r(l)).filter(!1);return n-=1,u.concat(k.once().flatMap(e))}return e()}))},k.sequentially=function(e,t){var n=0;return V(new k.Desc(k,"sequentially",[e,t]),k.fromPoll(e,function(){var e=t[n++];return n<t.length?e:n===t.length?[e,ue()]:ue()}))},k.Observable.prototype.skip=function(e){return V(new k.Desc(this,"skip",[e]),this.withHandler(function(t){return t.hasValue()&&e>0?(e--,k.more):this.push(t)}))},k.EventStream.prototype.skipUntil=function(e){var t=e.take(1).map(!0).toProperty(!1);return V(new k.Desc(this,"skipUntil",[e]),this.filter(t))},k.EventStream.prototype.skipWhile=function(e){R(e);for(var t=!1,n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];return te(this,e,i,function(e){return V(new k.Desc(this,"skipWhile",[e]),this.withHandler(function(n){return!t&&n.hasValue()&&e(n.value())?k.more:(n.hasValue()&&(t=!0),this.push(n))}))})},k.Observable.prototype.slidingWindow=function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return V(new k.Desc(this,"slidingWindow",[e,t]),this.scan([],function(t,n){return t.concat([n]).slice(-e)}).filter(function(e){return e.length>=t}))};var Ce=[],de=function(e){if(Ce.length&&!de.running)try{de.running=!0,Ce.forEach(function(t){t(e)})}finally{delete de.running}};k.spy=function(e){return Ce.push(e)},k.Property.prototype.startWith=function(e){return V(new k.Desc(this,"startWith",[e]),this.scan(e,function(e,t){return t}))},k.EventStream.prototype.startWith=function(e){return V(new k.Desc(this,"startWith",[e]),k.once(e).concat(this))},k.Observable.prototype.takeWhile=function(e){R(e);for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return te(this,e,n,function(e){return V(new k.Desc(this,"takeWhile",[e]),this.withHandler(function(t){return t.filter(e)?this.push(t):(this.push(ue()),k.noMore)}))})},k.EventStream.prototype.throttle=function(e){return V(new k.Desc(this,"throttle",[e]),this.bufferWithTime(e).map(function(e){return e[e.length-1]}))},k.Property.prototype.throttle=function(e){return this.delayChanges(new k.Desc(this,"throttle",[e]),function(t){return t.throttle(e)})},g.prototype.firstToPromise=function(e){var t=this;if("function"!=typeof e){if("function"!=typeof Promise)throw new C("There isn't default Promise, use shim or parameter");e=Promise}return new e(function(e,n){return t.subscribe(function(t){return t.hasValue()&&e(t.value()),t.isError()&&n(t.error),k.noMore})})},g.prototype.toPromise=function(e){return this.last().firstToPromise(e)},k["try"]=function(e){return function(t){try{return k.once(e(t))}catch(n){return new k.Error(n)}}},k.update=function(e){function t(e){return function(){for(var t=arguments.length,n=Array(t),i=0;t>i;i++)n[i]=arguments[i];return function(t){return e.apply(void 0,[t].concat(n))}}}for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];for(var o=i.length-1;o>0;)i[o]instanceof Function||(i[o]=q.always(i[o])),i[o]=t(i[o]),o-=2;return V(new k.Desc(k,"update",[e].concat(i)),k.when.apply(k,i).scan(e,function(e,t){return t(e)}))},k.zipAsArray=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];var i=_e(t);return V(new k.Desc(k,"zipAsArray",i),k.zipWith(i,function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return t}))},k.zipWith=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];var i=ge(t),r=i[0],o=i[1];return r=q.map(function(e){return e.toEventStream()},r),V(new k.Desc(k,"zipWith",[o].concat(r)),k.when(r,o))},k.Observable.prototype.zip=function(e,t){return V(new k.Desc(this,"zip",[e]),k.zipWith([this,e],t||Array))},null!==n(199)&&null!=n(200)?(i=[],r=function(){return k}.apply(t,i),!(void 0!==r&&(o.exports=r)),"undefined"!=typeof this&&null!==this&&(this.Bacon=k)):"undefined"!=typeof o&&null!==o&&null!=o.exports?(o.exports=k,k.Bacon=k):this.Bacon=k}).call(this)}).call(t,function(){return this}(),n(220)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){function i(e,t,n,i){this.brush_sel=e.append("g").attr("id","brush-container");var r=this.brush_sel.node(),o=e.select(i).node().nextSibling;r!==o&&r.parentNode.insertBefore(r,o),this.enabled=t,this.map=n}function r(e){void 0===e&&(e=!this.enabled),e?this.selection_brush=this.setup_selection_brush():this.brush_sel.selectAll(".brush").remove()}function o(){var e=this.brush_sel,t=this.map.sel.selectAll("#nodes,#text-labels"),n=this.map.canvas.size_and_location(),i=n.width,r=n.height,o=n.x,a=n.y;e.selectAll("g").remove();var s=d3.svg.brush().x(d3.scale.identity().domain([o,o+i])).y(d3.scale.identity().domain([a,a+r])).on("brush",function(){var e,n=d3.event.sourceEvent.shiftKey,i=d3.event.target.extent();e=n?t.selectAll(".node:not(.selected),.text-label:not(.selected)"):t.selectAll(".node,.text-label"),e.classed("selected",function(e){var t=e.x,n=e.y;return i[0][0]<=t&&t<i[1][0]&&i[0][1]<=n&&n<i[1][1]})}).on("brushend",function(){d3.event.target.clear(),d3.select(this).call(d3.event.target)}),l=e.append("g").attr("class","brush").call(s);return e.selectAll(".background").classed("cursor-grab",!1).classed("cursor-grabbing",!1).style("cursor",null),l}var a=n(195),s=a.make_class();s.prototype={init:i,toggle:r,setup_selection_brush:o},e.exports=s},function(e,t,n){function i(e,t){var n=t.ignore_bootstrap||!1;e.attr("class","btn btn-default simple-button");var i=e.append("span"),r=i.append("span");"id"in t&&e.attr("id",t.id),"text"in t&&r.text(t.text),"icon"in t&&!n&&i.classed(t.icon,!0),n||r.attr("class","hidden"),"key"in t&&l(e,t.key),"key_text"in t&&"tooltip"in t&&null!==t.key_text?e.attr("title",t.tooltip+t.key_text):"tooltip"in t&&e.attr("title",t.tooltip)}function r(e,t){var n=e.append("button");i(n,t)}function o(e){var t=e.append("li").attr("class","btn-group-vertical").attr("data-toggle","buttons");return{button:function(e){var n=(e.ignore_bootstrap||!1,t.append("label"));return n.append("input").attr("type","radio"),i(n,e),this}}}function a(e){var t=e.attr("class","btn-group-vertical");return{button:function(e){var n=t.append("button");return i(n,e),this}}}function s(e,t,n){void 0===n&&(n=!1);var i=e.append("li").attr("class","dropdown");i.append("button").text(t+" ").attr("class","btn btn-link btn-sm dropdown-button").attr("data-toggle","dropdown").append("b").attr("class","caret");var r=i.append("ul").attr("class","dropdown-menu").classed("pull-right",n).attr("role","menu").attr("aria-labelledby","dLabel");return{dropdown:i,button:function(e){var t=r.append("li").attr("role","presentation").datum(e),n=t.append("a").attr("href","#"),i=n.append("span").attr("class","dropdown-button-icon"),o=n.append("span").attr("class","dropdown-button-text");if("id"in e&&t.attr("id",e.id),"key_text"in e&&"text"in e&&null!==e.key_text?o.text(" "+e.text+e.key_text):"text"in e&&o.text(" "+e.text),"icon"in e&&i.classed(e.icon,!0),"key"in e)l(n,e.key);else if("input"in e){var a=e.input,s=a.accept_csv?c(n,t,a.pre_fn,a.fn,a.failure_fn):u(n,t,a.pre_fn,a.fn,a.failure_fn);"assign"in a&&"key"in a&&(a.assign[a.key]=s)}return this},divider:function(){return r.append("li").attr("role","presentation").attr("class","divider"),this}}}function l(e,t){e.on("click",function(){t.fn.call(t.target)})}function u(e,t,n,i,r){var o=t.append("input").attr("type","file").style("display","none").on("change",function(){h.load_json(this.files[0],function(e,t){i(e,t),this.value=""}.bind(this),n,r)});return e.on("click",function(e){o.node().click()}),function(){o.node().click()}}function c(e,t,n,i,r){var o=t.append("input").attr("type","file").style("display","none").on("change",function(){h.load_json_or_csv(this.files[0],d.csv_converter,function(e,t){i(e,t),this.value=""}.bind(this),n,r)});return e.on("click",function(e){o.node().click()}),function(){o.node().click()}}var h=n(195),d=n(206);e.exports={individual_button:r,radio_button_group:o,button_group:a,dropdown_menu:s,set_json_input_button:u,set_json_or_csv_input_button:c}},function(e,t,n){function i(e,t,n){var i=e.attr("class","search-container").style("display","none");this.input=i.append("input").attr("class","search-bar");var o=i.append("div").attr("class","btn-group btn-group-sm");o.append("button").attr("class","btn btn-default").on("click",this.previous.bind(this)).append("span").attr("class","glyphicon glyphicon-chevron-left"),o.append("button").attr("class","btn btn-default").on("click",this.next.bind(this)).append("span").attr("class","glyphicon glyphicon-chevron-right"),this.counter=i.append("div").attr("class","search-counter"),i.append("button").attr("class","btn btn-sm btn-default close-button").on("click",function(){this.toggle(!1)}.bind(this)).append("span").attr("class","glyphicon glyphicon-remove"),this.callback_manager=new h,this.selection=i,this.map=n,this.search_index=t,this.current=1,this.results=null;var a=function(e){this.current=1,this.results=r(this.search_index.find(e.value)),this.update()}.bind(this,this.input.node());this.input.on("input",c.debounce(a,200))}function r(e){return d.uniq(e,function(e){var t=p[e.type];return t[0]+e[t[1]]})}function o(){return"none"!==this.selection.style("display")}function a(e){void 0===e?this.is_active=!this.is_active:this.is_active=e,this.is_active?(this.selection.style("display",null),this.counter.text(""),this.input.node().value="",this.input.node().focus(),this.clear_escape=this.map.key_manager.add_escape_listener(function(){this.toggle(!1)}.bind(this),!0),this.clear_next=this.map.key_manager.add_key_listener(["enter","ctrl+g"],function(){this.next()}.bind(this),!1),this.clear_previous=this.map.key_manager.add_key_listener(["shift+enter","shift+ctrl+g"],function(){this.previous()}.bind(this),!1),this.callback_manager.run("show")):(this.map.highlight(null),this.selection.style("display","none"),this.results=null,this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.clear_next&&this.clear_next(),this.clear_next=null,this.clear_previous&&this.clear_previous(),this.clear_previous=null,this.callback_manager.run("hide"))}function s(){if(null===this.results)this.counter.text(""),this.map.highlight(null);else if(0===this.results.length)this.counter.text("0 / 0"),this.map.highlight(null);else{this.counter.text(this.current+" / "+this.results.length);var e=this.results[this.current-1];if("reaction"==e.type)this.map.zoom_to_reaction(e.reaction_id),this.map.highlight_reaction(e.reaction_id);else if("metabolite"==e.type)this.map.zoom_to_node(e.node_id),this.map.highlight_node(e.node_id);else{if("text_label"!=e.type)throw new Error("Bad search index data type: "+e.type);this.map.zoom_to_text_label(e.text_label_id),this.map.highlight_text_label(e.text_label_id)}}}function l(){null!==this.results&&(this.current===this.results.length?this.current=1:this.current+=1,this.update())}function u(){null!==this.results&&(1===this.current?this.current=this.results.length:this.current-=1,this.update())}var c=n(195),h=n(208),d=n(197),f=c.make_class();f.prototype={init:i,is_visible:o,toggle:a,update:s,next:l,previous:u},e.exports=f;var p={metabolite:["m","node_id"],reaction:["r","reaction_id"],text_label:["t","text_label_id"]}},function(e,t,n){function i(e,t,n){this.set_option=e,this.get_option=t,this.status_bus=new d.Bus,this.force_update_bus=new d.Bus,d.Observable.prototype.convert_to_conditional_stream=r,d.Observable.prototype.force_update_with_bus=o,this.busses={},this.streams={};for(var i=0,s=n.length;s>i;i++){var l=n[i],u=a(l,t(l),e,this.status_bus,this.force_update_bus);this.busses[l]=u.bus,this.streams[l]=u.stream}}function r(e){var t=e.map(function(e){return"hold"==e}).not().toProperty(!0),n=e.scan(!1,function(e,t){return 0==e&&("accepted"==t||"rejected"==t)}).not(),i=e.scan(!1,function(e,t){return 0==e&&"hold"==t}).not(),r=d.combineAsArray(this,e),o=r.scan([],function(e,t){if("hold"==t[1])return e.push(t[0]),e;if("accept"==t[1])return e;if("reject"==t[1])return[];if("rejected"==t[1]||"accepted"==t[1])return[t[0]];throw Error("bad status "+t[1])}).filter(t).filter(n).filter(i).flatMap(function(e){return d.fromArray(e)}),a=this.filter(t);return a.merge(o)}function o(e){return d.combineAsArray(this,e.toProperty(!1)).map(function(e){return e[0]})}function a(e,t,n,i,r){var o=new d.Bus,a=o.convert_to_conditional_stream(i).force_update_with_bus(r);return a.onValue(function(t){n(e,t)}),o.push(t),{bus:o,stream:a}}function s(e,t){if(!(e in this.busses))throw new Error("Invalid setting name");this.busses[e].push(t)}function l(){this.status_bus.push("hold")}function u(){this.status_bus.push("reject"),this.status_bus.push("rejected"),this.force_update_bus.push(!0)}function c(){this.status_bus.push("accept"),this.status_bus.push("accepted")}var h=n(195),d=n(219),f=h.make_class();f.prototype={init:i,set_conditional:s,hold_changes:l,abandon_changes:u,accept_changes:c},e.exports=f},function(e,t,n){"strict mode";function i(e,t,n,i){this.sel=e,this.settings=t,this.draw=!1;var r=this.settings.get_option("unique_map_id");this.unique_string=null===r?"":"."+r;var o=e.append("div").attr("class","settings-box-background").style("display","none"),a=o.append("div").attr("class","settings-box-container").style("display","none");a.append("button").attr("class","btn btn-sm btn-default settings-button").on("click",function(){this.accept_changes()}.bind(this)).append("span").attr("class","glyphicon glyphicon-ok"),a.append("button").attr("class","btn btn-sm btn-default settings-button settings-button-close").on("click",function(){this.abandon_changes()}.bind(this)).append("span").attr("class","glyphicon glyphicon-remove");var s=a.append("div").attr("class","settings-box");s.append("div").text("Tip: Hover over an option to see more details about it.").classed("settings-tip",!0),s.append("hr"),s.append("div").text("View and build options").attr("class","settings-section-heading-large"),this.view_gui(s.append("div")),s.append("hr"),s.append("div").text("Reactions").attr("class","settings-section-heading-large");var l=new f(s.append("div"),"reaction",this.settings,n.get_data_statistics.bind(n));n.callback_manager.set("calc_data_stats__reaction",function(e){e&&(l.update(),l.update_no_data())}),s.append("div").text("Reaction or Gene data").attr("class","settings-section-heading"),this.style_gui(s.append("div"),"reaction",function(e){i&&(i("reaction",e),l.update(),l.update_no_data())}),s.append("hr"),s.append("div").text("Metabolites").attr("class","settings-section-heading-large");var u=new f(s.append("div"),"metabolite",this.settings,n.get_data_statistics.bind(n));n.callback_manager.set("calc_data_stats__metabolite",function(e){e&&(u.update(),u.update_no_data())}),s.append("div").text("Metabolite data").attr("class","settings-section-heading"),this.style_gui(s.append("div"),"metabolite",function(e){i&&(i("metabolite",e),u.update(),u.update_no_data())}),this.callback_manager=new d,this.map=n,this.selection=a,this.background=o}function r(){return"none"!=this.selection.style("display")}function o(e){void 0===e&&(e=!this.is_visible()),e?(this.hold_changes(),this.selection.style("display","inline-block"),this.background.style("display","block"),this.selection.select("input").node().focus(),this.clear_escape=this.map.key_manager.add_escape_listener(function(){this.abandon_changes()}.bind(this),!0),this.clear_enter=this.map.key_manager.add_enter_listener(function(){this.accept_changes()}.bind(this),!0),this.callback_manager.run("show")):(this.draw&&this.map.draw_everything(),this.selection.style("display","none"),this.background.style("display","none"),this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.clear_enter&&this.clear_enter(),this.clear_enter=null,this.callback_manager.run("hide"))}function a(){this.settings.hold_changes()}function s(){this.draw=!1,this.settings.abandon_changes(),this.toggle(!1)}function l(){this.sel.selectAll("input").each(function(e){this.blur()}),this.draw=!0,this.settings.accept_changes(),this.toggle(!1)}function u(e,t,n){var i=e.append("table").attr("class","settings-table"),r=this.settings;if(i.append("tr").call(function(e){e.append("td").text("Options:").attr("class","options-label").attr("title","Options for "+t+" data.");var i=e.append("td"),o=[["Absolute value","abs","If checked, use the absolute value when calculating colors and sizes of "+t+"s on the map"],["Size","size","If checked, then size the "+("metabolite"==t?"radius of metabolite circles ":"thickness of reaction lines ")+"according to the value of the "+t+" data"],["Color","color","If checked, then color the "+("metabolite"==t?"metabolite circles ":"reaction lines ")+"according to the value of the "+t+" data"],["Text (Show data in label)","text","If checked, then show data values in the "+t+" labels"]],a=i.selectAll(".option-group").data(o),s=a.enter().append("label").attr("class","option-group"),l=function(){var e=[];return i.selectAll("input").each(function(t){this.checked&&e.push(t[1])}),e};s.append("input").attr("type","checkbox").on("change",function(e){r.set_conditional(t+"_styles",l()),"abs"==e[1]&&n(this.checked)}).each(function(e){r.streams[t+"_styles"].onValue(function(t){this.checked=-1!=t.indexOf(e[1])}.bind(this))}),s.append("span").text(function(e){return e[0]}).attr("title",function(e){return e[2]})}),i.append("tr").call(function(e){e.append("td").text("Comparison:").attr("class","options-label").attr("title","The function that will be used to compare datasets, when paired data is loaded");var n=e.append("td").attr("title","The function that will be used to compare datasets, when paired data is loaded"),i=[["Fold Change","fold"],["Log2(Fold Change)","log2_fold"],["Difference","diff"]],o=n.selectAll(".option-group").data(i),a=o.enter().append("label").attr("class","option-group");a.append("input").attr("type","radio").attr("name",t+"_compare_style"+this.unique_string).attr("value",function(e){return e[1]}).on("change",function(){this.checked&&r.set_conditional(t+"_compare_style",this.value)}).each(function(){r.streams[t+"_compare_style"].onValue(function(e){this.checked=this.value==e}.bind(this))}),a.append("span").text(function(e){return e[0]})}.bind(this)),"reaction"==t){var i=e.append("table").attr("class","settings-table").attr("title","The function that will be used to evaluate AND connections in gene reaction rules (AND connections generally connect components of an enzyme complex)");i.append("tr").call(function(e){e.append("td").text("Method for evaluating AND:").attr("class","options-label-wide");var t=e.append("td"),n=[["Mean","mean"],["Min","min"]],i=t.selectAll(".option-group").data(n),o=i.enter().append("label").attr("class","option-group"),a="and_method_in_gene_reaction_rule";
o.append("input").attr("type","radio").attr("name",a+this.unique_string).attr("value",function(e){return e[1]}).on("change",function(){this.checked&&r.set_conditional(a,this.value)}).each(function(){r.streams[a].onValue(function(e){this.checked=this.value==e}.bind(this))}),o.append("span").text(function(e){return e[0]})}.bind(this))}}function c(e,t,n,i){var r=this.settings,o=e.append("table").attr("class","settings-table");o.append("tr").call(function(e){e.attr("title","The identifiers that are show in the reaction, gene, and metabolite labels on the map."),e.append("td").text("Identifiers:").attr("class","options-label");var t=e.append("td"),n=[["ID's","bigg_id"],["Descriptive names","name"]],i=t.selectAll(".option-group").data(n),o=i.enter().append("label").attr("class","option-group"),a="identifiers_on_map";o.append("input").attr("type","radio").attr("name",a+this.unique_string).attr("value",function(e){return e[1]}).on("change",function(){this.checked&&r.set_conditional(a,this.value)}).each(function(){r.streams[a].onValue(function(e){this.checked=this.value==e}.bind(this))}),o.append("span").text(function(e){return e[0]})}.bind(this));var a=[["scroll_behavior","Scroll to zoom (instead of scroll to pan)","If checked, then the scroll wheel and trackpad will control zoom rather than pan.",{zoom:!0,pan:!1}],["hide_secondary_metabolites","Hide secondary metabolites","If checked, then only the primary metabolites will be displayed."],["show_gene_reaction_rules","Show gene reaction rules","If checked, then gene reaction rules will be displayed below each reaction label. (Gene reaction rules are always shown when gene data is loaded.)"],["hide_all_labels","Hide reaction, gene, and metabolite labels","If checked, hide all reaction, gene, and metabolite labels"],["allow_building_duplicate_reactions","Allow duplicate reactions","If checked, then allow duplicate reactions during model building."],["highlight_missing","Highlight reactions not in model","If checked, then highlight in red all the reactions on the map that are not present in the loaded model."]],s=e.append("div").attr("class","settings-container").selectAll(".option-group").data(a),l=s.enter().append("label").attr("class","option-group full-line");l.append("input").attr("type","checkbox"),l.append("span"),s.attr("title",function(e){return e[2]}),s.select("input").on("change",function(e){if(e.length>=4){for(var t in e[3])if(e[3][t]==this.checked){r.set_conditional(e[0],t);break}}else r.set_conditional(e[0],this.checked)}).each(function(e){r.streams[e[0]].onValue(function(t){e.length>=4?this.checked=e[3][t]:this.checked=t}.bind(this))}),s.select("span").text(function(e){return e[1]}),s.exit().remove(),e.append("div").style("margin-top","16px").classed("settings-tip",!0).text("Tip: To increase map performance, turn off text boxes (i.e. labels and gene reaction rules).")}var h=n(195),d=n(208),f=n(226),p=h.make_class();p.prototype={init:i,is_visible:r,toggle:o,hold_changes:a,abandon_changes:s,accept_changes:l,style_gui:u,view_gui:c},e.exports=p},function(e,t,n){function i(e,t,n,i){var r="grad"+t+this.unique_string;this.w=400,this.h=30,this.x=20,this.input_width=90,this.input_height=24;var o=e.append("div").attr("class","scale-editor");this.data_not_loaded=o.append("div").attr("class","data-not-loaded").text(("reaction"==t?"Reaction and gene":"Metabolite")+" data not loaded"),this.input_label_group=o.append("div").attr("class","input-label-group");var a=o.append("div").style("top",3*this.input_height+56+10+"px").attr("class","no-data");a.append("span").text("Styles for "+t+"s with no data").attr("class","no-data-heading"),this.no_data_container=a.append("div");var s=o.append("div").attr("class","centered");this.add_group=s.append("div"),this.trash_group=s.append("div").attr("class","trash-container");var l=s.append("svg").attr("class","scale-svg");this.input_group=s.append("div").attr("class","input-container"),this.gradient=l.append("defs").append("linearGradient").attr("id",r),l.append("rect").attr("class","rect").attr("fill","url(#"+r+")").attr("width",this.w+"px").attr("height",this.h+"px").attr("x",this.x+"px"),this.pickers_group=l.append("g"),this.type=t,this.settings=n,this.get_data_statistics=i;var u=this.settings.get_option("unique_map_id");this.unique_string=null===u?"":"."+u,this.no_data={},["color","size"].forEach(function(e){this.no_data[e]=null,this.settings.streams[this.type+"_no_data_"+e].onValue(function(t){this.no_data[e]=t,this.update_no_data()}.bind(this))}.bind(this)),this.settings.streams[t+"_scale"].onValue(function(e){this.scale=e,this.update()}.bind(this))}function r(){var e=this.scale,t=this.get_data_statistics()[this.type],n=14,i=35,r=this.x,o=this._data_not_loaded();o&&(e=[{type:"min",color:null,size:null},{type:"max",color:null,size:null}],t={min:0,max:1});var a=d3.scale.linear().domain([0,this.w]).range([t.min,t.max]),s=d3.scale.linear().domain([0,this.w]).range([0,t.max-t.min]),l=function(e,t){this.input_group.selectAll(".input-set").each(function(t){d3.select(this).classed("selected-set",e===t)})}.bind(this),u=function(e){return"value"==e.type?e.value:t[e.type]},c=function(e){this.settings.set_conditional(this.type+"_scale",e),this.scale=e,this.update()}.bind(this),h=e.map(function(e){return{frac:(u(e)-t.min)/(t.max-t.min),color:e.color}}).filter(function(e){return e.frac>=0&&e.frac<=1}).sort(function(e,t){return e.frac-t.frac}),d=this.gradient.selectAll("stop").data(h);d.enter().append("stop"),d.attr("offset",function(e){return 100*e.frac+"%"}).style("stop-color",function(e){return null===e.color?"#F1ECFA":e.color}),d.exit().remove(),this.data_not_loaded.style("visibility",o?null:"hidden");var f=this.pickers_group.selectAll(".picker").data(e),p=d3.behavior.drag();p.on("drag",function(i,r){-1===["value","min","max"].indexOf(e[r].type)&&(e[r].value=u(i),e[r].type="value");var o=e[r].value+s(d3.event.dx),a=s(n+2);o>t.max-a&&(o=t.max-a),o<t.min+a&&(o=t.min+a),o=Math.floor(100*o)/100,e[r].value=o,this.settings.set_conditional(this.type+"_scale",e),this.scale=e,this.update()}.bind(this)),f.enter().append("g").attr("class","picker").style("cursor","pointer").append("rect"),f.select("rect").attr("x",function(e,i){var o=u(e),s=n+2;return"value"==e.type&&o<=t.min?a.invert(t.min)-n/2+r-s:"value"==e.type&&o>=t.max?a.invert(t.max)-n/2+r+s:a.invert(o)-n/2+r}).attr("width",n+"px").attr("height",i+"px").call(p).on("mousedown",l),f.exit().remove();var _=this.trash_group.selectAll("span").data(e);_.enter().append("span"),_.attr("class",function(e,t){return"min"==e.type||"max"==e.type?null:"trash glyphicon glyphicon-trash"}).style("left",function(e){return a.invert(u(e))-n/2+r+"px"}).on("click",function(t,n){"min"!=t.type&&"max"!=t.type&&(e=e.slice(0,n).concat(e.slice(n+1)),this.settings.set_conditional(this.type+"_scale",e),this.scale=e,this.update())}.bind(this)),_.exit().remove();var g=this.add_group.selectAll(".add").data(["add"]);g.enter().append("span").attr("class","add glyphicon glyphicon-plus"),g.on("click",function(i){if(!o){for(var r=(t.max+t.min)/2,a=s(n+2),l=0,h=0,d=e.length;d>h;h++){var f=u(e[h]);Math.abs(f-r)<a&&(r+=a,r>t.max-a&&(r=t.max-a),r<t.min+a&&(r=t.min+a)),r>f&&(l=h)}e.push({type:"value",value:r,color:e[l].color,size:e[l].size}),c(e)}}.bind(this)),g.exit().remove();var m=this.input_label_group.selectAll(".row-label").data(["Value:","Color:","Size:"]);m.enter().append("div").attr("class","row-label").style("height",this.input_height+"px").style("line-height",this.input_height+"px"),m.style("top",function(e,t){return 56+t*this.input_height+"px"}.bind(this)).text(function(e){return e}),m.exit().remove();var v=this.input_group.selectAll(".input-set").data(e),y=v.enter().append("div").attr("class","input-set");y.append("input").attr("class","domain-input").style("width",this.input_width+"px"),y.append("select").attr("class","domain-type-picker"),y.append("input").attr("class","color-input").style("width",this.input_width+"px"),y.append("input").attr("type","color").style("visibility",function(){return"text"==this.type?"hidden":null}).attr("class","color-picker"),y.append("input").attr("class","size-input").style("width",this.input_width+"px"),v.style("height",3*this.input_height+"px").style("width",this.input_width+"px").style("left",function(e){var i,o=u(e),s=n+2;return i="value"==e.type&&o<=t.min?a.invert(t.min)-n/2+r-s:"value"==e.type&&o>=t.max?a.invert(t.max)-n/2+r+s:a.invert(o)-n/2+r,i+this.input_width>this.w+this.x&&(i=i-this.input_width+n/2),i+"px"}.bind(this)).on("mousedown",l);var b=d3.format(".4g");v.select(".domain-input").style("height",this.input_height+"px").each(function(e,t){"value"==e.type?(this.value=u(e),this.disabled=!1):(this.value=e.type+" ("+b(u(e))+")",this.disabled=!0)}).on("change",function(t,i){var r=(s(n+2),parseFloat(this.value));e[i].value=r,c(e)});var x=v.select(".domain-type-picker"),w=["value"].concat(Object.keys(t)).filter(function(e){return"min"!=e&&"max"!=e}),S=x.selectAll("option").data(w);S.enter().append("option"),S.attr("value",function(e){return e}).text(function(e){return e}),S.exit().remove(),x.style("visibility",function(e){return"min"==e.type||"max"==e.type?"hidden":null}).style("left",this.input_width-20+"px").style("width","20px").each(function(e,t){var n=0;d3.select(this).selectAll("option").each(function(t,i){this.value==e.type&&(n=i)}),this.selectedIndex=n}).on("change",function(n,i){"value"==this.value&&(e[i].value=t[n.type]),e[i].type=this.value,c(e)}),v.select(".color-input").style("height",this.input_height+"px").style("top",this.input_height+"px").each(function(e,t){this.value=null===e.color?"":e.color,this.disabled=null===e.color}).on("change",function(t,n){e[n].color=this.value,c(e)}),v.select(".color-picker").style("left",this.input_width-this.input_height+"px").style("top",this.input_height+"px").style("width",this.input_height+"px").style("height",this.input_height+"px").each(function(e,t){this.value=null===e.color?"#dddddd":e.color,this.disabled=null===e.color}).on("change",function(t,n){e[n].color=this.value,c(e)}),v.select(".size-input").style("height",this.input_height+"px").style("top",2*this.input_height+"px").each(function(e,t){this.value=null===e.size?"":e.size,this.disabled=null===e.size}).on("change",function(t,n){e[n].size=parseFloat(this.value),c(e)}),v.exit().remove()}function o(){var e=this.no_data,t=this._data_not_loaded(),n=40,i=this.no_data_container.selectAll(".input-group").data([["color","Color:"],["size","Size:"]]),r=i.enter().append("div").attr("class","input-group");r.append("span"),r.append("input"),r.append("input").attr("type","color").style("visibility",function(e){return"text"==this.type||"color"!=e[0]?"hidden":null}).attr("class","color-picker"),i.select("span").text(function(e){return e[1]}).style("height",this.input_height+"px").style("line-height",this.input_height+"px").style("left",function(e,t){return(n+this.input_width+10)*t+"px"}.bind(this));(function(e){return this.settings.get_option(this.type+"_no_data_"+e)}).bind(this);i.select("input").style("left",function(e,t){return n+(n+this.input_width+10)*t+"px"}.bind(this)).style("height",this.input_height+"px").style("width",this.input_width+"px").each(function(n){this.value=t?"":e[n[0]],this.disabled=t}).on("change",function(e){var t=d3.event.target.value;"size"==e[0]&&(t=parseFloat(t)),this.no_data[e[0]]=t,this.settings.set_conditional(this.type+"_no_data_"+e[0],t),this.update_no_data()}.bind(this)),i.select(".color-picker").style("left",function(e,t){return(n+this.input_width)*(t+1)-this.input_height+"px"}.bind(this)).style("width",this.input_height+"px").style("height",this.input_height+"px").each(function(n,i){this.value=t?"#dddddd":e[n[0]],this.disabled=t}).on("change",function(e,t){var n=d3.event.target.value;this.no_data[e[0]]=n,this.settings.set_conditional(this.type+"_no_data_"+e[0],n),this.update_no_data()}.bind(this)),i.exit().remove()}function a(){var e=this.get_data_statistics()[this.type];return null===e.max||null===e.min}var s=n(195),l=(n(219),s.make_class());l.prototype={init:i,update:r,update_no_data:o,_data_not_loaded:a},e.exports=l},function(e,t,n){function i(e,t,n){var i=e.append("div").attr("id","text-edit-input");this.placed_div=d(i,t),this.placed_div.hide(),this.input=i.append("input"),this.map=t,this.setup_map_callbacks(t),this.zoom_container=n,this.setup_zoom_callbacks(n)}function r(e){e.callback_manager.set("edit_text_label.text_edit_input",function(e,t){this.show(e,t)}.bind(this)),e.callback_manager.set("new_text_label.text_edit_input",function(e){null!==this.active_target&&this._accept_changes(this.active_target.target),this.hide(),this._add_and_edit(e)}.bind(this)),e.callback_manager.set("hide_text_label_editor.text_edit_input",function(){this.hide()}.bind(this))}function o(e){e.callback_manager.set("zoom.text_edit_input",function(){this.active_target&&this._accept_changes(this.active_target.target),this.hide()}.bind(this)),e.callback_manager.set("go_to.text_edit_input",function(){this.active_target&&this._accept_changes(this.active_target.target),this.hide()}.bind(this))}function a(){return this.placed_div.is_visible()}function s(e,t){this.active_target&&this._accept_changes(this.active_target.target),this.active_target={target:e,coords:t},e.each(function(e){this.input.node().value=e.text}.bind(this)),this.placed_div.place(t),this.input.node().focus(),this.clear_escape=this.map.key_manager.add_escape_listener(function(){this._accept_changes(e),this.hide()}.bind(this),!0),this.clear_enter=this.map.key_manager.add_enter_listener(function(e){this._accept_changes(e),this.hide()}.bind(this,e),!0)}function l(){this.placed_div.hide(),this.input.attr("value",""),this.active_target=null,this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.clear_enter&&this.clear_enter(),this.clear_enter=null}function u(e){if(""==this.input.node().value)e.each(function(e){var t={};t[e.text_label_id]=this.map.text_labels[e.text_label_id],this.map.delete_selectable({},t,!0)}.bind(this));else{var t=[];e.each(function(e){this.map.edit_text_label(e.text_label_id,this.input.node().value,!0),t.push(e.text_label_id)}.bind(this))}}function c(e){var t=this.map.new_text_label(e,""),n=this.map.sel.select("#text-labels").selectAll(".text-label").filter(function(e){return e.text_label_id==t});n.select("text").classed("edit-text-cursor",!0),this.show(n,e)}var h=n(195),d=n(202),f=(n(212),h.make_class());f.prototype={init:i,setup_map_callbacks:r,setup_zoom_callbacks:o,is_visible:a,show:s,hide:l,_accept_changes:u,_add_and_edit:c},e.exports=f},function(e,t,n){function i(e,t){var n=e.append("select").attr("id","quick-jump-menu").attr("class","form-control");this.selector=n;var i=a.parse_url_components(window),r="map_name"in i?i.map_name:null,o="quick_jump_path"in i?i.quick_jump_path:null,s="quick_jump"in i?i.quick_jump:[],l="— Jump to map —",u=[l].concat(s);null!==r&&(u=u.filter(function(e){return e!=r})),n.selectAll("option").data(u).enter().append("option").text(function(e){return e.split(".").slice(-1)[0]}),n.style("display",u.length>1?"block":"none");var c=function(e){t(e,o,function(t){t?this.replace_state_for_map_name(e):this.reset_selection()}.bind(this))}.bind(this);n.on("change",function(){var e=this.options[this.selectedIndex].__data__;c(e)})}function r(){this.selector.node().selectedIndex=0}function o(e){var t=window.location.href.replace(/(map_name=)([^&]+)(&|$)/,"$1"+e+"$3");window.history.replaceState("Not implemented","",t)}var a=n(195),s=a.make_class();s.prototype={init:i,reset_selection:r,replace_state_for_map_name:o},e.exports=s},function(e,t,n){var i=n(195);e.exports=function(e){function t(e,t,i,o,a){i.node().addEventListener("change",function(){n(e,this.value,a,o)},!1);var s=t[0];r(t,i),n(e,s,a,o)}function n(e,t,n,r){i.load_the_file(e,t,function(e,t){return e?console.warn(e):(o.data=t,void(r&&r(t)))})}function r(e,t){t.selectAll(".menu-option").data(e).enter().append("option").attr("value",function(e){return e}).text(function(e){return e}),t.node().focus()}var o=i.set_options(e,{selection:null,getdatafiles:null,datafiles:null,update_callback:null,target:null});if(null===o.selection)throw new Error("No selection provided for DataMenu");var a=o.selection.select(".data-menu");a.empty()&&(a=o.selection.append("div").attr("class","data-menu"));var s=a.append("form").append("select").attr("class","dropdown-menu");return o.getdatafiles?(o.datafiles&&console.warn("DataMenu: getdatafiles option overrides datafiles"),d3.json(o.getdatafiles,function(e,n){return e?console.warn(e):(t(o.target,n.data,s,o.update_callback,o.selection),null)})):o.datafiles?t(o.target,o.datafiles,s,o.update_callback,o.selection):console.warn("DataMenu: No datafiles given"),{update:r}}},function(e,t,n){function i(e,t,n,i,a){var s=o.parse_url_components(window,i),l=function(e){e(null)},u=function(e){e(null)};if(s.map_name){var c=r("map",s.map_name,n,e);c&&(l=function(e){d3.json(c,function(t,n){t&&console.warn(t),e(n)})})}if(s.model_name){var h=r("model",s.model_name,n,t);h&&(u=function(e){d3.json(h,function(t,n){t&&console.warn(t),e(n)})})}s.hasOwnProperty("enable_editing")&&(i.enable_editing="true"===s.enable_editing.toLowerCase()),l(function(e){u(function(t){a(e,t,i)})})}function r(e,t,n,i){var r=n[e+"s"].filter(function(n){return n[e+"_name"]==t});if(0==r.length)throw new Error("Bad "+e+" "+t);return i+encodeURIComponent(r[0].organism)+"/"+encodeURIComponent(r[0][e+"_name"])+".json"}var o=n(195);e.exports={load_map_model_from_url:i}},function(e,t,n){var i,r;!function(){function o(e){return e&&(e.ownerDocument||e.document||e).documentElement}function a(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}function s(e,t){return t>e?-1:e>t?1:e>=t?0:NaN}function l(e){return null===e?NaN:+e}function u(e){return!isNaN(e)}function c(e){return{left:function(t,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=t.length);r>i;){var o=i+r>>>1;e(t[o],n)<0?i=o+1:r=o}return i},right:function(t,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=t.length);r>i;){var o=i+r>>>1;e(t[o],n)>0?r=o:i=o+1}return i}}}function h(e){return e.length}function d(e){for(var t=1;e*t%1;)t*=10;return t}function f(e,t){for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}function p(){this._=Object.create(null)}function _(e){return(e+="")===Ca||e[0]===Ta?Ta+e:e}function g(e){return(e+="")[0]===Ta?e.slice(1):e}function m(e){return _(e)in this._}function v(e){return(e=_(e))in this._&&delete this._[e]}function y(){var e=[];for(var t in this._)e.push(g(t));return e}function b(){var e=0;for(var t in this._)++e;return e}function x(){for(var e in this._)return!1;return!0}function w(){this._=Object.create(null)}function S(e){return e}function A(e,t,n){return function(){var i=n.apply(t,arguments);return i===t?e:i}}function k(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var n=0,i=Ea.length;i>n;++n){var r=Ea[n]+t;if(r in e)return r}}function C(){}function T(){}function E(e){function t(){for(var t,i=n,r=-1,o=i.length;++r<o;)(t=i[r].on)&&t.apply(this,arguments);return e}var n=[],i=new p;return t.on=function(t,r){var o,a=i.get(t);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),i.remove(t)),r&&n.push(i.set(t,{on:r})),e)},t}function M(){fa.event.preventDefault()}function L(){for(var e,t=fa.event;e=t.sourceEvent;)t=e;return t}function R(e){for(var t=new T,n=0,i=arguments.length;++n<i;)t[arguments[n]]=E(t);return t.of=function(n,i){return function(r){try{var o=r.sourceEvent=fa.event;r.target=e,fa.event=r,t[r.type].apply(n,i)}finally{fa.event=o}}},t}function O(e){return La(e,Da),e}function P(e){return"function"==typeof e?e:function(){return Ra(e,this)}}function D(e){return"function"==typeof e?e:function(){return Oa(e,this)}}function I(e,t){function n(){this.removeAttribute(e)}function i(){this.removeAttributeNS(e.space,e.local)}function r(){this.setAttribute(e,t)}function o(){this.setAttributeNS(e.space,e.local,t)}function a(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}function s(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=fa.ns.qualify(e),null==t?e.local?i:n:"function"==typeof t?e.local?s:a:e.local?o:r}function N(e){return e.trim().replace(/\s+/g," ")}function F(e){return new RegExp("(?:^|\\s+)"+fa.requote(e)+"(?:\\s+|$)","g")}function B(e){return(e+"").trim().split(/^|\s+/)}function z(e,t){function n(){for(var n=-1;++n<r;)e[n](this,t)}function i(){for(var n=-1,i=t.apply(this,arguments);++n<r;)e[n](this,i)}e=B(e).map(H);var r=e.length;return"function"==typeof t?i:n}function H(e){var t=F(e);return function(n,i){if(r=n.classList)return i?r.add(e):r.remove(e);var r=n.getAttribute("class")||"";i?(t.lastIndex=0,t.test(r)||n.setAttribute("class",N(r+" "+e))):n.setAttribute("class",N(r.replace(t," ")))}}function q(e,t,n){function i(){this.style.removeProperty(e)}function r(){this.style.setProperty(e,t,n)}function o(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}return null==t?i:"function"==typeof t?o:r}function G(e,t){function n(){delete this[e]}function i(){this[e]=t}function r(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}return null==t?n:"function"==typeof t?r:i}function j(e){function t(){var t=this.ownerDocument,n=this.namespaceURI;return n&&n!==t.documentElement.namespaceURI?t.createElementNS(n,e):t.createElement(e)}function n(){return this.ownerDocument.createElementNS(e.space,e.local)}return"function"==typeof e?e:(e=fa.ns.qualify(e)).local?n:t}function U(){var e=this.parentNode;e&&e.removeChild(this)}function V(e){return{__data__:e}}function W(e){return function(){return Pa(this,e)}}function X(e){return arguments.length||(e=s),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function K(e,t){for(var n=0,i=e.length;i>n;n++)for(var r,o=e[n],a=0,s=o.length;s>a;a++)(r=o[a])&&t(r,a,n);return e}function Y(e){return La(e,Na),e}function Z(e){var t,n;return function(i,r,o){var a,s=e[o].update,l=s.length;for(o!=n&&(n=o,t=0),r>=t&&(t=r+1);!(a=s[t])&&++t<l;);return a}}function $(e,t,n){function i(){var t=this[a];t&&(this.removeEventListener(e,t,t.$),delete this[a])}function r(){var r=l(t,_a(arguments));i.call(this),this.addEventListener(e,this[a]=r,r.$=n),r._=t}function o(){var t,n=new RegExp("^__on([^.]+)"+fa.requote(e)+"$");for(var i in this)if(t=i.match(n)){var r=this[i];this.removeEventListener(t[1],r,r.$),delete this[i]}}var a="__on"+e,s=e.indexOf("."),l=J;s>0&&(e=e.slice(0,s));var u=Fa.get(e);return u&&(e=u,l=Q),s?t?r:i:t?C:o}function J(e,t){return function(n){var i=fa.event;fa.event=n,t[0]=this.__data__;try{e.apply(this,t)}finally{fa.event=i}}}function Q(e,t){var n=J(e,t);return function(e){var t=this,i=e.relatedTarget;i&&(i===t||8&i.compareDocumentPosition(t))||n.call(t,e)}}function ee(e){var t=".dragsuppress-"+ ++za,n="click"+t,i=fa.select(a(e)).on("touchmove"+t,M).on("dragstart"+t,M).on("selectstart"+t,M);if(null==Ba&&(Ba="onselectstart"in e?!1:k(e.style,"userSelect")),Ba){var r=o(e).style,s=r[Ba];r[Ba]="none"}return function(e){if(i.on(t,null),Ba&&(r[Ba]=s),e){var o=function(){i.on(n,null)};i.on(n,function(){M(),o()},!0),setTimeout(o,0)}}}function te(e,t){t.changedTouches&&(t=t.changedTouches[0]);var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();if(0>Ha){var r=a(e);if(r.scrollX||r.scrollY){n=fa.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=n[0][0].getScreenCTM();Ha=!(o.f||o.e),n.remove()}}return Ha?(i.x=t.pageX,i.y=t.pageY):(i.x=t.clientX,i.y=t.clientY),i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}function ne(){return fa.event.changedTouches[0].identifier}function ie(e){return e>0?1:0>e?-1:0}function re(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function oe(e){return e>1?0:-1>e?ja:Math.acos(e)}function ae(e){return e>1?Wa:-1>e?-Wa:Math.asin(e)}function se(e){return((e=Math.exp(e))-1/e)/2}function le(e){return((e=Math.exp(e))+1/e)/2}function ue(e){return((e=Math.exp(2*e))-1)/(e+1)}function ce(e){return(e=Math.sin(e/2))*e}function he(){}function de(e,t,n){return this instanceof de?(this.h=+e,this.s=+t,void(this.l=+n)):arguments.length<2?e instanceof de?new de(e.h,e.s,e.l):Ce(""+e,Te,de):new de(e,t,n)}function fe(e,t,n){function i(e){return e>360?e-=360:0>e&&(e+=360),60>e?o+(a-o)*e/60:180>e?a:240>e?o+(a-o)*(240-e)/60:o}function r(e){return Math.round(255*i(e))}var o,a;return e=isNaN(e)?0:(e%=360)<0?e+360:e,t=isNaN(t)?0:0>t?0:t>1?1:t,n=0>n?0:n>1?1:n,a=.5>=n?n*(1+t):n+t-n*t,o=2*n-a,new we(r(e+120),r(e),r(e-120))}function pe(e,t,n){return this instanceof pe?(this.h=+e,this.c=+t,void(this.l=+n)):arguments.length<2?e instanceof pe?new pe(e.h,e.c,e.l):e instanceof ge?ve(e.l,e.a,e.b):ve((e=Ee((e=fa.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new pe(e,t,n)}function _e(e,t,n){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new ge(n,Math.cos(e*=Xa)*t,Math.sin(e)*t)}function ge(e,t,n){return this instanceof ge?(this.l=+e,this.a=+t,void(this.b=+n)):arguments.length<2?e instanceof ge?new ge(e.l,e.a,e.b):e instanceof pe?_e(e.h,e.c,e.l):Ee((e=we(e)).r,e.g,e.b):new ge(e,t,n)}function me(e,t,n){var i=(e+16)/116,r=i+t/500,o=i-n/200;return r=ye(r)*rs,i=ye(i)*os,o=ye(o)*as,new we(xe(3.2404542*r-1.5371385*i-.4985314*o),xe(-.969266*r+1.8760108*i+.041556*o),xe(.0556434*r-.2040259*i+1.0572252*o))}function ve(e,t,n){return e>0?new pe(Math.atan2(n,t)*Ka,Math.sqrt(t*t+n*n),e):new pe(NaN,NaN,e)}function ye(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function be(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function xe(e){return Math.round(255*(.00304>=e?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function we(e,t,n){return this instanceof we?(this.r=~~e,this.g=~~t,void(this.b=~~n)):arguments.length<2?e instanceof we?new we(e.r,e.g,e.b):Ce(""+e,we,fe):new we(e,t,n)}function Se(e){return new we(e>>16,e>>8&255,255&e)}function Ae(e){return Se(e)+""}function ke(e){return 16>e?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function Ce(e,t,n){var i,r,o,a=0,s=0,l=0;if(i=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase()))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return t(Le(r[0]),Le(r[1]),Le(r[2]))}return(o=us.get(e))?t(o.r,o.g,o.b):(null==e||"#"!==e.charAt(0)||isNaN(o=parseInt(e.slice(1),16))||(4===e.length?(a=(3840&o)>>4,a=a>>4|a,s=240&o,s=s>>4|s,l=15&o,l=l<<4|l):7===e.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,l=255&o)),t(a,s,l))}function Te(e,t,n){var i,r,o=Math.min(e/=255,t/=255,n/=255),a=Math.max(e,t,n),s=a-o,l=(a+o)/2;return s?(r=.5>l?s/(a+o):s/(2-a-o),i=e==a?(t-n)/s+(n>t?6:0):t==a?(n-e)/s+2:(e-t)/s+4,i*=60):(i=NaN,r=l>0&&1>l?0:i),new de(i,r,l)}function Ee(e,t,n){e=Me(e),t=Me(t),n=Me(n);var i=be((.4124564*e+.3575761*t+.1804375*n)/rs),r=be((.2126729*e+.7151522*t+.072175*n)/os),o=be((.0193339*e+.119192*t+.9503041*n)/as);return ge(116*r-16,500*(i-r),200*(r-o))}function Me(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Le(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}function Re(e){return"function"==typeof e?e:function(){return e}}function Oe(e){return function(t,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),Pe(t,n,e,i)}}function Pe(e,t,n,i){function r(){var e,t=l.status;if(!t&&Ie(l)||t>=200&&300>t||304===t){try{e=n.call(o,l)}catch(i){return void a.error.call(o,i)}a.load.call(o,e)}else a.error.call(o,l)}var o={},a=fa.dispatch("beforesend","progress","load","error"),s={},l=new XMLHttpRequest,u=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(e)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=r:l.onreadystatechange=function(){l.readyState>3&&r()},l.onprogress=function(e){var t=fa.event;fa.event=e;try{a.progress.call(o,l)}finally{fa.event=t}},o.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?s[e]:(null==t?delete s[e]:s[e]=t+"",o)},o.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",o):t},o.responseType=function(e){return arguments.length?(u=e,o):u},o.response=function(e){return n=e,o},["get","post"].forEach(function(e){o[e]=function(){return o.send.apply(o,[e].concat(_a(arguments)))}}),o.send=function(n,i,r){if(2===arguments.length&&"function"==typeof i&&(r=i,i=null),l.open(n,e,!0),null==t||"accept"in s||(s.accept=t+",*/*"),l.setRequestHeader)for(var c in s)l.setRequestHeader(c,s[c]);return null!=t&&l.overrideMimeType&&l.overrideMimeType(t),null!=u&&(l.responseType=u),null!=r&&o.on("error",r).on("load",function(e){r(null,e)}),a.beforesend.call(o,l),l.send(null==i?null:i),o},o.abort=function(){return l.abort(),o},fa.rebind(o,a,"on"),null==i?o:o.get(De(i))}function De(e){return 1===e.length?function(t,n){e(null==t?n:null)}:e}function Ie(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}function Ne(e,t,n){var i=arguments.length;2>i&&(t=0),3>i&&(n=Date.now());var r=n+t,o={c:e,t:r,n:null};return hs?hs.n=o:cs=o,hs=o,ds||(fs=clearTimeout(fs),ds=1,ps(Fe)),o}function Fe(){var e=Be(),t=ze()-e;t>24?(isFinite(t)&&(clearTimeout(fs),fs=setTimeout(Fe,t)),ds=0):(ds=1,ps(Fe))}function Be(){for(var e=Date.now(),t=cs;t;)e>=t.t&&t.c(e-t.t)&&(t.c=null),t=t.n;return e}function ze(){for(var e,t=cs,n=1/0;t;)t.c?(t.t<n&&(n=t.t),t=(e=t).n):t=e?e.n=t.n:cs=t.n;return hs=e,n}function He(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function qe(e,t){var n=Math.pow(10,3*ka(8-t));return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function Ge(e){var t=e.decimal,n=e.thousands,i=e.grouping,r=e.currency,o=i&&n?function(e,t){for(var r=e.length,o=[],a=0,s=i[0],l=0;r>0&&s>0&&(l+s+1>t&&(s=Math.max(1,t-l)),o.push(e.substring(r-=s,r+s)),!((l+=s+1)>t));)s=i[a=(a+1)%i.length];return o.reverse().join(n)}:S;return function(e){var n=gs.exec(e),i=n[1]||" ",a=n[2]||">",s=n[3]||"-",l=n[4]||"",u=n[5],c=+n[6],h=n[7],d=n[8],f=n[9],p=1,_="",g="",m=!1,v=!0;switch(d&&(d=+d.substring(1)),(u||"0"===i&&"="===a)&&(u=i="0",a="="),f){case"n":h=!0,f="g";break;case"%":p=100,g="%",f="f";break;case"p":p=100,g="%",f="r";break;case"b":case"o":case"x":case"X":"#"===l&&(_="0"+f.toLowerCase());case"c":v=!1;case"d":m=!0,d=0;break;case"s":p=-1,f="r"}"$"===l&&(_=r[0],g=r[1]),"r"!=f||d||(f="g"),null!=d&&("g"==f?d=Math.max(1,Math.min(21,d)):("e"==f||"f"==f)&&(d=Math.max(0,Math.min(20,d)))),f=ms.get(f)||je;var y=u&&h;return function(e){var n=g;if(m&&e%1)return"";var r=0>e||0===e&&0>1/e?(e=-e,"-"):"-"===s?"":s;if(0>p){var l=fa.formatPrefix(e,d);e=l.scale(e),n=l.symbol+g}else e*=p;e=f(e,d);var b,x,w=e.lastIndexOf(".");if(0>w){var S=v?e.lastIndexOf("e"):-1;0>S?(b=e,x=""):(b=e.substring(0,S),x=e.substring(S))}else b=e.substring(0,w),x=t+e.substring(w+1);!u&&h&&(b=o(b,1/0));var A=_.length+b.length+x.length+(y?0:r.length),k=c>A?new Array(A=c-A+1).join(i):"";return y&&(b=o(k+b,k.length?c-x.length:1/0)),r+=_,e=b+x,("<"===a?r+e+k:">"===a?k+r+e:"^"===a?k.substring(0,A>>=1)+r+e+k.substring(A):r+(y?e:k+e))+n}}}function je(e){return e+""}function Ue(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ve(e,t,n){function i(t){var n=e(t),i=o(n,1);return i-t>t-n?n:i}function r(n){return t(n=e(new ys(n-1)),1),n}function o(e,n){return t(e=new ys(+e),n),e}function a(e,i,o){var a=r(e),s=[];if(o>1)for(;i>a;)n(a)%o||s.push(new Date(+a)),t(a,1);else for(;i>a;)s.push(new Date(+a)),t(a,1);return s}function s(e,t,n){try{ys=Ue;var i=new Ue;return i._=e,a(i,t,n)}finally{ys=Date}}e.floor=e,e.round=i,e.ceil=r,e.offset=o,e.range=a;var l=e.utc=We(e);return l.floor=l,l.round=We(i),l.ceil=We(r),l.offset=We(o),l.range=s,e}function We(e){return function(t,n){try{ys=Ue;var i=new Ue;return i._=t,e(i,n)._}finally{ys=Date}}}function Xe(e){function t(e){function t(t){for(var n,r,o,a=[],s=-1,l=0;++s<i;)37===e.charCodeAt(s)&&(a.push(e.slice(l,s)),
null!=(r=xs[n=e.charAt(++s)])&&(n=e.charAt(++s)),(o=E[n])&&(n=o(t,null==r?"e"===n?" ":"0":r)),a.push(n),l=s+1);return a.push(e.slice(l,s)),a.join("")}var i=e.length;return t.parse=function(t){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=n(i,e,t,0);if(r!=t.length)return null;"p"in i&&(i.H=i.H%12+12*i.p);var o=null!=i.Z&&ys!==Ue,a=new(o?Ue:ys);return"j"in i?a.setFullYear(i.y,0,i.j):"W"in i||"U"in i?("w"in i||(i.w="W"in i?1:0),a.setFullYear(i.y,0,1),a.setFullYear(i.y,0,"W"in i?(i.w+6)%7+7*i.W-(a.getDay()+5)%7:i.w+7*i.U-(a.getDay()+6)%7)):a.setFullYear(i.y,i.m,i.d),a.setHours(i.H+(i.Z/100|0),i.M+i.Z%100,i.S,i.L),o?a._:a},t.toString=function(){return e},t}function n(e,t,n,i){for(var r,o,a,s=0,l=t.length,u=n.length;l>s;){if(i>=u)return-1;if(r=t.charCodeAt(s++),37===r){if(a=t.charAt(s++),o=M[a in xs?t.charAt(s++):a],!o||(i=o(e,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function i(e,t,n){w.lastIndex=0;var i=w.exec(t.slice(n));return i?(e.w=S.get(i[0].toLowerCase()),n+i[0].length):-1}function r(e,t,n){b.lastIndex=0;var i=b.exec(t.slice(n));return i?(e.w=x.get(i[0].toLowerCase()),n+i[0].length):-1}function o(e,t,n){C.lastIndex=0;var i=C.exec(t.slice(n));return i?(e.m=T.get(i[0].toLowerCase()),n+i[0].length):-1}function a(e,t,n){A.lastIndex=0;var i=A.exec(t.slice(n));return i?(e.m=k.get(i[0].toLowerCase()),n+i[0].length):-1}function s(e,t,i){return n(e,E.c.toString(),t,i)}function l(e,t,i){return n(e,E.x.toString(),t,i)}function u(e,t,i){return n(e,E.X.toString(),t,i)}function c(e,t,n){var i=y.get(t.slice(n,n+=2).toLowerCase());return null==i?-1:(e.p=i,n)}var h=e.dateTime,d=e.date,f=e.time,p=e.periods,_=e.days,g=e.shortDays,m=e.months,v=e.shortMonths;t.utc=function(e){function n(e){try{ys=Ue;var t=new ys;return t._=e,i(t)}finally{ys=Date}}var i=t(e);return n.parse=function(e){try{ys=Ue;var t=i.parse(e);return t&&t._}finally{ys=Date}},n.toString=i.toString,n},t.multi=t.utc.multi=ft;var y=fa.map(),b=Ye(_),x=Ze(_),w=Ye(g),S=Ze(g),A=Ye(m),k=Ze(m),C=Ye(v),T=Ze(v);p.forEach(function(e,t){y.set(e.toLowerCase(),t)});var E={a:function(e){return g[e.getDay()]},A:function(e){return _[e.getDay()]},b:function(e){return v[e.getMonth()]},B:function(e){return m[e.getMonth()]},c:t(h),d:function(e,t){return Ke(e.getDate(),t,2)},e:function(e,t){return Ke(e.getDate(),t,2)},H:function(e,t){return Ke(e.getHours(),t,2)},I:function(e,t){return Ke(e.getHours()%12||12,t,2)},j:function(e,t){return Ke(1+vs.dayOfYear(e),t,3)},L:function(e,t){return Ke(e.getMilliseconds(),t,3)},m:function(e,t){return Ke(e.getMonth()+1,t,2)},M:function(e,t){return Ke(e.getMinutes(),t,2)},p:function(e){return p[+(e.getHours()>=12)]},S:function(e,t){return Ke(e.getSeconds(),t,2)},U:function(e,t){return Ke(vs.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return Ke(vs.mondayOfYear(e),t,2)},x:t(d),X:t(f),y:function(e,t){return Ke(e.getFullYear()%100,t,2)},Y:function(e,t){return Ke(e.getFullYear()%1e4,t,4)},Z:ht,"%":function(){return"%"}},M={a:i,A:r,b:o,B:a,c:s,d:ot,e:ot,H:st,I:st,j:at,L:ct,m:rt,M:lt,p:c,S:ut,U:Je,w:$e,W:Qe,x:l,X:u,y:tt,Y:et,Z:nt,"%":dt};return t}function Ke(e,t,n){var i=0>e?"-":"",r=(i?-e:e)+"",o=r.length;return i+(n>o?new Array(n-o+1).join(t)+r:r)}function Ye(e){return new RegExp("^(?:"+e.map(fa.requote).join("|")+")","i")}function Ze(e){for(var t=new p,n=-1,i=e.length;++n<i;)t.set(e[n].toLowerCase(),n);return t}function $e(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function Je(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n));return i?(e.U=+i[0],n+i[0].length):-1}function Qe(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n));return i?(e.W=+i[0],n+i[0].length):-1}function et(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function tt(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+2));return i?(e.y=it(+i[0]),n+i[0].length):-1}function nt(e,t,n){return/^[+-]\d{4}$/.test(t=t.slice(n,n+5))?(e.Z=-t,n+5):-1}function it(e){return e+(e>68?1900:2e3)}function rt(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function ot(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function at(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+3));return i?(e.j=+i[0],n+i[0].length):-1}function st(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function lt(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function ut(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function ct(e,t,n){ws.lastIndex=0;var i=ws.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function ht(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",i=ka(t)/60|0,r=ka(t)%60;return n+Ke(i,"0",2)+Ke(r,"0",2)}function dt(e,t,n){Ss.lastIndex=0;var i=Ss.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function ft(e){for(var t=e.length,n=-1;++n<t;)e[n][0]=this(e[n][0]);return function(t){for(var n=0,i=e[n];!i[1](t);)i=e[++n];return i[0](t)}}function pt(){}function _t(e,t,n){var i=n.s=e+t,r=i-e,o=i-r;n.t=e-o+(t-r)}function gt(e,t){e&&Ts.hasOwnProperty(e.type)&&Ts[e.type](e,t)}function mt(e,t,n){var i,r=-1,o=e.length-n;for(t.lineStart();++r<o;)i=e[r],t.point(i[0],i[1],i[2]);t.lineEnd()}function vt(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)mt(e[n],t,1);t.polygonEnd()}function yt(){function e(e,t){e*=Xa,t=t*Xa/2+ja/4;var n=e-i,a=n>=0?1:-1,s=a*n,l=Math.cos(t),u=Math.sin(t),c=o*u,h=r*l+c*Math.cos(s),d=c*a*Math.sin(s);Ms.add(Math.atan2(d,h)),i=e,r=l,o=u}var t,n,i,r,o;Ls.point=function(a,s){Ls.point=e,i=(t=a)*Xa,r=Math.cos(s=(n=s)*Xa/2+ja/4),o=Math.sin(s)},Ls.lineEnd=function(){e(t,n)}}function bt(e){var t=e[0],n=e[1],i=Math.cos(n);return[i*Math.cos(t),i*Math.sin(t),Math.sin(n)]}function xt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function wt(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function St(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function At(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function kt(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Ct(e){return[Math.atan2(e[1],e[0]),ae(e[2])]}function Tt(e,t){return ka(e[0]-t[0])<qa&&ka(e[1]-t[1])<qa}function Et(e,t){e*=Xa;var n=Math.cos(t*=Xa);Mt(n*Math.cos(e),n*Math.sin(e),Math.sin(t))}function Mt(e,t,n){++Rs,Ps+=(e-Ps)/Rs,Ds+=(t-Ds)/Rs,Is+=(n-Is)/Rs}function Lt(){function e(e,r){e*=Xa;var o=Math.cos(r*=Xa),a=o*Math.cos(e),s=o*Math.sin(e),l=Math.sin(r),u=Math.atan2(Math.sqrt((u=n*l-i*s)*u+(u=i*a-t*l)*u+(u=t*s-n*a)*u),t*a+n*s+i*l);Os+=u,Ns+=u*(t+(t=a)),Fs+=u*(n+(n=s)),Bs+=u*(i+(i=l)),Mt(t,n,i)}var t,n,i;Gs.point=function(r,o){r*=Xa;var a=Math.cos(o*=Xa);t=a*Math.cos(r),n=a*Math.sin(r),i=Math.sin(o),Gs.point=e,Mt(t,n,i)}}function Rt(){Gs.point=Et}function Ot(){function e(e,t){e*=Xa;var n=Math.cos(t*=Xa),a=n*Math.cos(e),s=n*Math.sin(e),l=Math.sin(t),u=r*l-o*s,c=o*a-i*l,h=i*s-r*a,d=Math.sqrt(u*u+c*c+h*h),f=i*a+r*s+o*l,p=d&&-oe(f)/d,_=Math.atan2(d,f);zs+=p*u,Hs+=p*c,qs+=p*h,Os+=_,Ns+=_*(i+(i=a)),Fs+=_*(r+(r=s)),Bs+=_*(o+(o=l)),Mt(i,r,o)}var t,n,i,r,o;Gs.point=function(a,s){t=a,n=s,Gs.point=e,a*=Xa;var l=Math.cos(s*=Xa);i=l*Math.cos(a),r=l*Math.sin(a),o=Math.sin(s),Mt(i,r,o)},Gs.lineEnd=function(){e(t,n),Gs.lineEnd=Rt,Gs.point=Et}}function Pt(e,t){function n(n,i){return n=e(n,i),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,i){return n=t.invert(n,i),n&&e.invert(n[0],n[1])}),n}function Dt(){return!0}function It(e,t,n,i,r){var o=[],a=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,n=e[0],i=e[t];if(Tt(n,i)){r.lineStart();for(var s=0;t>s;++s)r.point((n=e[s])[0],n[1]);return void r.lineEnd()}var l=new Ft(n,e,null,!0),u=new Ft(n,null,l,!1);l.o=u,o.push(l),a.push(u),l=new Ft(i,e,null,!1),u=new Ft(i,null,l,!0),l.o=u,o.push(l),a.push(u)}}),a.sort(t),Nt(o),Nt(a),o.length){for(var s=0,l=n,u=a.length;u>s;++s)a[s].e=l=!l;for(var c,h,d=o[0];;){for(var f=d,p=!0;f.v;)if((f=f.n)===d)return;c=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(var s=0,u=c.length;u>s;++s)r.point((h=c[s])[0],h[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(p){c=f.p.z;for(var s=c.length-1;s>=0;--s)r.point((h=c[s])[0],h[1])}else i(f.x,f.p.x,-1,r);f=f.p}f=f.o,c=f.z,p=!p}while(!f.v);r.lineEnd()}}}function Nt(e){if(t=e.length){for(var t,n,i=0,r=e[0];++i<t;)r.n=n=e[i],n.p=r,r=n;r.n=n=e[0],n.p=r}}function Ft(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Bt(e,t,n,i){return function(r,o){function a(t,n){var i=r(t,n);e(t=i[0],n=i[1])&&o.point(t,n)}function s(e,t){var n=r(e,t);g.point(n[0],n[1])}function l(){v.point=s,g.lineStart()}function u(){v.point=a,g.lineEnd()}function c(e,t){_.push([e,t]);var n=r(e,t);b.point(n[0],n[1])}function h(){b.lineStart(),_=[]}function d(){c(_[0][0],_[0][1]),b.lineEnd();var e,t=b.clean(),n=y.buffer(),i=n.length;if(_.pop(),p.push(_),_=null,i)if(1&t){e=n[0];var r,i=e.length-1,a=-1;if(i>0){for(x||(o.polygonStart(),x=!0),o.lineStart();++a<i;)o.point((r=e[a])[0],r[1]);o.lineEnd()}}else i>1&&2&t&&n.push(n.pop().concat(n.shift())),f.push(n.filter(zt))}var f,p,_,g=t(o),m=r.invert(i[0],i[1]),v={point:a,lineStart:l,lineEnd:u,polygonStart:function(){v.point=c,v.lineStart=h,v.lineEnd=d,f=[],p=[]},polygonEnd:function(){v.point=a,v.lineStart=l,v.lineEnd=u,f=fa.merge(f);var e=Vt(m,p);f.length?(x||(o.polygonStart(),x=!0),It(f,qt,e,n,o)):e&&(x||(o.polygonStart(),x=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),x&&(o.polygonEnd(),x=!1),f=p=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}},y=Ht(),b=t(y),x=!1;return v}}function zt(e){return e.length>1}function Ht(){var e,t=[];return{lineStart:function(){t.push(e=[])},point:function(t,n){e.push([t,n])},lineEnd:C,buffer:function(){var n=t;return t=[],e=null,n},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function qt(e,t){return((e=e.x)[0]<0?e[1]-Wa-qa:Wa-e[1])-((t=t.x)[0]<0?t[1]-Wa-qa:Wa-t[1])}function Gt(e){var t,n=NaN,i=NaN,r=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?ja:-ja,l=ka(o-n);ka(l-ja)<qa?(e.point(n,i=(i+a)/2>0?Wa:-Wa),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(s,i),e.point(o,i),t=0):r!==s&&l>=ja&&(ka(n-r)<qa&&(n-=r*qa),ka(o-s)<qa&&(o-=s*qa),i=jt(n,i,o,a),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(s,i),t=0),e.point(n=o,i=a),r=s},lineEnd:function(){e.lineEnd(),n=i=NaN},clean:function(){return 2-t}}}function jt(e,t,n,i){var r,o,a=Math.sin(e-n);return ka(a)>qa?Math.atan((Math.sin(t)*(o=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(t))*Math.sin(e))/(r*o*a)):(t+i)/2}function Ut(e,t,n,i){var r;if(null==e)r=n*Wa,i.point(-ja,r),i.point(0,r),i.point(ja,r),i.point(ja,0),i.point(ja,-r),i.point(0,-r),i.point(-ja,-r),i.point(-ja,0),i.point(-ja,r);else if(ka(e[0]-t[0])>qa){var o=e[0]<t[0]?ja:-ja;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(t[0],t[1])}function Vt(e,t){var n=e[0],i=e[1],r=[Math.sin(n),-Math.cos(n),0],o=0,a=0;Ms.reset();for(var s=0,l=t.length;l>s;++s){var u=t[s],c=u.length;if(c)for(var h=u[0],d=h[0],f=h[1]/2+ja/4,p=Math.sin(f),_=Math.cos(f),g=1;;){g===c&&(g=0),e=u[g];var m=e[0],v=e[1]/2+ja/4,y=Math.sin(v),b=Math.cos(v),x=m-d,w=x>=0?1:-1,S=w*x,A=S>ja,k=p*y;if(Ms.add(Math.atan2(k*w*Math.sin(S),_*b+k*Math.cos(S))),o+=A?x+w*Ua:x,A^d>=n^m>=n){var C=wt(bt(h),bt(e));kt(C);var T=wt(r,C);kt(T);var E=(A^x>=0?-1:1)*ae(T[2]);(i>E||i===E&&(C[0]||C[1]))&&(a+=A^x>=0?1:-1)}if(!g++)break;d=m,p=y,_=b,h=e}}return(-qa>o||qa>o&&0>Ms)^1&a}function Wt(e){function t(e,t){return Math.cos(e)*Math.cos(t)>o}function n(e){var n,o,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var f,p=[h,d],_=t(h,d),g=a?_?0:r(h,d):_?r(h+(0>h?ja:-ja),d):0;if(!n&&(u=l=_)&&e.lineStart(),_!==l&&(f=i(n,p),(Tt(n,f)||Tt(p,f))&&(p[0]+=qa,p[1]+=qa,_=t(p[0],p[1]))),_!==l)c=0,_?(e.lineStart(),f=i(p,n),e.point(f[0],f[1])):(f=i(n,p),e.point(f[0],f[1]),e.lineEnd()),n=f;else if(s&&n&&a^_){var m;g&o||!(m=i(p,n,!0))||(c=0,a?(e.lineStart(),e.point(m[0][0],m[0][1]),e.point(m[1][0],m[1][1]),e.lineEnd()):(e.point(m[1][0],m[1][1]),e.lineEnd(),e.lineStart(),e.point(m[0][0],m[0][1])))}!_||n&&Tt(n,p)||e.point(p[0],p[1]),n=p,l=_,o=g},lineEnd:function(){l&&e.lineEnd(),n=null},clean:function(){return c|(u&&l)<<1}}}function i(e,t,n){var i=bt(e),r=bt(t),a=[1,0,0],s=wt(i,r),l=xt(s,s),u=s[0],c=l-u*u;if(!c)return!n&&e;var h=o*l/c,d=-o*u/c,f=wt(a,s),p=At(a,h),_=At(s,d);St(p,_);var g=f,m=xt(p,g),v=xt(g,g),y=m*m-v*(xt(p,p)-1);if(!(0>y)){var b=Math.sqrt(y),x=At(g,(-m-b)/v);if(St(x,p),x=Ct(x),!n)return x;var w,S=e[0],A=t[0],k=e[1],C=t[1];S>A&&(w=S,S=A,A=w);var T=A-S,E=ka(T-ja)<qa,M=E||qa>T;if(!E&&k>C&&(w=k,k=C,C=w),M?E?k+C>0^x[1]<(ka(x[0]-S)<qa?k:C):k<=x[1]&&x[1]<=C:T>ja^(S<=x[0]&&x[0]<=A)){var L=At(g,(-m+b)/v);return St(L,p),[x,Ct(L)]}}}function r(t,n){var i=a?e:ja-e,r=0;return-i>t?r|=1:t>i&&(r|=2),-i>n?r|=4:n>i&&(r|=8),r}var o=Math.cos(e),a=o>0,s=ka(o)>qa,l=bn(e,6*Xa);return Bt(t,n,l,a?[0,-e]:[-ja,e-ja])}function Xt(e,t,n,i){return function(r){var o,a=r.a,s=r.b,l=a.x,u=a.y,c=s.x,h=s.y,d=0,f=1,p=c-l,_=h-u;if(o=e-l,p||!(o>0)){if(o/=p,0>p){if(d>o)return;f>o&&(f=o)}else if(p>0){if(o>f)return;o>d&&(d=o)}if(o=n-l,p||!(0>o)){if(o/=p,0>p){if(o>f)return;o>d&&(d=o)}else if(p>0){if(d>o)return;f>o&&(f=o)}if(o=t-u,_||!(o>0)){if(o/=_,0>_){if(d>o)return;f>o&&(f=o)}else if(_>0){if(o>f)return;o>d&&(d=o)}if(o=i-u,_||!(0>o)){if(o/=_,0>_){if(o>f)return;o>d&&(d=o)}else if(_>0){if(d>o)return;f>o&&(f=o)}return d>0&&(r.a={x:l+d*p,y:u+d*_}),1>f&&(r.b={x:l+f*p,y:u+f*_}),r}}}}}}function Kt(e,t,n,i){function r(i,r){return ka(i[0]-e)<qa?r>0?0:3:ka(i[0]-n)<qa?r>0?2:1:ka(i[1]-t)<qa?r>0?1:0:r>0?3:2}function o(e,t){return a(e.x,t.x)}function a(e,t){var n=r(e,1),i=r(t,1);return n!==i?n-i:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(s){function l(e){for(var t=0,n=g.length,i=e[1],r=0;n>r;++r)for(var o,a=1,s=g[r],l=s.length,u=s[0];l>a;++a)o=s[a],u[1]<=i?o[1]>i&&re(u,o,e)>0&&++t:o[1]<=i&&re(u,o,e)<0&&--t,u=o;return 0!==t}function u(o,s,l,u){var c=0,h=0;if(null==o||(c=r(o,l))!==(h=r(s,l))||a(o,s)<0^l>0){do u.point(0===c||3===c?e:n,c>1?i:t);while((c=(c+l+4)%4)!==h)}else u.point(s[0],s[1])}function c(r,o){return r>=e&&n>=r&&o>=t&&i>=o}function h(e,t){c(e,t)&&s.point(e,t)}function d(){M.point=p,g&&g.push(m=[]),A=!0,S=!1,x=w=NaN}function f(){_&&(p(v,y),b&&S&&T.rejoin(),_.push(T.buffer())),M.point=h,S&&s.lineEnd()}function p(e,t){e=Math.max(-Us,Math.min(Us,e)),t=Math.max(-Us,Math.min(Us,t));var n=c(e,t);if(g&&m.push([e,t]),A)v=e,y=t,b=n,A=!1,n&&(s.lineStart(),s.point(e,t));else if(n&&S)s.point(e,t);else{var i={a:{x:x,y:w},b:{x:e,y:t}};E(i)?(S||(s.lineStart(),s.point(i.a.x,i.a.y)),s.point(i.b.x,i.b.y),n||s.lineEnd(),k=!1):n&&(s.lineStart(),s.point(e,t),k=!1)}x=e,w=t,S=n}var _,g,m,v,y,b,x,w,S,A,k,C=s,T=Ht(),E=Xt(e,t,n,i),M={point:h,lineStart:d,lineEnd:f,polygonStart:function(){s=T,_=[],g=[],k=!0},polygonEnd:function(){s=C,_=fa.merge(_);var t=l([e,i]),n=k&&t,r=_.length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),u(null,null,1,s),s.lineEnd()),r&&It(_,o,t,u,s),s.polygonEnd()),_=g=m=null}};return M}}function Yt(e){var t=0,n=ja/3,i=dn(e),r=i(t,n);return r.parallels=function(e){return arguments.length?i(t=e[0]*ja/180,n=e[1]*ja/180):[t/ja*180,n/ja*180]},r}function Zt(e,t){function n(e,t){var n=Math.sqrt(o-2*r*Math.sin(t))/r;return[n*Math.sin(e*=r),a-n*Math.cos(e)]}var i=Math.sin(e),r=(i+Math.sin(t))/2,o=1+i*(2*r-i),a=Math.sqrt(o)/r;return n.invert=function(e,t){var n=a-t;return[Math.atan2(e,n)/r,ae((o-(e*e+n*n)*r*r)/(2*r))]},n}function $t(){function e(e,t){Ws+=r*e-i*t,i=e,r=t}var t,n,i,r;$s.point=function(o,a){$s.point=e,t=i=o,n=r=a},$s.lineEnd=function(){e(t,n)}}function Jt(e,t){Xs>e&&(Xs=e),e>Ys&&(Ys=e),Ks>t&&(Ks=t),t>Zs&&(Zs=t)}function Qt(){function e(e,t){a.push("M",e,",",t,o)}function t(e,t){a.push("M",e,",",t),s.point=n}function n(e,t){a.push("L",e,",",t)}function i(){s.point=e}function r(){a.push("Z")}var o=en(4.5),a=[],s={point:e,lineStart:function(){s.point=t},lineEnd:i,polygonStart:function(){s.lineEnd=r},polygonEnd:function(){s.lineEnd=i,s.point=e},pointRadius:function(e){return o=en(e),s},result:function(){if(a.length){var e=a.join("");return a=[],e}}};return s}function en(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function tn(e,t){Ps+=e,Ds+=t,++Is}function nn(){function e(e,i){var r=e-t,o=i-n,a=Math.sqrt(r*r+o*o);Ns+=a*(t+e)/2,Fs+=a*(n+i)/2,Bs+=a,tn(t=e,n=i)}var t,n;Qs.point=function(i,r){Qs.point=e,tn(t=i,n=r)}}function rn(){Qs.point=tn}function on(){function e(e,t){var n=e-i,o=t-r,a=Math.sqrt(n*n+o*o);Ns+=a*(i+e)/2,Fs+=a*(r+t)/2,Bs+=a,a=r*e-i*t,zs+=a*(i+e),Hs+=a*(r+t),qs+=3*a,tn(i=e,r=t)}var t,n,i,r;Qs.point=function(o,a){Qs.point=e,tn(t=i=o,n=r=a)},Qs.lineEnd=function(){e(t,n)}}function an(e){function t(t,n){e.moveTo(t+a,n),e.arc(t,n,a,0,Ua)}function n(t,n){e.moveTo(t,n),s.point=i}function i(t,n){e.lineTo(t,n)}function r(){s.point=t}function o(){e.closePath()}var a=4.5,s={point:t,lineStart:function(){s.point=n},lineEnd:r,polygonStart:function(){s.lineEnd=o},polygonEnd:function(){s.lineEnd=r,s.point=t},pointRadius:function(e){return a=e,s},result:C};return s}function sn(e){function t(e){return(s?i:n)(e)}function n(t){return cn(t,function(n,i){n=e(n,i),t.point(n[0],n[1])})}function i(t){function n(n,i){n=e(n,i),t.point(n[0],n[1])}function i(){y=NaN,A.point=o,t.lineStart()}function o(n,i){var o=bt([n,i]),a=e(n,i);r(y,b,v,x,w,S,y=a[0],b=a[1],v=n,x=o[0],w=o[1],S=o[2],s,t),t.point(y,b)}function a(){A.point=n,t.lineEnd()}function l(){i(),A.point=u,A.lineEnd=c}function u(e,t){o(h=e,d=t),f=y,p=b,_=x,g=w,m=S,A.point=o}function c(){r(y,b,v,x,w,S,f,p,h,_,g,m,s,t),A.lineEnd=a,a()}var h,d,f,p,_,g,m,v,y,b,x,w,S,A={point:n,lineStart:i,lineEnd:a,polygonStart:function(){t.polygonStart(),A.lineStart=l},polygonEnd:function(){t.polygonEnd(),A.lineStart=i}};return A}function r(t,n,i,s,l,u,c,h,d,f,p,_,g,m){var v=c-t,y=h-n,b=v*v+y*y;if(b>4*o&&g--){var x=s+f,w=l+p,S=u+_,A=Math.sqrt(x*x+w*w+S*S),k=Math.asin(S/=A),C=ka(ka(S)-1)<qa||ka(i-d)<qa?(i+d)/2:Math.atan2(w,x),T=e(C,k),E=T[0],M=T[1],L=E-t,R=M-n,O=y*L-v*R;(O*O/b>o||ka((v*L+y*R)/b-.5)>.3||a>s*f+l*p+u*_)&&(r(t,n,i,s,l,u,E,M,C,x/=A,w/=A,S,g,m),m.point(E,M),r(E,M,C,x,w,S,c,h,d,f,p,_,g,m))}}var o=.5,a=Math.cos(30*Xa),s=16;return t.precision=function(e){return arguments.length?(s=(o=e*e)>0&&16,t):Math.sqrt(o)},t}function ln(e){var t=sn(function(t,n){return e([t*Ka,n*Ka])});return function(e){return fn(t(e))}}function un(e){this.stream=e}function cn(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function hn(e){return dn(function(){return e})()}function dn(e){function t(e){return e=s(e[0]*Xa,e[1]*Xa),[e[0]*d+l,u-e[1]*d]}function n(e){return e=s.invert((e[0]-l)/d,(u-e[1])/d),e&&[e[0]*Ka,e[1]*Ka]}function i(){s=Pt(a=gn(m,v,y),o);var e=o(_,g);return l=f-e[0]*d,u=p+e[1]*d,r()}function r(){return c&&(c.valid=!1,c=null),t}var o,a,s,l,u,c,h=sn(function(e,t){return e=o(e,t),[e[0]*d+l,u-e[1]*d]}),d=150,f=480,p=250,_=0,g=0,m=0,v=0,y=0,b=js,x=S,w=null,A=null;return t.stream=function(e){return c&&(c.valid=!1),c=fn(b(a,h(x(e)))),c.valid=!0,c},t.clipAngle=function(e){return arguments.length?(b=null==e?(w=e,js):Wt((w=+e)*Xa),r()):w},t.clipExtent=function(e){return arguments.length?(A=e,x=e?Kt(e[0][0],e[0][1],e[1][0],e[1][1]):S,r()):A},t.scale=function(e){return arguments.length?(d=+e,i()):d},t.translate=function(e){return arguments.length?(f=+e[0],p=+e[1],i()):[f,p]},t.center=function(e){return arguments.length?(_=e[0]%360*Xa,g=e[1]%360*Xa,i()):[_*Ka,g*Ka]},t.rotate=function(e){return arguments.length?(m=e[0]%360*Xa,v=e[1]%360*Xa,y=e.length>2?e[2]%360*Xa:0,i()):[m*Ka,v*Ka,y*Ka]},fa.rebind(t,h,"precision"),function(){return o=e.apply(this,arguments),t.invert=o.invert&&n,i()}}function fn(e){return cn(e,function(t,n){e.point(t*Xa,n*Xa)})}function pn(e,t){return[e,t]}function _n(e,t){return[e>ja?e-Ua:-ja>e?e+Ua:e,t]}function gn(e,t,n){return e?t||n?Pt(vn(e),yn(t,n)):vn(e):t||n?yn(t,n):_n}function mn(e){return function(t,n){return t+=e,[t>ja?t-Ua:-ja>t?t+Ua:t,n]}}function vn(e){var t=mn(e);return t.invert=mn(-e),t}function yn(e,t){function n(e,t){var n=Math.cos(t),s=Math.cos(e)*n,l=Math.sin(e)*n,u=Math.sin(t),c=u*i+s*r;return[Math.atan2(l*o-c*a,s*i-u*r),ae(c*o+l*a)]}var i=Math.cos(e),r=Math.sin(e),o=Math.cos(t),a=Math.sin(t);return n.invert=function(e,t){var n=Math.cos(t),s=Math.cos(e)*n,l=Math.sin(e)*n,u=Math.sin(t),c=u*o-l*a;return[Math.atan2(l*o+u*a,s*i+c*r),ae(c*i-s*r)]},n}function bn(e,t){var n=Math.cos(e),i=Math.sin(e);return function(r,o,a,s){var l=a*t;null!=r?(r=xn(n,r),o=xn(n,o),(a>0?o>r:r>o)&&(r+=a*Ua)):(r=e+a*Ua,o=e-.5*l);for(var u,c=r;a>0?c>o:o>c;c-=l)s.point((u=Ct([n,-i*Math.cos(c),-i*Math.sin(c)]))[0],u[1])}}function xn(e,t){var n=bt(t);n[0]-=e,kt(n);var i=oe(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-qa)%(2*Math.PI)}function wn(e,t,n){var i=fa.range(e,t-qa,n).concat(t);return function(e){return i.map(function(t){return[e,t]})}}function Sn(e,t,n){var i=fa.range(e,t-qa,n).concat(t);return function(e){return i.map(function(t){return[t,e]})}}function An(e){return e.source}function kn(e){return e.target}function Cn(e,t,n,i){var r=Math.cos(t),o=Math.sin(t),a=Math.cos(i),s=Math.sin(i),l=r*Math.cos(e),u=r*Math.sin(e),c=a*Math.cos(n),h=a*Math.sin(n),d=2*Math.asin(Math.sqrt(ce(i-t)+r*a*ce(n-e))),f=1/Math.sin(d),p=d?function(e){var t=Math.sin(e*=d)*f,n=Math.sin(d-e)*f,i=n*l+t*c,r=n*u+t*h,a=n*o+t*s;return[Math.atan2(r,i)*Ka,Math.atan2(a,Math.sqrt(i*i+r*r))*Ka]}:function(){return[e*Ka,t*Ka]};return p.distance=d,p}function Tn(){function e(e,r){var o=Math.sin(r*=Xa),a=Math.cos(r),s=ka((e*=Xa)-t),l=Math.cos(s);el+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=i*o-n*a*l)*s),n*o+i*a*l),t=e,n=o,i=a}var t,n,i;tl.point=function(r,o){t=r*Xa,n=Math.sin(o*=Xa),i=Math.cos(o),tl.point=e},tl.lineEnd=function(){tl.point=tl.lineEnd=C}}function En(e,t){function n(t,n){var i=Math.cos(t),r=Math.cos(n),o=e(i*r);return[o*r*Math.sin(t),o*Math.sin(n)]}return n.invert=function(e,n){var i=Math.sqrt(e*e+n*n),r=t(i),o=Math.sin(r),a=Math.cos(r);return[Math.atan2(e*o,i*a),Math.asin(i&&n*o/i)]},n}function Mn(e,t){function n(e,t){a>0?-Wa+qa>t&&(t=-Wa+qa):t>Wa-qa&&(t=Wa-qa);var n=a/Math.pow(r(t),o);return[n*Math.sin(o*e),a-n*Math.cos(o*e)]}var i=Math.cos(e),r=function(e){return Math.tan(ja/4+e/2)},o=e===t?Math.sin(e):Math.log(i/Math.cos(t))/Math.log(r(t)/r(e)),a=i*Math.pow(r(e),o)/o;return o?(n.invert=function(e,t){var n=a-t,i=ie(o)*Math.sqrt(e*e+n*n);return[Math.atan2(e,n)/o,2*Math.atan(Math.pow(a/i,1/o))-Wa]},n):Rn}function Ln(e,t){function n(e,t){var n=o-t;return[n*Math.sin(r*e),o-n*Math.cos(r*e)]}var i=Math.cos(e),r=e===t?Math.sin(e):(i-Math.cos(t))/(t-e),o=i/r+e;return ka(r)<qa?pn:(n.invert=function(e,t){var n=o-t;return[Math.atan2(e,n)/r,o-ie(r)*Math.sqrt(e*e+n*n)]},n)}function Rn(e,t){return[e,Math.log(Math.tan(ja/4+t/2))]}function On(e){var t,n=hn(e),i=n.scale,r=n.translate,o=n.clipExtent;return n.scale=function(){var e=i.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.translate=function(){var e=r.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.clipExtent=function(e){var a=o.apply(n,arguments);if(a===n){if(t=null==e){var s=ja*i(),l=r();o([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else t&&(a=null);return a},n.clipExtent(null)}function Pn(e,t){return[Math.log(Math.tan(ja/4+t/2)),-e]}function Dn(e){return e[0]}function In(e){return e[1]}function Nn(e){for(var t=e.length,n=[0,1],i=2,r=2;t>r;r++){for(;i>1&&re(e[n[i-2]],e[n[i-1]],e[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function Fn(e,t){return e[0]-t[0]||e[1]-t[1]}function Bn(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function zn(e,t,n,i){var r=e[0],o=n[0],a=t[0]-r,s=i[0]-o,l=e[1],u=n[1],c=t[1]-l,h=i[1]-u,d=(s*(l-u)-h*(r-o))/(h*a-s*c);return[r+d*a,l+d*c]}function Hn(e){var t=e[0],n=e[e.length-1];return!(t[0]-n[0]||t[1]-n[1])}function qn(){li(this),this.edge=this.site=this.circle=null}function Gn(e){var t=fl.pop()||new qn;return t.site=e,t}function jn(e){Qn(e),cl.remove(e),fl.push(e),li(e)}function Un(e){var t=e.circle,n=t.x,i=t.cy,r={x:n,y:i},o=e.P,a=e.N,s=[e];jn(e);for(var l=o;l.circle&&ka(n-l.circle.x)<qa&&ka(i-l.circle.cy)<qa;)o=l.P,s.unshift(l),jn(l),l=o;s.unshift(l),Qn(l);for(var u=a;u.circle&&ka(n-u.circle.x)<qa&&ka(i-u.circle.cy)<qa;)a=u.N,s.push(u),jn(u),u=a;s.push(u),Qn(u);var c,h=s.length;for(c=1;h>c;++c)u=s[c],l=s[c-1],oi(u.edge,l.site,u.site,r);l=s[0],u=s[h-1],u.edge=ii(l.site,u.site,null,r),Jn(l),Jn(u)}function Vn(e){for(var t,n,i,r,o=e.x,a=e.y,s=cl._;s;)if(i=Wn(s,a)-o,i>qa)s=s.L;else{if(r=o-Xn(s,a),!(r>qa)){i>-qa?(t=s.P,n=s):r>-qa?(t=s,n=s.N):t=n=s;break}if(!s.R){t=s;break}s=s.R}var l=Gn(e);if(cl.insert(t,l),t||n){if(t===n)return Qn(t),n=Gn(t.site),cl.insert(l,n),l.edge=n.edge=ii(t.site,l.site),Jn(t),void Jn(n);if(!n)return void(l.edge=ii(t.site,l.site));Qn(t),Qn(n);var u=t.site,c=u.x,h=u.y,d=e.x-c,f=e.y-h,p=n.site,_=p.x-c,g=p.y-h,m=2*(d*g-f*_),v=d*d+f*f,y=_*_+g*g,b={x:(g*v-f*y)/m+c,y:(d*y-_*v)/m+h};oi(n.edge,u,p,b),l.edge=ii(u,e,null,b),n.edge=ii(e,p,null,b),Jn(t),Jn(n)}}function Wn(e,t){var n=e.site,i=n.x,r=n.y,o=r-t;if(!o)return i;var a=e.P;if(!a)return-(1/0);n=a.site;var s=n.x,l=n.y,u=l-t;if(!u)return s;var c=s-i,h=1/o-1/u,d=c/u;return h?(-d+Math.sqrt(d*d-2*h*(c*c/(-2*u)-l+u/2+r-o/2)))/h+i:(i+s)/2}function Xn(e,t){var n=e.N;if(n)return Wn(n,t);var i=e.site;return i.y===t?i.x:1/0}function Kn(e){this.site=e,this.edges=[]}function Yn(e){for(var t,n,i,r,o,a,s,l,u,c,h=e[0][0],d=e[1][0],f=e[0][1],p=e[1][1],_=ul,g=_.length;g--;)if(o=_[g],o&&o.prepare())for(s=o.edges,l=s.length,a=0;l>a;)c=s[a].end(),i=c.x,r=c.y,u=s[++a%l].start(),t=u.x,n=u.y,(ka(i-t)>qa||ka(r-n)>qa)&&(s.splice(a,0,new ai(ri(o.site,c,ka(i-h)<qa&&p-r>qa?{x:h,y:ka(t-h)<qa?n:p}:ka(r-p)<qa&&d-i>qa?{x:ka(n-p)<qa?t:d,y:p}:ka(i-d)<qa&&r-f>qa?{x:d,y:ka(t-d)<qa?n:f}:ka(r-f)<qa&&i-h>qa?{x:ka(n-f)<qa?t:h,y:f}:null),o.site,null)),++l)}function Zn(e,t){return t.angle-e.angle}function $n(){li(this),this.x=this.y=this.arc=this.site=this.cy=null}function Jn(e){var t=e.P,n=e.N;if(t&&n){var i=t.site,r=e.site,o=n.site;if(i!==o){var a=r.x,s=r.y,l=i.x-a,u=i.y-s,c=o.x-a,h=o.y-s,d=2*(l*h-u*c);if(!(d>=-Ga)){var f=l*l+u*u,p=c*c+h*h,_=(h*f-u*p)/d,g=(l*p-c*f)/d,h=g+s,m=pl.pop()||new $n;m.arc=e,m.site=r,m.x=_+a,m.y=h+Math.sqrt(_*_+g*g),m.cy=h,e.circle=m;for(var v=null,y=dl._;y;)if(m.y<y.y||m.y===y.y&&m.x<=y.x){if(!y.L){v=y.P;break}y=y.L}else{if(!y.R){v=y;break}y=y.R}dl.insert(v,m),v||(hl=m)}}}}function Qn(e){var t=e.circle;t&&(t.P||(hl=t.N),dl.remove(t),pl.push(t),li(t),e.circle=null)}function ei(e){for(var t,n=ll,i=Xt(e[0][0],e[0][1],e[1][0],e[1][1]),r=n.length;r--;)t=n[r],(!ti(t,e)||!i(t)||ka(t.a.x-t.b.x)<qa&&ka(t.a.y-t.b.y)<qa)&&(t.a=t.b=null,n.splice(r,1))}function ti(e,t){var n=e.b;if(n)return!0;var i,r,o=e.a,a=t[0][0],s=t[1][0],l=t[0][1],u=t[1][1],c=e.l,h=e.r,d=c.x,f=c.y,p=h.x,_=h.y,g=(d+p)/2,m=(f+_)/2;if(_===f){if(a>g||g>=s)return;if(d>p){if(o){if(o.y>=u)return}else o={x:g,y:l};n={x:g,y:u}}else{if(o){if(o.y<l)return}else o={x:g,y:u};n={x:g,y:l}}}else if(i=(d-p)/(_-f),r=m-i*g,-1>i||i>1)if(d>p){if(o){if(o.y>=u)return}else o={x:(l-r)/i,y:l};n={x:(u-r)/i,y:u}}else{if(o){if(o.y<l)return}else o={x:(u-r)/i,y:u};n={x:(l-r)/i,y:l}}else if(_>f){if(o){if(o.x>=s)return}else o={x:a,y:i*a+r};n={x:s,y:i*s+r}}else{if(o){if(o.x<a)return}else o={x:s,y:i*s+r};n={x:a,y:i*a+r}}return e.a=o,e.b=n,!0}function ni(e,t){this.l=e,this.r=t,this.a=this.b=null}function ii(e,t,n,i){var r=new ni(e,t);return ll.push(r),n&&oi(r,e,t,n),i&&oi(r,t,e,i),ul[e.i].edges.push(new ai(r,e,t)),ul[t.i].edges.push(new ai(r,t,e)),r}function ri(e,t,n){var i=new ni(e,null);return i.a=t,i.b=n,ll.push(i),i}function oi(e,t,n,i){e.a||e.b?e.l===n?e.b=i:e.a=i:(e.a=i,e.l=t,e.r=n)}function ai(e,t,n){var i=e.a,r=e.b;this.edge=e,this.site=t,this.angle=n?Math.atan2(n.y-t.y,n.x-t.x):e.l===t?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function si(){this._=null}function li(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function ui(e,t){var n=t,i=t.R,r=n.U;r?r.L===n?r.L=i:r.R=i:e._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function ci(e,t){var n=t,i=t.L,r=n.U;r?r.L===n?r.L=i:r.R=i:e._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function hi(e){for(;e.L;)e=e.L;return e}function di(e,t){var n,i,r,o=e.sort(fi).pop();for(ll=[],ul=new Array(e.length),cl=new si,dl=new si;;)if(r=hl,o&&(!r||o.y<r.y||o.y===r.y&&o.x<r.x))(o.x!==n||o.y!==i)&&(ul[o.i]=new Kn(o),Vn(o),n=o.x,i=o.y),o=e.pop();else{if(!r)break;Un(r.arc)}t&&(ei(t),Yn(t));var a={cells:ul,edges:ll};return cl=dl=ll=ul=null,a}function fi(e,t){return t.y-e.y||t.x-e.x}function pi(e,t,n){return(e.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-e.y)}function _i(e){return e.x}function gi(e){return e.y}function mi(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function vi(e,t,n,i,r,o){if(!e(t,n,i,r,o)){var a=.5*(n+r),s=.5*(i+o),l=t.nodes;l[0]&&vi(e,l[0],n,i,a,s),l[1]&&vi(e,l[1],a,i,r,s),l[2]&&vi(e,l[2],n,s,a,o),l[3]&&vi(e,l[3],a,s,r,o)}}function yi(e,t,n,i,r,o,a){var s,l=1/0;return function u(e,c,h,d,f){if(!(c>o||h>a||i>d||r>f)){if(p=e.point){var p,_=t-e.x,g=n-e.y,m=_*_+g*g;if(l>m){var v=Math.sqrt(l=m);i=t-v,r=n-v,o=t+v,a=n+v,s=p}}for(var y=e.nodes,b=.5*(c+d),x=.5*(h+f),w=t>=b,S=n>=x,A=S<<1|w,k=A+4;k>A;++A)if(e=y[3&A])switch(3&A){case 0:u(e,c,h,b,x);break;case 1:u(e,b,h,d,x);break;case 2:u(e,c,x,b,f);break;case 3:u(e,b,x,d,f)}}}(e,i,r,o,a),s}function bi(e,t){e=fa.rgb(e),t=fa.rgb(t);var n=e.r,i=e.g,r=e.b,o=t.r-n,a=t.g-i,s=t.b-r;return function(e){return"#"+ke(Math.round(n+o*e))+ke(Math.round(i+a*e))+ke(Math.round(r+s*e))}}function xi(e,t){var n,i={},r={};for(n in e)n in t?i[n]=Ai(e[n],t[n]):r[n]=e[n];for(n in t)n in e||(r[n]=t[n]);return function(e){for(n in i)r[n]=i[n](e);return r}}function wi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Si(e,t){var n,i,r,o=gl.lastIndex=ml.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=gl.exec(e))&&(i=ml.exec(t));)(r=i.index)>o&&(r=t.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:wi(n,i)})),o=ml.lastIndex;return o<t.length&&(r=t.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?(t=l[0].x,function(e){return t(e)+""}):function(){return t}:(t=l.length,function(e){for(var n,i=0;t>i;++i)s[(n=l[i]).i]=n.x(e);return s.join("")})}function Ai(e,t){for(var n,i=fa.interpolators.length;--i>=0&&!(n=fa.interpolators[i](e,t)););return n}function ki(e,t){var n,i=[],r=[],o=e.length,a=t.length,s=Math.min(e.length,t.length);for(n=0;s>n;++n)i.push(Ai(e[n],t[n]));for(;o>n;++n)r[n]=e[n];for(;a>n;++n)r[n]=t[n];return function(e){for(n=0;s>n;++n)r[n]=i[n](e);return r}}function Ci(e){return function(t){return 0>=t?0:t>=1?1:e(t)}}function Ti(e){return function(t){return 1-e(1-t)}}function Ei(e){return function(t){return.5*(.5>t?e(2*t):2-e(2-2*t))}}function Mi(e){return e*e}function Li(e){return e*e*e}function Ri(e){if(0>=e)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(.5>e?n:3*(e-t)+n-.75)}function Oi(e){return function(t){return Math.pow(t,e)}}function Pi(e){return 1-Math.cos(e*Wa)}function Di(e){return Math.pow(2,10*(e-1))}function Ii(e){return 1-Math.sqrt(1-e*e)}function Ni(e,t){var n;return arguments.length<2&&(t=.45),arguments.length?n=t/Ua*Math.asin(1/e):(e=1,n=t/4),function(i){return 1+e*Math.pow(2,-10*i)*Math.sin((i-n)*Ua/t)}}function Fi(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function Bi(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function zi(e,t){e=fa.hcl(e),t=fa.hcl(t);var n=e.h,i=e.c,r=e.l,o=t.h-n,a=t.c-i,s=t.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?t.c:i),isNaN(o)?(o=0,n=isNaN(n)?t.h:n):o>180?o-=360:-180>o&&(o+=360),function(e){return _e(n+o*e,i+a*e,r+s*e)+""}}function Hi(e,t){e=fa.hsl(e),t=fa.hsl(t);var n=e.h,i=e.s,r=e.l,o=t.h-n,a=t.s-i,s=t.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?t.s:i),isNaN(o)?(o=0,n=isNaN(n)?t.h:n):o>180?o-=360:-180>o&&(o+=360),function(e){return fe(n+o*e,i+a*e,r+s*e)+""}}function qi(e,t){e=fa.lab(e),t=fa.lab(t);var n=e.l,i=e.a,r=e.b,o=t.l-n,a=t.a-i,s=t.b-r;
return function(e){return me(n+o*e,i+a*e,r+s*e)+""}}function Gi(e,t){return t-=e,function(n){return Math.round(e+t*n)}}function ji(e){var t=[e.a,e.b],n=[e.c,e.d],i=Vi(t),r=Ui(t,n),o=Vi(Wi(n,t,-r))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*Ka,this.translate=[e.e,e.f],this.scale=[i,o],this.skew=o?Math.atan2(r,o)*Ka:0}function Ui(e,t){return e[0]*t[0]+e[1]*t[1]}function Vi(e){var t=Math.sqrt(Ui(e,e));return t&&(e[0]/=t,e[1]/=t),t}function Wi(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function Xi(e){return e.length?e.pop()+",":""}function Ki(e,t,n,i){if(e[0]!==t[0]||e[1]!==t[1]){var r=n.push("translate(",null,",",null,")");i.push({i:r-4,x:wi(e[0],t[0])},{i:r-2,x:wi(e[1],t[1])})}else(t[0]||t[1])&&n.push("translate("+t+")")}function Yi(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(Xi(n)+"rotate(",null,")")-2,x:wi(e,t)})):t&&n.push(Xi(n)+"rotate("+t+")")}function Zi(e,t,n,i){e!==t?i.push({i:n.push(Xi(n)+"skewX(",null,")")-2,x:wi(e,t)}):t&&n.push(Xi(n)+"skewX("+t+")")}function $i(e,t,n,i){if(e[0]!==t[0]||e[1]!==t[1]){var r=n.push(Xi(n)+"scale(",null,",",null,")");i.push({i:r-4,x:wi(e[0],t[0])},{i:r-2,x:wi(e[1],t[1])})}else(1!==t[0]||1!==t[1])&&n.push(Xi(n)+"scale("+t+")")}function Ji(e,t){var n=[],i=[];return e=fa.transform(e),t=fa.transform(t),Ki(e.translate,t.translate,n,i),Yi(e.rotate,t.rotate,n,i),Zi(e.skew,t.skew,n,i),$i(e.scale,t.scale,n,i),e=t=null,function(e){for(var t,r=-1,o=i.length;++r<o;)n[(t=i[r]).i]=t.x(e);return n.join("")}}function Qi(e,t){return t=(t-=e=+e)||1/t,function(n){return(n-e)/t}}function er(e,t){return t=(t-=e=+e)||1/t,function(n){return Math.max(0,Math.min(1,(n-e)/t))}}function tr(e){for(var t=e.source,n=e.target,i=ir(t,n),r=[t];t!==i;)t=t.parent,r.push(t);for(var o=r.length;n!==i;)r.splice(o,0,n),n=n.parent;return r}function nr(e){for(var t=[],n=e.parent;null!=n;)t.push(e),e=n,n=n.parent;return t.push(e),t}function ir(e,t){if(e===t)return e;for(var n=nr(e),i=nr(t),r=n.pop(),o=i.pop(),a=null;r===o;)a=r,r=n.pop(),o=i.pop();return a}function rr(e){e.fixed|=2}function or(e){e.fixed&=-7}function ar(e){e.fixed|=4,e.px=e.x,e.py=e.y}function sr(e){e.fixed&=-5}function lr(e,t,n){var i=0,r=0;if(e.charge=0,!e.leaf)for(var o,a=e.nodes,s=a.length,l=-1;++l<s;)o=a[l],null!=o&&(lr(o,t,n),e.charge+=o.charge,i+=o.charge*o.cx,r+=o.charge*o.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var u=t*n[e.point.index];e.charge+=e.pointCharge=u,i+=u*e.point.x,r+=u*e.point.y}e.cx=i/e.charge,e.cy=r/e.charge}function ur(e,t){return fa.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=_r,e}function cr(e,t){for(var n=[e];null!=(e=n.pop());)if(t(e),(r=e.children)&&(i=r.length))for(var i,r;--i>=0;)n.push(r[i])}function hr(e,t){for(var n=[e],i=[];null!=(e=n.pop());)if(i.push(e),(o=e.children)&&(r=o.length))for(var r,o,a=-1;++a<r;)n.push(o[a]);for(;null!=(e=i.pop());)t(e)}function dr(e){return e.children}function fr(e){return e.value}function pr(e,t){return t.value-e.value}function _r(e){return fa.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function gr(e){return e.x}function mr(e){return e.y}function vr(e,t,n){e.y0=t,e.y=n}function yr(e){return fa.range(e.length)}function br(e){for(var t=-1,n=e[0].length,i=[];++t<n;)i[t]=0;return i}function xr(e){for(var t,n=1,i=0,r=e[0][1],o=e.length;o>n;++n)(t=e[n][1])>r&&(i=n,r=t);return i}function wr(e){return e.reduce(Sr,0)}function Sr(e,t){return e+t[1]}function Ar(e,t){return kr(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function kr(e,t){for(var n=-1,i=+e[0],r=(e[1]-i)/t,o=[];++n<=t;)o[n]=r*n+i;return o}function Cr(e){return[fa.min(e),fa.max(e)]}function Tr(e,t){return e.value-t.value}function Er(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function Mr(e,t){e._pack_next=t,t._pack_prev=e}function Lr(e,t){var n=t.x-e.x,i=t.y-e.y,r=e.r+t.r;return.999*r*r>n*n+i*i}function Rr(e){function t(e){c=Math.min(e.x-e.r,c),h=Math.max(e.x+e.r,h),d=Math.min(e.y-e.r,d),f=Math.max(e.y+e.r,f)}if((n=e.children)&&(u=n.length)){var n,i,r,o,a,s,l,u,c=1/0,h=-(1/0),d=1/0,f=-(1/0);if(n.forEach(Or),i=n[0],i.x=-i.r,i.y=0,t(i),u>1&&(r=n[1],r.x=r.r,r.y=0,t(r),u>2))for(o=n[2],Ir(i,r,o),t(o),Er(i,o),i._pack_prev=o,Er(o,r),r=i._pack_next,a=3;u>a;a++){Ir(i,r,o=n[a]);var p=0,_=1,g=1;for(s=r._pack_next;s!==r;s=s._pack_next,_++)if(Lr(s,o)){p=1;break}if(1==p)for(l=i._pack_prev;l!==s._pack_prev&&!Lr(l,o);l=l._pack_prev,g++);p?(g>_||_==g&&r.r<i.r?Mr(i,r=s):Mr(i=l,r),a--):(Er(i,o),r=o,t(o))}var m=(c+h)/2,v=(d+f)/2,y=0;for(a=0;u>a;a++)o=n[a],o.x-=m,o.y-=v,y=Math.max(y,o.r+Math.sqrt(o.x*o.x+o.y*o.y));e.r=y,n.forEach(Pr)}}function Or(e){e._pack_next=e._pack_prev=e}function Pr(e){delete e._pack_next,delete e._pack_prev}function Dr(e,t,n,i){var r=e.children;if(e.x=t+=i*e.x,e.y=n+=i*e.y,e.r*=i,r)for(var o=-1,a=r.length;++o<a;)Dr(r[o],t,n,i)}function Ir(e,t,n){var i=e.r+n.r,r=t.x-e.x,o=t.y-e.y;if(i&&(r||o)){var a=t.r+n.r,s=r*r+o*o;a*=a,i*=i;var l=.5+(i-a)/(2*s),u=Math.sqrt(Math.max(0,2*a*(i+s)-(i-=s)*i-a*a))/(2*s);n.x=e.x+l*r+u*o,n.y=e.y+l*o-u*r}else n.x=e.x+i,n.y=e.y}function Nr(e,t){return e.parent==t.parent?1:2}function Fr(e){var t=e.children;return t.length?t[0]:e.t}function Br(e){var t,n=e.children;return(t=n.length)?n[t-1]:e.t}function zr(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Hr(e){for(var t,n=0,i=0,r=e.children,o=r.length;--o>=0;)t=r[o],t.z+=n,t.m+=n,n+=t.s+(i+=t.c)}function qr(e,t,n){return e.a.parent===t.parent?e.a:n}function Gr(e){return 1+fa.max(e,function(e){return e.y})}function jr(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Ur(e){var t=e.children;return t&&t.length?Ur(t[0]):e}function Vr(e){var t,n=e.children;return n&&(t=n.length)?Vr(n[t-1]):e}function Wr(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Xr(e,t){var n=e.x+t[3],i=e.y+t[0],r=e.dx-t[1]-t[3],o=e.dy-t[0]-t[2];return 0>r&&(n+=r/2,r=0),0>o&&(i+=o/2,o=0),{x:n,y:i,dx:r,dy:o}}function Kr(e){var t=e[0],n=e[e.length-1];return n>t?[t,n]:[n,t]}function Yr(e){return e.rangeExtent?e.rangeExtent():Kr(e.range())}function Zr(e,t,n,i){var r=n(e[0],e[1]),o=i(t[0],t[1]);return function(e){return o(r(e))}}function $r(e,t){var n,i=0,r=e.length-1,o=e[i],a=e[r];return o>a&&(n=i,i=r,r=n,n=o,o=a,a=n),e[i]=t.floor(o),e[r]=t.ceil(a),e}function Jr(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:El}function Qr(e,t,n,i){var r=[],o=[],a=0,s=Math.min(e.length,t.length)-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<=s;)r.push(n(e[a-1],e[a])),o.push(i(t[a-1],t[a]));return function(t){var n=fa.bisect(e,t,1,s)-1;return o[n](r[n](t))}}function eo(e,t,n,i){function r(){var r=Math.min(e.length,t.length)>2?Qr:Zr,l=i?er:Qi;return a=r(e,t,l,n),s=r(t,e,l,Ai),o}function o(e){return a(e)}var a,s;return o.invert=function(e){return s(e)},o.domain=function(t){return arguments.length?(e=t.map(Number),r()):e},o.range=function(e){return arguments.length?(t=e,r()):t},o.rangeRound=function(e){return o.range(e).interpolate(Gi)},o.clamp=function(e){return arguments.length?(i=e,r()):i},o.interpolate=function(e){return arguments.length?(n=e,r()):n},o.ticks=function(t){return ro(e,t)},o.tickFormat=function(t,n){return oo(e,t,n)},o.nice=function(t){return no(e,t),r()},o.copy=function(){return eo(e,t,n,i)},r()}function to(e,t){return fa.rebind(e,t,"range","rangeRound","interpolate","clamp")}function no(e,t){return $r(e,Jr(io(e,t)[2])),$r(e,Jr(io(e,t)[2])),e}function io(e,t){null==t&&(t=10);var n=Kr(e),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/t)/Math.LN10)),o=t/i*r;return.15>=o?r*=10:.35>=o?r*=5:.75>=o&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function ro(e,t){return fa.range.apply(fa,io(e,t))}function oo(e,t,n){var i=io(e,t);if(n){var r=gs.exec(n);if(r.shift(),"s"===r[8]){var o=fa.formatPrefix(Math.max(ka(i[0]),ka(i[1])));return r[7]||(r[7]="."+ao(o.scale(i[2]))),r[8]="f",n=fa.format(r.join("")),function(e){return n(o.scale(e))+o.symbol}}r[7]||(r[7]="."+so(r[8],i)),n=r.join("")}else n=",."+ao(i[2])+"f";return fa.format(n)}function ao(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function so(e,t){var n=ao(t[2]);return e in Ml?Math.abs(n-ao(Math.max(ka(t[0]),ka(t[1]))))+ +("e"!==e):n-2*("%"===e)}function lo(e,t,n,i){function r(e){return(n?Math.log(0>e?0:e):-Math.log(e>0?0:-e))/Math.log(t)}function o(e){return n?Math.pow(t,e):-Math.pow(t,-e)}function a(t){return e(r(t))}return a.invert=function(t){return o(e.invert(t))},a.domain=function(t){return arguments.length?(n=t[0]>=0,e.domain((i=t.map(Number)).map(r)),a):i},a.base=function(n){return arguments.length?(t=+n,e.domain(i.map(r)),a):t},a.nice=function(){var t=$r(i.map(r),n?Math:Rl);return e.domain(t),i=t.map(o),a},a.ticks=function(){var e=Kr(i),a=[],s=e[0],l=e[1],u=Math.floor(r(s)),c=Math.ceil(r(l)),h=t%1?2:t;if(isFinite(c-u)){if(n){for(;c>u;u++)for(var d=1;h>d;d++)a.push(o(u)*d);a.push(o(u))}else for(a.push(o(u));u++<c;)for(var d=h-1;d>0;d--)a.push(o(u)*d);for(u=0;a[u]<s;u++);for(c=a.length;a[c-1]>l;c--);a=a.slice(u,c)}return a},a.tickFormat=function(e,n){if(!arguments.length)return Ll;arguments.length<2?n=Ll:"function"!=typeof n&&(n=fa.format(n));var i=Math.max(1,t*e/a.ticks().length);return function(e){var a=e/o(Math.round(r(e)));return t-.5>a*t&&(a*=t),i>=a?n(e):""}},a.copy=function(){return lo(e.copy(),t,n,i)},to(a,e)}function uo(e,t,n){function i(t){return e(r(t))}var r=co(t),o=co(1/t);return i.invert=function(t){return o(e.invert(t))},i.domain=function(t){return arguments.length?(e.domain((n=t.map(Number)).map(r)),i):n},i.ticks=function(e){return ro(n,e)},i.tickFormat=function(e,t){return oo(n,e,t)},i.nice=function(e){return i.domain(no(n,e))},i.exponent=function(a){return arguments.length?(r=co(t=a),o=co(1/t),e.domain(n.map(r)),i):t},i.copy=function(){return uo(e.copy(),t,n)},to(i,e)}function co(e){return function(t){return 0>t?-Math.pow(-t,e):Math.pow(t,e)}}function ho(e,t){function n(n){return o[((r.get(n)||("range"===t.t?r.set(n,e.push(n)):NaN))-1)%o.length]}function i(t,n){return fa.range(e.length).map(function(e){return t+n*e})}var r,o,a;return n.domain=function(i){if(!arguments.length)return e;e=[],r=new p;for(var o,a=-1,s=i.length;++a<s;)r.has(o=i[a])||r.set(o,e.push(o));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(o=e,a=0,t={t:"range",a:arguments},n):o},n.rangePoints=function(r,s){arguments.length<2&&(s=0);var l=r[0],u=r[1],c=e.length<2?(l=(l+u)/2,0):(u-l)/(e.length-1+s);return o=i(l+c*s/2,c),a=0,t={t:"rangePoints",a:arguments},n},n.rangeRoundPoints=function(r,s){arguments.length<2&&(s=0);var l=r[0],u=r[1],c=e.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(e.length-1+s)|0;return o=i(l+Math.round(c*s/2+(u-l-(e.length-1+s)*c)/2),c),a=0,t={t:"rangeRoundPoints",a:arguments},n},n.rangeBands=function(r,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=r[1]<r[0],c=r[u-0],h=r[1-u],d=(h-c)/(e.length-s+2*l);return o=i(c+d*l,d),u&&o.reverse(),a=d*(1-s),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=r[1]<r[0],c=r[u-0],h=r[1-u],d=Math.floor((h-c)/(e.length-s+2*l));return o=i(c+Math.round((h-c-(e.length-s)*d)/2),d),u&&o.reverse(),a=Math.round(d*(1-s)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return a},n.rangeExtent=function(){return Kr(t.a[0])},n.copy=function(){return ho(e,t)},n.domain(e)}function fo(e,t){function n(){var n=0,o=t.length;for(r=[];++n<o;)r[n-1]=fa.quantile(e,n/o);return i}function i(e){return isNaN(e=+e)?void 0:t[fa.bisect(r,e)]}var r;return i.domain=function(t){return arguments.length?(e=t.map(l).filter(u).sort(s),n()):e},i.range=function(e){return arguments.length?(t=e,n()):t},i.quantiles=function(){return r},i.invertExtent=function(n){return n=t.indexOf(n),0>n?[NaN,NaN]:[n>0?r[n-1]:e[0],n<r.length?r[n]:e[e.length-1]]},i.copy=function(){return fo(e,t)},n()}function po(e,t,n){function i(t){return n[Math.max(0,Math.min(a,Math.floor(o*(t-e))))]}function r(){return o=n.length/(t-e),a=n.length-1,i}var o,a;return i.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],r()):[e,t]},i.range=function(e){return arguments.length?(n=e,r()):n},i.invertExtent=function(t){return t=n.indexOf(t),t=0>t?NaN:t/o+e,[t,t+1/o]},i.copy=function(){return po(e,t,n)},r()}function _o(e,t){function n(n){return n>=n?t[fa.bisect(e,n)]:void 0}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.invertExtent=function(n){return n=t.indexOf(n),[e[n-1],e[n]]},n.copy=function(){return _o(e,t)},n}function go(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return ro(e,t)},t.tickFormat=function(t,n){return oo(e,t,n)},t.copy=function(){return go(e)},t}function mo(){return 0}function vo(e){return e.innerRadius}function yo(e){return e.outerRadius}function bo(e){return e.startAngle}function xo(e){return e.endAngle}function wo(e){return e&&e.padAngle}function So(e,t,n,i){return(e-n)*t-(t-i)*e>0?0:1}function Ao(e,t,n,i,r){var o=e[0]-t[0],a=e[1]-t[1],s=(r?i:-i)/Math.sqrt(o*o+a*a),l=s*a,u=-s*o,c=e[0]+l,h=e[1]+u,d=t[0]+l,f=t[1]+u,p=(c+d)/2,_=(h+f)/2,g=d-c,m=f-h,v=g*g+m*m,y=n-i,b=c*f-d*h,x=(0>m?-1:1)*Math.sqrt(Math.max(0,y*y*v-b*b)),w=(b*m-g*x)/v,S=(-b*g-m*x)/v,A=(b*m+g*x)/v,k=(-b*g+m*x)/v,C=w-p,T=S-_,E=A-p,M=k-_;return C*C+T*T>E*E+M*M&&(w=A,S=k),[[w-l,S-u],[w*n/y,S*n/y]]}function ko(e){function t(t){function a(){u.push("M",o(e(c),s))}for(var l,u=[],c=[],h=-1,d=t.length,f=Re(n),p=Re(i);++h<d;)r.call(this,l=t[h],h)?c.push([+f.call(this,l,h),+p.call(this,l,h)]):c.length&&(a(),c=[]);return c.length&&a(),u.length?u.join(""):null}var n=Dn,i=In,r=Dt,o=Co,a=o.key,s=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(i=e,t):i},t.defined=function(e){return arguments.length?(r=e,t):r},t.interpolate=function(e){return arguments.length?(a="function"==typeof e?o=e:(o=Fl.get(e)||Co).key,t):a},t.tension=function(e){return arguments.length?(s=e,t):s},t}function Co(e){return e.length>1?e.join("L"):e+"Z"}function To(e){return e.join("L")+"Z"}function Eo(e){for(var t=0,n=e.length,i=e[0],r=[i[0],",",i[1]];++t<n;)r.push("H",(i[0]+(i=e[t])[0])/2,"V",i[1]);return n>1&&r.push("H",i[0]),r.join("")}function Mo(e){for(var t=0,n=e.length,i=e[0],r=[i[0],",",i[1]];++t<n;)r.push("V",(i=e[t])[1],"H",i[0]);return r.join("")}function Lo(e){for(var t=0,n=e.length,i=e[0],r=[i[0],",",i[1]];++t<n;)r.push("H",(i=e[t])[0],"V",i[1]);return r.join("")}function Ro(e,t){return e.length<4?Co(e):e[1]+Do(e.slice(1,-1),Io(e,t))}function Oo(e,t){return e.length<3?To(e):e[0]+Do((e.push(e[0]),e),Io([e[e.length-2]].concat(e,[e[1]]),t))}function Po(e,t){return e.length<3?Co(e):e[0]+Do(e,Io(e,t))}function Do(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return Co(e);var n=e.length!=t.length,i="",r=e[0],o=e[1],a=t[0],s=a,l=1;if(n&&(i+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],r=e[1],l=2),t.length>1){s=t[1],o=e[l],l++,i+="C"+(r[0]+a[0])+","+(r[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var u=2;u<t.length;u++,l++)o=e[l],s=t[u],i+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(n){var c=e[l];i+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return i}function Io(e,t){for(var n,i=[],r=(1-t)/2,o=e[0],a=e[1],s=1,l=e.length;++s<l;)n=o,o=a,a=e[s],i.push([r*(a[0]-n[0]),r*(a[1]-n[1])]);return i}function No(e){if(e.length<3)return Co(e);var t=1,n=e.length,i=e[0],r=i[0],o=i[1],a=[r,r,r,(i=e[1])[0]],s=[o,o,o,i[1]],l=[r,",",o,"L",Ho(Hl,a),",",Ho(Hl,s)];for(e.push(e[n-1]);++t<=n;)i=e[t],a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),qo(l,a,s);return e.pop(),l.push("L",i),l.join("")}function Fo(e){if(e.length<4)return Co(e);for(var t,n=[],i=-1,r=e.length,o=[0],a=[0];++i<3;)t=e[i],o.push(t[0]),a.push(t[1]);for(n.push(Ho(Hl,o)+","+Ho(Hl,a)),--i;++i<r;)t=e[i],o.shift(),o.push(t[0]),a.shift(),a.push(t[1]),qo(n,o,a);return n.join("")}function Bo(e){for(var t,n,i=-1,r=e.length,o=r+4,a=[],s=[];++i<4;)n=e[i%r],a.push(n[0]),s.push(n[1]);for(t=[Ho(Hl,a),",",Ho(Hl,s)],--i;++i<o;)n=e[i%r],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),qo(t,a,s);return t.join("")}function zo(e,t){var n=e.length-1;if(n)for(var i,r,o=e[0][0],a=e[0][1],s=e[n][0]-o,l=e[n][1]-a,u=-1;++u<=n;)i=e[u],r=u/n,i[0]=t*i[0]+(1-t)*(o+r*s),i[1]=t*i[1]+(1-t)*(a+r*l);return No(e)}function Ho(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function qo(e,t,n){e.push("C",Ho(Bl,t),",",Ho(Bl,n),",",Ho(zl,t),",",Ho(zl,n),",",Ho(Hl,t),",",Ho(Hl,n))}function Go(e,t){return(t[1]-e[1])/(t[0]-e[0])}function jo(e){for(var t=0,n=e.length-1,i=[],r=e[0],o=e[1],a=i[0]=Go(r,o);++t<n;)i[t]=(a+(a=Go(r=o,o=e[t+1])))/2;return i[t]=a,i}function Uo(e){for(var t,n,i,r,o=[],a=jo(e),s=-1,l=e.length-1;++s<l;)t=Go(e[s],e[s+1]),ka(t)<qa?a[s]=a[s+1]=0:(n=a[s]/t,i=a[s+1]/t,r=n*n+i*i,r>9&&(r=3*t/Math.sqrt(r),a[s]=r*n,a[s+1]=r*i));for(s=-1;++s<=l;)r=(e[Math.min(l,s+1)][0]-e[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([r||0,a[s]*r||0]);return o}function Vo(e){return e.length<3?Co(e):e[0]+Do(e,Uo(e))}function Wo(e){for(var t,n,i,r=-1,o=e.length;++r<o;)t=e[r],n=t[0],i=t[1]-Wa,t[0]=n*Math.cos(i),t[1]=n*Math.sin(i);return e}function Xo(e){function t(t){function l(){_.push("M",s(e(m),h),c,u(e(g.reverse()),h),"Z")}for(var d,f,p,_=[],g=[],m=[],v=-1,y=t.length,b=Re(n),x=Re(r),w=n===i?function(){return f}:Re(i),S=r===o?function(){return p}:Re(o);++v<y;)a.call(this,d=t[v],v)?(g.push([f=+b.call(this,d,v),p=+x.call(this,d,v)]),m.push([+w.call(this,d,v),+S.call(this,d,v)])):g.length&&(l(),g=[],m=[]);return g.length&&l(),_.length?_.join(""):null}var n=Dn,i=Dn,r=0,o=In,a=Dt,s=Co,l=s.key,u=s,c="L",h=.7;return t.x=function(e){return arguments.length?(n=i=e,t):i},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(i=e,t):i},t.y=function(e){return arguments.length?(r=o=e,t):o},t.y0=function(e){return arguments.length?(r=e,t):r},t.y1=function(e){return arguments.length?(o=e,t):o},t.defined=function(e){return arguments.length?(a=e,t):a},t.interpolate=function(e){return arguments.length?(l="function"==typeof e?s=e:(s=Fl.get(e)||Co).key,u=s.reverse||s,c=s.closed?"M":"L",t):l},t.tension=function(e){return arguments.length?(h=e,t):h},t}function Ko(e){return e.radius}function Yo(e){return[e.x,e.y]}function Zo(e){return function(){var t=e.apply(this,arguments),n=t[0],i=t[1]-Wa;return[n*Math.cos(i),n*Math.sin(i)]}}function $o(){return 64}function Jo(){return"circle"}function Qo(e){var t=Math.sqrt(e/ja);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function ea(e){return function(){var t,n,i;(t=this[e])&&(i=t[n=t.active])&&(i.timer.c=null,i.timer.t=NaN,--t.count?delete t[n]:delete this[e],t.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function ta(e,t,n){return La(e,Xl),e.namespace=t,e.id=n,e}function na(e,t,n,i){var r=e.id,o=e.namespace;return K(e,"function"==typeof n?function(e,a,s){e[o][r].tween.set(t,i(n.call(e,e.__data__,a,s)))}:(n=i(n),function(e){e[o][r].tween.set(t,n)}))}function ia(e){return null==e&&(e=""),function(){this.textContent=e}}function ra(e){return null==e?"__transition__":"__transition_"+e+"__"}function oa(e,t,n,i,r){function o(e){var t=_.delay;return u.t=t+l,e>=t?a(e-t):void(u.c=a)}function a(n){var r=f.active,o=f[r];o&&(o.timer.c=null,o.timer.t=NaN,--f.count,delete f[r],o.event&&o.event.interrupt.call(e,e.__data__,o.index));for(var a in f)if(i>+a){var p=f[a];p.timer.c=null,p.timer.t=NaN,--f.count,delete f[a]}u.c=s,Ne(function(){return u.c&&s(n||1)&&(u.c=null,u.t=NaN),1},0,l),f.active=i,_.event&&_.event.start.call(e,e.__data__,t),d=[],_.tween.forEach(function(n,i){(i=i.call(e,e.__data__,t))&&d.push(i)}),h=_.ease,c=_.duration}function s(r){for(var o=r/c,a=h(o),s=d.length;s>0;)d[--s].call(e,a);return o>=1?(_.event&&_.event.end.call(e,e.__data__,t),--f.count?delete f[i]:delete e[n],1):void 0}var l,u,c,h,d,f=e[n]||(e[n]={active:0,count:0}),_=f[i];_||(l=r.time,u=Ne(o,0,l),_=f[i]={tween:new p,time:l,timer:u,delay:r.delay,duration:r.duration,ease:r.ease,index:t},r=null,++f.count)}function aa(e,t,n){e.attr("transform",function(e){var i=t(e);return"translate("+(isFinite(i)?i:n(e))+",0)"})}function sa(e,t,n){e.attr("transform",function(e){var i=t(e);return"translate(0,"+(isFinite(i)?i:n(e))+")"})}function la(e){return e.toISOString()}function ua(e,t,n){function i(t){return e(t)}function r(e,n){var i=e[1]-e[0],r=i/n,o=fa.bisect(nu,r);return o==nu.length?[t.year,io(e.map(function(e){return e/31536e6}),n)[2]]:o?t[r/nu[o-1]<nu[o]/r?o-1:o]:[ou,io(e,n)[2]]}return i.invert=function(t){return ca(e.invert(t))},i.domain=function(t){return arguments.length?(e.domain(t),i):e.domain().map(ca)},i.nice=function(e,t){function n(n){return!isNaN(n)&&!e.range(n,ca(+n+1),t).length}var o=i.domain(),a=Kr(o),s=null==e?r(a,10):"number"==typeof e&&r(a,e);return s&&(e=s[0],t=s[1]),i.domain($r(o,t>1?{floor:function(t){for(;n(t=e.floor(t));)t=ca(t-1);return t},ceil:function(t){for(;n(t=e.ceil(t));)t=ca(+t+1);return t}}:e))},i.ticks=function(e,t){var n=Kr(i.domain()),o=null==e?r(n,10):"number"==typeof e?r(n,e):!e.range&&[{range:e},t];return o&&(e=o[0],t=o[1]),e.range(n[0],ca(+n[1]+1),1>t?1:t)},i.tickFormat=function(){return n},i.copy=function(){return ua(e.copy(),t,n)},to(i,e)}function ca(e){return new Date(e)}function ha(e){return JSON.parse(e.responseText)}function da(e){var t=ga.createRange();return t.selectNode(ga.body),t.createContextualFragment(e.responseText)}var fa={version:"3.5.14"},pa=[].slice,_a=function(e){return pa.call(e)},ga=this.document;if(ga)try{_a(ga.documentElement.childNodes)[0].nodeType}catch(ma){_a=function(e){for(var t=e.length,n=new Array(t);t--;)n[t]=e[t];return n}}if(Date.now||(Date.now=function(){return+new Date}),ga)try{ga.createElement("DIV").style.setProperty("opacity",0,"")}catch(va){var ya=this.Element.prototype,ba=ya.setAttribute,xa=ya.setAttributeNS,wa=this.CSSStyleDeclaration.prototype,Sa=wa.setProperty;ya.setAttribute=function(e,t){ba.call(this,e,t+"")},ya.setAttributeNS=function(e,t,n){xa.call(this,e,t,n+"")},wa.setProperty=function(e,t,n){Sa.call(this,e,t+"",n)}}fa.ascending=s,fa.descending=function(e,t){return e>t?-1:t>e?1:t>=e?0:NaN},fa.min=function(e,t){var n,i,r=-1,o=e.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=e[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=e[r])&&n>i&&(n=i)}else{for(;++r<o;)if(null!=(i=t.call(e,e[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=t.call(e,e[r],r))&&n>i&&(n=i)}return n},fa.max=function(e,t){var n,i,r=-1,o=e.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=e[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=e[r])&&i>n&&(n=i)}else{for(;++r<o;)if(null!=(i=t.call(e,e[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=t.call(e,e[r],r))&&i>n&&(n=i)}return n},fa.extent=function(e,t){var n,i,r,o=-1,a=e.length;if(1===arguments.length){for(;++o<a;)if(null!=(i=e[o])&&i>=i){n=r=i;break}for(;++o<a;)null!=(i=e[o])&&(n>i&&(n=i),i>r&&(r=i))}else{for(;++o<a;)if(null!=(i=t.call(e,e[o],o))&&i>=i){n=r=i;break}for(;++o<a;)null!=(i=t.call(e,e[o],o))&&(n>i&&(n=i),i>r&&(r=i))}return[n,r]},fa.sum=function(e,t){var n,i=0,r=e.length,o=-1;if(1===arguments.length)for(;++o<r;)u(n=+e[o])&&(i+=n);else for(;++o<r;)u(n=+t.call(e,e[o],o))&&(i+=n);return i},fa.mean=function(e,t){var n,i=0,r=e.length,o=-1,a=r;if(1===arguments.length)for(;++o<r;)u(n=l(e[o]))?i+=n:--a;else for(;++o<r;)u(n=l(t.call(e,e[o],o)))?i+=n:--a;return a?i/a:void 0},fa.quantile=function(e,t){var n=(e.length-1)*t+1,i=Math.floor(n),r=+e[i-1],o=n-i;return o?r+o*(e[i]-r):r},fa.median=function(e,t){var n,i=[],r=e.length,o=-1;if(1===arguments.length)for(;++o<r;)u(n=l(e[o]))&&i.push(n);else for(;++o<r;)u(n=l(t.call(e,e[o],o)))&&i.push(n);return i.length?fa.quantile(i.sort(s),.5):void 0},fa.variance=function(e,t){var n,i,r=e.length,o=0,a=0,s=-1,c=0;if(1===arguments.length)for(;++s<r;)u(n=l(e[s]))&&(i=n-o,o+=i/++c,a+=i*(n-o));else for(;++s<r;)u(n=l(t.call(e,e[s],s)))&&(i=n-o,o+=i/++c,a+=i*(n-o));return c>1?a/(c-1):void 0},fa.deviation=function(){var e=fa.variance.apply(this,arguments);return e?Math.sqrt(e):e};var Aa=c(s);fa.bisectLeft=Aa.left,fa.bisect=fa.bisectRight=Aa.right,fa.bisector=function(e){return c(1===e.length?function(t,n){return s(e(t),n)}:e)},fa.shuffle=function(e,t,n){(o=arguments.length)<3&&(n=e.length,2>o&&(t=0));for(var i,r,o=n-t;o;)r=Math.random()*o--|0,i=e[o+t],e[o+t]=e[r+t],e[r+t]=i;return e},fa.permute=function(e,t){for(var n=t.length,i=new Array(n);n--;)i[n]=e[t[n]];return i},fa.pairs=function(e){for(var t,n=0,i=e.length-1,r=e[0],o=new Array(0>i?0:i);i>n;)o[n]=[t=r,r=e[++n]];return o},fa.zip=function(){if(!(i=arguments.length))return[];for(var e=-1,t=fa.min(arguments,h),n=new Array(t);++e<t;)for(var i,r=-1,o=n[e]=new Array(i);++r<i;)o[r]=arguments[r][e];return n},fa.transpose=function(e){return fa.zip.apply(fa,e)},fa.keys=function(e){var t=[];for(var n in e)t.push(n);return t},fa.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},fa.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},fa.merge=function(e){for(var t,n,i,r=e.length,o=-1,a=0;++o<r;)a+=e[o].length;for(n=new Array(a);--r>=0;)for(i=e[r],t=i.length;--t>=0;)n[--a]=i[t];return n};var ka=Math.abs;fa.range=function(e,t,n){if(arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0)),(t-e)/n===1/0)throw new Error("infinite range");var i,r=[],o=d(ka(n)),a=-1;if(e*=o,t*=o,n*=o,0>n)for(;(i=e+n*++a)>t;)r.push(i/o);else for(;(i=e+n*++a)<t;)r.push(i/o);return r},fa.map=function(e,t){var n=new p;if(e instanceof p)e.forEach(function(e,t){n.set(e,t)});else if(Array.isArray(e)){var i,r=-1,o=e.length;if(1===arguments.length)for(;++r<o;)n.set(r,e[r]);else for(;++r<o;)n.set(t.call(e,i=e[r],r),i)}else for(var a in e)n.set(a,e[a]);return n};var Ca="__proto__",Ta="\x00";f(p,{has:m,get:function(e){return this._[_(e)]},set:function(e,t){return this._[_(e)]=t},remove:v,keys:y,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:g(t),value:this._[t]});return e},size:b,empty:x,forEach:function(e){for(var t in this._)e.call(this,g(t),this._[t])}}),fa.nest=function(){function e(t,a,s){if(s>=o.length)return i?i.call(r,a):n?a.sort(n):a;for(var l,u,c,h,d=-1,f=a.length,_=o[s++],g=new p;++d<f;)(h=g.get(l=_(u=a[d])))?h.push(u):g.set(l,[u]);return t?(u=t(),c=function(n,i){u.set(n,e(t,i,s))}):(u={},c=function(n,i){u[n]=e(t,i,s)}),g.forEach(c),u}function t(e,n){if(n>=o.length)return e;var i=[],r=a[n++];return e.forEach(function(e,r){i.push({key:e,values:t(r,n)})}),r?i.sort(function(e,t){return r(e.key,t.key)}):i}var n,i,r={},o=[],a=[];return r.map=function(t,n){return e(n,t,0)},r.entries=function(n){return t(e(fa.map,n,0),0)},r.key=function(e){return o.push(e),r},r.sortKeys=function(e){return a[o.length-1]=e,r},r.sortValues=function(e){return n=e,r},r.rollup=function(e){return i=e,r},r},fa.set=function(e){var t=new w;if(e)for(var n=0,i=e.length;i>n;++n)t.add(e[n]);return t},f(w,{has:m,add:function(e){return this._[_(e+="")]=!0,e},remove:v,values:y,size:b,empty:x,forEach:function(e){for(var t in this._)e.call(this,g(t))}}),fa.behavior={},fa.rebind=function(e,t){for(var n,i=1,r=arguments.length;++i<r;)e[n=arguments[i]]=A(e,t,t[n]);return e};var Ea=["webkit","ms","moz","Moz","o","O"];fa.dispatch=function(){for(var e=new T,t=-1,n=arguments.length;++t<n;)e[arguments[t]]=E(e);return e},T.prototype.on=function(e,t){var n=e.indexOf("."),i="";if(n>=0&&(i=e.slice(n+1),e=e.slice(0,n)),e)return arguments.length<2?this[e].on(i):this[e].on(i,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(i,null);return this}},fa.event=null,fa.requote=function(e){return e.replace(Ma,"\\$&")};var Ma=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,La={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]},Ra=function(e,t){return t.querySelector(e)},Oa=function(e,t){return t.querySelectorAll(e)},Pa=function(e,t){var n=e.matches||e[k(e,"matchesSelector")];return(Pa=function(e,t){return n.call(e,t)})(e,t)};"function"==typeof Sizzle&&(Ra=function(e,t){return Sizzle(e,t)[0]||null},Oa=Sizzle,Pa=Sizzle.matchesSelector),fa.selection=function(){return fa.select(ga.documentElement)};var Da=fa.selection.prototype=[];Da.select=function(e){var t,n,i,r,o=[];e=P(e);for(var a=-1,s=this.length;++a<s;){o.push(t=[]),t.parentNode=(i=this[a]).parentNode;for(var l=-1,u=i.length;++l<u;)(r=i[l])?(t.push(n=e.call(r,r.__data__,l,a)),n&&"__data__"in r&&(n.__data__=r.__data__)):t.push(null)}return O(o)},Da.selectAll=function(e){var t,n,i=[];e=D(e);for(var r=-1,o=this.length;++r<o;)for(var a=this[r],s=-1,l=a.length;++s<l;)(n=a[s])&&(i.push(t=_a(e.call(n,n.__data__,s,r))),t.parentNode=n);return O(i)};var Ia={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};fa.ns={prefix:Ia,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&"xmlns"!==(n=e.slice(0,t))&&(e=e.slice(t+1)),Ia.hasOwnProperty(n)?{space:Ia[n],local:e}:e}},Da.attr=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node();return e=fa.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(I(t,e[t]));return this}return this.each(I(e,t))},Da.classed=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node(),i=(e=B(e)).length,r=-1;if(t=n.classList){for(;++r<i;)if(!t.contains(e[r]))return!1}else for(t=n.getAttribute("class");++r<i;)if(!F(e[r]).test(t))return!1;return!0}for(t in e)this.each(z(t,e[t]));return this}return this.each(z(e,t))},Da.style=function(e,t,n){var i=arguments.length;if(3>i){if("string"!=typeof e){2>i&&(t="");for(n in e)this.each(q(n,e[n],t));return this}if(2>i){var r=this.node();return a(r).getComputedStyle(r,null).getPropertyValue(e)}n=""}return this.each(q(e,t,n))},Da.property=function(e,t){if(arguments.length<2){if("string"==typeof e)return this.node()[e];for(t in e)this.each(G(t,e[t]));return this}return this.each(G(e,t))},Da.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},Da.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},Da.append=function(e){return e=j(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},Da.insert=function(e,t){return e=j(e),t=P(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},Da.remove=function(){return this.each(U)},Da.data=function(e,t){function n(e,n){var i,r,o,a=e.length,c=n.length,h=Math.min(a,c),d=new Array(c),f=new Array(c),_=new Array(a);if(t){var g,m=new p,v=new Array(a);for(i=-1;++i<a;)(r=e[i])&&(m.has(g=t.call(r,r.__data__,i))?_[i]=r:m.set(g,r),v[i]=g);for(i=-1;++i<c;)(r=m.get(g=t.call(n,o=n[i],i)))?r!==!0&&(d[i]=r,r.__data__=o):f[i]=V(o),m.set(g,!0);for(i=-1;++i<a;)i in v&&m.get(v[i])!==!0&&(_[i]=e[i])}else{for(i=-1;++i<h;)r=e[i],o=n[i],r?(r.__data__=o,d[i]=r):f[i]=V(o);for(;c>i;++i)f[i]=V(n[i]);for(;a>i;++i)_[i]=e[i]}f.update=d,f.parentNode=d.parentNode=_.parentNode=e.parentNode,s.push(f),l.push(d),u.push(_)}var i,r,o=-1,a=this.length;if(!arguments.length){for(e=new Array(a=(i=this[0]).length);++o<a;)(r=i[o])&&(e[o]=r.__data__);return e}var s=Y([]),l=O([]),u=O([]);if("function"==typeof e)for(;++o<a;)n(i=this[o],e.call(i,i.parentNode.__data__,o));else for(;++o<a;)n(i=this[o],e);return l.enter=function(){return s},l.exit=function(){return u},l},Da.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__");
},Da.filter=function(e){var t,n,i,r=[];"function"!=typeof e&&(e=W(e));for(var o=0,a=this.length;a>o;o++){r.push(t=[]),t.parentNode=(n=this[o]).parentNode;for(var s=0,l=n.length;l>s;s++)(i=n[s])&&e.call(i,i.__data__,s,o)&&t.push(i)}return O(r)},Da.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n,i=this[e],r=i.length-1,o=i[r];--r>=0;)(n=i[r])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},Da.sort=function(e){e=X.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},Da.each=function(e){return K(this,function(t,n,i){e.call(t,t.__data__,n,i)})},Da.call=function(e){var t=_a(arguments);return e.apply(t[0]=this,t),this},Da.empty=function(){return!this.node()},Da.node=function(){for(var e=0,t=this.length;t>e;e++)for(var n=this[e],i=0,r=n.length;r>i;i++){var o=n[i];if(o)return o}return null},Da.size=function(){var e=0;return K(this,function(){++e}),e};var Na=[];fa.selection.enter=Y,fa.selection.enter.prototype=Na,Na.append=Da.append,Na.empty=Da.empty,Na.node=Da.node,Na.call=Da.call,Na.size=Da.size,Na.select=function(e){for(var t,n,i,r,o,a=[],s=-1,l=this.length;++s<l;){i=(r=this[s]).update,a.push(t=[]),t.parentNode=r.parentNode;for(var u=-1,c=r.length;++u<c;)(o=r[u])?(t.push(i[u]=n=e.call(r.parentNode,o.__data__,u,s)),n.__data__=o.__data__):t.push(null)}return O(a)},Na.insert=function(e,t){return arguments.length<2&&(t=Z(this)),Da.insert.call(this,e,t)},fa.select=function(e){var t;return"string"==typeof e?(t=[Ra(e,ga)],t.parentNode=ga.documentElement):(t=[e],t.parentNode=o(e)),O([t])},fa.selectAll=function(e){var t;return"string"==typeof e?(t=_a(Oa(e,ga)),t.parentNode=ga.documentElement):(t=_a(e),t.parentNode=null),O([t])},Da.on=function(e,t,n){var i=arguments.length;if(3>i){if("string"!=typeof e){2>i&&(t=!1);for(n in e)this.each($(n,e[n],t));return this}if(2>i)return(i=this.node()["__on"+e])&&i._;n=!1}return this.each($(e,t,n))};var Fa=fa.map({mouseenter:"mouseover",mouseleave:"mouseout"});ga&&Fa.forEach(function(e){"on"+e in ga&&Fa.remove(e)});var Ba,za=0;fa.mouse=function(e){return te(e,L())};var Ha=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;fa.touch=function(e,t,n){if(arguments.length<3&&(n=t,t=L().changedTouches),t)for(var i,r=0,o=t.length;o>r;++r)if((i=t[r]).identifier===n)return te(e,i)},fa.behavior.drag=function(){function e(){this.on("mousedown.drag",r).on("touchstart.drag",o)}function t(e,t,r,o,a){return function(){function s(){var e,n,i=t(d,_);i&&(e=i[0]-y[0],n=i[1]-y[1],p|=e|n,y=i,f({type:"drag",x:i[0]+u[0],y:i[1]+u[1],dx:e,dy:n}))}function l(){t(d,_)&&(m.on(o+g,null).on(a+g,null),v(p),f({type:"dragend"}))}var u,c=this,h=fa.event.target,d=c.parentNode,f=n.of(c,arguments),p=0,_=e(),g=".drag"+(null==_?"":"-"+_),m=fa.select(r(h)).on(o+g,s).on(a+g,l),v=ee(h),y=t(d,_);i?(u=i.apply(c,arguments),u=[u.x-y[0],u.y-y[1]]):u=[0,0],f({type:"dragstart"})}}var n=R(e,"drag","dragstart","dragend"),i=null,r=t(C,fa.mouse,a,"mousemove","mouseup"),o=t(ne,fa.touch,S,"touchmove","touchend");return e.origin=function(t){return arguments.length?(i=t,e):i},fa.rebind(e,n,"on")},fa.touches=function(e,t){return arguments.length<2&&(t=L().touches),t?_a(t).map(function(t){var n=te(e,t);return n.identifier=t.identifier,n}):[]};var qa=1e-6,Ga=qa*qa,ja=Math.PI,Ua=2*ja,Va=Ua-qa,Wa=ja/2,Xa=ja/180,Ka=180/ja,Ya=Math.SQRT2,Za=2,$a=4;fa.interpolateZoom=function(e,t){var n,i,r=e[0],o=e[1],a=e[2],s=t[0],l=t[1],u=t[2],c=s-r,h=l-o,d=c*c+h*h;if(Ga>d)i=Math.log(u/a)/Ya,n=function(e){return[r+e*c,o+e*h,a*Math.exp(Ya*e*i)]};else{var f=Math.sqrt(d),p=(u*u-a*a+$a*d)/(2*a*Za*f),_=(u*u-a*a-$a*d)/(2*u*Za*f),g=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(_*_+1)-_);i=(m-g)/Ya,n=function(e){var t=e*i,n=le(g),s=a/(Za*f)*(n*ue(Ya*t+g)-se(g));return[r+s*c,o+s*h,a*n/le(Ya*t+g)]}}return n.duration=1e3*i,n},fa.behavior.zoom=function(){function e(e){e.on(L,h).on(Qa+".zoom",f).on("dblclick.zoom",p).on(D,d)}function t(e){return[(e[0]-A.x)/A.k,(e[1]-A.y)/A.k]}function n(e){return[e[0]*A.k+A.x,e[1]*A.k+A.y]}function i(e){A.k=Math.max(C[0],Math.min(C[1],e))}function r(e,t){t=n(t),A.x+=e[0]-t[0],A.y+=e[1]-t[1]}function o(t,n,o,a){t.__chart__={x:A.x,y:A.y,k:A.k},i(Math.pow(2,a)),r(g=n,o),t=fa.select(t),T>0&&(t=t.transition().duration(T)),t.call(e.event)}function s(){x&&x.domain(b.range().map(function(e){return(e-A.x)/A.k}).map(b.invert)),S&&S.domain(w.range().map(function(e){return(e-A.y)/A.k}).map(w.invert))}function l(e){E++||e({type:"zoomstart"})}function u(e){s(),e({type:"zoom",scale:A.k,translate:[A.x,A.y]})}function c(e){--E||(e({type:"zoomend"}),g=null)}function h(){function e(){s=1,r(fa.mouse(i),d),u(o)}function n(){h.on(O,null).on(P,null),f(s),c(o)}var i=this,o=I.of(i,arguments),s=0,h=fa.select(a(i)).on(O,e).on(P,n),d=t(fa.mouse(i)),f=ee(i);Wl.call(i),l(o)}function d(){function e(){var e=fa.touches(p);return f=A.k,e.forEach(function(e){e.identifier in g&&(g[e.identifier]=t(e))}),e}function n(){var t=fa.event.target;fa.select(t).on(b,a).on(x,s),w.push(t);for(var n=fa.event.changedTouches,i=0,r=n.length;r>i;++i)g[n[i].identifier]=null;var l=e(),u=Date.now();if(1===l.length){if(500>u-y){var c=l[0];o(p,c,g[c.identifier],Math.floor(Math.log(A.k)/Math.LN2)+1),M()}y=u}else if(l.length>1){var c=l[0],h=l[1],d=c[0]-h[0],f=c[1]-h[1];m=d*d+f*f}}function a(){var e,t,n,o,a=fa.touches(p);Wl.call(p);for(var s=0,l=a.length;l>s;++s,o=null)if(n=a[s],o=g[n.identifier]){if(t)break;e=n,t=o}if(o){var c=(c=n[0]-e[0])*c+(c=n[1]-e[1])*c,h=m&&Math.sqrt(c/m);e=[(e[0]+n[0])/2,(e[1]+n[1])/2],t=[(t[0]+o[0])/2,(t[1]+o[1])/2],i(h*f)}y=null,r(e,t),u(_)}function s(){if(fa.event.touches.length){for(var t=fa.event.changedTouches,n=0,i=t.length;i>n;++n)delete g[t[n].identifier];for(var r in g)return void e()}fa.selectAll(w).on(v,null),S.on(L,h).on(D,d),k(),c(_)}var f,p=this,_=I.of(p,arguments),g={},m=0,v=".zoom-"+fa.event.changedTouches[0].identifier,b="touchmove"+v,x="touchend"+v,w=[],S=fa.select(p),k=ee(p);n(),l(_),S.on(L,null).on(D,n)}function f(){var e=I.of(this,arguments);v?clearTimeout(v):(Wl.call(this),_=t(g=m||fa.mouse(this)),l(e)),v=setTimeout(function(){v=null,c(e)},50),M(),i(Math.pow(2,.002*Ja())*A.k),r(g,_),u(e)}function p(){var e=fa.mouse(this),n=Math.log(A.k)/Math.LN2;o(this,e,t(e),fa.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}var _,g,m,v,y,b,x,w,S,A={x:0,y:0,k:1},k=[960,500],C=es,T=250,E=0,L="mousedown.zoom",O="mousemove.zoom",P="mouseup.zoom",D="touchstart.zoom",I=R(e,"zoomstart","zoom","zoomend");return Qa||(Qa="onwheel"in ga?(Ja=function(){return-fa.event.deltaY*(fa.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ga?(Ja=function(){return fa.event.wheelDelta},"mousewheel"):(Ja=function(){return-fa.event.detail},"MozMousePixelScroll")),e.event=function(e){e.each(function(){var e=I.of(this,arguments),t=A;Ul?fa.select(this).transition().each("start.zoom",function(){A=this.__chart__||{x:0,y:0,k:1},l(e)}).tween("zoom:zoom",function(){var n=k[0],i=k[1],r=g?g[0]:n/2,o=g?g[1]:i/2,a=fa.interpolateZoom([(r-A.x)/A.k,(o-A.y)/A.k,n/A.k],[(r-t.x)/t.k,(o-t.y)/t.k,n/t.k]);return function(t){var i=a(t),s=n/i[2];this.__chart__=A={x:r-i[0]*s,y:o-i[1]*s,k:s},u(e)}}).each("interrupt.zoom",function(){c(e)}).each("end.zoom",function(){c(e)}):(this.__chart__=A,l(e),u(e),c(e))})},e.translate=function(t){return arguments.length?(A={x:+t[0],y:+t[1],k:A.k},s(),e):[A.x,A.y]},e.scale=function(t){return arguments.length?(A={x:A.x,y:A.y,k:null},i(+t),s(),e):A.k},e.scaleExtent=function(t){return arguments.length?(C=null==t?es:[+t[0],+t[1]],e):C},e.center=function(t){return arguments.length?(m=t&&[+t[0],+t[1]],e):m},e.size=function(t){return arguments.length?(k=t&&[+t[0],+t[1]],e):k},e.duration=function(t){return arguments.length?(T=+t,e):T},e.x=function(t){return arguments.length?(x=t,b=t.copy(),A={x:0,y:0,k:1},e):x},e.y=function(t){return arguments.length?(S=t,w=t.copy(),A={x:0,y:0,k:1},e):S},fa.rebind(e,I,"on")};var Ja,Qa,es=[0,1/0];fa.color=he,he.prototype.toString=function(){return this.rgb()+""},fa.hsl=de;var ts=de.prototype=new he;ts.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),new de(this.h,this.s,this.l/e)},ts.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new de(this.h,this.s,e*this.l)},ts.rgb=function(){return fe(this.h,this.s,this.l)},fa.hcl=pe;var ns=pe.prototype=new he;ns.brighter=function(e){return new pe(this.h,this.c,Math.min(100,this.l+is*(arguments.length?e:1)))},ns.darker=function(e){return new pe(this.h,this.c,Math.max(0,this.l-is*(arguments.length?e:1)))},ns.rgb=function(){return _e(this.h,this.c,this.l).rgb()},fa.lab=ge;var is=18,rs=.95047,os=1,as=1.08883,ss=ge.prototype=new he;ss.brighter=function(e){return new ge(Math.min(100,this.l+is*(arguments.length?e:1)),this.a,this.b)},ss.darker=function(e){return new ge(Math.max(0,this.l-is*(arguments.length?e:1)),this.a,this.b)},ss.rgb=function(){return me(this.l,this.a,this.b)},fa.rgb=we;var ls=we.prototype=new he;ls.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,i=this.b,r=30;return t||n||i?(t&&r>t&&(t=r),n&&r>n&&(n=r),i&&r>i&&(i=r),new we(Math.min(255,t/e),Math.min(255,n/e),Math.min(255,i/e))):new we(r,r,r)},ls.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new we(e*this.r,e*this.g,e*this.b)},ls.hsl=function(){return Te(this.r,this.g,this.b)},ls.toString=function(){return"#"+ke(this.r)+ke(this.g)+ke(this.b)};var us=fa.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});us.forEach(function(e,t){us.set(e,Se(t))}),fa.functor=Re,fa.xhr=Oe(S),fa.dsv=function(e,t){function n(e,n,o){arguments.length<3&&(o=n,n=null);var a=Pe(e,t,null==n?i:r(n),o);return a.row=function(e){return arguments.length?a.response(null==(n=e)?i:r(e)):n},a}function i(e){return n.parse(e.responseText)}function r(e){return function(t){return n.parse(t.responseText,e)}}function o(t){return t.map(a).join(e)}function a(e){return s.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var s=new RegExp('["'+e+"\n]"),l=e.charCodeAt(0);return n.parse=function(e,t){var i;return n.parseRows(e,function(e,n){if(i)return i(e,n-1);var r=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");i=t?function(e,n){return t(r(e),n)}:r})},n.parseRows=function(e,t){function n(){if(c>=u)return a;if(r)return r=!1,o;var t=c;if(34===e.charCodeAt(t)){for(var n=t;n++<u;)if(34===e.charCodeAt(n)){if(34!==e.charCodeAt(n+1))break;++n}c=n+2;var i=e.charCodeAt(n+1);return 13===i?(r=!0,10===e.charCodeAt(n+2)&&++c):10===i&&(r=!0),e.slice(t+1,n).replace(/""/g,'"')}for(;u>c;){var i=e.charCodeAt(c++),s=1;if(10===i)r=!0;else if(13===i)r=!0,10===e.charCodeAt(c)&&(++c,++s);else if(i!==l)continue;return e.slice(t,c-s)}return e.slice(t)}for(var i,r,o={},a={},s=[],u=e.length,c=0,h=0;(i=n())!==a;){for(var d=[];i!==o&&i!==a;)d.push(i),i=n();t&&null==(d=t(d,h++))||s.push(d)}return s},n.format=function(t){if(Array.isArray(t[0]))return n.formatRows(t);var i=new w,r=[];return t.forEach(function(e){for(var t in e)i.has(t)||r.push(i.add(t))}),[r.map(a).join(e)].concat(t.map(function(t){return r.map(function(e){return a(t[e])}).join(e)})).join("\n")},n.formatRows=function(e){return e.map(o).join("\n")},n},fa.csv=fa.dsv(",","text/csv"),fa.tsv=fa.dsv("	","text/tab-separated-values");var cs,hs,ds,fs,ps=this[k(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};fa.timer=function(){Ne.apply(this,arguments)},fa.timer.flush=function(){Be(),ze()},fa.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var _s=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(qe);fa.formatPrefix=function(e,t){var n=0;return(e=+e)&&(0>e&&(e*=-1),t&&(e=fa.round(e,He(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),_s[8+n/3]};var gs=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ms=fa.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=fa.round(e,He(e,t))).toFixed(Math.max(0,Math.min(20,He(e*(1+1e-15),t))))}}),vs=fa.time={},ys=Date;Ue.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){bs.setUTCDate.apply(this._,arguments)},setDay:function(){bs.setUTCDay.apply(this._,arguments)},setFullYear:function(){bs.setUTCFullYear.apply(this._,arguments)},setHours:function(){bs.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){bs.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){bs.setUTCMinutes.apply(this._,arguments)},setMonth:function(){bs.setUTCMonth.apply(this._,arguments)},setSeconds:function(){bs.setUTCSeconds.apply(this._,arguments)},setTime:function(){bs.setTime.apply(this._,arguments)}};var bs=Date.prototype;vs.year=Ve(function(e){return e=vs.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),vs.years=vs.year.range,vs.years.utc=vs.year.utc.range,vs.day=Ve(function(e){var t=new ys(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),vs.days=vs.day.range,vs.days.utc=vs.day.utc.range,vs.dayOfYear=function(e){var t=vs.year(e);return Math.floor((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var n=vs[e]=Ve(function(e){return(e=vs.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*Math.floor(t))},function(e){var n=vs.year(e).getDay();return Math.floor((vs.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});vs[e+"s"]=n.range,vs[e+"s"].utc=n.utc.range,vs[e+"OfYear"]=function(e){var n=vs.year(e).getDay();return Math.floor((vs.dayOfYear(e)+(n+t)%7)/7)}}),vs.week=vs.sunday,vs.weeks=vs.sunday.range,vs.weeks.utc=vs.sunday.utc.range,vs.weekOfYear=vs.sundayOfYear;var xs={"-":"",_:" ",0:"0"},ws=/^\s*\d+/,Ss=/^%/;fa.locale=function(e){return{numberFormat:Ge(e),timeFormat:Xe(e)}};var As=fa.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});fa.format=As.numberFormat,fa.geo={},pt.prototype={s:0,t:0,add:function(e){_t(e,this.t,ks),_t(ks.s,this.s,this),this.s?this.t+=ks.t:this.s=ks.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ks=new pt;fa.geo.stream=function(e,t){e&&Cs.hasOwnProperty(e.type)?Cs[e.type](e,t):gt(e,t)};var Cs={Feature:function(e,t){gt(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)gt(n[i].geometry,t)}},Ts={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){mt(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)mt(n[i],t,0)},Polygon:function(e,t){vt(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)vt(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)gt(n[i],t)}};fa.geo.area=function(e){return Es=0,fa.geo.stream(e,Ls),Es};var Es,Ms=new pt,Ls={sphere:function(){Es+=4*ja},point:C,lineStart:C,lineEnd:C,polygonStart:function(){Ms.reset(),Ls.lineStart=yt},polygonEnd:function(){var e=2*Ms;Es+=0>e?4*ja+e:e,Ls.lineStart=Ls.lineEnd=Ls.point=C}};fa.geo.bounds=function(){function e(e,t){y.push(b=[c=e,d=e]),h>t&&(h=t),t>f&&(f=t)}function t(t,n){var i=bt([t*Xa,n*Xa]);if(m){var r=wt(m,i),o=[r[1],-r[0],0],a=wt(o,r);kt(a),a=Ct(a);var l=t-p,u=l>0?1:-1,_=a[0]*Ka*u,g=ka(l)>180;if(g^(_>u*p&&u*t>_)){var v=a[1]*Ka;v>f&&(f=v)}else if(_=(_+360)%360-180,g^(_>u*p&&u*t>_)){var v=-a[1]*Ka;h>v&&(h=v)}else h>n&&(h=n),n>f&&(f=n);g?p>t?s(c,t)>s(c,d)&&(d=t):s(t,d)>s(c,d)&&(c=t):d>=c?(c>t&&(c=t),t>d&&(d=t)):t>p?s(c,t)>s(c,d)&&(d=t):s(t,d)>s(c,d)&&(c=t)}else e(t,n);m=i,p=t}function n(){x.point=t}function i(){b[0]=c,b[1]=d,x.point=e,m=null}function r(e,n){if(m){var i=e-p;v+=ka(i)>180?i+(i>0?360:-360):i}else _=e,g=n;Ls.point(e,n),t(e,n)}function o(){Ls.lineStart()}function a(){r(_,g),Ls.lineEnd(),ka(v)>qa&&(c=-(d=180)),b[0]=c,b[1]=d,m=null}function s(e,t){return(t-=e)<0?t+360:t}function l(e,t){return e[0]-t[0]}function u(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var c,h,d,f,p,_,g,m,v,y,b,x={point:e,lineStart:n,lineEnd:i,polygonStart:function(){x.point=r,x.lineStart=o,x.lineEnd=a,v=0,Ls.polygonStart()},polygonEnd:function(){Ls.polygonEnd(),x.point=e,x.lineStart=n,x.lineEnd=i,0>Ms?(c=-(d=180),h=-(f=90)):v>qa?f=90:-qa>v&&(h=-90),b[0]=c,b[1]=d}};return function(e){f=d=-(c=h=1/0),y=[],fa.geo.stream(e,x);var t=y.length;if(t){y.sort(l);for(var n,i=1,r=y[0],o=[r];t>i;++i)n=y[i],u(n[0],r)||u(n[1],r)?(s(r[0],n[1])>s(r[0],r[1])&&(r[1]=n[1]),s(n[0],r[1])>s(r[0],r[1])&&(r[0]=n[0])):o.push(r=n);for(var a,n,p=-(1/0),t=o.length-1,i=0,r=o[t];t>=i;r=n,++i)n=o[i],(a=s(r[1],n[0]))>p&&(p=a,c=n[0],d=r[1])}return y=b=null,c===1/0||h===1/0?[[NaN,NaN],[NaN,NaN]]:[[c,h],[d,f]]}}(),fa.geo.centroid=function(e){Rs=Os=Ps=Ds=Is=Ns=Fs=Bs=zs=Hs=qs=0,fa.geo.stream(e,Gs);var t=zs,n=Hs,i=qs,r=t*t+n*n+i*i;return Ga>r&&(t=Ns,n=Fs,i=Bs,qa>Os&&(t=Ps,n=Ds,i=Is),r=t*t+n*n+i*i,Ga>r)?[NaN,NaN]:[Math.atan2(n,t)*Ka,ae(i/Math.sqrt(r))*Ka]};var Rs,Os,Ps,Ds,Is,Ns,Fs,Bs,zs,Hs,qs,Gs={sphere:C,point:Et,lineStart:Lt,lineEnd:Rt,polygonStart:function(){Gs.lineStart=Ot},polygonEnd:function(){Gs.lineStart=Lt}},js=Bt(Dt,Gt,Ut,[-ja,-ja/2]),Us=1e9;fa.geo.clipExtent=function(){var e,t,n,i,r,o,a={stream:function(e){return r&&(r.valid=!1),r=o(e),r.valid=!0,r},extent:function(s){return arguments.length?(o=Kt(e=+s[0][0],t=+s[0][1],n=+s[1][0],i=+s[1][1]),r&&(r.valid=!1,r=null),a):[[e,t],[n,i]]}};return a.extent([[0,0],[960,500]])},(fa.geo.conicEqualArea=function(){return Yt(Zt)}).raw=Zt,fa.geo.albers=function(){return fa.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},fa.geo.albersUsa=function(){function e(e){var o=e[0],a=e[1];return t=null,n(o,a),t||(i(o,a),t)||r(o,a),t}var t,n,i,r,o=fa.geo.albers(),a=fa.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=fa.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,n){t=[e,n]}};return e.invert=function(e){var t=o.scale(),n=o.translate(),i=(e[0]-n[0])/t,r=(e[1]-n[1])/t;return(r>=.12&&.234>r&&i>=-.425&&-.214>i?a:r>=.166&&.234>r&&i>=-.214&&-.115>i?s:o).invert(e)},e.stream=function(e){var t=o.stream(e),n=a.stream(e),i=s.stream(e);return{point:function(e,r){t.point(e,r),n.point(e,r),i.point(e,r)},sphere:function(){t.sphere(),n.sphere(),i.sphere()},lineStart:function(){t.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){t.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){t.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){t.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},e.precision=function(t){return arguments.length?(o.precision(t),a.precision(t),s.precision(t),e):o.precision()},e.scale=function(t){return arguments.length?(o.scale(t),a.scale(.35*t),s.scale(t),e.translate(o.translate())):o.scale()},e.translate=function(t){if(!arguments.length)return o.translate();var u=o.scale(),c=+t[0],h=+t[1];return n=o.translate(t).clipExtent([[c-.455*u,h-.238*u],[c+.455*u,h+.238*u]]).stream(l).point,i=a.translate([c-.307*u,h+.201*u]).clipExtent([[c-.425*u+qa,h+.12*u+qa],[c-.214*u-qa,h+.234*u-qa]]).stream(l).point,r=s.translate([c-.205*u,h+.212*u]).clipExtent([[c-.214*u+qa,h+.166*u+qa],[c-.115*u-qa,h+.234*u-qa]]).stream(l).point,e},e.scale(1070)};var Vs,Ws,Xs,Ks,Ys,Zs,$s={point:C,lineStart:C,lineEnd:C,polygonStart:function(){Ws=0,$s.lineStart=$t},polygonEnd:function(){$s.lineStart=$s.lineEnd=$s.point=C,Vs+=ka(Ws/2)}},Js={point:Jt,lineStart:C,lineEnd:C,polygonStart:C,polygonEnd:C},Qs={point:tn,lineStart:nn,lineEnd:rn,polygonStart:function(){Qs.lineStart=on},polygonEnd:function(){Qs.point=tn,Qs.lineStart=nn,Qs.lineEnd=rn}};fa.geo.path=function(){function e(e){return e&&("function"==typeof s&&o.pointRadius(+s.apply(this,arguments)),a&&a.valid||(a=r(o)),fa.geo.stream(e,a)),o.result()}function t(){return a=null,e}var n,i,r,o,a,s=4.5;return e.area=function(e){return Vs=0,fa.geo.stream(e,r($s)),Vs},e.centroid=function(e){return Ps=Ds=Is=Ns=Fs=Bs=zs=Hs=qs=0,fa.geo.stream(e,r(Qs)),qs?[zs/qs,Hs/qs]:Bs?[Ns/Bs,Fs/Bs]:Is?[Ps/Is,Ds/Is]:[NaN,NaN]},e.bounds=function(e){return Ys=Zs=-(Xs=Ks=1/0),fa.geo.stream(e,r(Js)),[[Xs,Ks],[Ys,Zs]]},e.projection=function(e){return arguments.length?(r=(n=e)?e.stream||ln(e):S,t()):n},e.context=function(e){return arguments.length?(o=null==(i=e)?new Qt:new an(e),"function"!=typeof s&&o.pointRadius(s),t()):i},e.pointRadius=function(t){return arguments.length?(s="function"==typeof t?t:(o.pointRadius(+t),+t),e):s},e.projection(fa.geo.albersUsa()).context(null)},fa.geo.transform=function(e){return{stream:function(t){var n=new un(t);for(var i in e)n[i]=e[i];return n}}},un.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},fa.geo.projection=hn,fa.geo.projectionMutator=dn,(fa.geo.equirectangular=function(){return hn(pn)}).raw=pn.invert=pn,fa.geo.rotation=function(e){function t(t){return t=e(t[0]*Xa,t[1]*Xa),t[0]*=Ka,t[1]*=Ka,t}return e=gn(e[0]%360*Xa,e[1]*Xa,e.length>2?e[2]*Xa:0),t.invert=function(t){return t=e.invert(t[0]*Xa,t[1]*Xa),t[0]*=Ka,t[1]*=Ka,t},t},_n.invert=pn,fa.geo.circle=function(){function e(){var e="function"==typeof i?i.apply(this,arguments):i,t=gn(-e[0]*Xa,-e[1]*Xa,0).invert,r=[];return n(null,null,1,{point:function(e,n){r.push(e=t(e,n)),e[0]*=Ka,e[1]*=Ka}}),{type:"Polygon",coordinates:[r]}}var t,n,i=[0,0],r=6;return e.origin=function(t){return arguments.length?(i=t,e):i},e.angle=function(i){return arguments.length?(n=bn((t=+i)*Xa,r*Xa),e):t},e.precision=function(i){return arguments.length?(n=bn(t*Xa,(r=+i)*Xa),e):r},e.angle(90)},fa.geo.distance=function(e,t){var n,i=(t[0]-e[0])*Xa,r=e[1]*Xa,o=t[1]*Xa,a=Math.sin(i),s=Math.cos(i),l=Math.sin(r),u=Math.cos(r),c=Math.sin(o),h=Math.cos(o);return Math.atan2(Math.sqrt((n=h*a)*n+(n=u*c-l*h*s)*n),l*c+u*h*s)},fa.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return fa.range(Math.ceil(o/g)*g,r,g).map(d).concat(fa.range(Math.ceil(u/m)*m,l,m).map(f)).concat(fa.range(Math.ceil(i/p)*p,n,p).filter(function(e){return ka(e%g)>qa}).map(c)).concat(fa.range(Math.ceil(s/_)*_,a,_).filter(function(e){return ka(e%m)>qa}).map(h))}var n,i,r,o,a,s,l,u,c,h,d,f,p=10,_=p,g=90,m=360,v=2.5;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[d(o).concat(f(l).slice(1),d(r).reverse().slice(1),f(u).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(o=+t[0][0],r=+t[1][0],u=+t[0][1],l=+t[1][1],o>r&&(t=o,o=r,r=t),u>l&&(t=u,u=l,l=t),e.precision(v)):[[o,u],[r,l]]},e.minorExtent=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],s=+t[0][1],a=+t[1][1],i>n&&(t=i,i=n,n=t),s>a&&(t=s,s=a,a=t),e.precision(v)):[[i,s],[n,a]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(g=+t[0],m=+t[1],e):[g,m]},e.minorStep=function(t){return arguments.length?(p=+t[0],_=+t[1],e):[p,_]},e.precision=function(t){return arguments.length?(v=+t,c=wn(s,a,90),h=Sn(i,n,v),d=wn(u,l,90),f=Sn(o,r,v),e):v},e.majorExtent([[-180,-90+qa],[180,90-qa]]).minorExtent([[-180,-80-qa],[180,80+qa]])},fa.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[t||i.apply(this,arguments),n||r.apply(this,arguments)]}}var t,n,i=An,r=kn;return e.distance=function(){return fa.geo.distance(t||i.apply(this,arguments),n||r.apply(this,arguments))},e.source=function(n){return arguments.length?(i=n,t="function"==typeof n?null:n,e):i},e.target=function(t){return arguments.length?(r=t,n="function"==typeof t?null:t,e):r},e.precision=function(){return arguments.length?e:0},e},fa.geo.interpolate=function(e,t){return Cn(e[0]*Xa,e[1]*Xa,t[0]*Xa,t[1]*Xa)},fa.geo.length=function(e){return el=0,fa.geo.stream(e,tl),el};var el,tl={sphere:C,point:C,lineStart:Tn,lineEnd:C,polygonStart:C,polygonEnd:C},nl=En(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(fa.geo.azimuthalEqualArea=function(){return hn(nl)}).raw=nl;var il=En(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},S);(fa.geo.azimuthalEquidistant=function(){return hn(il)}).raw=il,(fa.geo.conicConformal=function(){return Yt(Mn)}).raw=Mn,(fa.geo.conicEquidistant=function(){return Yt(Ln)}).raw=Ln;var rl=En(function(e){return 1/e},Math.atan);(fa.geo.gnomonic=function(){return hn(rl)}).raw=rl,Rn.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-Wa]},(fa.geo.mercator=function(){return On(Rn)}).raw=Rn;var ol=En(function(){return 1},Math.asin);(fa.geo.orthographic=function(){return hn(ol)}).raw=ol;var al=En(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(fa.geo.stereographic=function(){return hn(al)}).raw=al,Pn.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-Wa]},(fa.geo.transverseMercator=function(){var e=On(Pn),t=e.center,n=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return e?n([e[0],e[1],e.length>2?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])},n([0,0,90])}).raw=Pn,fa.geom={},fa.geom.hull=function(e){function t(e){if(e.length<3)return[];var t,r=Re(n),o=Re(i),a=e.length,s=[],l=[];for(t=0;a>t;t++)s.push([+r.call(this,e[t],t),+o.call(this,e[t],t),t]);for(s.sort(Fn),t=0;a>t;t++)l.push([s[t][0],-s[t][1]]);var u=Nn(s),c=Nn(l),h=c[0]===u[0],d=c[c.length-1]===u[u.length-1],f=[];for(t=u.length-1;t>=0;--t)f.push(e[s[u[t]][2]]);for(t=+h;t<c.length-d;++t)f.push(e[s[c[t]][2]]);return f}var n=Dn,i=In;return arguments.length?t(e):(t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(i=e,t):i},t)},fa.geom.polygon=function(e){return La(e,sl),e};var sl=fa.geom.polygon.prototype=[];sl.area=function(){for(var e,t=-1,n=this.length,i=this[n-1],r=0;++t<n;)e=i,i=this[t],r+=e[1]*i[0]-e[0]*i[1];return.5*r},sl.centroid=function(e){var t,n,i=-1,r=this.length,o=0,a=0,s=this[r-1];for(arguments.length||(e=-1/(6*this.area()));++i<r;)t=s,s=this[i],n=t[0]*s[1]-s[0]*t[1],o+=(t[0]+s[0])*n,a+=(t[1]+s[1])*n;return[o*e,a*e]},sl.clip=function(e){for(var t,n,i,r,o,a,s=Hn(e),l=-1,u=this.length-Hn(this),c=this[u-1];++l<u;){for(t=e.slice(),e.length=0,r=this[l],o=t[(i=t.length-s)-1],n=-1;++n<i;)a=t[n],Bn(a,c,r)?(Bn(o,c,r)||e.push(zn(o,a,c,r)),e.push(a)):Bn(o,c,r)&&e.push(zn(o,a,c,r)),o=a;s&&e.push(e[0]),c=r}return e};var ll,ul,cl,hl,dl,fl=[],pl=[];Kn.prototype.prepare=function(){for(var e,t=this.edges,n=t.length;n--;)e=t[n].edge,e.b&&e.a||t.splice(n,1);return t.sort(Zn),t.length},ai.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},si.prototype={insert:function(e,t){var n,i,r;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=hi(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,e=i):(e===n.R&&(ui(this,n),e=n,n=e.U),n.C=!1,i.C=!0,ci(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,e=i):(e===n.L&&(ci(this,n),e=n,n=e.U),n.C=!1,i.C=!0,ui(this,i))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,n,i,r=e.U,o=e.L,a=e.R;if(n=o?a?hi(a):o:a,r?r.L===e?r.L=n:r.R=n:this._=n,o&&a?(i=n.C,n.C=e.C,n.L=o,o.U=n,n!==a?(r=n.U,n.U=e.U,e=n.R,r.L=e,n.R=a,a.U=n):(n.U=r,r=n,e=n.R)):(i=e.C,e=n),e&&(e.U=r),!i){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===r.L){if(t=r.R,t.C&&(t.C=!1,r.C=!0,ui(this,r),t=r.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ci(this,t),t=r.R),t.C=r.C,r.C=t.R.C=!1,ui(this,r),e=this._;break}}else if(t=r.L,t.C&&(t.C=!1,r.C=!0,ci(this,r),t=r.L),t.L&&t.L.C||t.R&&t.R.C){
t.L&&t.L.C||(t.R.C=!1,t.C=!0,ui(this,t),t=r.L),t.C=r.C,r.C=t.L.C=!1,ci(this,r),e=this._;break}t.C=!0,e=r,r=r.U}while(!e.C);e&&(e.C=!1)}}},fa.geom.voronoi=function(e){function t(e){var t=new Array(e.length),i=s[0][0],r=s[0][1],o=s[1][0],a=s[1][1];return di(n(e),s).cells.forEach(function(n,s){var l=n.edges,u=n.site,c=t[s]=l.length?l.map(function(e){var t=e.start();return[t.x,t.y]}):u.x>=i&&u.x<=o&&u.y>=r&&u.y<=a?[[i,a],[o,a],[o,r],[i,r]]:[];c.point=e[s]}),t}function n(e){return e.map(function(e,t){return{x:Math.round(o(e,t)/qa)*qa,y:Math.round(a(e,t)/qa)*qa,i:t}})}var i=Dn,r=In,o=i,a=r,s=_l;return e?t(e):(t.links=function(e){return di(n(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},t.triangles=function(e){var t=[];return di(n(e)).cells.forEach(function(n,i){for(var r,o,a=n.site,s=n.edges.sort(Zn),l=-1,u=s.length,c=s[u-1].edge,h=c.l===a?c.r:c.l;++l<u;)r=c,o=h,c=s[l].edge,h=c.l===a?c.r:c.l,i<o.i&&i<h.i&&pi(a,o,h)<0&&t.push([e[i],e[o.i],e[h.i]])}),t},t.x=function(e){return arguments.length?(o=Re(i=e),t):i},t.y=function(e){return arguments.length?(a=Re(r=e),t):r},t.clipExtent=function(e){return arguments.length?(s=null==e?_l:e,t):s===_l?null:s},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):s===_l?null:s&&s[1]},t)};var _l=[[-1e6,-1e6],[1e6,1e6]];fa.geom.delaunay=function(e){return fa.geom.voronoi().triangles(e)},fa.geom.quadtree=function(e,t,n,i,r){function o(e){function o(e,t,n,i,r,o,a,s){if(!isNaN(n)&&!isNaN(i))if(e.leaf){var l=e.x,c=e.y;if(null!=l)if(ka(l-n)+ka(c-i)<.01)u(e,t,n,i,r,o,a,s);else{var h=e.point;e.x=e.y=e.point=null,u(e,h,l,c,r,o,a,s),u(e,t,n,i,r,o,a,s)}else e.x=n,e.y=i,e.point=t}else u(e,t,n,i,r,o,a,s)}function u(e,t,n,i,r,a,s,l){var u=.5*(r+s),c=.5*(a+l),h=n>=u,d=i>=c,f=d<<1|h;e.leaf=!1,e=e.nodes[f]||(e.nodes[f]=mi()),h?r=u:s=u,d?a=c:l=c,o(e,t,n,i,r,a,s,l)}var c,h,d,f,p,_,g,m,v,y=Re(s),b=Re(l);if(null!=t)_=t,g=n,m=i,v=r;else if(m=v=-(_=g=1/0),h=[],d=[],p=e.length,a)for(f=0;p>f;++f)c=e[f],c.x<_&&(_=c.x),c.y<g&&(g=c.y),c.x>m&&(m=c.x),c.y>v&&(v=c.y),h.push(c.x),d.push(c.y);else for(f=0;p>f;++f){var x=+y(c=e[f],f),w=+b(c,f);_>x&&(_=x),g>w&&(g=w),x>m&&(m=x),w>v&&(v=w),h.push(x),d.push(w)}var S=m-_,A=v-g;S>A?v=g+S:m=_+A;var k=mi();if(k.add=function(e){o(k,e,+y(e,++f),+b(e,f),_,g,m,v)},k.visit=function(e){vi(e,k,_,g,m,v)},k.find=function(e){return yi(k,e[0],e[1],_,g,m,v)},f=-1,null==t){for(;++f<p;)o(k,e[f],h[f],d[f],_,g,m,v);--f}else e.forEach(k.add);return h=d=e=c=null,k}var a,s=Dn,l=In;return(a=arguments.length)?(s=_i,l=gi,3===a&&(r=n,i=t,n=t=0),o(e)):(o.x=function(e){return arguments.length?(s=e,o):s},o.y=function(e){return arguments.length?(l=e,o):l},o.extent=function(e){return arguments.length?(null==e?t=n=i=r=null:(t=+e[0][0],n=+e[0][1],i=+e[1][0],r=+e[1][1]),o):null==t?null:[[t,n],[i,r]]},o.size=function(e){return arguments.length?(null==e?t=n=i=r=null:(t=n=0,i=+e[0],r=+e[1]),o):null==t?null:[i-t,r-n]},o)},fa.interpolateRgb=bi,fa.interpolateObject=xi,fa.interpolateNumber=wi,fa.interpolateString=Si;var gl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ml=new RegExp(gl.source,"g");fa.interpolate=Ai,fa.interpolators=[function(e,t){var n=typeof t;return("string"===n?us.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?bi:Si:t instanceof he?bi:Array.isArray(t)?ki:"object"===n&&isNaN(t)?xi:wi)(e,t)}],fa.interpolateArray=ki;var vl=function(){return S},yl=fa.map({linear:vl,poly:Oi,quad:function(){return Mi},cubic:function(){return Li},sin:function(){return Pi},exp:function(){return Di},circle:function(){return Ii},elastic:Ni,back:Fi,bounce:function(){return Bi}}),bl=fa.map({"in":S,out:Ti,"in-out":Ei,"out-in":function(e){return Ei(Ti(e))}});fa.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.slice(0,t):e,i=t>=0?e.slice(t+1):"in";return n=yl.get(n)||vl,i=bl.get(i)||S,Ci(i(n.apply(null,pa.call(arguments,1))))},fa.interpolateHcl=zi,fa.interpolateHsl=Hi,fa.interpolateLab=qi,fa.interpolateRound=Gi,fa.transform=function(e){var t=ga.createElementNS(fa.ns.prefix.svg,"g");return(fa.transform=function(e){if(null!=e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate()}return new ji(n?n.matrix:xl)})(e)},ji.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var xl={a:1,b:0,c:0,d:1,e:0,f:0};fa.interpolateTransform=Ji,fa.layout={},fa.layout.bundle=function(){return function(e){for(var t=[],n=-1,i=e.length;++n<i;)t.push(tr(e[n]));return t}},fa.layout.chord=function(){function e(){var e,u,h,d,f,p={},_=[],g=fa.range(o),m=[];for(n=[],i=[],e=0,d=-1;++d<o;){for(u=0,f=-1;++f<o;)u+=r[d][f];_.push(u),m.push(fa.range(o)),e+=u}for(a&&g.sort(function(e,t){return a(_[e],_[t])}),s&&m.forEach(function(e,t){e.sort(function(e,n){return s(r[t][e],r[t][n])})}),e=(Ua-c*o)/e,u=0,d=-1;++d<o;){for(h=u,f=-1;++f<o;){var v=g[d],y=m[v][f],b=r[v][y],x=u,w=u+=b*e;p[v+"-"+y]={index:v,subindex:y,startAngle:x,endAngle:w,value:b}}i[v]={index:v,startAngle:h,endAngle:u,value:_[v]},u+=c}for(d=-1;++d<o;)for(f=d-1;++f<o;){var S=p[d+"-"+f],A=p[f+"-"+d];(S.value||A.value)&&n.push(S.value<A.value?{source:A,target:S}:{source:S,target:A})}l&&t()}function t(){n.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n,i,r,o,a,s,l,u={},c=0;return u.matrix=function(e){return arguments.length?(o=(r=e)&&r.length,n=i=null,u):r},u.padding=function(e){return arguments.length?(c=e,n=i=null,u):c},u.sortGroups=function(e){return arguments.length?(a=e,n=i=null,u):a},u.sortSubgroups=function(e){return arguments.length?(s=e,n=null,u):s},u.sortChords=function(e){return arguments.length?(l=e,n&&t(),u):l},u.chords=function(){return n||e(),n},u.groups=function(){return i||e(),i},u},fa.layout.force=function(){function e(e){return function(t,n,i,r){if(t.point!==e){var o=t.cx-e.x,a=t.cy-e.y,s=r-n,l=o*o+a*a;if(l>s*s/m){if(_>l){var u=t.charge/l;e.px-=o*u,e.py-=a*u}return!0}if(t.point&&l&&_>l){var u=t.pointCharge/l;e.px-=o*u,e.py-=a*u}}return!t.charge}}function t(e){e.px=fa.event.x,e.py=fa.event.y,l.resume()}var n,i,r,o,a,s,l={},u=fa.dispatch("start","tick","end"),c=[1,1],h=.9,d=wl,f=Sl,p=-30,_=Al,g=.1,m=.64,v=[],y=[];return l.tick=function(){if((r*=.99)<.005)return n=null,u.end({type:"end",alpha:r=0}),!0;var t,i,l,d,f,_,m,b,x,w=v.length,S=y.length;for(i=0;S>i;++i)l=y[i],d=l.source,f=l.target,b=f.x-d.x,x=f.y-d.y,(_=b*b+x*x)&&(_=r*a[i]*((_=Math.sqrt(_))-o[i])/_,b*=_,x*=_,f.x-=b*(m=d.weight+f.weight?d.weight/(d.weight+f.weight):.5),f.y-=x*m,d.x+=b*(m=1-m),d.y+=x*m);if((m=r*g)&&(b=c[0]/2,x=c[1]/2,i=-1,m))for(;++i<w;)l=v[i],l.x+=(b-l.x)*m,l.y+=(x-l.y)*m;if(p)for(lr(t=fa.geom.quadtree(v),r,s),i=-1;++i<w;)(l=v[i]).fixed||t.visit(e(l));for(i=-1;++i<w;)l=v[i],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*h,l.y-=(l.py-(l.py=l.y))*h);u.tick({type:"tick",alpha:r})},l.nodes=function(e){return arguments.length?(v=e,l):v},l.links=function(e){return arguments.length?(y=e,l):y},l.size=function(e){return arguments.length?(c=e,l):c},l.linkDistance=function(e){return arguments.length?(d="function"==typeof e?e:+e,l):d},l.distance=l.linkDistance,l.linkStrength=function(e){return arguments.length?(f="function"==typeof e?e:+e,l):f},l.friction=function(e){return arguments.length?(h=+e,l):h},l.charge=function(e){return arguments.length?(p="function"==typeof e?e:+e,l):p},l.chargeDistance=function(e){return arguments.length?(_=e*e,l):Math.sqrt(_)},l.gravity=function(e){return arguments.length?(g=+e,l):g},l.theta=function(e){return arguments.length?(m=e*e,l):Math.sqrt(m)},l.alpha=function(e){return arguments.length?(e=+e,r?e>0?r=e:(n.c=null,n.t=NaN,n=null,u.end({type:"end",alpha:r=0})):e>0&&(u.start({type:"start",alpha:r=e}),n=Ne(l.tick)),l):r},l.start=function(){function e(e,i){if(!n){for(n=new Array(r),l=0;r>l;++l)n[l]=[];for(l=0;u>l;++l){var o=y[l];n[o.source.index].push(o.target),n[o.target.index].push(o.source)}}for(var a,s=n[t],l=-1,c=s.length;++l<c;)if(!isNaN(a=s[l][e]))return a;return Math.random()*i}var t,n,i,r=v.length,u=y.length,h=c[0],_=c[1];for(t=0;r>t;++t)(i=v[t]).index=t,i.weight=0;for(t=0;u>t;++t)i=y[t],"number"==typeof i.source&&(i.source=v[i.source]),"number"==typeof i.target&&(i.target=v[i.target]),++i.source.weight,++i.target.weight;for(t=0;r>t;++t)i=v[t],isNaN(i.x)&&(i.x=e("x",h)),isNaN(i.y)&&(i.y=e("y",_)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(o=[],"function"==typeof d)for(t=0;u>t;++t)o[t]=+d.call(this,y[t],t);else for(t=0;u>t;++t)o[t]=d;if(a=[],"function"==typeof f)for(t=0;u>t;++t)a[t]=+f.call(this,y[t],t);else for(t=0;u>t;++t)a[t]=f;if(s=[],"function"==typeof p)for(t=0;r>t;++t)s[t]=+p.call(this,v[t],t);else for(t=0;r>t;++t)s[t]=p;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return i||(i=fa.behavior.drag().origin(S).on("dragstart.force",rr).on("drag.force",t).on("dragend.force",or)),arguments.length?void this.on("mouseover.force",ar).on("mouseout.force",sr).call(i):i},fa.rebind(l,u,"on")};var wl=20,Sl=1,Al=1/0;fa.layout.hierarchy=function(){function e(r){var o,a=[r],s=[];for(r.depth=0;null!=(o=a.pop());)if(s.push(o),(u=n.call(e,o,o.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)a.push(c=u[l]),c.parent=o,c.depth=o.depth+1;i&&(o.value=0),o.children=u}else i&&(o.value=+i.call(e,o,o.depth)||0),delete o.children;return hr(r,function(e){var n,r;t&&(n=e.children)&&n.sort(t),i&&(r=e.parent)&&(r.value+=e.value)}),s}var t=pr,n=dr,i=fr;return e.sort=function(n){return arguments.length?(t=n,e):t},e.children=function(t){return arguments.length?(n=t,e):n},e.value=function(t){return arguments.length?(i=t,e):i},e.revalue=function(t){return i&&(cr(t,function(e){e.children&&(e.value=0)}),hr(t,function(t){var n;t.children||(t.value=+i.call(e,t,t.depth)||0),(n=t.parent)&&(n.value+=t.value)})),t},e},fa.layout.partition=function(){function e(t,n,i,r){var o=t.children;if(t.x=n,t.y=t.depth*r,t.dx=i,t.dy=r,o&&(a=o.length)){var a,s,l,u=-1;for(i=t.value?i/t.value:0;++u<a;)e(s=o[u],n,l=s.value*i,r),n+=l}}function t(e){var n=e.children,i=0;if(n&&(r=n.length))for(var r,o=-1;++o<r;)i=Math.max(i,t(n[o]));return 1+i}function n(n,o){var a=i.call(this,n,o);return e(a[0],0,r[0],r[1]/t(a[0])),a}var i=fa.layout.hierarchy(),r=[1,1];return n.size=function(e){return arguments.length?(r=e,n):r},ur(n,i)},fa.layout.pie=function(){function e(a){var s,l=a.length,u=a.map(function(n,i){return+t.call(e,n,i)}),c=+("function"==typeof i?i.apply(this,arguments):i),h=("function"==typeof r?r.apply(this,arguments):r)-c,d=Math.min(Math.abs(h)/l,+("function"==typeof o?o.apply(this,arguments):o)),f=d*(0>h?-1:1),p=fa.sum(u),_=p?(h-l*f)/p:0,g=fa.range(l),m=[];return null!=n&&g.sort(n===kl?function(e,t){return u[t]-u[e]}:function(e,t){return n(a[e],a[t])}),g.forEach(function(e){m[e]={data:a[e],value:s=u[e],startAngle:c,endAngle:c+=s*_+f,padAngle:d}}),m}var t=Number,n=kl,i=0,r=Ua,o=0;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(i=t,e):i},e.endAngle=function(t){return arguments.length?(r=t,e):r},e.padAngle=function(t){return arguments.length?(o=t,e):o},e};var kl={};fa.layout.stack=function(){function e(s,l){if(!(d=s.length))return s;var u=s.map(function(n,i){return t.call(e,n,i)}),c=u.map(function(t){return t.map(function(t,n){return[o.call(e,t,n),a.call(e,t,n)]})}),h=n.call(e,c,l);u=fa.permute(u,h),c=fa.permute(c,h);var d,f,p,_,g=i.call(e,c,l),m=u[0].length;for(p=0;m>p;++p)for(r.call(e,u[0][p],_=g[p],c[0][p][1]),f=1;d>f;++f)r.call(e,u[f][p],_+=c[f-1][p][1],c[f][p][1]);return s}var t=S,n=yr,i=br,r=vr,o=gr,a=mr;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n="function"==typeof t?t:Cl.get(t)||yr,e):n},e.offset=function(t){return arguments.length?(i="function"==typeof t?t:Tl.get(t)||br,e):i},e.x=function(t){return arguments.length?(o=t,e):o},e.y=function(t){return arguments.length?(a=t,e):a},e.out=function(t){return arguments.length?(r=t,e):r},e};var Cl=fa.map({"inside-out":function(e){var t,n,i=e.length,r=e.map(xr),o=e.map(wr),a=fa.range(i).sort(function(e,t){return r[e]-r[t]}),s=0,l=0,u=[],c=[];for(t=0;i>t;++t)n=a[t],l>s?(s+=o[n],u.push(n)):(l+=o[n],c.push(n));return c.reverse().concat(u)},reverse:function(e){return fa.range(e.length).reverse()},"default":yr}),Tl=fa.map({silhouette:function(e){var t,n,i,r=e.length,o=e[0].length,a=[],s=0,l=[];for(n=0;o>n;++n){for(t=0,i=0;r>t;t++)i+=e[t][n][1];i>s&&(s=i),a.push(i)}for(n=0;o>n;++n)l[n]=(s-a[n])/2;return l},wiggle:function(e){var t,n,i,r,o,a,s,l,u,c=e.length,h=e[0],d=h.length,f=[];for(f[0]=l=u=0,n=1;d>n;++n){for(t=0,r=0;c>t;++t)r+=e[t][n][1];for(t=0,o=0,s=h[n][0]-h[n-1][0];c>t;++t){for(i=0,a=(e[t][n][1]-e[t][n-1][1])/(2*s);t>i;++i)a+=(e[i][n][1]-e[i][n-1][1])/s;o+=a*e[t][n][1]}f[n]=l-=r?o/r*s:0,u>l&&(u=l)}for(n=0;d>n;++n)f[n]-=u;return f},expand:function(e){var t,n,i,r=e.length,o=e[0].length,a=1/r,s=[];for(n=0;o>n;++n){for(t=0,i=0;r>t;t++)i+=e[t][n][1];if(i)for(t=0;r>t;t++)e[t][n][1]/=i;else for(t=0;r>t;t++)e[t][n][1]=a}for(n=0;o>n;++n)s[n]=0;return s},zero:br});fa.layout.histogram=function(){function e(e,o){for(var a,s,l=[],u=e.map(n,this),c=i.call(this,u,o),h=r.call(this,c,u,o),o=-1,d=u.length,f=h.length-1,p=t?1:1/d;++o<f;)a=l[o]=[],a.dx=h[o+1]-(a.x=h[o]),a.y=0;if(f>0)for(o=-1;++o<d;)s=u[o],s>=c[0]&&s<=c[1]&&(a=l[fa.bisect(h,s,1,f)-1],a.y+=p,a.push(e[o]));return l}var t=!0,n=Number,i=Cr,r=Ar;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(i=Re(t),e):i},e.bins=function(t){return arguments.length?(r="number"==typeof t?function(e){return kr(e,t)}:Re(t),e):r},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},fa.layout.pack=function(){function e(e,o){var a=n.call(this,e,o),s=a[0],l=r[0],u=r[1],c=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(s.x=s.y=0,hr(s,function(e){e.r=+c(e.value)}),hr(s,Rr),i){var h=i*(t?1:Math.max(2*s.r/l,2*s.r/u))/2;hr(s,function(e){e.r+=h}),hr(s,Rr),hr(s,function(e){e.r-=h})}return Dr(s,l/2,u/2,t?1:1/Math.max(2*s.r/l,2*s.r/u)),a}var t,n=fa.layout.hierarchy().sort(Tr),i=0,r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},e.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,e):t},e.padding=function(t){return arguments.length?(i=+t,e):i},ur(e,n)},fa.layout.tree=function(){function e(e,r){var c=a.call(this,e,r),h=c[0],d=t(h);if(hr(d,n),d.parent.m=-d.z,cr(d,i),u)cr(h,o);else{var f=h,p=h,_=h;cr(h,function(e){e.x<f.x&&(f=e),e.x>p.x&&(p=e),e.depth>_.depth&&(_=e)});var g=s(f,p)/2-f.x,m=l[0]/(p.x+s(p,f)/2+g),v=l[1]/(_.depth||1);cr(h,function(e){e.x=(e.x+g)*m,e.y=e.depth*v})}return c}function t(e){for(var t,n={A:null,children:[e]},i=[n];null!=(t=i.pop());)for(var r,o=t.children,a=0,s=o.length;s>a;++a)i.push((o[a]=r={_:o[a],parent:t,children:(r=o[a].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=r);return n.children[0]}function n(e){var t=e.children,n=e.parent.children,i=e.i?n[e.i-1]:null;if(t.length){Hr(e);var o=(t[0].z+t[t.length-1].z)/2;i?(e.z=i.z+s(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+s(e._,i._));e.parent.A=r(e,i,e.parent.A||n[0])}function i(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function r(e,t,n){if(t){for(var i,r=e,o=e,a=t,l=r.parent.children[0],u=r.m,c=o.m,h=a.m,d=l.m;a=Br(a),r=Fr(r),a&&r;)l=Fr(l),o=Br(o),o.a=e,i=a.z+h-r.z-u+s(a._,r._),i>0&&(zr(qr(a,e,n),e,i),u+=i,c+=i),h+=a.m,u+=r.m,d+=l.m,c+=o.m;a&&!Br(o)&&(o.t=a,o.m+=h-c),r&&!Fr(l)&&(l.t=r,l.m+=u-d,n=e)}return n}function o(e){e.x*=l[0],e.y=e.depth*l[1]}var a=fa.layout.hierarchy().sort(null).value(null),s=Nr,l=[1,1],u=null;return e.separation=function(t){return arguments.length?(s=t,e):s},e.size=function(t){return arguments.length?(u=null==(l=t)?o:null,e):u?null:l},e.nodeSize=function(t){return arguments.length?(u=null==(l=t)?null:o,e):u?l:null},ur(e,a)},fa.layout.cluster=function(){function e(e,o){var a,s=t.call(this,e,o),l=s[0],u=0;hr(l,function(e){var t=e.children;t&&t.length?(e.x=jr(t),e.y=Gr(t)):(e.x=a?u+=n(e,a):0,e.y=0,a=e)});var c=Ur(l),h=Vr(l),d=c.x-n(c,h)/2,f=h.x+n(h,c)/2;return hr(l,r?function(e){e.x=(e.x-l.x)*i[0],e.y=(l.y-e.y)*i[1]}:function(e){e.x=(e.x-d)/(f-d)*i[0],e.y=(1-(l.y?e.y/l.y:1))*i[1]}),s}var t=fa.layout.hierarchy().sort(null).value(null),n=Nr,i=[1,1],r=!1;return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=null==(i=t),e):r?null:i},e.nodeSize=function(t){return arguments.length?(r=null!=(i=t),e):r?i:null},ur(e,t)},fa.layout.treemap=function(){function e(e,t){for(var n,i,r=-1,o=e.length;++r<o;)i=(n=e[r]).value*(0>t?0:t),n.area=isNaN(i)||0>=i?0:i}function t(n){var o=n.children;if(o&&o.length){var a,s,l,u=h(n),c=[],d=o.slice(),p=1/0,_="slice"===f?u.dx:"dice"===f?u.dy:"slice-dice"===f?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(e(d,u.dx*u.dy/n.value),c.area=0;(l=d.length)>0;)c.push(a=d[l-1]),c.area+=a.area,"squarify"!==f||(s=i(c,_))<=p?(d.pop(),p=s):(c.area-=c.pop().area,r(c,_,u,!1),_=Math.min(u.dx,u.dy),c.length=c.area=0,p=1/0);c.length&&(r(c,_,u,!0),c.length=c.area=0),o.forEach(t)}}function n(t){var i=t.children;if(i&&i.length){var o,a=h(t),s=i.slice(),l=[];for(e(s,a.dx*a.dy/t.value),l.area=0;o=s.pop();)l.push(o),l.area+=o.area,null!=o.z&&(r(l,o.z?a.dx:a.dy,a,!s.length),l.length=l.area=0);i.forEach(n)}}function i(e,t){for(var n,i=e.area,r=0,o=1/0,a=-1,s=e.length;++a<s;)(n=e[a].area)&&(o>n&&(o=n),n>r&&(r=n));return i*=i,t*=t,i?Math.max(t*r*p/i,i/(t*o*p)):1/0}function r(e,t,n,i){var r,o=-1,a=e.length,s=n.x,u=n.y,c=t?l(e.area/t):0;if(t==n.dx){for((i||c>n.dy)&&(c=n.dy);++o<a;)r=e[o],r.x=s,r.y=u,r.dy=c,s+=r.dx=Math.min(n.x+n.dx-s,c?l(r.area/c):0);r.z=!0,r.dx+=n.x+n.dx-s,n.y+=c,n.dy-=c}else{for((i||c>n.dx)&&(c=n.dx);++o<a;)r=e[o],r.x=s,r.y=u,r.dx=c,u+=r.dy=Math.min(n.y+n.dy-u,c?l(r.area/c):0);r.z=!1,r.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function o(i){var r=a||s(i),o=r[0];return o.x=o.y=0,o.value?(o.dx=u[0],o.dy=u[1]):o.dx=o.dy=0,a&&s.revalue(o),e([o],o.dx*o.dy/o.value),(a?n:t)(o),d&&(a=r),r}var a,s=fa.layout.hierarchy(),l=Math.round,u=[1,1],c=null,h=Wr,d=!1,f="squarify",p=.5*(1+Math.sqrt(5));return o.size=function(e){return arguments.length?(u=e,o):u},o.padding=function(e){function t(t){var n=e.call(o,t,t.depth);return null==n?Wr(t):Xr(t,"number"==typeof n?[n,n,n,n]:n)}function n(t){return Xr(t,e)}if(!arguments.length)return c;var i;return h=null==(c=e)?Wr:"function"==(i=typeof e)?t:"number"===i?(e=[e,e,e,e],n):n,o},o.round=function(e){return arguments.length?(l=e?Math.round:Number,o):l!=Number},o.sticky=function(e){return arguments.length?(d=e,a=null,o):d},o.ratio=function(e){return arguments.length?(p=e,o):p},o.mode=function(e){return arguments.length?(f=e+"",o):f},ur(o,s)},fa.random={normal:function(e,t){var n=arguments.length;return 2>n&&(t=1),1>n&&(e=0),function(){var n,i,r;do n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i;while(!r||r>1);return e+t*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var e=fa.random.normal.apply(fa,arguments);return function(){return Math.exp(e())}},bates:function(e){var t=fa.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(e){return function(){for(var t=0,n=0;e>n;n++)t+=Math.random();return t}}},fa.scale={};var El={floor:S,ceil:S};fa.scale.linear=function(){return eo([0,1],[0,1],Ai,!1)};var Ml={s:1,g:1,p:1,r:1,e:1};fa.scale.log=function(){return lo(fa.scale.linear().domain([0,1]),10,!0,[1,10])};var Ll=fa.format(".0e"),Rl={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};fa.scale.pow=function(){return uo(fa.scale.linear(),1,[0,1])},fa.scale.sqrt=function(){return fa.scale.pow().exponent(.5)},fa.scale.ordinal=function(){return ho([],{t:"range",a:[[]]})},fa.scale.category10=function(){return fa.scale.ordinal().range(Ol)},fa.scale.category20=function(){return fa.scale.ordinal().range(Pl)},fa.scale.category20b=function(){return fa.scale.ordinal().range(Dl)},fa.scale.category20c=function(){return fa.scale.ordinal().range(Il)};var Ol=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Ae),Pl=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Ae),Dl=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Ae),Il=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Ae);fa.scale.quantile=function(){return fo([],[])},fa.scale.quantize=function(){return po(0,1,[0,1])},fa.scale.threshold=function(){return _o([.5],[0,1])},fa.scale.identity=function(){return go([0,1])},fa.svg={},fa.svg.arc=function(){function e(){var e=Math.max(0,+n.apply(this,arguments)),u=Math.max(0,+i.apply(this,arguments)),c=a.apply(this,arguments)-Wa,h=s.apply(this,arguments)-Wa,d=Math.abs(h-c),f=c>h?0:1;if(e>u&&(p=u,u=e,e=p),d>=Va)return t(u,f)+(e?t(e,1-f):"")+"Z";var p,_,g,m,v,y,b,x,w,S,A,k,C=0,T=0,E=[];if((m=(+l.apply(this,arguments)||0)/2)&&(g=o===Nl?Math.sqrt(e*e+u*u):+o.apply(this,arguments),f||(T*=-1),u&&(T=ae(g/u*Math.sin(m))),e&&(C=ae(g/e*Math.sin(m)))),u){v=u*Math.cos(c+T),y=u*Math.sin(c+T),b=u*Math.cos(h-T),x=u*Math.sin(h-T);var M=Math.abs(h-c-2*T)<=ja?0:1;if(T&&So(v,y,b,x)===f^M){var L=(c+h)/2;v=u*Math.cos(L),y=u*Math.sin(L),b=x=null}}else v=y=0;if(e){w=e*Math.cos(h-C),S=e*Math.sin(h-C),A=e*Math.cos(c+C),k=e*Math.sin(c+C);var R=Math.abs(c-h+2*C)<=ja?0:1;if(C&&So(w,S,A,k)===1-f^R){var O=(c+h)/2;w=e*Math.cos(O),S=e*Math.sin(O),A=k=null}}else w=S=0;if(d>qa&&(p=Math.min(Math.abs(u-e)/2,+r.apply(this,arguments)))>.001){_=u>e^f?0:1;var P=p,D=p;if(ja>d){var I=null==A?[w,S]:null==b?[v,y]:zn([v,y],[A,k],[b,x],[w,S]),N=v-I[0],F=y-I[1],B=b-I[0],z=x-I[1],H=1/Math.sin(Math.acos((N*B+F*z)/(Math.sqrt(N*N+F*F)*Math.sqrt(B*B+z*z)))/2),q=Math.sqrt(I[0]*I[0]+I[1]*I[1]);D=Math.min(p,(e-q)/(H-1)),P=Math.min(p,(u-q)/(H+1))}if(null!=b){var G=Ao(null==A?[w,S]:[A,k],[v,y],u,P,f),j=Ao([b,x],[w,S],u,P,f);p===P?E.push("M",G[0],"A",P,",",P," 0 0,",_," ",G[1],"A",u,",",u," 0 ",1-f^So(G[1][0],G[1][1],j[1][0],j[1][1]),",",f," ",j[1],"A",P,",",P," 0 0,",_," ",j[0]):E.push("M",G[0],"A",P,",",P," 0 1,",_," ",j[0])}else E.push("M",v,",",y);if(null!=A){var U=Ao([v,y],[A,k],e,-D,f),V=Ao([w,S],null==b?[v,y]:[b,x],e,-D,f);p===D?E.push("L",V[0],"A",D,",",D," 0 0,",_," ",V[1],"A",e,",",e," 0 ",f^So(V[1][0],V[1][1],U[1][0],U[1][1]),",",1-f," ",U[1],"A",D,",",D," 0 0,",_," ",U[0]):E.push("L",V[0],"A",D,",",D," 0 0,",_," ",U[0])}else E.push("L",w,",",S)}else E.push("M",v,",",y),null!=b&&E.push("A",u,",",u," 0 ",M,",",f," ",b,",",x),E.push("L",w,",",S),null!=A&&E.push("A",e,",",e," 0 ",R,",",1-f," ",A,",",k);return E.push("Z"),E.join("")}function t(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}var n=vo,i=yo,r=mo,o=Nl,a=bo,s=xo,l=wo;return e.innerRadius=function(t){return arguments.length?(n=Re(t),e):n},e.outerRadius=function(t){return arguments.length?(i=Re(t),e):i},e.cornerRadius=function(t){return arguments.length?(r=Re(t),e):r},e.padRadius=function(t){return arguments.length?(o=t==Nl?Nl:Re(t),e):o},e.startAngle=function(t){return arguments.length?(a=Re(t),e):a},e.endAngle=function(t){return arguments.length?(s=Re(t),e):s},e.padAngle=function(t){return arguments.length?(l=Re(t),e):l},e.centroid=function(){var e=(+n.apply(this,arguments)+ +i.apply(this,arguments))/2,t=(+a.apply(this,arguments)+ +s.apply(this,arguments))/2-Wa;return[Math.cos(t)*e,Math.sin(t)*e]},e};var Nl="auto";fa.svg.line=function(){return ko(S)};var Fl=fa.map({linear:Co,"linear-closed":To,step:Eo,"step-before":Mo,"step-after":Lo,basis:No,"basis-open":Fo,"basis-closed":Bo,bundle:zo,cardinal:Po,"cardinal-open":Ro,"cardinal-closed":Oo,monotone:Vo});Fl.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var Bl=[0,2/3,1/3,0],zl=[0,1/3,2/3,0],Hl=[0,1/6,2/3,1/6];fa.svg.line.radial=function(){var e=ko(Wo);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},Mo.reverse=Lo,Lo.reverse=Mo,fa.svg.area=function(){return Xo(S)},fa.svg.area.radial=function(){var e=Xo(Wo);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},fa.svg.chord=function(){function e(e,s){var l=t(this,o,e,s),u=t(this,a,e,s);return"M"+l.p0+i(l.r,l.p1,l.a1-l.a0)+(n(l,u)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,u.r,u.p0)+i(u.r,u.p1,u.a1-u.a0)+r(u.r,u.p1,l.r,l.p0))+"Z"}function t(e,t,n,i){var r=t.call(e,n,i),o=s.call(e,r,i),a=l.call(e,r,i)-Wa,c=u.call(e,r,i)-Wa;return{r:o,a0:a,a1:c,p0:[o*Math.cos(a),o*Math.sin(a)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function i(e,t,n){return"A"+e+","+e+" 0 "+ +(n>ja)+",1 "+t}function r(e,t,n,i){return"Q 0,0 "+i}var o=An,a=kn,s=Ko,l=bo,u=xo;return e.radius=function(t){return arguments.length?(s=Re(t),e):s},e.source=function(t){return arguments.length?(o=Re(t),e):o},e.target=function(t){return arguments.length?(a=Re(t),e):a},e.startAngle=function(t){return arguments.length?(l=Re(t),e):l},e.endAngle=function(t){return arguments.length?(u=Re(t),e):u},e},fa.svg.diagonal=function(){function e(e,r){var o=t.call(this,e,r),a=n.call(this,e,r),s=(o.y+a.y)/2,l=[o,{x:o.x,y:s},{x:a.x,y:s},a];return l=l.map(i),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var t=An,n=kn,i=Yo;return e.source=function(n){return arguments.length?(t=Re(n),e):t},e.target=function(t){return arguments.length?(n=Re(t),e):n},e.projection=function(t){return arguments.length?(i=t,e):i},e},fa.svg.diagonal.radial=function(){var e=fa.svg.diagonal(),t=Yo,n=e.projection;return e.projection=function(e){return arguments.length?n(Zo(t=e)):t},e},fa.svg.symbol=function(){function e(e,i){return(ql.get(t.call(this,e,i))||Qo)(n.call(this,e,i))}var t=Jo,n=$o;return e.type=function(n){return arguments.length?(t=Re(n),e):t},e.size=function(t){return arguments.length?(n=Re(t),e):n},e};var ql=fa.map({circle:Qo,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*jl)),n=t*jl;return"M0,"+-t+"L"+n+",0 0,"+t+" "+-n+",0Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Gl),n=t*Gl/2;return"M0,"+n+"L"+t+","+-n+" "+-t+","+-n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Gl),n=t*Gl/2;return"M0,"+-n+"L"+t+","+n+" "+-t+","+n+"Z"}});fa.svg.symbolTypes=ql.keys();var Gl=Math.sqrt(3),jl=Math.tan(30*Xa);Da.transition=function(e){for(var t,n,i=Ul||++Kl,r=ra(e),o=[],a=Vl||{time:Date.now(),ease:Ri,delay:0,duration:250},s=-1,l=this.length;++s<l;){o.push(t=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(n=u[c])&&oa(n,c,r,i,a),t.push(n)}return ta(o,r,i)},Da.interrupt=function(e){return this.each(null==e?Wl:ea(ra(e)))};var Ul,Vl,Wl=ea(ra()),Xl=[],Kl=0;Xl.call=Da.call,Xl.empty=Da.empty,Xl.node=Da.node,Xl.size=Da.size,fa.transition=function(e,t){return e&&e.transition?Ul?e.transition(t):e:fa.selection().transition(e)},fa.transition.prototype=Xl,Xl.select=function(e){var t,n,i,r=this.id,o=this.namespace,a=[];e=P(e);for(var s=-1,l=this.length;++s<l;){a.push(t=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(i=u[c])&&(n=e.call(i,i.__data__,c,s))?("__data__"in i&&(n.__data__=i.__data__),oa(n,c,o,r,i[o][r]),t.push(n)):t.push(null)}return ta(a,o,r)},Xl.selectAll=function(e){var t,n,i,r,o,a=this.id,s=this.namespace,l=[];e=D(e);for(var u=-1,c=this.length;++u<c;)for(var h=this[u],d=-1,f=h.length;++d<f;)if(i=h[d]){o=i[s][a],n=e.call(i,i.__data__,d,u),l.push(t=[]);for(var p=-1,_=n.length;++p<_;)(r=n[p])&&oa(r,p,s,a,o),t.push(r)}return ta(l,s,a)},Xl.filter=function(e){var t,n,i,r=[];"function"!=typeof e&&(e=W(e));for(var o=0,a=this.length;a>o;o++){r.push(t=[]);for(var n=this[o],s=0,l=n.length;l>s;s++)(i=n[s])&&e.call(i,i.__data__,s,o)&&t.push(i)}return ta(r,this.namespace,this.id)},Xl.tween=function(e,t){var n=this.id,i=this.namespace;return arguments.length<2?this.node()[i][n].tween.get(e):K(this,null==t?function(t){t[i][n].tween.remove(e)}:function(r){r[i][n].tween.set(e,t)})},Xl.attr=function(e,t){function n(){this.removeAttribute(s)}function i(){this.removeAttributeNS(s.space,s.local)}function r(e){return null==e?n:(e+="",function(){var t,n=this.getAttribute(s);return n!==e&&(t=a(n,e),function(e){this.setAttribute(s,t(e))})})}function o(e){return null==e?i:(e+="",function(){var t,n=this.getAttributeNS(s.space,s.local);return n!==e&&(t=a(n,e),function(e){this.setAttributeNS(s.space,s.local,t(e))})})}if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var a="transform"==e?Ji:Ai,s=fa.ns.qualify(e);return na(this,"attr."+e,t,s.local?o:r)},Xl.attrTween=function(e,t){function n(e,n){var i=t.call(this,e,n,this.getAttribute(r));return i&&function(e){this.setAttribute(r,i(e))}}function i(e,n){var i=t.call(this,e,n,this.getAttributeNS(r.space,r.local));return i&&function(e){this.setAttributeNS(r.space,r.local,i(e))}}var r=fa.ns.qualify(e);return this.tween("attr."+e,r.local?i:n)},Xl.style=function(e,t,n){function i(){this.style.removeProperty(e)}function r(t){return null==t?i:(t+="",function(){var i,r=a(this).getComputedStyle(this,null).getPropertyValue(e);return r!==t&&(i=Ai(r,t),function(t){this.style.setProperty(e,i(t),n)})})}var o=arguments.length;if(3>o){if("string"!=typeof e){2>o&&(t="");for(n in e)this.style(n,e[n],t);return this}n=""}return na(this,"style."+e,t,r)},Xl.styleTween=function(e,t,n){function i(i,r){var o=t.call(this,i,r,a(this).getComputedStyle(this,null).getPropertyValue(e));return o&&function(t){this.style.setProperty(e,o(t),n)}}return arguments.length<3&&(n=""),this.tween("style."+e,i)},Xl.text=function(e){return na(this,"text",e,ia)},Xl.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;this[e].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Xl.ease=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].ease:("function"!=typeof e&&(e=fa.ease.apply(fa,arguments)),K(this,function(i){i[n][t].ease=e}))},Xl.delay=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].delay:K(this,"function"==typeof e?function(i,r,o){i[n][t].delay=+e.call(i,i.__data__,r,o)}:(e=+e,function(i){i[n][t].delay=e}))},Xl.duration=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].duration:K(this,"function"==typeof e?function(i,r,o){i[n][t].duration=Math.max(1,e.call(i,i.__data__,r,o))}:(e=Math.max(1,e),function(i){i[n][t].duration=e}))},Xl.each=function(e,t){var n=this.id,i=this.namespace;if(arguments.length<2){var r=Vl,o=Ul;try{Ul=n,K(this,function(t,r,o){Vl=t[i][n],e.call(t,t.__data__,r,o)})}finally{Vl=r,Ul=o}}else K(this,function(r){var o=r[i][n];(o.event||(o.event=fa.dispatch("start","end","interrupt"))).on(e,t)});return this},Xl.transition=function(){for(var e,t,n,i,r=this.id,o=++Kl,a=this.namespace,s=[],l=0,u=this.length;u>l;l++){s.push(e=[]);for(var t=this[l],c=0,h=t.length;h>c;c++)(n=t[c])&&(i=n[a][r],oa(n,c,a,o,{time:i.time,ease:i.ease,delay:i.delay+i.duration,duration:i.duration})),e.push(n)}return ta(s,a,o)},fa.svg.axis=function(){function e(e){e.each(function(){var e,u=fa.select(this),c=this.__chart__||n,h=this.__chart__=n.copy(),d=null==l?h.ticks?h.ticks.apply(h,s):h.domain():l,f=null==t?h.tickFormat?h.tickFormat.apply(h,s):S:t,p=u.selectAll(".tick").data(d,h),_=p.enter().insert("g",".domain").attr("class","tick").style("opacity",qa),g=fa.transition(p.exit()).style("opacity",qa).remove(),m=fa.transition(p.order()).style("opacity",1),v=Math.max(r,0)+a,y=Yr(h),b=u.selectAll(".domain").data([0]),x=(b.enter().append("path").attr("class","domain"),fa.transition(b));_.append("line"),_.append("text");var w,A,k,C,T=_.select("line"),E=m.select("line"),M=p.select("text").text(f),L=_.select("text"),R=m.select("text"),O="top"===i||"left"===i?-1:1;
if("bottom"===i||"top"===i?(e=aa,w="x",k="y",A="x2",C="y2",M.attr("dy",0>O?"0em":".71em").style("text-anchor","middle"),x.attr("d","M"+y[0]+","+O*o+"V0H"+y[1]+"V"+O*o)):(e=sa,w="y",k="x",A="y2",C="x2",M.attr("dy",".32em").style("text-anchor",0>O?"end":"start"),x.attr("d","M"+O*o+","+y[0]+"H0V"+y[1]+"H"+O*o)),T.attr(C,O*r),L.attr(k,O*v),E.attr(A,0).attr(C,O*r),R.attr(w,0).attr(k,O*v),h.rangeBand){var P=h,D=P.rangeBand()/2;c=h=function(e){return P(e)+D}}else c.rangeBand?c=h:g.call(e,h,c);_.call(e,c,h),m.call(e,h,h)})}var t,n=fa.scale.linear(),i=Yl,r=6,o=6,a=3,s=[10],l=null;return e.scale=function(t){return arguments.length?(n=t,e):n},e.orient=function(t){return arguments.length?(i=t in Zl?t+"":Yl,e):i},e.ticks=function(){return arguments.length?(s=_a(arguments),e):s},e.tickValues=function(t){return arguments.length?(l=t,e):l},e.tickFormat=function(n){return arguments.length?(t=n,e):t},e.tickSize=function(t){var n=arguments.length;return n?(r=+t,o=+arguments[n-1],e):r},e.innerTickSize=function(t){return arguments.length?(r=+t,e):r},e.outerTickSize=function(t){return arguments.length?(o=+t,e):o},e.tickPadding=function(t){return arguments.length?(a=+t,e):a},e.tickSubdivide=function(){return arguments.length&&e},e};var Yl="bottom",Zl={top:1,right:1,bottom:1,left:1};fa.svg.brush=function(){function e(o){o.each(function(){var o=fa.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",r).on("touchstart.brush",r),a=o.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),o.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=o.selectAll(".resize").data(_,S);s.exit().remove(),s.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return $l[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",e.empty()?"none":null);var l,h=fa.transition(o),d=fa.transition(a);u&&(l=Yr(u),d.attr("x",l[0]).attr("width",l[1]-l[0]),n(h)),c&&(l=Yr(c),d.attr("y",l[0]).attr("height",l[1]-l[0]),i(h)),t(h)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+h[+/e$/.test(e)]+","+d[+/^s/.test(e)]+")"})}function n(e){e.select(".extent").attr("x",h[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1]-h[0])}function i(e){e.select(".extent").attr("y",d[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function r(){function r(){32==fa.event.keyCode&&(E||(y=null,R[0]-=h[1],R[1]-=d[1],E=2),M())}function _(){32==fa.event.keyCode&&2==E&&(R[0]+=h[1],R[1]+=d[1],E=0,M())}function g(){var e=fa.mouse(x),r=!1;b&&(e[0]+=b[0],e[1]+=b[1]),E||(fa.event.altKey?(y||(y=[(h[0]+h[1])/2,(d[0]+d[1])/2]),R[0]=h[+(e[0]<y[0])],R[1]=d[+(e[1]<y[1])]):y=null),C&&m(e,u,0)&&(n(A),r=!0),T&&m(e,c,1)&&(i(A),r=!0),r&&(t(A),S({type:"brush",mode:E?"move":"resize"}))}function m(e,t,n){var i,r,a=Yr(t),l=a[0],u=a[1],c=R[n],_=n?d:h,g=_[1]-_[0];return E&&(l-=c,u-=g+c),i=(n?p:f)?Math.max(l,Math.min(u,e[n])):e[n],E?r=(i+=c)+g:(y&&(c=Math.max(l,Math.min(u,2*y[n]-i))),i>c?(r=i,i=c):r=c),_[0]!=i||_[1]!=r?(n?s=null:o=null,_[0]=i,_[1]=r,!0):void 0}function v(){g(),A.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),fa.select("body").style("cursor",null),O.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),L(),S({type:"brushend"})}var y,b,x=this,w=fa.select(fa.event.target),S=l.of(x,arguments),A=fa.select(x),k=w.datum(),C=!/^(n|s)$/.test(k)&&u,T=!/^(e|w)$/.test(k)&&c,E=w.classed("extent"),L=ee(x),R=fa.mouse(x),O=fa.select(a(x)).on("keydown.brush",r).on("keyup.brush",_);if(fa.event.changedTouches?O.on("touchmove.brush",g).on("touchend.brush",v):O.on("mousemove.brush",g).on("mouseup.brush",v),A.interrupt().selectAll("*").interrupt(),E)R[0]=h[0]-R[0],R[1]=d[0]-R[1];else if(k){var P=+/w$/.test(k),D=+/^n/.test(k);b=[h[1-P]-R[0],d[1-D]-R[1]],R[0]=h[P],R[1]=d[D]}else fa.event.altKey&&(y=R.slice());A.style("pointer-events","none").selectAll(".resize").style("display",null),fa.select("body").style("cursor",w.style("cursor")),S({type:"brushstart"}),g()}var o,s,l=R(e,"brushstart","brush","brushend"),u=null,c=null,h=[0,0],d=[0,0],f=!0,p=!0,_=Jl[0];return e.event=function(e){e.each(function(){var e=l.of(this,arguments),t={x:h,y:d,i:o,j:s},n=this.__chart__||t;this.__chart__=t,Ul?fa.select(this).transition().each("start.brush",function(){o=n.i,s=n.j,h=n.x,d=n.y,e({type:"brushstart"})}).tween("brush:brush",function(){var n=ki(h,t.x),i=ki(d,t.y);return o=s=null,function(r){h=t.x=n(r),d=t.y=i(r),e({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=t.i,s=t.j,e({type:"brush",mode:"resize"}),e({type:"brushend"})}):(e({type:"brushstart"}),e({type:"brush",mode:"resize"}),e({type:"brushend"}))})},e.x=function(t){return arguments.length?(u=t,_=Jl[!u<<1|!c],e):u},e.y=function(t){return arguments.length?(c=t,_=Jl[!u<<1|!c],e):c},e.clamp=function(t){return arguments.length?(u&&c?(f=!!t[0],p=!!t[1]):u?f=!!t:c&&(p=!!t),e):u&&c?[f,p]:u?f:c?p:null},e.extent=function(t){var n,i,r,a,l;return arguments.length?(u&&(n=t[0],i=t[1],c&&(n=n[0],i=i[0]),o=[n,i],u.invert&&(n=u(n),i=u(i)),n>i&&(l=n,n=i,i=l),(n!=h[0]||i!=h[1])&&(h=[n,i])),c&&(r=t[0],a=t[1],u&&(r=r[1],a=a[1]),s=[r,a],c.invert&&(r=c(r),a=c(a)),r>a&&(l=r,r=a,a=l),(r!=d[0]||a!=d[1])&&(d=[r,a])),e):(u&&(o?(n=o[0],i=o[1]):(n=h[0],i=h[1],u.invert&&(n=u.invert(n),i=u.invert(i)),n>i&&(l=n,n=i,i=l))),c&&(s?(r=s[0],a=s[1]):(r=d[0],a=d[1],c.invert&&(r=c.invert(r),a=c.invert(a)),r>a&&(l=r,r=a,a=l))),u&&c?[[n,r],[i,a]]:u?[n,i]:c&&[r,a])},e.clear=function(){return e.empty()||(h=[0,0],d=[0,0],o=s=null),e},e.empty=function(){return!!u&&h[0]==h[1]||!!c&&d[0]==d[1]},fa.rebind(e,l,"on")};var $l={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Jl=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ql=vs.format=As.timeFormat,eu=Ql.utc,tu=eu("%Y-%m-%dT%H:%M:%S.%LZ");Ql.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?la:tu,la.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},la.toString=tu.toString,vs.second=Ve(function(e){return new ys(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*Math.floor(t))},function(e){return e.getSeconds()}),vs.seconds=vs.second.range,vs.seconds.utc=vs.second.utc.range,vs.minute=Ve(function(e){return new ys(6e4*Math.floor(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*Math.floor(t))},function(e){return e.getMinutes()}),vs.minutes=vs.minute.range,vs.minutes.utc=vs.minute.utc.range,vs.hour=Ve(function(e){var t=e.getTimezoneOffset()/60;return new ys(36e5*(Math.floor(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*Math.floor(t))},function(e){return e.getHours()}),vs.hours=vs.hour.range,vs.hours.utc=vs.hour.utc.range,vs.month=Ve(function(e){return e=vs.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),vs.months=vs.month.range,vs.months.utc=vs.month.utc.range;var nu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],iu=[[vs.second,1],[vs.second,5],[vs.second,15],[vs.second,30],[vs.minute,1],[vs.minute,5],[vs.minute,15],[vs.minute,30],[vs.hour,1],[vs.hour,3],[vs.hour,6],[vs.hour,12],[vs.day,1],[vs.day,2],[vs.week,1],[vs.month,1],[vs.month,3],[vs.year,1]],ru=Ql.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",Dt]]),ou={range:function(e,t,n){return fa.range(Math.ceil(e/n)*n,+t,n).map(ca)},floor:S,ceil:S};iu.year=vs.year,vs.scale=function(){return ua(fa.scale.linear(),iu,ru)};var au=iu.map(function(e){return[e[0].utc,e[1]]}),su=eu.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",Dt]]);au.year=vs.year.utc,vs.scale.utc=function(){return ua(fa.scale.linear(),au,su)},fa.text=Oe(function(e){return e.responseText}),fa.json=function(e,t){return Pe(e,"application/json",ha,t)},fa.html=function(e,t){return Pe(e,"text/html",da,t)},fa.xml=Oe(function(e){return e.responseXML}),this.d3=fa,i=fa,r="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==r&&(e.exports=r))}()},function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){return Object.assign({},e,{type:t})}function a(e){return o({view:e},Y)}function s(e){return o({view:e},K)}function l(e,t,n){return se(e)?t[Y](e,e.view):le(e)?t[K](e,e.view):ue(e)?t[Z](e,e):he(e)?t[J](e):(0,V.isPlainObject)(e)?t[$](e):n(e)}function u(e){throw Error("Unrecognized node type in model: "+e)}function c(e,t){return t.reduce(function(e,t){if(null===e)return null;switch(t[0]){case ee:return t[1]===e[e.length-1]?e.slice(0,-1):null;case te:return[].concat(r(e),[t[1]]);default:throw Error("Unrecognized relative address key: "+t)}},e)}function h(e,t){return[].concat(r(e),[t])}function d(e,t){return o({action:e,relativeAddress:t},Q)}function f(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return(0,V.reverse)(e.map(function(e){return[ee,e]})).concat(t)}function p(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return t.concat(e.map(function(e){return[te,e]}))}function _(e,t,n,i,r){var o=(0,V.reduce)(i(e,function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];var o=t.apply(void 0,[e].concat(i));return[o,o===e]}),function(e,t,n){var i=U(e,2),o=i[0],a=i[1],s=U(t,2),l=s[0],u=s[1];return[r(o,l,n),a&&u]},[n,!0]),a=U(o,2),s=a[0],l=a[1];return l?e:s}function g(e,t){return _(e,t,[],V.map,function(e,t,n){return[].concat(r(e),[t])})}function m(e,t){return _(e,t,{},V.mapValues,function(e,t,n){return Object.assign(e,i({},n,t))})}function v(e,t,n,r){if(he(e)){var o;return l(t,(o={},i(o,Y,de(e)),i(o,K,function(t,i){return g(e,function(e,t){var o=h(n,t),a=r(i,e,o);return v(a,i.model,o,r)})}),i(o,Z,function(t,i){var o=r(i,e,n);return v(o,i.model,n,r)}),i(o,$,de(e)),i(o,J,function(t){return g(e,function(e,i){var o=(0,V.get)(t,i,null);return v(e,o,h(n,i),r)})}),o),(0,V.constant)(e))}if((0,V.isPlainObject)(e)){var a;return l(t,(a={},i(a,Y,function(t,i){return m(e,function(e,t){var o=h(n,t),a=r(i,e,o);return v(a,i.model,o,r)})}),i(a,K,de(e)),i(a,Z,function(t,i){var o=r(i,e,n);return v(o,i.model,n,r)}),i(a,$,function(t){return m(e,function(e,i){return v(e,(0,V.get)(t,i,null),h(n,i),r)})}),i(a,J,de(e)),a),(0,V.constant)(e))}return e}function y(e){return function(t,n){return v(t,e,[],function(e,t,i){if(n[W]||(0,V.isEqual)(n.address,i)){var r=e.reducer(t,n);return r}return t})}}function b(e,t,n){var i=(0,V.mapValues)(e.actionCreators,function(e){return[t,e]});return(0,V.mergeWith)(n,i,function(e,t){return e?[].concat(r(e),[t]):[t]})}function x(e){var t,n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return l(e,(t={},i(t,Y,function(e,t){var i=h(n,":"),o=b(t,i,r);return x(t.model,i,o)}),i(t,K,function(e,t){var i=h(n,":"),o=b(t,i,r);return x(t.model,i,o)}),i(t,Z,function(e,t){var i=b(t,n,r);return x(t.model,n,i)}),i(t,$,function(e){return Object.keys(e).reduce(function(t,i){return x(e[i],h(n,i),t)},r)}),i(t,J,function(e){return e.reduce(function(e,t,i){return x(t,h(n,i),e)},r)}),t),u)}function w(e,t){return(0,V.isEqualWith)(e,t,function(e,t){return":"===e?!0:void 0})}function S(e,t){return function(){var n=t.apply(void 0,arguments);return(0,V.isPlainObject)(n)?Object.assign({},n,{address:e}):n}}function A(e,t){return(0,V.mapValues)(t,(0,V.curry)(S)(e))}function k(e,t,n){var i=c(t,n.relativeAddress),r=(0,V.get)(e,n.action,[]).filter(function(e){return w(e[0],i)}).map(function(e){return e[1]});return(0,V.get)(r,0,null)}function C(e,t){var n=x(e),i=(0,V.curry)(k)(n);return function(e){return function(n){return O(t,S(c(e,n.relativeAddress),i(e,n)))}}}function T(e,t){var n=(0,V.mapValues)(e,function(e){var n=e.filter(function(e){return w(e[0],t)}).map(function(e){return e[1]});return(0,V.get)(n,0,null)});return(0,V.omitBy)(n,function(e){return null===e})}function E(e,t){var n=x(e),i=(0,V.curry)(T)(n);return function(e){return P(t,A(e,i(e)))}}function M(e,t,n,r){var o;return l(e,(o={},i(o,Y,function(e,i){var o=function(e,t){return(0,V.isPlainObject)(e)&&t in e&&null!==e[t]},a=Object.assign({},t||{},n||{});return(0,V.mapValues)(a,function(e,a){var s=M(i.model,(0,V.get)(t,a,null),(0,V.get)(n,a,null),h(r,a));return s[ne]=o(t,a)&&!o(n,a),s[ie]=o(t,a)&&(!o(n,a)||t[a]!==n[a]),s[re]=!o(t,a)&&o(n,a),s})}),i(o,K,function(e,i){var o=function(e,t){return he(e)&&t<e.length&&null!==e[t]},a=Math.max(he(t)?t.length:0,he(n)?n.length:0),s=Array.apply(null,{length:a});return s.map(function(e,a){var s=M(i.model,(0,V.get)(t,a,null),(0,V.get)(n,a,null),h(r,a));return s[ne]=o(t,a)&&!o(n,a),s[ie]=o(t,a)&&(!o(n,a)||t[a]!==n[a]),s[re]=!o(t,a)&&o(n,a),(0,V.isEqual)(h(r,a),["cells",0]),s})}),i(o,Z,function(e,i){var o=function(e){return null!==e},a=M(i.model,t||null,n||null,r);return a[ne]=o(t)&&!o(n),a[ie]=o(t)&&(!o(n)||t!==n),a[re]=!o(t)&&o(n),a}),i(o,J,function(i){return e.map(function(e,i){return M(e,(0,V.get)(t,i,null),(0,V.get)(n,i,null),h(r,i))})}),i(o,$,function(i){return(0,V.mapValues)(e,function(e,i){return M(e,(0,V.get)(t,i,null),(0,V.get)(n,i,null),h(r,i))})}),o),u)}function L(e,t,n,i,r,o,a,s,l,u){var c=P(u,A(r,e.actionCreators)),h=l(r);return s?(e.destroy(n,i,t,c,h),null):(o&&e.create(n,i,t,c,h),a?e.update(n,i,t,c,h):null)}function R(e,t,n,r,o,a,s){var c,d=arguments.length<=7||void 0===arguments[7]?[]:arguments[7];return l(e,(c={},i(c,Y,function(e,i){(0,V.mapValues)(n,function(e,n){var l=h(d,n),u=t[n],c=L(i,o[n],u,r,l,e[ne],e[ie],e[re],a,s);c&&R(i.model,u,e,r,c,a,s,l)})}),i(c,K,function(e,i){n.map(function(e,n){var l=h(d,n),u=t[n],c=L(i,o[n],u,r,l,e[ne],e[ie],e[re],a,s);c&&R(i.model,u,e,r,c,a,s,l)})}),i(c,Z,function(e,i){var l=t,u=n,c=L(i,o,t,r,d,u[ne],u[ie],u[re],a,s);c&&R(i.model,l,u,r,c,a,s,d)}),i(c,J,function(e){e.map(function(e,i){R(e,t[i],n[i],r,o[i],a,s,h(d,i))})}),i(c,$,function(e){(0,V.mapValues)(e,function(e,i){R(e,t[i],n[i],r,o[i],a,s,h(d,i))})}),c),u)}function O(e,t){return(0,V.flowRight)(e,t)}function P(e,t){return(0,V.mapValues)(t,(0,V.curry)(O)(e))}function D(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.name,n=void 0===t?"":t,i=e.model,r=void 0===i?{}:i,a=e.init,s=void 0===a?(0,V.constant)({}):a,l=e.getReducer,u=void 0===l?(0,V.constant)((0,V.nthArg)(0)):l,c=e.actionCreators,h=void 0===c?(0,V.constant)({}):c,d=e.create,f=void 0===d?V.noop:d,p=e.update,_=void 0===p?(0,V.constant)({}):p,g=e.destroy,m=void 0===g?V.noop:g,v=e.getAPI,y=void 0===v?(0,V.constant)({}):v;return(0,V.mapValues)(e,function(e,t){(0,V.includes)(["name","model","init","getReducer","actionCreators","create","update","destroy","getAPI"],t)||console.error("Unexpected argument "+t)}),o({name:n,model:r,init:s,reducer:u(r),actionCreators:h,create:f,update:_,destroy:m,getAPI:y},Z)}function I(e,t,n){var i=arguments.length<=3||void 0===arguments[3]?null:arguments[3],r=e,o=y(r),a=function(e,t){var n=(0,V.get)(e,"userState",null),i=t.type===X?t.state:o(n,t),a=M(r,i,n,[]);return{tinierState:a,userState:i}},s=n(a),l=C(r,s.dispatch),u=function(){var e=s.getState(),n=e.tinierState,i=e.userState;R(r,i,n,i,t,l,s.dispatch)};s.subscribe(u);var c=i||e.init(),h=function(e){return{type:X,state:e}};s.dispatch(h(c));var d=[],f=P(s.dispatch,A(d,e.actionCreators));return e.getAPI(f,l(d))}function N(e,t,n){return he(t)&&0===t.length?e:(0,V.get)(e,t,n)}function F(e,t){var n=t().userState,i=N(n,e,null);return null===i&&console.warn("Could not find local state at address "+e),[i,n]}function B(e){return function(t){var n=t.dispatch,i=t.getState,o=E(e,n);return function(e){return function(t){return ce(t)?t.exec.apply(t,[o(t.address)].concat(r(F(t.address,i)))):e(t)}}}}function z(e){return function(t,n){return e.hasOwnProperty(n.type)?e[n.type](t,n):t}}function H(e,t){return function(n){var i=e(n);return o({type:t,exec:i},oe)}}function q(e){return(0,V.mapValues)(e,H)}function G(e){return function(t){return{type:e,payload:t}}}function j(e){return(0,V.zipObject)(e,e.map(G))}var U=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(l){r=!0,o=l}finally{try{!i&&s["return"]&&s["return"]()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(t,"__esModule",{value:!0}),t.GLOBAL_ACTION=void 0,t.objectOf=a,t.arrayOf=s,t.addressAction=d,t.addressRelFrom=f,t.addressRelTo=p,t.mapOrIdentity=g,t.mapValuesOrIdentity=m,t.mapState=v,t.createView=D,t.run=I,t.createMiddleware=B,t.createReducer=z,t.createAsyncActionCreator=H,t.createAsyncActionCreators=q,t.createActionCreator=G,t.createActionCreators=j;var V=n(233),W=t.GLOBAL_ACTION="@TINIER_GLOBAL_ACTION",X="@TINIER_UPDATE_STATE",K="@TINIER_ARRAY_OF",Y="@TINIER_OBJECT_OF",Z="@TINIER_VIEW",$="@TINIER_PLAIN_OBJECT",J="@TINIER_PLAIN_ARRAY",Q="@TINIER_ADDRESSED_ACTION",ee="@TINIER_ADDRESS_UP",te="@TINIER_ADDRESS_DOWN",ne="@TINIER_NEEDS_CREATE",ie="@TINIER_NEEDS_UPDATE",re="@TINIER_NEEDS_DESTROY",oe="@TINIER_ACTION",ae=(0,V.curry)(function(e,t){return(0,V.get)(t,"type",null)===e}),se=ae(Y),le=ae(K),ue=ae(Z),ce=ae(oe),he=Array.isArray,de=(0,V.curry)(function(e,t){throw Error("Content shape does not match state shape: "+t+" <-> Array "+e)})},function(e,t,n){var i;(function(e,r){(function(){function o(e,t){return e.set(t[0],t[1]),e}function a(e,t){return e.add(t),e}function s(e,t,n){var i=n.length;switch(i){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function l(e,t,n,i){for(var r=-1,o=e.length;++r<o;){var a=e[r];t(i,a,n(a),e)}return i}function u(e,t){for(var n=-1,i=e.length,r=-1,o=t.length,a=Array(i+o);++n<i;)a[n]=e[n];for(;++r<o;)a[n++]=t[r];return a}function c(e,t){for(var n=-1,i=e.length;++n<i&&t(e[n],n,e)!==!1;);return e}function h(e,t){for(var n=e.length;n--&&t(e[n],n,e)!==!1;);return e}function d(e,t){for(var n=-1,i=e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function f(e,t){for(var n=-1,i=e.length,r=-1,o=[];++n<i;){var a=e[n];t(a,n,e)&&(o[++r]=a)}return o}function p(e,t){return!!e.length&&A(e,t,0)>-1}function _(e,t,n){for(var i=-1,r=e.length;++i<r;)if(n(t,e[i]))return!0;return!1}function g(e,t){for(var n=-1,i=e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function m(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}function v(e,t,n,i){var r=-1,o=e.length;for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function y(e,t,n,i){var r=e.length;for(i&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function b(e,t){for(var n=-1,i=e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function x(e,t,n){for(var i=-1,r=e.length;++i<r;){var o=e[i],a=t(o);if(null!=a&&(s===$?a===a:n(a,s)))var s=a,l=o}return l}function w(e,t,n,i){var r;return n(e,function(e,n,o){return t(e,n,o)?(r=i?n:e,!1):void 0}),r}function S(e,t,n){for(var i=e.length,r=n?i:-1;n?r--:++r<i;)if(t(e[r],r,e))return r;return-1}function A(e,t,n){if(t!==t)return H(e,n);for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}function k(e,t,n,i,r){return r(e,function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)}),n}function C(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function T(e,t){for(var n,i=-1,r=e.length;++i<r;){var o=t(e[i]);o!==$&&(n=n===$?o:n+o)}return n}function E(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function M(e,t){return g(t,function(t){return[t,e[t]]})}function L(e){return function(t){return e(t)}}function R(e,t){return g(t,function(t){return e[t]})}function O(e,t){for(var n=-1,i=e.length;++n<i&&A(t,e[n],0)>-1;);return n}function P(e,t){for(var n=e.length;n--&&A(t,e[n],0)>-1;);return n}function D(e){return e&&e.Object===Object?e:null}function I(e,t){if(e!==t){var n=null===e,i=e===$,r=e===e,o=null===t,a=t===$,s=t===t;if(e>t&&!o||!r||n&&!a&&s||i&&s)return 1;if(t>e&&!n||!s||o&&!i&&r||a&&r)return-1}return 0}function N(e,t,n){for(var i=-1,r=e.criteria,o=t.criteria,a=r.length,s=n.length;++i<a;){var l=I(r[i],o[i]);if(l){if(i>=s)return l;var u=n[i];return l*("desc"==u?-1:1)}}return e.index-t.index}function F(e){return wn[e]}function B(e){return Sn[e]}function z(e){return"\\"+Cn[e]}function H(e,t,n){for(var i=e.length,r=t+(n?0:-1);n?r--:++r<i;){var o=e[r];if(o!==o)return r}return-1}function q(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}function G(e,t){return e="number"==typeof e||Tt.test(e)?+e:-1,t=null==t?we:t,e>-1&&e%1==0&&t>e}function j(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function U(e){var t=-1,n=Array(e.size);return e.forEach(function(e,i){n[++t]=[i,e]}),n}function V(e,t){for(var n=-1,i=e.length,r=-1,o=[];++n<i;)e[n]===t&&(e[n]=Ee,o[++r]=n);return o}function W(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function X(e){if(!e||!pn.test(e))return e.length;for(var t=fn.lastIndex=0;fn.test(e);)t++;return t}function K(e){return e.match(fn)}function Y(e){return An[e]}function Z(e){function t(e){if(Da(e)&&!gc(e)&&!(e instanceof r)){if(e instanceof i)return e;if(zl.call(e,"__wrapped__"))return Lr(e)}return new i(e)}function n(){}function i(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=$}function r(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ke,this.__views__=[]}function D(){var e=new r(this.__wrapped__);return e.__actions__=Di(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Di(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Di(this.__views__),e}function Tt(){if(this.__filtered__){var e=new r(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Rt(){var e=this.__wrapped__.value(),t=this.__dir__,n=gc(e),i=0>t,r=n?e.length:0,o=hr(0,r,this.__views__),a=o.start,s=o.end,l=s-a,u=i?s:a-1,c=this.__iteratees__,h=c.length,d=0,f=uu(l,this.__takeCount__);if(!n||_e>r||r==l&&f==l)return wi(e,this.__actions__);var p=[];e:for(;l--&&f>d;){u+=t;for(var _=-1,g=e[u];++_<h;){var m=c[_],v=m.iteratee,y=m.type,b=v(g);if(y==me)g=b;else if(!b){if(y==ge)continue e;break e}}p[d++]=g}return p}function Ot(){}function Pt(e,t){return It(e,t)&&delete e[t]}function Dt(e,t){if(gu){var n=e[t];return n===be?$:n}return zl.call(e,t)?e[t]:$}function It(e,t){return gu?e[t]!==$:zl.call(e,t)}function Nt(e,t,n){e[t]=gu&&n===$?be:n}function Ft(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Bt(){this.__data__={hash:new Ot,map:fu?new fu:[],string:new Ot}}function zt(e){var t=this.__data__;return yr(e)?Pt("string"==typeof e?t.string:t.hash,e):fu?t.map["delete"](e):Jt(t.map,e)}function Ht(e){var t=this.__data__;return yr(e)?Dt("string"==typeof e?t.string:t.hash,e):fu?t.map.get(e):Qt(t.map,e)}function qt(e){var t=this.__data__;return yr(e)?It("string"==typeof e?t.string:t.hash,e):fu?t.map.has(e):en(t.map,e)}function Gt(e,t){var n=this.__data__;return yr(e)?Nt("string"==typeof e?n.string:n.hash,e,t):fu?n.map.set(e,t):nn(n.map,e,t),this}function jt(e){var t=-1,n=e?e.length:0;for(this.__data__=new Ft;++t<n;)this.push(e[t])}function Ut(e,t){var n=e.__data__;if(yr(t)){var i=n.__data__,r="string"==typeof t?i.string:i.hash;return r[t]===be}return n.has(t)}function Vt(e){var t=this.__data__;if(yr(e)){var n=t.__data__,i="string"==typeof e?n.string:n.hash;i[e]=be}else t.set(e,be)}function Wt(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Xt(){this.__data__={array:[],map:null}}function Kt(e){var t=this.__data__,n=t.array;return n?Jt(n,e):t.map["delete"](e)}function Yt(e){var t=this.__data__,n=t.array;return n?Qt(n,e):t.map.get(e)}function Zt(e){var t=this.__data__,n=t.array;return n?en(n,e):t.map.has(e)}function $t(e,t){var n=this.__data__,i=n.array;i&&(i.length<_e-1?nn(i,e,t):(n.array=null,n.map=new Ft(i)));var r=n.map;return r&&r.set(e,t),this}function Jt(e,t){var n=tn(e,t);if(0>n)return!1;var i=e.length-1;return n==i?e.pop():nu.call(e,n,1),!0}function Qt(e,t){var n=tn(e,t);return 0>n?$:e[n][1]}function en(e,t){return tn(e,t)>-1}function tn(e,t){for(var n=e.length;n--;)if(_a(e[n][0],t))return n;return-1}function nn(e,t,n){var i=tn(e,t);0>i?e.push([t,n]):e[i][1]=n}function rn(e,t,n,i){return e===$||_a(e,Fl[n])&&!zl.call(i,n)?t:e}function on(e,t,n){(n!==$&&!_a(e[t],n)||"number"==typeof t&&n===$&&!(t in e))&&(e[t]=n)}function an(e,t,n){var i=e[t];(!_a(i,n)||_a(i,Fl[t])&&!zl.call(e,t)||n===$&&!(t in e))&&(e[t]=n)}function sn(e,t,n,i){return Cu(e,function(e,r,o){t(i,e,n(e),o)}),i}function ln(e,t){return e&&Ii(t,bs(t),e)}function un(e,t){for(var n=-1,i=null==e,r=t.length,o=Array(r);++n<r;)o[n]=i?$:ms(e,t[n]);return o}function cn(e,t,n){return e===e&&(n!==$&&(e=n>=e?e:n),t!==$&&(e=e>=t?e:t)),e}function hn(e,t,n,i,r,o){var a;if(n&&(a=r?n(e,i,r,o):n(e)),a!==$)return a;if(!Pa(e))return e;var s=gc(e);if(s){if(a=fr(e),!t)return Di(e,a)}else{var l=cr(e),u=l==De||l==Ie;if(mc(e))return ki(e,t);if(l!=Be&&l!=Me&&(!u||r))return xn[l]?_r(e,l,t):r?e:{};if(q(e))return r?e:{};if(a=pr(u?{}:e),!t)return Fi(e,ln(a,e))}o||(o=new Wt);var h=o.get(e);return h?h:(o.set(e,a),(s?c:Rn)(e,function(i,r){an(a,r,hn(i,t,n,r,e,o))}),s?a:Fi(e,a))}function fn(e){var t=bs(e),n=t.length;return function(i){if(null==i)return!n;for(var r=n;r--;){var o=t[r],a=e[o],s=i[o];if(s===$&&!(o in Object(i))||!a(s))return!1}return!0}}function wn(e,t,n){if("function"!=typeof e)throw new Il(ye);return tu(function(){e.apply($,n)},t)}function Sn(e,t,n,i){var r=-1,o=p,a=!0,s=e.length,l=[],u=t.length;if(!s)return l;n&&(t=g(t,L(n))),i?(o=_,a=!1):t.length>=_e&&(o=Ut,a=!1,t=new jt(t));e:for(;++r<s;){var c=e[r],h=n?n(c):c;if(a&&h===h){for(var d=u;d--;)if(t[d]===h)continue e;l.push(c)}else o(t,h,i)||l.push(c)}return l}function An(e,t){var n=!0;return Cu(e,function(e,i,r){return n=!!t(e,i,r)}),n}function kn(e,t,n,i){var r=e.length;for(n=ns(n),0>n&&(n=-n>r?0:r+n),i=i===$||i>r?r:ns(i),0>i&&(i+=r),i=n>i?0:is(i);i>n;)e[n++]=t;return e}function Cn(e,t){var n=[];return Cu(e,function(e,i,r){t(e,i,r)&&n.push(e)}),n}function Mn(e,t,n,i){i||(i=[]);for(var r=-1,o=e.length;++r<o;){var a=e[r];xa(a)&&(n||gc(a)||va(a))?t?Mn(a,t,n,i):m(i,a):n||(i[i.length]=a)}return i}function Ln(e,t){return null==e?e:Eu(e,t,xs)}function Rn(e,t){return e&&Eu(e,t,bs)}function On(e,t){return e&&Mu(e,t,bs)}function Pn(e,t){return f(t,function(t){return La(e[t])})}function In(e,t){t=vr(t,e)?[t+""]:vi(t);for(var n=0,i=t.length;null!=e&&i>n;)e=e[t[n++]];return n&&n==i?e:$}function Bn(e,t){return zl.call(e,t)||"object"==typeof e&&t in e&&null===$l(e)}function zn(e,t){return t in Object(e)}function Hn(e,t,n){return e>=uu(t,n)&&e<lu(t,n)}function qn(e,t,n){for(var i=n?_:p,r=e.length,o=r,a=Array(r),s=[];o--;){var l=e[o];o&&t&&(l=g(l,L(t))),a[o]=!n&&(t||l.length>=120)?new jt(o&&l):$}l=e[0];var u=-1,c=l.length,h=a[0];e:for(;++u<c;){var d=l[u],f=t?t(d):d;if(!(h?Ut(h,f):i(s,f,n))){for(var o=r;--o;){var m=a[o];if(!(m?Ut(m,f):i(e[o],f,n)))continue e}h&&h.push(f),s.push(d)}}return s}function Gn(e,t,n,i){return Rn(e,function(e,r,o){t(i,n(e),r,o)}),i}function jn(e,t,n){vr(t,e)||(t=vi(t),e=kr(e,t),t=Xr(t));var i=null==e?e:e[t];return null==i?$:s(i,e,n)}function Un(e,t,n,i,r){return e===t?!0:null==e||null==t||!Pa(e)&&!Da(t)?e!==e&&t!==t:Vn(e,t,Un,n,i,r)}function Vn(e,t,n,i,r,o){var a=gc(e),s=gc(t),l=Le,u=Le;a||(l=cr(e),l==Me?l=Be:l!=Be&&(a=Ya(e))),s||(u=cr(t),u==Me?u=Be:u!=Be&&(s=Ya(t)));var c=l==Be&&!q(e),h=u==Be&&!q(t),d=l==u;if(d&&!a&&!c)return rr(e,t,l,n,i,r);var f=r&ce;if(!f){var p=c&&zl.call(e,"__wrapped__"),_=h&&zl.call(t,"__wrapped__");if(p||_)return n(p?e.value():e,_?t.value():t,i,r,o)}return d?(o||(o=new Wt),(a?ir:or)(e,t,n,i,r,o)):!1}function Wn(e,t,n,i){var r=n.length,o=r,a=!i;if(null==e)return!o;for(e=Object(e);r--;){var s=n[r];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++r<o;){s=n[r];var l=s[0],u=e[l],c=s[1];if(a&&s[2]){if(u===$&&!(l in e))return!1}else{var h=new Wt,d=i?i(u,c,l,e,t,h):$;if(!(d===$?Un(c,u,i,ue|ce,h):d))return!1}}return!0}function Xn(e){var t=typeof e;return"function"==t?e:null==e?ul:"object"==t?gc(e)?Jn(e[0],e[1]):$n(e):ml(e)}function Kn(e){return su(Object(e))}function Yn(e){e=null==e?e:Object(e);var t=[];for(var n in e)t.push(n);return t}function Zn(e,t){var n=-1,i=ba(e)?Array(e.length):[];return Cu(e,function(e,r,o){i[++n]=t(e,r,o)}),i}function $n(e){var t=lr(e);if(1==t.length&&t[0][2]){var n=t[0][0],i=t[0][1];return function(e){return null==e?!1:e[n]===i&&(i!==$||n in Object(e))}}return function(n){return n===e||Wn(n,e,t)}}function Jn(e,t){return function(n){var i=ms(n,e);return i===$&&i===t?ys(n,e):Un(t,i,$,ue|ce)}}function Qn(e,t,n,i,r){if(e!==t){var o=gc(t)||Ya(t)?$:xs(t);c(o||t,function(a,s){if(o&&(s=a,a=t[s]),Pa(a))r||(r=new Wt),ei(e,t,s,n,Qn,i,r);else{var l=i?i(e[s],a,s+"",e,t,r):$;l===$&&(l=a),on(e,s,l)}})}}function ei(e,t,n,i,r,o,a){var s=e[n],l=t[n],u=a.get(l);if(u)return void on(e,n,u);var c=o?o(s,l,n+"",e,t,a):$,h=c===$;h&&(c=l,gc(l)||Ya(l)?gc(s)?c=i?Di(s):s:xa(s)?c=Di(s):(h=!1,c=hn(l)):ja(l)||va(l)?va(s)?c=os(s):!Pa(s)||i&&La(s)?(h=!1,c=hn(l)):c=i?hn(s):s:h=!1),a.set(l,c),h&&r(c,l,i,o,a),on(e,n,c)}function ti(e,t,n){var i=-1,r=sr();t=g(t.length?t:Array(1),function(e){return r(e)});var o=Zn(e,function(e,n,r){var o=g(t,function(t){return t(e)});return{criteria:o,index:++i,value:e}});return C(o,function(e,t){return N(e,t,n)})}function ni(e,t){return e=Object(e),v(t,function(t,n){return n in e&&(t[n]=e[n]),t},{})}function ii(e,t){var n={};return Ln(e,function(e,i){t(e,i)&&(n[i]=e)}),n}function ri(e){return function(t){return null==t?$:t[e]}}function oi(e){return function(t){return In(t,e)}}function ai(e,t){return si(e,t)}function si(e,t,n){var i=-1,r=t.length,o=e;for(n&&(o=g(e,function(e){return n(e)}));++i<r;)for(var a=0,s=t[i],l=n?n(s):s;(a=A(o,l,a))>-1;)o!==e&&nu.call(o,a,1),nu.call(e,a,1);return e}function li(e,t){for(var n=e?t.length:0,i=n-1;n--;){var r=t[n];if(i==n||r!=o){var o=r;if(G(r))nu.call(e,r,1);else if(vr(r,e))delete e[r];else{var a=vi(r),s=kr(e,a);null!=s&&delete s[Xr(a)]}}}return e}function ui(e,t){return e+ru(hu()*(t-e+1))}function ci(e,t,n,i){for(var r=-1,o=lu(iu((t-e)/(n||1)),0),a=Array(o);o--;)a[i?o:++r]=e,e+=n;return a}function hi(e,t,n,i){t=vr(t,e)?[t+""]:vi(t);for(var r=-1,o=t.length,a=o-1,s=e;null!=s&&++r<o;){var l=t[r];if(Pa(s)){var u=n;if(r!=a){var c=s[l];u=i?i(c,l,s):$,u===$&&(u=null==c?G(t[r+1])?[]:{}:c)}an(s,l,u)}s=s[l]}return e}function di(e,t,n){var i=-1,r=e.length;0>t&&(t=-t>r?0:r+t),n=n>r?r:n,0>n&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(r);++i<r;)o[i]=e[i+t];return o}function fi(e,t){var n;return Cu(e,function(e,i,r){return n=t(e,i,r),!n}),!!n}function pi(e,t,n){var i=0,r=e?e.length:i;if("number"==typeof t&&t===t&&Te>=r){for(;r>i;){var o=i+r>>>1,a=e[o];(n?t>=a:t>a)&&null!==a?i=o+1:r=o}return r}return _i(e,t,ul,n);
}function _i(e,t,n,i){t=n(t);for(var r=0,o=e?e.length:0,a=t!==t,s=null===t,l=t===$;o>r;){var u=ru((r+o)/2),c=n(e[u]),h=c!==$,d=c===c;if(a)var f=d||i;else f=s?d&&h&&(i||null!=c):l?d&&(i||h):null==c?!1:i?t>=c:t>c;f?r=u+1:o=u}return uu(o,Ce)}function gi(e){return mi(e)}function mi(e,t){for(var n=0,i=e.length,r=e[0],o=t?t(r):r,a=o,s=0,l=[r];++n<i;)r=e[n],o=t?t(r):r,_a(o,a)||(a=o,l[++s]=r);return l}function vi(e){return gc(e)?e:Tr(e)}function yi(e,t,n){var i=-1,r=p,o=e.length,a=!0,s=[],l=s;if(n)a=!1,r=_;else if(o>=_e){var u=t?null:Ru(e);if(u)return W(u);a=!1,r=Ut,l=new jt}else l=t?[]:s;e:for(;++i<o;){var c=e[i],h=t?t(c):c;if(a&&h===h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),s.push(c)}else r(l,h,n)||(l!==s&&l.push(h),s.push(c))}return s}function bi(e,t){t=vr(t,e)?[t+""]:vi(t),e=kr(e,t);var n=Xr(t);return null!=e&&vs(e,n)?delete e[n]:!0}function xi(e,t,n,i){for(var r=e.length,o=i?r:-1;(i?o--:++o<r)&&t(e[o],o,e););return n?di(e,i?0:o,i?o+1:r):di(e,i?o+1:0,i?r:o)}function wi(e,t){var n=e;return n instanceof r&&(n=n.value()),v(t,function(e,t){return t.func.apply(t.thisArg,m([e],t.args))},n)}function Si(e,t,n){for(var i=-1,r=e.length;++i<r;)var o=o?m(Sn(o,e[i],t,n),Sn(e[i],o,t,n)):e[i];return o&&o.length?yi(o,t,n):[]}function Ai(e,t,n){for(var i=-1,r=e.length,o=t.length,a={};++i<r;)n(a,e[i],o>i?t[i]:$);return a}function ki(e,t){if(t)return e.slice();var n=e.constructor,i=new n(e.length);return e.copy(i),i}function Ci(e){var t=e.constructor,n=new t(e.byteLength),i=new Kl(n);return i.set(new Kl(e)),n}function Ti(e){var t=e.constructor;return v(U(e),o,new t)}function Ei(e){var t=e.constructor,n=new t(e.source,xt.exec(e));return n.lastIndex=e.lastIndex,n}function Mi(e){var t=e.constructor;return v(W(e),a,new t)}function Li(e){return Xl?Object(wu.call(e)):{}}function Ri(e,t){var n=e.buffer,i=e.constructor;return new i(t?Ci(n):n,e.byteOffset,e.length)}function Oi(e,t,n){for(var i=n.length,r=-1,o=lu(e.length-i,0),a=-1,s=t.length,l=Array(s+o);++a<s;)l[a]=t[a];for(;++r<i;)l[n[r]]=e[r];for(;o--;)l[a++]=e[r++];return l}function Pi(e,t,n){for(var i=-1,r=n.length,o=-1,a=lu(e.length-r,0),s=-1,l=t.length,u=Array(a+l);++o<a;)u[o]=e[o];for(var c=o;++s<l;)u[c+s]=t[s];for(;++i<r;)u[c+n[i]]=e[o++];return u}function Di(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}function Ii(e,t,n){return Ni(e,t,n)}function Ni(e,t,n,i){n||(n={});for(var r=-1,o=t.length;++r<o;){var a=t[r],s=i?i(n[a],e[a],a,n,e):e[a];an(n,a,s)}return n}function Fi(e,t){return Ii(e,Du(e),t)}function Bi(e,t){return function(n,i){var r=gc(n)?l:sn,o=t?t():{};return r(n,e,sr(i),o)}}function zi(e){return aa(function(t,n){var i=-1,r=n.length,o=r>1?n[r-1]:$,a=r>2?n[2]:$;for(o="function"==typeof o?(r--,o):$,a&&mr(n[0],n[1],a)&&(o=3>r?$:o,r=1),t=Object(t);++i<r;){var s=n[i];s&&e(t,s,i,o)}return t})}function Hi(e,t){return function(n,i){if(null==n)return n;if(!ba(n))return e(n,i);for(var r=n.length,o=t?r:-1,a=Object(n);(t?o--:++o<r)&&i(a[o],o,a)!==!1;);return n}}function qi(e){return function(t,n,i){for(var r=-1,o=Object(t),a=i(t),s=a.length;s--;){var l=a[e?s:++r];if(n(o[l],l,o)===!1)break}return t}}function Gi(e,t,n){function i(){var t=this&&this!==Nn&&this instanceof i?o:e;return t.apply(r?n:this,arguments)}var r=t&Q,o=Vi(e);return i}function ji(e){return function(t){t=ss(t);var n=pn.test(t)?K(t):$,i=n?n[0]:t.charAt(0),r=n?n.slice(1).join(""):t.slice(1);return i[e]()+r}}function Ui(e){return function(t){return v(ol(zs(t)),e,"")}}function Vi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=ku(e.prototype),i=e.apply(n,t);return Pa(i)?i:n}}function Wi(e,n,i){function r(){for(var a=arguments.length,l=a,u=Array(a),c=this&&this!==Nn&&this instanceof r?o:e,h=t.placeholder||r.placeholder;l--;)u[l]=arguments[l];var d=3>a&&u[0]!==h&&u[a-1]!==h?[]:V(u,h);return a-=d.length,i>a?er(e,n,Ki,h,$,u,d,$,$,i-a):s(c,this,u)}var o=Vi(e);return r}function Xi(e){return aa(function(t){t=Mn(t);var n=t.length,r=n,o=i.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Il(ye);if(o&&!s&&"wrapper"==ar(a))var s=new i([],!0)}for(r=s?r:n;++r<n;){a=t[r];var l=ar(a),u="wrapper"==l?Ou(a):$;s=u&&br(u[0])&&u[1]==(ae|ne|re|se)&&!u[4].length&&1==u[9]?s[ar(u[0])].apply(s,u[3]):1==a.length&&br(a)?s[l]():s.thru(a)}return function(){var e=arguments,i=e[0];if(s&&1==e.length&&gc(i)&&i.length>=_e)return s.plant(i).value();for(var r=0,o=n?t[r].apply(this,e):i;++r<n;)o=t[r].call(this,o);return o}})}function Ki(e,n,i,r,o,a,s,l,u,c){function h(){for(var y=arguments.length,b=y,x=Array(y);b--;)x[b]=arguments[b];if(r&&(x=Oi(x,r,o)),a&&(x=Pi(x,a,s)),_||g){var w=t.placeholder||h.placeholder,S=V(x,w);if(y-=S.length,c>y)return er(e,n,Ki,w,i,x,S,l,u,c-y)}var A=f?i:this,k=p?A[e]:e;return l?x=Cr(x,l):m&&x.length>1&&x.reverse(),d&&u<x.length&&(x.length=u),this&&this!==Nn&&this instanceof h&&(k=v||Vi(k)),k.apply(A,x)}var d=n&ae,f=n&Q,p=n&ee,_=n&ne,g=n&ie,m=n&le,v=p?$:Vi(e);return h}function Yi(e,t){return function(n,i){return Gn(n,e,t(i),{})}}function Zi(e){return aa(function(t){return t=g(Mn(t),sr()),aa(function(n){var i=this;return e(t,function(e){return s(e,i,n)})})})}function $i(e,t,n){t=ns(t);var i=X(e);if(!t||i>=t)return"";var r=t-i;n=n===$?" ":n+"";var o=Xs(n,iu(r/X(n)));return pn.test(n)?K(o).slice(0,r).join(""):o.slice(0,r)}function Ji(e,t,n,i){function r(){for(var t=-1,l=arguments.length,u=-1,c=i.length,h=Array(c+l),d=this&&this!==Nn&&this instanceof r?a:e;++u<c;)h[u]=i[u];for(;l--;)h[u++]=arguments[++t];return s(d,o?n:this,h)}var o=t&Q,a=Vi(e);return r}function Qi(e){return function(t,n,i){return i&&"number"!=typeof i&&mr(t,n,i)&&(n=i=$),t=rs(t),t=t===t?t:0,n===$?(n=t,t=0):n=rs(n)||0,i=i===$?n>t?1:-1:rs(i)||0,ci(t,n,i,e)}}function er(e,t,n,i,r,o,a,s,l,u){var c=t&ne,h=s?Di(s):$,d=c?a:$,f=c?$:a,p=c?o:$,_=c?$:o;t|=c?re:oe,t&=~(c?oe:re),t&te||(t&=~(Q|ee));var g=[e,t,r,p,d,_,f,h,l,u],m=n.apply($,g);return br(e)&&Iu(m,g),m.placeholder=i,m}function tr(e){var t=Pl[e];return function(e,n){if(e=rs(e),n=ns(n)){var i=(ss(e)+"e").split("e"),r=t(i[0]+"e"+(+i[1]+n));return i=(ss(r)+"e").split("e"),+(i[0]+"e"+(+i[1]-n))}return t(e)}}function nr(e,t,n,i,r,o,a,s){var l=t&ee;if(!l&&"function"!=typeof e)throw new Il(ye);var u=i?i.length:0;if(u||(t&=~(re|oe),i=r=$),a=a===$?a:lu(ns(a),0),s=s===$?s:ns(s),u-=r?r.length:0,t&oe){var c=i,h=r;i=r=$}var d=l?$:Ou(e),f=[e,t,n,i,r,c,h,o,a,s];if(d&&Sr(f,d),e=f[0],t=f[1],n=f[2],i=f[3],r=f[4],s=f[9]=null==f[9]?l?0:e.length:lu(f[9]-u,0),!s&&t&(ne|ie)&&(t&=~(ne|ie)),t&&t!=Q)p=t==ne||t==ie?Wi(e,t,s):t!=re&&t!=(Q|re)||r.length?Ki.apply($,f):Ji(e,t,n,i);else var p=Gi(e,t,n);var _=d?Lu:Iu;return _(p,f)}function ir(e,t,n,i,r,o){var a=-1,s=r&ce,l=r&ue,u=e.length,c=t.length;if(u!=c&&!(s&&c>u))return!1;var h=o.get(e);if(h)return h==t;var d=!0;for(o.set(e,t);++a<u;){var f=e[a],p=t[a];if(i)var _=s?i(p,f,a,t,e,o):i(f,p,a,e,t,o);if(_!==$){if(_)continue;d=!1;break}if(l){if(!b(t,function(e){return f===e||n(f,e,i,r,o)})){d=!1;break}}else if(f!==p&&!n(f,p,i,r,o)){d=!1;break}}return o["delete"](e),d}function rr(e,t,n,i,r,o){switch(n){case Ve:return e.byteLength==t.byteLength&&i(new Kl(e),new Kl(t))?!0:!1;case Re:case Oe:return+e==+t;case Pe:return e.name==t.name&&e.message==t.message;case Fe:return e!=+e?t!=+t:e==+t;case ze:case qe:return e==t+"";case Ne:var a=U;case He:var s=o&ce;return a||(a=W),(s||e.size==t.size)&&i(a(e),a(t),r,o|ue);case Ge:return!!Xl&&wu.call(e)==wu.call(t)}return!1}function or(e,t,n,i,r,o){var a=r&ce,s=bs(e),l=s.length,u=bs(t),c=u.length;if(l!=c&&!a)return!1;for(var h=l;h--;){var d=s[h];if(!(a?d in t:Bn(t,d)))return!1}var f=o.get(e);if(f)return f==t;var p=!0;o.set(e,t);for(var _=a;++h<l;){d=s[h];var g=e[d],m=t[d];if(i)var v=a?i(m,g,d,t,e,o):i(g,m,d,e,t,o);if(!(v===$?g===m||n(g,m,i,r,o):v)){p=!1;break}_||(_="constructor"==d)}if(p&&!_){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return o["delete"](e),p}function ar(e){for(var t=e.name+"",n=Au[t],i=zl.call(Au,t)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==e)return r.name}return t}function sr(){var e=t.iteratee||cl;return e=e===cl?Xn:e,arguments.length?e(arguments[0],arguments[1]):e}function lr(e){for(var t=Ms(e),n=t.length;n--;)t[n][2]=wr(t[n][1]);return t}function ur(e,t){var n=null==e?$:e[t];return za(n)?n:$}function cr(e){return Gl.call(e)}function hr(e,t,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=uu(t,e+a);break;case"takeRight":e=lu(e,t-a)}}return{start:e,end:t}}function dr(e,t,n){if(null==e)return!1;var i=n(e,t);i||vr(t)||(t=vi(t),e=kr(e,t),null!=e&&(t=Xr(t),i=n(e,t)));var r=e?e.length:$;return i||!!r&&Oa(r)&&G(t,r)&&(gc(e)||Xa(e)||va(e))}function fr(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&zl.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function pr(e){if(xr(e))return{};var t=e.constructor;return ku(La(t)?t.prototype:$)}function _r(e,t,n){var i=e.constructor;switch(t){case Ve:return Ci(e);case Re:case Oe:return new i(+e);case We:case Xe:case Ke:case Ye:case Ze:case $e:case Je:case Qe:case et:return Ri(e,n);case Ne:return Ti(e);case Fe:case qe:return new i(e);case ze:return Ei(e);case He:return Mi(e);case Ge:return Li(e)}}function gr(e){var t=e?e.length:$;return Oa(t)&&(gc(e)||Xa(e)||va(e))?E(t,String):null}function mr(e,t,n){if(!Pa(n))return!1;var i=typeof t;return("number"==i?ba(n)&&G(t,n.length):"string"==i&&t in n)?_a(n[t],e):!1}function vr(e,t){return"number"==typeof e?!0:!gc(e)&&(dt.test(e)||!ht.test(e)||null!=t&&e in Object(t))}function yr(e){var t=typeof e;return"number"==t||"boolean"==t||"string"==t&&"__proto__"!==e||null==e}function br(e){var n=ar(e),i=t[n];if("function"!=typeof i||!(n in r.prototype))return!1;if(e===i)return!0;var o=Ou(i);return!!o&&e===o[0]}function xr(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||Fl;return e===n}function wr(e){return e===e&&!Pa(e)}function Sr(e,t){var n=e[1],i=t[1],r=n|i,o=(Q|ee|ae)>r,a=i==ae&&n==ne||i==ae&&n==se&&e[7].length<=t[8]||i==(ae|se)&&t[7].length<=t[8]&&n==ne;if(!o&&!a)return e;i&Q&&(e[2]=t[2],r|=n&Q?0:te);var s=t[3];if(s){var l=e[3];e[3]=l?Oi(l,s,t[4]):Di(s),e[4]=l?V(e[3],Ee):Di(t[4])}return s=t[5],s&&(l=e[5],e[5]=l?Pi(l,s,t[6]):Di(s),e[6]=l?V(e[5],Ee):Di(t[6])),s=t[7],s&&(e[7]=Di(s)),i&ae&&(e[8]=null==e[8]?t[8]:uu(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r,e}function Ar(e,t,n,i,r,o){return Pa(e)&&Pa(t)&&(o.set(t,e),Qn(e,t,$,Ar,o)),e}function kr(e,t){return 1==t.length?e:ms(e,di(t,0,-1))}function Cr(e,t){for(var n=e.length,i=uu(t.length,n),r=Di(e);i--;){var o=t[i];e[i]=G(o,n)?r[o]:$}return e}function Tr(e){var t=[];return ss(e).replace(ft,function(e,n,i,r){t.push(i?r.replace(yt,"$1"):n||e)}),t}function Er(e){return xa(e)?e:[]}function Mr(e){return"function"==typeof e?e:ul}function Lr(e){if(e instanceof r)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=Di(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Rr(e,t){t=lu(ns(t),0);var n=e?e.length:0;if(!n||1>t)return[];for(var i=0,r=-1,o=Array(iu(n/t));n>i;)o[++r]=di(e,i,i+=t);return o}function Or(e){for(var t=-1,n=e?e.length:0,i=-1,r=[];++t<n;){var o=e[t];o&&(r[++i]=o)}return r}function Pr(e,t,n){var i=e?e.length:0;return i?(t=n||t===$?1:ns(t),di(e,0>t?0:t,i)):[]}function Dr(e,t,n){var i=e?e.length:0;return i?(t=n||t===$?1:ns(t),t=i-t,di(e,0,0>t?0:t)):[]}function Ir(e,t){return e&&e.length?xi(e,sr(t,3),!0,!0):[]}function Nr(e,t){return e&&e.length?xi(e,sr(t,3),!0):[]}function Fr(e,t,n,i){var r=e?e.length:0;return r?(n&&"number"!=typeof n&&mr(e,t,n)&&(n=0,i=r),kn(e,t,n,i)):[]}function Br(e,t){return e&&e.length?S(e,sr(t,3)):-1}function zr(e,t){return e&&e.length?S(e,sr(t,3),!0):-1}function Hr(e){var t=e?e.length:0;return t?Mn(e):[]}function qr(e){var t=e?e.length:0;return t?Mn(e,!0):[]}function Gr(e){for(var t=-1,n=e?e.length:0,i={};++t<n;){var r=e[t];i[r[0]]=r[1]}return i}function jr(e){return e?e[0]:$}function Ur(e,t,n){var i=e?e.length:0;return i?(n=ns(n),0>n&&(n=lu(i+n,0)),A(e,t,n)):-1}function Vr(e){return Dr(e,1)}function Wr(e,t){return e?au.call(e,t):""}function Xr(e){var t=e?e.length:0;return t?e[t-1]:$}function Kr(e,t,n){var i=e?e.length:0;if(!i)return-1;var r=i;if(n!==$&&(r=ns(n),r=(0>r?lu(i+r,0):uu(r,i-1))+1),t!==t)return H(e,r,!0);for(;r--;)if(e[r]===t)return r;return-1}function Yr(e,t){return e&&e.length&&t&&t.length?ai(e,t):e}function Zr(e,t,n){return e&&e.length&&t&&t.length?si(e,t,sr(n)):e}function $r(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],o=e.length;for(t=sr(t,3);++i<o;){var a=e[i];t(a,i,e)&&(n.push(a),r.push(i))}return li(e,r),n}function Jr(e){return e?du.call(e):e}function Qr(e,t,n){var i=e?e.length:0;return i?(n&&"number"!=typeof n&&mr(e,t,n)?(t=0,n=i):(t=null==t?0:ns(t),n=n===$?i:ns(n)),di(e,t,n)):[]}function eo(e,t){return pi(e,t)}function to(e,t,n){return _i(e,t,sr(n))}function no(e,t){var n=e?e.length:0;if(n){var i=pi(e,t);if(n>i&&_a(e[i],t))return i}return-1}function io(e,t){return pi(e,t,!0)}function ro(e,t,n){return _i(e,t,sr(n),!0)}function oo(e,t){var n=e?e.length:0;if(n){var i=pi(e,t,!0)-1;if(_a(e[i],t))return i}return-1}function ao(e){return e&&e.length?gi(e):[]}function so(e,t){return e&&e.length?mi(e,sr(t)):[]}function lo(e){return Pr(e,1)}function uo(e,t,n){return e&&e.length?(t=n||t===$?1:ns(t),di(e,0,0>t?0:t)):[]}function co(e,t,n){var i=e?e.length:0;return i?(t=n||t===$?1:ns(t),t=i-t,di(e,0>t?0:t,i)):[]}function ho(e,t){return e&&e.length?xi(e,sr(t,3),!1,!0):[]}function fo(e,t){return e&&e.length?xi(e,sr(t,3)):[]}function po(e){return e&&e.length?yi(e):[]}function _o(e,t){return e&&e.length?yi(e,sr(t)):[]}function go(e,t){return e&&e.length?yi(e,$,t):[]}function mo(e){if(!e||!e.length)return[];var t=0;return e=f(e,function(e){return xa(e)?(t=lu(e.length,t),!0):void 0}),E(t,function(t){return g(e,ri(t))})}function vo(e,t){if(!e||!e.length)return[];var n=mo(e);return null==t?n:g(n,function(e){return s(t,$,e)})}function yo(e,t){return Ai(e||[],t||[],an)}function bo(e,t){return Ai(e||[],t||[],hi)}function xo(e){var n=t(e);return n.__chain__=!0,n}function wo(e,t){return t(e),e}function So(e,t){return t(e)}function Ao(){return xo(this)}function ko(){return new i(this.value(),this.__chain__)}function Co(e){return this.map(e).flatten()}function To(){this.__values__===$&&(this.__values__=ts(this.value()));var e=this.__index__>=this.__values__.length,t=e?$:this.__values__[this.__index__++];return{done:e,value:t}}function Eo(){return this}function Mo(e){for(var t,i=this;i instanceof n;){var r=Lr(i);r.__index__=0,r.__values__=$,t?o.__wrapped__=r:t=r;var o=r;i=i.__wrapped__}return o.__wrapped__=e,t}function Lo(){var e=this.__wrapped__;if(e instanceof r){var t=e;return this.__actions__.length&&(t=new r(this)),t=t.reverse(),t.__actions__.push({func:So,args:[Jr],thisArg:$}),new i(t,this.__chain__)}return this.thru(Jr)}function Ro(){return wi(this.__wrapped__,this.__actions__)}function Oo(e,t,n){var i=gc(e)?d:An;return n&&mr(e,t,n)&&(t=$),i(e,sr(t,3))}function Po(e,t){var n=gc(e)?f:Cn;return n(e,sr(t,3))}function Do(e,t){if(t=sr(t,3),gc(e)){var n=S(e,t);return n>-1?e[n]:$}return w(e,t,Cu)}function Io(e,t){if(t=sr(t,3),gc(e)){var n=S(e,t,!0);return n>-1?e[n]:$}return w(e,t,Tu)}function No(e,t){return Mn(Ho(e,t))}function Fo(e,t){return"function"==typeof t&&gc(e)?c(e,t):Cu(e,Mr(t))}function Bo(e,t){return"function"==typeof t&&gc(e)?h(e,t):Tu(e,Mr(t))}function zo(e,t,n,i){e=ba(e)?e:Ps(e),n=n&&!i?ns(n):0;var r=e.length;return 0>n&&(n=lu(r+n,0)),Xa(e)?r>=n&&e.indexOf(t,n)>-1:!!r&&A(e,t,n)>-1}function Ho(e,t){var n=gc(e)?g:Zn;return n(e,sr(t,3))}function qo(e,t,n,i){return null==e?[]:(gc(t)||(t=null==t?[]:[t]),n=i?$:n,gc(n)||(n=null==n?[]:[n]),ti(e,t,n))}function Go(e,t,n){var i=gc(e)?v:k,r=arguments.length<3;return i(e,sr(t,4),n,r,Cu)}function jo(e,t,n){var i=gc(e)?y:k,r=arguments.length<3;return i(e,sr(t,4),n,r,Tu)}function Uo(e,t){var n=gc(e)?f:Cn;return t=sr(t,3),n(e,function(e,n,i){return!t(e,n,i)})}function Vo(e){var t=ba(e)?e:Ps(e),n=t.length;return n>0?t[ui(0,n-1)]:$}function Wo(e,t){var n=-1,i=ts(e),r=i.length,o=r-1;for(t=cn(ns(t),0,r);++n<t;){var a=ui(n,o),s=i[a];i[a]=i[n],i[n]=s}return i.length=t,i}function Xo(e){return Wo(e,ke)}function Ko(e){if(null==e)return 0;if(ba(e)){var t=e.length;return t&&Xa(e)?X(e):t}return bs(e).length}function Yo(e,t,n){var i=gc(e)?b:fi;return n&&mr(e,t,n)&&(t=$),i(e,sr(t,3))}function Zo(e,t){if("function"!=typeof t)throw new Il(ye);return e=ns(e),function(){return--e<1?t.apply(this,arguments):void 0}}function $o(e,t,n){return t=n?$:t,t=e&&null==t?e.length:t,nr(e,ae,$,$,$,$,t)}function Jo(e,t){var n;if("function"!=typeof t)throw new Il(ye);return e=ns(e),function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=$),n}}function Qo(e,n,i){n=i?$:n;var r=nr(e,ne,$,$,$,$,$,n);return r.placeholder=t.placeholder||Qo.placeholder,r}function ea(e,n,i){n=i?$:n;var r=nr(e,ie,$,$,$,$,$,n);return r.placeholder=t.placeholder||ea.placeholder,r}function ta(e,t,n){function i(){p&&Yl(p),c&&Yl(c),g=0,u=c=f=p=_=$}function r(t,n){n&&Yl(n),c=p=_=$,t&&(g=sc(),h=e.apply(f,u),p||c||(u=f=$))}function o(){var e=t-(sc()-d);0>=e||e>t?r(_,c):p=tu(o,e)}function a(){return(p&&_||c&&y)&&(h=e.apply(f,u)),i(),h}function s(){r(y,p)}function l(){if(u=arguments,d=sc(),f=this,_=y&&(p||!m),v===!1)var n=m&&!p;else{g||c||m||(g=d);var i=v-(d-g),r=0>=i||i>v;r?(c&&(c=Yl(c)),g=d,h=e.apply(f,u)):c||(c=tu(s,i))}return r&&p?p=Yl(p):p||t===v||(p=tu(o,t)),n&&(r=!0,h=e.apply(f,u)),!r||p||c||(u=f=$),h}var u,c,h,d,f,p,_,g=0,m=!1,v=!1,y=!0;if("function"!=typeof e)throw new Il(ye);return t=rs(t)||0,Pa(n)&&(m=!!n.leading,v="maxWait"in n&&lu(rs(n.maxWait)||0,t),y="trailing"in n?!!n.trailing:y),l.cancel=i,l.flush=a,l}function na(e){return nr(e,le)}function ia(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new Il(ye);var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var a=e.apply(this,i);return n.cache=o.set(r,a),a};return n.cache=new ia.Cache,n}function ra(e){if("function"!=typeof e)throw new Il(ye);return function(){return!e.apply(this,arguments)}}function oa(e){return Jo(2,e)}function aa(e,t){if("function"!=typeof e)throw new Il(ye);return t=lu(t===$?e.length-1:ns(t),0),function(){for(var n=arguments,i=-1,r=lu(n.length-t,0),o=Array(r);++i<r;)o[i]=n[t+i];switch(t){case 0:return e.call(this,o);case 1:return e.call(this,n[0],o);case 2:return e.call(this,n[0],n[1],o)}var a=Array(t+1);for(i=-1;++i<t;)a[i]=n[i];return a[t]=o,s(e,this,a)}}function sa(e,t){if("function"!=typeof e)throw new Il(ye);return t=t===$?0:lu(ns(t),0),aa(function(n){var i=n[t],r=n.slice(0,t);return i&&m(r,i),s(e,this,r)})}function la(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new Il(ye);return Pa(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),ta(e,t,{leading:i,maxWait:t,trailing:r})}function ua(e){return $o(e,1)}function ca(e,t){return t=null==t?ul:t,fc(t,e)}function ha(e){return hn(e)}function da(e,t){return hn(e,!1,t)}function fa(e){return hn(e,!0)}function pa(e,t){return hn(e,!0,t)}function _a(e,t){return e===t||e!==e&&t!==t}function ga(e,t){return e>t}function ma(e,t){return e>=t}function va(e){return xa(e)&&zl.call(e,"callee")&&(!eu.call(e,"callee")||Gl.call(e)==Me)}function ya(e){return Da(e)&&Gl.call(e)==Ve}function ba(e){return null!=e&&!("function"==typeof e&&La(e))&&Oa(Pu(e))}function xa(e){return Da(e)&&ba(e)}function wa(e){return e===!0||e===!1||Da(e)&&Gl.call(e)==Re}function Sa(e){return Da(e)&&Gl.call(e)==Oe}function Aa(e){return!!e&&1===e.nodeType&&Da(e)&&!ja(e)}function ka(e){if(ba(e)&&(gc(e)||Xa(e)||La(e.splice)||va(e)))return!e.length;for(var t in e)if(zl.call(e,t))return!1;return!0}function Ca(e,t){return Un(e,t)}function Ta(e,t,n){n="function"==typeof n?n:$;var i=n?n(e,t):$;return i===$?Un(e,t,n):!!i}function Ea(e){return Da(e)&&"string"==typeof e.message&&Gl.call(e)==Pe}function Ma(e){return"number"==typeof e&&ou(e)}function La(e){var t=Pa(e)?Gl.call(e):"";return t==De||t==Ie}function Ra(e){return"number"==typeof e&&e==ns(e)}function Oa(e){return"number"==typeof e&&e>-1&&e%1==0&&we>=e}function Pa(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Da(e){return!!e&&"object"==typeof e}function Ia(e){return Da(e)&&cr(e)==Ne}function Na(e,t){return e===t||Wn(e,t,lr(t))}function Fa(e,t,n){return n="function"==typeof n?n:$,Wn(e,t,lr(t),n)}function Ba(e){return Ga(e)&&e!=+e}function za(e){return null==e?!1:La(e)?Ul.test(Bl.call(e)):Da(e)&&(q(e)?Ul:kt).test(e)}function Ha(e){return null===e}function qa(e){return null==e}function Ga(e){return"number"==typeof e||Da(e)&&Gl.call(e)==Fe}function ja(e){if(!Da(e)||Gl.call(e)!=Be||q(e))return!1;var t=Fl;if("function"==typeof e.constructor&&(t=$l(e)),null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&Bl.call(n)==ql}function Ua(e){return Pa(e)&&Gl.call(e)==ze}function Va(e){return Ra(e)&&e>=-we&&we>=e}function Wa(e){return Da(e)&&cr(e)==He}function Xa(e){return"string"==typeof e||!gc(e)&&Da(e)&&Gl.call(e)==qe}function Ka(e){return"symbol"==typeof e||Da(e)&&Gl.call(e)==Ge}function Ya(e){return Da(e)&&Oa(e.length)&&!!bn[Gl.call(e)]}function Za(e){return e===$}function $a(e){return Da(e)&&cr(e)==je}function Ja(e){return Da(e)&&Gl.call(e)==Ue}function Qa(e,t){return t>e}function es(e,t){return t>=e}function ts(e){if(!e)return[];if(ba(e))return Xa(e)?K(e):Di(e);if(Ql&&e[Ql])return j(e[Ql]());var t=cr(e),n=t==Ne?U:t==He?W:Ps;return n(e)}function ns(e){if(!e)return 0===e?e:0;if(e=rs(e),e===xe||e===-xe){var t=0>e?-1:1;return t*Se}var n=e%1;return e===e?n?e-n:e:0}function is(e){return e?cn(ns(e),0,ke):0}function rs(e){if(Pa(e)){var t=La(e.valueOf)?e.valueOf():e;e=Pa(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(gt,"");var n=At.test(e);return n||Ct.test(e)?En(e.slice(2),n?2:8):St.test(e)?Ae:+e}function os(e){return Ii(e,xs(e))}function as(e){return cn(ns(e),-we,we)}function ss(e){if("string"==typeof e)return e;if(null==e)return"";if(Ka(e))return Xl?Su.call(e):"";var t=e+"";return"0"==t&&1/e==-xe?"-0":t}function ls(e,t){var n=ku(e);return t?ln(n,t):n}function us(e,t){return w(e,sr(t,3),Rn,!0)}function cs(e,t){return w(e,sr(t,3),On,!0)}function hs(e,t){return null==e?e:Eu(e,Mr(t),xs)}function ds(e,t){return null==e?e:Mu(e,Mr(t),xs)}function fs(e,t){return e&&Rn(e,Mr(t))}function ps(e,t){return e&&On(e,Mr(t))}function _s(e){return null==e?[]:Pn(e,bs(e))}function gs(e){return null==e?[]:Pn(e,xs(e))}function ms(e,t,n){var i=null==e?$:In(e,t);return i===$?n:i}function vs(e,t){return dr(e,t,Bn)}function ys(e,t){return dr(e,t,zn)}function bs(e){var t=xr(e);if(!t&&!ba(e))return Kn(e);var n=gr(e),i=!!n,r=n||[],o=r.length;for(var a in e)!Bn(e,a)||i&&("length"==a||G(a,o))||t&&"constructor"==a||r.push(a);return r}function xs(e){for(var t=-1,n=xr(e),i=Yn(e),r=i.length,o=gr(e),a=!!o,s=o||[],l=s.length;++t<r;){var u=i[t];a&&("length"==u||G(u,l))||"constructor"==u&&(n||!zl.call(e,u))||s.push(u)}return s}function ws(e,t){var n={};return t=sr(t,3),Rn(e,function(e,i,r){n[t(e,i,r)]=e}),n}function Ss(e,t){var n={};return t=sr(t,3),Rn(e,function(e,i,r){n[i]=t(e,i,r)}),n}function As(e,t){return t=sr(t,2),ii(e,function(e,n){return!t(e,n)})}function ks(e,t){return null==e?{}:ii(e,sr(t,2))}function Cs(e,t,n){if(vr(t,e))i=null==e?$:e[t];else{t=vi(t);var i=ms(e,t);e=kr(e,t)}return i===$&&(i=n),La(i)?i.call(e):i}function Ts(e,t,n){return null==e?e:hi(e,t,n)}function Es(e,t,n,i){return i="function"==typeof i?i:$,null==e?e:hi(e,t,n,i)}function Ms(e){return M(e,bs(e))}function Ls(e){return M(e,xs(e))}function Rs(e,t,n){var i=gc(e)||Ya(e);if(t=sr(t,4),null==n)if(i||Pa(e)){var r=e.constructor;n=i?gc(e)?new r:[]:ku(La(r)?r.prototype:$)}else n={};return(i?c:Rn)(e,function(e,i,r){return t(n,e,i,r)}),n}function Os(e,t){return null==e?!0:bi(e,t)}function Ps(e){return e?R(e,bs(e)):[]}function Ds(e){return null==e?R(e,xs(e)):[]}function Is(e,t,n){return n===$&&(n=t,t=$),n!==$&&(n=rs(n),n=n===n?n:0),t!==$&&(t=rs(t),t=t===t?t:0),cn(rs(e),t,n)}function Ns(e,t,n){return t=rs(t)||0,n===$?(n=t,t=0):n=rs(n)||0,e=rs(e),Hn(e,t,n)}function Fs(e,t,n){if(n&&"boolean"!=typeof n&&mr(e,t,n)&&(t=n=$),n===$&&("boolean"==typeof t?(n=t,t=$):"boolean"==typeof e&&(n=e,e=$)),e===$&&t===$?(e=0,t=1):(e=rs(e)||0,t===$?(t=e,e=0):t=rs(t)||0),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var r=hu();return uu(e+r*(t-e+Tn("1e-"+((r+"").length-1))),t)}return ui(e,t)}function Bs(e){return Nc(ss(e).toLowerCase())}function zs(e){return e=ss(e),e&&e.replace(Et,F).replace(dn,"")}function Hs(e,t,n){e=ss(e),t="string"==typeof t?t:t+"";var i=e.length;return n=n===$?i:cn(ns(n),0,i),n-=t.length,n>=0&&e.indexOf(t,n)==n}function qs(e){return e=ss(e),e&&st.test(e)?e.replace(ot,B):e}function Gs(e){return e=ss(e),e&&_t.test(e)?e.replace(pt,"\\$&"):e}function js(e,t,n){e=ss(e),t=ns(t);var i=X(e);if(!t||i>=t)return e;var r=(t-i)/2,o=ru(r),a=iu(r);return $i("",o,n)+e+$i("",a,n)}function Us(e,t,n){return e=ss(e),e+$i(e,t,n)}function Vs(e,t,n){return e=ss(e),$i(e,t,n)+e}function Ws(e,t,n){return n||null==t?t=0:t&&(t=+t),e=ss(e).replace(gt,""),cu(e,t||(wt.test(e)?16:10))}function Xs(e,t){e=ss(e),t=ns(t);var n="";if(!e||1>t||t>we)return n;do t%2&&(n+=e),t=ru(t/2),e+=e;while(t);return n}function Ks(){var e=arguments,t=ss(e[0]);return e.length<3?t:t.replace(e[1],e[2])}function Ys(e,t,n){return ss(e).split(t,n)}function Zs(e,t,n){return e=ss(e),n=cn(ns(n),0,e.length),e.lastIndexOf(t,n)==n}function $s(e,n,i){var r=t.templateSettings;i&&mr(e,n,i)&&(n=$),e=ss(e),n=bc({},n,r,rn);var o,a,s=bc({},n.imports,r.imports,rn),l=bs(s),u=R(s,l),c=0,h=n.interpolate||Mt,d="__p += '",f=Dl((n.escape||Mt).source+"|"+h.source+"|"+(h===ct?bt:Mt).source+"|"+(n.evaluate||Mt).source+"|$","g"),p="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++yn+"]")+"\n";e.replace(f,function(t,n,i,r,s,l){return i||(i=r),d+=e.slice(c,l).replace(Lt,z),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=l+t.length,t}),d+="';\n";var _=n.variable;_||(d="with (obj) {\n"+d+"\n}\n"),d=(a?d.replace(tt,""):d).replace(nt,"$1").replace(it,"$1;"),d="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Hc(function(){return Function(l,p+"return "+d).apply($,u)});if(g.source=d,Ea(g))throw g;return g}function Js(e){return ss(e).toLowerCase()}function Qs(e){return ss(e).toUpperCase()}function el(e,t,n){if(e=ss(e),!e)return e;if(n||t===$)return e.replace(gt,"");if(t+="",!t)return e;var i=K(e),r=K(t);return i.slice(O(i,r),P(i,r)+1).join("")}function tl(e,t,n){if(e=ss(e),!e)return e;if(n||t===$)return e.replace(vt,"");if(t+="",!t)return e;var i=K(e);return i.slice(0,P(i,K(t))+1).join("")}function nl(e,t,n){if(e=ss(e),!e)return e;if(n||t===$)return e.replace(mt,"");if(t+="",!t)return e;var i=K(e);return i.slice(O(i,K(t))).join("")}function il(e,t){var n=he,i=de;if(Pa(t)){var r="separator"in t?t.separator:r;n="length"in t?ns(t.length):n,i="omission"in t?ss(t.omission):i}e=ss(e);var o=e.length;if(pn.test(e)){var a=K(e);o=a.length}if(n>=o)return e;var s=n-X(i);if(1>s)return i;var l=a?a.slice(0,s).join(""):e.slice(0,s);if(r===$)return l+i;if(a&&(s+=l.length-s),Ua(r)){if(e.slice(s).search(r)){var u,c=l;for(r.global||(r=Dl(r.source,ss(xt.exec(r))+"g")),r.lastIndex=0;u=r.exec(c);)var h=u.index;l=l.slice(0,h===$?s:h)}}else if(e.indexOf(r,s)!=s){var d=l.lastIndexOf(r);d>-1&&(l=l.slice(0,d))}return l+i}function rl(e){return e=ss(e),e&&at.test(e)?e.replace(rt,Y):e}function ol(e,t,n){return e=ss(e),t=n?$:t,t===$&&(t=mn.test(e)?gn:_n),e.match(t)||[]}function al(e){var t=e?e.length:0,n=sr();return e=t?g(e,function(e){if("function"!=typeof e[1])throw new Il(ye);return[n(e[0]),e[1]]}):[],aa(function(n){for(var i=-1;++i<t;){var r=e[i];if(s(r[0],this,n))return s(r[1],this,n)}})}function sl(e){return fn(hn(e,!0))}function ll(e){return function(){return e}}function ul(e){return e}function cl(e){return Xn("function"==typeof e?e:hn(e,!0))}function hl(e){return $n(hn(e,!0))}function dl(e,t){return Jn(e,hn(t,!0))}function fl(e,t,n){var i=bs(t),r=Pn(t,i);null!=n||Pa(t)&&(r.length||!i.length)||(n=t,t=e,e=this,r=Pn(t,bs(t)));var o=Pa(n)&&"chain"in n?n.chain:!0,a=La(e);return c(r,function(n){var i=t[n];e[n]=i,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),r=n.__actions__=Di(this.__actions__);return r.push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,m([this.value()],arguments))})}),e}function pl(){return Nn._===this&&(Nn._=jl),this}function _l(){}function gl(e){return e=ns(e),function(){return arguments[e]}}function ml(e){return vr(e)?ri(e):oi(e)}function vl(e){return function(t){return null==e?$:In(e,t)}}function yl(e,t){if(e=ns(e),1>e||e>we)return[];var n=ke,i=uu(e,ke);t=Mr(t),e-=ke;for(var r=E(i,t);++n<e;)t(n);return r}function bl(e){return gc(e)?g(e,String):Tr(e)}function xl(e){var t=++Hl;return ss(e)+t}function wl(e,t){var n;return e===$&&t===$?0:(e!==$&&(n=e),t!==$&&(n=n===$?t:n+t),n)}function Sl(e){return e&&e.length?x(e,ul,ga):$}function Al(e,t){return e&&e.length?x(e,sr(t),ga):$}function kl(e){return Ml(e)/(e?e.length:0)}function Cl(e){return e&&e.length?x(e,ul,Qa):$}function Tl(e,t){return e&&e.length?x(e,sr(t),Qa):$}function El(e,t){var n;return e===$&&t===$?0:(e!==$&&(n=e),t!==$&&(n=n===$?t:n-t),n)}function Ml(e){return e&&e.length?T(e,ul):0}function Ll(e,t){return e&&e.length?T(e,sr(t)):0}e=e?Fn.defaults({},e,Fn.pick(Nn,vn)):Nn;var Rl=e.Date,Ol=e.Error,Pl=e.Math,Dl=e.RegExp,Il=e.TypeError,Nl=e.Array.prototype,Fl=e.Object.prototype,Bl=e.Function.prototype.toString,zl=Fl.hasOwnProperty,Hl=0,ql=Bl.call(Object),Gl=Fl.toString,jl=Nn._,Ul=Dl("^"+Bl.call(zl).replace(pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vl=Dn?e.Buffer:$,Wl=e.Reflect,Xl=e.Symbol,Kl=e.Uint8Array,Yl=e.clearTimeout,Zl=Wl?Wl.enumerate:$,$l=Object.getPrototypeOf,Jl=Object.getOwnPropertySymbols,Ql="symbol"==typeof(Ql=Xl&&Xl.iterator)?Ql:$,eu=Fl.propertyIsEnumerable,tu=e.setTimeout,nu=Nl.splice,iu=Pl.ceil,ru=Pl.floor,ou=e.isFinite,au=Nl.join,su=Object.keys,lu=Pl.max,uu=Pl.min,cu=e.parseInt,hu=Pl.random,du=Nl.reverse,fu=ur(e,"Map"),pu=ur(e,"Set"),_u=ur(e,"WeakMap"),gu=ur(Object,"create"),mu=_u&&new _u,vu=fu?Bl.call(fu):"",yu=pu?Bl.call(pu):"",bu=_u?Bl.call(_u):"",xu=Xl?Xl.prototype:$,wu=Xl?xu.valueOf:$,Su=Xl?xu.toString:$,Au={};t.templateSettings={escape:lt,evaluate:ut,interpolate:ct,variable:"",imports:{_:t}};var ku=function(){function e(){}return function(t){if(Pa(t)){e.prototype=t;var n=new e;e.prototype=$}return n||{}}}(),Cu=Hi(Rn),Tu=Hi(On,!0),Eu=qi(),Mu=qi(!0);Zl&&!eu.call({valueOf:1},"valueOf")&&(Yn=function(e){return j(Zl(e))});var Lu=mu?function(e,t){return mu.set(e,t),e}:ul,Ru=pu&&2===new pu([1,2]).size?function(e){return new pu(e)}:_l,Ou=mu?function(e){return mu.get(e)}:_l,Pu=ri("length"),Du=Jl||function(){return[]};(fu&&cr(new fu)!=Ne||pu&&cr(new pu)!=He||_u&&cr(new _u)!=je)&&(cr=function(e){var t=Gl.call(e),n=t==Be?e.constructor:null,i="function"==typeof n?Bl.call(n):"";if(i)switch(i){case vu:return Ne;case yu:return He;case bu:return je}return t});var Iu=function(){var e=0,t=0;return function(n,i){var r=sc(),o=pe-(r-t);if(t=r,o>0){if(++e>=fe)return n}else e=0;return Lu(n,i)}}(),Nu=aa(function(e,t){return gc(e)||(e=null==e?[]:[Object(e)]),t=Mn(t),u(e,t)}),Fu=aa(function(e,t){return xa(e)?Sn(e,Mn(t,!1,!0)):[]}),Bu=aa(function(e,t){var n=Xr(t);return xa(n)&&(n=$),xa(e)?Sn(e,Mn(t,!1,!0),sr(n)):[]}),zu=aa(function(e,t){var n=Xr(t);return xa(n)&&(n=$),xa(e)?Sn(e,Mn(t,!1,!0),$,n):[];
}),Hu=aa(function(e){var t=g(e,Er);return t.length&&t[0]===e[0]?qn(t):[]}),qu=aa(function(e){var t=Xr(e),n=g(e,Er);return t===Xr(n)?t=$:n.pop(),n.length&&n[0]===e[0]?qn(n,sr(t)):[]}),Gu=aa(function(e){var t=Xr(e),n=g(e,Er);return t===Xr(n)?t=$:n.pop(),n.length&&n[0]===e[0]?qn(n,$,t):[]}),ju=aa(Yr),Uu=aa(function(e,t){t=g(Mn(t),String);var n=un(e,t);return li(e,t.sort(I)),n}),Vu=aa(function(e){return yi(Mn(e,!1,!0))}),Wu=aa(function(e){var t=Xr(e);return xa(t)&&(t=$),yi(Mn(e,!1,!0),sr(t))}),Xu=aa(function(e){var t=Xr(e);return xa(t)&&(t=$),yi(Mn(e,!1,!0),$,t)}),Ku=aa(function(e,t){return xa(e)?Sn(e,t):[]}),Yu=aa(function(e){return Si(f(e,xa))}),Zu=aa(function(e){var t=Xr(e);return xa(t)&&(t=$),Si(f(e,xa),sr(t))}),$u=aa(function(e){var t=Xr(e);return xa(t)&&(t=$),Si(f(e,xa),$,t)}),Ju=aa(mo),Qu=aa(function(e){var t=e.length,n=t>1?e[t-1]:$;return n="function"==typeof n?(e.pop(),n):$,vo(e,n)}),ec=aa(function(e){e=Mn(e);var t=e.length,n=t?e[0]:0,o=this.__wrapped__,a=function(t){return un(t,e)};return!(t>1||this.__actions__.length)&&o instanceof r&&G(n)?(o=o.slice(n,+n+(t?1:0)),o.__actions__.push({func:So,args:[a],thisArg:$}),new i(o,this.__chain__).thru(function(e){return t&&!e.length&&e.push($),e})):this.thru(a)}),tc=Bi(function(e,t,n){zl.call(e,n)?++e[n]:e[n]=1}),nc=Bi(function(e,t,n){zl.call(e,n)?e[n].push(t):e[n]=[t]}),ic=aa(function(e,t,n){var i=-1,r="function"==typeof t,o=vr(t),a=ba(e)?Array(e.length):[];return Cu(e,function(e){var l=r?t:o&&null!=e?e[t]:$;a[++i]=l?s(l,e,n):jn(e,t,n)}),a}),rc=Bi(function(e,t,n){e[n]=t}),oc=Bi(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),ac=aa(function(e,t){if(null==e)return[];var n=t.length;return n>1&&mr(e,t[0],t[1])?t=[]:n>2&&mr(t[0],t[1],t[2])&&(t.length=1),ti(e,Mn(t),[])}),sc=Rl.now,lc=aa(function(e,n,i){var r=Q;if(i.length){var o=t.placeholder||lc.placeholder,a=V(i,o);r|=re}return nr(e,r,n,i,a)}),uc=aa(function(e,n,i){var r=Q|ee;if(i.length){var o=t.placeholder||uc.placeholder,a=V(i,o);r|=re}return nr(n,r,e,i,a)}),cc=aa(function(e,t){return wn(e,1,t)}),hc=aa(function(e,t,n){return wn(e,rs(t)||0,n)}),dc=aa(function(e,t){t=g(Mn(t),sr());var n=t.length;return aa(function(i){for(var r=-1,o=uu(i.length,n);++r<o;)i[r]=t[r].call(this,i[r]);return s(e,this,i)})}),fc=aa(function(e,n){var i=t.placeholder||fc.placeholder,r=V(n,i);return nr(e,re,$,n,r)}),pc=aa(function(e,n){var i=t.placeholder||pc.placeholder,r=V(n,i);return nr(e,oe,$,n,r)}),_c=aa(function(e,t){return nr(e,se,$,$,$,Mn(t))}),gc=Array.isArray,mc=Vl?function(e){return e instanceof Vl}:ll(!1),vc=zi(function(e,t){Ii(t,bs(t),e)}),yc=zi(function(e,t){Ii(t,xs(t),e)}),bc=zi(function(e,t,n,i){Ni(t,xs(t),e,i)}),xc=zi(function(e,t,n,i){Ni(t,bs(t),e,i)}),wc=aa(function(e,t){return un(e,Mn(t))}),Sc=aa(function(e){return e.push($,rn),s(bc,$,e)}),Ac=aa(function(e){return e.push($,Ar),s(Mc,$,e)}),kc=Yi(function(e,t,n){e[t]=n},ll(ul)),Cc=Yi(function(e,t,n){zl.call(e,t)?e[t].push(n):e[t]=[n]},sr),Tc=aa(jn),Ec=zi(function(e,t,n){Qn(e,t,n)}),Mc=zi(function(e,t,n,i){Qn(e,t,n,i)}),Lc=aa(function(e,t){return null==e?{}:(t=g(Mn(t),String),ni(e,Sn(xs(e),t)))}),Rc=aa(function(e,t){return null==e?{}:ni(e,Mn(t))}),Oc=Ui(function(e,t,n){return t=t.toLowerCase(),e+(n?Bs(t):t)}),Pc=Ui(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Dc=Ui(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Ic=ji("toLowerCase"),Nc=ji("toUpperCase"),Fc=Ui(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Bc=Ui(function(e,t,n){return e+(n?" ":"")+Bs(t)}),zc=Ui(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Hc=aa(function(e,t){try{return s(e,$,t)}catch(n){return Pa(n)?n:new Ol(n)}}),qc=aa(function(e,t){return c(Mn(t),function(t){e[t]=lc(e[t],e)}),e}),Gc=Xi(),jc=Xi(!0),Uc=aa(function(e,t){return function(n){return jn(n,e,t)}}),Vc=aa(function(e,t){return function(n){return jn(e,n,t)}}),Wc=Zi(g),Xc=Zi(d),Kc=Zi(b),Yc=Qi(),Zc=Qi(!0),$c=tr("ceil"),Jc=tr("floor"),Qc=tr("round");return t.prototype=n.prototype,i.prototype=ku(n.prototype),i.prototype.constructor=i,r.prototype=ku(n.prototype),r.prototype.constructor=r,Ot.prototype=gu?gu(null):Fl,Ft.prototype.clear=Bt,Ft.prototype["delete"]=zt,Ft.prototype.get=Ht,Ft.prototype.has=qt,Ft.prototype.set=Gt,jt.prototype.push=Vt,Wt.prototype.clear=Xt,Wt.prototype["delete"]=Kt,Wt.prototype.get=Yt,Wt.prototype.has=Zt,Wt.prototype.set=$t,ia.Cache=Ft,t.after=Zo,t.ary=$o,t.assign=vc,t.assignIn=yc,t.assignInWith=bc,t.assignWith=xc,t.at=wc,t.before=Jo,t.bind=lc,t.bindAll=qc,t.bindKey=uc,t.chain=xo,t.chunk=Rr,t.compact=Or,t.concat=Nu,t.cond=al,t.conforms=sl,t.constant=ll,t.countBy=tc,t.create=ls,t.curry=Qo,t.curryRight=ea,t.debounce=ta,t.defaults=Sc,t.defaultsDeep=Ac,t.defer=cc,t.delay=hc,t.difference=Fu,t.differenceBy=Bu,t.differenceWith=zu,t.drop=Pr,t.dropRight=Dr,t.dropRightWhile=Ir,t.dropWhile=Nr,t.fill=Fr,t.filter=Po,t.flatMap=No,t.flatten=Hr,t.flattenDeep=qr,t.flip=na,t.flow=Gc,t.flowRight=jc,t.fromPairs=Gr,t.functions=_s,t.functionsIn=gs,t.groupBy=nc,t.initial=Vr,t.intersection=Hu,t.intersectionBy=qu,t.intersectionWith=Gu,t.invert=kc,t.invertBy=Cc,t.invokeMap=ic,t.iteratee=cl,t.keyBy=rc,t.keys=bs,t.keysIn=xs,t.map=Ho,t.mapKeys=ws,t.mapValues=Ss,t.matches=hl,t.matchesProperty=dl,t.memoize=ia,t.merge=Ec,t.mergeWith=Mc,t.method=Uc,t.methodOf=Vc,t.mixin=fl,t.negate=ra,t.nthArg=gl,t.omit=Lc,t.omitBy=As,t.once=oa,t.orderBy=qo,t.over=Wc,t.overArgs=dc,t.overEvery=Xc,t.overSome=Kc,t.partial=fc,t.partialRight=pc,t.partition=oc,t.pick=Rc,t.pickBy=ks,t.property=ml,t.propertyOf=vl,t.pull=ju,t.pullAll=Yr,t.pullAllBy=Zr,t.pullAt=Uu,t.range=Yc,t.rangeRight=Zc,t.rearg=_c,t.reject=Uo,t.remove=$r,t.rest=aa,t.reverse=Jr,t.sampleSize=Wo,t.set=Ts,t.setWith=Es,t.shuffle=Xo,t.slice=Qr,t.sortBy=ac,t.sortedUniq=ao,t.sortedUniqBy=so,t.split=Ys,t.spread=sa,t.tail=lo,t.take=uo,t.takeRight=co,t.takeRightWhile=ho,t.takeWhile=fo,t.tap=wo,t.throttle=la,t.thru=So,t.toArray=ts,t.toPairs=Ms,t.toPairsIn=Ls,t.toPath=bl,t.toPlainObject=os,t.transform=Rs,t.unary=ua,t.union=Vu,t.unionBy=Wu,t.unionWith=Xu,t.uniq=po,t.uniqBy=_o,t.uniqWith=go,t.unset=Os,t.unzip=mo,t.unzipWith=vo,t.values=Ps,t.valuesIn=Ds,t.without=Ku,t.words=ol,t.wrap=ca,t.xor=Yu,t.xorBy=Zu,t.xorWith=$u,t.zip=Ju,t.zipObject=yo,t.zipObjectDeep=bo,t.zipWith=Qu,t.extend=yc,t.extendWith=bc,fl(t,t),t.add=wl,t.attempt=Hc,t.camelCase=Oc,t.capitalize=Bs,t.ceil=$c,t.clamp=Is,t.clone=ha,t.cloneDeep=fa,t.cloneDeepWith=pa,t.cloneWith=da,t.deburr=zs,t.endsWith=Hs,t.eq=_a,t.escape=qs,t.escapeRegExp=Gs,t.every=Oo,t.find=Do,t.findIndex=Br,t.findKey=us,t.findLast=Io,t.findLastIndex=zr,t.findLastKey=cs,t.floor=Jc,t.forEach=Fo,t.forEachRight=Bo,t.forIn=hs,t.forInRight=ds,t.forOwn=fs,t.forOwnRight=ps,t.get=ms,t.gt=ga,t.gte=ma,t.has=vs,t.hasIn=ys,t.head=jr,t.identity=ul,t.includes=zo,t.indexOf=Ur,t.inRange=Ns,t.invoke=Tc,t.isArguments=va,t.isArray=gc,t.isArrayBuffer=ya,t.isArrayLike=ba,t.isArrayLikeObject=xa,t.isBoolean=wa,t.isBuffer=mc,t.isDate=Sa,t.isElement=Aa,t.isEmpty=ka,t.isEqual=Ca,t.isEqualWith=Ta,t.isError=Ea,t.isFinite=Ma,t.isFunction=La,t.isInteger=Ra,t.isLength=Oa,t.isMap=Ia,t.isMatch=Na,t.isMatchWith=Fa,t.isNaN=Ba,t.isNative=za,t.isNil=qa,t.isNull=Ha,t.isNumber=Ga,t.isObject=Pa,t.isObjectLike=Da,t.isPlainObject=ja,t.isRegExp=Ua,t.isSafeInteger=Va,t.isSet=Wa,t.isString=Xa,t.isSymbol=Ka,t.isTypedArray=Ya,t.isUndefined=Za,t.isWeakMap=$a,t.isWeakSet=Ja,t.join=Wr,t.kebabCase=Pc,t.last=Xr,t.lastIndexOf=Kr,t.lowerCase=Dc,t.lowerFirst=Ic,t.lt=Qa,t.lte=es,t.max=Sl,t.maxBy=Al,t.mean=kl,t.min=Cl,t.minBy=Tl,t.noConflict=pl,t.noop=_l,t.now=sc,t.pad=js,t.padEnd=Us,t.padStart=Vs,t.parseInt=Ws,t.random=Fs,t.reduce=Go,t.reduceRight=jo,t.repeat=Xs,t.replace=Ks,t.result=Cs,t.round=Qc,t.runInContext=Z,t.sample=Vo,t.size=Ko,t.snakeCase=Fc,t.some=Yo,t.sortedIndex=eo,t.sortedIndexBy=to,t.sortedIndexOf=no,t.sortedLastIndex=io,t.sortedLastIndexBy=ro,t.sortedLastIndexOf=oo,t.startCase=Bc,t.startsWith=Zs,t.subtract=El,t.sum=Ml,t.sumBy=Ll,t.template=$s,t.times=yl,t.toInteger=ns,t.toLength=is,t.toLower=Js,t.toNumber=rs,t.toSafeInteger=as,t.toString=ss,t.toUpper=Qs,t.trim=el,t.trimEnd=tl,t.trimStart=nl,t.truncate=il,t.unescape=rl,t.uniqueId=xl,t.upperCase=zc,t.upperFirst=Nc,t.each=Fo,t.eachRight=Bo,t.first=jr,fl(t,function(){var e={};return Rn(t,function(n,i){zl.call(t.prototype,i)||(e[i]=n)}),e}(),{chain:!1}),t.VERSION=J,c(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){t[e].placeholder=t}),c(["drop","take"],function(e,t){r.prototype[e]=function(n){var i=this.__filtered__;if(i&&!t)return new r(this);n=n===$?1:lu(ns(n),0);var o=this.clone();return i?o.__takeCount__=uu(n,o.__takeCount__):o.__views__.push({size:uu(n,ke),type:e+(o.__dir__<0?"Right":"")}),o},r.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),c(["filter","map","takeWhile"],function(e,t){var n=t+1,i=n==ge||n==ve;r.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:sr(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}}),c(["head","last"],function(e,t){var n="take"+(t?"Right":"");r.prototype[e]=function(){return this[n](1).value()[0]}}),c(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");r.prototype[e]=function(){return this.__filtered__?new r(this):this[n](1)}}),r.prototype.compact=function(){return this.filter(ul)},r.prototype.find=function(e){return this.filter(e).head()},r.prototype.findLast=function(e){return this.reverse().find(e)},r.prototype.invokeMap=aa(function(e,t){return"function"==typeof e?new r(this):this.map(function(n){return jn(n,e,t)})}),r.prototype.reject=function(e){return e=sr(e,3),this.filter(function(t){return!e(t)})},r.prototype.slice=function(e,t){e=ns(e);var n=this;return n.__filtered__&&(e>0||0>t)?new r(n):(0>e?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==$&&(t=ns(t),n=0>t?n.dropRight(-t):n.take(t-e)),n)},r.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},r.prototype.toArray=function(){return this.take(ke)},Rn(r.prototype,function(e,n){var o=/^(?:filter|find|map|reject)|While$/.test(n),a=/^(?:head|last)$/.test(n),s=t[a?"take"+("last"==n?"Right":""):n],l=a||/^find/.test(n);s&&(t.prototype[n]=function(){var n=this.__wrapped__,u=a?[1]:arguments,c=n instanceof r,h=u[0],d=c||gc(n),f=function(e){var n=s.apply(t,m([e],u));return a&&p?n[0]:n};d&&o&&"function"==typeof h&&1!=h.length&&(c=d=!1);var p=this.__chain__,_=!!this.__actions__.length,g=l&&!p,v=c&&!_;if(!l&&d){n=v?n:new r(this);var y=e.apply(n,u);return y.__actions__.push({func:So,args:[f],thisArg:$}),new i(y,p)}return g&&v?e.apply(this,u):(y=this.thru(f),g?a?y.value()[0]:y.value():y)})}),c(["pop","push","shift","sort","splice","unshift"],function(e){var n=Nl[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);t.prototype[e]=function(){var e=arguments;return r&&!this.__chain__?n.apply(this.value(),e):this[i](function(t){return n.apply(t,e)})}}),Rn(r.prototype,function(e,n){var i=t[n];if(i){var r=i.name+"",o=Au[r]||(Au[r]=[]);o.push({name:n,func:i})}}),Au[Ki($,ee).name]=[{name:"wrapper",func:$}],r.prototype.clone=D,r.prototype.reverse=Tt,r.prototype.value=Rt,t.prototype.at=ec,t.prototype.chain=Ao,t.prototype.commit=ko,t.prototype.flatMap=Co,t.prototype.next=To,t.prototype.plant=Mo,t.prototype.reverse=Lo,t.prototype.toJSON=t.prototype.valueOf=t.prototype.value=Ro,Ql&&(t.prototype[Ql]=Eo),t}var $,J="4.3.0",Q=1,ee=2,te=4,ne=8,ie=16,re=32,oe=64,ae=128,se=256,le=512,ue=1,ce=2,he=30,de="...",fe=150,pe=16,_e=200,ge=1,me=2,ve=3,ye="Expected a function",be="__lodash_hash_undefined__",xe=1/0,we=9007199254740991,Se=1.7976931348623157e308,Ae=NaN,ke=4294967295,Ce=ke-1,Te=ke>>>1,Ee="__lodash_placeholder__",Me="[object Arguments]",Le="[object Array]",Re="[object Boolean]",Oe="[object Date]",Pe="[object Error]",De="[object Function]",Ie="[object GeneratorFunction]",Ne="[object Map]",Fe="[object Number]",Be="[object Object]",ze="[object RegExp]",He="[object Set]",qe="[object String]",Ge="[object Symbol]",je="[object WeakMap]",Ue="[object WeakSet]",Ve="[object ArrayBuffer]",We="[object Float32Array]",Xe="[object Float64Array]",Ke="[object Int8Array]",Ye="[object Int16Array]",Ze="[object Int32Array]",$e="[object Uint8Array]",Je="[object Uint8ClampedArray]",Qe="[object Uint16Array]",et="[object Uint32Array]",tt=/\b__p \+= '';/g,nt=/\b(__p \+=) '' \+/g,it=/(__e\(.*?\)|\b__t\)) \+\n'';/g,rt=/&(?:amp|lt|gt|quot|#39|#96);/g,ot=/[&<>"'`]/g,at=RegExp(rt.source),st=RegExp(ot.source),lt=/<%-([\s\S]+?)%>/g,ut=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dt=/^\w*$/,ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,pt=/[\\^$.*+?()[\]{}|]/g,_t=RegExp(pt.source),gt=/^\s+|\s+$/g,mt=/^\s+/,vt=/\s+$/,yt=/\\(\\)?/g,bt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xt=/\w*$/,wt=/^0x/i,St=/^[-+]0x[0-9a-f]+$/i,At=/^0b[01]+$/i,kt=/^\[object .+?Constructor\]$/,Ct=/^0o[0-7]+$/i,Tt=/^(?:0|[1-9]\d*)$/,Et=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Mt=/($^)/,Lt=/['\n\r\u2028\u2029\\]/g,Rt="\\ud800-\\udfff",Ot="\\u0300-\\u036f\\ufe20-\\ufe23",Pt="\\u20d0-\\u20f0",Dt="\\u2700-\\u27bf",It="a-z\\xdf-\\xf6\\xf8-\\xff",Nt="\\xac\\xb1\\xd7\\xf7",Ft="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Bt="\\u2018\\u2019\\u201c\\u201d",zt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ht="A-Z\\xc0-\\xd6\\xd8-\\xde",qt="\\ufe0e\\ufe0f",Gt=Nt+Ft+Bt+zt,jt="["+Rt+"]",Ut="["+Gt+"]",Vt="["+Ot+Pt+"]",Wt="\\d+",Xt="["+Dt+"]",Kt="["+It+"]",Yt="[^"+Rt+Gt+Wt+Dt+It+Ht+"]",Zt="\\ud83c[\\udffb-\\udfff]",$t="(?:"+Vt+"|"+Zt+")",Jt="[^"+Rt+"]",Qt="(?:\\ud83c[\\udde6-\\uddff]){2}",en="[\\ud800-\\udbff][\\udc00-\\udfff]",tn="["+Ht+"]",nn="\\u200d",rn="(?:"+Kt+"|"+Yt+")",on="(?:"+tn+"|"+Yt+")",an=$t+"?",sn="["+qt+"]?",ln="(?:"+nn+"(?:"+[Jt,Qt,en].join("|")+")"+sn+an+")*",un=sn+an+ln,cn="(?:"+[Xt,Qt,en].join("|")+")"+un,hn="(?:"+[Jt+Vt+"?",Vt,Qt,en,jt].join("|")+")",dn=RegExp(Vt,"g"),fn=RegExp(Zt+"(?="+Zt+")|"+hn+un,"g"),pn=RegExp("["+nn+Rt+Ot+Pt+qt+"]"),_n=/[a-zA-Z0-9]+/g,gn=RegExp([tn+"?"+Kt+"+(?="+[Ut,tn,"$"].join("|")+")",on+"+(?="+[Ut,tn+rn,"$"].join("|")+")",tn+"?"+rn+"+",tn+"+",Wt,cn].join("|"),"g"),mn=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,vn=["Array","Buffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yn=-1,bn={};bn[We]=bn[Xe]=bn[Ke]=bn[Ye]=bn[Ze]=bn[$e]=bn[Je]=bn[Qe]=bn[et]=!0,bn[Me]=bn[Le]=bn[Ve]=bn[Re]=bn[Oe]=bn[Pe]=bn[De]=bn[Ne]=bn[Fe]=bn[Be]=bn[ze]=bn[He]=bn[qe]=bn[je]=!1;var xn={};xn[Me]=xn[Le]=xn[Ve]=xn[Re]=xn[Oe]=xn[We]=xn[Xe]=xn[Ke]=xn[Ye]=xn[Ze]=xn[Ne]=xn[Fe]=xn[Be]=xn[ze]=xn[He]=xn[qe]=xn[Ge]=xn[$e]=xn[Je]=xn[Qe]=xn[et]=!0,xn[Pe]=xn[De]=xn[je]=!1;var wn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Sn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},An={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},kn={"function":!0,object:!0},Cn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Tn=parseFloat,En=parseInt,Mn=kn[typeof t]&&t&&!t.nodeType?t:null,Ln=kn[typeof e]&&e&&!e.nodeType?e:null,Rn=D(Mn&&Ln&&"object"==typeof r&&r),On=D(kn[typeof self]&&self),Pn=D(kn[typeof window]&&window),Dn=Ln&&Ln.exports===Mn?Mn:null,In=D(kn[typeof this]&&this),Nn=Rn||Pn!==(In&&In.window)&&Pn||On||In||Function("return this")(),Fn=Z();(Pn||On||{})._=Fn,i=function(){return Fn}.call(t,n,t,e),!(i!==$&&(e.exports=i))}).call(this)}).call(t,n(220)(e),function(){return this}())},function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(){}t.__esModule=!0,t.compose=t.applyMiddleware=t.bindActionCreators=t.combineReducers=t.createStore=void 0;var o=n(235),a=i(o),s=n(239),l=i(s),u=n(241),c=i(u),h=n(242),d=i(h),f=n(243),p=i(f),_=n(240),g=i(_);"production"!==e.env.NODE_ENV&&"string"==typeof r.name&&"isCrushed"!==r.name&&(0,g["default"])("You are currently using minified code outside of NODE_ENV === 'production'. This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) to ensure you have the correct code for your production build."),t.createStore=a["default"],t.combineReducers=l["default"],t.bindActionCreators=c["default"],t.applyMiddleware=d["default"],t.compose=p["default"]}).call(t,n(190))},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){function i(){p===f&&(p=f.slice())}function o(){return d}function l(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return i(),p.push(e),function(){if(t){t=!1,i();var n=p.indexOf(e);p.splice(n,1)}}}function u(e){if(!(0,a["default"])(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"==typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(_)throw new Error("Reducers may not dispatch actions.");try{_=!0,d=h(d,e)}finally{_=!1}for(var t=f=p,n=0;n<t.length;n++)t[n]();return e}function c(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");h=e,u({type:s.INIT})}if("function"==typeof t&&"undefined"==typeof n&&(n=t,t=void 0),"undefined"!=typeof n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(r)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var h=e,d=t,f=[],p=f,_=!1;return u({type:s.INIT}),{dispatch:u,subscribe:l,getState:o,replaceReducer:c}}t.__esModule=!0,t.ActionTypes=void 0,t["default"]=r;var o=n(236),a=i(o),s=t.ActionTypes={INIT:"@@redux/INIT"}},function(e,t,n){function i(e){if(!o(e)||c.call(e)!=a||r(e))return!1;var t=s;if("function"==typeof e.constructor&&(t=h(e)),null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==u}var r=n(237),o=n(238),a="[object Object]",s=Object.prototype,l=Function.prototype.toString,u=l.call(Object),c=s.toString,h=Object.getPrototypeOf;e.exports=i},function(e,t){function n(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}e.exports=n},function(e,t){function n(e){return!!e&&"object"==typeof e}e.exports=n},function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){var n=t&&t.type,i=n&&'"'+n.toString()+'"'||"an action";return'Reducer "'+e+'" returned undefined handling '+i+". To ignore an action, you must explicitly return the previous state."}function o(e,t,n){var i=Object.keys(t),r=n&&n.type===l.ActionTypes.INIT?"initialState argument passed to createStore":"previous state received by the reducer";if(0===i.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!(0,c["default"])(e))return"The "+r+' has unexpected type of "'+{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1]+'". Expected argument to be an object with the following '+('keys: "'+i.join('", "')+'"');var o=Object.keys(e).filter(function(e){return!t.hasOwnProperty(e)});return o.length>0?"Unexpected "+(o.length>1?"keys":"key")+" "+('"'+o.join('", "')+'" found in '+r+". ")+"Expected to find one of the known reducer keys instead: "+('"'+i.join('", "')+'". Unexpected keys will be ignored.'):void 0}function a(e){Object.keys(e).forEach(function(t){var n=e[t],i=n(void 0,{type:l.ActionTypes.INIT});if("undefined"==typeof i)throw new Error('Reducer "'+t+'" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined.');var r="@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".");if("undefined"==typeof n(void 0,{type:r}))throw new Error('Reducer "'+t+'" returned undefined when probed with a random type. '+("Don't try to handle "+l.ActionTypes.INIT+' or other actions in "redux/*" ')+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined.")})}function s(t){for(var n=Object.keys(t),i={},s=0;s<n.length;s++){var l=n[s];"function"==typeof t[l]&&(i[l]=t[l])}var u,c=Object.keys(i);try{a(i)}catch(h){u=h}return function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments[1];if(u)throw u;if("production"!==e.env.NODE_ENV){var a=o(t,i,n);a&&(0,d["default"])(a)}for(var s=!1,l={},h=0;h<c.length;h++){var f=c[h],p=i[f],_=t[f],g=p(_,n);if("undefined"==typeof g){var m=r(f,n);throw new Error(m)}l[f]=g,s=s||g!==_}return s?l:t}}t.__esModule=!0,t["default"]=s;var l=n(235),u=n(236),c=i(u),h=n(240),d=i(h)}).call(t,n(190))},function(e,t){"use strict";function n(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(t){}}t.__esModule=!0,t["default"]=n},function(e,t){"use strict";function n(e,t){return function(){return t(e.apply(void 0,arguments))}}function i(e,t){if("function"==typeof e)return n(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var i=Object.keys(e),r={},o=0;o<i.length;o++){var a=i[o],s=e[a];"function"==typeof s&&(r[a]=n(s,t))}return r}t.__esModule=!0,t["default"]=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){return function(n,i,r){var a=e(n,i,r),l=a.dispatch,u=[],c={getState:a.getState,dispatch:function(e){return l(e)}};return u=t.map(function(e){return e(c)}),l=s["default"].apply(void 0,u)(a.dispatch),o({},a,{dispatch:l})}}}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.__esModule=!0,t["default"]=r;var a=n(243),s=i(a)},function(e,t){"use strict";function n(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(){if(0===t.length)return arguments.length<=0?void 0:arguments[0];var e=t[t.length-1],n=t.slice(0,-1);return n.reduceRight(function(e,t){return t(e)},e.apply(void 0,arguments))}}t.__esModule=!0,t["default"]=n},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t,n){var i=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],r=u["default"].select(e),o=r.select("#"+n);return o.empty()?r.append(t).attr("id",n).call(function(e){for(var t in i)e.attr(t,i[t])}).node():o.node()}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=t.App=void 0;var s,l=n(231),u=r(l),c=n(232),h=n(245),d=n(310),f=i(d),p=n(317),_=r(p),g="@INC",m="@DEC",v=t.App=(0,c.createView)({name:"App",model:{pages:[h.Title,h.Cell,h.Pathway,h.Protein,h.Genome,h.Questions],navButtons:_["default"]},init:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=(0,c.addressAction)(g,(0,c.addressRelFrom)(["navButtons"])),n=(0,c.addressAction)(m,(0,c.addressRelFrom)(["navButtons"]));return{pages:[h.Title,h.Cell,h.Pathway,h.Protein,h.Genome,h.Questions].map(function(t,n){return t.init(n,e)}),navButtons:_["default"].init(t,n,e),currentIndex:e,lastCurrentIndex:null}},actionCreators:Object.assign((0,c.createAsyncActionCreators)((s={},o(s,g,function(){return function(e,t){var n=Math.min(t.currentIndex+1,t.pages.length-1);e[f.CHANGE](n)}}),o(s,m,function(){return function(e,t){var n=Math.max(t.currentIndex-1,0);e[f.CHANGE](n)}}),s)),f.actionCreators),getReducer:f.getReducer,create:function(e,t,n){u["default"].select(n).attr("id","app")},update:function(e,t,n){return{pages:[a(n,"div","title",{"class":"page"}),a(n,"div","cell",{"class":"page"}),a(n,"div","pathway",{"class":"page"}),a(n,"div","protein",{"class":"page"}),a(n,"div","genome",{"class":"page"}),a(n,"div","questions",{"class":"page"})],navButtons:a(n,"div","nav-buttons")}},getAPI:function(e){return{change:e[f.CHANGE],goIn:e[g],goOut:e[m]}}});t["default"]=v},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Questions=t.Genome=t.Protein=t.Pathway=t.Cell=t.Title=void 0;var o=n(231),a=r(o),s=n(192),l=i(s),u=n(246),c=i(u),h=n(247),d=n(232),f=n(310),p=i(f);n(311);var _=n(315),g=r(_),m=n(316),v=r(m);t.Title=(0,d.createView)({name:"Title",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(e,t,n){var i=a["default"].select(n);i.append("img").attr("src","logo.svg").attr("class","title-img centered"),i.append("img").attr("src","start-here.svg").attr("class","start-img")},update:p.update}),t.Cell=(0,d.createView)({name:"Cell",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(e,t,n){var i=a["default"].select(n);i.append("img").attr("src","cell.svg").attr("class","cell-img centered"),i.append("div").attr("class","overlay bottom left").text("This demo provides a glimpse of the multi-scale visualizations that will be possible with Escher Cell.")},update:p.update}),t.Pathway=(0,d.createView)({name:"Pathway",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(e,t,n){var i=a["default"].select(n),r=i.append("div").attr("class","escher-container");l.Builder(g["default"],null,null,r,{reaction_data:v["default"],reaction_styles:["abs","color","size","text"],menu:"zoom",never_ask_before_quit:!0,fill_screen:!0,enable_keys:!1,zoom_to_element:{type:"reaction",id:"1576769"}}),i.append("div").attr("class","overlay bottom right").text("Visualize omics data on biochemical pathways. Try panning and zooming to see more of central metabolism.")},update:p.update}),t.Protein=(0,d.createView)({name:"Protein",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(e,t,n,i){var r=a["default"].select(n);if(!c.isWebGLSupported()){var o=r.append("div").attr("class","webgl-message");return o.append("h3").text("Cannot display the interactive protein viewer"),o.append("p").text("WebGL not supported by this browser. ").append("a").attr("href","https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API").attr("target","_blank").text("Learn more about WebGL"),void o.append("img").attr("class","protein-screen centered").attr("src","protein_screen.png")}r.style("display","block");var s={width:"auto",height:"auto",antialias:!0,quality:"high",fog:!1},l=c.Viewer(n,s);c.io.fetchPdb("http://www.rcsb.org/pdb/files/4WNC.pdb",function(e){if(!e)throw Error("Could not load structure");l.cartoon("protein",e,{color:c.color.ssSuccession()});l.setCenter(e.center()),l.setRotation([.17,.14,.97,.09,.98,-.16,-.97,.12,.15]),l.autoZoom()}),r.append("div").attr("class","overlay bottom left").text("Stepping into the visualization reveals interactive protein structures. Try rotating the structure for the glyceraldehye-3-phosphate dehydrogenase enzyme.")},update:p.update}),t.Genome=(0,d.createView)({name:"Genome",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(e,t,n,i){var r=a["default"].select(n);r.style("display","block"),r.append("div").attr("id","svgHolder").attr("class","genome-center"),new h.Browser({chr:"chr",viewStart:1859699,viewEnd:1863062,noPersist:!0,disablePoweredBy:!0,noTitle:!0,coordSystem:{speciesName:"Escherichia coli",ucscName:"eschColi_K12"},browserLinks:{Ensembl:"http://www.ensembl.org/Escherichia_coli/Location/View?r=${chr}:${start}-${end}"},sources:[{name:"Genome",uri:"http://microbes.ucsc.edu/cgi-bin/das/eschColi_K12/",tier_type:"sequence",provides_entrypoints:!0},{name:"Genes",desc:"Genes",uri:"http://microbes.ucsc.edu/cgi-bin/das/eschColi_K12/",stylesheet_uri:"gencode.xml",tier_type:"refSeq",collapseSuperGroups:!0,provides_karyotype:!0}]}),r.append("div").attr("class","overlay bottom right").text("Stepping down another level reveals the gene in the context of the genome. A fully featured genome browser will be available for visualizing omics data. Try zooming out to see nearby genes.")},update:p.update}),t.Questions=(0,d.createView)({name:"Questions",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(e,t,n){var i=a["default"].select(n),r=i.append("div").attr("class","overlay top center");r.append("img").attr("src","logo.svg").attr("class","title-questions-img");var o=r.append("p");o.append("span").text("Right now, Escher Cell is just a demo. When we get started, you will be able to follow our progress on "),o.append("a").attr("href","https://github.com/escher/escher-cell").text("GitHub"),o.append("span").text(". If you have questions, you can contact Zachary King at zaking [at] ucsd [dot] edu. Source code for this demo is available "),o.append("a").attr("href","https://github.com/zakandrewking/osp").text("here"),o.append("span").text(".")},update:p.update})},function(e,t,n){var i,r,o;!function(n,a){r=[],i=a,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(this,function(){var e,t,n,i,r,o,a,s,l,u,c,h,d,f,p,_,g,m,v,y,b,x,w,S,A,k,C,T,E,M,L,R,O,P,D,I,N,F,B,z,H,q,G,j,U,V,W;return e=function(){var e={};if(!t)var t=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;if(!i)var i=Math.random;var r={};r.setMatrixArrayType=function(e){n=e},e.glMatrix=r;var o={};o.create=function(){var e=new n(3);return e[0]=0,e[1]=0,e[2]=0,e},o.clone=function(e){var t=new n(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.fromValues=function(e,t,i){var r=new n(3);return r[0]=e,r[1]=t,r[2]=i,r},o.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},o.set=function(e,t,n,i){return e[0]=t,e[1]=n,e[2]=i,e},o.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},o.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},o.sub=o.subtract,o.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e},o.mul=o.multiply,o.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e},o.div=o.divide,o.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},o.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},o.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},o.scaleAndAdd=function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e},o.distance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(n*n+i*i+r*r)},o.dist=o.distance,o.squaredDistance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return n*n+i*i+r*r},o.sqrDist=o.squaredDistance,
o.length=function(e){var t=e[0],n=e[1],i=e[2];return Math.sqrt(t*t+n*n+i*i)},o.len=o.length,o.squaredLength=function(e){var t=e[0],n=e[1],i=e[2];return t*t+n*n+i*i},o.sqrLen=o.squaredLength,o.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},o.normalize=function(e,t){var n=t[0],i=t[1],r=t[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.cross=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=n[0],s=n[1],l=n[2];return e[0]=r*l-o*s,e[1]=o*a-i*l,e[2]=i*s-r*a,e},o.lerp=function(e,t,n,i){var r=t[0],o=t[1],a=t[2];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e[2]=a+i*(n[2]-a),e},o.random=function(e,t){t=t||1;var n=2*i()*Math.PI,r=2*i()-1,o=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=r*t,e},o.transformMat4=function(e,t,n){var i=t[0],r=t[1],o=t[2];return e[0]=n[0]*i+n[4]*r+n[8]*o+n[12],e[1]=n[1]*i+n[5]*r+n[9]*o+n[13],e[2]=n[2]*i+n[6]*r+n[10]*o+n[14],e},o.transformMat3=function(e,t,n){var i=t[0],r=t[1],o=t[2];return e[0]=i*n[0]+r*n[3]+o*n[6],e[1]=i*n[1]+r*n[4]+o*n[7],e[2]=i*n[2]+r*n[5]+o*n[8],e},o.transformQuat=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=n[0],s=n[1],l=n[2],u=n[3],c=u*i+s*o-l*r,h=u*r+l*i-a*o,d=u*o+a*r-s*i,f=-a*i-s*r-l*o;return e[0]=c*u+f*-a+h*-l-d*-s,e[1]=h*u+f*-s+d*-a-c*-l,e[2]=d*u+f*-l+c*-s-h*-a,e},o.forEach=function(){var e=o.create();return function(t,n,i,r,o,a){var s,l;for(n||(n=3),i||(i=0),l=r?Math.min(r*n+i,t.length):t.length,s=i;l>s;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),o.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},e.vec3=o;var a={};a.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},a.clone=function(e){var t=new n(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.fromValues=function(e,t,i,r){var o=new n(4);return o[0]=e,o[1]=t,o[2]=i,o[3]=r,o},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.set=function(e,t,n,i,r){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e},a.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},a.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e},a.sub=a.subtract,a.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e},a.mul=a.multiply,a.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e},a.div=a.divide,a.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},a.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},a.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},a.scaleAndAdd=function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e[3]=t[3]+n[3]*i,e},a.distance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+i*i+r*r+o*o)},a.dist=a.distance,a.squaredDistance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return n*n+i*i+r*r+o*o},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return Math.sqrt(t*t+n*n+i*i+r*r)},a.len=a.length,a.squaredLength=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return t*t+n*n+i*i+r*r},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},a.normalize=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n*n+i*i+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.lerp=function(e,t,n,i){var r=t[0],o=t[1],a=t[2],s=t[3];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e[2]=a+i*(n[2]-a),e[3]=s+i*(n[3]-s),e},a.random=function(e,t){return t=t||1,e[0]=i(),e[1]=i(),e[2]=i(),e[3]=i(),a.normalize(e,e),a.scale(e,e,t),e},a.transformMat4=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3];return e[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,e[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,e[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,e[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,e},a.transformQuat=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=n[0],s=n[1],l=n[2],u=n[3],c=u*i+s*o-l*r,h=u*r+l*i-a*o,d=u*o+a*r-s*i,f=-a*i-s*r-l*o;return e[0]=c*u+f*-a+h*-l-d*-s,e[1]=h*u+f*-s+d*-a-c*-l,e[2]=d*u+f*-l+c*-s-h*-a,e},a.forEach=function(){var e=a.create();return function(t,n,i,r,o,a){var s,l;for(n||(n=4),i||(i=0),l=r?Math.min(r*n+i,t.length):t.length,s=i;l>s;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),a.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},e.vec4=a;var s={};s.create=function(){var e=new n(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},s.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},s.clone=function(e){var t=new n(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},s.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},s.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},s.transpose=function(e,t){if(e===t){var n=t[1],i=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=i,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},s.invert=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=c*a-s*u,d=-c*o+s*l,f=u*o-a*l,p=n*h+i*d+r*f;return p?(p=1/p,e[0]=h*p,e[1]=(-c*i+r*u)*p,e[2]=(s*i-r*a)*p,e[3]=d*p,e[4]=(c*n-r*l)*p,e[5]=(-s*n+r*o)*p,e[6]=f*p,e[7]=(-u*n+i*l)*p,e[8]=(a*n-i*o)*p,e):null},s.adjoint=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8];return e[0]=a*c-s*u,e[1]=r*u-i*c,e[2]=i*s-r*a,e[3]=s*l-o*c,e[4]=n*c-r*l,e[5]=r*o-n*s,e[6]=o*u-a*l,e[7]=i*l-n*u,e[8]=n*a-i*o,e},s.determinant=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8];return t*(u*o-a*l)+n*(-u*r+a*s)+i*(l*r-o*s)},s.multiply=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=n[0],f=n[1],p=n[2],_=n[3],g=n[4],m=n[5],v=n[6],y=n[7],b=n[8];return e[0]=d*i+f*a+p*u,e[1]=d*r+f*s+p*c,e[2]=d*o+f*l+p*h,e[3]=_*i+g*a+m*u,e[4]=_*r+g*s+m*c,e[5]=_*o+g*l+m*h,e[6]=v*i+y*a+b*u,e[7]=v*r+y*s+b*c,e[8]=v*o+y*l+b*h,e},s.mul=s.multiply,s.translate=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=n[0],f=n[1];return e[0]=i,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=d*i+f*a+u,e[7]=d*r+f*s+c,e[8]=d*o+f*l+h,e},s.rotate=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=Math.sin(n),f=Math.cos(n);return e[0]=f*i+d*a,e[1]=f*r+d*s,e[2]=f*o+d*l,e[3]=f*a-d*i,e[4]=f*s-d*r,e[5]=f*l-d*o,e[6]=u,e[7]=c,e[8]=h,e},s.fromQuat=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n+n,s=i+i,l=r+r,u=n*a,c=n*s,h=n*l,d=i*s,f=i*l,p=r*l,_=o*a,g=o*s,m=o*l;return e[0]=1-(d+p),e[3]=c+m,e[6]=h-g,e[1]=c-m,e[4]=1-(u+p),e[7]=f+_,e[2]=h+g,e[5]=f-_,e[8]=1-(u+d),e},s.normalFromMat4=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],_=t[13],g=t[14],m=t[15],v=n*s-i*a,y=n*l-r*a,b=n*u-o*a,x=i*l-r*s,w=i*u-o*s,S=r*u-o*l,A=c*_-h*p,k=c*g-d*p,C=c*m-f*p,T=h*g-d*_,E=h*m-f*_,M=d*m-f*g,L=v*M-y*E+b*T+x*C-w*k+S*A;return L?(L=1/L,e[0]=(s*M-l*E+u*T)*L,e[1]=(l*C-a*M-u*k)*L,e[2]=(a*E-s*C+u*A)*L,e[3]=(r*E-i*M-o*T)*L,e[4]=(n*M-r*C+o*k)*L,e[5]=(i*C-n*E-o*A)*L,e[6]=(_*S-g*w+m*x)*L,e[7]=(g*b-p*S-m*y)*L,e[8]=(p*w-_*b+m*v)*L,e):null},s.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},e.mat3=s;var l={};l.create=function(){var e=new n(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},l.fromValues=function(e,t,i,r,o,a,s,l,u,c,h,d,f,p,_,g){var m=new n(16);return m[0]=e,m[1]=t,m[2]=i,m[3]=r,m[4]=o,m[5]=a,m[6]=s,m[7]=l,m[8]=u,m[9]=c,m[10]=h,m[11]=d,m[12]=f,m[13]=p,m[14]=_,m[15]=g,m},l.clone=function(e){var t=new n(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},l.transpose=function(e,t){if(e===t){var n=t[1],i=t[2],r=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=o,e[11]=t[14],e[12]=r,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},l.invert=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],_=t[13],g=t[14],m=t[15],v=n*s-i*a,y=n*l-r*a,b=n*u-o*a,x=i*l-r*s,w=i*u-o*s,S=r*u-o*l,A=c*_-h*p,k=c*g-d*p,C=c*m-f*p,T=h*g-d*_,E=h*m-f*_,M=d*m-f*g,L=v*M-y*E+b*T+x*C-w*k+S*A;return L?(L=1/L,e[0]=(s*M-l*E+u*T)*L,e[1]=(r*E-i*M-o*T)*L,e[2]=(_*S-g*w+m*x)*L,e[3]=(d*w-h*S-f*x)*L,e[4]=(l*C-a*M-u*k)*L,e[5]=(n*M-r*C+o*k)*L,e[6]=(g*b-p*S-m*y)*L,e[7]=(c*S-d*b+f*y)*L,e[8]=(a*E-s*C+u*A)*L,e[9]=(i*C-n*E-o*A)*L,e[10]=(p*w-_*b+m*v)*L,e[11]=(h*b-c*w-f*v)*L,e[12]=(s*k-a*T-l*A)*L,e[13]=(n*T-i*k+r*A)*L,e[14]=(_*y-p*x-g*v)*L,e[15]=(c*x-h*y+d*v)*L,e):null},l.adjoint=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],_=t[13],g=t[14],m=t[15];return e[0]=s*(d*m-f*g)-h*(l*m-u*g)+_*(l*f-u*d),e[1]=-(i*(d*m-f*g)-h*(r*m-o*g)+_*(r*f-o*d)),e[2]=i*(l*m-u*g)-s*(r*m-o*g)+_*(r*u-o*l),e[3]=-(i*(l*f-u*d)-s*(r*f-o*d)+h*(r*u-o*l)),e[4]=-(a*(d*m-f*g)-c*(l*m-u*g)+p*(l*f-u*d)),e[5]=n*(d*m-f*g)-c*(r*m-o*g)+p*(r*f-o*d),e[6]=-(n*(l*m-u*g)-a*(r*m-o*g)+p*(r*u-o*l)),e[7]=n*(l*f-u*d)-a*(r*f-o*d)+c*(r*u-o*l),e[8]=a*(h*m-f*_)-c*(s*m-u*_)+p*(s*f-u*h),e[9]=-(n*(h*m-f*_)-c*(i*m-o*_)+p*(i*f-o*h)),e[10]=n*(s*m-u*_)-a*(i*m-o*_)+p*(i*u-o*s),e[11]=-(n*(s*f-u*h)-a*(i*f-o*h)+c*(i*u-o*s)),e[12]=-(a*(h*g-d*_)-c*(s*g-l*_)+p*(s*d-l*h)),e[13]=n*(h*g-d*_)-c*(i*g-r*_)+p*(i*d-r*h),e[14]=-(n*(s*g-l*_)-a*(i*g-r*_)+p*(i*l-r*s)),e[15]=n*(s*d-l*h)-a*(i*d-r*h)+c*(i*l-r*s),e},l.determinant=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11],f=e[12],p=e[13],_=e[14],g=e[15],m=t*a-n*o,v=t*s-i*o,y=t*l-r*o,b=n*s-i*a,x=n*l-r*a,w=i*l-r*s,S=u*p-c*f,A=u*_-h*f,k=u*g-d*f,C=c*_-h*p,T=c*g-d*p,E=h*g-d*_;return m*E-v*T+y*C+b*k-x*A+w*S},l.multiply=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],f=t[10],p=t[11],_=t[12],g=t[13],m=t[14],v=t[15],y=n[0],b=n[1],x=n[2],w=n[3];return e[0]=y*i+b*s+x*h+w*_,e[1]=y*r+b*l+x*d+w*g,e[2]=y*o+b*u+x*f+w*m,e[3]=y*a+b*c+x*p+w*v,y=n[4],b=n[5],x=n[6],w=n[7],e[4]=y*i+b*s+x*h+w*_,e[5]=y*r+b*l+x*d+w*g,e[6]=y*o+b*u+x*f+w*m,e[7]=y*a+b*c+x*p+w*v,y=n[8],b=n[9],x=n[10],w=n[11],e[8]=y*i+b*s+x*h+w*_,e[9]=y*r+b*l+x*d+w*g,e[10]=y*o+b*u+x*f+w*m,e[11]=y*a+b*c+x*p+w*v,y=n[12],b=n[13],x=n[14],w=n[15],e[12]=y*i+b*s+x*h+w*_,e[13]=y*r+b*l+x*d+w*g,e[14]=y*o+b*u+x*f+w*m,e[15]=y*a+b*c+x*p+w*v,e},l.fromMat3=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=0,e[4]=t[3],e[5]=t[4],e[6]=t[5],e[7]=0,e[8]=t[6],e[9]=t[7],e[10]=t[8],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},l.mul=l.multiply,l.translate=function(e,t,n){var i,r,o,a,s,l,u,c,h,d,f,p,_=n[0],g=n[1],m=n[2];return t===e?(e[12]=t[0]*_+t[4]*g+t[8]*m+t[12],e[13]=t[1]*_+t[5]*g+t[9]*m+t[13],e[14]=t[2]*_+t[6]*g+t[10]*m+t[14],e[15]=t[3]*_+t[7]*g+t[11]*m+t[15]):(i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=i,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=i*_+s*g+h*m+t[12],e[13]=r*_+l*g+d*m+t[13],e[14]=o*_+u*g+f*m+t[14],e[15]=a*_+c*g+p*m+t[15]),e},l.scale=function(e,t,n){var i=n[0],r=n[1],o=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.rotate=function(e,n,i,r){var o,a,s,l,u,c,h,d,f,p,_,g,m,v,y,b,x,w,S,A,k,C,T,E,M=r[0],L=r[1],R=r[2],O=Math.sqrt(M*M+L*L+R*R);return Math.abs(O)<t?null:(O=1/O,M*=O,L*=O,R*=O,o=Math.sin(i),a=Math.cos(i),s=1-a,l=n[0],u=n[1],c=n[2],h=n[3],d=n[4],f=n[5],p=n[6],_=n[7],g=n[8],m=n[9],v=n[10],y=n[11],b=M*M*s+a,x=L*M*s+R*o,w=R*M*s-L*o,S=M*L*s-R*o,A=L*L*s+a,k=R*L*s+M*o,C=M*R*s+L*o,T=L*R*s-M*o,E=R*R*s+a,e[0]=l*b+d*x+g*w,e[1]=u*b+f*x+m*w,e[2]=c*b+p*x+v*w,e[3]=h*b+_*x+y*w,e[4]=l*S+d*A+g*k,e[5]=u*S+f*A+m*k,e[6]=c*S+p*A+v*k,e[7]=h*S+_*A+y*k,e[8]=l*C+d*T+g*E,e[9]=u*C+f*T+m*E,e[10]=c*C+p*T+v*E,e[11]=h*C+_*T+y*E,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)},l.rotateX=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*r+u*i,e[5]=a*r+c*i,e[6]=s*r+h*i,e[7]=l*r+d*i,e[8]=u*r-o*i,e[9]=c*r-a*i,e[10]=h*r-s*i,e[11]=d*r-l*i,e},l.rotateY=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],u=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r-u*i,e[1]=a*r-c*i,e[2]=s*r-h*i,e[3]=l*r-d*i,e[8]=o*i+u*r,e[9]=a*i+c*r,e[10]=s*i+h*r,e[11]=l*i+d*r,e},l.rotateZ=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],c=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r+u*i,e[1]=a*r+c*i,e[2]=s*r+h*i,e[3]=l*r+d*i,e[4]=u*r-o*i,e[5]=c*r-a*i,e[6]=h*r-s*i,e[7]=d*r-l*i,e},l.fromRotationTranslation=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=i+i,l=r+r,u=o+o,c=i*s,h=i*l,d=i*u,f=r*l,p=r*u,_=o*u,g=a*s,m=a*l,v=a*u;return e[0]=1-(f+_),e[1]=h+v,e[2]=d-m,e[3]=0,e[4]=h-v,e[5]=1-(c+_),e[6]=p+g,e[7]=0,e[8]=d+m,e[9]=p-g,e[10]=1-(c+f),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},l.fromQuat=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n+n,s=i+i,l=r+r,u=n*a,c=n*s,h=n*l,d=i*s,f=i*l,p=r*l,_=o*a,g=o*s,m=o*l;return e[0]=1-(d+p),e[1]=c+m,e[2]=h-g,e[3]=0,e[4]=c-m,e[5]=1-(u+p),e[6]=f+_,e[7]=0,e[8]=h+g,e[9]=f-_,e[10]=1-(u+d),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},l.frustum=function(e,t,n,i,r,o,a){var s=1/(n-t),l=1/(r-i),u=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(r+i)*l,e[10]=(a+o)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*u,e[15]=0,e},l.perspective=function(e,t,n,i,r){var o=1/Math.tan(t/2),a=1/(i-r);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+i)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*i*a,e[15]=0,e},l.ortho=function(e,t,n,i,r,o,a){var s=1/(t-n),l=1/(i-r),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*s,e[13]=(r+i)*l,e[14]=(a+o)*u,e[15]=1,e},l.lookAt=function(e,n,i,r){var o,a,s,u,c,h,d,f,p,_,g=n[0],m=n[1],v=n[2],y=r[0],b=r[1],x=r[2],w=i[0],S=i[1],A=i[2];return Math.abs(g-w)<t&&Math.abs(m-S)<t&&Math.abs(v-A)<t?l.identity(e):(d=g-w,f=m-S,p=v-A,_=1/Math.sqrt(d*d+f*f+p*p),d*=_,f*=_,p*=_,o=b*p-x*f,a=x*d-y*p,s=y*f-b*d,_=Math.sqrt(o*o+a*a+s*s),_?(_=1/_,o*=_,a*=_,s*=_):(o=0,a=0,s=0),u=f*s-p*a,c=p*o-d*s,h=d*a-f*o,_=Math.sqrt(u*u+c*c+h*h),_?(_=1/_,u*=_,c*=_,h*=_):(u=0,c=0,h=0),e[0]=o,e[1]=u,e[2]=d,e[3]=0,e[4]=a,e[5]=c,e[6]=f,e[7]=0,e[8]=s,e[9]=h,e[10]=p,e[11]=0,e[12]=-(o*g+a*m+s*v),e[13]=-(u*g+c*m+h*v),e[14]=-(d*g+f*m+p*v),e[15]=1,e)},l.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},e.mat4=l;var u={};return u.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},u.rotationTo=function(){var e=o.create(),t=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(i,r,a){var s=o.dot(r,a);return-.999999>s?(o.cross(e,t,r),o.length(e)<1e-6&&o.cross(e,n,r),o.normalize(e,e),u.setAxisAngle(i,e,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(o.cross(e,r,a),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+s,u.normalize(i,i))}}(),u.setAxes=function(){var e=s.create();return function(t,n,i,r){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=r[0],e[4]=r[1],e[7]=r[2],e[2]=n[0],e[5]=n[1],e[8]=n[2],u.normalize(t,u.fromMat3(t,e))}}(),u.clone=a.clone,u.fromValues=a.fromValues,u.copy=a.copy,u.set=a.set,u.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},u.setAxisAngle=function(e,t,n){n=.5*n;var i=Math.sin(n);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(n),e},u.add=a.add,u.multiply=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=n[0],l=n[1],u=n[2],c=n[3];return e[0]=i*c+a*s+r*u-o*l,e[1]=r*c+a*l+o*s-i*u,e[2]=o*c+a*u+i*l-r*s,e[3]=a*c-i*s-r*l-o*u,e},u.mul=u.multiply,u.scale=a.scale,u.rotateX=function(e,t,n){n*=.5;var i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l+a*s,e[1]=r*l+o*s,e[2]=o*l-r*s,e[3]=a*l-i*s,e},u.rotateY=function(e,t,n){n*=.5;var i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l-o*s,e[1]=r*l+a*s,e[2]=o*l+i*s,e[3]=a*l-r*s,e},u.rotateZ=function(e,t,n){n*=.5;var i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l+r*s,e[1]=r*l-i*s,e[2]=o*l+a*s,e[3]=a*l-o*s,e},u.calculateW=function(e,t){var n=t[0],i=t[1],r=t[2];return e[0]=n,e[1]=i,e[2]=r,e[3]=-Math.sqrt(Math.abs(1-n*n-i*i-r*r)),e},u.dot=a.dot,u.lerp=a.lerp,u.slerp=function(e,t,n,i){var r,o,a,s,l,u=t[0],c=t[1],h=t[2],d=t[3],f=n[0],p=n[1],_=n[2],g=n[3];return o=u*f+c*p+h*_+d*g,0>o&&(o=-o,f=-f,p=-p,_=-_,g=-g),1-o>1e-6?(r=Math.acos(o),a=Math.sin(r),s=Math.sin((1-i)*r)/a,l=Math.sin(i*r)/a):(s=1-i,l=i),e[0]=s*u+l*f,e[1]=s*c+l*p,e[2]=s*h+l*_,e[3]=s*d+l*g,e},u.invert=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n*n+i*i+r*r+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-i*s,e[2]=-r*s,e[3]=o*s,e},u.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},u.length=a.length,u.len=u.length,u.squaredLength=a.squaredLength,u.sqrLen=u.squaredLength,u.normalize=a.normalize,u.fromMat3=function(){var e="undefined"!=typeof Int8Array?new Int8Array([1,2,0]):[1,2,0];return function(t,n){var i,r=n[0]+n[4]+n[8];if(r>0)i=Math.sqrt(r+1),t[3]=.5*i,i=.5/i,t[0]=(n[7]-n[5])*i,t[1]=(n[2]-n[6])*i,t[2]=(n[3]-n[1])*i;else{var o=0;n[4]>n[0]&&(o=1),n[8]>n[3*o+o]&&(o=2);var a=e[o],s=e[a];i=Math.sqrt(n[3*o+o]-n[3*a+a]-n[3*s+s]+1),t[o]=.5*i,i=.5/i,t[3]=(n[3*s+a]-n[3*a+s])*i,t[a]=(n[3*a+o]+n[3*o+a])*i,t[s]=(n[3*s+o]+n[3*o+s])*i}return t}}(),u.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},e.quat=u,e}(),t=function(){function t(e,t){this._colors=e;for(var n=0;n<this._colors.length;++n)this._colors[n]=a.forceRGB(this._colors[n]);this._stops=t}function n(e,t,n){this.colorFor=e,this._beginFunc=t,this._endFunc=n}function i(e,t,n){var i=null,r=null;return e[t](function(e){var t=e.prop(n);return null===i&&null===r?void(i=r=t):(i=Math.min(i,t),void(r=Math.max(r,t)))}),{min:i,max:r}}function r(e,t,r,o,a){return t||(t=c("rainbow")),new n(function(n,i,r){var o=0;this._min!==this._max&&(o=(a(n).prop(e)-this._min)/(this._max-this._min)),d(i,r,t,o)},function(t){return void 0!==r?(this._min=r[0],void(this._max=r[1])):(r=i(t,o,e),this._min=r.min,void(this._max=r.max))},function(){})}var o=e.vec4,a={};a.rgb={};var s=a.rgb;a.rgb.create=o.create,a.rgb.scale=o.scale,a.rgb.copy=o.copy,a.rgb.fromValues=o.fromValues,a.rgb.mix=function(e,t,n,i){var r=1-i;return e[0]=t[0]*i+n[0]*r,e[1]=t[1]*i+n[1]*r,e[2]=t[2]*i+n[2]*r,e[3]=t[3]*i+n[3]*r,e};var l={white:s.fromValues(1,1,1,1),black:s.fromValues(0,0,0,1),grey:s.fromValues(.5,.5,.5,1),lightgrey:s.fromValues(.8,.8,.8,1),darkgrey:s.fromValues(.3,.3,.3,1),red:s.fromValues(1,0,0,1),darkred:s.fromValues(.5,0,0,1),lightred:s.fromValues(1,.5,.5,1),green:s.fromValues(0,1,0,1),darkgreen:s.fromValues(0,.5,0,1),lightgreen:s.fromValues(.5,1,.5,1),blue:s.fromValues(0,0,1,1),darkblue:s.fromValues(0,0,.5,1),lightblue:s.fromValues(.5,.5,1,1),yellow:s.fromValues(1,1,0,1),darkyellow:s.fromValues(.5,.5,0,1),lightyellow:s.fromValues(1,1,.5,1),cyan:s.fromValues(0,1,1,1),darkcyan:s.fromValues(0,.5,.5,1),lightcyan:s.fromValues(.5,1,1,1),magenta:s.fromValues(1,0,1,1),darkmagenta:s.fromValues(.5,0,.5,1),lightmagenta:s.fromValues(1,.5,1,1),orange:s.fromValues(1,.5,0,1),darkorange:s.fromValues(.5,.25,0,1),lightorange:s.fromValues(1,.75,.5,1)};a.hex2rgb=function(e){var t,n,i,r;if(4===e.length||5===e.length){t=parseInt(e[1],16),n=parseInt(e[2],16),i=parseInt(e[3],16),r=15,5===e.length&&(r=parseInt(e[4],16));var o=1/15;return s.fromValues(o*t,o*n,o*i,o*r)}if(7===e.length||9===e.length){t=parseInt(e.substr(1,2),16),n=parseInt(e.substr(3,2),16),i=parseInt(e.substr(5,2),16),r=255,9===e.length&&(r=parseInt(e.substr(7,2),16));var a=1/255;return s.fromValues(a*t,a*n,a*i,a*r)}},a.setColorPalette=function(e){console.log("setting colors"),l=e,a.initGradients()},a.forceRGB=function(e){if("string"==typeof e){var t=l[e];if(void 0!==t)return t;if(e.length>0&&"#"===e[0])return a.hex2rgb(e)}return 3===e.length?[e[0],e[1],e[2],1]:e},t.prototype={colorAt:function(e,t){if(t<=this._stops[0])return o.copy(e,this._colors[0]);if(t>=this._stops[this._stops.length-1])return o.copy(e,this._colors[this._stops.length-1]);for(var n=0,i=1;i<this._stops.length&&!(this._stops[i]>t);++i)n=i;var r=n+1,a=this._stops[n],l=this._stops[r],u=(t-a)/(l-a);return s.mix(e,this._colors[r],this._colors[n],u)}};var u={};a.gradient=function(e,n){if("string"==typeof e)return u[e];if(n=n||"equal","equal"===n){n=[];for(var i=0;i<e.length;++i)n.push(1*i/(e.length-1))}return new t(e,n)};var c=a.gradient;a.initGradients=function(){u.rainbow=c(["red","yellow","green","blue"]),u.reds=c(["lightred","darkred"]),u.greens=c(["lightgreen","darkgreen"]),u.blues=c(["lightblue","darkblue"]),u.trafficlight=c(["green","yellow","red"]),u.heatmap=c(["red","white","blue"])},n.prototype={begin:function(e){this._beginFunc&&this._beginFunc(e)},end:function(e){this._endFunc&&this._endFunc(e)}},a.ColorOp=n,a.uniform=function(e){return e=a.forceRGB(e||"white"),new n(function(t,n,i){n[i+0]=e[0],n[i+1]=e[1],n[i+2]=e[2],n[i+3]=e[3]},null,null)};var h={H:[1,1,1],C:[.83,.83,.83],N:[.13,.2,1],O:[1,.13,0],F:[.12,.94,.12],CL:[.12,.94,.12],BR:[.6,.13,0],I:[.4,0,.73],HE:[0,1,1],NE:[0,1,1],AR:[0,1,1],XE:[0,1,1],KR:[0,1,1],P:[1,.6,0],S:[.87,.87,0],B:[1,.67,.47],LI:[.47,0,1],NA:[.47,0,1],K:[.47,0,1],RB:[.47,0,1],CS:[.47,0,1],FR:[.47,0,1],BE:[0,.47,0],MG:[0,.47,0],SR:[0,.47,0],BA:[0,.47,0],RA:[0,.47,0],TI:[.6,.6,.6],FE:[.87,.47,0]};a.byElement=function(){return new n(function(e,t,n){var i=e.element(),r=h[i];return void 0!==r?(t[n]=r[0],t[n+1]=r[1],t[n+2]=r[2],t[n+3]=1,t):(t[n]=1,t[n+1]=0,t[n+2]=1,t[n+3]=1,t)},null,null)},a.bySS=function(){return new n(function(e,t,n){switch(e.residue().ss()){case"C":return t[n]=.8,t[n+1]=.8,t[n+2]=.8,void(t[n+3]=1);case"H":return t[n]=.6,t[n+1]=.6,t[n+2]=.9,void(t[n+3]=1);case"E":return t[n]=.2,t[n+1]=.8,t[n+2]=.2,void(t[n+3]=1)}},null,null)},a.rainbow=function(e){e||(e=c("rainbow"));var t=new n(function(t,n,i){var r=0,o=this.chainLimits[t.residue().chain().name()];if(void 0!==o){var a=t.residue().index();r=(a-o[0])/(o[1]-o[0])}var s=[1,1,1,1];e.colorAt(s,r),n[i]=s[0],n[i+1]=s[1],n[i+2]=s[2],n[i+3]=s[3]},function(e){var t=e.chains();this.chainLimits={};for(var n=0;n<t.length;++n){var i=t[n].backboneTraces();if(0!==i.length){for(var r=i[0].residueAt(0).index(),o=i[0].residueAt(i[0].length()-1).index(),a=1;a<i.length;++a){var s=i[a];r=Math.min(r,s.residueAt(0).index()),o=Math.max(o,s.residueAt(s.length()-1).index())}r!==o&&(this.chainLimits[t[n].name()]=[r,o])}}},function(){this.chainLimits=null});return t},a.ssSuccession=function(e,t){e||(e=c("rainbow")),t||(t=a.forceRGB("lightgrey"));var i=new n(function(n,i,r){var o=n.residue().index(),a=this.chainLimits[n.residue().chain().name()],s=a.indices[o];if(-1===s)return i[r]=t[0],i[r+1]=t[1],i[r+2]=t[2],void(i[r+3]=t[3]);var l=0;null===a.max,null!==a.max&&(l=s/(a.max>0?a.max:1));var u=[0,0,0,0];e.colorAt(u,l),i[r]=u[0],i[r+1]=u[1],i[r+2]=u[2],i[r+3]=u[3]},function(e){var t=e.chains();this.chainLimits={};for(var n=0;n<t.length;++n){for(var i=t[n].residues(),r=null,o={},a=0,s="C",l=0;l<i.length;++l){var u=i[l].ss();"C"===u?("C"!==s&&a++,o[i[l].index()]=-1):(r=a,o[i[l].index()]=a),s=u}this.chainLimits[t[n].name()]={indices:o,max:r}}},function(){this.chainLimits=null});return i},a.byChain=function(e){e||(e=c("rainbow"));var t=new n(function(t,n,i){var r=this.chainIndices[t.residue().chain().name()],o=r*this.scale,a=[0,0,0,0];e.colorAt(a,o),n[i+0]=a[0],n[i+1]=a[1],n[i+2]=a[2],n[i+3]=a[3]},function(e){var t=e.chains();this.chainIndices={};for(var n=0;n<t.length;++n)this.chainIndices[t[n].name()]=n;this.scale=t.length>1?1/(t.length-1):1},function(){this.chainIndices=null});return t};var d=function(){var e=o.create();return function(t,n,i,r){i.colorAt(e,r),t[n+0]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=e[3]}}();return a.byAtomProp=function(e,t,n){return r(e,t,n,"eachAtom",function(e){return e})},a.byResidueProp=function(e,t,n){return r(e,t,n,"eachResidue",function(e){return e.residue()})},a.interpolateColor=function(e,t){for(var n=new Float32Array(4*(t*(e.length/4-1)+1)),i=0,r=o.create(),a=o.create(),s=1/t,l=0;l<e.length/4-1;++l){o.set(r,e[4*l+0],e[4*l+1],e[4*l+2],e[4*l+3]),o.set(a,e[4*l+4],e[4*l+5],e[4*l+6],e[4*l+7]);for(var u=0;t>u;++u){var c=s*u;n[i+0]=r[0]*(1-c)+a[0]*c,n[i+1]=r[1]*(1-c)+a[1]*c,n[i+2]=r[2]*(1-c)+a[2]*c,n[i+3]=r[3]*(1-c)+a[3]*c,i+=4}}return n[i+0]=a[0],n[i+1]=a[1],n[i+2]=a[2],n[i+3]=a[3],n},a.initGradients(),a}(),n=function(){function e(e,t,n){this._pool=e,this._start=t,this._next=t,this._end=n}function t(){this.clear()}return e.prototype={nextId:function(e){var t=this._next;return console.assert(this._next<this._end),this._next++,this._pool._objects[t]=e,t},hasLeft:function(){return this._next<this._end},recycle:function(){this._pool.recycle(this)},length:function(){return this._end-this._start}},t.prototype={MAX_ID:16777216,getContinuousRange:function(t){for(var n=-1,i=null,r=0;r<this._free.length;++r){var o=this._free[r],a=o.length();a>=t&&(null===i||i>a)&&(i=a,n=r)}if(-1!==n){var s=this._free[n];return this._free.splice(n,1),this._usedCount++,s}var l=this._unusedRangeStart,u=l+t;if(u>this.MAX_ID)return console.error("not enough free object ids."),null;this._unusedRangeStart=u;var c=new e(this,l,u);return this._usedCount++,c},clear:function(){this._objects={},this._unusedRangeStart=1,this._free=[],this._usedCount=0},recycle:function(e){for(var t=e._start;t<e._next;++t)delete this._objects[t];e._next=e._start,this._free.push(e),this._usedCount--,console.assert(this._usedCount>=0),this._free.length>0&&0===this._usedCount&&this.clear()},objectForId:function(e){return this._objects[e]}},t}(),i=function(){function e(e,t){return t>e}function t(e,t){void 0===e||void 0===t?(this._empty=!0,this._min=this._max=null):(this._empty=!1,this._min=e,this._max=t)}var n={};return n.derive=function(e,t,n){for(var i in t.prototype)e.prototype[i]=t.prototype[i];if(void 0!==n)for(var r in n)e.prototype[r]=n[r]},n.bind=function(e,t){return function(){return t.apply(e,arguments)}},n.copy=function(e){e=e||{};var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},n.binarySearch=function(t,n,i){if(0===t.length)return-1;i=i||e;for(var r=0,o=t.length,a=r+o>>1;;){var s=t[a];if(i(n,s))o=a;else{if(!i(s,n))return a;r=a}var l=r+o>>1;if(l===a)return-1;a=l}return-1},n.indexFirstLargerEqualThan=function(t,n,i){if(i=i||e,0===t.length||i(t[t.length-1],n))return-1;for(var r=0,o=t.length,a=r+o>>1;;){var s=t[a];i(n,s)?o=a:i(s,n)?r=a+1:o=a;var l=r+o>>1;if(l===a)return a;a=l}},n.indexLastSmallerThan=function(t,n,i){if(i=i||e,0===t.length||i(t[t.length-1],n))return t.length-1;if(i(n,t[0])||!i(t[0],n))return-1;for(var r=0,o=t.length,a=r+o>>1;;){var s=t[a];i(n,s)||!i(s,n)?o=a:r=a;var l=r+o>>1;if(l===a)return a;a=l}},n.indexLastSmallerEqualThan=function(t,n,i){if(i=i||e,0===t.length||i(t[t.length-1],n))return t.length-1;if(i(n,t[0]))return-1;for(var r=0,o=t.length,a=r+o>>1;;){var s=t[a];i(n,s)?o=a:r=a;var l=r+o>>1;if(l===a)return a;a=l}},t.prototype={min:function(){return this._min},max:function(){return this._max},length:function(){return this._max-this._min},empty:function(){return this._empty},center:function(){return.5*(this._max+this._min)},extend:function(e){this._min-=e,this._max+=e},update:function(e){return this._empty?(this._min=this._max=e,void(this._empty=!1)):void(e<this._min?this._min=e:e>this._max&&(this._max=e))}},n.Range=t,n}(),r=function(){function e(e){if("complete"!==document.readyState&&"loaded"!==document.readyState&&"interactive"!==document.readyState)return console.error("isWebGLSupported only works after DOMContentLoaded"),!1;if(void 0===e)try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("experimental-webgl"))}catch(n){return!1}return!!e}function t(e,t){this._width=t.width,this._antialias=t.antialias,this._height=t.height,this._resize=!1,this._lastTimestamp=null,this._domElement=e,this._initCanvas(),this._backgroundColor=t.backgroundColor,this._forceManualAntialiasing=t.forceManualAntialiasing}return t.prototype={_ensureSize:function(){if(this._resize){this._resize=!1;var e=this._width*this._samples,t=this._height*this._samples;this._realWidth=e,this._realHeight=t,this._gl.viewport(0,0,e,t),this._canvas.width=e,this._canvas.height=t,this._samples>1&&this._initManualAntialiasing(this._samples)}},resize:function(e,t){(e!==this._width||t!==this._height)&&(this._resize=!0,this._width=e,this._height=t)},fitParent:function(){var e=this._domElement.getBoundingClientRect();this.resize(e.width,e.height)},gl:function(){return this._gl},imageData:function(){return this._canvas.toDataURL()},_initContext:function(){try{var e={antialias:this._antialias&&!this._forceManualAntialiasing,preserveDrawingBuffer:!0};this._gl=this._canvas.getContext("experimental-webgl",e)}catch(t){return console.error("WebGL not supported",t),!1}return this._gl?!0:(console.error("WebGL not supported"),!1)},_initManualAntialiasing:function(e){var t=1/e,n=.5*-(1-t)*this._realWidth,i=.5*-(1-t)*this._realHeight,r="translate("+n+"px, "+i+"px)",o="scale("+t+", "+t+")",a=r+" "+o;this._canvas.style.webkitTransform=a,this._canvas.style.transform=a,this._canvas.style.ieTransform=a,this._canvas.width=this._realWidth,this._canvas.height=this._realHeight},initGL:function(){var e=1;if(!this._initContext())return!1;var t=this._gl;return t.getContextAttributes().antialias&&!this._forceManualAntialiasing||!this._antialias||(e=2),this._realWidth=this._width*e,this._realHeight=this._height*e,this._samples=e,e>1&&this._initManualAntialiasing(e),t.viewportWidth=this._realWidth,t.viewportHeight=this._realHeight,t.clearColor(this._backgroundColor[0],this._backgroundColor[1],this._backgroundColor[2],1),t.lineWidth(2),t.cullFace(t.FRONT),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),!0},_shaderFromString:function(e,t,n){var i,r=this._gl;if("fragment"===t)i=r.createShader(r.FRAGMENT_SHADER);else{if("vertex"!==t)return console.error("could not determine type for shader"),null;i=r.createShader(r.VERTEX_SHADER)}var o=e.replace("${PRECISION}",n);return r.shaderSource(i,o),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS)?i:(console.log(o),console.error(r.getShaderInfoLog(i)),null)},initShader:function(e,t,n){var r=this._gl,o=this._shaderFromString(t,"fragment",n),a=this._shaderFromString(e,"vertex",n),s=r.createProgram();if(r.attachShader(s,a),
r.attachShader(s,o),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))return console.error("could not initialise shaders"),console.error(r.getShaderInfoLog(s)),null;var l=i.bind(r,r.getAttribLocation),u=i.bind(r,r.getUniformLocation);return s.posAttrib=l(s,"attrPos"),s.colorAttrib=l(s,"attrColor"),s.normalAttrib=l(s,"attrNormal"),s.objIdAttrib=l(s,"attrObjId"),s.selectAttrib=l(s,"attrSelect"),s.symId=u(s,"symId"),s.projection=u(s,"projectionMat"),s.modelview=u(s,"modelviewMat"),s.rotation=u(s,"rotationMat"),s.fog=u(s,"fog"),s.fogFar=u(s,"fogFar"),s.fogNear=u(s,"fogNear"),s.fogColor=u(s,"fogColor"),s.outlineColor=u(s,"outlineColor"),s.outlineWidth=u(s,"outlineWidth"),s.relativePixelSize=u(s,"relativePixelSize"),s.screenDoorTransparency=u(s,"screenDoorTransparency"),s.selectionColor=u(s,"selectionColor"),s.pointSize=u(s,"pointSize"),s.zoom=u(s,"zoom"),s},on:function(e,t){this._canvas.addEventListener(e,t,!1)},removeEventListener:function(e,t){this._canvas.removeEventListener(e,t,!1)},onWheel:function(e,t){"onwheel"in this._canvas?this.on("wheel",e):this.on("mousewheel",t)},domElement:function(){return this._canvas},bind:function(){this._ensureSize(),this._gl.viewport(0,0,this._realWidth,this._realHeight)},superSamplingFactor:function(){return this._samples},viewportWidth:function(){return this._realWidth},viewportHeight:function(){return this._realHeight},width:function(){return this._width},height:function(){return this._height},_initCanvas:function(){this._canvas=document.createElement("canvas"),this._canvas.width=this._width,this._canvas.height=this._height,this._domElement.appendChild(this._canvas)},isWebGLSupported:function(){return e(this._gl)},destroy:function(){this._canvas.width=1,this._canvas.height=1,this._canvas.parentElement.removeChild(this._canvas),this._canvas=null}},{Canvas:t,isWebGLSupported:e}}(),o=function(){function e(e,t){this._width=t.width,this._height=t.height,this._colorBufferWidth=this._width,this._colorBufferHeight=this._height,this._gl=e,this._colorHandle=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this._colorHandle),this._depthHandle=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this._depthHandle),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this._width,this._height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this._depthHandle),this._colorTexture=e.createTexture(),this._initColorBuffer()}return e.prototype={width:function(){return this._width},height:function(){return this._height},bind:function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._colorHandle),e.bindRenderbuffer(e.RENDERBUFFER,this._depthHandle),(this._colorBufferWidth!==this._width||this._colorBufferHeight!==this._height)&&this._resizeBuffers(),e.viewport(0,0,this._width,this._height)},colorTexture:function(){return this._colorTexture},_initColorBuffer:function(){this.bind();var e=this._gl;e.bindTexture(e.TEXTURE_2D,this._colorTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this._width,this._height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._colorTexture,0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),this.release()},_resizeBuffers:function(){var e=this._gl;e.bindRenderbuffer(e.RENDERBUFFER,this._depthHandle),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this._width,this._height),e.bindTexture(e.TEXTURE_2D,this._colorTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this._width,this._height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._colorTexture,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this._depthHandle),e.bindTexture(e.TEXTURE_2D,null),this._colorBufferWidth=this._width,this._colorBufferHeight=this._height},resize:function(e,t){this._width=e,this._height=t},release:function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null)}},e}(),a=function(){function e(e){this._freeArrays=[],this._bufferType=e}return e.prototype.request=function(e){for(var t=-1,n=null,i=0;i<this._freeArrays.length;++i){var r=this._freeArrays[i],o=r.length;o>=e&&(null===n||n>o)&&(n=o,t=i)}if(-1!==t){var a=this._freeArrays[t];return this._freeArrays.splice(t,1),a}return new this._bufferType(e)},e.prototype.release=function(e){this._freeArrays.push(e)},e}(),s=function(){function t(e){this._projection=i.create(),this._camModelView=i.create(),this._modelView=i.create(),this._rotation=i.create(),this._translation=i.create(),this._near=.1,this._far=4e3,this._fogNear=-5,this._fogFar=50,this._fog=!0,this._fovY=45*Math.PI/180,this._fogColor=n.fromValues(1,1,1),this._outlineColor=n.fromValues(.1,.1,.1),this._outlineWidth=1,this._selectionColor=n.fromValues(.1,1,.1),this._center=n.create(),this._zoom=50,this._screenDoorTransparency=!1,this._updateProjectionMat=!0,this._updateModelViewMat=!0,this._upsamplingFactor=1,this._gl=e,this._currentShader=null,this._stateId=0,this.setViewportSize(e.viewportWidth,e.viewportHeight)}var n=e.vec3,i=e.mat4;return t.prototype={_incrementStateId:function(){this._stateId+=1,this._stateId>68719476735&&(this._stateId=0)},setScreenDoorTransparency:function(e){this._screenDoorTransparency=e,this._incrementStateId()},setOutlineWidth:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,this._incrementStateId())},setRotation:function(e){16===e.length?i.copy(this._rotation,e):i.fromMat3(this._rotation,e),this._updateModelViewMat=!0},upsamplingFactor:function(){return this._upsamplingFactor},setUpsamplingFactor:function(e){if(this._upsamplingFactor!==e){this._incrementStateId(),this._upsamplingFactor=e;var t=this._upsamplingFactor/this._width,n=this._upsamplingFactor/this._height;this._relativePixelSize=new Float32Array([t,n])}},mainAxes:function(){return[n.fromValues(this._rotation[0],this._rotation[4],this._rotation[8]),n.fromValues(this._rotation[1],this._rotation[5],this._rotation[9]),n.fromValues(this._rotation[2],this._rotation[6],this._rotation[10])]},fieldOfViewY:function(){return this._fovY},setFieldOfViewY:function(e){this._fovY=e,this._updateProjectionMat=!0},aspectRatio:function(){return this._width/this._height},rotation:function(){return this._rotation},_updateIfRequired:function(){var e=!1;return this._updateModelViewMat&&(i.identity(this._camModelView),i.translate(this._camModelView,this._camModelView,[-this._center[0],-this._center[1],-this._center[2]]),i.mul(this._camModelView,this._rotation,this._camModelView),i.identity(this._translation),i.translate(this._translation,this._translation,[0,0,-this._zoom]),i.mul(this._camModelView,this._translation,this._camModelView),e=!0),this._updateProjectionMat&&(i.identity(this._projection),i.perspective(this._projection,this._fovY,this._width/this._height,this._near,this._far),e=!0),this._updateProjectionMat=!1,this._updateModelViewMat=!1,e&&this._incrementStateId(),e},setViewportSize:function(e,t){this._updateProjectionMat=!0,this._width=e,this._height=t,this._relativePixelSize=new Float32Array([this._upsamplingFactor/e,this._upsamplingFactor/t])},viewportWidth:function(){return this._width},viewportHeight:function(){return this._height},setCenter:function(e){this._updateModelViewMat=!0,n.copy(this._center,e)},fog:function(e){return void 0!==e&&e!==this._fog&&(this._fog=e,this._incrementStateId()),this._fog},rotateZ:function(){var e=i.create();return function(t){i.identity(e),this._updateModelViewMat=!0,i.rotate(e,e,t,[0,0,1]),i.mul(this._rotation,e,this._rotation)}}(),rotateX:function(){var e=i.create();return function(t){i.identity(e),this._updateModelViewMat=!0,i.rotate(e,e,t,[1,0,0]),i.mul(this._rotation,e,this._rotation)}}(),rotateY:function(){var e=i.create();return function(t){i.identity(e),this._updateModelViewMat=!0,i.rotate(e,e,t,[0,1,0]),i.mul(this._rotation,e,this._rotation)}}(),panX:function(e){return this.panXY(e,0)},panY:function(e){return this.panXY(0,e)},panXY:function(){var e=i.create(),t=n.create();return function(r,o){i.transpose(e,this._rotation),this._updateModelViewMat=!0,n.set(t,-r,o,0),n.transformMat4(t,t,e),n.add(t,t,this._center),this.setCenter(t)}}(),nearOffset:function(){return this._near},farOffset:function(){return this._far},setNearFar:function(e,t){(e!==this._near||t!==this._far)&&(this._near=e,this._far=t,this._updateProjectionMat=!0)},setFogNearFar:function(e,t){this._fogNear=e,this._fogFar=t,this._updateProjectionMat=!0},setZoom:function(e){return this._updateModelViewMat=!0,this._zoom=e,this._zoom},zoom:function(e){if(void 0===e)return this._zoom;this._updateModelViewMat=!0;var t=1+.1*e;return this._zoom=Math.min(1e3,Math.max(2,t*this._zoom)),this._zoom},center:function(){return this._center},setFogColor:function(e){this._fogColor=n.clone(e)},currentShader:function(){return this._currentShader},invalidateCurrentShader:function(){this._currentShader=null},setOutlineColor:function(e){this._outlineColor=n.clone(e)},setSelectionColor:function(e){this._selectionColor=n.clone(e)},bind:function(e,t){var n=!1,r=this._gl;if(this._currentShader!==e&&(this._currentShader=e,r.useProgram(e),n=!0),n=this._updateIfRequired()||n,t?(i.mul(this._modelView,this._camModelView,t),r.uniformMatrix4fv(e.modelview,!1,this._modelView)):r.uniformMatrix4fv(e.modelview,!1,this._camModelView),this._stateId!==e.stateId){e.stateId=this._stateId,r.uniformMatrix4fv(e.projection,!1,this._projection),e.rotation&&r.uniformMatrix4fv(e.rotation,!1,this._rotation),r.uniform1i(e.fog,this._fog);var o=this._zoom;r.uniform1f(e.fogFar,this._fogFar+o),r.uniform1f(e.zoom,this._zoom),r.uniform1f(e.fogNear,this._fogNear+o),r.uniform3fv(e.fogColor,this._fogColor),r.uniform3fv(e.outlineColor,this._outlineColor),r.uniform3fv(e.selectionColor,this._selectionColor),r.uniform2fv(e.relativePixelSize,this._relativePixelSize),r.uniform1f(e.outlineWidth,this._outlineWidth),r.uniform1i(e.screenDoorTransparency,this._screenDoorTransparency)}}},t}(),l={PRELUDE_FS:"\nprecision ${PRECISION} float;\nuniform bool screenDoorTransparency;\nvec4 handleAlpha(vec4 inColor) {\n  if (screenDoorTransparency) {\n    ivec2 pxCoord = ivec2(gl_FragCoord.xy);\n    ivec2 mod = pxCoord - (pxCoord/2) * 2;\n    if (inColor.a < 0.99 &&\n        (inColor.a < 0.01 || mod.x != 0 || mod.y != 0)) { discard; }\n    return vec4(inColor.rgb, 1.0);\n  } else {\n    if (inColor.a == 0.0) { discard; }\n    return inColor;\n  } \n} \nuniform vec3 selectionColor;\n\nvec3 handleSelect(vec3 inColor, float vertSelect) { \n  return mix(inColor, selectionColor, step(0.5, vertSelect) * 0.7); \n} \n\nuniform bool fog;\nuniform float fogNear;\nuniform float fogFar;\nuniform vec3 fogColor;\nvec3 handleFog(vec3 inColor) {\n  if (fog) {\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = smoothstep(fogNear, fogFar, depth);\n    return mix(inColor, fogColor, fogFactor);\n  } else {\n    return inColor;\n  }\n}",LINES_FS:"\nvarying vec4 vertColor;\nvarying vec3 vertNormal;\n\nvoid main(void) {\n  gl_FragColor = handleAlpha(vertColor);\n  gl_FragColor.rgb = handleFog(gl_FragColor.rgb);\n}",SELECT_LINES_FS:"\nprecision ${PRECISION} float;\n\nvarying float vertSelect;\nvarying vec3 vertNormal;\nuniform float fogNear;\nuniform float fogFar;\nuniform vec3 fogColor;\nuniform bool fog;\nuniform vec3 selectionColor;\n\nvoid main(void) {\n  gl_FragColor = mix(vec4(0.0, 0.0, 0.0, 0.0), vec4(selectionColor, 1.0), \n                     vertSelect);\n  gl_FragColor.a = step(0.5, vertSelect);\n  if (gl_FragColor.a == 0.0) { discard; }\n  float depth = gl_FragCoord.z / gl_FragCoord.w;\n  if (fog) {\n    float fog_factor = smoothstep(fogNear, fogFar, depth);\n    gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w),\n                        fog_factor);\n  }\n}",SELECT_LINES_VS:"\nattribute vec3 attrPos;\nattribute float attrSelect;\n\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nuniform float pointSize;\nvarying float vertSelect;\nvoid main(void) {\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  gl_Position.z += gl_Position.w * 0.000001; \n  float distToCamera = vec4(modelviewMat * vec4(attrPos, 1.0)).z;\n  gl_PointSize = pointSize * 200.0 / abs(distToCamera); \n  vertSelect = attrSelect;\n}",SELECT_VS:"\nprecision ${PRECISION} float;\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nuniform float pointSize;\nattribute vec3 attrPos;\nattribute float attrObjId;\n\nvarying float objId;\n\nvoid main(void) {\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  float distToCamera = vec4(modelviewMat * vec4(attrPos, 1.0)).z;\n  gl_PointSize = pointSize * 200.0 / abs(distToCamera); \n  objId = attrObjId;\n}",SELECT_FS:"\nprecision ${PRECISION} float;\n\nvarying float objId;\nuniform int symId;\n\nint intMod(int x, int y) { \n  int z = x/y;\n  return x-y*z;\n}\nvoid main(void) {\n  // ints are only required to be 7bit...\n  int integralObjId = int(objId+0.5);\n  int red = intMod(integralObjId, 256);\n  integralObjId/=256;\n  int green = intMod(integralObjId, 256);\n  integralObjId/=256;\n  int blue = intMod(integralObjId, 256);\n  int alpha = symId;\n  gl_FragColor = vec4(float(red), float(green), \n                      float(blue), float(alpha))/255.0;\n}",LINES_VS:"\nattribute vec3 attrPos;\nattribute vec4 attrColor;\n\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nvarying vec4 vertColor;\nuniform float pointSize;\nvoid main(void) {\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  float distToCamera = vec4(modelviewMat * vec4(attrPos, 1.0)).z;\n  gl_PointSize = pointSize * 200.0 / abs(distToCamera); \n  vertColor = attrColor;\n}",HEMILIGHT_FS:"\nvarying vec4 vertColor;\nvarying vec3 vertNormal;\nvarying float vertSelect;\n\nvoid main(void) {\n  float dp = dot(vertNormal, vec3(0.0, 0.0, 1.0));\n  float hemi = min(1.0, max(0.0, dp)*0.6+0.5);\n  gl_FragColor = vec4(vertColor.rgb*hemi, vertColor.a);\n  gl_FragColor.rgb = handleFog(handleSelect(gl_FragColor.rgb, vertSelect));\n  gl_FragColor = handleAlpha(gl_FragColor);\n}",PHONG_FS:"\nvarying vec4 vertColor;\nvarying vec3 vertNormal;\nvarying vec3 vertPos;\nuniform float zoom;\nvarying float vertSelect;\n\nvoid main(void) {\n  vec3 eyePos = vec3(0.0, 0.0, zoom);\n  float dp = dot(vertNormal, normalize(eyePos - vertPos));\n  float hemi = min(1.0, max(0.3, dp)+0.2);\n  //hemi *= vertColor.a;\n  vec3 rgbColor = vertColor.rgb * hemi; \n  rgbColor += min(vertColor.rgb, 0.8) * pow(max(0.0, dp), 18.0);\n  rgbColor = handleSelect(rgbColor, vertSelect);\n  gl_FragColor = vec4(clamp(rgbColor, 0.0, 1.0), vertColor.a);\n  gl_FragColor.rgb = handleFog(gl_FragColor.rgb);\n  gl_FragColor = handleAlpha(gl_FragColor);\n}",HEMILIGHT_VS:"\nattribute vec3 attrPos;\nattribute vec4 attrColor;\nattribute vec3 attrNormal;\nattribute float attrSelect;\n\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nvarying vec4 vertColor;\nvarying vec3 vertNormal;\nvarying vec3 vertPos;\nvarying float vertSelect;\nvoid main(void) {\n  vertPos = (modelviewMat * vec4(attrPos, 1.0)).xyz;\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  vec4 n = (modelviewMat * vec4(attrNormal, 0.0));\n  vertNormal = n.xyz;\n  vertColor = attrColor;\n  vertSelect = attrSelect;\n}",OUTLINE_FS:"\nvarying float vertAlpha;\nvarying float vertSelect;\n\nuniform vec3 outlineColor;\n\nvoid main() {\n  gl_FragColor = vec4(mix(outlineColor, selectionColor, \n                          step(0.5, vertSelect)), \n                      vertAlpha);\n  gl_FragColor.rgb = handleFog(gl_FragColor.rgb);\n  gl_FragColor = handleAlpha(gl_FragColor);\n}",OUTLINE_VS:"\nprecision ${PRECISION} float;\n\nattribute vec3 attrPos;\nattribute vec3 attrNormal;\nattribute vec4 attrColor;\nattribute float attrSelect;\n\nuniform vec3 outlineColor;\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nvarying float vertAlpha;\nvarying float vertSelect;\nuniform vec2 relativePixelSize;\nuniform float outlineWidth;\n\nvoid main(void) {\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  vec4 normal = modelviewMat * vec4(attrNormal, 0.0);\n  vertAlpha = attrColor.a;\n  vertSelect = attrSelect;\n  vec2 expansion = relativePixelSize * \n       (outlineWidth + 2.0 * step(0.5, attrSelect));\n  vec2 offset = normal.xy * expansion;\n  gl_Position.xy += gl_Position.w * offset;\n}",TEXT_VS:"\nprecision ${PRECISION} float;\n\nattribute vec3 attrCenter;\nattribute vec2 attrCorner;\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nuniform mat4 rotationMat;\nvarying vec2 vertTex;\nuniform float width;\nuniform float height;\nvoid main() { \n  vec4 pos = modelviewMat* vec4(attrCenter, 1.0);\n  pos.z += 4.0;\n  gl_Position = projectionMat * pos;\n  gl_Position.xy += vec2(width,height)*attrCorner*gl_Position.w; \n  vertTex = (attrCorner+abs(attrCorner))/(2.0*abs(attrCorner)); \n}",TEXT_FS:"\nprecision ${PRECISION} float;\n\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nuniform sampler2D sampler;\nuniform float xScale;\nuniform float yScale;\nvarying vec2 vertTex;\nvoid main() { \n  vec2 texCoord = vec2(vertTex.x*xScale, vertTex.y*yScale);\n  gl_FragColor = texture2D(sampler, texCoord);\n  if (gl_FragColor.a == 0.0) { discard; }\n}"},u=function(){function e(e,t,n){this._element=e,this._element.addEventListener("touchmove",i.bind(this,this._touchMove)),this._element.addEventListener("touchstart",i.bind(this,this._touchStart)),this._element.addEventListener("touchend",i.bind(this,this._touchEnd)),this._element.addEventListener("touchcancel",i.bind(this,this._touchEnd)),this._touchState={scale:1,rotation:0,center:null},this._lastSingleTap=null,this._viewer=t,this._cam=n}function t(e){for(var t=0,n=0,i=0;i<e.length;++i)t+=e[i].clientX,n+=e[i].clientY;return t/=e.length,n/=e.length,{x:t,y:n}}function n(e,t){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}function r(e,t){var i=n(e[0],e[1]),r=n(t[0],t[1]);return r/(0===i?1:i)}function o(e,t){var n=t.x-e.x,i=t.y-e.y;return Math.atan2(i,n)}function a(e,t){return o(t[1],t[0])-o(e[1],e[0])}return e.prototype={_extractEventAttributes:function(e,n){var i={};i.center=t(n.targetTouches),i.pointers=[];for(var o=0;o<n.targetTouches.length;++o){var s=n.targetTouches[o];i.pointers.push({x:s.clientX,y:s.clientY})}return i.numTouches=n.targetTouches.length,i.rotation=0,i.scale=1,i.deltaScale=0,i.deltaRotation=0,e.center&&(i.deltaCenter={x:i.center.x-e.center.x,y:i.center.y-e.center.y}),2!==e.numTouches||2!==i.numTouches?i:(e.initialPointers?i.initialPointers=e.initialPointers:i.initialPointers=e.pointers,i.scale=r(i.initialPointers,i.pointers),i.deltaScale=i.scale-e.scale,i.rotation=a(i.initialPointers,i.pointers),i.deltaRotation=i.rotation-e.rotation,i)},_touchMove:function(e){e.preventDefault();var t=this._extractEventAttributes(this._touchState,e),n=4*-t.deltaScale;if(0!==n&&this._cam.zoom(n),2===t.numTouches&&2===this._touchState.numTouches){var i=.002*Math.tan(.5*this._cam.fieldOfViewY())*this._cam.zoom();this._cam.panXY(t.deltaCenter.x*i,t.deltaCenter.y*i)}var r=-t.deltaRotation;this._cam.rotateZ(r),1===t.numTouches&&1===this._touchState.numTouches&&(this._cam.rotateX(.005*t.deltaCenter.y),this._cam.rotateY(.005*t.deltaCenter.x)),this._viewer.requestRedraw(),this._touchState=t},_touchStart:function(e){if(e.preventDefault(),1===e.targetTouches.length){var t=(new Date).getTime();if(null!==this._lastSingleTap){var n=t-this._lastSingleTap;500>n&&this._viewer._mouseDoubleClick({clientX:e.targetTouches[0].clientX,clientY:e.targetTouches[0].clientY})}this._lastSingleTap=t}else this._lastSingleTap=null;this._touchState=this._extractEventAttributes(this._touchState,e)},_touchEnd:function(e){e.preventDefault()}},e}(),c=function(){function e(e,t,n,i){this._viewer=t,this._canvas=e,this._cam=n,this._canvas=e,this._animationTime=i,this._lastMouseUpTime=null,this._init()}return e.prototype={_centerOnClicked:function(e){null!==e&&this._viewer.setCenter(e.pos(),this._animationTime)},_mouseUp:function(e){var t=this._canvas,n=(new Date).getTime();if((null===this._lastMouseUpTime||n-this._lastMouseUpTime>300)&n-this._lastMouseDownTime<300){var i=this._canvas.domElement().getBoundingClientRect(),r=this._viewer.pick({x:e.clientX-i.left,y:e.clientY-i.top});this._viewer._dispatchEvent(e,"click",r)}this._lastMouseUpTime=n,t.removeEventListener("mousemove",this._mouseRotateListener),t.removeEventListener("mousemove",this._mousePanListener),t.removeEventListener("mouseup",this._mouseUpListener),document.removeEventListener("mouseup",this._mouseUpListener),document.removeEventListener("mousemove",this._mouseRotateListener),document.removeEventListener("mousemove",this._mousePanListener)},setCam:function(e){this._cam=e},_init:function(){return this._mousePanListener=i.bind(this,this._mousePan),this._mouseRotateListener=i.bind(this,this._mouseRotate),this._mouseUpListener=i.bind(this,this._mouseUp),this._canvas.onWheel(i.bind(this,this._mouseWheelFF),i.bind(this,this._mouseWheel)),this._canvas.on("dblclick",i.bind(this,this._mouseDoubleClick)),this._canvas.on("mousedown",i.bind(this,this._mouseDown)),!0},_mouseWheel:function(e){this._cam.zoom(e.wheelDelta<0?-1:1),e.preventDefault(),this._viewer.requestRedraw()},_mouseWheelFF:function(e){this._cam.zoom(e.deltaY<0?1:-1),e.preventDefault(),this._viewer.requestRedraw()},_mouseDoubleClick:function(){return function(e){var t=this._canvas.domElement().getBoundingClientRect(),n=this._viewer.pick({x:e.clientX-t.left,y:e.clientY-t.top});this._viewer._dispatchEvent(e,"doubleClick",n),this._viewer.requestRedraw()}}(),_mouseDown:function(e){0===e.button&&(this._lastMouseDownTime=(new Date).getTime(),e.preventDefault(),e.shiftKey===!0?(this._canvas.on("mousemove",this._mousePanListener),document.addEventListener("mousemove",this._mousePanListener,!1)):(this._canvas.on("mousemove",this._mouseRotateListener),document.addEventListener("mousemove",this._mouseRotateListener,!1)),this._canvas.on("mouseup",this._mouseUpListener),document.addEventListener("mouseup",this._mouseUpListener,!1),this._lastMousePos={x:e.pageX,y:e.pageY})},_mouseRotate:function(e){var t={x:e.pageX,y:e.pageY},n={x:t.x-this._lastMousePos.x,y:t.y-this._lastMousePos.y},i=.005;this._cam.rotateX(i*n.y),this._cam.rotateY(i*n.x),this._lastMousePos=t,this._viewer.requestRedraw()},_mousePan:function(e){var t={x:e.pageX,y:e.pageY},n={x:t.x-this._lastMousePos.x,y:t.y-this._lastMousePos.y},i=.002*Math.tan(.5*this._cam.fieldOfViewY())*this._cam.zoom();this._cam.panXY(i*n.x,i*n.y),this._lastMousePos=t,this._viewer.requestRedraw()}},e}(),h=function(){function t(e,t,n){return n?e*t:t*(e-1)+1}function n(e,n,i,r,a,s){a=a||!1,r=r||.5;var l=null,u=3*t(n,i,a);l=s?s.request(u):new Float32Array(u);var c,h,f,p=0,_=1/i,g=o.create(),m=o.create(),v=o.create(),y=o.create(),b=o.create(),x=o.create();for(o.set(y,e[0],e[1],e[2]),o.set(b,e[3],e[4],e[5]),a?(o.set(v,e[e.length-3],e[e.length-2],e[e.length-1]),o.sub(g,b,v),o.scale(g,g,r)):(o.set(v,e[0],e[1],e[2]),o.set(g,0,0,0)),c=1,f=n-1;f>c;++c){for(o.set(x,e[3*(c+1)],e[3*(c+1)+1],e[3*(c+1)+2]),o.sub(m,x,y),o.scale(m,m,r),h=0;i>h;++h)d(l,y,g,b,m,_*h,p),p+=3;o.copy(v,y),o.copy(y,b),o.copy(b,x),o.copy(g,m)}for(a?(o.set(x,e[0],e[1],e[3]),o.sub(m,x,y),o.scale(m,m,r)):o.set(m,0,0,0),h=0;i>h;++h)d(l,y,g,b,m,_*h,p),p+=3;if(!a)return l[p]=e[3*(n-1)+0],l[p+1]=e[3*(n-1)+1],l[p+2]=e[3*(n-1)+2],l;for(o.copy(v,y),o.copy(y,b),o.copy(b,x),o.copy(g,m),o.set(x,e[3],e[4],e[5]),o.sub(m,x,y),o.scale(m,m,r),h=0;i>h;++h)d(l,y,g,b,m,_*h,p),p+=3;return l}function i(e,t){this._center=e||o.create(),this._radius=t||1}function r(e,t){for(var n=new Float32Array(t*(e.length-1)+1),i=0,r=0,o=0,a=1/t,s=0;s<e.length-1;++s){r=e[s],o=e[s+1];for(var l=0;t>l;++l){var u=a*l;n[i+0]=r*(1-u)+o*u,i+=1}}return n[i+0]=o,n}var o=e.vec3,a=e.vec4,s=e.mat3,l=e.quat,u=function(){var e=o.create();return function(t,n,i){return o.cross(e,t,n),Math.atan2(o.dot(e,i),o.dot(t,n))}}(),c=function(){var e=o.create();return function(t,n){return o.copy(e,n),Math.abs(n[0])<Math.abs(n[1])?Math.abs(n[0])<Math.abs(n[2])?e[0]+=1:e[2]+=1:Math.abs(n[1])<Math.abs(n[2])?e[1]+=1:e[2]+=1,o.cross(t,n,e)}}(),h=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],a=t[1],s=t[2],l=o*o,u=o*a,c=o*s,h=a*a,d=a*s,f=s*s;return e[0]=l+r-l*r,e[1]=u-r*u-i*s,e[2]=c-r*c+i*a,e[3]=u-r*u+i*s,e[4]=h+r-r*h,e[5]=d-r*d-i*o,e[6]=c-r*c-i*a,e[7]=d-r*d+i*o,e[8]=f+r-r*f,e},d=function(){var e=o.create();return function(t,n,i,r,a,s,l){var u=s*s,c=3-2*s,h=u*c,d=1-h,f=u*(s-2)+s,p=u*(s-1);o.copy(e,n),o.scale(e,e,d),o.scaleAndAdd(e,e,i,f),o.scaleAndAdd(e,e,r,h),o.scaleAndAdd(e,e,a,p),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2]}}(),f=function(){var e=s.create(),t=s.create(),n=s.create(),i=s.create(),r=l.create(),u=o.create(),c=o.create();return function(h){for(var d=24,f=l.fromValues(0,0,0,1),p=0;d>p;++p){s.fromQuat(e,f);var _=s.transpose(n,e);s.mul(t,e,s.mul(i,h,_)),o.set(u,t[5],t[2],t[1]),o.set(c,Math.abs(u[0]),Math.abs(u[1]),Math.abs(u[2]));var g=c[0]>c[1]&&c[0]>c[2]?0:c[1]>c[2]?1:2,m=(g+1)%3,v=(g+2)%3;if(0===u[g])break;var y=(t[3*v+v]-t[3*m+m])/(2*u[g]),b=y>0?1:-1;y*=b;var x=y+(1e6>y?Math.sqrt(y*y+1):y),w=b/x,S=1/Math.sqrt(w*w+1);if(1===S)break;if(a.set(r,0,0,0,0),r[g]=b*Math.sqrt((1-S)/2),r[g]*=-1,r[3]=Math.sqrt(1-r[g]*r[g]),1===r[3])break;f=l.mul(f,f,r),l.normalize(f,f)}return f}}();i.prototype.center=function(){return this._center},i.prototype.radius=function(){return this._radius};var p=function(){return function(e,t,n,i,r){r?o.cross(i,t,n):c(i,t),o.cross(n,i,t),o.normalize(i,i),o.normalize(n,n),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=i[0],e[4]=i[1],e[5]=i[2],e[6]=t[0],e[7]=t[1],e[8]=t[2]}}();return{signedAngle:u,axisRotation:h,ortho:c,diagonalizer:f,catmullRomSpline:n,cubicHermiteInterpolate:d,interpolateScalars:r,catmullRomSplineNumPoints:t,Sphere:i,buildRotation:p}}(),d=function(){function t(e,t){this._arcs=t,this._stacks=e,this._indices=new Uint16Array(3*t*e*2),this._verts=new Float32Array(3*t*e);var n,i,r=Math.PI/(e-1),o=2*Math.PI/t;for(n=0;n<this._stacks;++n){var a=Math.sin(n*r),s=Math.cos(n*r);for(i=0;i<this._arcs;++i){var l=a*Math.cos(i*o),u=a*Math.sin(i*o);this._verts[3*(i+n*this._arcs)]=l,this._verts[3*(i+n*this._arcs)+1]=u,this._verts[3*(i+n*this._arcs)+2]=s}}var c=0;for(n=0;n<this._stacks-1;++n)for(i=0;i<this._arcs;++i)this._indices[c]=n*this._arcs+i,this._indices[c+1]=n*this._arcs+(i+1)%this._arcs,this._indices[c+2]=(n+1)*this._arcs+i,c+=3,this._indices[c]=n*this._arcs+(i+1)%this._arcs,this._indices[c+1]=(n+1)*this._arcs+(i+1)%this._arcs,this._indices[c+2]=(n+1)*this._arcs+i,c+=3}function n(e,t,n){var i=h.catmullRomSpline(e,e.length/3,t,n,!0);this._indices=new Uint16Array(2*i.length),this._verts=i,this._normals=new Float32Array(i.length),this._arcs=i.length/3;for(var o=r.create(),a=0;a<this._arcs;++a){var s=0===a?this._arcs-1:a-1,l=a===this._arcs-1?0:a+1;o[0]=this._verts[3*l+1]-this._verts[3*s+1],o[1]=this._verts[3*s]-this._verts[3*l],r.normalize(o,o),this._normals[3*a]=o[0],this._normals[3*a+1]=o[1],this._normals[3*a+2]=o[2]}for(a=0;a<this._arcs;++a)this._indices[6*a]=a,this._indices[6*a+1]=a+this._arcs,this._indices[6*a+2]=(a+1)%this._arcs+this._arcs,this._indices[6*a+3]=a,this._indices[6*a+4]=(a+1)%this._arcs+this._arcs,this._indices[6*a+5]=(a+1)%this._arcs}function i(e){this._arcs=e,this._indices=new Uint16Array(3*e*2),this._verts=new Float32Array(3*e*2),this._normals=new Float32Array(3*e*2);for(var t=2*Math.PI/this._arcs,n=0;n<this._arcs;++n){var i=Math.cos(t*n),r=Math.sin(t*n);this._verts[3*n]=i,this._verts[3*n+1]=r,this._verts[3*n+2]=-.5,this._verts[3*e+3*n]=i,this._verts[3*e+3*n+1]=r,this._verts[3*e+3*n+2]=.5,this._normals[3*n]=i,this._normals[3*n+1]=r,this._normals[3*e+3*n]=i,this._normals[3*e+3*n+1]=r}for(n=0;n<this._arcs;++n)this._indices[6*n]=n%this._arcs,this._indices[6*n+1]=e+(n+1)%this._arcs,this._indices[6*n+2]=(n+1)%this._arcs,this._indices[6*n+3]=n%this._arcs,this._indices[6*n+4]=e+n%this._arcs,this._indices[6*n+5]=e+(n+1)%this._arcs}var r=e.vec3;return t.prototype={addTransformed:function(){var e=r.create(),t=r.create();return function(n,i,o,a,s){for(var l=n.numVerts(),u=0;u<this._stacks*this._arcs;++u)r.set(t,this._verts[3*u],this._verts[3*u+1],this._verts[3*u+2]),r.copy(e,t),r.scale(e,e,o),r.add(e,e,i),n.addVertex(e,t,a,s);for(u=0;u<this._indices.length/3;++u)n.addTriangle(l+this._indices[3*u],l+this._indices[3*u+1],l+this._indices[3*u+2])}}(),numIndices:function(){return this._indices.length},numVerts:function(){return this._verts.length/3}},n.prototype={addTransformed:function(){var e=r.create(),t=r.create();return function(n,i,o,a,s,l,u,c){for(var h=this._arcs,d=this._normals,f=this._verts,p=n.numVerts()-h,_=0;h>_;++_)r.set(e,o*f[3*_],o*f[3*_+1],0),r.transformMat3(e,e,a),r.add(e,e,i),r.set(t,d[3*_],d[3*_+1],0),r.transformMat3(t,t,a),n.addVertex(e,t,s,c);if(!l)if(0!==u)for(_=0;h>_;++_)n.addTriangle(p+(_+u)%h,p+_+h,p+(_+1)%h+h),n.addTriangle(p+(_+u)%h,p+(_+1)%h+h,p+(_+1+u)%h);else for(_=0;_<this._indices.length/3;++_)n.addTriangle(p+this._indices[3*_],p+this._indices[3*_+1],p+this._indices[3*_+2])}}()},i.prototype={numVerts:function(){return this._verts.length/3},numIndices:function(){return this._indices.length},addTransformed:function(){var e=r.create(),t=r.create();return function(n,i,o,a,s,l,u,c,h){for(var d=n.numVerts(),f=this._verts,p=this._normals,_=this._arcs,g=0;2*_>g;++g){r.set(e,a*f[3*g],a*f[3*g+1],o*f[3*g+2]),r.transformMat3(e,e,s),r.add(e,e,i),r.set(t,p[3*g],p[3*g+1],p[3*g+2]),r.transformMat3(t,t,s);var m=_>g?c:h;n.addVertex(e,t,_>g?l:u,m)}var v=this._indices;for(g=0;g<v.length/3;++g)n.addTriangle(d+v[3*g],d+v[3*g+1],d+v[3*g+2])}}()},{TubeProfile:n,ProtoCylinder:i,ProtoSphere:t}}(),f=G=function(){function e(e){this._children=[],this._visible=!0,this._name=name||"",this._gl=e,this._order=1}return e.prototype={order:function(e){return void 0!==e&&(this._order=e),this._order},add:function(e){this._children.push(e)},draw:function(e,t,n,i){for(var r=0,o=this._children.length;r!==o;++r)this._children[r].draw(e,t,n,i)},show:function(){this._visible=!0},hide:function(){this._visible=!1},name:function(e){return void 0!==e&&(this._name=e),this._name},destroy:function(){for(var e=0;e<this._children.length;++e)this._children[e].destroy()},visible:function(){return this._visible}},e}(),p=V=function(){function t(e,t){e.eachResidue(function(e){var n=e.centralAtom();null!==n&&t(n,n.pos())})}function n(e){G.call(this,e),this._idRanges=[],this._vertAssocs=[],this._showRelated=null,this._selection=null}var r=e.vec3,o=function(){var e=r.create();return function(t,n,i){for(var o=0;o<n.length;++o)for(var a=n[o],s=t.chainsByName(a.chains()),l=0;l<a.matrices().length;++l)for(var u=a.matrix(l),c=0;c<s.length;++c)for(var h=s[c],d=0;d<h.residues().length;++d){var f=h.residues()[d].centralAtom();null!==f&&(r.transformMat4(e,f.pos(),u),i(f,e))}}}();return i.derive(n,G,{setShowRelated:function(e){return e&&"asym"!==e&&null===this.structure().assembly(e)?void console.error("no assembly with name",e,". Falling back to asymmetric unit"):(this._showRelated=e,e)},symWithIndex:function(e){if("asym"===this.showRelated())return null;var t=this.structure().assembly(this.showRelated());if(!t)return null;for(var n=t.generators(),i=0;i<n.length;++i){if(n[i].matrices().length>e)return n[i].matrix(e);e-=n[i].matrices().length}return null},showRelated:function(){return this._showRelated},select:function(e){return this.structure().select(e)},structure:function(){return this._vertAssocs[0]._structure},getColorForAtom:function(e,t){return this._vertAssocs[0].getColorForAtom(e,t)},addIdRange:function(e){this._idRanges.push(e)},destroy:function(){G.prototype.destroy.call(this);for(var e=0;e<this._idRanges.length;++e)this._idRanges[e].recycle()},eachCentralAtom:function(e){var n=this,i=n.structure(),r=i.assembly(n.showRelated());return null===r?t(i,e):o(i,r.generators(),e)},addVertAssoc:function(e){
this._vertAssocs.push(e)},_vertArraysInvolving:function(e){for(var t=this.vertArrays(),n=[],i={},r=0;r<e.length;++r)i[e[r]]=!0;for(var o=0;o<t.length;++o)i[t[o].chain()]===!0&&n.push(t[o]);return n},_drawSymmetryRelated:function(e,t,n){for(var i=n.generators(),r=0;r<i.length;++r){var o=i[r],a=this._vertArraysInvolving(o.chains());this._drawVertArrays(e,t,a,o.matrices())}},_updateProjectionIntervalsAsym:function(e,t,n,i,r,o){for(var a=this.vertArrays(),s=0;s<a.length;++s)a[s].updateProjectionIntervals(e,t,n,i,r,o)},updateProjectionIntervals:function(e,t,n,i,r,o){if(this._visible){var a=this.showRelated();if("asym"===a)return this._updateProjectionIntervalsAsym(e,t,n,i,r,o);for(var s=this.structure().assembly(a),l=s.generators(),u=0;u<l.length;++u)for(var c=l[u],h=this._vertArraysInvolving(c.chains()),d=0;d<c.matrices().length;++d)for(var f=0;f<h.length;++f){var p=c.matrix(d);h[f].updateProjectionIntervals(e,t,n,i,r,o,p)}}},_updateSquaredSphereRadiusAsym:function(e,t){for(var n=this.vertArrays(),i=0;i<n.length;++i)t=n[i].updateSquaredSphereRadius(e,t);return t},updateSquaredSphereRadius:function(e,t){if(!this._visible)return t;var n=this.showRelated();if("asym"===n)return this._updateSquaredSphereRadiusAsym(e,t);for(var i=this.structure().assembly(n),r=i.generators(),o=0;o<r.length;++o)for(var a=r[o],s=this._vertArraysInvolving(a.chains()),l=0;l<a.matrices().length;++l)for(var u=0;u<s.length;++u)t=s[u].updateSquaredSphereRadius(e,t);return t},draw:function(e,t,n,i){if(this._visible){var r=this.shaderForStyleAndPass(t,n,i);if(r){var o=this.showRelated();if("asym"===o)return this._drawVertArrays(e,r,this.vertArrays(),null);var a=this.structure().assembly(o);return this._drawSymmetryRelated(e,r,a)}}},colorBy:function(e,t){console.time("BaseGeom.colorBy"),this._ready=!1,t=t||this.structure();for(var n=0;n<this._vertAssocs.length;++n)this._vertAssocs[n].recolor(e,t);console.timeEnd("BaseGeom.colorBy")},setOpacity:function(e,t){console.time("BaseGeom.setOpacity"),this._ready=!1,t=t||this.structure();for(var n=0;n<this._vertAssocs.length;++n)this._vertAssocs[n].setOpacity(e,t);console.timeEnd("BaseGeom.setOpacity")},setSelection:function(e){console.time("BaseGeom.setSelection"),this._selection=e,this._ready=!1;for(var t=0;t<this._vertAssocs.length;++t)this._vertAssocs[t].setSelection(e);console.timeEnd("BaseGeom.setSelection")},selection:function(){return null===this._selection&&(this._selection=this.structure().createEmptyView()),this._selection}}),n}(),_=j=function(){function t(e,t,n){this._gl=e,this._vertBuffer=e.createBuffer(),this._float32Allocator=n||null,this._ready=!1,this._boundingSphere=null;var i=this._FLOATS_PER_VERT*t;this._vertData=n.request(i)}var n=e.vec3;return t.prototype={setColor:function(e,t,n,i,r){var o=e*this._FLOATS_PER_VERT+this._COLOR_OFFSET;this._vertData[o+0]=t,this._vertData[o+1]=n,this._vertData[o+2]=i,this._vertData[o+3]=r,this._ready=!1},getColor:function(e,t){var n=e*this._FLOATS_PER_VERT+this._COLOR_OFFSET;return t[0]=this._vertData[n+0],t[1]=this._vertData[n+1],t[2]=this._vertData[n+2],t[3]=this._vertData[n+3],t},setOpacity:function(e,t){var n=e*this._FLOATS_PER_VERT+this._COLOR_OFFSET;this._vertData[n+3]=t,this._ready=!1},setSelected:function(e,t){var n=e*this._FLOATS_PER_VERT+this._SELECT_OFFSET;this._vertData[n]=t,this._ready=!1},boundingSphere:function(){return this._boundingSphere||(this._boundingSphere=this._calculateBoundingSphere()),this._boundingSphere},_calculateBoundingSphere:function(){var e=this.numVerts();if(0===e)return null;var t,i,r=n.create();for(i=0;e>i;++i)t=i*this._FLOATS_PER_VERT,r[0]+=this._vertData[t+0],r[1]+=this._vertData[t+1],r[2]+=this._vertData[t+2];n.scale(r,r,1/e);var o=0;for(i=0;e>i;++i){t=i*this._FLOATS_PER_VERT;var a=r[0]-this._vertData[t+0],s=r[1]-this._vertData[t+1],l=r[2]-this._vertData[t+2];o=Math.max(o,a*a+s*s+l*l)}return new h.Sphere(r,Math.sqrt(o))},destroy:function(){this._gl.deleteBuffer(this._vertBuffer),this._float32Allocator.release(this._vertData)},bindBuffers:function(){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._vertBuffer),this._ready||(this._gl.bufferData(this._gl.ARRAY_BUFFER,this._vertData,this._gl.STATIC_DRAW),this._ready=!0)},updateSquaredSphereRadius:function(){var e=n.create();return function(t,i,r){var o=this.boundingSphere();if(!o)return i;if(r)return n.transformMat4(e,o.center(),r),Math.max(n.sqrDist(e,t),i);var a=o.radius()*o.radius();return Math.max(n.sqrDist(o.center(),t)+a,i)}}(),updateProjectionIntervals:function(){var e=n.create();return function(t,i,r,o,a,s,l){var u=this.boundingSphere();if(u){l?n.transformMat4(e,u.center(),l):n.copy(e,u.center());var c=n.dot(t,e),h=n.dot(i,e),d=n.dot(r,e);o.update(c-u.radius()),o.update(c+u.radius()),a.update(h-u.radius()),a.update(h+u.radius()),s.update(d-u.radius()),s.update(d+u.radius())}}}()},t}(),g=function(){function e(e,t,n){j.call(this,e,t,n),this._numVerts=0,this._primitiveType=this._gl.LINES}return i.derive(e,j,{_FLOATS_PER_VERT:9,_POS_OFFSET:0,_COLOR_OFFSET:3,_ID_OFFSET:7,_SELECT_OFFSET:8,numVerts:function(){return this._numVerts},setDrawAsPoints:function(e){e?this._primitiveType=this._gl.POINTS:this._primitiveType=this._gl.LINES},addPoint:function(e,t,n){var i=this._FLOATS_PER_VERT*this._numVerts;this._vertData[i++]=e[0],this._vertData[i++]=e[1],this._vertData[i++]=e[2],this._vertData[i++]=t[0],this._vertData[i++]=t[1],this._vertData[i++]=t[2],this._vertData[i++]=t[3],this._vertData[i++]=n,this._vertData[i++]=0,this._numVerts+=1,this._ready=!1,this._boundingSphere=null},addLine:function(e,t,n,i,r,o){this.addPoint(e,t,r),this.addPoint(n,i,o)},bindAttribs:function(e){this._gl.vertexAttribPointer(e.posAttrib,3,this._gl.FLOAT,!1,4*this._FLOATS_PER_VERT,4*this._POS_OFFSET),-1!==e.colorAttrib&&(this._gl.vertexAttribPointer(e.colorAttrib,4,this._gl.FLOAT,!1,4*this._FLOATS_PER_VERT,4*this._COLOR_OFFSET),this._gl.enableVertexAttribArray(e.colorAttrib)),this._gl.enableVertexAttribArray(e.posAttrib),-1!==e.objIdAttrib&&(this._gl.vertexAttribPointer(e.objIdAttrib,1,this._gl.FLOAT,!1,4*this._FLOATS_PER_VERT,4*this._ID_OFFSET),this._gl.enableVertexAttribArray(e.objIdAttrib)),-1!==e.selectAttrib&&(this._gl.vertexAttribPointer(e.selectAttrib,1,this._gl.FLOAT,!1,4*this._FLOATS_PER_VERT,4*this._SELECT_OFFSET),this._gl.enableVertexAttribArray(e.selectAttrib))},releaseAttribs:function(e){this._gl.disableVertexAttribArray(e.posAttrib),-1!==e.colorAttrib&&this._gl.disableVertexAttribArray(e.colorAttrib),-1!==e.objIdAttrib&&this._gl.disableVertexAttribArray(e.objIdAttrib),-1!==e.selectAttrib&&this._gl.disableVertexAttribArray(e.selectAttrib)},bind:function(e){this.bindBuffers(),this.bindAttribs(e)},draw:function(){this._gl.drawArrays(this._primitiveType,0,this._numVerts)}}),e}(),m=U=function(){function e(e,t,n,i,r){j.call(this,e,t,i),this._indexBuffer=e.createBuffer(),this._uint16Allocator=r,this._numVerts=0,this._maxVerts=t,this._numTriangles=0,this._indexData=r.request(n)}return i.derive(e,j,{destroy:function(){j.prototype.destroy.call(this),this._gl.deleteBuffer(this._indexBuffer),this._uint16Allocator.release(this._indexData)},setIndexData:function(e){this._ready=!1,this._numTriangles=e.length/3;for(var t=0;t<e.length;++t)this._indexData[t]=e[t]},setVertData:function(e){this._ready=!1,this._numVerts=e.length/this._FLOATS_PER_VERT;for(var t=0;t<e.length;++t)this._vertData[t]=e[t]},numVerts:function(){return this._numVerts},maxVerts:function(){return this._maxVerts},numIndices:function(){return 3*this._numTriangles},addVertex:function(e,t,n,i){if(this._numVerts===this._maxVerts)return void console.error("maximum number of vertices reached");var r=this._numVerts*this._FLOATS_PER_VERT;this._vertData[r++]=e[0],this._vertData[r++]=e[1],this._vertData[r++]=e[2],this._vertData[r++]=t[0],this._vertData[r++]=t[1],this._vertData[r++]=t[2],this._vertData[r++]=n[0],this._vertData[r++]=n[1],this._vertData[r++]=n[2],this._vertData[r++]=n[3],this._vertData[r++]=i,this._vertData[r++]=0,this._numVerts+=1,this._ready=!1},_FLOATS_PER_VERT:12,_BYTES_PER_VERT:48,_OBJID_OFFSET:10,_OBJID_BYTE_OFFSET:40,_SELECT_OFFSET:11,_SELECT_BYTE_OFFSET:44,_COLOR_OFFSET:6,_COLOR_BYTE_OFFSET:24,_NORMAL_OFFSET:3,_NORMAL_BYTE_OFFSET:12,_POS_OFFSET:0,_POS_BYTE_OFFSET:0,addTriangle:function(e,t,n){var i=3*this._numTriangles;i+2>=this._indexData.length||(this._indexData[i++]=e,this._indexData[i++]=t,this._indexData[i++]=n,this._numTriangles+=1,this._ready=!1)},bindBuffers:function(){var e=this._ready,t=this._gl;j.prototype.bindBuffers.call(this),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e||t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indexData,t.STATIC_DRAW)},bindAttribs:function(e){var t=this._gl,n=this._BYTES_PER_VERT;t.enableVertexAttribArray(e.posAttrib),t.vertexAttribPointer(e.posAttrib,3,t.FLOAT,!1,n,this._POS_BYTE_OFFSET),-1!==e.normalAttrib&&(t.enableVertexAttribArray(e.normalAttrib),t.vertexAttribPointer(e.normalAttrib,3,t.FLOAT,!1,n,this._NORMAL_BYTE_OFFSET)),-1!==e.colorAttrib&&(t.vertexAttribPointer(e.colorAttrib,4,t.FLOAT,!1,n,this._COLOR_BYTE_OFFSET),t.enableVertexAttribArray(e.colorAttrib)),-1!==e.objIdAttrib&&(t.vertexAttribPointer(e.objIdAttrib,1,t.FLOAT,!1,n,this._OBJID_BYTE_OFFSET),t.enableVertexAttribArray(e.objIdAttrib)),-1!==e.selectAttrib&&(t.vertexAttribPointer(e.selectAttrib,1,t.FLOAT,!1,n,this._SELECT_BYTE_OFFSET),t.enableVertexAttribArray(e.selectAttrib))},releaseAttribs:function(e){var t=this._gl;t.disableVertexAttribArray(e.posAttrib),-1!==e.colorAttrib&&t.disableVertexAttribArray(e.colorAttrib),-1!==e.normalAttrib&&t.disableVertexAttribArray(e.normalAttrib),-1!==e.objIdAttrib&&t.disableVertexAttribArray(e.objIdAttrib),-1!==e.selectAttrib&&t.disableVertexAttribArray(e.selectAttrib)},bind:function(e){this.bindBuffers(),this.bindAttribs(e)},draw:function(){var e=this._gl;e.drawElements(e.TRIANGLES,3*this._numTriangles,e.UNSIGNED_SHORT,0)}}),e}(),v=function(e){function t(t,n,i,r){e.call(this,n,i,r),this._chain=t}function n(e,t,n,i,r,o){U.call(this,t,n,i,r,o),this._chain=e}return i.derive(t,e,{chain:function(){return this._chain},drawSymmetryRelated:function(e,t,n){this.bind(t);for(var i=0;i<n.length;++i)e.bind(t,n[i]),this._gl.uniform1i(t.symId,i),this.draw();this.releaseAttribs(t)}}),i.derive(n,U,{chain:function(){return this._chain}}),n.prototype.drawSymmetryRelated=t.prototype.drawSymmetryRelated,{LineChainData:t,MeshChainData:n}}(g),y=function(e,t){function n(e,t,n){V.call(this,e),this._indexedVAs=[],this._float32Allocator=t,this._uint16Allocator=n,this._remainingVerts=null,this._remainingIndices=null}var r=e.MeshChainData;return i.derive(n,V,{_boundedVertArraySize:function(e){return Math.min(65536,e)},addChainVertArray:function(e,t,n){this._remainingVerts=t,this._remainingIndices=n;var i=new r(e.name(),this._gl,this._boundedVertArraySize(t),n,this._float32Allocator,this._uint16Allocator);return this._indexedVAs.push(i),i},addVertArray:function(e,n){this._remainingVerts=e,this._remainingIndices=n;var i=new t(this._gl,this._boundedVertArraySize(e),n,this._float32Allocator,this._uint16Allocator);return this._indexedVAs.push(i),i},vertArrayWithSpaceFor:function(e){var n=this._indexedVAs[this._indexedVAs.length-1],i=n.maxVerts()-n.numVerts();if(i>=e)return n;this._remainingVerts-=n.numVerts(),this._remainingIndices-=n.numIndices(),e=this._boundedVertArraySize(this._remainingVerts);var o=null;return o=n instanceof r?new r(n.chain(),this._gl,e,this._remainingIndices,this._float32Allocator,this._uint16Allocator):new t(this._gl,e,this._remainingIndices,this._float32Allocator,this._uint16Allocator),this._indexedVAs.push(o),o},vertArray:function(e){return this._indexedVAs[e]},destroy:function(){V.prototype.destroy.call(this);for(var e=0;e<this._indexedVAs.length;++e)this._indexedVAs[e].destroy();this._indexedVAs=[]},numVerts:function(){return this._indexedVAs[0].numVerts()},shaderForStyleAndPass:function(e,t,n){if("normal"===n)return"hemilight"===t?e.hemilight:e.phong;if("select"===n)return e.select;if("outline"===n)return e.outline;var i=e[n];return void 0!==i?i:null},_drawVertArrays:function(e,t,n,i){var r;if(i)for(r=0;r<n.length;++r)n[r].drawSymmetryRelated(e,t,i);else for(e.bind(t),this._gl.uniform1i(t.symId,255),r=0;r<n.length;++r)n[r].bind(t),n[r].draw(),n[r].releaseAttribs(t)},vertArrays:function(){return this._indexedVAs},addVertex:function(e,t,n,i){var r=this._indexedVAs[0];r.addVertex(e,t,n,i)},addTriangle:function(e,t,n){var i=this._indexedVAs[0];i.addTriangle(e,t,n)}}),n}(v,m),b=function(e){function t(e,t){V.call(this,e),this._vertArrays=[],this._float32Allocator=t,this._lineWidth=.5,this._pointSize=1}var n=e.LineChainData;return i.derive(t,V,{addChainVertArray:function(e,t){var i=new n(e.name(),this._gl,t,this._float32Allocator);return this._vertArrays.push(i),i},setLineWidth:function(e){this._lineWidth=e},setPointSize:function(e){this._pointSize=e},vertArrays:function(){return this._vertArrays},shaderForStyleAndPass:function(e,t,n){return"outline"===n?e.selectLines:"select"===n?e.select:e.lines},destroy:function(){V.prototype.destroy.call(this);for(var e=0;e<this._vertArrays.length;++e)this._vertArrays[e].destroy();this._vertArrays=[]},_drawVertArrays:function(e,t,n,i){var r=e.upsamplingFactor();-1!==t.selectAttrib&&(r=4*e.upsamplingFactor());var o;if(i)for(e.bind(t),this._gl.lineWidth(r*this._lineWidth),t.pointSize&&this._gl.uniform1f(t.pointSize,r*this._pointSize),o=0;o<n.length;++o)n[o].drawSymmetryRelated(e,t,i);else for(e.bind(t),this._gl.lineWidth(r*this._lineWidth),this._gl.uniform1i(t.symId,255),t.pointSize&&this._gl.uniform1f(t.pointSize,r*this._pointSize),o=0;o<n.length;++o)n[o].bind(t),n[o].draw(),n[o].releaseAttribs(t)},vertArray:function(){return this._va}}),t}(v),x=function(){function e(e,t){this._structure=e,this._assocs=[],this._callBeginEnd=t}function n(e,t,n){this._structure=e,this._assocs=[],this._callBeginEnd=n,this._interpolation=t||1,this._perResidueColors={}}return e.prototype={addAssoc:function(e,t,n,i){this._assocs.push({atom:e,vertexArray:t,vertStart:n,vertEnd:i})},recolor:function(e,t){var n=new Float32Array(4*t.atomCount());this._callBeginEnd&&e.begin(this._structure);var i={};t.eachAtom(function(t,r){i[t.index()]=r,e.colorFor(t,n,4*r)}),this._callBeginEnd&&e.end(this._structure);for(var r=0;r<this._assocs.length;++r){var o=this._assocs[r],a=i[o.atom.index()];if(void 0!==a)for(var s=n[4*a+0],l=n[4*a+1],u=n[4*a+2],c=n[4*a+3],h=o.vertexArray,d=o.vertStart;d<o.vertEnd;++d)h.setColor(d,s,l,u,c)}},getColorForAtom:function(e,t){for(var n=0;n<this._assocs.length;++n){var i=this._assocs[n];if(i.atom.full()===e.full())return i.vertexArray.getColor(i.vertStart,t)}return null},setSelection:function(e){var t={};e.eachAtom(function(e){t[e.index()]=!0});for(var n=0;n<this._assocs.length;++n)for(var i=this._assocs[n],r=t[i.atom.index()],o=r!==!0?0:1,a=i.vertexArray,s=i.vertStart;s<i.vertEnd;++s)a.setSelected(s,o)},setOpacity:function(e,t){var n={};t.eachAtom(function(e){n[e.index()]=!0});for(var i=0;i<this._assocs.length;++i){var r=this._assocs[i],o=n[r.atom.index()];if(o===!0)for(var a=r.vertexArray,s=r.vertStart;s<r.vertEnd;++s)a.setOpacity(s,e)}}},n.prototype={setPerResidueColors:function(e,t){this._perResidueColors[e]=t},addAssoc:function(e,t,n,i,r){this._assocs.push({traceIndex:e,slice:n,vertStart:i,vertEnd:r,vertexArray:t})},recolor:function(e,n){this._callBeginEnd&&e.begin(this._structure);var i,r,o=[],a=this._structure.backboneTraces();for(console.assert(this._perResidueColors,"per-residue colors must be set for recoloring to work"),i=0;i<a.length;++i){var s=this._perResidueColors[i];console.assert(s,"no per-residue colors. Seriously, man?");var l=0,u=a[i];for(r=0;r<u.length();++r)n.containsResidue(u.residueAt(r))?(e.colorFor(u.centralAtomAt(r),s,l),l+=4):l+=4;this._interpolation>1?o.push(t.interpolateColor(s,this._interpolation)):o.push(s)}for(i=0;i<this._assocs.length;++i){var c=this._assocs[i],h=c.slice,d=o[c.traceIndex],f=d[4*h],p=d[4*h+1],_=d[4*h+2],g=d[4*h+3],m=c.vertexArray;for(r=c.vertStart;r<c.vertEnd;++r)m.setColor(r,f,p,_,g)}this._callBeginEnd&&e.end(this._structure)},getColorForAtom:function(e,t){var n,i,r=this._structure.backboneTraces(),o=e.full().residue();for(n=0;n<r.length;++n){var a=this._perResidueColors[n],s=0,l=r[n];for(i=0;i<l.length();++i){if(o===l.residueAt(i).full())return t[0]=a[s+0],t[1]=a[s+1],t[2]=a[s+2],t[3]=a[s+3],t;s+=4}}return null},setSelection:function(e){var t,n,i=[],r=this._structure.backboneTraces();for(t=0;t<r.length;++t){var o=new Float32Array(this._perResidueColors[t].length),a=0,s=r[t];for(n=0;n<s.length();++n){var l=e.containsResidue(s.residueAt(n))?1:0;o[a]=l,a+=1}this._interpolation>1?i.push(h.interpolateScalars(o,this._interpolation)):i.push(o)}for(t=0;t<this._assocs.length;++t){var u=this._assocs[t],c=u.slice,d=i[u.traceIndex],f=d[c],p=u.vertexArray;for(n=u.vertStart;n<u.vertEnd;++n)p.setSelected(n,f)}},setOpacity:function(e,n){var i,r,o=[],a=this._structure.backboneTraces();for(i=0;i<a.length;++i){var s=this._perResidueColors[i],l=0,u=a[i];for(r=0;r<u.length();++r)n.containsResidue(u.residueAt(r))?(s[l+3]=e,l+=4):l+=4;this._interpolation>1?o.push(t.interpolateColor(s,this._interpolation)):o.push(s)}for(i=0;i<this._assocs.length;++i){var c=this._assocs[i],h=c.slice,d=o[c.traceIndex],f=d[4*h+3],p=c.vertexArray;for(r=c.vertStart;r<c.vertEnd;++r)p.setOpacity(r,f)}}},{TraceVertexAssoc:n,AtomVertexAssoc:e}}(),w=function(n,i,r,o){function a(e,t,n){for(var i=0;n-1>i;++i)e.addTriangle(t,t+1+i,t+2+i);e.addTriangle(t,t+n,t+1)}function s(e,t,n){for(var i=t+n,r=0;n-1>r;++r)e.addTriangle(i,t+r+1,t+r);e.addTriangle(i,t,t+n-1)}var l=e.vec3,u=e.vec4,c=e.mat3,d=n.TubeProfile,f=n.ProtoSphere,p=n.ProtoCylinder,_=o.TraceVertexAssoc,g=o.AtomVertexAssoc,m=t.interpolateColor,v={},y=.7071,b=[-y,-y,0,y,-y,0,y,y,0,-y,y,0],x=[-6*y,-.9*y,0,-5.8*y,-1*y,0,5.8*y,-1*y,0,6*y,-.9*y,0,6*y,.9*y,0,5.8*y,1*y,0,-5.8*y,1*y,0,-6*y,.9*y,0],w=[-10*y,-.9*y,0,-9.8*y,-1*y,0,9.8*y,-1*y,0,10*y,-.9*y,0,10*y,.9*y,0,9.8*y,1*y,0,-9.8*y,1*y,0,-10*y,.9*y,0],S=function(){var e=l.create(),t=l.create(),n=l.create();return function(i,r,o,a){r=Math.max(r,1),o=Math.min(a-1,o);var s=3*(r-1);l.set(e,i[s],i[s+1],i[s+2]),l.set(n,i[3*r],i[3*r+1],i[3*r+2]);for(var u=r;o>u;++u)s=3*(u+1),l.set(t,i[s],i[s+1],i[s+2]),i[3*u+0]=.25*t[0]+.5*n[0]+.25*e[0],i[3*u+1]=.25*t[1]+.5*n[1]+.25*e[1],i[3*u+2]=.25*t[2]+.5*n[2]+.25*e[2],l.copy(e,n),l.copy(n,t)}}(),A=function(){var e=u.fromValues(0,0,0,1);return function(t,n,i,r){var o=r.atomCount(),a=i.idPool.getContinuousRange(o);t.addIdRange(a);var s=i.protoSphere.numVerts(),l=i.protoSphere.numIndices(),u=1.5*i.radiusMultiplier;t.addChainVertArray(r,s*o,l*o),r.eachAtom(function(r){var o=t.vertArrayWithSpaceFor(s);i.color.colorFor(r,e,0);var l=o.numVerts(),c=a.nextId({geom:t,atom:r});i.protoSphere.addTransformed(o,r.pos(),u,e,c);var h=o.numVerts();n.addAssoc(r,o,l,h)})}}();v.spheres=function(e,t,n){console.time("spheres");var r=new f(n.sphereDetail,n.sphereDetail);n.protoSphere=r;var o=new i(t,n.float32Allocator,n.uint16Allocator),a=new g(e,!0);return o.addVertAssoc(a),o.setShowRelated(n.showRelated),n.color.begin(e),e.eachChain(function(e){A(o,a,n,e)}),n.color.end(e),console.timeEnd("spheres"),o};var k=function(){var e=l.create(),t=l.create(),n=u.fromValues(0,0,0,1),i=l.create(),r=l.create(),o=c.create();return function(a,s,u,c){var d=c.atomCount(),f=0;c.eachAtom(function(e){f+=e.bonds().length});var p=d*u.protoSphere.numVerts()+f*u.protoCyl.numVerts(),_=d*u.protoSphere.numIndices()+f*u.protoCyl.numIndices();a.addChainVertArray(c,p,_);var g=u.idPool.getContinuousRange(d);a.addIdRange(g),c.eachAtom(function(c){var d=u.protoSphere.numVerts()+c.bondCount()*u.protoCyl.numVerts(),f=a.vertArrayWithSpaceFor(d),p=f.numVerts(),_=g.nextId({geom:a,atom:c});u.color.colorFor(c,n,0),u.protoSphere.addTransformed(f,c.pos(),u.radius,n,_),c.eachBond(function(a){a.mid_point(e),l.sub(t,c.pos(),e);var s=l.length(t);l.scale(t,t,1/s),h.buildRotation(o,t,i,r,!1),l.add(e,e,c.pos()),l.scale(e,e,.5),u.protoCyl.addTransformed(f,e,s,u.radius,o,n,n,_,_)});var m=f.numVerts();s.addAssoc(c,f,p,m)})}}();v.ballsAndSticks=function(e,t,n){console.time("ballsAndSticks");var r=new g(e,!0),o=new f(n.sphereDetail,n.sphereDetail),a=new p(n.arcDetail);n.protoSphere=o,n.protoCyl=a;var s=new i(t,n.float32Allocator,n.uint16Allocator);return s.addVertAssoc(r),s.setShowRelated(n.showRelated),n.color.begin(e),e.eachChain(function(e){k(s,r,n,e)}),n.color.end(e),console.timeEnd("ballsAndSticks"),s};var C=function(){var e=u.fromValues(0,0,0,1);return function(t,n,i,r){var o=i.atomCount(),a=r.idPool.getContinuousRange(o);t.addIdRange(a);var s=t.addChainVertArray(i,o);s.setDrawAsPoints(!0),i.eachAtom(function(i){var o=s.numVerts();r.color.colorFor(i,e,0);var l=a.nextId({geom:t,atom:i});s.addPoint(i.pos(),e,l);var u=s.numVerts();n.addAssoc(i,s,o,u)})}}();v.points=function(e,t,n){console.time("points");var i=new g(e,!0);n.color.begin(e);var o=new r(t,n.float32Allocator);return o.setPointSize(n.pointSize),o.addVertAssoc(i),o.setShowRelated(n.showRelated),e.eachChain(function(e){C(o,i,e,n)}),n.color.end(e),console.timeEnd("points"),o};var T=function(){var e=l.create(),t=u.fromValues(0,0,0,1);return function(n,i,r,o){var a=0,s=r.atomCount(),l=o.idPool.getContinuousRange(s);n.addIdRange(l),r.eachAtom(function(e){var t=e.bonds().length;a+=t?t:3});var u=n.addChainVertArray(r,2*a);r.eachAtom(function(r){var a=u.numVerts(),s=l.nextId({geom:n,atom:r});if(r.bonds().length)r.eachBond(function(n){n.mid_point(e),o.color.colorFor(r,t,0),u.addLine(r.pos(),t,e,t,s,s)});else{var c=.2,h=r.pos();o.color.colorFor(r,t,0),u.addLine([h[0]-c,h[1],h[2]],t,[h[0]+c,h[1],h[2]],t,s,s),u.addLine([h[0],h[1]-c,h[2]],t,[h[0],h[1]+c,h[2]],t,s,s),u.addLine([h[0],h[1],h[2]-c],t,[h[0],h[1],h[2]+c],t,s,s)}var d=u.numVerts();i.addAssoc(r,u,a,d)})}}();v.lines=function(e,t,n){console.time("lines");var i=new g(e,!0);n.color.begin(e);var o=new r(t,n.float32Allocator);return o.setLineWidth(n.lineWidth),o.addVertAssoc(i),o.setShowRelated(n.showRelated),e.eachChain(function(e){T(o,i,e,n)}),n.color.end(e),console.timeEnd("lines"),o};var E=function(e){for(var t=0,n=0;n<e.length;++n)t+=2*(e[n].length()-1);return t},M=function(){var e=u.fromValues(0,0,0,1),t=u.fromValues(0,0,0,1),n=l.create(),i=l.create();return function(r,o,a,s,l,u){o.addAssoc(s,a,0,a.numVerts(),a.numVerts()+1);var c=u.float32Allocator.request(4*l.length()),h=u.idPool.getContinuousRange(l.length());r.addIdRange(h);for(var d,f=h.nextId({geom:r,atom:l.centralAtomAt(0)}),p=1;p<l.length();++p){u.color.colorFor(l.centralAtomAt(p-1),e,0),c[4*(p-1)+0]=e[0],c[4*(p-1)+1]=e[1],c[4*(p-1)+2]=e[2],c[4*(p-1)+3]=e[3],u.color.colorFor(l.centralAtomAt(p),t,0),l.posAt(n,p-1),l.posAt(i,p),d=h.nextId({geom:r,atom:l.centralAtomAt(p)}),a.addLine(n,e,i,t,f,d),f=d,d=null;var _=a.numVerts();o.addAssoc(s,a,p,_-1,_+(p===l.length()-1?0:1))}return c[4*l.length()-4]=t[0],c[4*l.length()-3]=t[1],c[4*l.length()-2]=t[2],c[4*l.length()-1]=t[3],o.setPerResidueColors(s,c),s+1}}(),L=function(e,t,n,i,r){for(var o=r.backboneTraces(),a=E(o),s=e.addChainVertArray(r,a),l=0;l<o.length;++l)i=M(e,t,s,i,o[l],n);return i};v.lineTrace=function(e,t,n){console.time("lineTrace");var i=new _(e,1,!0);n.color.begin(e);var o=new r(t,n.float32Allocator);o.setLineWidth(n.lineWidth);var a=0;return e.eachChain(function(e){a=L(o,i,n,a,e)}),o.addVertAssoc(i),o.setShowRelated(n.showRelated),n.color.end(e),console.timeEnd("lineTrace"),o};var R=function(e,t){for(var n=0,i=0;i<e.length;++i)n+=2*(t*(e[i].length()-1)+1);return n},O=function(){var e=l.create(),t=l.create(),n=u.fromValues(0,0,0,1),i=u.fromValues(0,0,0,1);return function(r,o,a,s,l,u){var c,d=u.fullTraceIndex(0),f=s.float32Allocator.request(3*u.length()),p=s.float32Allocator.request(4*u.length()),_=[],g=s.idPool.getContinuousRange(u.length());for(r.addIdRange(g),c=0;c<u.length();++c){var v=u.centralAtomAt(c);u.smoothPosAt(e,c,s.strength),s.color.colorFor(v,p,4*c),f[3*c]=e[0],f[3*c+1]=e[1],f[3*c+2]=e[2],_.push(g.nextId({geom:r,atom:v}))}var y=_[0],b=0,x=h.catmullRomSpline(f,u.length(),s.splineDetail,s.strength,!1,s.float32Allocator),w=m(p,s.splineDetail),S=a.numVerts();o.addAssoc(l,a,d,S,S+1);var A=Math.floor(s.splineDetail/2),k=h.catmullRomSplineNumPoints(u.length(),s.splineDetail,!1);for(c=1;k>c;++c){e[0]=x[3*(c-1)],e[1]=x[3*(c-1)+1],e[2]=x[3*(c-1)+2],t[0]=x[3*(c-0)],t[1]=x[3*(c-0)+1],t[2]=x[3*(c-0)+2],n[0]=w[4*(c-1)+0],n[1]=w[4*(c-1)+1],n[2]=w[4*(c-1)+2],n[3]=w[4*(c-1)+3],i[0]=w[4*(c-0)+0],i[1]=w[4*(c-0)+1],i[2]=w[4*(c-0)+2],i[3]=w[4*(c-0)+3];var C=Math.floor((c+A)/s.splineDetail);b=_[Math.min(_.length-1,C)],a.addLine(e,n,t,i,y,b),y=b;var T=a.numVerts();o.addAssoc(l,a,d+c,T-1,T+(c===u.length-1?0:1))}return o.setPerResidueColors(l,p),s.float32Allocator.release(f),s.float32Allocator.release(x),l+1}}(),P=function(e,t,n,i,r){for(var o=i.backboneTraces(),a=R(o,n.splineDetail),s=e.addChainVertArray(i,a),l=0;l<o.length;++l)r=O(e,t,s,n,r,o[l]);return r};v.sline=function(e,t,n){console.time("sline"),n.color.begin(e);var i=new _(e,n.splineDetail,1,!0),o=new r(t,n.float32Allocator);o.addVertAssoc(i),o.setLineWidth(n.lineWidth),o.setShowRelated(n.showRelated);var a=0;return e.eachChain(function(e){a=P(o,i,n,e,a)}),n.color.end(e),console.timeEnd("sline"),o};var D=function(e,t,n){for(var i=0,r=0;r<e.length;++r)i+=e[r].length()*t,i+=(e[r].length()-1)*n;return i},I=function(e,t,n){for(var i=0,r=0;r<e.length;++r)i+=e[r].length()*t,i+=(e[r].length()-1)*n;return i},N=function(e,t,n,i,r){var o=r.backboneTraces(),a=D(o,n.protoSphere.numVerts(),n.protoCyl.numVerts()),s=I(o,n.protoSphere.numIndices(),n.protoCyl.numIndices());e.addChainVertArray(r,a,s);for(var l=0;l<o.length;++l)U(e,t,o[l],i,n),i++;return i};v.trace=function(e,t,n){console.time("trace"),n.protoCyl=new p(n.arcDetail),n.protoSphere=new f(n.sphereDetail,n.sphereDetail);var r=new i(t,n.float32Allocator,n.uint16Allocator),o=new _(e,1,!0);r.addVertAssoc(o),r.setShowRelated(n.showRelated),n.color.begin(e);var a=0;return e.eachChain(function(e){a=N(r,o,n,a,e)}),n.color.end(e),console.timeEnd("trace"),r};var F=function(e,t,n){for(var i=0,r=0;r<e.length;++r){var o=((e[r].length()-1)*n+1)*t,a=Math.ceil((o+2)/65536);i+=o+(a-1)*t,i+=2}return i},B=function(e,t,n){for(var i=0,r=0;r<e.length;++r)i+=(e[r].length()*n-1)*t*6,i+=6*t;return i},z=function(){var e=c.create(),t=l.create(),n=l.create(),i=l.create(),r=l.create(),o=u.create();return function(a,s,u,c){for(var d=1.8*c.radius,f=c.protoCyl.numVerts()+2*c.protoSphere.numVerts(),p=0;p<u.length;++p){var _=u[p],g=c.idPool.getContinuousRange(_.length());a.addIdRange(g);for(var m=0;m<_.length();++m){var v=a.vertArrayWithSpaceFor(f),y=v.numVerts(),b=_.residueAt(m),x=b.name(),w=b.atom("C3'"),S=null;if(S="A"===x||"G"===x||"DA"===x||"DG"===x?b.atom("N1"):b.atom("N3"),null!==S&&null!==w){var A=g.nextId({geom:a,atom:S});l.add(r,w.pos(),S.pos()),l.scale(r,r,.5),c.color.colorFor(S,o,0),l.sub(i,S.pos(),w.pos());var k=l.length(i);l.scale(i,i,1/k),h.buildRotation(e,i,n,t,!1),c.protoCyl.addTransformed(v,r,k,d,e,o,o,A,A),c.protoSphere.addTransformed(v,S.pos(),d,o,A),c.protoSphere.addTransformed(v,w.pos(),d,o,A);var C=v.numVerts();console.assert(65536>=C,"too many vertices"),s.addAssoc(S,v,y,C)}}}}}(),H=function(e,t,n,i,r,o){for(var a=o.backboneTraces(),s=F(a,4*i.arcDetail,i.splineDetail),l=B(a,4*i.arcDetail,i.splineDetail),u=[],c=i.protoCyl.numVerts()+2*i.protoSphere.numVerts(),h=i.protoCyl.numIndices()+2*i.protoSphere.numIndices(),d=0;d<a.length;++d){var f=a[d];f.residueAt(0).isNucleotide()&&(u.push(f),s+=f.length()*c,l+=f.length()*h)}e.addChainVertArray(o,s,l);for(var p=0;p<a.length;++p)r=j(e,t,a[p],r,i);return z(e,n,u,i),r};v.cartoon=function(e,t,n){console.time("cartoon"),n.arrowSkip=Math.floor(3*n.splineDetail/4),n.coilProfile=new d(b,n.arcDetail,1),n.arrowProfile=new d(w,n.arcDetail/2,.1),n.helixProfile=new d(x,n.arcDetail/2,.1),n.strandProfile=new d(x,n.arcDetail/2,.1),n.protoCyl=new p(4*n.arcDetail),n.protoSphere=new f(4*n.arcDetail,4*n.arcDetail);var r=new i(t,n.float32Allocator,n.uint16Allocator),o=new _(e,n.splineDetail,!0);r.addVertAssoc(o),r.setShowRelated(n.showRelated),n.color.begin(e);var a=0,s=e.select({anames:["N1","N3"]}),l=new g(s,!0);return r.addVertAssoc(l),e.eachChain(function(e){a=H(r,o,l,n,a,e)}),n.color.end(e),console.timeEnd("cartoon"),r},v.surface=function(){var e=l.create(),t=l.create(),n=u.fromValues(.8,.8,.8,1);return function(r,o,a){var s=0;r.getUint32(0),s+=4;var u=r.getUint32(s);s+=4;var c=24,h=c*u+s,d=r.getUint32(h),f=new i(o,a.float32Allocator,a.uint16Allocator);f.setShowRelated("asym");var p,_=f.addVertArray(u,3*d);for(p=0;u>p;++p)l.set(e,r.getFloat32(s+0),r.getFloat32(s+4),r.getFloat32(s+8)),s+=12,l.set(t,r.getFloat32(s+0),r.getFloat32(s+4),r.getFloat32(s+8)),s+=12,_.addVertex(e,t,n,0);for(s=h+4,p=0;d>p;++p){var g=r.getUint32(s+0),m=r.getUint32(s+4),v=r.getUint32(s+8);s+=12,_.addTriangle(g-1,v-1,m-1)}return f}}();var q=function(){var e=c.create(),t=l.create();return function(n,i,r,o,a,s,u,c,d,f,p){var _=d.coilProfile;"C"===o||d.forceTube?c?h.ortho(r,a):l.cross(r,t,a):"H"===o?_=d.helixProfile:"E"===o?_=d.strandProfile:"A"===o&&(_=d.arrowProfile),h.buildRotation(e,a,r,t,!0),_.addTransformed(n,i,u,e,s,c,f,p)}}(),G=function(){var e=l.create(),t=l.create(),n=l.create();return function(i,r,o,a,s,u,c,h){var d=null,f=null,p=r.length();l.set(n,0,0,0);for(var _=0;p>_;++_){u.push(c.nextId({geom:i,atom:r.centralAtomAt(_)})),r.smoothPosAt(e,_,h.strength),a[3*_]=e[0],a[3*_+1]=e[1],a[3*_+2]=e[2],r.smoothNormalAt(t,_,h.strength);var g=r.centralAtomAt(_);h.color.colorFor(g,o,4*_),l.dot(t,n)<0&&l.scale(t,t,-1),"E"!==r.residueAt(_).ss()||h.forceTube||(null===d&&(d=_),f=_),"C"===r.residueAt(_).ss()&&null!==d&&(S(a,d,f,p),S(s,d,f,p),d=null,f=null),s[3*_]=a[3*_]+t[0]+n[0],s[3*_+1]=a[3*_+1]+t[1]+n[1],s[3*_+2]=a[3*_+2]+t[2]+n[2],l.copy(n,t)}}}(),j=function(){var e=l.create(),t=l.create(),n=u.fromValues(0,0,0,1),i=l.create(),r=l.create();return function(o,c,d,f,p){var _=F([d],4*p.arcDetail,p.splineDetail),g=p.float32Allocator.request(3*d.length()),v=p.float32Allocator.request(4*d.length()),y=p.float32Allocator.request(3*d.length()),b=[],x=p.idPool.getContinuousRange(d.length());o.addIdRange(x),G(o,d,v,g,y,b,x,p);var w=o.vertArrayWithSpaceFor(_),S=h.catmullRomSpline(g,d.length(),p.splineDetail,p.strength,!1,p.float32Allocator),A=h.catmullRomSpline(y,d.length(),p.splineDetail,p.strength,!1,p.float32Allocator);c.setPerResidueColors(f,v);var k=p.radius*(d.residueAt(0).isAminoacid()?1:1.8),C=m(v,p.splineDetail);l.set(e,S[3]-S[0],S[4]-S[1],S[5]-S[2]),l.set(t,S[0],S[1],S[2]),l.set(i,A[0]-S[0],A[1]-S[0],A[2]-S[2]),l.normalize(e,e),l.normalize(i,i),u.set(n,C[0],C[1],C[2],C[3]);var T=w.numVerts();w.addVertex(t,[-e[0],-e[1],-e[2]],n,b[0]),q(w,t,i,d.residueAt(0).ss(),e,n,k,!0,p,0,b[0]),a(w,T,4*p.arcDetail);var E=w.numVerts(),M=0;c.addAssoc(f,w,M,T,E),M+=1;for(var L=Math.floor(p.splineDetail/2),R=h.catmullRomSplineNumPoints(d.length(),p.splineDetail,!1),O=4*p.arcDetail,P=1,D=R;D>P;++P){var I=3*P,N=4*P,B=3*(P+1),z=3*(P-1);l.set(t,S[I],S[I+1],S[I+2]),P===D-1?l.set(e,S[I]-S[z],S[I+1]-S[z+1],S[I+2]-S[z+2]):l.set(e,S[B]-S[z],S[B+1]-S[z+1],S[B+2]-S[z+2]),l.normalize(e,e),u.set(n,C[N],C[N+1],C[N+2],C[N+3]);var H=0,j=Math.floor(P/p.splineDetail),U=Math.floor((P-1)/p.splineDetail),V=Math.floor((P+p.arrowSkip)/p.splineDetail),W=!1,X=d.residueAt(j).ss();if(!p.forceTube){if(j!==U){var K=d.residueAt(U).ss();if("C"===K&&("H"===X||"E"===X)){l.set(r,A[z]-S[z],A[z+1]-S[z+1],A[z+2]-S[z+2]),l.normalize(r,r);var Y=2*Math.PI/(4*p.arcDetail),Z=h.signedAngle(i,r,e);H=Math.round(Z/Y),H=(H+4*p.arcDetail)%(4*p.arcDetail)}}if(V!==j&&V<d.length()){var $=d.residueAt(V).ss();"C"===$&&"E"===X&&(W=!0)}}l.set(i,A[3*P]-S[I],A[I+1]-S[I+1],A[I+2]-S[I+2]),l.normalize(i,i),T=w.numVerts();var J=Math.floor((P+L)/p.splineDetail),Q=b[Math.min(b.length-1,J)];q(w,t,i,X,e,n,k,!1,p,H,Q);var ee=P===D-1?1:O;w.numVerts()+ee>w.maxVerts()&&(E=w.numVerts(),c.addAssoc(f,w,M,T,E),w=o.vertArrayWithSpaceFor(ee),T=0,q(w,t,i,X,e,n,k,!0,p,0,Q)),W&&(c.addAssoc(f,w,M,T,E),q(w,t,i,"A",e,n,k,!1,p,0,Q),P+=p.arrowSkip),E=w.numVerts(),P===D-1&&(E+=1),c.addAssoc(f,w,M,T,E),
M+=1,W&&(M+=p.arrowSkip)}return w.addVertex(t,e,n,b[b.length-1]),s(w,T,4*p.arcDetail),p.float32Allocator.release(y),p.float32Allocator.release(g),f+1}}(),U=function(){var e=c.create(),t=l.create(),n=l.create(),i=l.create(),r=l.create(),o=l.create(),a=l.create(),s=u.fromValues(0,0,0,1),d=u.fromValues(0,0,0,1);return function(u,c,f,p,_){if(0!==f.length()){var g=_.idPool.getContinuousRange(f.length());u.addIdRange(g),_.color.colorFor(f.centralAtomAt(0),s,0);var m=D([f],_.protoSphere.numVerts(),_.protoCyl.numVerts()),v=m,y=u.vertArrayWithSpaceFor(m),b=y.maxVerts(),x=y.numVerts();f.posAt(o,0);var w=g.nextId({geom:u,atom:f.centralAtomAt(0)}),S=0;_.protoSphere.addTransformed(y,o,_.radius,s,w);var A=null;c.addAssoc(p,y,0,x,A);var k=_.float32Allocator.request(4*f.length());k[0]=s[0],k[1]=s[1],k[2]=s[2],k[3]=s[3];for(var C=_.protoCyl.numVerts()+_.protoSphere.numVerts(),T=1;T<f.length();++T){S=g.nextId({geom:u,atom:f.centralAtomAt(T)}),f.posAt(o,T-1),f.posAt(a,T),_.color.colorFor(f.centralAtomAt(T),d,0),k[4*T+0]=d[0],k[4*T+1]=d[1],k[4*T+2]=d[2],k[4*T+3]=d[3],l.sub(t,a,o);var E=l.length(t);l.scale(t,t,1/E),h.buildRotation(e,t,n,i,!1),l.copy(r,o),l.add(r,r,a),l.scale(r,r,.5),C>b-y.numVerts()&&(y=u.vertArrayWithSpaceFor(v)),v-=C;var M=y.numVerts();_.protoCyl.addTransformed(y,r,E,_.radius,e,s,d,w,S),A=y.numVerts(),A-=(A-M)/2,_.protoSphere.addTransformed(y,a,_.radius,d,S),w=S,c.addAssoc(p,y,T,x,A),x=A,l.copy(s,d)}c.setPerResidueColors(p,k),c.addAssoc(p,y,f.length()-1,x,y.numVerts())}}}();return v}(d,y,b,x),S=function(){function e(e,t,n,i,r,o){G.call(this,e);var a=o||{};this._options={},this._options.fillStyle=a.fillStyle||"#000",this._options.backgroundAlpha=a.backgroundAlpha||0,this._options.fontSize=a.fontSize||24,this._options.font=a.font||"Verdana",this._options.fontStyle=a.fontStyle||"normal",this._options.fontColor=a.fontColor||"#000",this._order=100,this._pos=i,this._interleavedBuffer=this._gl.createBuffer(),this._interleavedData=new Float32Array(30),this._prepareText(t,n,r);var s=.5,l=.5;this._interleavedData[0]=i[0],this._interleavedData[1]=i[1],this._interleavedData[2]=i[2],this._interleavedData[3]=-s,this._interleavedData[4]=-l,this._interleavedData[5]=i[0],this._interleavedData[6]=i[1],this._interleavedData[7]=i[2],this._interleavedData[8]=s,this._interleavedData[9]=l,this._interleavedData[10]=i[0],this._interleavedData[11]=i[1],this._interleavedData[12]=i[2],this._interleavedData[13]=s,this._interleavedData[14]=-l,this._interleavedData[15]=i[0],this._interleavedData[16]=i[1],this._interleavedData[17]=i[2],this._interleavedData[18]=-s,this._interleavedData[19]=-l,this._interleavedData[20]=i[0],this._interleavedData[21]=i[1],this._interleavedData[22]=i[2],this._interleavedData[23]=-s,this._interleavedData[24]=l,this._interleavedData[25]=i[0],this._interleavedData[26]=i[1],this._interleavedData[27]=i[2],this._interleavedData[28]=s,this._interleavedData[29]=l}function t(e){for(var t=1;e>t;)t*=2;return t}return i.derive(e,G,{updateProjectionIntervals:function(){},updateSquaredSphereRadius:function(e,t){return t},_setupTextParameters:function(e){e.fillStyle=this._options.fontColor,e.textAlign="left",e.textBaseline="bottom",e.font=this._options.fontStyle+" "+this._options.fontSize+"px "+this._options.font},_prepareText:function(e,n,i){this._setupTextParameters(n);var r=n.measureText(i).width,o=24;e.width=t(r),e.height=t(o),n.fillStyle=this._options.fillStyle,n.globalAlpha=this._options.backgroundAlpha,n.fillRect(0,0,e.width,e.height),this._setupTextParameters(n),n.globalAlpha=1,n.lineWidth=.5,n.lineStyle="none",n.fillText(i,0,e.height),n.strokeText(i,0,e.height),this._texture=this._gl.createTexture(),this._textureFromCanvas(this._texture,e),this._xScale=r/e.width,this._yScale=o/e.height,this._width=r,this._height=o},_textureFromCanvas:function(e,t){var n=this._gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.generateMipmap(n.TEXTURE_2D),n.bindTexture(n.TEXTURE_2D,null)},bind:function(){var e=this._gl;e.bindBuffer(e.ARRAY_BUFFER,this._interleavedBuffer),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),this._ready||(e.bufferData(e.ARRAY_BUFFER,this._interleavedData,e.STATIC_DRAW),this._ready=!0)},draw:function(e,t,n,i){if(this._visible&&"normal"===i){var r=t.text;e.bind(r),this.bind();var o=this._gl,a=e.upsamplingFactor();o.uniform1f(o.getUniformLocation(r,"xScale"),this._xScale),o.uniform1f(o.getUniformLocation(r,"yScale"),this._yScale),o.uniform1f(o.getUniformLocation(r,"width"),2*a*this._width/e.viewportWidth()),o.uniform1f(o.getUniformLocation(r,"height"),2*a*this._height/e.viewportHeight()),o.uniform1i(o.getUniformLocation(r,"sampler"),0);var s=o.getAttribLocation(r,"attrCenter");o.enableVertexAttribArray(s),o.vertexAttribPointer(s,3,o.FLOAT,!1,20,0);var l=o.getAttribLocation(r,"attrCorner");o.vertexAttribPointer(l,2,o.FLOAT,!1,20,12),o.enableVertexAttribArray(l),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.drawArrays(o.TRIANGLES,0,6),o.disableVertexAttribArray(s),o.disableVertexAttribArray(l),o.disable(o.BLEND)}}}),e}(),A=function(n){function r(){this._vertData=[],this._indexData=[],this._numVerts=0}function o(e,t,i,o,a){G.call(this,t),this._float32Allocator=i,this._uint16Allocator=o,this._data=new r,this._protoSphere=new n.ProtoSphere(8,8),this._protoCyl=new n.ProtoCylinder(8),this._va=null,this._idRanges=[],this._idPool=a,this._ready=!1,this._currentRange=null}function a(e,t,n){for(var i=0;n-1>i;++i)e.addTriangle(t,t+1+i,t+2+i);e.addTriangle(t,t+n,t+1)}function s(e,t,n){for(var i=t+n,r=0;n-1>r;++r)e.addTriangle(i,t+r+1,t+r);e.addTriangle(i,t,t+n-1)}var l=e.vec3,u=e.mat3,c=t.forceRGB,d=100;return r.prototype={numVerts:function(){return this._numVerts},addVertex:function(e,t,n,i){this._numVerts+=1,this._vertData.push(e[0],e[1],e[2],t[0],t[1],t[2],n[0],n[1],n[2],n[3],i,0)},addTriangle:function(e,t,n){this._indexData.push(e,t,n)},numIndices:function(){return this._indexData.length},indexData:function(){return this._indexData},vertData:function(){return this._vertData}},i.derive(o,G,{updateProjectionIntervals:function(){},updateSquaredSphereRadius:function(e,t){return t},addTube:function(){var e=l.create(),t=l.create(),n=l.create(),i=l.create(),r=u.create();return function(o,u,d,f){f=f||{};var p=c(f.color||"white"),_=!0;void 0!==f.cap&&(_=f.cap),l.sub(i,u,o);var g=l.length(i);if(l.normalize(i,i),l.add(e,o,u),l.scale(e,e,.5),h.buildRotation(r,i,t,n,!1),_){var m=this._data.numVerts();this._data.addVertex(o,[-i[0],-i[1],-i[2]],p,0),a(this._data,m,8)}var v=void 0!==f.userData?f.userData:null;console.log(v);var y=this._nextObjectId({center:e,userData:v,geom:this});if(this._protoCyl.addTransformed(this._data,e,g,d,r,p,p,y,y),_){var b=this._data.numVerts();this._data.addVertex(u,i,p,0),s(this._data,b-8,8)}this._ready=!1}}(),_nextObjectId:function(e){return this._currentRange&&this._currentRange.hasLeft()||(this._currentRange=this._idPool.getContinuousRange(d),this._idRanges.push(this._currentRange)),this._currentRange.nextId(e)},destroy:function(){G.prototype.destroy.call(this);for(var e=0;e<this._idRanges.length;++e)this._idRanges[e].recycle()},addSphere:function(e,t,n){n=n||{};var i=c(n.color||"white"),r=void 0!==n.userData?n.userData:null,o=this._nextObjectId({center:e,userData:r,geom:this});this._protoSphere.addTransformed(this._data,e,t,i,o),this._ready=!1},_prepareVertexArray:function(){this._ready=!0,null!==this._va&&this._va.destroy(),this._va=new U(this._gl,this._data.numVerts(),this._data.numIndices(),this._float32Allocator,this._uint16Allocator),this._va.setIndexData(this._data.indexData()),this._va.setVertData(this._data.vertData())},draw:function(e,t,n,i){if(this._visible){this._ready||this._prepareVertexArray();var r=this.shaderForStyleAndPass(t,n,i);if(r){e.bind(r),this._gl.uniform1i(r.symId,255);var o=this._va;o.bind(r),o.draw(),o.releaseAttribs(r)}}},shaderForStyleAndPass:function(e,t,n){if("normal"===n)return"hemilight"===t?e.hemilight:e.phong;if("select"===n)return e.select;if("outline"===n)return e.outline;var i=e[n];return void 0!==i?i:null}}),o}(d),k=function(){function t(e,t,n){this._from=e,this._to=t,this._duration=n,this._left=n,this._start=Date.now(),this._looping=!1,this._finished=!1}function n(e,n,i){t.call(this,p.clone(e),p.clone(n),i),this._current=p.clone(e)}function r(e,n,i){var r=g.create(),o=g.create();g.fromMat4(r,e),g.fromMat4(o,n);var a=_.create(),s=_.create();_.fromMat3(a,r),_.fromMat3(s,o),this._current=g.create(),t.call(this,a,s,i)}function o(e,n){t.call(this,null,null,n),this._axis=p.clone(e),this.setLooping(!0),this._previousAngle=0}function a(e,n){var i=1e3*(2*Math.PI/n);t.call(this,null,null,i),this._axis=p.clone(e),this.setLooping(!0),this._speed=n,this._previousT=0}function s(){this._animations=[]}function l(e,t,i){return new n(e,t,i)}function u(e,t,n){return new r(e,t,n)}function c(e,n,i){return new t(e,n,i)}function d(e,t){return new a(e,t)}function f(){return new o([0,1,0],2e3)}var p=e.vec3,_=e.quat,g=e.mat3;return t.prototype={setLooping:function(e){this._looping=e},step:function(e){var t,n=Date.now(),i=n-this._start;if(0===this._duration)t=1;else if(this._looping){var r=Math.floor(i/this._duration);t=(i-r*this._duration)/this._duration}else i=Math.min(this._duration,i),t=i/this._duration,this._finished=1===t;return this.apply(e,t),this._finished},apply:function(e,t){var n=(1-Math.cos(t*Math.PI))/2;this._current=this._from*(1-n)+this._to*n,e.setZoom(this._current)},finished:function(){return this._finished}},i.derive(n,t,{apply:function(e,t){var n=(1-Math.cos(t*Math.PI))/2;p.lerp(this._current,this._from,this._to,n),e.setCenter(this._current)}}),i.derive(r,t,{apply:function(){var e=_.create();return function(t,n){_.slerp(e,this._from,this._to,n),g.fromQuat(this._current,e),t.setRotation(this._current)}}()}),i.derive(o,t,{apply:function(){var e=g.create(),t=g.create();return function(n,i){g.fromMat4(t,n.rotation());var r=.2*Math.sin(2*i*Math.PI),o=r-this._previousAngle;this._previousAngle=r,h.axisRotation(e,this._axis,o),g.mul(t,e,t),n.setRotation(t)}}()}),i.derive(a,t,{apply:function(){var e=g.create(),t=g.create();return function(n,i){g.fromMat4(t,n.rotation());var r=2*Math.PI*(i-this._previousT);this._previousT=i,h.axisRotation(e,this._axis,r),g.mul(t,e,t),n.setRotation(t)}}(),setSpeed:function(e){this._speed=e},setAxis:function(e){this._axis=e}}),s.prototype={run:function(e){var t=Date.now();return this._animations=this._animations.filter(function(n){return!n.step(e,t)}),this._animations.length>0},add:function(e){this._animations.push(e)},remove:function(e){this._animations=this._animations.filter(function(t){return t!==e})}},{AnimationControl:s,move:l,rotate:u,zoom:c,rockAndRoll:f,spin:d}}(),C=function(){function e(e,t){this.near=e,this.far=t}function t(e){e=e||{},this._near=e.near||.1,this._far=e.far||400}function n(){this._far=100}return t.prototype.update=function(){return new e(this._near,this._far)},n.prototype.update=function(t,n){for(var i=n.center(),r=null,o=0;o<t.length;++o){var a=t[o];a.visible()&&(r=a.updateSquaredSphereRadius(i,r))}if(null===r)return null;r=Math.sqrt(r);var s=n.zoom(),l=1.05*(r+s),u=.1;return new e(u,l)},{FixedSlab:t,AutoSlab:n,Slab:e}}(),T=function(n,r,o,a,s,l,u,c,h,d,f,p){function _(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)}function g(e,t){return e=e||"auto","fixed"===e?new C.FixedSlab(t):"auto"===e?new C.AutoSlab(t):null}function m(e,t,n,i,r,o){this._pos=i,this._target=e,this._node=t,this._symIndex=n,this._legacyObject=r,this._legacyTransform=o}function v(e,t){this._options=this._initOptions(t,e),this._initialized=!1,this._objects=[],this._domElement=e,this._redrawRequested=!1,this._resize=!1,this._lastTimestamp=null,this._objectIdManager=new n,this._spin=null,this._rockAndRoll=null,this.listenerMap={},this._animControl=new p.AnimationControl,this._initKeyboardInput(),this._initCanvas(),this.quality(this._options.quality),null!==this._options.click&&this.on("click",this._options.click),null!==this._options.doubleClicked&&this.on("doubleClick",this._options.doubleClick),"complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState?this._initViewer():document.addEventListener("DOMContentLoaded",i.bind(this,this._initViewer))}function y(e,t,n){return t in e?e[t]:n}function b(e){return e.atomDoubleClick?(console.warn("use of atomDoubleClick is deprecated. ","use doubleClick instead"),e.atomDoubleClick):e.atomDoubleClicked?(console.warn("use of atomDoubleClicked is deprecated. ","use doubleClick instead"),e.atomDoubleClicked):e.doubleClick?e.doubleClick:"center"}function x(e){return e.atomClick?(console.warn("use of atomClick is deprecated. ","use click instead"),e.atomClick):e.atomClicked?(console.warn("use of atomClicked is deprecated. ","use click instead"),e.atomClicked):e.click?e.click:null}var w='<div style="vertical-align:middle; text-align:center;"><h1>WebGL not supported</h1><p>Your browser does not support WebGL. You might want to try Chrome, Firefox, IE 11, or newer versions of Safari</p><p>If you are using a recent version of one of the above browsers, your graphic card might be blocked. Check the browser documentation for details on how to unblock it.</p></div>',S=e.vec3,A=e.mat4,k=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();return m.prototype={symIndex:function(){return this._symIndex},target:function(){return this._target},pos:function(){return this._pos},node:function(){return this._node},transform:function(){return this._legacyTransform},object:function(){return this._legacyObject}},v.prototype={_initOptions:function(e,n){e=e||{};var i={width:e.width||500,height:e.height||500,animateTime:e.animateTime||0,antialias:e.antialias,quality:y(e,"quality","low"),style:y(e,"style","hemilight"),background:t.forceRGB(e.background||"white"),slabMode:g(e.slabMode),outline:y(e,"outline",!0),outlineColor:t.forceRGB(y(e,"outlineColor","black")),outlineWidth:y(e,"outlineWidth",1.5),selectionColor:t.forceRGB(y(e,"selectionColor","#3f3")),fov:y(e,"fov",45),doubleClick:b(e),click:x(e),fog:y(e,"fog",!0),transparency:y(e,"transparency","alpha")},r=n.getBoundingClientRect();return"auto"===i.width&&(i.width=r.width),"auto"===i.height&&(i.height=r.height),i},_ensureSize:function(){this._resize&&(this._resize=!1,this._cam.setViewportSize(this._canvas.viewportWidth(),this._canvas.viewportHeight()),this._pickBuffer.resize(this._options.width,this._options.height))},resize:function(e,t){(e!==this._options.width||t!==this._options.height)&&(this._canvas.resize(e,t),this._resize=!0,this._options.width=e,this._options.height=t,this.requestRedraw())},fitParent:function(){var e=this._domElement.getBoundingClientRect();this.resize(e.width,e.height)},gl:function(){return this._canvas.gl()},ok:function(){return this._initialized},options:function(e,n){if(void 0!==n)if(this._options[e]=n,"fog"===e)this._cam.fog(n),this.requestRedraw();else if("fov"===e)this._cam.setFieldOfViewY(n*Math.PI/180);else if("selectionColor"===e)this._cam.setSelectionColor(t.forceRGB(n));else if("outlineColor"===e)this._cam.setOutlineColorColor(t.forceRGB(n));else if("outlineWidth"===e)this._cam.setOutlineWidth(n+0);else if("transparency"===e){var i="screendoor"===n;this._cam.setScreenDoorTransparency(i)}return this._options[e]},quality:function(e){return this._options.quality=e,"high"===e?(this._options.arcDetail=4,this._options.sphereDetail=16,void(this._options.splineDetail=8)):"medium"===e?(this._options.arcDetail=2,this._options.sphereDetail=10,void(this._options.splineDetail=5)):"low"===e?(this._options.arcDetail=2,this._options.sphereDetail=8,void(this._options.splineDetail=3)):void console.error("invalid quality argument",e)},imageData:function(){return this._canvas.imageData()},_initPickBuffer:function(){var e={width:this._options.width,height:this._options.height};this._pickBuffer=new o(this._canvas.gl(),e)},_initViewer:function(){if(!this._canvas.initGL())return this._domElement.removeChild(this._canvas.domElement()),this._domElement.innerHTML=w,this._domElement.style.width=this._options.width+"px",this._domElement.style.height=this._options.height+"px",!1;this._initPickBuffer(),this._2dcontext=this._textureCanvas.getContext("2d"),this._float32Allocator=new a(Float32Array),this._uint16Allocator=new a(Uint16Array),this._cam=new s(this._canvas.gl()),this._cam.setUpsamplingFactor(this._canvas.superSamplingFactor()),this._cam.setOutlineWidth(this._options.outlineWidth);var e="screendoor"===this._options.transparency;this._cam.setScreenDoorTransparency(e),this._cam.fog(this._options.fog),this._cam.setFogColor(this._options.background),this._cam.setOutlineColor(this._options.outlineColor),this._cam.setSelectionColor(this._options.selectionColor),this._cam.setFieldOfViewY(this._options.fov*Math.PI/180),this._mouseHandler.setCam(this._cam);var t=this._canvas,n=_()?"highp":"mediump";return this._shaderCatalog={hemilight:t.initShader(l.HEMILIGHT_VS,l.PRELUDE_FS+l.HEMILIGHT_FS,n),phong:t.initShader(l.HEMILIGHT_VS,l.PRELUDE_FS+l.PHONG_FS,n),outline:t.initShader(l.OUTLINE_VS,l.PRELUDE_FS+l.OUTLINE_FS,n),lines:t.initShader(l.LINES_VS,l.PRELUDE_FS+l.LINES_FS,n),text:t.initShader(l.TEXT_VS,l.TEXT_FS,n),selectLines:t.initShader(l.SELECT_LINES_VS,l.SELECT_LINES_FS,n),select:t.initShader(l.SELECT_VS,l.SELECT_FS,n)},this._boundDraw=i.bind(this,this._draw),this._touchHandler=new u(this._canvas.domElement(),this,this._cam),this._initialized||(this._initialized=!0,this._dispatchEvent({name:"viewerReadyEvent"},"viewerReady",this)),!0},requestRedraw:function(){this._redrawRequested||(this._redrawRequested=!0,k(this._boundDraw))},boundingClientRect:function(){return this._canvas.domElement().getBoundingClientRect()},_drawWithPass:function(e){for(var t=0,n=this._objects.length;t!==n;++t)this._objects[t].draw(this._cam,this._shaderCatalog,this._options.style,e)},_initKeyboardInput:function(){var e=document.createElement("div");e.setAttribute("style","overflow:hidden;width:0;height:0"),this._keyInput=document.createElement("textarea"),this._domElement.appendChild(e),e.appendChild(this._keyInput),this._keyInput.focus()},focus:function(){this._keyInput.focus()},_initCanvas:function(){var e={antialias:this._options.antialias,height:this._options.height,width:this._options.width,backgroundColor:this._options.background};this._canvas=new r.Canvas(this._domElement,e),this._textureCanvas=document.createElement("canvas"),this._textureCanvas.style.display="none",this._domElement.appendChild(this._textureCanvas),this._mouseHandler=new c(this._canvas,this,this._cam,this._options.animateTime),this._canvas.domElement().addEventListener("mousedown",i.bind(this,this._gainFocus))},_gainFocus:function(){this._keyInput.focus()},setRotation:function(e,t){if(t|=0,0===t)return this._cam.setRotation(e),void this.requestRedraw();var n;9===e.length?(n=A.create(),A.fromMat3(n,e)):n=A.clone(e),this._animControl.add(p.rotate(this._cam.rotation(),n,t)),this.requestRedraw()},setCamera:function(e,t,n,i){i|=0,this.setCenter(t,i),this.setRotation(e,i),this.setZoom(n,i)},_animateCam:function(){var e=this._animControl.run(this._cam);e&&this.requestRedraw()},_draw:function(){if(null!==this._canvas){this._redrawRequested=!1,this._animateCam(),this._canvas.bind(),this._ensureSize();var e=this._canvas.gl();e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var t=this._options.slabMode.update(this._objects,this._cam);null!==t&&this._cam.setNearFar(t.near,t.far),e.enable(e.CULL_FACE),this._options.outline&&(e.cullFace(e.BACK),e.enable(e.CULL_FACE),this._drawWithPass("outline")),e.cullFace(e.FRONT),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this._drawWithPass("normal")}},setCenter:function(e,t){return t|=0,0===t?void this._cam.setCenter(e):(this._animControl.add(p.move(this._cam.center(),S.clone(e),t)),void this.requestRedraw())},setZoom:function(e,t){return t|=0,0===t?void this._cam.setZoom(e):(this._animControl.add(p.zoom(this._cam.zoom(),e,t)),void this.requestRedraw())},centerOn:function(e,t){this.setCenter(e.center(),t)},clear:function(){for(var e=0;e<this._objects.length;++e)this._objects[e].destroy();this._objects=[]},addListener:function(e,t){if("keypress"===e||"keydown"===e||"keyup"===e)console.log("keypress"),this._keyInput.addEventListener(e,t,!1);else{var n=this.listenerMap[e];if("undefined"==typeof n&&(n=[],this.listenerMap[e]=n),"center"===t){var r=i.bind(this._mouseHandler,this._mouseHandler._centerOnClicked);n.push(r)}else n.push(t);this._initialized&&"viewerReady"===e&&t(this,null)}},_dispatchEvent:function(e,t,n){var i=this.listenerMap[t];i&&i.forEach(function(t){t(n,e)})},RENDER_MODES:["sline","lines","trace","lineTrace","cartoon","tube","spheres","ballsAndSticks","points"],renderAs:function(e,t,n,i){for(var r=!1,o=0;o<this.RENDER_MODES.length;++o)if(this.RENDER_MODES[o]===n){r=!0;break}return r?this[n](e,t,i):void console.error("render mode",n,"not supported")},_handleStandardMolOptions:function(e,t){return e=this._handleStandardOptions(e),e.showRelated=e.showRelated||"asym",e.showRelated&&"asym"!==e.showRelated&&null===t.assembly(e.showRelated)&&(console.error("no assembly with name",e.showRelated,". Falling back to asymmetric unit"),e.showRelated="asym"),e},_handleStandardOptions:function(e){return e=i.copy(e),e.float32Allocator=this._float32Allocator,e.uint16Allocator=this._uint16Allocator,e.idPool=this._objectIdManager,e},lineTrace:function(e,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||t.uniform([1,0,1]),r.lineWidth=r.lineWidth||4;var o=h.lineTrace(n,this._canvas.gl(),r);return this.add(e,o)},spheres:function(e,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||t.byElement(),r.sphereDetail=this.options("sphereDetail"),r.radiusMultiplier=r.radiusMultiplier||1;var o=h.spheres(n,this._canvas.gl(),r);return this.add(e,o)},sline:function(e,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||t.uniform([1,0,1]),r.splineDetail=r.splineDetail||this.options("splineDetail"),r.strength=r.strength||1,r.lineWidth=r.lineWidth||4;var o=h.sline(n,this._canvas.gl(),r);return this.add(e,o)},cartoon:function(e,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||t.bySS(),r.strength=r.strength||1,r.splineDetail=r.splineDetail||this.options("splineDetail"),r.arcDetail=r.arcDetail||this.options("arcDetail"),r.radius=r.radius||.3,r.forceTube=r.forceTube||!1;var o=h.cartoon(n,this._canvas.gl(),r),a=this.add(e,o);return a},surface:function(e,t,n){var i=this._handleStandardOptions(n),r=h.surface(t,this._canvas.gl(),i);return this.add(e,r)},tube:function(e,t,n){return n=n||{},n.forceTube=!0,this.cartoon(e,t,n)},ballsAndSticks:function(e,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||t.byElement(),r.radius=r.radius||.3,r.arcDetail=2*(r.arcDetail||this.options("arcDetail")),r.sphereDetail=r.sphereDetail||this.options("sphereDetail");var o=h.ballsAndSticks(n,this._canvas.gl(),r);return this.add(e,o)},lines:function(e,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||t.byElement(),r.lineWidth=r.lineWidth||4;var o=h.lines(n,this._canvas.gl(),r);return this.add(e,o)},points:function(e,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||t.byElement(),r.pointSize=r.pointSize||1;var o=h.points(n,this._canvas.gl(),r);return this.add(e,o)},trace:function(e,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||t.uniform([1,0,0]),r.radius=r.radius||.3,r.arcDetail=2*(r.arcDetail||this.options("arcDetail")),r.sphereDetail=r.sphereDetail||this.options("sphereDetail");var o=h.trace(n,this._canvas.gl(),r);return this.add(e,o)},_updateProjectionIntervals:function(e,t,n){n.eachAtom(function(n){for(var i=n.pos(),r=0;3>r;++r)t[r].update(S.dot(i,e[r]))});for(var i=0;3>i;++i)t[i].extend(1.5)},fitTo:function(e){var t=this._cam.mainAxes(),n=[new i.Range,new i.Range,new i.Range];if(e instanceof G)e.updateProjectionIntervals(t[0],t[1],t[2],n[0],n[1],n[2]);else if(void 0!==e.eachAtom)this._updateProjectionIntervals(t,n,e);else if(void 0!==e.length)for(var r=0;r<e.length;++r)this._updateProjectionIntervals(t,n,e[r]);this._fitToIntervals(t,n)},_fitToIntervals:function(e,t){if(t[0].empty()||t[1].empty()||t[2].empty())return void console.error("could not determine interval. No objects shown?");var n=t[0].center(),i=t[1].center(),r=t[2].center(),o=[n*e[0][0]+i*e[1][0]+r*e[2][0],n*e[0][1]+i*e[1][1]+r*e[2][1],n*e[0][2]+i*e[1][2]+r*e[2][2]],a=this._cam.fieldOfViewY(),s=this._cam.aspectRatio(),l=t[0].length()/s,u=t[1].length(),c=.5*Math.max(l,u),h=c/Math.tan(.5*a),d=h+.5*t[2].length(),f=.5,p=Math.max(h-f,.1),_=2*f+h+t[2].length();this._cam.setNearFar(p,_),this.setCamera(this._cam.rotation(),o,d,this._options.animateTime),this.requestRedraw()},autoZoom:function(){var e=this._cam.mainAxes(),t=[new i.Range,new i.Range,new i.Range];this.forEach(function(n){n.visible()&&n.updateProjectionIntervals(e[0],e[1],e[2],t[0],t[1],t[2])}),this._fitToIntervals(e,t)},slabInterval:function(){},autoSlab:function(){var e=this._options._slabMode.update(this._objects,this._cam);null!==e&&this._cam.setNearFar(e.near,e.far),this.requestRedraw()},rockAndRoll:function(e){return void 0===e?null!==this._rockAndRoll:e?(null===this._rockAndRoll&&(this._rockAndRoll=p.rockAndRoll(),this._animControl.add(this._rockAndRoll),this.requestRedraw()),!0):(this._animControl.remove(this._rockAndRoll),this._rockAndRoll=null,this.requestRedraw(),!1)},spin:function(e,t){return void 0===e?null!==this._spin:e===!1?(this._animControl.remove(this._spin),this._spin=null,this.requestRedraw(),!1):(e===!0&&(e=Math.PI/8),t=t||[0,1,0],null===this._spin?(this._spin=p.spin(t,e),this._animControl.add(this._spin)):(this._spin.setSpeed(e),this._spin.setAxis(t)),this.requestRedraw(),!0)},slabMode:function(e,t){t=t||{};var n=g(e,t),i=n.update(this._objects,this._cam);null!==i&&this._cam.setNearFar(i.near,i.far),this._options.slabMode=n,this.requestRedraw()},label:function(e,t,n,i){var r=new d(this._canvas.gl(),this._textureCanvas,this._2dcontext,n,t,i);return this.add(e,r),r},customMesh:function(e,t){var n=this._handleStandardOptions(t),i=new f(e,this._canvas.gl(),n.float32Allocator,n.uint16Allocator,n.idPool);return this.add(e,i),i},_drawPickingScene:function(){var e=this._canvas.gl();e.clearColor(0,0,0,0),e.disable(e.BLEND),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.clearColor(this._options.background[0],this._options.background[1],this._options.background[2],1),e.cullFace(e.FRONT),e.enable(e.CULL_FACE),this._drawWithPass("select")},pick:function(){return function(e){this._pickBuffer.bind(),this._drawPickingScene();var t=new Uint8Array(4),n=this._canvas.gl();n.readPixels(e.x,this._options.height-e.y,1,1,n.RGBA,n.UNSIGNED_BYTE,t),this._pickBuffer.release(),t.data&&(t=t.data);var i=t[0]|t[1]<<8|t[2]<<16,r=t[3],o=this._objectIdManager.objectForId(i);if(void 0===o)return null;var a=S.create(),s=null,l=null;return 255!==r?(s=o.atom,l=o.geom.symWithIndex(r),S.transformMat4(a,o.atom.pos(),l)):void 0!==o.atom?(s=o.atom,a=o.atom.pos()):(s=o.userData,a=o.center),new m(s,o.geom,255>r?r:null,a,o,l)}}(),add:function(e,t){return t.name(e),this._objects.push(t),this._objects.sort(function(e,t){return e.order()-t.order()}),this.requestRedraw(),t},_globToRegex:function(e){var t=e.replace(".","\\.").replace("*",".*");return new RegExp("^"+t+"$")},forEach:function(){var e,t="*";2===arguments.length?(e=arguments[1],t=arguments[0]):e=arguments[0];for(var n=this._globToRegex(t),i=0;i<this._objects.length;++i){var r=this._objects[i];n.test(r.name())&&e(r,i)}},get:function(e){for(var t=0;t<this._objects.length;++t)if(this._objects[t].name()===e)return this._objects[t];return console.error("could not find object with name",e),null},hide:function(e){this.forEach(e,function(e){e.hide()})},show:function(e){this.forEach(e,function(e){e.show()})},rm:function(e){for(var t=[],n=this._globToRegex(e),i=0;i<this._objects.length;++i){var r=this._objects[i];n.test(r.name())?r.destroy():t.push(r)}this._objects=t},all:function(){return this._objects},isWebGLSupported:function(){return this._canvas.isWebGLSupported()},destroy:function(){this.clear(),this._canvas.destroy(),this._canvas=null}},v.prototype.on=v.prototype.addListener,{Viewer:function(e,t){return new v(e,t)},isWebGLSupported:r.isWebGLSupported}}(n,r,o,a,s,l,u,c,w,S,A,k),E=function(){function e(e,t){this._chains=e||[],this._matrices=t||[]}function t(e){this._name=e,this._generators=[]}return e.prototype={addChain:function(e){this._chains.push(e)},chains:function(){return this._chains},addMatrix:function(e){this._matrices.push(e)},matrices:function(){return this._matrices},matrix:function(e){return this._matrices[e]}},t.prototype={name:function(){return this._name},generators:function(){return this._generators},generator:function(e){return this._generators[e]},addGenerator:function(e){this._generators.push(e)}},{SymGenerator:e,Assembly:t}}(),M=function(){function t(){}function n(e,n,i,r,o,a,s,l){t.call(this),this._residue=e,this._bonds=[],this._isHetatm=!!a,this._name=n,this._pos=i,this._index=o,this._element=r,this._occupancy=void 0!==s?s:null,this._tempFactor=void 0!==l?l:null}function r(e,n){t.call(this),this._resView=e,this._atom=n,this._bonds=[]}var o=e.vec3;return t.prototype={bondCount:function(){return this.bonds().length},eachBond:function(e){for(var t=this.bonds(),n=0,i=t.length;i>n;++n)e(t[n])},isConnectedTo:function(e){if(null===e)return!1;for(var t=e.full(),n=this.full(),i=this.bonds(),r=0,o=i.length;o>r;++r){var a=i[r];if(a.atom_one()===n&&a.atom_two()===t||a.atom_one()===t&&a.atom_two()===n)return!0}return!1}},i.derive(n,t,{addBond:function(e){this._bonds.push(e)},name:function(){return this._name},bonds:function(){return this._bonds},residue:function(){return this._residue},structure:function(){return this._residue.structure()},full:function(){return this},qualifiedName:function(){return this.residue().qualifiedName()+"."+this.name()},pos:function(){return this._pos},setPos:function(e){o.copy(this._pos,e)},element:function(){return this._element},index:function(){return this._index},prop:function(e){return this[e]()},occupancy:function(){return this._occupancy},tempFactor:function(){return this._tempFactor},isHetatm:function(){return this._isHetatm}}),i.derive(r,t,{full:function(){return this._atom},name:function(){return this._atom.name()},pos:function(){return this._atom.pos()},element:function(){return this._atom.element()},residue:function(){return this._resView},bonds:function(){return this._atom.bonds()},index:function(){return this._atom.index()},occupancy:function(){return this._atom.occupancy()},tempFactor:function(){return this._atom.tempFactor()},qualifiedName:function(){return this._atom.qualifiedName()},isHetatm:function(){return this._atom.isHetatm()}}),{Atom:n,AtomView:r}}(),L=function(t){function n(){}function r(e,t,i,r){n.call(this),this._name=t,this._num=i,this._insCode=r,this._atoms=[],this._ss="C",this._chain=e,this._isAminoacid=!1,this._isNucleotide=!1,this._index=e.residues().length}function o(e,t){n.call(this),this._chainView=e,this._atoms=[],this._residue=t}var a=e.vec3,s=t.Atom,l=t.AtomView;return n.prototype={prop:function(e){return this[e]()},isWater:function(){return"HOH"===this.name()||"DOD"===this.name()},eachAtom:function(e,t){t|=0;for(var n=0;n<this._atoms.length;n+=1){if(e(this._atoms[n],t)===!1)return!1;t+=1}return t},qualifiedName:function(){var e=this.chain().name()+"."+this.name()+this.num();return"\x00"===this.insCode()?e:e+this.insCode()},atom:function(e){if("string"==typeof e){for(var t=0;t<this._atoms.length;++t)if(this._atoms[t].name()===e)return this._atoms[t];return null}return e>=this._atoms.length&&0>e?null:this._atoms[e]},centralAtom:function(){return this.isAminoacid()?this.atom("CA"):this.isNucleotide()?this.atom("C3'"):null;
},center:function(){var e=0,t=a.create();return this.eachAtom(function(n){a.add(t,t,n.pos()),e+=1}),e>0&&a.scale(t,t,1/e),t},isAminoacid:function(){return this._isAminoacid},isNucleotide:function(){return this._isNucleotide}},i.derive(r,n,{_deduceType:function(){this._isNucleotide=null!==this.atom("P")&&null!==this.atom("C3'"),this._isAminoacid=null!==this.atom("N")&&null!==this.atom("CA")&&null!==this.atom("C")&&null!==this.atom("O")},name:function(){return this._name},insCode:function(){return this._insCode},num:function(){return this._num},full:function(){return this},addAtom:function(e,t,n,i,r,o){var a=new s(this,e,t,n,this.structure().nextAtomIndex(),i,r,o);return this._atoms.push(a),a},ss:function(){return this._ss},setSS:function(e){this._ss=e},index:function(){return this._index},atoms:function(){return this._atoms},chain:function(){return this._chain},structure:function(){return this._chain.structure()}}),i.derive(o,n,{addAtom:function(e,t){if(t)for(var n=0;n<this._atoms.length;++n){var i=this._atoms[n];if(i.index()===e.index())return i}var r=new l(this,e.full());return this._atoms.push(r),r},removeAtom:function(e){var t=this._atoms.length;return this._atoms=this._atoms.filter(function(t){return t.index()!==e.index()}),t!==this._atoms.length},full:function(){return this._residue},num:function(){return this._residue.num()},insCode:function(){return this._residue.insCode()},ss:function(){return this._residue.ss()},index:function(){return this._residue.index()},chain:function(){return this._chainView},name:function(){return this._residue.name()},atoms:function(){return this._atoms},qualifiedName:function(){return this._residue.qualifiedName()},containsResidue:function(e){return this._residue.full()===e.full()},isAminoacid:function(){return this._residue.isAminoacid()},isNucleotide:function(){return this._residue.isNucleotide()},isWater:function(){return this._residue.isWater()}}),{ResidueView:o,Residue:r}}(M),R=function(){function t(){this._trace=[]}function n(e,t,n){this._fullTrace=e,this._fullTraceBegin=t,this._fullTraceEnd=n,this._isNTerminal=0===this._fullTraceBegin,this._isCTerminal=this._fullTrace.length()===this._fullTraceEnd;var i=this._fullTraceEnd-this._fullTraceBegin;this._isCTerminal||++i,this._isNTerminal||(++i,this._fullTraceBegin-=1),this._length=i}var i=e.vec3;return t.prototype={push:function(e){this._trace.push(e)},length:function(){return this._trace.length},residueAt:function(e){return this._trace[e]},posAt:function(e,t){return i.copy(e,this._trace[t].centralAtom().pos()),e},normalAt:function(e,t){var n=this._trace[t];return n.isAminoacid()&&i.sub(e,n.atom("O").pos(),n.atom("C").pos()),i.normalize(e,e),e},centralAtomAt:function(e){return this._trace[e].centralAtom()},tangentAt:function(){var e=i.create(),t=i.create();return function(n,r){r>0?this.posAt(e,r-1):this.posAt(e,r),r<this._trace.length-1?this.posAt(t,r+1):this.posAt(t,r),i.sub(n,t,e)}}(),fullTraceIndex:function(e){return e},subsets:function(e){for(var t=0,i=0,r=[];i<e.length&&t<this._trace.length;){for(var o=e[i].full().index();this._trace.length>t&&this._trace[t].index()<o;)++t;if(t>=this._trace.length)break;for(var a=this._trace[t].index();e.length>i&&e[i].full().index()<a;)++i;if(i>=e.length)break;for(var s=t;e.length>i&&this._trace.length>t&&e[i].full().index()===this._trace[t].index();)++i,++t;var l=t;r.push(new n(this,s,l))}return r}},t.prototype.smoothPosAt=t.prototype.posAt,t.prototype.smoothNormalAt=t.prototype.normalAt,n.prototype={length:function(){return this._length},residueAt:function(e){return this._fullTrace.residueAt(this._fullTraceBegin+e)},_interpolate:function(){var e=i.create(),t=i.create();return function(n,r,o,a){return this.tangentAt(e,r),this.tangentAt(t,o),i.scale(e,e,a),i.scale(t,t,a),h.cubicHermiteInterpolate(n,this.centralAtomAt(r).pos(),e,this.centralAtomAt(o).pos(),t,.5,0),n}}(),smoothPosAt:function(){return function(e,t,n){if(0===t&&!this._isNTerminal)return this._interpolate(e,t,t+1,n);if(t===this._length-1&&!this._isCTerminal)return this._interpolate(e,t-1,t,n);var r=this.centralAtomAt(t);return i.copy(e,r.pos()),e}}(),smoothNormalAt:function(){return function(e,t){return this._fullTrace.normalAt(e,t+this._fullTraceBegin),e}}(),posAt:function(e,t){var n=this.centralAtomAt(t),r=null;return i.copy(e,n.pos()),0!==t||this._isNTerminal||(r=this.centralAtomAt(t+1),i.add(e,e,r.pos()),i.scale(e,e,.5)),t!==this._length-1||this._isCTerminal||(r=this.centralAtomAt(t-1),i.add(e,e,r.pos()),i.scale(e,e,.5)),e},centralAtomAt:function(e){return this.residueAt(e).centralAtom()},fullTraceIndex:function(e){return this._fullTraceBegin+e},tangentAt:function(e,t){return this._fullTrace.tangentAt(e,t+this._fullTraceBegin)}},{TraceSubset:n,BackboneTrace:t}}(),O=function(t,n){function r(e,t){return e<<8|t.charCodeAt(0)}function o(e,t){return e.num()<t.num()}function a(e){return{num:function(){return e}}}function s(){}function l(e,t){s.call(this),this._structure=e,this._name=t,this._cachedTraces=[],this._residues=[],this._rnumsOrdered=!0}function u(e,t,n){var i,r;if(e?(i=t.atom("C"),r=n.atom("N")):(i=t.atom("O3'"),r=n.atom("P")),i.isConnectedTo(r))return!1;var o=f.sqrDist(i.pos(),r.pos());return Math.abs(o-2.25)>1}function c(e,t){t.length()<2||e.push(t)}function h(e,t,n){if(0===e.length)return!0;if(!t)return!1;var i=r(n.num(),n.insCode()),o=e[e.length-1],a=r(o.num(),o.insCode());return i>a}function d(e,t){s.call(this),this._chain=t,this._residues=[],this._molView=e,this._residueMap={},this._rnumsOrdered=!0}var f=e.vec3,p=t.Residue,_=t.ResidueView;return s.prototype={eachAtom:function(e,t){t|=0;for(var n=0;n<this._residues.length;n+=1)if(t=this._residues[n].eachAtom(e,t),t===!1)return!1;return t},atomCount:function(){for(var e=0,t=this.residues(),n=0;n<t.length;++n)e+=t[n].atoms().length;return e},eachResidue:function(e){for(var t=0;t<this._residues.length;t+=1)if(e(this._residues[t])===!1)return!1},residues:function(){return this._residues},structure:function(){return this._structure},asView:function(){var e=this.structure().createEmptyView();return e.addChain(this,!0),e},residueByRnum:function(e){var t=this.residues();if(this._rnumsOrdered){var n=i.binarySearch(t,a(e),o);return-1===n?null:t[n]}for(var r=0;r<t.length;++r)if(t[r].num()===e)return t[r];return null},residuesInRnumRange:function(e,t){var n,r,s=[],l=this.residues();if(this._rnumsOrdered===!0){var u=i.indexFirstLargerEqualThan(l,a(e),o);if(-1===u)return s;var c=i.indexLastSmallerEqualThan(l,a(t),o);if(-1===c)return s;for(n=u;c>=n;++n)s.push(this._residues[n])}else for(n=0,r=l.length;n!==r;++n){var h=l[n];h.num()>=e&&h.num()<=t&&s.push(h)}return s},prop:function(e){return this[e]()}},i.derive(l,s,{name:function(){return this._name},full:function(){return this},addResidue:function(e,t,n){n=n||"\x00";var i=new p(this,e,t,n);return this._rnumsOrdered=h(this._residues,this._rnumsOrdered,i),this._residues.push(i),i},assignSS:function(e,t,n){for(var i=r(e[0],e[1]),o=r(t[0],t[1]),a=1;a<this._residues.length-1;++a){var s=this._residues[a],l=r(s.num(),s.insCode());i>=l||l>=o||s.setSS(n)}},eachBackboneTrace:function(e){this._cacheBackboneTraces();for(var t=0;t<this._cachedTraces.length;++t)e(this._cachedTraces[t])},_cacheBackboneTraces:function(){if(!(this._cachedTraces.length>0)){for(var e=new n.BackboneTrace,t=null,i=0;i<this._residues.length;i+=1){var r=this._residues[i],o=r.isAminoacid(),a=r.isNucleotide();if(t===!0&&!o||t===!1&&!a||null===t&&!a&&!o)c(this._cachedTraces,e),t=null,e=new n.BackboneTrace;else if(0!==e.length()){var s=this._residues[i-1];u(t,s,r)&&(c(this._cachedTraces,e),e=new n.BackboneTrace),e.push(r)}else e.push(r),t=r.isAminoacid()}c(this._cachedTraces,e)}},backboneTraces:function(){var e=[];return this.eachBackboneTrace(function(t){e.push(t)}),e}}),i.derive(d,s,{addResidue:function(e,t){var n=new _(this,e.full());if(this._rnumsOrdered=h(this._residues,this._rnumsOrdered,e),this._residues.push(n),this._residueMap[e.full().index()]=n,t)for(var i=e.atoms(),r=0;r<i.length;++r)n.addAtom(i[r].full(),!1);return n},addAtom:function(e){var t=this._residueMap[e.residue().full().index()];return void 0===t&&(t=this.addResidue(e.residue())),t.addAtom(e,!0)},removeAtom:function(e,t){var n=this._residueMap[e.residue().full().index()];if(void 0===n)return!1;var i=n.removeAtom(e);return i&&0===n.atoms().length&&t&&(delete this._residueMap[e.residue().full().index()],this._residues=this._residues.filter(function(e){return e!==n})),i},containsResidue:function(e){var t=this._residueMap[e.full().index()];return void 0===t?!1:t.full()===e.full()},eachBackboneTrace:function(e){for(var t=this._chain.backboneTraces(),n=0;n<t.length;++n)for(var i=t[n].subsets(this._residues),r=0;r<i.length;++r)e(i[r])},backboneTraces:function(){var e=[];return this.eachBackboneTrace(function(t){e.push(t)}),e},full:function(){return this._chain},name:function(){return this._chain.name()},structure:function(){return this._molView}}),{Chain:l,ChainView:d}}(L,R),P=function(){var t=e.vec3,n=function(e,n){var i={atom_one:e,atom_two:n};return{atom_one:function(){return i.atom_one},atom_two:function(){return i.atom_two},mid_point:function(e){return e||(e=t.create()),t.add(e,i.atom_one.pos(),i.atom_two.pos()),t.scale(e,e,.5),e}}};return{Bond:n}}(),D=function(){function e(e,t){for(var n=0;n<t.length;++n)if(!t[n](e))return!1;return!0}function t(e){var t=[];return void 0!==e.aname&&t.push(function(t){return t.name()===e.aname}),void 0!==e.hetatm&&t.push(function(t){return t.isHetatm()===e.hetatm}),void 0!==e.anames&&t.push(function(t){for(var n=t.name(),i=0;i<e.anames.length;++i)if(n===e.anames[i])return!0;return!1}),t}function n(e){var t=[];if(void 0!==e.rname&&t.push(function(t){return t.name()===e.rname}),void 0!==e.rnames&&t.push(function(t){for(var n=t.name(),i=0;i<e.rnames.length;++i)if(n===e.rnames[i])return!0;return!1}),void 0!==e.rnums){for(var n={},i=0;i<e.rnums.length;++i)n[e.rnums[i]]=!0;t.push(function(e){var t=e.num();return n[t]===!0})}return void 0!==e.rnum&&t.push(function(t){return t.num()===e.rnum}),t}function i(e){var t=[];return void 0!==e.cname&&(e.chain=e.cname),void 0!==e.cnames&&(e.chains=e.cnames),void 0!==e.chain&&t.push(function(t){return t.name()===e.chain}),void 0!==e.chains&&t.push(function(t){for(var n=t.name(),i=0;i<e.chains.length;++i)if(n===e.chains[i])return!0;return!1}),t}function r(e,t){var n=e.residues();t.rnumRange&&(n=e.residuesInRnumRange(t.rnumRange[0],t.rnumRange[1]));var i,r,o=[];if(void 0!==t.rindexRange){for(i=t.rindexRange[0],r=Math.min(n.length-1,t.rindexRange[1]);r>=i;++i)o.push(n[i]);return o}if(t.rindices&&void 0!==t.rindices.length){for(o=[],i=0;i<t.rindices.length;++i)o.push(n[t.rindices[i]]);return o}return n}function o(o,a,s){var l=n(s),u=t(s),c=i(s);s.rindex&&(s.rindices=[s.rindex]);for(var h=0;h<o._chains.length;++h){var d=o._chains[h];if(e(d,c))for(var f=r(d,s),p=null,_=0;_<f.length;++_)if(e(f[_],l)){p||(p=a.addChain(d,!1));for(var g=null,m=f[_].atoms(),v=0;v<m.length;++v)e(m[v],u)&&(g||(g=p.addResidue(f[_],!1)),g.addAtom(m[v]))}}return a}return{dict:o}}(),I=W=function(t,n,r){function o(e){var t=g[e.toUpperCase()];return void 0!==t?t:1.5}function a(e,t,n){var i=t.atom("C"),r=n.atom("N");if(i&&r){var o=d.sqrDist(i.pos(),r.pos());1.6*1.6>o&&e.connect(r,i)}}function s(e,t,n){var i=t.atom("O3'"),r=n.atom("P");if(i&&r){var o=d.sqrDist(i.pos(),r.pos());1.7*1.7>o&&e.connect(i,r)}}function l(){}function u(){l.call(this),this._chains=[],this._assemblies=[],this._nextAtomIndex=0}function c(e){l.call(this),this._mol=e,this._chains=[]}var d=e.vec3,f=t.Chain,p=t.ChainView,_=n.Bond,g={H:.31,HE:.28,LI:1.28,BE:.96,B:.84,C:.76,N:.71,O:.66,F:.57,NE:.58,NA:1.66,MG:1.41,AL:1.21,SI:1.11,P:1.07,S:1.05,CL:1.02,AR:1.06,K:2.03,CA:1.76,SC:1.7,TI:1.6,V:1.53,CR:1.39,MN:1.39,FE:1.32,CO:1.26,NI:1.24,CU:1.32,ZN:1.22,GA:1.22,GE:1.2,AS:1.19,SE:1.2,BR:1.2,KR:1.16,RB:2.2,SR:1.95,Y:1.9,ZR:1.75,NB:1.64,MO:1.54,TC:1.47,RU:1.46,RH:1.42,PD:1.39,AG:1.45,CD:1.44,IN:1.42,SN:1.39,SB:1.39,TE:1.38,I:1.39,XE:1.4,CS:2.44,BA:2.15,LA:2.07,CE:2.04,PR:2.03,ND:2.01,PM:1.99,SM:1.98,EU:1.98,GD:1.96,TB:1.94,DY:1.92,HO:1.92,ER:1.89,TM:1.9,YB:1.87,LU:1.87,HF:1.75,TA:1.7,W:1.62,RE:1.51,OS:1.44,IR:1.41,PT:1.36,AU:1.36,HG:1.32,TL:1.45,PB:1.46,BI:1.48,PO:1.4,AT:1.5,RN:1.5,FR:2.6,RA:2.21,AC:2.15,TH:2.06,PA:2,U:1.96,NP:1.9,PU:1.87,AM:1.8,CM:1.69};return l.prototype={eachResidue:function(e){for(var t=0;t<this._chains.length;t+=1)if(this._chains[t].eachResidue(e)===!1)return!1},eachAtom:function(e,t){t|=0;for(var n=0;n<this._chains.length;n+=1)if(t=this._chains[n].eachAtom(e,t),t===!1)return!1},residueCount:function(){for(var e=this.chains(),t=0,n=0;n<e.length;++n)t+=e[n].residues().length;return t},eachChain:function(e){for(var t=this.chains(),n=0;n<t.length;++n)if(e(t[n])===!1)return},atomCount:function(){for(var e=this.chains(),t=0,n=0;n<e.length;++n)t+=e[n].atomCount();return t},atoms:function(){var e=[];return this.eachAtom(function(t){e.push(t)}),e},atom:function(e){var t=e.split("."),n=this.chain(t[0]);if(null===n)return null;var i=n.residueByRnum(parseInt(t[1],10));return null===i?null:i.atom(t[2])},center:function(){var e=d.create(),t=0;return this.eachAtom(function(n){d.add(e,e,n.pos()),t+=1}),t&&d.scale(e,e,1/t),e},boundingSphere:function(){var e=this.center(),t=0;return this.eachAtom(function(n){t=Math.max(t,d.sqrDist(e,n.pos()))}),new h.Sphere(e,Math.sqrt(t))},backboneTraces:function(){for(var e=this.chains(),t=[],n=0;n<e.length;++n)Array.prototype.push.apply(t,e[n].backboneTraces());return t},select:function(e){return"protein"===e?this.residueSelect(function(e){return e.isAminoacid()}):"water"===e?this.residueSelect(function(e){return e.isWater()}):"ligand"===e?this.residueSelect(function(e){return!e.isAminoacid()&&!e.isWater()}):r.dict(this,new c(this),e||{})},residueSelect:function(e){console.time("Mol.residueSelect");for(var t=new c(this.full()),n=0;n<this._chains.length;++n)for(var i=this._chains[n],r=null,o=i.residues(),a=0;a<o.length;++a)e(o[a])&&(r||(r=t.addChain(i,!1)),r.addResidue(o[a],!0));return console.timeEnd("Mol.residueSelect"),t},atomSelect:function(e){console.time("Mol.atomSelect");for(var t=new c(this.full()),n=0;n<this._chains.length;++n)for(var i=this._chains[n],r=null,o=i.residues(),a=0;a<o.length;++a)for(var s=null,l=o[a],u=l.atoms(),h=0;h<u.length;++h)e(u[h])&&(r||(r=t.addChain(i,!1)),s||(s=r.addResidue(l,!1)),s.addAtom(u[h]));return console.timeEnd("Mol.atomSelect"),t},assembly:function(e){for(var t=this.assemblies(),n=0;n<t.length;++n)if(t[n].name()===e)return t[n];return null},chainsByName:function(e){for(var t={},n=this.chains(),i=0;i<n.length;++i)t[n[i].name()]=n[i];for(var r=[],o=0;o<e.length;++o){var a=t[e[o]];void 0!==a&&r.push(a)}return r},selectWithin:function(){var e=d.create();return function(t,n){console.time("Mol.selectWithin"),n=n||{};var i=n.radius||4,r=i*i,o=!!n.matchResidues,a=[];t.eachAtom(function(e){a.push(e)});for(var s=new c(this.full()),l=null,u=null,h=this.chains(),f=!1,p=0;p<h.length;++p){var _=h[p].residues();u=null;for(var g=0;g<_.length;++g){l=null,f=!1;for(var m=_[g].atoms(),v=0;v<m.length&&!f;++v)for(var y=0;y<a.length;++y)if(d.sub(e,m[v].pos(),a[y].pos()),!(d.sqrLen(e)>r)){if(u||(u=s.addChain(h[p].full(),!1)),l||(l=u.addResidue(_[g].full(),o)),o){f=!0;break}l.addAtom(m[v].full());break}}}return console.timeEnd("Mol.selectWithin"),s}}(),createEmptyView:function(){return new c(this.full())}},i.derive(u,l,{addAssembly:function(e){this._assemblies.push(e)},setAssemblies:function(e){this._assemblies=e},assemblies:function(){return this._assemblies},chains:function(){return this._chains},full:function(){return this},containsResidue:function(e){return e.full().structure()===this},chainByName:function(e){for(var t=0;t<this._chains.length;++t)if(this._chains[t].name()===e)return this._chains[t];return null},chain:function(e){return this.chainByName(e)},nextAtomIndex:function(){var e=this._nextAtomIndex;return this._nextAtomIndex+=1,e},addChain:function(e){var t=new f(this,e);return this._chains.push(t),t},connect:function(e,t){var n=new _(e,t);return e.addBond(n),t.addBond(n),n},deriveConnectivity:function(){console.time("Mol.deriveConnectivity");var e=this,t=null;this.eachResidue(function(n){for(var i,r=n.atoms(),l=r.length,u=0;l>u;u+=1)for(var c=r[u],h=c.pos(),f=o(c.element()),p=0;u>p;p+=1){var _=r[p],g=o(_.element());i=d.sqrDist(h,_.pos());var m=f+g-.3,v=f+g+.3;v*v>i&&i>m*m&&e.connect(c,_)}n._deduceType(),null!==t&&(n.isAminoacid()&&t.isAminoacid()&&a(e,t,n),n.isNucleotide()&&t.isNucleotide()&&s(e,t,n)),t=n}),console.timeEnd("Mol.deriveConnectivity")}}),i.derive(c,l,{full:function(){return this._mol},assemblies:function(){return this._mol.assemblies()},addChain:function(e,t){var n=new p(this,e.full());if(this._chains.push(n),t)for(var i=e.residues(),r=0;r<i.length;++r)n.addResidue(i[r],!0);return n},addAtom:function(e){var t=this.chain(e.residue().chain().name());return null===t&&(t=this.addChain(e.residue().chain())),t.addAtom(e)},removeAtom:function(e,t){if(null===e)return!1;var n=this.chain(e.residue().chain().name());if(null===n)return!1;var i=n.removeAtom(e,t);return i&&0===n.residues().length&&(this._chains=this._chains.filter(function(e){return e!==n})),i},containsResidue:function(e){if(!e)return!1;var t=this.chain(e.chain().name());return t?t.containsResidue(e):!1},addResidues:function(e,t){var n=this,i={};return e.forEach(function(e){var r=e.chain().name();"undefined"==typeof i[r]&&(i[r]=n.addChain(e.chain(),!1)),i[r].addResidue(e,t)}),i},chains:function(){return this._chains},chain:function(e){for(var t=0;t<this._chains.length;++t)if(this._chains[t].name()===e)return this._chains[t];return null}}),{MolView:c,Mol:u}}(O,P,D),N=function(){function e(e){function t(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var n,i=Math.pow(2,-52),r=1e-64/i,o=50,a=0,s=0,l=0,u=0,c=0,h=e,d=h.length,f=h[0].length;if(f>d)throw"Need more rows than columns";var p=new Array(f),_=new Array(f);for(s=0;f>s;s++)p[s]=_[s]=0;for(var g=[],s=0;f>s;++s){var m=[];g.push([]);for(var l=0;f>l;++l)m.push(0);g.push(m)}var v=0,y=0,b=0,x=0,w=0,S=0,A=0;for(s=0;f>s;s++){for(p[s]=y,A=0,c=s+1,l=s;d>l;l++)A+=h[l][s]*h[l][s];if(r>=A)y=0;else for(v=h[s][s],y=Math.sqrt(A),v>=0&&(y=-y),b=v*y-A,h[s][s]=v-y,l=c;f>l;l++){for(A=0,u=s;d>u;u++)A+=h[u][s]*h[u][l];for(v=A/b,u=s;d>u;u++)h[u][l]+=v*h[u][s]}for(_[s]=y,A=0,l=c;f>l;l++)A+=h[s][l]*h[s][l];if(r>=A)y=0;else{for(v=h[s][s+1],y=Math.sqrt(A),v>=0&&(y=-y),b=v*y-A,h[s][s+1]=v-y,l=c;f>l;l++)p[l]=h[s][l]/b;for(l=c;d>l;l++){for(A=0,u=c;f>u;u++)A+=h[l][u]*h[s][u];for(u=c;f>u;u++)h[l][u]+=A*p[u]}}w=Math.abs(_[s])+Math.abs(p[s]),w>x&&(x=w)}for(s=f-1;-1!=s;s+=-1){if(0!=y){for(b=y*h[s][s+1],l=c;f>l;l++)g[l][s]=h[s][l]/b;for(l=c;f>l;l++){for(A=0,u=c;f>u;u++)A+=h[s][u]*g[u][l];for(u=c;f>u;u++)g[u][l]+=A*g[u][s]}}for(l=c;f>l;l++)g[s][l]=0,g[l][s]=0;g[s][s]=1,y=p[s],c=s}for(s=f-1;-1!=s;s+=-1){for(c=s+1,y=_[s],l=c;f>l;l++)h[s][l]=0;if(0!=y){for(b=h[s][s]*y,l=c;f>l;l++){for(A=0,u=c;d>u;u++)A+=h[u][s]*h[u][l];for(v=A/b,u=s;d>u;u++)h[u][l]+=v*h[u][s]}for(l=s;d>l;l++)h[l][s]=h[l][s]/y}else for(l=s;d>l;l++)h[l][s]=0;h[s][s]+=1}for(i*=x,u=f-1;-1!=u;u+=-1)for(var k=0;o>k;k++){var C=!1;for(c=u;-1!=c;c+=-1){if(Math.abs(p[c])<=i){C=!0;break}if(Math.abs(_[c-1])<=i)break}if(!C){a=0,A=1;var T=c-1;for(s=c;u+1>s&&(v=A*p[s],p[s]=a*p[s],!(Math.abs(v)<=i));s++)for(y=_[s],b=t(v,y),_[s]=b,a=y/b,A=-v/b,l=0;d>l;l++)w=h[l][T],S=h[l][s],h[l][T]=w*a+S*A,h[l][s]=-w*A+S*a}if(S=_[u],c==u){if(0>S)for(_[u]=-S,l=0;f>l;l++)g[l][u]=-g[l][u];break}if(k>=o-1)throw"Error: no convergence.";for(x=_[c],w=_[u-1],y=p[u-1],b=p[u],v=((w-S)*(w+S)+(y-b)*(y+b))/(2*b*w),y=t(v,1),v=0>v?((x-S)*(x+S)+b*(w/(v-y)-b))/x:((x-S)*(x+S)+b*(w/(v+y)-b))/x,a=1,A=1,s=c+1;u+1>s;s++){for(y=p[s],w=_[s],b=A*y,y=a*y,S=t(v,b),p[s-1]=S,a=v/S,A=b/S,v=x*a+y*A,y=-x*A+y*a,b=w*A,w*=a,l=0;f>l;l++)x=g[l][s-1],S=g[l][s],g[l][s-1]=x*a+S*A,g[l][s]=-x*A+S*a;for(S=t(v,b),_[s-1]=S,a=v/S,A=b/S,v=a*y+A*w,x=-A*y+a*w,l=0;d>l;l++)w=h[l][s-1],S=h[l][s],h[l][s-1]=w*a+S*A,h[l][s]=-w*A+S*a}p[c]=0,p[u]=v,_[u]=x}for(s=0;s<_.length;s++)_[s]<i&&(_[s]=0);for(s=0;f>s;s++)for(l=s-1;l>=0;l--)if(_[l]<_[s]){for(a=_[l],_[l]=_[s],_[s]=a,u=0;u<h.length;u++)n=h[u][s],h[u][s]=h[u][l],h[u][l]=n;for(u=0;u<g.length;u++)n=g[u][s],g[u][s]=g[u][l],g[u][l]=n;s=l}return{U:h,S:_,V:g}}return e}(),F=function(){function t(e){if(void 0===e||null===e||"all"===e)return null;if("backbone"===e)return{CA:!0,C:!0,O:!0,N:!0};if(void 0!==e.substr){for(var t={},n=e.split(","),i=0;i<n.length;++i)t[n[i].trim()]=!0;return t}for(var t={},i=0;i<e.length;++i)t[e[i]]=!0;return t}function n(e,t,n,i,r){for(var o=e.atoms(),a=t.atoms(),s=0;s<o.length;++s){var l=o[s];if(null===r||r[l.name()]===!0)for(var u=0;u<a.length;++u){var c=a[u];if(c.name()===l.name()){n.push(l),i.push(c);break}}}}function i(e,i,r,o){for(var a=e.full().createEmptyView(),s=i.full().createEmptyView(),l=Math.min(e.chains().length,i.chains().length),u=t(r),c=0;l>c;++c){var h=e.chains()[c],d=i.chains()[c],f=o(h,d),p=f[0],_=f[1];if(p.length!==_.length)return console.error("chains",h.name()," and",d.name()," do not contain the same number of residues."),null;for(var g=a.addChain(h),m=s.addChain(d),v=0;v<p.length;++v){var y=p[v],b=_[v],x=[],w=[];if(n(y,b,x,w,u),0!==x.length)for(var S=g.addResidue(y),A=m.addResidue(b),k=0;k<x.length;++k)S.addAtom(x[k]),A.addAtom(w[k])}}return[a,s]}function r(e,t,n){return i(e,t,n,function(e,t){return[e.residues(),t.residues()]})}function o(e,t,n){return i(e,t,n,function(e,t){for(var n=[],i=[],r=e.residues(),o=0;o<r.length;++o){var a=t.residueByRnum(r[o].num());null!==a&&(n.push(r[o]),i.push(a))}return[n,i]})}var a=e.vec3,s=e.mat3,l=(e.quat,function(e,t){if(a.set(t,0,0,0),0!==e.length){for(var n=0;n<e.length;++n){var i=e[n];a.add(t,t,i.pos())}a.scale(t,t,1/e.length)}}),u=function(){var e=a.create(),t=a.create();return function(n,i,r,o,s){s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=0,s[6]=0,s[7]=0,s[8]=0;for(var l=0;l<i.length;++l){a.sub(e,n[l].pos(),r),a.sub(t,i[l].pos(),o);var u=e,c=t;s[0]+=u[0]*c[0],s[1]+=u[0]*c[1],s[2]+=u[0]*c[2],s[3]+=u[1]*c[0],s[4]+=u[1]*c[1],s[5]+=u[1]*c[2],s[6]+=u[2]*c[0],s[7]+=u[2]*c[1],s[8]+=u[2]*c[2]}}}(),c=function(){var e=a.create(),t=a.create(),n=a.create(),i=s.create(),r=s.create(),o=s.create(),c=s.create(),h=s.create();return function(d,f){var p=d.atoms(),_=f.atoms();if(l(_,e),l(p,t),p.length!==_.length)return console.error("atom counts do not match ("+p.length+"in structure vs "+_.length+" in reference)"),!1;if(p.length<3)return console.error("at least 3 atoms are required for superposition"),!1;u(p,_,t,e,r);var g=[[r[0],r[1],r[2]],[r[3],r[4],r[5]],[r[6],r[7],r[8]]],m=N(g);c[0]=m.U[0][0],c[1]=m.U[0][1],c[2]=m.U[0][2],c[3]=m.U[1][0],c[4]=m.U[1][1],c[5]=m.U[1][2],c[6]=m.U[2][0],c[7]=m.U[2][1],c[8]=m.U[2][2];var v=s.determinant(c);h[0]=m.V[0][0],h[1]=m.V[0][1],h[2]=m.V[0][2],h[3]=m.V[1][0],h[4]=m.V[1][1],h[5]=m.V[1][2],h[6]=m.V[2][0],h[7]=m.V[2][1],h[8]=m.V[2][2];var y=s.determinant(h);s.identity(o),0>v*y&&(console.log("determinants smaller than zero!"),o[8]=-1,s.mul(c,c,o)),console.log(s.str(c)),s.mul(i,s.transpose(h,h),c);for(var b=d.full().atoms(),x=0;x<b.length;++x){var w=b[x];a.sub(n,w.pos(),t),a.transformMat3(n,n,i),a.add(n,e,n),w.setPos(n)}return!0}}();return{superpose:c,matchResiduesByNum:o,matchResiduesByIndex:r,parseAtomNames:t,addAtomsPresentInBoth:n}}(),B=W=function(t){function n(e){for(var t=0;t<e.length();++t)a(e,t)?e.residueAt(t).setSS("H"):s(e,t)?e.residueAt(t).setSS("E"):e.residueAt(t).setSS("C")}function i(e){console.time("mol.assignHelixSheet");for(var t=e.chains(),i=0;i<t.length;++i){var r=t[i];r.eachBackboneTrace(n)}console.timeEnd("mol.assignHelixSheet")}var r=e.vec3,o=function(){var e=r.create(),t=r.create();return function(n,i,o,a){for(var s=Math.max(0,i-2);i>=s;++s)for(var l=2;5>l;++l)if(!(s+l>=n.length())){var u=r.dist(n.posAt(e,s),n.posAt(t,s+l));if(Math.abs(u-o[l-2])>a)return!1}return!0}}(),a=function(e,t){var n=[5.45,5.18,6.37],i=2.1;return o(e,t,n,i)},s=function(e,t){var n=[6.1,10.4,13],i=1.42;return o(e,t,n,i)};return{Mol:W.Mol,MolView:W.MolView,assignHelixSheet:i,superpose:t.superpose,matchResiduesByIndex:t.matchResiduesByIndex,matchResiduesByNum:t.matchResiduesByNum}}(F),z=function(t){function n(){this._assemblies={},this._current=null}function i(e){if(" "!==e[0]){var t=e.trim();if(4===t.length){for(var n=0,i=t.charCodeAt(n);4>n&&(65>i||i>122||i>90&&97>i);)++n,i=t.charCodeAt(n);return t[n]}var r=t.charCodeAt(0);return r>=48&&57>=r?t[1]:t.substr(0,2)}return e[1]}function r(e){this._helices=[],this._sheets=[],this._conect=[],this._serialToAtomMap={},this._structure=new W.Mol,this._remark350Reader=new n,this._currChain=null,this._currRes=null,this._currAtom=null,this._options={},this._options.conectRecords=!!e.conectRecords}function o(e){return e.split(/\r\n|\r|\n/g)}function a(e,t){console.time("pdb");for(var n=t||{},i=o(e),a=new r(n),s=[],l=0;l<i.length;l++){var u=a.processLine(i[l]);if(u===a.ERROR)return console.timeEnd("pdb"),null;if(u!==a.CONTINUE){var c=a.finish();if(null!==c&&s.push(c),u!==a.MODEL_COMPLETE||!n.loadAllModels)break}}var h=a.finish();return null!==h&&s.push(h),console.timeEnd("pdb"),n.loadAllModels?s:s[0]}function s(){this._structure=new W.Mol,this._reset(),this._sawEnd=!1}function l(e){console.time("sdf");for(var t=new s,n=o(e),i=0;i<n.length&&t.processLine(n[i]);i++);var r=t.finish();return console.timeEnd("sdf"),r}function u(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){n.response&&t(n.response)},n.send(null)}function c(e,t,n){u(e,function(e){var i=a(e,n);t(i)})}function h(e,t){u(e,function(e){var n=l(e);t(n)})}var d=e.vec3,f=e.mat4;return n.prototype={assemblies:function(){var e=[];for(var t in this._assemblies)this._assemblies.hasOwnProperty(t)&&e.push(this._assemblies[t]);return e},assembly:function(e){return this._assemblies[e]},nextLine:function(e){if(e=e.substr(11),"B"===e[0]&&"BIOMOLECULE:"===e.substr(0,12)){var n=e.substr(13).trim();return this._currentAssembly=new t.Assembly(n),void(this._assemblies[n]=this._currentAssembly)}if("APPLY THE FOLLOWING TO CHAINS:"!==e.substr(0,30)&&"                   AND CHAINS:"!==e.substr(0,30)){if("  BIOMT"===e.substr(0,7)){for(var i=parseInt(e[7],10)-1,r=0;" "!==e[12+r];)r+=1;var o=parseFloat(e.substr(13+r,9)),a=parseFloat(e.substr(23+r,9)),s=parseFloat(e.substr(33+r,9)),l=parseFloat(e.substr(43+r,14));return this._currentMatrix[0+i]=o,this._currentMatrix[4+i]=a,this._currentMatrix[8+i]=s,this._currentMatrix[12+i]=l,void(2===i&&(this._currentSymGen.addMatrix(this._currentMatrix),this._currentMatrix=f.create()))}}else{var u=e.substr(30).split(",");"A"===e[0]&&(this._currentSymGen=new t.SymGenerator,this._currentAssembly.addGenerator(this._currentSymGen)),this._currentMatrix=f.create();for(var c=0;c<u.length;++c){var h=u[c].trim();h.length&&this._currentSymGen.addChain(h)}}}},r.prototype={CONTINUE:1,MODEL_COMPLETE:2,FILE_END:3,ERROR:4,parseHelixRecord:function(e){var t=parseInt(e.substr(21,4),10),n=" "===e[25]?"\x00":e[25],i=parseInt(e.substr(33,4),10),r=" "===e[37]?"\x00":e[37],o=e[19];return this._helices.push({first:[t,n],last:[i,r],chainName:o}),!0},parseSheetRecord:function(e){var t=parseInt(e.substr(22,4),10),n=" "===e[26]?"\x00":e[26],i=parseInt(e.substr(33,4),10),r=" "===e[37]?"\x00":e[37],o=e[21];return this._sheets.push({first:[t,n],last:[i,r],chainName:o}),!0},parseAndAddAtom:function(e){var t=e[16];if(" "!==t&&"A"!==t)return!0;var n="H"===e[0],r=e[21],o=e.substr(17,3).trim(),a=e.substr(12,4),s=a.trim(),l=parseInt(e.substr(22,4),10);l!==l&&(l=1);var u=" "===e[26]?"\x00":e[26],c=!1,h=!1;this._currChain&&this._currChain.name()===r||(h=!0,c=!0),this._currRes&&this._currRes.num()===l&&this._currRes.insCode()===u||(c=!0),h&&(this._currChain=this._structure.chain(r)||this._structure.addChain(r)),c&&(this._currRes=this._currChain.addResidue(o,l,u));for(var f=d.create(),p=0;3>p;++p)f[p]=parseFloat(e.substr(30+8*p,8));var _=e.substr(76,2).trim();""===_&&(_=i(a));var g=parseFloat(e.substr(54,6).trim()),m=parseFloat(e.substr(60,6).trim()),v=this._currRes.addAtom(s,f,_,n,isNaN(g)?null:g,isNaN(m)?null:m);if(this._options.conectRecords){var y=parseInt(e.substr(6,5).trim(),10);this._serialToAtomMap[y]=v}return!0},parseConectRecord:function(e){for(var t=parseInt(e.substr(6,5).trim(),10),n=[],i=0;4>i;++i){var r=parseInt(e.substr(11+5*i,6).trim(),10);isNaN(r)||r>t||n.push(r)}return this._conect.push({from:t,to:n}),!0},processLine:function(e){var t=e.substr(0,6);if("ATOM  "===t||"HETATM"===t)return this.parseAndAddAtom(e)?this.CONTINUE:this.ERROR;if("REMARK"===t){var n=e.substr(7,3);return"350"===n&&this._remark350Reader.nextLine(e),this.CONTINUE}return"HELIX "===t?this.parseHelixRecord(e)?this.CONTINUE:this.ERROR:"SHEET "===t?this.parseSheetRecord(e)?this.CONTINUE:this.ERROR:this._options.conectRecords&&"CONECT"===t?this.parseConectRecord(e)?this.CONTINUE:this.ERROR:"END   "===t?this.FILE_END:"ENDMDL"===t?this.MODEL_COMPLETE:this.CONTINUE},finish:function(){if(null===this._currChain)return null;var e,t=null;for(e=0;e<this._sheets.length;++e){var n=this._sheets[e];t=this._structure.chain(n.chainName),t&&t.assignSS(n.first,n.last,"E")}for(e=0;e<this._helices.length;++e){var i=this._helices[e];t=this._structure.chain(i.chainName),t&&t.assignSS(i.first,i.last,"H")}this._structure.setAssemblies(this._remark350Reader.assemblies()),this._options.conectRecords&&this._assignBondsFromConectRecords(this._structure),this._structure.deriveConnectivity(),console.log("imported",this._structure.chains().length,"chain(s),",this._structure.residueCount(),"residue(s)");var r=this._structure;return this._structure=new W.Mol,this._currChain=null,this._currRes=null,this._currAtom=null,r},_assignBondsFromConectRecords:function(e){for(var t=0;t<this._conect.length;++t)for(var n=this._conect[t],i=this._serialToAtomMap[n.from],r=0;r<n.to.length;++r){var o=this._serialToAtomMap[n.to[r]];e.connect(i,o)}}},s.prototype={processLine:function(e){var t=this._state;if(3>t){if(0===t){var n=e.trim();if(0===n.length)return!1;this._title=n}return this._sawEnd=!1,this._state++,!0}if(3===t){if(this._expectedAtomCount=parseInt(e.substr(0,3).trim(),10),this._expectedBondCount=parseInt(e.substr(3,3).trim(),10),isNaN(this._expectedAtomCount)||isNaN(this._expectedBondCount))return console.error("invalid bond definition"),!1;this._state++;var i=""+(this._structure.chains().length+1);this._currentChain=this._structure.addChain(i),this._currentResidue=this._currentChain.addResidue(this._title,1)}if(4===t){for(var r=[0,0,0],o=0;3>o;++o)if(r[o]=parseFloat(e.substr(10*o,10).trim()),isNaN(r[o]))return console.error("invalid atom position"),!1;var a=e.substr(31,3).trim();this._currentResidue.addAtom(a,r,a,!1),this._atomCount++,this._atomCount===this._expectedAtomCount&&this._state++}if(5===t){var s=parseInt(e.substr(0,3).trim(),10)-1,l=parseInt(e.substr(3,3).trim(),10)-1;if(isNaN(s)||isNaN(l))return console.error("invalid bond definition"),!1;var u=this._currentResidue.atoms();this._structure.connect(u[s],u[l]),this._bondCount++,this._bondCount===this._expectedBondCount&&this._state++}return"M  END"===e.substr(0,6)&&(this._sawEnd=!0,this._state++),"$$$$"===e.substr(0,4)&&this._reset(),!0},_reset:function(){this._state=0,this._currentResidue=null,this._currentChain=null,this._expectedAtomCount=null,this._expectedBondount=null,this._atomCount=0,this._bondCount=0,this._title=""},finish:function(){return this._sawEnd?this._structure:(console.error("truncated SDF file"),null)}},{pdb:a,sdf:l,Remark350Reader:n,fetchPdb:c,fetchSdf:h,guessAtomElementFromName:i}}(E),H=function(){var t=e.vec3,n=e.mat3,i=function(){var e=t.create(),n=t.create();return function(i,r){t.set(e,0,0,0);var o=0;i.eachCentralAtom(function(n,i){t.add(e,e,i),o+=1}),0!==o&&(t.scale(e,e,1/o),r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r[8]=0,i.eachCentralAtom(function(i,o){t.sub(n,o,e);var a=n[0],s=n[1],l=n[2];r[0]+=s*s+l*l,r[1]-=a*s,r[2]-=a*l,r[5]-=s*l,r[4]+=a*a+l*l,r[8]+=a*a+s*s}),r[3]=r[1],r[6]=r[2],r[7]=r[5])}}(),r=function(){var e=n.create(),r=n.create(),o=t.create(),a=t.create(),s=t.create(),l=t.create(),u=t.create(),c=t.create(),d=t.create();
return function(f){i(f,e);var p=h.diagonalizer(e);n.fromQuat(r,p);var _=!0;f.eachCentralAtom(function(e,n){t.transformMat3(s,n,r),_?(t.copy(o,s),t.copy(a,s),_=!1):(t.min(o,o,s),t.max(a,a,s))}),t.sub(l,a,o);var g=[[l[0],0],[l[1],1],[l[2],2]];g.sort(function(e,t){return t[0]-e[0]});var m=g[0][1],v=g[1][1];t.set(u,r[m+0],r[m+3],r[m+6]),t.set(c,r[v+0],r[v+3],r[v+6]),t.cross(d,u,c);var y=n.create();return y[0]=u[0],y[1]=c[0],y[2]=d[0],y[3]=u[1],y[4]=c[1],y[5]=d[1],y[6]=u[2],y[7]=c[2],y[8]=d[2],y}}();return{principalAxes:r}}(),q=function(){return{Viewer:T.Viewer,isWebGLSupported:T.isWebGLSupported,io:z,color:t,mol:W,rgb:{setColorPalette:t.setColorPalette,hex2rgb:t.hex2rgb},vec3:e.vec3,vec4:e.vec4,mat3:e.mat3,mat4:e.mat4,quat:e.quat,viewpoint:H}}()})},function(e,t,n){"use strict";function i(e,t,n){this.min=t,this.max=n,this.chr=e}function r(e){if(e||(e={}),this.prefix="//www.biodalliance.org/release-0.13/",this.sources=[],this.tiers=[],this.tierGroups={},this.featureListeners=[],this.featureHoverListeners=[],this.viewListeners=[],this.regionSelectListeners=[],this.tierListeners=[],this.tierSelectionListeners=[],this.tierSelectionWrapListeners=[],this.cookieKey="browser",this.chains={},this.pageName="svgHolder",this.maxExtra=2.5,this.minExtra=.5,this.zoomFactor=1,this.maxPixelsPerBase=10,this.origin=0,this.targetQuantRes=1,this.featurePanelWidth=750,this.zoomBase=100,this.zoomExpt=30,this.zoomSliderValue=100,this.entryPoints=null,this.currentSeqMax=-1,this.highlights=[],this.selectedTiers=[1],this.maxViewWidth=5e5,this.defaultSubtierMax=100,this.reverseScrolling=!1,this.rulerLocation="center",this.defaultHighlightFill="red",this.defaultHighlightAlpha=.3,this.exportHighlights=!0,this.exportRuler=!0,this.singleBaseHighlight=!0,this.tierBackgroundColors=["rgb(245,245,245)","white"],this.minTierHeight=20,this.noDefaultLabels=!1,this.availableSources=new h,this.defaultSources=[],this.mappableSources={},this.registry=null,this.noRegistryTabs=!0,this.hubs=[],this.hubObjects=[],this.sourceCache=new u,this.retina=!0,this.useFetchWorkers=!0,this.maxWorkers=2,this.workerPath="$$worker-all.js",this.assemblyNamePrimary=!0,this.assemblyNameUcsc=!0,this.httpCanaryURL="http://www.biodalliance.org/http-canary.txt",this.httpWarningURL="//www.biodalliance.org/https.html",this.initListeners=[],e.baseColors?this.baseColors=e.baseColors:this.baseColors={A:"green",C:"blue",G:"orange",T:"red","-":"hotpink",I:"red"},void 0!==e.viewStart&&"number"!=typeof e.viewStart)throw Error("viewStart must be an integer");if(void 0!==e.viewEnd&&"number"!=typeof e.viewEnd)throw Error("viewEnd must be an integer");if(void 0!==e.offscreenInitWidth&&"number"!=typeof e.offscreenInitWidth)throw Error("offscreenInitWidth must be an integer");for(var t in e)this[t]=e[t];if("string"==typeof e.uiPrefix&&"string"!=typeof e.prefix&&(this.prefix=e.uiPrefix),this.prefix.indexOf("//")<0&&0===this.prefix.indexOf("/")){var n=window.location.hostname;window.location.port&&(n+=":"+window.location.port),this.prefix="//"+n+this.prefix}if(0===this.prefix.indexOf("//")){var i=window.location.protocol;"http:"==i||"https:"==i||(console.log(window.location.protocol),console.log("WARNING: prefix is set to a protocol-relative URL ("+this.prefix+" when loading from a non-HTTP source"),this.prefix="http:"+this.prefix)}if(!this.coordSystem)throw Error("Coordinate system must be configured");if(void 0===this.chr||void 0===this.viewStart||void 0===this.viewEnd)throw Error("Viewed region (chr:start..end) must be defined");var r=this;if("complete"===document.readyState)r.realInit();else{var o=function(e){window.removeEventListener("load",o,!1),r.realInit()};window.addEventListener("load",o,!1)}}function o(e,t,n){if(n)for(var i=0;i<t.length;++i)t[i].mapping=n;e.set(t)}function a(e,t,n,i){i=i||[];for(var r=e.length-1;r>=0;--r){var o=e[r];if(!o.notSelectable&&o.min()<=t&&o.max()>=t){if(o.minY&&(n<o.minY()||n>o.maxY()))continue;return o.feature?i.push(o.feature):o.group&&i.push(o.group),o.glyphs?a(o.glyphs,t,n,i):o.glyph?a([o.glyph],t,n,i):i}}return i}function s(e,t){var n=this;this.tagSeed=0,this.callbacks={},this.browser=e,this.worker=t,this.worker.onmessage=function(e){var t=n.callbacks[e.data.tag];t&&(t(e.data.result,e.data.error),delete n.callbacks[e.data.tag])}}function l(e){var t=e.resolveURL(e.workerPath);if(0==t.indexOf("//")){var n=window.location.protocol;t="https:"==n?"https:"+t:"http:"+t}var i='importScripts("'+t+"?version="+S+'");',r=new Blob([i],{type:"application/javascript"});return new E(function(t,n){var i=new Worker(URL.createObjectURL(r));i.onmessage=function(n){"init"===n.data.tag&&(console.log("Worker initialized"),t(new s(e,i)))},i.onerror=function(e){n(e.message)}})}function u(){this.sourcesByURI={}}var c=n(248),h=c.Observed,d=(c.Awaited,c.makeElement),f=c.removeChildren,p=c.miniJSONify,_=c.shallowCopy,g=c.textXHR,m=n(250),v=m.DasTier,y=n(249),b=y.hex_sha1,x=n(274),w=x.connectTrackHub,S=n(275),A=n(272),k=A.formatQuantLabel,C=A.formatLongInt,T=n(276).Chainset,E=n(255).Promise,M=n(254),L=M.sourcesAreEqual,R=M.sourcesAreEqualModuloStyle,O=M.sourceDataURI;M.sourceStyleURI;r.prototype.resolveURL=function(e){return e.replace("$$",this.prefix)},r.prototype.destroy=function(){window.removeEventListener("resize",this.resizeListener,!1)},r.prototype.realInit=function(){var e=this;if(this.wasInitialized)return void console.log("Attemping to call realInit on an already-initialized Dalliance instance");this.wasInitialized=!0;var t=navigator.userAgent||"dummy";t.indexOf("Trident")>=0&&t.indexOf("rv:11")>=0&&(this.disablePinning=!0),this.defaultChr=this.chr,this.defaultStart=this.viewStart,this.defaultEnd=this.viewEnd,this.defaultSources=[];for(var n=0;n<this.sources.length;++n){var i=this.sources[n];i&&this.defaultSources.push(i)}this.restoreStatus&&(this.statusRestored=this.restoreStatus());var r=this;this.browserHolderHolder=document.getElementById(this.pageName),this.browserHolderHolder.classList.add("dalliance-injection-point"),this.browserHolder=d("div",null,{className:"dalliance dalliance-root",tabIndex:-1}),this.maxHeight?this.browserHolder.style.maxHeight=this.maxHeight+"px":void 0!=this.maxHeight&&(this.browserHolder.style.maxHeight=null),f(this.browserHolderHolder),this.browserHolderHolder.appendChild(this.browserHolder),this.svgHolder=d("div",null,{className:"main-holder"}),this.initUI(this.browserHolder,this.svgHolder),this.pinnedTierHolder=d("div",null,{className:"tier-holder tier-holder-pinned"}),this.tierHolder=d("div",this.makeLoader(24),{className:"tier-holder tier-holder-rest"}),this.locSingleBase=d("span","",{className:"loc-single-base"});var o=d("div",this.locSingleBase,{className:"loc-single-base-holder"});this.addViewListener(function(t,n,i,r,o,a,s){var l=Math.round((s+a)/2);e.locSingleBase.appendChild(document.createTextNode(t+":"+C(l))),e.locSingleBase.removeChild(e.locSingleBase.firstChild)}),this.disablePinning?this.tierHolderHolder=this.tierHolder:(this.tierHolderHolder=d("div",[o,this.pinnedTierHolder,this.tierHolder],{className:"tier-holder-holder"}),this.svgHolder.appendChild(this.tierHolderHolder)),this.svgHolder.appendChild(this.tierHolderHolder),this.bhtmlRoot=d("div"),this.disablePoweredBy||this.bhtmlRoot.appendChild(d("span",["Powered by ",d("a","Biodalliance",{href:"http://www.biodalliance.org/"})," "+S],{className:"powered-by"})),this.browserHolder.appendChild(this.bhtmlRoot),this.resizeListener=function(e){r.resizeViewer()},window.addEventListener("resize",this.resizeListener,!1),this.ruler=d("div",null,{className:"guideline"}),this.ruler2=d("div",null,{className:"single-base-guideline"}),this.tierHolderHolder.appendChild(this.ruler),this.tierHolderHolder.appendChild(this.ruler2),this.chainConfigs=this.chains||{},this.chains={};for(var a in this.chainConfigs){var s=this.chainConfigs[a];s instanceof T&&console.log('WARNING: Should no longer use "new Chainset" in Biodalliance configurations.'),this.chains[a]=new T(s)}var u;if(this.maxWorkers>0){for(var c=[],h=0;h<this.maxWorkers;++h)c.push(l(this));u=E.all(c)}else u=E.resolve([]);this.fetchWorkers=null,this.nextWorker=0,u.then(function(e){console.log("Booted "+e.length+" workers"),r.fetchWorkers=e},function(e){console.log("Failed to boot workers",e)}).then(function(){if(e.offscreenInitWidth||"none"!=window.getComputedStyle(r.browserHolderHolder).display&&r.tierHolder.getBoundingClientRect().width>0)setTimeout(function(){r.realInit2()},1);else var t=setInterval(function(){"none"!=window.getComputedStyle(r.browserHolderHolder).display&&r.tierHolder.getBoundingClientRect().width>0&&(clearInterval(t),r.realInit2())},300)})},r.prototype.realInit2=function(){var e=this;f(this.tierHolder),f(this.pinnedTierHolder),this.featurePanelWidth=this.tierHolder.getBoundingClientRect().width|e.offscreenInitWidth|0,this.scale=this.featurePanelWidth/(this.viewEnd-this.viewStart),this.zoomMax||(this.zoomMax=this.zoomExpt*Math.log(this.maxViewWidth/this.zoomBase),this.zoomMin=this.zoomExpt*Math.log(this.featurePanelWidth/this.maxPixelsPerBase/this.zoomBase)),this.zoomSliderValue=this.zoomExpt*Math.log((this.viewEnd-this.viewStart+1)/this.zoomBase),this.tierHolderHolder.addEventListener("mousewheel",function(t){if(t.stopPropagation(),t.preventDefault(),t.wheelDeltaX){var n=t.wheelDeltaX/5;e.reverseScrolling||(n=-n),e.move(n)}if(t.wheelDeltaY){var n=t.wheelDeltaY;e.reverseScrolling&&(n=-n),e.tierHolder.scrollTop+=n}},!1),this.tierHolderHolder.addEventListener("MozMousePixelScroll",function(t){if(t.stopPropagation(),t.preventDefault(),1==t.axis){if(0!=t.detail){var n=t.detail/4;e.reverseScrolling&&(n=-n),e.move(n)}}else{var n=t.detail;e.reverseScrolling||(n=-n),e.tierHolder.scrollTop+=n}},!1),this.tierHolderHolder.addEventListener("touchstart",function(t){return e.touchStartHandler(t)},!1),this.tierHolderHolder.addEventListener("touchmove",function(t){return e.touchMoveHandler(t)},!1),this.tierHolderHolder.addEventListener("touchend",function(t){return e.touchEndHandler(t)},!1),this.tierHolderHolder.addEventListener("touchcancel",function(t){return e.touchCancelHandler(t)},!1);var t=function(t){if(13==t.keyCode){for(var n=!1,i=0;i<e.tiers.length;++i){var r=e.tiers[i];r.wantedLayoutHeight&&r.wantedLayoutHeight!=r.layoutHeight&&(r.layoutHeight=r.wantedLayoutHeight,r.clipTier(),n=!0)}n&&e.arrangeTiers()}else if(32==t.keyCode||32==t.charCode){if(e.isSnapZooming){e.isSnapZooming=!1;var o=(e.savedZoom||20)+e.zoomMin;e.savedZoom=e.zoomSliderValue-e.zoomMin,e.zoomSliderValue=o,e.zoom(Math.exp(1*o/e.zoomExpt))}else{e.isSnapZooming=!0;var o=(e.savedZoom||0)+e.zoomMin;e.savedZoom=e.zoomSliderValue-e.zoomMin,e.zoomSliderValue=o,e.zoom(Math.exp(1*o/e.zoomExpt))}t.stopPropagation(),t.preventDefault()}else if(85==t.keyCode){if("opts"===e.uiMode){var a=document.getElementById("singleBaseHightlightButton").checked;document.getElementById("singleBaseHightlightButton").checked=!a}e.singleBaseHighlight=!e.singleBaseHighlight,e.positionRuler(),t.stopPropagation(),t.preventDefault()}else if(39==t.keyCode)t.stopPropagation(),t.preventDefault(),e.scrollArrowKey(t,-1);else if(37==t.keyCode)t.stopPropagation(),t.preventDefault(),e.scrollArrowKey(t,1);else if(38==t.keyCode||87==t.keyCode)if(t.stopPropagation(),t.preventDefault(),t.shiftKey){var s=e.getSelectedTier();if(0>s)return;var l=e.tiers[s],u=l.forceHeight||l.subtiers[0].height;u>=40&&l.mergeConfig({height:u-10})}else if(t.ctrlKey||t.metaKey){var s=e.getSelectedTier();if(0>s)return;var l=e.tiers[s];if(l.quantLeapThreshold){var c=l.subtiers[0].height,h=l.subtiers[0].quant;if(!h)return;var d=1*h.min,f=1*h.max,p=(f-d)/c;l.mergeConfig({quantLeapThreshold:d+((0|Math.round((l.quantLeapThreshold-d)/p))+1)*p}),l.notify("Threshold: "+k(l.quantLeapThreshold))}}else if(t.altKey){var _=e.selectedTiers.length;if(0==_)return;for(var s=e.selectedTiers[0],g=!0,m=[],v=0;v<e.selectedTiers.length;++v)m.push(e.tiers[e.selectedTiers[v]]),v>0&&e.selectedTiers[v]-e.selectedTiers[v-1]!=1&&(g=!1);if(g&&0>=s)return;for(var v=e.selectedTiers.length-1;v>=0;--v)e.tiers.splice(e.selectedTiers[v],1);e.selectedTiers.splice(0,_);for(var y=g?s-1:s,v=0;v<m.length;++v)e.tiers.splice(y+v,0,m[v]),e.selectedTiers.push(y+v);e.withPreservedSelection(e._ensureTiersGrouped),e.markSelectedTiers(),e.notifyTierSelection(),e.reorderTiers(),e.notifyTier("selected",s)}else{var s=e.getSelectedTier();if(s>0){e.setSelectedTier(s-1);var b=e.tiers[e.getSelectedTier()],x=b.row.offsetTop,w=x+b.row.offsetHeight;(x<e.tierHolder.scrollTop||w>e.tierHolder.scrollTop+e.tierHolder.offsetHeight)&&(e.tierHolder.scrollTop=x)}else e.notifyTierSelectionWrap(-1)}else if(40==t.keyCode||83==t.keyCode)if(t.stopPropagation(),t.preventDefault(),t.shiftKey){var s=e.getSelectedTier();if(0>s)return;var l=e.tiers[s],u=l.forceHeight||l.subtiers[0].height;l.mergeConfig({height:u+10})}else if(t.ctrlKey||t.metaKey){var s=e.getSelectedTier();if(0>s)return;var l=e.tiers[s];if(l.quantLeapThreshold){var c=l.subtiers[0].height,h=l.subtiers[0].quant;if(!h)return;var d=1*h.min,f=1*h.max,p=(f-d)/c,S=0|Math.round((l.quantLeapThreshold-d)/p);S>1&&(l.mergeConfig({quantLeapThreshold:d+(S-1)*p}),l.notify("Threshold: "+k(l.quantLeapThreshold)))}}else if(t.altKey){var _=e.selectedTiers.length;if(0==_)return;for(var s=e.selectedTiers[0],A=0,m=[],v=0;v<e.selectedTiers.length;++v)m.push(e.tiers[e.selectedTiers[v]]),v>0&&(A+=e.selectedTiers[v]-e.selectedTiers[v-1]-1);var g=0==A;if(g&&s+_>=e.tiers.length)return;for(var v=e.selectedTiers.length-1;v>=0;--v)e.tiers.splice(e.selectedTiers[v],1);e.selectedTiers.splice(0,_);for(var y=g?s+1:s+A,v=0;v<m.length;++v)e.tiers.splice(y+v,0,m[v]),e.selectedTiers.push(y+v);e.withPreservedSelection(function(){e._ensureTiersGrouped(!0)}),e.markSelectedTiers(),e.notifyTierSelection(),e.reorderTiers(),e.notifyTier("selected",s)}else{var s=e.getSelectedTier();if(s<e.tiers.length-1){e.setSelectedTier(s+1);var b=e.tiers[e.getSelectedTier()],x=b.row.offsetTop,w=x+b.row.offsetHeight;(x<e.tierHolder.scrollTop||w>e.tierHolder.scrollTop+e.tierHolder.offsetHeight)&&(e.tierHolder.scrollTop=Math.min(x,w-e.tierHolder.offsetHeight))}}else if(187==t.keyCode||61==t.keyCode)t.stopPropagation(),t.preventDefault(),e.zoomStep(-10);else if(189==t.keyCode||173==t.keyCode)t.stopPropagation(),t.preventDefault(),e.zoomStep(10);else if(73==t.keyCode||105==t.keyCode){t.stopPropagation(),t.preventDefault();var s=e.getSelectedTier();if(0>s)return;var r=e.tiers[s];r.infoVisible?(r.infoElement.style.display="none",r.updateHeight(),r.infoVisible=!1):(r.infoElement.style.display="block",r.updateHeight(),r.infoVisible=!0)}else if(84==t.keyCode||116==t.keyCode){var C;if(t.shiftKey){t.stopPropagation(),t.preventDefault();for(var i=0;i<e.tiers.length;++i){var r=e.tiers[i];r.dasSource.collapseSuperGroups&&(void 0===C&&(C=!r.bumped),r.mergeConfig({bumped:C}))}}else if(!t.ctrlKey&&!t.metaKey){t.stopPropagation(),t.preventDefault();var s=e.getSelectedTier();if(0>s)return;var r=e.tiers[s];r.dasSource.collapseSuperGroups&&(void 0===C&&(C=!r.bumped),r.mergeConfig({bumped:C}))}}else if(77==t.keyCode||109==t.keyCode)t.stopPropagation(),t.preventDefault(),(t.ctrlKey||t.metaKey)&&e.selectedTiers.length>1&&e.mergeSelectedTiers();else if(68==t.keyCode||100==t.keyCode){if(t.stopPropagation(),t.preventDefault(),t.ctrlKey||t.metaKey){var s=e.getSelectedTier();if(0>s)return;e.addTier(e.tiers[s].dasSource)}}else if((80==t.keyCode||112==t.keyCode)&&(t.ctrlKey||t.metaKey)){for(var l=[],s=0;s<e.selectedTiers.length;++s)l.push(e.tiers[e.selectedTiers[s]]);for(var i=0;i<l.length;++i)l[i].mergeConfig({pinned:!l[i].pinned})}};this.browserHolder.addEventListener("focus",function(n){e.browserHolder.addEventListener("keydown",t,!1)},!1),this.browserHolder.addEventListener("blur",function(n){e.browserHolder.removeEventListener("keydown",t,!1)},!1),this.hPopupHolder=d("div"),this.hPopupHolder.style["font-family"]="helvetica",this.hPopupHolder.style["font-size"]="12pt",this.hPopupHolder.classList.add("dalliance"),document.body.appendChild(this.hPopupHolder);for(var n=0;n<this.sources.length;++n){var i=this.sources[n];if(i){var r={};this.restoredConfigs&&(r=this.restoredConfigs[n]),i.disabled||this.makeTier(i,r).then(function(t){e.refreshTier(t)})}}e._ensureTiersGrouped(),e.arrangeTiers(),e.reorderTiers();var o=this.getSequenceSource();o&&o.getSeqInfo(this.chr,function(t){t?e.currentSeqMax=t.length:e.currentSeqMax=-1}),this.queryRegistry();for(var a in this.chains)this.queryRegistry(a,!0);if(this.hubs)for(var s=0;s<this.hubs.length;++s){var l=this.hubs[s];"string"==typeof l&&(l={url:l}),function(t){w(t.url,function(n,i){if(i)console.log(i);else{var r;r=t.genome?n.genomes[t.genome]:n.genomes[e.coordSystem.ucscName],r&&(t.mapping&&(r.mapping=t.mapping),e.hubObjects.push(r))}},t)}(l)}this.fullScreen&&this.setFullScreenHeight(),!this.statusRestored&&this.storeStatus&&this.storeStatus(),e.setLocation(this.chr,this.viewStart,this.viewEnd,function(){e.setSelectedTier(1);for(var t=0;t<e.initListeners.length;++t)try{e.initListeners[t].call(e)}catch(n){console.log(n)}})},r.prototype.touchStartHandler=function(e){if(this.touchOriginX=e.touches[0].pageX,this.touchOriginY=e.touches[0].pageY,2==e.touches.length){var t=Math.abs(e.touches[0].pageX-e.touches[1].pageX);this.zooming=!0,this.zoomLastSep=this.zoomInitialSep=t,this.zoomInitialScale=this.scale}},r.prototype.touchMoveHandler=function(e){if(e.stopPropagation(),e.preventDefault(),1==e.touches.length){var t=e.touches[0].pageX,n=e.touches[0].pageY;this.touchOriginX&&t!=this.touchOriginX&&this.move(t-this.touchOriginX),this.touchOriginY&&n!=this.touchOriginY&&(this.tierHolder.scrollTop-=n-this.touchOriginY),this.touchOriginX=t,this.touchOriginY=n}else if(this.zooming&&2==e.touches.length){var i=Math.abs(e.touches[0].pageX-e.touches[1].pageX);if(i!=this.zoomLastSep){var r=(e.touches[0].pageX+e.touches[1].pageX)/2,o=this.viewStart+r/this.scale|0;this.scale=this.zoomInitialScale*(i/this.zoomInitialSep),this.viewStart=o-r/this.scale|0;for(var a=0;a<this.tiers.length;++a)this.tiers[a].draw()}this.zoomLastSep=i}},r.prototype.touchEndHandler=function(e){},r.prototype.touchCancelHandler=function(e){},r.prototype.makeTier=function(e,t){try{return this.realMakeTier(e,t)}catch(n){console.log("Error initializing",e),console.log(n.stack||n)}},r.prototype.realMakeTier=function(e,t){var n=this,i=null;this.tierBackgroundColors&&(i=this.tierBackgroundColors[this.tiers.length%this.tierBackgroundColors.length]);var r=new v(this,e,t,i);r.oorigin=this.viewStart;var o,s,l,u=!1,c=function(e,t){var i=r.subtiers;if(i){var o=0;for(t-=r.padding;o<i.length&&t>i[o].height&&o<i.length-1;)t=t-i[o].height-r.padding,++o;if(!(o>=i.length)){var s=i[o].glyphs,l=((n.viewStart+n.viewEnd)/2,(r.glyphCacheOrigin-n.viewStart)*n.scale);return e-=l,a(s,e,t)}}},h=function(e){e.preventDefault(),e.stopPropagation();var t=e.clientX;t!=s&&(n.move(t-s,!0),s=t),n.isDragging=!0},d=function(e){window.removeEventListener("mousemove",h,!0),window.removeEventListener("mouseup",d,!0),n.move(e.clientX-s)};r.viewport.addEventListener("mousedown",function(e){n.browserHolder.focus(),e.preventDefault();var t=(r.row.getBoundingClientRect(),e.clientX);e.clientY;window.addEventListener("mousemove",h,!0),window.addEventListener("mouseup",d,!0),o=s=t,n.isDragging=!1},!1),r.viewport.addEventListener("mousemove",function(e){var t=r.row.getBoundingClientRect(),i=e.clientX-t.left,o=e.clientY-t.top,a=c(i,o);a&&a.length>0?r.row.style.cursor="pointer":r.row.style.cursor="default",l&&clearTimeout(l),u||(l=setTimeout(function(){var t=c(i,o);t&&t.length>0&&n.notifyFeatureHover(e,t[t.length-1],t,r)},1e3))});var f=null;r.viewport.addEventListener("mouseup",function(e){var t=r.row.getBoundingClientRect(),i=e.clientX-t.left,a=e.clientY-t.top,s=c(i,a);if(s&&s.length>0&&!n.isDragging&&(f?(clearTimeout(f),f=null,n.featureDoubleClick(s,i,a)):f=setTimeout(function(){f=null,n.notifyFeature(e,s[s.length-1],s,r)},500)),n.isDragging&&i!=o&&r.sequenceSource){var l,u,h=n.viewStart+i/n.scale,d=n.viewStart+o/n.scale;d>h?(l=0|h,u=0|d):(l=0|d,u=0|h),n.notifyRegionSelect(n.chr,l,u)}n.isDragging=!1},!1),r.viewport.addEventListener("mouseout",function(e){u=!1}),r.removeButton.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault();for(var t=0;t<n.tiers.length;++t)if(n.tiers[t]===r){n.removeTier({index:t});break}},!1),r.nameButton.addEventListener("click",function(e){if(e.stopPropagation(),e.preventDefault(),e.shiftKey){for(var t=-1,i=0;i<n.tiers.length;++i)if(n.tiers[i]===r){t=i;break}if(t>=0){var o=n.selectedTiers.indexOf(t);o>=0?n.selectedTiers.splice(o,1):(n.selectedTiers.push(t),n.selectedTiers.sort()),n.markSelectedTiers(),n.notifyTierSelection(),n.selectedTiers.length>0?n.browserHolder.focus():n.notifyTierSelectionWrap(-1)}}else{for(var i=0;i<n.tiers.length;++i)if(n.tiers[i]===r&&(n.browserHolder.focus(),1!=n.selectedTiers.length||n.selectedTiers[0]!=i))return void n.setSelectedTier(i);r.infoVisible?(r.infoElement.style.display="none",r.updateHeight(),r.infoVisible=!1):(r.infoElement.style.display="block",r.updateHeight(),r.infoVisible=!0)}},!1),r.bumpButton.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault();var t,n=r;n.dasSource.collapseSuperGroups&&(void 0===t&&(t=!n.bumped),n.mergeConfig({bumped:t}))},!1);var p,_,g,m,y,b=!1,x=function(e){var t=r.label;if(e.stopPropagation(),e.preventDefault(),!p){_=r.pinned?n.pinnedTierHolder:n.tierHolder,g=_.scrollHeight-_.offsetHeight,p=t.cloneNode(!0),p.style.cursor="pointer",_.appendChild(p),t.style.visibility="hidden";for(var i=0;i<n.tiers.length;++i)if(n.tiers[i]===r){m=i;break}y=e.clientY}var o=_.getBoundingClientRect();p.style.left=t.getBoundingClientRect().left-o.left+"px",p.style.top=e.clientY-o.top+_.scrollTop-10+"px";for(var a=e.clientY-o.top+_.scrollTop,i=0;i<n.tiers.length;++i){var s=n.tiers[i];if(!(s.pinned^r.pinned)){var l=s.row.getBoundingClientRect();if(a-=l.bottom-l.top,0>a){if(m>i&&e.clientY<y||i>m&&e.clientY>y){n.withPreservedSelection(function(){n.tiers.splice(m,1),n.tiers.splice(i,0,r),n._ensureTiersGrouped(i>m)});for(var u=0;u<n.tiers.length;++u)n.tiers[u]==r&&(m=u);y=e.clientY,n.reorderTiers(),_.appendChild(p),b=!0}break}}}p.offsetTop<_.scrollTop?_.scrollTop-=_.scrollTop-p.offsetTop:p.offsetTop+p.offsetHeight>_.scrollTop+_.offsetHeight&&(_.scrollTop=Math.min(_.scrollTop+(p.offsetTop+p.offsetHeight)-(_.scrollTop+_.offsetHeight),g))},w=function(e){var t=r.label;if(e.stopPropagation(),e.preventDefault(),p&&(p.style.cursor="auto",_.removeChild(p),p=null,t.style.visibility="visible"),document.removeEventListener("mousemove",x,!1),document.removeEventListener("mouseup",w,!1),b){for(var i=0;i<n.tiers.length;++i)if(n.tiers[i]==r){n.setSelectedTier(i);break}n.notifyTier("reordered",r)}};return r.label.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault(),b=!1,document.addEventListener("mousemove",x,!1),document.addEventListener("mouseup",w,!1)},!1),this.tiers.push(r),r.init().then(function(e){return e.currentlyHeight=50,n.updateHeight(),e.updateLabel(),n.withPreservedSelection(n._ensureTiersGrouped),e._updateFromConfig(),n.reorderTiers(),e})},r.prototype.reorderTiers=function(){f(this.tierHolder),f(this.pinnedTierHolder),this.disablePinning&&(this.tierHolder.appendChild(this.ruler),this.tierHolder.appendChild(this.ruler2));for(var e=!1,t=[],n=[],i=0;i<this.tiers.length;++i){var r=this.tiers[i];r.pinned&&!this.disablePinning?(t.push(r),this.pinnedTierHolder.appendChild(this.tiers[i].row),e=!0):(n.push(r),this.tierHolder.appendChild(this.tiers[i].row))}this.withPreservedSelection(function(){this.tiers.splice(0,this.tiers.length);for(var e=0;e<t.length;++e)this.tiers.push(t[e]);for(var e=0;e<n.length;++e)this.tiers.push(n[e])}),e?this.pinnedTierHolder.classList.add("tier-holder-pinned-full"):this.pinnedTierHolder.classList.remove("tier-holder-pinned-full"),this.arrangeTiers()},r.prototype.withPreservedSelection=function(e){for(var t=[],n=0;n<this.selectedTiers.length;++n)t.push(this.tiers[this.selectedTiers[n]]);e.call(this),this.selectedTiers=[];for(var i=0;i<this.tiers.length;++i)t.indexOf(this.tiers[i])>=0&&this.selectedTiers.push(i)},r.prototype.refreshTier=function(e,t){t=t||P,this.knownSpace&&this.knownSpace.invalidate(e,t)},r.prototype._ensureTiersGrouped=function(e){for(var t={},n=0;n<this.tiers.length;++n){var i=this.tiers[n];i.dasSource.tierGroup&&pusho(t,i.dasSource.tierGroup,i)}var r=[];e&&this.tiers.reverse();for(var n=0;n<this.tiers.length;++n){var i=this.tiers[n];if(i.dasSource.tierGroup){var o=t[i.dasSource.tierGroup];if(o){e&&o.reverse();for(var a=0;a<o.length;++a)r.push(o[a]);t[i.dasSource.tierGroup]=null}}else r.push(i)}e&&r.reverse(),this.tiers.splice(0,this.tiers.length);for(var a=0;a<r.length;++a)this.tiers.push(r[a])},r.prototype.arrangeTiers=function(){for(var e=[],t={},n=0;n<this.tiers.length;++n){var i=this.tiers[n];i.pinned&&(e.push(i),i.dasSource.tierGroup&&pusho(t,i.dasSource.tierGroup,i))}for(var n=0;n<this.tiers.length;++n){var i=this.tiers[n];i.pinned||(e.push(i),i.dasSource.tierGroup&&pusho(t,i.dasSource.tierGroup,i))}for(var r in t){var o=t[r],a=this.tierGroups[r];a||(a={element:d("div",d("span",r,{className:"tier-group-label"}),{className:"tier-group"})},this.tierGroups[r]=a),a.element.parentNode&&a.element.parentNode.removeChild(a.element);for(var s=o[0].pinned?this.pinnedTierHolder:this.tierHolder,l=1e7,u=0,n=0;n<o.length;++n){var c=o[n].row;l=Math.min(l,c.offsetTop),u=Math.max(u,c.offsetTop+c.offsetHeight)}a.element.style.top=l+"px",a.element.style.left="0px",a.element.style.height=u-l+"px",s.appendChild(a.element)}if(this.tierBackgroundColors)for(var n=0;n<e.length;++n){var i=e[n];i.setBackground(this.tierBackgroundColors[n%this.tierBackgroundColors.length]),i.dasSource.tierGroup?i.label.style.left="18px":i.label.style.left="2px",i.background=this.tierBackgroundColors[n%this.tierBackgroundColors.length]}},r.prototype.refresh=function(){this.retrieveTierData(this.tiers,P),this.drawOverlays(),this.positionRuler()};var P=function(e,t){t.draw(),t.updateStatus(e)};r.prototype.retrieveTierData=function(e,t){this.notifyLocation();var n=(this.viewEnd-this.viewStart+1,100/this.scale|0),i=1e3/this.scale|0,r=(this.viewStart+this.viewEnd)/2,o=r-this.origin;this.origin=r,this.scaleAtLastRedraw=this.scale;for(var a=0;a<e.length;++a){var s=o;e[a].originHaxx&&(s+=e[a].originHaxx),e[a].originHaxx=s}var l=this.targetQuantRes/this.scale,u=Math.max(1,(0|this.viewStart)-n),c=Math.min((0|this.viewEnd)+n,(0|this.currentSeqMax)>0?0|this.currentSeqMax:1e9),h=Math.max(1,(0|this.viewStart)-i),d=Math.min((0|this.viewEnd)+i,(0|this.currentSeqMax)>0?0|this.currentSeqMax:1e9);if(!this.knownSpace||this.knownSpace.chr!==this.chr){var f=this.getSequenceSource();this.knownSpace&&this.knownSpace.cancel(),this.knownSpace=new F(this.tiers,this.chr,h,d,l,f)}var p=this.knownSpace.bestCacheOverlapping(this.chr,u,c);p&&p.min<=u&&p.max>=c?(this.drawnStart=Math.max(p.min,h),this.drawnEnd=Math.min(p.max,d)):(this.drawnStart=h,this.drawnEnd=d),this.knownSpace.retrieveFeatures(e,this.chr,this.drawnStart,this.drawnEnd,l,t)},r.prototype.queryRegistry=function(e,t){if(this.registry){var n,i,r=this;e?(n=this.chains[e].coords,r.mappableSources[e]||(r.mappableSources[e]=new h),i=r.mappableSources[e]):(n=this.coordSystem,i=this.availableSources);var a=b(p(n));if(t){var s=localStorage["dalliance.registry."+a+".last_queried"];if(s)try{o(i,JSON.parse(localStorage["dalliance.registry."+a+".sources"]),e);var l=(0|Date.now())-(0|s);if(432e5>l)return}catch(u){console.log("Bad registry cache: "+u)}}var c=this.registry;if(0==c.indexOf("//")){var d=window.location.protocol;"https:"!=d&&"http:"!=d&&(c="http:"+c)}new B(c).sources(function(t){for(var r=[],s=0;s<t.length;++s){var l=t[s];if(l.coords&&0!=l.coords.length){var u=l.coords[0];u.taxon==n.taxon&&u.auth==n.auth&&u.version==n.version&&r.push(l)}}localStorage["dalliance.registry."+a+".sources"]=JSON.stringify(r),localStorage["dalliance.registry."+a+".last_queried"]=""+Date.now(),o(i,r,e)},function(e){},n)}},r.prototype.move=function(e,t){var n=this.viewEnd-this.viewStart,i=this.viewStart-1*e/this.scale,r=i+n;t||(this.currentSeqMax>0&&r>this.currentSeqMax&&(r=this.currentSeqMax,i=this.viewEnd-n),1>i&&(i=1,r=i+n)),this.setLocation(null,i,r,null,t)},r.prototype.zoomStep=function(e){var t=1*this.zoomSliderValue,n=t+e;n<this.zoomMin&&(n=this.zoomMin),n>this.zoomMax&&(n=this.zoomMax),n!=t&&(this.zoomSliderValue=n,this.zoom(Math.exp(1*n/this.zoomExpt)))},r.prototype.zoom=function(e){this.zoomFactor=e;var t=0|Math.round((this.viewStart+this.viewEnd)/2);if(this.viewStart=t-this.zoomBase*this.zoomFactor/2,this.viewEnd=t+this.zoomBase*this.zoomFactor/2,this.currentSeqMax>0&&this.viewEnd>this.currentSeqMax+5){var n=this.viewEnd-this.viewStart+1;this.viewEnd=this.currentSeqMax,this.viewStart=this.viewEnd-n+1}if(this.viewStart<1){var n=this.viewEnd-this.viewStart+1;this.viewStart=1,this.viewEnd=this.viewStart+n-1}this.scale=this.featurePanelWidth/(this.viewEnd-this.viewStart);this.viewEnd-this.viewStart+1,this.scale/this.scaleAtLastRedraw;this.notifyLocation(),this.refresh()},r.prototype.spaceCheck=function(e){if(!this.knownSpace||this.knownSpace.chr!==this.chr)return void this.refresh();var t=((this.viewEnd-this.viewStart|0)+1,100/this.scale|0);1e3/this.scale|0;((0|this.drawnStart)>Math.max(1,(0|this.viewStart)-t|0)||(0|this.drawnEnd)<Math.min((0|this.viewEnd)+t,(0|this.currentSeqMax)>0?0|this.currentSeqMax:1e9))&&this.refresh()},r.prototype.resizeViewer=function(e){var t=0|this.tierHolder.getBoundingClientRect().width;if(0!=t){var n=Math.max(this.featurePanelWidth,300);if(this.featurePanelWidth=0|t,n!=this.featurePanelWidth){this.zoomMax=this.zoomExpt*Math.log(this.maxViewWidth/this.zoomBase),this.zoomMin=this.zoomExpt*Math.log(this.featurePanelWidth/this.maxPixelsPerBase/this.zoomBase),this.zoomSliderValue=this.zoomExpt*Math.log((this.viewEnd-this.viewStart+1)/this.zoomBase);var i=this.viewEnd-this.viewStart,r=this.viewStart+i*this.featurePanelWidth/n;this.viewEnd=r;var o=this.viewEnd-this.viewStart+1;this.currentSeqMax>0&&this.viewEnd>this.currentSeqMax&&(this.viewEnd=this.currentSeqMax,this.viewStart=this.viewEnd-o+1),this.viewStart<1&&(this.viewStart=1,this.viewEnd=this.viewStart+o-1),this.positionRuler(),e||this.spaceCheck(),this.notifyLocation()}this.fullScreen&&this.setFullScreenHeight()}},r.prototype.setFullScreenHeight=function(){var e=document.body.offsetHeight-this.browserHolder.offsetHeight;this.browserHolder.style.maxHeight=Math.max(300,window.innerHeight-e-20)+"px"},r.prototype.addTier=function(e){var t=this;return e=_(e),e.disabled=!1,this.makeTier(e).then(function(e){return t.refreshTier(e),t.markSelectedTiers(),t.positionRuler(),t.notifyTier("added",e),e})},r.prototype.removeTier=function(e,t){var n=-1;if("undefined"!=typeof e.index&&e.index>=0&&e.index<this.tiers.length)n=e.index;else for(var i=0;i<this.tiers.length;++i){var r=this.tiers[i].dasSource;if(L(e,r)){n=i;break}}if(0>n)throw"Couldn't find requested tier";var o=this.tiers[n];this.tiers.splice(n,1);for(var a=[],s=0;s<this.selectedTiers.length;++s){var l=this.selectedTiers[s];n>l?a.push(l):l>n&&a.push(l-1)}this.selectedTiers=a,this.markSelectedTiers(),o.destroy(),this.knownSpace&&(this.knownSpace.featureCache[o]=null),this.reorderTiers(),this.notifyTier("removed",o)},r.prototype.removeAllTiers=function(){var e=this;this.selectedTiers=[],this.markSelectedTiers(),this.tiers.forEach(function(t){t.destroy(),e.knownSpace&&(e.knownSpace.featureCache[t]=null)}),this.tiers.length=0,this.reorderTiers(),this.notifyTier("removedAll",null)},r.prototype.getSequenceSource=function(){return void 0===this._sequenceSource&&(this._sequenceSource=this._getSequenceSource()),this._sequenceSource},r.prototype._getSequenceSource=function(){for(var e=0;e<this.tiers.length;++e)if(this.tiers[e].sequenceSource)return this.tiers[e].sequenceSource;for(var t=0;t<this.defaultSources.length;++t){var n=this.defaultSources[t];if(n.provides_entrypoints||"sequence"==n.tier_type||n.twoBitURI||n.twoBitBlob)return n.twoBitURI||n.twoBitBlob?new I(n):new N(n)}},r.prototype.setLocation=function(e,t,n,i,r){
if("number"!=typeof t)throw Error("minimum must be a number (got "+JSON.stringify(t)+")");if("number"!=typeof n)throw Error("maximum must be a number (got "+JSON.stringify(n)+")");if(t>n){var o=t;t=n,n=o}else t===n&&(n+=1);i||(i=function(e){if(e)throw e});var a=this;if((!e||e==this.chr)&&this.currentSeqMax>0)return this._setLocation(null,t,n,null,i,r);var s=this.getSequenceSource();if(!s)return i("Need a sequence source");var l=e||this.chr;s.getSeqInfo(l,function(o){if(o)return a._setLocation(e,t,n,o,i,r);var u;u=0==l.indexOf("chr")?l.substr(3):"chr"+l,s.getSeqInfo(u,function(o){return!o&&e?i("Couldn't find sequence '"+e+"'"):o?a._setLocation(u,t,n,o,i,r):a._setLocation(null,t,n,null,i,r)})})},r.prototype._setLocation=function(e,t,n,i,r,o){var a=!1;e&&(0==e.indexOf("chr")&&(e=e.substring(3)),this.chr!=e&&(a=!0),this.chr=e,this.currentSeqMax=i.length),t=parseFloat(t),n=parseFloat(n);var s=Math.max(10,n-t+1);if(!o){var l=this.currentSeqMax;0>=l&&(l=1e12),1>t&&(t=1,n=t+s-1),n>l&&(n=l,t=Math.max(1,n-s+1))}this.viewStart=t,this.viewEnd=n;var u=Math.max(this.featurePanelWidth||this.offscreenInitWidth,50)/(this.viewEnd-this.viewStart),c=this.scale,h=Math.abs(u-c)>1e-6;this.scale=u;var d,f;if(f=this.zoomSliderValue,this.zoomSliderValue=d=this.zoomExpt*Math.log((this.viewEnd-this.viewStart+1)/this.zoomBase),h||a){for(var p=0;p<this.tiers.length;++p)this.tiers[p].viewportHolder.style.left="5000px",this.tiers[p].overlay.style.left="5000px";if(this.refresh(),this.savedZoom){d-=this.zoomMin,f-=this.zoomMin;var _=d-f,g=d-this.savedZoom;Math.abs(_)>Math.abs(g)&&(this.isSnapZooming=!this.isSnapZooming,this.savedZoom=f)}else this.isSnapZooming=!1,this.savedZoom=null}else for(var p=((this.viewStart+this.viewEnd)/2,0);p<this.tiers.length;++p){var m=(this.viewStart-this.tiers[p].norigin)*this.scale;this.tiers[p].viewportHolder.style.left=""+((0|-m)-1e3)+"px",this.tiers[p].drawOverlay()}return this.notifyLocation(),this.spaceCheck(),this.instrumentActivity&&(this.activityStartTime=0|Date.now()),r()},r.prototype.setCenterLocation=function(e,t){var n=(this.viewEnd-this.viewStart)/2,i=t-n,r=t+n;this.setLocation(e,i,r)},r.prototype.pingActivity=function(){if(this.instrumentActivity&&this.activityStartTime){for(var e=0,t=0;t<this.tiers.length;++t)"none"!==this.tiers[t].loaderButton.style.display&&++e;if(0==e){var n=0|Date.now();console.log("Loading took "+(n-this.activityStartTime)+"ms"),this.activityStartTime=null}}},r.prototype.addInitListener=function(e){this.initListeners.push(e)},r.prototype.addFeatureListener=function(e,t){t=t||{},this.featureListeners.push(e)},r.prototype.removeFeatureListener=function(e,t){var n=arrayIndexOf(this.featureListeners,e);n>=0&&this.featureListeners.splice(n,1)},r.prototype.notifyFeature=function(e,t,n,i){for(var r=0;r<this.featureListeners.length;++r)try{if(this.featureListeners[r](e,t,n,i))return}catch(o){console.log(o.stack)}},r.prototype.addFeatureHoverListener=function(e,t){t=t||{},this.featureHoverListeners.push(e)},r.prototype.removeFeatureHoverListener=function(e,t){var n=arrayIndexOf(this.featureHoverListeners,e);n>=0&&this.featureHoverListeners.splice(n,1)},r.prototype.notifyFeatureHover=function(e,t,n,i){for(var r=0;r<this.featureHoverListeners.length;++r)try{this.featureHoverListeners[r](e,t,n,i)}catch(o){console.log(o.stack)}},r.prototype.addViewListener=function(e,t){t=t||{},this.viewListeners.push(e)},r.prototype.removeViewListener=function(e,t){var n=arrayIndexOf(this.viewListeners,e);n>=0&&this.viewListeners.splice(n,1)},r.prototype.notifyLocation=function(){var e=Math.max(1,0|this.viewStart),t=0|this.viewEnd;this.currentSeqMax>0&&t>this.currentSeqMax&&(t=this.currentSeqMax);for(var n=0;n<this.viewListeners.length;++n)try{this.viewListeners[n](this.chr,e,t,this.zoomSliderValue,{current:this.zoomSliderValue,alternate:this.savedZoom+this.zoomMin||this.zoomMin,isSnapZooming:this.isSnapZooming,min:this.zoomMin,max:this.zoomMax},this.viewStart,this.viewEnd)}catch(i){console.log(i.stack)}},r.prototype.addTierListener=function(e){this.tierListeners.push(e)},r.prototype.removeTierListener=function(e){var t=arrayIndexOf(this.tierListeners,e);t>=0&&this.tierListeners.splice(t,1)},r.prototype.notifyTier=function(e,t){for(var n=0;n<this.tierListeners.length;++n)try{this.tierListeners[n](e,t)}catch(i){console.log(i.stack)}},r.prototype.addRegionSelectListener=function(e){this.regionSelectListeners.push(e)},r.prototype.removeRegionSelectListener=function(e){var t=arrayIndexOf(this.regionSelectListeners,e);t>=0&&this.regionSelectListeners.splice(t,1)},r.prototype.notifyRegionSelect=function(e,t,n){for(var i=0;i<this.regionSelectListeners.length;++i)try{this.regionSelectListeners[i](e,t,n)}catch(r){console.log(r.stack)}},r.prototype.highlightRegion=function(e,t,n){var i=this;if(e==this.chr)return this._highlightRegion(e,t,n);var r=this.getSequenceSource();if(!r)throw"Need a sequence source";r.getSeqInfo(e,function(o){if(o)return i._highlightRegion(e,t,n);var a;a=0==e.indexOf("chr")?e.substr(3):"chr"+e,r.getSeqInfo(a,function(e){return e?i._highlightRegion(a,t,n):void 0})})},r.prototype._highlightRegion=function(e,t,n){for(var r=0;r<this.highlights.length;++r){var o=this.highlights[r];if(o.chr==e&&o.min==t&&o.max==n)return}this.highlights.push(new i(e,t,n));var a=this.viewStart-1e3/this.scale,s=this.viewEnd+1e3/this.scale;(e==this.chr||e=="chr"+this.chr)&&s>t&&n>a&&this.drawOverlays(),this.notifyLocation()},r.prototype.clearHighlights=function(){this.highlights=[],this.drawOverlays(),this.notifyLocation()},r.prototype.drawOverlays=function(){for(var e=0;e<this.tiers.length;++e)this.tiers[e].drawOverlay()},r.prototype.featuresInRegion=function(e,t,n){var i=[];if(e!==this.chr)return[];for(var r=0;r<this.tiers.length;++r)for(var o=this.tiers[r].currentFeatures||[],a=0;a<o.length;++a){var s=o[a];s.min<=n&&s.max>=t&&i.push(s)}return i},r.prototype.getSelectedTier=function(){return this.selectedTiers.length>0?this.selectedTiers[0]:-1},r.prototype.setSelectedTier=function(e){null==e?this.selectedTiers=[]:this.selectedTiers=[e],this.markSelectedTiers(),this.notifyTierSelection()},r.prototype.markSelectedTiers=function(){for(var e=0;e<this.tiers.length;++e){var t=this.tiers[e].nameButton;this.selectedTiers.indexOf(e)>=0?t.classList.add("active"):t.classList.remove("active")}if(this.selectedTiers.length>0){var n=this.browserHolder.offsetTop+this.browserHolder.offsetHeight/2;n>document.body.scrollTop&&n+100<document.body.scrollTop+window.innerHeight&&this.browserHolder.focus()}},r.prototype.addTierSelectionListener=function(e){this.tierSelectionListeners.push(e)},r.prototype.removeTierSelectionListener=function(e){var t=arrayIndexOf(this.tierSelectionListeners,e);t>=0&&this.tierSelectionListeners.splice(t,1)},r.prototype.notifyTierSelection=function(){for(var e=0;e<this.tierSelectionListeners.length;++e)try{this.tierSelectionListeners[e](this.selectedTiers)}catch(t){console.log(t.stack)}},r.prototype.addTierSelectionWrapListener=function(e){this.tierSelectionWrapListeners.push(e)},r.prototype.removeTierSelectionWrapListener=function(e){var t=arrayIndexOf(this.tierSelectionWrapListeners,e);t>=0&&this.tierSelectionWrapListeners.splice(t,1)},r.prototype.notifyTierSelectionWrap=function(e){for(var t=0;t<this.tierSelectionWrapListeners.length;++t)try{this.tierSelectionWrapListeners[t](e)}catch(n){console.log(n.stack)}},r.prototype.positionRuler=function(){var e="none",t="",n="";if("center"==this.rulerLocation?(e="block",t=""+(this.featurePanelWidth/2|0)+"px"):"left"==this.rulerLocation?(e="block",t="0px"):"right"==this.rulerLocation?(e="block",n="0px"):e="none",this.ruler.style.display=e,this.ruler.style.left=t,this.ruler.style.right=n,this.singleBaseHighlight){this.ruler2.style.display="block",this.ruler2.style.borderWidth="1px",this.scale<1?(this.ruler2.style.width="0px",this.ruler2.style.borderRightWidth="0px"):(this.ruler2.style.width=this.scale+"px",this.ruler2.style.borderRightWidth="1px"),this.locSingleBase.style.visibility="visible";var i=this.featurePanelWidth/2-this.locSingleBase.offsetWidth/2+this.ruler2.offsetWidth/2;this.locSingleBase.style.left=""+(0|i)+"px"}else this.locSingleBase.style.visibility="hidden",this.ruler2.style.width="1px",this.ruler2.style.borderWidth="0px",this.ruler2.style.display="center"==this.rulerLocation?"none":"block";this.ruler2.style.left=""+(this.featurePanelWidth/2|0)+"px";for(var r=0;r<this.tiers.length;++r){var o,a=this.tiers[r],s=a.quantOverlay;a.subtiers&&a.subtiers.length>0&&(o=a.subtiers[0].quant),s&&(s.style.display=o?e:"none",s.style.left=t,s.style.right=n)}},r.prototype.featureDoubleClick=function(e,t,n){if(e&&0!=e.length){var i=e[e.length-1];if(i.min&&i.max){var r=((0|i.min)-(0|this.viewStart))*this.scale,o=(i.max-i.min+1)*this.scale,a=((0|i.min)+(0|i.max))/2;if(o>10){var s=1*(t-r)/o;.3>s?a=0|i.min:s>.7&&(a=(0|i.max)+1)}var l=this.viewEnd-this.viewStart;this.setLocation(null,a-l/2,a+l/2)}}},r.prototype.zoomForScale=function(e){var t;return t=e>.2?"high":e>.01?"medium":"low"},r.prototype.zoomForCurrentScale=function(){return this.zoomForScale(this.scale)},r.prototype.updateHeight=function(){for(var e=0,t=0;t<this.tiers.length;++t)e+=this.tiers[t].currentHeight||30;this.ruler.style.height=""+e+"px",this.ruler2.style.height=""+e+"px",this.browserHolder.style.display="block",this.browserHolder.style.display="flex"},r.prototype.scrollArrowKey=function(e,t){if(this.reverseKeyScrolling&&(t=-t),e.ctrlKey||e.metaKey){var n=!1;e.shiftKey&&(n=!0),this.leap(t,n)}else if(this.scale>1){var i=(this.viewStart+this.viewEnd)/2,r=i-Math.round(i),o=1;e.shiftKey&&(o*=10),t>0?(o=-o,o-=r,r>0&&(o+=1)):(o-=r,0>r&&(o-=1)),this.setLocation(null,this.viewStart+o,this.viewEnd+o)}else this.move(e.shiftKey?100*t:25*t)},r.prototype.leap=function(e,t){var n=this,i=(n.viewStart+n.viewEnd+1)/2|0;e>0&&n.viewStart<=1?i-=1e8:0>e&&n.viewEnd>=n.currentSeqMax&&(i+=1e8);var r=n.getSelectedTier();if(!(0>r)){var o=n.tiers[r];o&&(o.featureSource&&this.sourceAdapterIsCapable(o.featureSource,"quantLeap")&&"number"==typeof o.quantLeapThreshold||o.featureSource&&this.sourceAdapterIsCapable(o.featureSource,"leap"))?o.findNextFeature(n.chr,i,-e,t,function(r){if(r){var o=r.min,a=r.max;t&&(e>0?o>i+1?a=o:(a++,o=a):i-1>a?(a++,o=a):a=o);var s=n.viewEnd-n.viewStart+1;parseFloat(s/2)==parseInt(s/2)&&s--;var l=(o+a-s)/2+1,u=l+s-1;n.setLocation(r.segment,l,u)}else alert("no next feature")}):this.move(100*e)}},r.prototype.nameForCoordSystem=function(e){var t=null,n=null;return this.assemblyNamePrimary&&(t=""+e.auth,"undefined"!=typeof e.version&&(t+=e.version)),this.assemblyNameUcsc&&(n=e.ucscName),null!=t&&null!=n?t+"/"+n:t||n||"unknown"},r.prototype.makeLoader=function(e){e=e||16;var t=window.devicePixelRatio>1;return 20>e?d("img",null,{src:this.resolveURL("$$img/spinner_"+(t?16:32)+".gif"),width:"16",height:"16"}):d("img",null,{src:this.resolveURL("$$img/spinner_"+(t?24:48)+".gif"),width:"24",height:"24"})},r.prototype.canFetchPlainHTTP=function(){var e=this;if(!this._plainHTTPPromise){var t=this.getWorker();t?this._plainHTTPPromise=new E(function(n,i){t.postCommand({command:"textxhr",uri:e.httpCanaryURL},function(e,t){n(e?!0:!1)})}):this._plainHTTPPromise=new E(function(t,n){g(e.httpCanaryURL,function(e,n){t(e?!0:!1)},{timeout:2e3})})}return this._plainHTTPPromise},r.prototype.getWorker=function(){return this.useFetchWorkers&&this.fetchWorkers&&0!=this.fetchWorkers.length?(this.nextWorker>=this.fetchWorkers.length&&(this.nextWorker=0),this.fetchWorkers[this.nextWorker++]):null},s.prototype.postCommand=function(e,t,n){var i="x"+ ++this.tagSeed;e.tag=i,this.callbacks[i]=t,this.worker.postMessage(e,n)},e.exports={Browser:r},n(280),n(288),n(295),n(296),n(289),n(297);var D=n(299),I=D.TwoBitSequenceSource,N=D.DASSequenceSource,F=n(308).KnownSpace,B=n(251).DASRegistry;u.prototype.get=function(e){var t=this.sourcesByURI[O(e)];if(t)for(var n=0;n<t.configs.length;++n)if(R(t.configs[n],e))return t.sources[n]},u.prototype.put=function(e,t){var n=O(e),i=this.sourcesByURI[n];i||(i={configs:[],sources:[]},this.sourcesByURI[n]=i),i.configs.push(e),i.sources.push(t)}},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return;e.push(t)}function r(e,t,n){e[t]?e[t].push(n):e[t]=[n]}function o(e,t,n){var i=e[t];if(i){for(var r=0;r<i.length;++r)if(i[r]==n)return;i.push(n)}else e[t]=[n]}function a(e,t,n,i){return e?e:t?t:n?n:i?i:void 0}function i(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return;e.push(t)}function s(e,t){if(!e)return-1;for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function l(e,t){var n=s(e,t);return n>=0?(e.splice(n,1),!0):!1}function u(e,t,n,i){var r=document.createElement(e);if(t){t instanceof Array||(t=[t]);for(var o=0;o<t.length;++o){var a=t[o];a&&("string"==typeof a?a=document.createTextNode(a):"number"==typeof a&&(a=document.createTextNode(""+a)),r.appendChild(a))}}if(n)for(var s in n)try{r[s]=n[s]}catch(l){throw console.log("error setting "+s),l}if(i)for(var s in i)r.style[s]=i[s];return r}function c(e,t,n,i){var r=document.createElementNS(e,t);if(n){n instanceof Array||(n=[n]);for(var o=0;o<n.length;++o){var a=n[o];"string"==typeof a&&(a=document.createTextNode(a)),r.appendChild(a)}}return d(r,i),r}function h(e,t,n){var i=A[t];if(!i){for(var r="",o=0;o<t.length;++o){var a=t.substring(o,o+1),s=a.toLowerCase();s!=a?r=r+"-"+s:r+=a}A[t]=r,i=r}e.setAttribute(i,n)}function d(e,t){if(t)for(var n in t)h(e,n,t[n])}function f(e){if(e&&e.childNodes)for(;e.childNodes.length>0;)e.removeChild(e.firstChild)}function p(e,t){if("undefined"==typeof e)return"undefined";if(null==e)return"null";if("string"==typeof e)return"'"+e+"'";if("number"==typeof e)return""+e;if("boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array){for(var n=null,i=0;i<e.length;++i)n=(null==n?"":n+", ")+p(e[i],t);return"["+(n?n:"")+"]"}t=t||{};var n=null;for(var r in e)t[r]||void 0!=r&&"function"!=typeof e[r]&&(n=(null==n?"":n+", ")+r+": "+p(e[r],t));return"{"+(n?n:"")+"}"}return typeof e}function _(e){var t={};for(var n in e)t[n]=e[n];return t}function g(e){this.value=e,this.listeners=[]}function m(){this.queue=[]}function v(e){return e+"?salt="+S(""+Date.now()+","+ ++k)}function y(e,t,n){n&&n.salt&&(e=v(e));try{var i;n.timeout&&(i=setTimeout(function(){return console.log("timing out "+e),r.abort(),t(null,"Timeout")},n.timeout));var r=new XMLHttpRequest;r.onreadystatechange=function(){4==r.readyState&&(i&&clearTimeout(i),r.status<200||r.status>=300?t(null,"Error code "+r.status):t(r.responseText))},r.open("GET",e,!0),r.responseType="text",n&&n.credentials&&(r.withCredentials=!0),r.send("")}catch(o){t(null,"Exception "+o)}}function b(e,t){if(0==t.indexOf("http:")||0==t.indexOf("https:"))return t;var n=e.lastIndexOf("/");return n>=0?e.substr(0,n+1)+t:t}function x(e){return u("a",null,{href:e}).href}var w=n(249),S=w.b64_sha1,A=(new RegExp("[0-9]+"),new RegExp("^[0-9]+$"),{});g.prototype.addListener=function(e){this.listeners.push(e)},g.prototype.addListenerAndFire=function(e){this.listeners.push(e),e(this.value)},g.prototype.removeListener=function(e){l(this.listeners,e)},g.prototype.get=function(){return this.value},g.prototype.set=function(e){this.value=e;for(var t=0;t<this.listeners.length;++t)this.listeners[t](e)},m.prototype.provide=function(e){if(void 0!==this.res)throw"Resource has already been provided.";this.res=e;for(var t=0;t<this.queue.length;++t)this.queue[t](e);this.queue=null},m.prototype.await=function(e){return void 0!==this.res?(e(this.res),this.res):void this.queue.push(e)};var k=0,C={TTT:"F",TTC:"F",TTA:"L",TTG:"L",CTT:"L",CTC:"L",CTA:"L",CTG:"L",ATT:"I",ATC:"I",ATA:"I",ATG:"M",GTT:"V",GTC:"V",GTA:"V",GTG:"V",TCT:"S",TCC:"S",TCA:"S",TCG:"S",CCT:"P",CCC:"P",CCA:"P",CCG:"P",ACT:"T",ACC:"T",ACA:"T",ACG:"T",GCT:"A",GCC:"A",GCA:"A",GCG:"A",TAT:"Y",TAC:"Y",TAA:"*",TAG:"*",CAT:"H",CAC:"H",CAA:"Q",CAG:"Q",AAT:"N",AAC:"N",AAA:"K",AAG:"K",GAT:"D",GAC:"D",GAA:"E",GAG:"E",TGT:"C",TGC:"C",TGA:"*",TGG:"W",CGT:"R",CGC:"R",CGA:"R",CGG:"R",AGT:"S",AGC:"S",AGA:"R",AGG:"R",GGT:"G",GGC:"G",GGA:"G",GGG:"G"};"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),e.exports={textXHR:y,relativeURL:b,resolveUrlToPage:x,shallowCopy:_,pusho:r,pushnew:i,pushnewo:o,arrayIndexOf:s,pick:a,makeElement:u,makeElementNS:c,removeChildren:f,miniJSONify:p,Observed:g,Awaited:m,AMINO_ACID_TRANSLATION:C}},function(e,t,n){"use strict";function i(e){return a(o(l(e)))}function r(e){return s(o(l(e)))}function o(e){return c(h(u(e),8*e.length))}function a(e){for(var t,n=g?"0123456789ABCDEF":"0123456789abcdef",i="",r=0;r<e.length;r++)t=e.charCodeAt(r),i+=n.charAt(t>>>4&15)+n.charAt(15&t);return i}function s(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",i=e.length,r=0;i>r;r+=3)for(var o=e.charCodeAt(r)<<16|(i>r+1?e.charCodeAt(r+1)<<8:0)|(i>r+2?e.charCodeAt(r+2):0),a=0;4>a;a++)n+=8*r+6*a>8*e.length?m:t.charAt(o>>>6*(3-a)&63);return n}function l(e){for(var t,n,i="",r=-1;++r<e.length;)t=e.charCodeAt(r),n=r+1<e.length?e.charCodeAt(r+1):0,t>=55296&&56319>=t&&n>=56320&&57343>=n&&(t=65536+((1023&t)<<10)+(1023&n),r++),127>=t?i+=String.fromCharCode(t):2047>=t?i+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?i+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(i+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return i}function u(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(var n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}function c(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>24-n%32&255);return t}function h(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var n=Array(80),i=1732584193,r=-271733879,o=-1732584194,a=271733878,s=-1009589776,l=0;l<e.length;l+=16){for(var u=i,c=r,h=o,g=a,m=s,v=0;80>v;v++){16>v?n[v]=e[l+v]:n[v]=_(n[v-3]^n[v-8]^n[v-14]^n[v-16],1);var y=p(p(_(i,5),d(v,r,o,a)),p(p(s,n[v]),f(v)));s=a,a=o,o=_(r,30),r=i,i=y}i=p(i,u),r=p(r,c),o=p(o,h),a=p(a,g),s=p(s,m)}return Array(i,r,o,a,s)}function d(e,t,n,i){return 20>e?t&n|~t&i:40>e?t^n^i:60>e?t&n|t&i|n&i:t^n^i}function f(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function p(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}function _(e,t){return e<<t|e>>>32-t}var g=0,m="";e.exports={b64_sha1:r,hex_sha1:i}},function(e,t,n){"use strict";function i(e,t,n,i){if(this.config=n||{},this.id="tier"+ ++w,this.browser=e,this.dasSource=s(t),this.background=i,this.viewport=o("canvas",null,{width:""+((0|this.browser.featurePanelWidth)+2e3),height:"30",className:"viewport_12_5"},{position:"inline-block",margin:"0px",border:"0px"}),this.viewportHolder=o("div",this.viewport,{className:"viewport-holder_12_5"},{background:i,position:"absolute",padding:"0px",margin:"0px",border:"0px",left:"-1000px",minHeight:"200px"}),this.overlay=o("canvas",null,{width:+(0|this.browser.featurePanelWidth),height:"30",className:"viewport-overlay"}),this.notifier=o("div","",{className:"notifier"}),this.notifierHolder=o("div",this.notifier,{className:"notifier-holder"}),this.quantOverlay=o("canvas",null,{width:"50",height:"56",className:"quant-overlay"}),this.removeButton=o("i",null,{className:"fa fa-times"}),this.bumpButton=o("i",null,{className:"fa fa-plus-circle"}),this.loaderButton=e.makeLoader(16),this.loaderButton.style.display="none",this.infoElement=o("div",this.dasSource.desc,{className:"track-label-info"}),this.nameButton=o("div",[],{className:"tier-tab"}),this.nameButton.appendChild(this.removeButton),t.pennant)this.nameButton.appendChild(o("img",null,{src:t.pennant,width:"16",height:"16"}));else if(t.mapping){var r=null;this.browser.chains[t.mapping]&&(r=this.browser.chains[t.mapping].coords.version),r&&this.nameButton.appendChild(o("span",""+r,null,{fontSize:"8pt",background:"black",color:"white",paddingLeft:"3px",paddingRight:"3px",paddingTop:"1px",paddingBottom:"1px",marginLeft:"2px",borderRadius:"10px"}))}this.nameElement=o("span",t.name),this.nameButton.appendChild(o("span",[this.nameElement,this.infoElement],{className:"track-name-holder"})),this.nameButton.appendChild(this.bumpButton),this.nameButton.appendChild(this.loaderButton),this.label=o("span",[this.nameButton],{className:"btn-group track-label"});var a="tier"+(t.className?" "+t.className:"");this.row=o("div",[this.viewportHolder,this.overlay,this.quantOverlay],{className:a}),i||(this.row.style.background="none"),e.noDefaultLabels||this.row.appendChild(this.label),this.row.appendChild(this.notifierHolder),this.layoutHeight=25,this.bumped=!0,this.styleIdSeed=0,t.quantLeapThreshold&&(this.quantLeapThreshold=t.quantLeapThreshold),this.dasSource.collapseSuperGroups&&(this.bumped=!1),this.layoutWasDone=!1,t.featureInfoPlugin&&this.addFeatureInfoPlugin(t.featureInfoPlugin),this.initSources();var l=this;this.featureSource&&this.featureSource.getDefaultFIPs&&!t.noSourceFeatureInfo&&this.featureSource.getDefaultFIPs(function(e){e&&l.addFeatureInfoPlugin(e)}),this.featureSource&&this.featureSource.addReadinessListener&&(this.readinessListener=function(e){l.notify(e,-1)},this.featureSource.addReadinessListener(this.readinessListener)),this.featureSource&&this.featureSource.addActivityListener&&(this.activityListener=function(e){e>0?l.loaderButton.style.display="inline-block":l.loaderButton.style.display="none",l.browser.pingActivity()},this.featureSource.addActivityListener(this.activityListener)),this.listeners=[],this.featuresLoadedListeners=[]}var r=n(248),o=r.makeElement,a=r.removeChildren,s=r.shallowCopy,l=(r.pushnew,r.miniJSONify),u=r.arrayIndexOf,c=n(251),h=c.DASStylesheet,d=c.DASStyle,f=n(249),p=f.b64_sha1,_=n(253),g=_.StyleFilter,m=_.StyleFilterSet,v=n(254),y=v.sourceDataURI,b=n(255).Promise,x=n(266).sortFeatures,w=0;i.prototype.destroy=function(){this.featureSource.removeReadinessListener&&this.featureSource.removeReadinessListener(this.readinessListener),this.featureSource.removeActivityListener&&this.featureSource.removeActivityListener(this.activityListener)},i.prototype.setBackground=function(e){this.background=e,this.viewportHolder.style.background=e},i.prototype.toString=function(){return this.id},i.prototype.addFeatureInfoPlugin=function(e){this.featureInfoPlugins||(this.featureInfoPlugins=[]),this.featureInfoPlugins.push(e)},i.prototype.init=function(){var e=this;return new b(function(t,n){e.dasSource.style?(e.setStylesheet({styles:e.dasSource.style}),t(e)):(e.status="Fetching stylesheet",e.fetchStylesheet(function(n,i){if(i||!n){e.error="No stylesheet";var n=new h,r=new d;r.glyph="BOX",r.BGCOLOR="blue",r.FGCOLOR="black",n.pushStyle({type:"default"},null,r),e.setStylesheet(n)}else e.setStylesheet(n),n.geneHint&&(e.dasSource.collapseSuperGroups=!0,e.bumped=!1,e.updateLabel()),e._updateFromConfig();t(e)}))})},i.prototype.setStylesheet=function(e){this.baseStylesheet=s(e);for(var t=0;t<this.baseStylesheet.styles.length;++t){var n=this.baseStylesheet.styles[t]=s(this.baseStylesheet.styles[t]);n._methodRE=n._labelRE=n._typeRE=null,n.style=s(n.style),n.style.id="style"+ ++this.styleIdSeed}this.baseStylesheetValidity=p(l(this.baseStylesheet)),this._updateFromConfig()},i.prototype.getSource=function(){return this.featureSource},i.prototype.getDesiredTypes=function(e){var t=this.getActiveStyleFilters(e);return t?t.typeList():void 0},i.prototype.getActiveStyleFilters=function(e){var t=this.browser.zoomForCurrentScale();if(this.stylesheet){for(var n=new m,i=this.stylesheet.styles,r=0;r<i.length;++r){var o=i[r];o.zoom&&o.zoom!=t||n.add(new g(o.type,o.method,o.label))}return n}},i.prototype.needsSequence=function(e){return this.sequenceSource&&5>e?!0:(this.dasSource.bamURI||this.dasSource.bamBlob||this.dasSource.bwgURI||this.dasSource.bwgBlob)&&20>e?!0:!1},i.prototype.setFeatures=function(e,t,n,i,r){this.currentFeatures=i,this.currentSequence=r,this.knownChr=e,this.knownCoverage=t,i&&(x(this),this.notifyFeaturesLoaded())},i.prototype.draw=function(){var e=(this.currentFeatures,this.currentSequence);this.sequenceSource?C(this,e):A(this),this.paint(),this.originHaxx=0,this.browser.arrangeTiers()},i.prototype.findNextFeature=function(e,t,n,i,r){if(this.quantLeapThreshold){var o=this.browser.viewEnd-this.browser.viewStart+1;t=t+o*n/2|0,this.featureSource.quantFindNextFeature(e,t,n,this.quantLeapThreshold,r)}else{if(this.knownCoverage&&t>=this.knownCoverage.min()&&t<=this.knownCoverage.max()&&this.currentFeatures){for(var a=null,s=0;s<this.currentFeatures.length;++s){var l=this.currentFeatures[s];l.min&&l.max&&(l.parents&&l.parents.length>0||(0>n?1==i&&l.max>=t&&l.min<t?(!a||l.min>a.min||l.min==a.min&&l.max<a.max)&&(a=l):l.max<t&&(!a||l.max>a.max||l.max==a.max&&l.min<a.min||l.min==a.mmin&&a.max>=t)&&(a=l):1==i&&l.min<=t&&l.max>t?(!a||l.max<a.max||l.max==a.max&&l.min>a.min)&&(a=l):l.min>t&&(!a||l.min<a.min||l.min==a.min&&l.max>a.max||l.max==a.max&&a.min<=t)&&(a=l)))}if(a)return r(a);t=0>n?this.browser.knownSpace.min:this.browser.knownSpace.max}this.trySourceFNF(e,t,n,r)}},i.prototype.trySourceFNF=function(e,t,n,i){var r=this;this.featureSource.findNextFeature(e,t,n,function(e){e||i(e);var t=r.browser.getSequenceSource();t||i(e),t.getSeqInfo(e.segment,function(t){t?i(e):r.trySourceFNF(e.segment,n>0?1e10:0,n,i)})})},i.prototype.updateLabel=function(){this.bumpButton.className=this.bumped?"fa fa-minus-circle":"fa fa-plus-circle",this.dasSource.collapseSuperGroups?this.bumpButton.style.display="inline-block":this.bumpButton.style.display="none"},i.prototype.updateHeight=function(){this.currentHeight=Math.max(Math.max(this.layoutHeight,this.label.clientHeight+2),this.browser.minTierHeight),this.row.style.height=""+this.currentHeight+"px",this.browser.updateHeight()},i.prototype.drawOverlay=function(){var e=this,t=this.browser,n=t.retina&&window.devicePixelRatio>1;e.overlay.height=e.viewport.height,e.overlay.width=n?2*t.featurePanelWidth:t.featurePanelWidth;var i=e.overlay.getContext("2d");n&&i.scale(2,2);var r=t.viewStart,o=t.viewStart,a=t.viewEnd;if(this.overlayLabelCanvas){var s=(this.glyphCacheOrigin-this.browser.viewStart)*this.browser.scale;i.save(),i.translate(s,0);var l=-s+2;this.dasSource.tierGroup&&(l+=15),this.overlayLabelCanvas.draw(i,l,t.featurePanelWidth-s),i.restore()}for(var u=0;u<t.highlights.length;++u){var c=t.highlights[u];(c.chr===t.chr||c.chr==="chr"+t.chr)&&c.min<a&&c.max>o&&(i.globalAlpha=t.defaultHighlightAlpha,i.fillStyle=t.defaultHighlightFill,i.fillRect((c.min-r)*t.scale,0,(c.max-c.min)*t.scale,e.overlay.height))}e.overlay.style.width=t.featurePanelWidth,e.overlay.style.height=e.viewport.style.height,e.overlay.style.left="0px"},i.prototype.updateStatus=function(e){var t=this;if(e){this.status=e,this._notifierToStatus();y(this.dasSource);"https:"!==window.location.protocol||0!=y(this.dasSource).indexOf("http:")||this.checkedHTTP||(this.checkedHTTP=!0,this.browser.canFetchPlainHTTP().then(function(e){e||(t.warnHTTP=!0,t._notifierToStatus())}))}else this.status&&(this.status=null,this._notifierToStatus())},i.prototype.notify=function(e,t){if("number"!=typeof t&&(t=2e3),this.notifierFadeTimeout&&(clearTimeout(this.notifierFadeTimeout),this.notifierFadeTimeout=null),e){if(this._notifierOn(e),t>0){var n=this;this.notifierFadeTimeout=setTimeout(function(){n._notifierToStatus()},t)}}else this._notifierToStatus()},i.prototype._notifierOn=function(e,t){a(this.notifier),t?this.notifier.appendChild(o("span",[o("a","[HTTP Warning] ",{href:this.browser.httpWarningURL,target:"_blank"}),e])):this.notifier.textContent=e,this.notifier.style.opacity=.8},i.prototype._notifierOff=function(){this.notifier.style.opacity=0},i.prototype._notifierToStatus=function(){this.status?this._notifierOn(this.status,this.warnHTTP):this._notifierOff()},i.prototype.setConfig=function(e){this.config=e||{},this._updateFromConfig(),this.notifyTierListeners()},i.prototype.mergeStylesheet=function(e){this.mergeConfig({stylesheet:e,stylesheetValidity:this.baseStylesheetValidity})},i.prototype.mergeConfig=function(e){for(var t in e)this.config[t]=e[t];this._updateFromConfig(),this.notifyTierListeners()},i.prototype._updateFromConfig=function(){var e=!1,t=!1;"string"==typeof this.config.name?this.nameElement.textContent=this.config.name:this.nameElement.textContent=this.dasSource.name;var n=this.config.height||this.dasSource.forceHeight;n!=this.forceHeight&&(this.forceHeight=n,e=!0),this.forceMinDynamic!=this.config.forceMinDynamic&&(this.forceMinDynamic=this.config.forceMinDynamic,e=!0);var i=void 0!=this.config.forceMin?this.config.forceMin:this.dasSource.forceMin;this.forceMin!=i&&(this.forceMin=i,e=!0),this.forceMaxDynamic!=this.config.forceMaxDynamic&&(this.forceMaxDynamic=this.config.forceMaxDynamic,e=!0);var r=void 0!=this.config.forceMax?this.config.forceMax:this.dasSource.forceMax;this.forceMax!=r&&(this.forceMax=r,e=!0);var o=null;void 0!==this.config.quantLeapThreshold?o=this.config.quantLeapThreshold:void 0!==this.dasSource.quantLeapThreshold&&(o=this.dasSource.quantLeapThreshold),o!=this.quantLeapThreshold&&(this.quantLeapThreshold=o,e=!0);var a=null;this.config.stylesheetValidity==this.baseStylesheetValidity&&(a=this.config.stylesheet),a=a||this.baseStylesheet,this.stylesheet!==a&&(this.stylesheet=a,e=!0);var s=void 0!==this.config.pinned?this.config.pinned:this.dasSource.pinned;s!==this.pinned&&(this.pinned=s,t=!0);var l=this.config.subtierMax;l!=this.subtierMax&&(this.subtierMax=l,e=!0);var u;u=void 0!==this.config.bumped?this.config.bumped:void 0!==this.dasSource.bumped?this.dasSource.bumped:this.dasSource.collapseSuperGroups?!1:!0,u!==this.bumped&&(this.bumped=u,e=!0,this.updateLabel()),e&&this.scheduleRedraw(),t&&this.browser.reorderTiers()},i.prototype.scheduleRedraw=function(){if(this.currentFeatures){var e=this;this.redrawTimeout||(this.redrawTimeout=setTimeout(function(){e.draw(),e.redrawTimeout=null},10))}},i.prototype.clearTierListeners=function(){this.listeners=[]},i.prototype.addTierListener=function(e){this.listeners.push(e)},i.prototype.removeTierListener=function(e){var t=u(this.listeners,e);t>=0&&this.listeners.splice(t,1)},i.prototype.notifyTierListeners=function(e){for(var t=0;t<this.listeners.length;++t)try{this.listeners[t](e)}catch(n){console.log(n)}this.browser.notifyTier()},i.prototype.clearFeaturesLoadedListeners=function(){this.featuresLoadedListeners=[]},i.prototype.addFeaturesLoadedListener=function(e){this.featuresLoadedListeners.push(e)},i.prototype.removeFeaturesLoadedListener=function(e){var t=u(this.featuresLoadedListeners,e);t>=0&&this.featuresLoadedListeners.splice(t,1)},i.prototype.notifyFeaturesLoaded=function(){for(var e=0;e<this.featuresLoadedListeners.length;++e)try{this.featuresLoadedListeners[e].call(this)}catch(t){console.log(t)}},e.exports={DasTier:i};var S=n(267),A=S.drawFeatureTier,k=n(273),C=k.drawSeqTier},function(e,t,n){"use strict";function i(e,t,n,i){this.name=e,this.start=t,this.end=n,this.description=i}function r(e,t){var n;"string"==typeof e?(this.uri=e,n=t||{}):n=e||{};for(var i in n)"function"!=typeof n[i]&&(this[i]=n[i]);this.coords||(this.coords=[]),this.props||(this.props={}),this.dasBaseURI=this.uri,this.dasBaseURI&&"/"!=this.dasBaseURI.substr(this.uri.length-1)&&(this.dasBaseURI=this.dasBaseURI+"/")}function o(){}function a(e,t){return e.taxon==t.taxon&&e.auth==t.auth&&e.version==t.version}function s(e,t,n,i,r){this.name=e,this.start=t,this.end=n,this.alphabet=i,this.seq=r}function l(){}function u(e){e&&(this.id=e)}function c(e,t){this.desc=e,this.uri=t}function h(e){this.type=e,this.objects={},this.blocks=[]}function d(){this.styles=[]}function f(){}function p(e){var t=e.getAttribute("steps");t=t?0|t:50;for(var n=[],i=[],r=e.getElementsByTagName("STOP"),o=0;o<r.length;++o){var a=r[o];n.push(1*a.getAttribute("score")),i.push(a.firstChild.nodeValue)}return E(t,n,i)}function _(e,t){t=t||{},this.uri=e,this.opts=t}function g(e,t){var n=e.getElementsByTagName(t);if(n.length>0&&n[0].firstChild){var i=n[0];if(1==i.childNodes.length)return i.firstChild.nodeValue;for(var r="",o=0;o<i.childNodes.length;++o)r+=i.childNodes[o].nodeValue;
return r}return null}function m(e){if(e.hasChildNodes()){var t=e.firstChild;do{if(t.nodeType==Node.ELEMENT_NODE)return t;t=t.nextSibling}while(null!=t)}return null}function v(e){for(var t=new Array,n=e.getElementsByTagName("LINK"),i=0;i<n.length;++i){var r=n[i];r.parentNode==e&&t.push(new c(r.firstChild?r.firstChild.nodeValue:"Unknown",r.getAttribute("href")))}return t}function y(e){for(var t=[],n=e.getElementsByTagName("NOTE"),i=0;i<n.length;++i)n[i].firstChild&&t.push(n[i].firstChild.nodeValue);return t}function b(e,t,n,i){if(window.XDomainRequest){var r=new XDomainRequest;r.onload=function(){var e=new ActiveXObject("Microsoft.XMLDOM");e.async=!1,e.loadXML(r.responseText),t(e)},r.open("get",e),r.send("")}else try{var r=new XMLHttpRequest,o=setTimeout(function(){console.log("timing out "+e),r.abort(),t(null,r)},5e3);r.timeout=5e3,r.ontimeout=function(){console.log("timeout on "+e)},r.onreadystatechange=function(){4==r.readyState&&(clearTimeout(o),(r.status>=200||0==r.status)&&t(r.responseXML,r))},r.open("get",e,!0),n&&(r.withCredentials=!0),i&&r.setRequestHeader("X-DAS-Authorisation",i),r.overrideMimeType("text/xml"),r.setRequestHeader("Accept","application/xml,*/*"),r.send("")}catch(a){t(null,r,a)}}function x(e){return e=(""+e).toLowerCase(),"yes"===e||"true"===e}function w(e){return e?(e=(""+e).toLowerCase(),"no"!==e||"false"!==e):!1}function S(e){var t=k(e);t.styles=[];for(var n=0;n<e.styles.length;++n){var i=t.styles[n]=k(e.styles[n]);i._methodRE=i._labelRE=i._typeRE=void 0,i.style=k(i.style),i.style.id=void 0,i.style._gradient=void 0}return t}var A=n(248),k=A.shallowCopy,C=A.pusho,T=n(252),E=T.makeColourSteps;new Array;i.prototype.toString=function(){return this.name+":"+this.start+".."+this.end},i.prototype.isBounded=function(){return this.start&&this.end},i.prototype.toDASQuery=function(){var e="segment="+this.name;return this.start&&this.end&&(e+=":"+this.start+","+this.end),e},r.prototype.entryPoints=function(e){var t=this.dasBaseURI+"entry_points";this.doCrossDomainRequest(t,function(t){if(!t)return e([]);for(var n=new Array,r=t.getElementsByTagName("SEGMENT"),o=0;o<r.length;++o){var a,s,l=r[o],u=l.getAttribute("id"),c=l.getAttribute("size");c?(a=1,s=0|c):(a=l.getAttribute("start"),a&&(a|=0),s=l.getAttribute("stop"),s&&(s|=0));var h=null;l.firstChild&&(h=l.firstChild.nodeValue),n.push(new i(u,a,s,h))}e(n)})},r.prototype.sequence=function(e,t){var n=this.dasBaseURI+"sequence?"+e.toDASQuery();this.doCrossDomainRequest(n,function(e){if(!e)return void t([]);for(var n=new Array,i=e.getElementsByTagName("SEQUENCE"),r=0;r<i.length;++r){var o=i[r],a=o.getAttribute("id"),l=o.getAttribute("start"),u=o.getAttribute("stop"),c="DNA",h=null;if(o.firstChild){var d=o.firstChild.nodeValue;h="";for(var f=0;;){var p=d.indexOf("\n",f);if(!(p>=0)){h+=d.substring(f).toUpperCase();break}h+=d.substring(f,p).toUpperCase(),f=p+1}}n.push(new s(a,l,u,c,h))}t(n)})},r.prototype.features=function(e,t,n){t=t||{};var i;if(this.features_uri)i=this.features_uri;else{var r=[];if(e)r.push(e.toDASQuery());else if(t.group){var o=t.group;if("string"==typeof o)r.push("group_id="+o);else for(var a=0;a<o.length;++a)r.push("group_id="+o[a])}if(t.adjacent){var s=t.adjacent;"string"==typeof s&&(s=[s]);for(var c=0;c<s.length;++c)r.push("adjacent="+s[c])}if(t.type)if("string"==typeof t.type)r.push("type="+t.type);else for(var h=0;h<t.type.length;++h)r.push("type="+t.type[h]);t.maxbins&&r.push("maxbins="+t.maxbins),r.length>0?i=this.dasBaseURI+"features?"+r.join(";"):n([],"No filters specified")}this.doCrossDomainRequest(i,function(e,t){if(!e){var i;return i=0==t.status?"server may not support CORS":"status="+t.status,void n([],"Failed request: "+i)}for(var r=new Array,o={},a=e.getElementsByTagName("SEGMENT"),s=0;s<a.length;++s){var c=a[s],h=c.getAttribute("id");o[h]={min:c.getAttribute("start"),max:c.getAttribute("stop")};for(var d=c.getElementsByTagName("FEATURE"),f=0;f<d.length;++f){var p=d[f],_=new l;_.segment=h,_.id=p.getAttribute("id"),_.label=p.getAttribute("label");var m=g(p,"START"),b=g(p,"END");(0|m)>(0|b)?(_.min=0|b,_.max=0|m):(_.min=0|m,_.max=0|b);var x=p.getElementsByTagName("TYPE");if(x.length>0){var w=x[0];w.firstChild&&(_.type=w.firstChild.nodeValue),_.typeId=w.getAttribute("id"),_.typeCv=w.getAttribute("cvId")}_.type=g(p,"TYPE"),!_.type&&_.typeId&&(_.type=_.typeId),_.method=g(p,"METHOD");var S=g(p,"ORIENTATION");S||(S="0"),_.orientation=S,_.score=g(p,"SCORE"),_.links=v(p),_.notes=y(p);for(var A=p.getElementsByTagName("GROUP"),k=0;k<A.length;++k){var C=A[k],T=new u;T.type=C.getAttribute("type"),T.id=C.getAttribute("id"),T.links=v(C),T.notes=y(C),_.groups?_.groups.push(T):_.groups=new Array(T)}if(_.notes)for(var E=0;E<_.notes.length;++E){var M=_.notes[E];if(0==M.indexOf("Genename=")){var L=new u;L.type="gene",L.id=M.substring(9),_.groups?_.groups.push(L):_.groups=new Array(L)}}var R=p.getElementsByTagName("PART");if(R.length>0){for(var O=[],P=0;P<R.length;++P)O.push(R[P].getAttribute("id"));_.parts=O}var R=p.getElementsByTagName("PARENT");if(R.length>0){for(var D=[],P=0;P<R.length;++P)D.push(R[P].getAttribute("id"));_.parents=D}r.push(_)}}n(r,void 0,o)},function(e){n([],e)})},r.prototype.alignments=function(e,t,n){var i=this.dasBaseURI+"alignment?query="+e;this.doCrossDomainRequest(i,function(e){if(!e)return void n([],"Failed request "+i);for(var t=[],r=e.getElementsByTagName("alignment"),o=0;o<r.length;++o){for(var a=r[o],s=new h(a.getAttribute("alignType")),l=a.getElementsByTagName("alignObject"),u=0;u<l.length;++u){var c=l[u],d={id:c.getAttribute("intObjectId"),accession:c.getAttribute("dbAccessionId"),version:c.getAttribute("objectVersion"),dbSource:c.getAttribute("dbSource"),dbVersion:c.getAttribute("dbVersion")};s.objects[d.id]=d}for(var f=a.getElementsByTagName("block"),p=0;p<f.length;++p){for(var _=f[p],m={order:_.getAttribute("blockOrder"),segments:[]},v=_.getElementsByTagName("segment"),y=0;y<v.length;++y){var b=v[y],x={object:b.getAttribute("intObjectId"),min:b.getAttribute("start"),max:b.getAttribute("end"),strand:b.getAttribute("strand"),cigar:g(b,"cigar")};m.segments.push(x)}s.blocks.push(m)}t.push(s)}n(t)})},d.prototype.pushStyle=function(e,t,n){e||(e={type:"default"});var i=k(e);t&&(i.zoom=t),i.style=n,this.styles.push(i)},r.prototype.stylesheet=function(e,t){var n,i=this.credentials;this.stylesheet_uri?(n=this.stylesheet_uri,i=!1):n=this.dasBaseURI+"stylesheet",b(n,function(n){if(!n)return void(t&&t());for(var i=new d,r=n.getElementsByTagName("TYPE"),o=0;o<r.length;++o){var a=r[o],s={};s.type=a.getAttribute("id"),s.label=a.getAttribute("label"),s.method=a.getAttribute("method");for(var l=a.getElementsByTagName("GLYPH"),u=0;u<l.length;++u){var c=l[u],h=c.getAttribute("zoom"),_=m(c),g=new f;g.glyph=_.localName;for(var v=_.firstChild;v;)v.nodeType==Node.ELEMENT_NODE&&("BGGRAD"==v.localName?g[v.localName]=p(v):g[v.localName]=v.firstChild.nodeValue),v=v.nextSibling;i.pushStyle(s,h,g)}}e(i)},i)},_.prototype.sources=function(e,t,n){n||(n={});var i=[];n.taxon&&i.push("organism="+n.taxon),n.auth&&i.push("authority="+n.auth),n.version&&i.push("version="+n.version);var a=this.uri;i.length>0&&(a=a+"?"+i.join("&")),b(a,function(n){if(!n&&t)return void t();for(var i=[],a=n.getElementsByTagName("SOURCE"),s=0;s<a.length;++s){var l=a[s],u=l.getElementsByTagName("VERSION");if(!(u.length<1)){for(var c=u[0],h=c.getElementsByTagName("COORDINATES"),d=[],f=0;f<h.length;++f){var p=h[f],_=new o;_.auth=p.getAttribute("authority"),_.taxon=p.getAttribute("taxid"),_.version=p.getAttribute("version"),d.push(_)}for(var g,m=[],v=c.getElementsByTagName("CAPABILITY"),f=0;f<v.length;++f){var y=v[f];if(m.push(y.getAttribute("type")),"das1:features"==y.getAttribute("type")){var b=y.getAttribute("query_uri");g=b.substring(0,b.length-"features".length)}}for(var x={},w=c.getElementsByTagName("PROP"),S=0;S<w.length;++S)C(x,w[S].getAttribute("name"),w[S].getAttribute("value"));if(g){var A=new r(g,{source_uri:l.getAttribute("uri"),name:l.getAttribute("title"),desc:l.getAttribute("description"),coords:d,props:x,capabilities:m});i.push(A)}}}e(i)})},r.prototype.doCrossDomainRequest=function(e,t,n){var i;this.xUser&&(i="Basic "+btoa(this.xUser+":"+this.xPass));try{return b(e,t,this.credentials,i)}catch(r){if(!n)throw r;n(r)}},e.exports={DASGroup:u,DASFeature:l,DASStylesheet:d,DASStyle:f,DASSource:r,DASSegment:i,DASRegistry:_,DASSequence:s,DASLink:c,isDasBooleanTrue:x,isDasBooleanNotFalse:w,copyStylesheet:S,coordsMatch:a}},function(e,t,n){"use strict";function i(e,t,n,i){this.red=0|e,this.green=0|t,this.blue=0|n,i&&(this.name=i)}function r(e){var t="00"+e.toString(16);return t.substring(t.length-2)}function o(e){var t=l[e];if(!t){var n=u.exec(e);n?(t=new i("0x"+n[1]|0,"0x"+n[2]|0,"0x"+n[3]|0,e),l[e]=t):(n=c.exec(e),n?(t=new i(0|n[1],0|n[2],0|n[3],e),l[e]=t):(console.log("couldn't handle color: "+e),t=l.black,l[e]=t))}return t}function a(e,t,n){for(var r=[],a=0;a<n.length;++a)r.push(o(n[a]));var s=[];e:for(var l=0;e>l;++l){for(var u=1*l/(e-1),c=t[0]+(t[t.length-1]-t[0])*u,h=0;h<t.length-1;++h)if(c>=t[h]&&c<=t[h+1]){var d=(c-t[h])/(t[h+1]-t[h]),f=r[h],p=r[h+1],_=new i(f.red*(1-d)+p.red*d|0,f.green*(1-d)+p.green*d|0,f.blue*(1-d)+p.blue*d|0).toSvgString();s.push(_);continue e}throw"Bad step"}return s}function s(e,t,n,i){return i?a(e,[0,.5,1],[t,n,i]):a(e,[0,1],[t,n])}i.prototype.toSvgString=function(){return this.name||(this.name="rgb("+this.red+","+this.green+","+this.blue+")"),this.name},i.prototype.toHexString=function(){return"#"+r(this.red)+r(this.green)+r(this.blue)};var l={red:new i(255,0,0,"red"),green:new i(0,255,0,"green"),blue:new i(0,0,255,"blue"),yellow:new i(255,255,0,"yellow"),white:new i(255,255,255,"white"),black:new i(0,0,0,"black"),gray:new i(180,180,180,"gray"),grey:new i(180,180,180,"grey"),lightskyblue:new i(135,206,250,"lightskyblue"),lightsalmon:new i(255,160,122,"lightsalmon"),hotpink:new i(255,105,180,"hotpink")},u=new RegExp("^#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$"),c=/rgb\(([0-9]+),([0-9]+),([0-9]+)\)/;e.exports={makeColourSteps:a,makeGradient:s,dasColourForName:o}},function(e,t,n){"use strict";function i(e,t,n){this.type=e,this.method=t,this.label=n}function r(e){if(this._filters={},e)for(var t=0;t<e.length;++t)this.add(e[t])}i.prototype.equals=function(e){return this.type==e.type&&this.method==e.method&&this.label==e.label},i.prototype.toString=function(){var e=[];return this.type&&e.push("type="+this.type),this.method&&e.push("method="+this.method),this.label&&e.push("label="+this.label),"StyleFilter<"+e.join(";")+">"},r.prototype.add=function(e){var t=e.toString();this._filters[t]||(this._filters[t]=e,this._list=null)},r.prototype.addAll=function(e){for(var t=e.list(),n=0;n<t.length;++n)this.add(t[n])},r.prototype.doesNotContain=function(e){for(var t=e.list(),n=0;n<t.length;++n)if(!this._filters[n.toString()])return!0;return!1},r.prototype.list=function(){if(!this._list){this._list=[];for(var e in this._filters)this._filters.hasOwnProperty(e)&&this._list.push(this._filters[e])}return this._list},r.prototype.typeList=function(){for(var e=[],t=this.list(),n=0;n<t.length;++n){var i=t[n],r=i.type;if(!r||"default"==r)return null;e.indexOf(r)<0&&e.push(r)}return e},e.exports={StyleFilter:i,StyleFilterSet:r}},function(e,t,n){function i(e){return e.uri?e.uri:e.blob?"file:"+e.blob.name:e.bwgBlob?"file:"+e.bwgBlob.name:e.bamBlob?"file:"+e.bamBlob.name:e.twoBitBlob?"file:"+e.twoBitBlob.name:e.bwgURI||e.bamURI||e.jbURI||e.twoBitURI||"https://www.biodalliance.org/magic/no_uri"}function r(e){return e.stylesheet_uri?e.stylesheet_uri:"sequence"==e.tier_type||e.twoBitURI||e.twoBitBlob?"https://www.biodalliance.org/magic/sequence":i(e)}function o(e,t){if(i(e)!=i(t))return!1;if(e.mapping!=t.mapping)return!1;if(e.tier_type!=t.tier_type)return!1;if(e.overlay){if(!t.overlay||t.overlay.length!=e.overlay.length)return!1;for(var n=0;n<e.overlay.length;++n)if(!o(e.overlay[n],t.overlay[n]))return!1}else if(t.overlay)return!1;return!0}function a(e,t){if(i(e)!=i(t)||r(e)!=r(t))return!1;if(e.mapping!=t.mapping)return!1;if(e.tier_type!=t.tier_type)return!1;if(e.overlay){if(!t.overlay||t.overlay.length!=e.overlay.length)return!1;for(var n=0;n<e.overlay.length;++n)if(!a(e.overlay[n],t.overlay[n]))return!1}else if(t.overlay)return!1;return!0}e.exports={sourcesAreEqual:a,sourcesAreEqualModuloStyle:o,sourceDataURI:i,sourceStyleURI:r}},function(e,t,n){"use strict";var i=n(256).Promise,r=n(265).polyfill;t.Promise=i,t.polyfill=r},function(e,t,n){"use strict";function i(e){if(!g(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof i))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],r(e,this)}function r(e,t){function n(e){u(t,e)}function i(e){h(t,e)}try{e(n,i)}catch(r){i(r)}}function o(e,t,n,i){var r,o,a,s,c=g(n);if(c)try{r=n(i),a=!0}catch(d){s=!0,o=d}else r=i,a=!0;l(t,r)||(c&&a?u(t,r):s?h(t,o):e===k?u(t,r):e===C&&h(t,r))}function a(e,t,n,i){var r=e._subscribers,o=r.length;r[o]=t,r[o+k]=n,r[o+C]=i}function s(e,t){for(var n,i,r=e._subscribers,a=e._detail,s=0;s<r.length;s+=3)n=r[s],i=r[s+t],o(t,n,i,a);e._subscribers=null}function l(e,t){var n,i=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(_(t)&&(i=t.then,g(i)))return i.call(t,function(i){return n?!0:(n=!0,void(t!==i?u(e,i):c(e,i)))},function(t){return n?!0:(n=!0,void h(e,t))}),!0}catch(r){return n?!0:(h(e,r),!0)}return!1}function u(e,t){e===t?c(e,t):l(e,t)||c(e,t)}function c(e,t){e._state===S&&(e._state=A,e._detail=t,p.async(d,e))}function h(e,t){e._state===S&&(e._state=A,e._detail=t,p.async(f,e))}function d(e){s(e,e._state=k)}function f(e){s(e,e._state=C)}var p=n(257).config,_=(n(257).configure,n(258).objectOrFunction),g=n(258).isFunction,m=(n(258).now,n(259).cast),v=n(260).all,y=n(261).race,b=n(262).resolve,x=n(263).reject,w=n(264).asap;p.async=w;var S=void 0,A=0,k=1,C=2;i.prototype={constructor:i,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(e,t){var n=this,i=new this.constructor(function(){});if(this._state){var r=arguments;p.async(function(){o(n._state,i,r[n._state-1],n._detail)})}else a(this,i,e,t);return i},"catch":function(e){return this.then(null,e)}},i.all=v,i.cast=m,i.race=y,i.resolve=b,i.reject=x,t.Promise=i},function(e,t){"use strict";function n(e,t){return 2!==arguments.length?i[e]:void(i[e]=t)}var i={instrument:!1};t.config=i,t.configure=n},function(e,t){"use strict";function n(e){return i(e)||"object"==typeof e&&null!==e}function i(e){return"function"==typeof e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}var o=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=n,t.isFunction=i,t.isArray=r,t.now=o},function(e,t){"use strict";function n(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=this;return new t(function(t){t(e)})}t.cast=n},function(e,t,n){"use strict";function i(e){var t=this;if(!r(e))throw new TypeError("You must pass an array to all.");return new t(function(t,n){function i(e){return function(t){r(e,t)}}function r(e,n){s[e]=n,0===--l&&t(s)}var a,s=[],l=e.length;0===l&&t([]);for(var u=0;u<e.length;u++)a=e[u],a&&o(a.then)?a.then(i(u),n):r(u,a)})}var r=n(258).isArray,o=n(258).isFunction;t.all=i},function(e,t,n){"use strict";function i(e){var t=this;if(!r(e))throw new TypeError("You must pass an array to race.");return new t(function(t,n){for(var i,r=0;r<e.length;r++)i=e[r],i&&"function"==typeof i.then?i.then(t,n):t(i)})}var r=n(258).isArray;t.race=i},function(e,t){"use strict";function n(e){var t=this;return new t(function(t,n){t(e)})}t.resolve=n},function(e,t){"use strict";function n(e){var t=this;return new t(function(t,n){n(e)})}t.reject=n},function(e,t,n){(function(e,n){"use strict";function i(){return function(){n.nextTick(a)}}function r(){var e=0,t=new c(a),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function o(){return function(){h.setTimeout(a,1)}}function a(){for(var e=0;e<d.length;e++){var t=d[e],n=t[0],i=t[1];n(i)}d=[]}function s(e,t){var n=d.push([e,t]);1===n&&l()}var l,u="undefined"!=typeof window?window:{},c=u.MutationObserver||u.WebKitMutationObserver,h="undefined"!=typeof e?e:void 0===this?window:this,d=[];l="undefined"!=typeof n&&"[object process]"==={}.toString.call(n)?i():c?r():o(),t.asap=s}).call(t,function(){return this}(),n(190))},function(e,t,n){(function(e){"use strict";function i(){var t;t="undefined"!=typeof e?e:"undefined"!=typeof window&&window.document?window:self;var n="Promise"in t&&"cast"in t.Promise&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),o(e)}();n||(t.Promise=r)}var r=n(256).Promise,o=n(258).isFunction;t.polyfill=i}).call(t,function(){return this}())},function(e,t,n){"use strict";function i(e){for(var t,n,i,r=e.browser.drawnStart,s=e.browser.drawnEnd,l={},u={},c={},h={},d={},f={},p={},_={},g=[],m=function(){i={};for(var t=0;t<e.currentFeatures.length;++t){var n=e.currentFeatures[t];n.id&&(i[n.id]=n)}},v=function(e){var t=[];if(e.parents)for(var n=0;n<e.parents.length;++n){var r=e.parents[n],o=i[r];o&&"SO:0000704"==o.typeCv&&pushnew(t,r)}return t},y=0;y<e.currentFeatures.length;++y){var b=e.currentFeatures[y];if(!b.parts){var x=b.min<=s&&b.max>=r;if(b.min&&b.max){if(b.score&&"."!=b.score&&"-"!=b.score){var w=1*b.score;(!t||t>w)&&(t=w),(!n||w>n)&&(n=w)}var S=[],A=null;if(b.groups)for(var k=0;k<b.groups.length;++k){var C=b.groups[k],T=C.id;if("gene"==C.type)A=T,f[T]=C;else if("translation"==C.type);else{o(u,T,b),f[T]=C,S.push(T);var E=h[T];(!E||b.min<E)&&(h[T]=b.min),E=d[T],(!E||b.max>E)&&(d[T]=b.max)}}if(b.parents){i||m();for(var M=0;M<b.parents.length;++M){var L=b.parents[M],R=i[L];if(R){R.parts||(R.parts=[b]),a(u,L,R),o(u,L,b),f[L]||(f[L]={type:R.type,id:R.id,label:R.label||R.id}),S.push(L);var E=h[L];(!E||b.min<E)&&(h[L]=b.min),E=d[L],(!E||b.max>E)&&(d[L]=b.max);var O=v(R);if(O.length>0){A=O[0];var P=i[O[0]];f[O[0]]={type:P.type,id:P.id,label:P.label||P.id},e.dasSource.collapseSuperGroups||(e.dasSource.collapseSuperGroups=!0)}}}}if(0==S.length)x&&o(l,b.type,b);else if(A)for(var C=0;C<S.length;++C){var T=S[C];a(p,A,T),_[T]=A}}else g.push(b)}}for(var T in u){var D=f[T];"number"!=typeof D.min&&(D.min=h[T]),"number"!=typeof D.max&&(D.max=d[T]),d[T]>=r&&h[T]<=s&&(c[T]=u[T])}e.ungroupedFeatures=l,e.groupedFeatures=c,e.groups=f,e.superGroups=p,e.groupsToSupers=_,t&&(t>0?t=0:0>n&&(n=0),e.currentFeaturesMinScore=t,e.currentFeaturesMaxScore=n)}var r=n(248),o=r.pusho,a=r.pushnewo;e.exports={sortFeatures:i}},function(e,t,n){"use strict";function i(){this.glyphs=[],this.height=0,this.quant=null}function r(e){0|Date.now();$=e.viewport.getContext("2d"),"number"==typeof e.dasSource.padding?e.padding=e.dasSource.padding:e.padding=Z;var t=[],n=!1,r={},l={};for(var h in e.ungroupedFeatures)for(var d=e.ungroupedFeatures[h],f=0;f<d.length;++f){var p=d[f];if(!p.parts){var _=e.styleForFeature(p);if(_)if("LINEPLOT"==_.glyph)c(r,_.id,p),l[_.id]=_;else{var g=a(p,0,_,e);g&&t.push(g)}}}for(var m in r){var v=r[m],_=l[m];"LINEPLOT"==_.glyph&&(t.push(s(v,_,e)),n=!0)}if(e.dasSource.collapseSuperGroups&&!e.bumped)for(var y in e.superGroups){var b=e.superGroups[y];e.groups[y]=u(e.groups[y]),e.groups[y].isSuperGroup=!0;for(var x={},S=1e10,A=-1e10,k=null,g=0;g<b.length;++g){var v=e.groupedFeatures[b[g]];if(v){for(var C=0;C<v.length;++C){var p=v[C];c(x,p.type,p),S=Math.min(p.min,S),A=Math.max(p.max,A),p.segment&&!k&&(k=p.segment)}(e.groups[y]&&!e.groups[y].links||0==e.groups[y].links.length)&&(e.groups[y].links=e.groups[b[0]].links),delete e.groupedFeatures[b[g]]}}e.groups[y].max=A,e.groups[y].min=S,e.groups[y].segment=k;for(var T in x){for(var E=x[T],M=E[0],L=null,C=0;C<E.length;++C){var p=E[C],R=new q(p.min,p.max);L=L?G(L,R):R}for(var O=L.ranges(),P=0;P<O.length;++P){for(var I=O[P],N=((0|I.max())-(0|I.min())+1)*b.length,F=0,C=0;C<E.length;++C){var p=E[C];if((0|p.min)<=I.max()&&(0|p.max)>=I.min()){var B=Math.max(0|p.min,I.min()),z=Math.min(0|p.max,I.max());F+=z-B+1}}var H=new U;for(var j in M)H[j]=M[j];H.min=I.min(),H.max=I.max(),H.label&&b.length>1&&(H.label+=" ("+b.length+" vars)"),H.visualWeight=1*F/N,c(e.groupedFeatures,y,H)}}delete e.superGroups[y]}var V=new Array;for(var W in e.groupedFeatures)V.push(W);V.sort(function(t,n){var i=e.groupedFeatures[t][0].score-e.groupedFeatures[n][0].score;return i>0?-1:0==i?0:1});for(var X={},K=0;K<V.length;++K){var W=V[K],g=o(e.groupedFeatures[W],0,e.groups[W],e,e.dasSource.collapseSuperGroups&&!e.bumped?"collapsed_gene":"tent");g&&(g.group=e.groups[W],X[W]=g)}for(var y in e.superGroups){for(var b=e.superGroups[y],Y=[],S=1e10,A=-1e10,J=0;J<b.length;++J){var Q=X[b[J]];X[b[J]]=null,Q&&(Y.push(Q),S=Math.min(S,Q.min()),A=Math.max(A,Q.max()))}for(var J=0;J<Y.length;++J){var Q=Y[J];t.push(new w(Q,S,A))}}for(var g in X){var Q=X[g];Q&&t.push(Q)}var ee=new i,te=[],ne=!1,ie=e.subtierMax||e.dasSource.subtierMax||e.browser.defaultSubtierMax,re=!1;e:for(var oe=0;oe<t.length;++oe){var g=t[oe];if(g.bump&&(ne=!0),g.bump&&(e.bumped||e.dasSource.collapseSuperGroups)){for(var ae=0;ae<te.length;++ae){var se=te[ae];if(se.hasSpaceFor(g)){se.add(g);continue e}}if(te.length>=ie)re=!0;else{var se=new i;se.add(g),te.push(se)}}else ee.add(g)}ee.glyphs.length>0&&(te=[ee].concat(te));for(var ae=0;ae<te.length;++ae){var se=te[ae];se.quant&&se.glyphs.unshift(new D(se.height))}for(var ae=0;ae<te.length;++ae){var se=te[ae];se.glyphs.sort(function(e,t){var n=e.zindex||0,i=t.zindex||0;return n-i})}e.subtiers=te,e.glyphCacheOrigin=e.browser.viewStart,re?e.updateStatus("Bumping limit exceeded, use the track editor to see more features"):e.updateStatus()}function o(e,t,n,i,r){for(var o,s=i.styleForFeature(n),l=!1,u=[],c=null,h=0;h<e.length;++h){var d=e[h];d.orientation&&null==c&&(c=d.orientation),!o&&d.label&&(o=d.label);var f=i.styleForFeature(d);if(f&&!d.parts){V(f.LABEL)&&(l=!0);var p=a(d,0,f,i,null,!0);p&&u.push(p)}}if(0==u.length)return null;var g="flat";s&&"LINE"===s.glyph||(i.dasSource.collapseSuperGroups&&!i.bumped?"+"===c?g="collapsed+":"-"===c&&(g="collapsed-"):"+"===c?g="hat+":"-"===c&&(g="hat-"));var v=null;(o&&l||s&&(V(s.LABEL)||V(s.LABELS)))&&(v=n.label||o);var y=new _(u,g);return v&&("+"===c?v=">"+v:"-"===c&&(v="<"+v),y=new m($,y,v,!1)),y.bump=!0,y}function a(e,t,n,i,r,o){function a(e,t,n){var i=null;if(e.currentSequence){var r=0|e.currentSequence.start,o=0|e.currentSequence.end;if(n>=r&&o>=t){var a=Math.max(t,r),s=Math.min(n,o);for(i=e.currentSequence.seq.substr(a-r,s-a+1);a>t;)i="N"+i,a--;for(;n>s;)i+="N",s++}}return i}var s,l,u=i.browser.scale,c=i.browser.viewStart,h=n.glyph||"BOX",d=e.min,f=e.max,g=(e.type,e.orientation),D=e.score,F=e.label||e.id,B=(d-c)*u,H=(f-c+1)*u,q=Math.max(H,B+1),G=i.forceHeight||n.HEIGHT||r||12,j=G=1*G,U=n.BUMP&&V(n.BUMP);if("CROSS"===h||"EX"===h||"TRIANGLE"===h||"DOT"===h||"SQUARE"===h||"STAR"===h||"PLIMSOLL"===h){var K=n.FGCOLOR||"black",Y=n.BGCOLOR||"none",Z=n.STROKECOLOR;if(n.BGITEM&&e.itemRgb)K=e.itemRgb;else if(V(n.COLOR_BY_SCORE2)){var J=n.BGGRAD||n._gradient;J||(J=z(50,n.COLOR1,n.COLOR2,n.COLOR3),n._gradient=J);var Q=e.score2;if(void 0!=Q||!K){Q=Q||0;var ee=n.MIN2?1*n.MIN2:0,te=n.MAX2?1*n.MAX2:1,ne=(1*Q-ee)/(te-ee),ie=ne*J.length|0;0>ie&&(ie=0),ie>=J.length&&(ie=J.length-1),K=J[ie]}}var G=i.forceHeight||n.HEIGHT||r||12;j=G=1*G;var re=n.SIZE||G;n.RSIZE&&(re=1*n.RSIZE*G),n.STROKETHRESHOLD&&re<1*n.STROKETHRESHOLD&&(Z=null),re=1*re;var oe=(B+q)/2,ae=re/2;if("EX"===h)s=new y(oe,re,K);else if("TRIANGLE"===h){var se=n.DIRECTION||"N",le=n.LINEWIDTH||re;s=new b(oe,re,se,le,K,Z)}else if("DOT"===h)s=new x(oe,re,K,Z);else if("PLIMSOLL"===h)s=new N(oe,re,.2*re,K,Z);else if("SQUARE"===h)s=new p(oe-ae,0,re,re,K,Z);else if("STAR"===h){var ue=5;n.POINTS&&(ue=0|n.POINTS),s=new I(oe,ae,ue,K,Z)}else s=new v(oe,re,K);if(Y&&"none"!=Y&&q-B>5){var ce=new p(B,0,q-B,re,Y);s=new _([ce,s])}if(V(n.SCATTER)){var he=i.quantMin(n),de=i.quantMax(n);de||(de=0>he?0:10),he||(he=0);var fe=(1*D-he)/(de-he),pe=-1*he/(de-he);if(0>fe||fe>1)return null;fe>=pe?(G=Math.max(1,(fe-pe)*j),t=t+(1-pe)*j-G):(G=Math.max(1,(fe-pe)*j),t+=(1-pe)*j),l={min:he,max:de};var _e,ge=0;_e="undefined"!=typeof e.forceLabel?e.forceLabel:n.LABEL,W(_e)&&F&&!o&&(s=new m($,s,F,!0,null,"above"==_e?"above":"below"),"above"==_e&&(ge=s.textHeight+2),o=!0),s=new O(s,0,t-ae-ge,j)}}else if("HISTOGRAM"===h||"GRADIENT"===h&&"undefined"!==D){var he=i.quantMin(n),de=i.quantMax(n);de||(de=0>he?0:10),he||(he=0),1*he>1*D&&(D=he),1*D>1*de&&(D=de);var fe=(1*D-he)/(de-he),pe=-1*he/(de-he);"HISTOGRAM"===h&&(fe>=pe?(G=(fe-Math.max(0,pe))*j,t=t+(1-Math.max(0,pe))*j-G):(G=(Math.max(0,pe)-fe)*j,t+=(1-Math.max(0,pe))*j),l={min:he,max:de});var K=n.FGCOLOR||null,Y=n.BGCOLOR||n.COLOR1||"green";n.BGITEM&&e.itemRgb&&(Y=e.itemRgb);var me=n.ALPHA?1*n.ALPHA:null;if(n.BGGRAD){var J=n.BGGRAD,ie=fe*J.length|0;0>ie&&(ie=0),ie>=J.length&&(ie=J.length-1),Y=J[ie]}if(n.COLOR2){var J=n._gradient;J||(J=z(50,n.COLOR1,n.COLOR2,n.COLOR3),n._gradient=J);var ie=fe*J.length|0;0>ie&&(ie=0),ie>=J.length&&(ie=J.length-1),Y=J[ie]}s=new p(B,t,q-B,G,Y,K,me),s=new O(s,0,0,j)}else if("HIDDEN"===h)s=new w(null,B,q),o=!0;else if("ARROW"===h){var ve=n.FGCOLOR||"purple",ye=V(n.PARALLEL),be=V(n.SOUTHWEST),xe=V(n.NORTHEAST);s=new T(B,q,G,ve,ye,be,xe)}else if("ANCHORED_ARROW"===h){var K=n.FGCOLOR||"none",Y=n.BGCOLOR||"green";s=new S(B,q,G,Y,K,g),s.bump=!0}else if("SPAN"===h){var K=n.FGCOLOR||"black";s=new A(B,q,G,K)}else if("LINE"===h){var K=n.FGCOLOR||"black",we=n.STYLE||"solid";s=new k(B,q,G,we,g,K)}else if("PRIMERS"===h){var K=n.FGCOLOR||"black",Y=n.BGCOLOR||"red";s=new C(B,q,G,Y,K)}else if("TEXT"===h){var Se=n.STRING||"text",Y=n.FGCOLOR||"black";s=new M($,B,q,G,Y,Se)}else if("TOOMANY"===h){var K=n.FGCOLOR||"gray",Y=n.BGCOLOR||"orange";s=new E(B,q,G,Y,K)}else if("POINT"===h){var G=i.forceHeight||n.HEIGHT||30,he=i.quantMin(n),de=i.quantMax(n),Ae=1*G/(de-he),fe=(1*D-he)/(de-he),ke=(D-1*he)*Ae|0;l={min:he,max:de};var Y=n.FGCOLOR||n.COLOR1||"black";if(n.COLOR2){var J=n._gradient;J||(J=z(50,n.COLOR1,n.COLOR2,n.COLOR3),n._gradient=J);var ie=fe*J.length|0;0>ie&&(ie=0),ie>=J.length&&(ie=J.length-1),Y=J[ie]}s=new P((B+q)/2,G-ke,G,Y)}else if("__SEQUENCE"===h){var Ce=e.seq,Te=Ce,Ee=e.quals,Me=Ee,Le=V(n.__INSERTIONS),Re=[];if(e.cigar){var Oe=X(e.cigar);Te="",Me="";for(var Pe=0,De=0;De<Oe.length;++De){var Ie=Oe[De];if("M"==Ie.op)Te+=Ce.substr(Pe,Ie.cnt),Me+=Ee.substr(Pe,Ie.cnt),Pe+=Ie.cnt;else if("D"==Ie.op)for(var Ne=0;Ne<Ie.cnt;++Ne)Te+="-",Me+="Z";else if("I"==Ie.op){var Fe=Ce.substr(Pe,Ie.cnt),Be=new b(B+Te.length*u,5,"S",5,i.browser.baseColors.I);Le&&(Be=new m($,Be,Fe,!1,"center","above","7px sans-serif")),Be.feature={label:"Insertion: "+Fe,type:"insertion",method:"insertion"},Re.push(Be),Pe+=Ie.cnt}else"S"==Ie.op?Pe+=Ie.cnt:console.log("unknown cigop"+Ie.op)}}var ze=a(i,d,f);if(Te&&ze&&("mismatch"===n.__SEQCOLOR||"mismatch-all"===n.__SEQCOLOR)){for(var He=[],qe="-"===e.orientation?",":".",Ge=0;Ge<Te.length;++Ge)He.push(Te[Ge]==ze[Ge]?qe:Te[Ge]);Te=He.join("")}var je;je="-"===e.orientation?n._minusColor||"lightskyblue":n._plusColor||"lightsalmon",n.__disableQuals&&(Me=!1),s=new L(i.browser.baseColors,je,B,q,G,Te,ze,n.__SEQCOLOR,Me,!V(n.__CLEARBG)),Le&&(s=new O(s,0,7)),Re.length>0&&(Re.splice(0,0,s),s=new _(Re))}else if("__INSERTION"===h){var Be=new b(B,5,"S",5,i.browser.baseColors.I);if(s=new m($,Be,e.insertion||e.altAlleles[0],!1,"center","above","7px sans-serif"),q-B>1){var Y=n.BGCOLOR||n.COLOR1||"green",Ue=new p(B,5,q-B,G,Y,K);s=new _([Ue,s])}}else{if("__NONE"===h)return null;var K=n.FGCOLOR||null,Y=n.BGCOLOR||n.COLOR1||"green";n.BGITEM&&e.itemRgb&&(Y=e.itemRgb);var u=(q-B)/(f-d);if("translation"==e.type&&("protein_coding"==e.method||e.readframeExplicit)&&(!e.tags||e.tags.indexOf("cds_start_NF")<0||e.readframeExplicit)&&(!i.dasSource.collapseSuperGroups||i.bumped)&&u>=.5){var ze=a(i,d,f);s=new R(B,q,G,Y,ze,e.orientation,e.readframe)}else s=new p(B,0,q-B,G,Y,K)}return(V(n.LABEL)||e.forceLabel)&&F&&!o&&(s=new m($,s,F,!1)),U&&(s.bump=!0),s.feature=e,l&&(s.quant=l),n.ZINDEX&&(s.zindex=0|n.ZINDEX),s}function s(e,t,n){for(var i=n.browser.viewStart,r=n.browser.scale,o=n.forceHeight||t.HEIGHT||30,a=n.quantMin(t),s=n.quantMax(t),l=1*o/(s-a),u=(t.LINEWIDTH||1,t.FGCOLOR||t.COLOR1||"black"),c=[],h=0;h<e.length;++h){var d=e[h],f=(((0|d.min)+(0|d.max))/2-i)*r,p=(d.score-1*a)*l|0,_=o-p;c.push(f),c.push(_)}var m=new g(c,u,o);return m.quant={min:a,max:s},t.ZINDEX&&(m.zindex=0|t.ZINDEX),m}var l=n(248),u=l.shallowCopy,c=l.pusho,h=n(250),d=h.DasTier,f=n(268),p=f.BoxGlyph,_=f.GroupGlyph,g=f.LineGraphGlyph,m=f.LabelledGlyph,v=f.CrossGlyph,y=f.ExGlyph,b=f.TriangleGlyph,x=f.DotGlyph,w=f.PaddedGlyph,S=f.AArrowGlyph,A=f.SpanGlyph,k=f.LineGlyph,C=f.PrimersGlyph,T=f.ArrowGlyph,E=f.TooManyGlyph,M=f.TextGlyph,L=f.SequenceGlyph,R=f.AminoAcidGlyph,O=f.TranslatedGlyph,P=f.PointGlyph,D=f.GridGlyph,I=f.StarGlyph,N=f.PlimsollGlyph,F=f.OverlayLabelCanvas,B=n(252),z=B.makeGradient,H=n(269),q=H.Range,G=H.union,j=n(251),U=j.DASFeature,V=j.isDasBooleanTrue,W=j.isDasBooleanNotFalse,X=n(271).parseCigar,K=n(272),Y=K.formatQuantLabel,Z=3;i.prototype.indexFor=function(e){for(var t=e.min(),n=0,i=this.glyphs.length;i>n;){var r=(n+i)/2|0;if(r>=this.glyphs.length)return this.glyphs.length;var o=this.glyphs[r];t<o.min()?i=r:n=r+1}return i},i.prototype.add=function(e){var t=this.indexFor(e);this.glyphs.splice(t,0,e),this.height=Math.max(this.height,e.height()),e.quant&&null==this.quant&&(this.quant=e.quant)},i.prototype.hasSpaceFor=function(e){var t=this.indexFor(e);return t>0&&this.glyphs[t-1].max()>=e.min()?!1:t<this.glyphs.length&&this.glyphs[t].min()<=e.max()?!1:!0};var $;d.prototype.paint=function(){var e=this.browser.retina&&window.devicePixelRatio>1,t=this.subtiers;if(t){var n=this.browser.featurePanelWidth+2e3;e&&(n*=2);var i=0|this.viewport.width;n-50>i&&(this.viewport.width=i=n);for(var r=this.padding,o=0;o<t.length;++o)r=r+t[o].height+this.padding;r+=6,r=Math.max(r,this.browser.minTierHeight);var a=r;e&&(a*=2),a!=this.viewport.height&&(this.viewport.height=a);Math.max(r,this.browser.minTierHeight);this.viewportHolder.style.left="-1000px",this.viewport.style.width=e?""+i/2+"px":""+i+"px",this.viewport.style.height=""+r+"px",this.layoutHeight=Math.max(r,this.browser.minTierHeight),this.updateHeight(),this.norigin=this.browser.viewStart;var s=this.viewport.getContext("2d");s.clearRect(0,0,i,a),s.save(),e&&s.scale(2,2);var l=this.browser.viewStart-1e3/this.browser.scale,u=this.browser.viewEnd+1e3/this.browser.scale,c=[];if(this.knownCoverage)for(var h=this.knownCoverage.ranges(),d=0;d<h.length;++d){var f=h[d];0==d?f.min()>l&&c.push({min:l,max:f.min()-1}):c.push({min:h[d-1].max()+1,max:f.min()-1}),d==h.length-1&&f.max()<u&&c.push({min:f.max()+1,max:u})}if(c.length>0){s.fillStyle="gray";for(var p=0;p<c.length;++p){var _=c[p],g=(_.min-this.browser.viewStart)*this.browser.scale+1e3,m=(_.max-this.browser.viewStart)*this.browser.scale+1e3;s.fillRect(g,0,m-g,r)}}var v=new F,y=(this.glyphCacheOrigin-this.browser.viewStart)*this.browser.scale+1e3;s.translate(y,this.padding),v.translate(0,this.padding),this.paintToContext(s,v,y),v.glyphs.length>0?this.overlayLabelCanvas=v:this.overlayLabelCanvas=null,s.restore(),this.drawOverlay(),this.paintQuant()}},d.prototype.paintToContext=function(e,t,n){var i=this.subtiers,r=0|this.viewport.width;e.save();for(var o=0;o<i.length;++o){for(var a=null,s=i[o].glyphs,l=0;l<s.length;++l){var u=s[l];if(u.min()<r-n&&u.max()>-n){var u=s[l];u.draw(e,t),u.quant&&(a=u.quant)}}e.translate(0,i[o].height+this.padding),t.translate(0,i[o].height+this.padding)}if(e.restore(),a&&this.quantLeapThreshold&&this.featureSource&&this.browser.sourceAdapterIsCapable(this.featureSource,"quantLeap")){var c=i[0].height*(1-(this.quantLeapThreshold-a.min)/(a.max-a.min));e.save(),e.strokeStyle="red",e.lineWidth=.3,e.beginPath(),e.moveTo(-1e3,c),e.lineTo(r+1e3,c),e.stroke(),e.restore()}},d.prototype.paintQuant=function(){if(this.quantOverlay){
var e,t=this.browser.retina&&window.devicePixelRatio>1;if(this.subtiers&&this.subtiers.length>0&&(e=this.subtiers[0].quant),e){var n=this.subtiers[0].height,i=50;this.quantOverlay.height=this.viewport.height,this.quantOverlay.width=t?2*i:i,this.quantOverlay.style.height=""+(t?this.quantOverlay.height/2:this.quantOverlay.height)+"px",this.quantOverlay.style.width=""+i+"px",this.quantOverlay.style.display="block";var r=this.quantOverlay.getContext("2d");t&&r.scale(2,2);var o=2;n>40&&(o=1+(n/20|0));var a=(n+2*this.padding)/(o-1),s=(e.max-e.min)/(o-1);if(r.fillStyle="white",r.globalAlpha=.6,"right"==this.browser.rulerLocation?r.fillRect(i-30,0,30,n+2*this.padding):r.fillRect(0,0,30,n+2*this.padding),r.globalAlpha=1,r.strokeStyle="black",r.lineWidth=1,r.beginPath(),"right"==this.browser.rulerLocation){r.moveTo(i-8,this.padding),r.lineTo(i,this.padding),r.lineTo(i,n+this.padding),r.lineTo(i-8,n+this.padding);for(var l=1;o-1>l;++l){var u=l*a;r.moveTo(i,u),r.lineTo(i-5,u)}}else{r.moveTo(8,this.padding),r.lineTo(0,this.padding),r.lineTo(0,n+this.padding),r.lineTo(8,n+this.padding);for(var l=1;o-1>l;++l){var u=l*a;r.moveTo(0,u),r.lineTo(5,u)}}if(r.stroke(),r.fillStyle="black","right"==this.browser.rulerLocation){r.textAlign="right",r.fillText(Y(e.max),i-9,8),r.fillText(Y(e.min),i-9,n+this.padding);for(var l=1;o-1>l;++l){var u=l*a;r.fillText(Y(1*e.max-l*s),i-9,u+3)}}else{r.textAlign="left",r.fillText(Y(e.max),9,8),r.fillText(Y(e.min),9,n+this.padding);for(var l=1;o-1>l;++l){var u=l*a;r.fillText(Y(1*e.max-l*s),9,u+3)}}}else this.quantOverlay.style.display="none"}},d.prototype.styleForFeature=function(e){var t=this.browser.zoomForCurrentScale();if(!this.stylesheet)return null;for(var n=null,i=this.stylesheet.styles,r=0;r<i.length;++r){var o=i[r];if(!(o.zoom&&o.zoom!=t||o.orientation&&o.orientation!=e.orientation)){var a=o._labelRE;if(a&&a.test||(a=new RegExp("^"+o.label+"$"),o._labelRE=a),!o.label||a.test(e.label)){var s=o._methodRE;if(s&&s.test||(s=new RegExp("^"+o.method+"$"),o._methodRE=s),!o.method||s.test(e.method)){if(o.type){if("default"==o.type){n||(n=o.style);continue}var l=o._typeRE;if(l&&l.test||(l=new RegExp("^"+o.type+"$"),o._typeRE=l),!l.test(e.type))continue}return o.style}}}}return n},d.prototype.quantMin=function(e){return this.forceMinDynamic?this.currentFeaturesMinScore||0:"number"==typeof this.forceMin?this.forceMin:e.MIN||this.currentFeaturesMinScore||0},d.prototype.quantMax=function(e){return this.forceMaxDynamic?this.currentFeaturesMaxScore||0:"number"==typeof this.forceMax?this.forceMax:e.MAX||this.currentFeaturesMaxScore||0},e.exports={drawFeatureTier:r}},function(e,t,n){"use strict";function i(e,t){this._stroke=e,this._fill=t}function r(e,t,n,i,r,o,a,s){this.x=e,this.y=t,this._width=n,this._height=i,this.fill=r,this.stroke=o,this._alpha=a,this._radius=s||0}function o(e,t){this.glyphs=e,this.connector=t,this.h=e[0].height();for(var n=[],i=0;i<e.length;++i){var r=e[i];n.push(new R(r.min(),r.max())),this.h=Math.max(this.h,r.height())}this.coverage=L(n)}function a(e,t,n){this.points=e,this.color=t,this._height=n||50}function s(e,t,n,i,r,o,a){this.glyph=t,this.text=n,this.anchor=r||"left",this.align=o||"below",a&&(this.font=a),this.font&&(e.save(),e.font=this.font);var s=e.measureText(n);this.font&&e.restore(),this.textLen=s.width,this.textHeight=5,this.bump=t.bump,this.measured=!i}function l(e,t,n){this._x=e,this._height=t,this._stroke=n}function u(e,t,n){this._x=e,this._height=t,this._stroke=n}function c(e,t,n,r,o,a){i.call(this,a,o),this._x=e,this._height=t,this._dir=n,this._width=r}function h(e,t,n,i){this._x=e,this._height=t,this._fill=n,this._stroke=i}function d(e,t,n){this.glyph=e,this._min=t,this._max=n,e&&(this.bump=e.bump)}function f(e,t,n,r,o,a){i.call(this,o,r),this._min=e,this._max=t,this._height=n,this._ori=a}function p(e,t,n,r){i.call(this,r,null),this._min=e,this._max=t,this._height=n}function _(e,t,n,i,r,o){this._min=e,this._max=t,this._height=n,this._style=i,this._strand=r,this._stroke=o}function g(e,t,n,i,r){this._min=e,this._max=t,this._height=n,this._fill=i,this._stroke=r}function m(e,t,n,r,o,a,s){i.call(this,null,r),this._min=e,this._max=t,this._height=n,this._color=r,this._parallel=o,this._sw=a,this._ne=s}function v(e,t,n,i,r){this._min=e,this._max=t,this._height=n,this._fill=i,this._stroke=r}function y(e,t,n,i,r,o){this._min=t,this._max=n,this._height=i,this._fill=r,this._string=o,this._textLen=e.measureText(o).width}function b(e,t,n){var i,r={red:"darkred",purple:"mediumpurple",blue:"darkblue",green:"darkgreen"},o=r[n.toLowerCase()];return i=o?[n,o]:["rgb(73, 68, 149)","rgb(9, 0, 103)"],"?"==e?"black":"M"==e?"greenyellow":"*"==e?"crimson":i[t%2]}function x(e){for(var t={A:"T",T:"A",G:"C",C:"G"},n=e.split("").reverse().join(""),i=[],r=0;r<n.length;++r){var o=n.substr(r,1).toUpperCase();i.push(o in t?t[o]:"N")}return i.join("")}function w(e,t,n,i,r,o,a){this._min=e,this._max=t,this._height=n,this._fill=i,this._seq=r,this._orientation=o,this._readframe=a}function S(e,t,n,i){this.glyph=e,this._height=i,this._x=t,this._y=n}function A(e,t,n,i){this._x=e,this._y=t,this._height=n,this._fill=i}function k(e){this._height=e||50}function C(e,t,n,r,o){i.call(this,o,r),this._x=e,this._r=t,this._points=n}function T(e,t,n,i,r){this._x=e,this._height=t,this._overhang=n,this._fill=i,this._stroke=r,this._hh=t/2}function E(){this.ox=0,this.oy=0,this.glyphs=[]}var M=n(269),L=M.union,R=M.Range,O=n(248),P=O.makeElementNS,D=O.AMINO_ACID_TRANSLATION,I=n(270),N=I.NS_SVG,F=(I.NS_XLINK,I.SVGPath);i.prototype.draw=function(e){e.beginPath(),this.drawPath(e),this._fill&&(e.fillStyle=this._fill,e.fill()),this._stroke&&(e.strokeStyle=this._stroke,e.stroke())},i.prototype.toSVG=function(){var e=new F;return this.drawPath(e),P(N,"path",null,{d:e.toPathData(),fill:this._fill||"none",stroke:this._stroke||"none"})},i.prototype.drawPath=function(e){throw"drawPath method on PathGlyphBase must be overridden"},r.prototype.draw=function(e){var t=this._radius;t>0?(e.beginPath(),e.moveTo(this.x+t,this.y),e.lineTo(this.x+this._width-t,this.y),e.arcTo(this.x+this._width,this.y,this.x+this._width,this.y+t,t),e.lineTo(this.x+this._width,this.y+this._height-t),e.arcTo(this.x+this._width,this.y+this._height,this.x+this._width-t,this.y+this._height,t),e.lineTo(this.x+t,this.y+this._height),e.arcTo(this.x,this.y+this._height,this.x,this.y+this._height-t,t),e.lineTo(this.x,this.y+t),e.arcTo(this.x,this.y,this.x+t,this.y,t),e.closePath(),null!=this._alpha&&(e.save(),e.globalAlpha=this._alpha),this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=.5,e.stroke()),null!=this._alpha&&e.restore()):(null!=this._alpha&&(e.save(),e.globalAlpha=this._alpha),this.fill&&(e.fillStyle=this.fill,e.fillRect(this.x,this.y,this._width,this._height)),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=.5,e.strokeRect(this.x,this.y,this._width,this._height)),null!=this._alpha&&e.restore())},r.prototype.toSVG=function(){var e=P(N,"rect",null,{x:this.x,y:this.y,width:this._width,height:this._height,stroke:this.stroke||"none",strokeWidth:.5,fill:this.fill||"none"});return null!=this._alpha&&e.setAttribute("opacity",this._alpha),e},r.prototype.min=function(){return this.x},r.prototype.max=function(){return this.x+this._width},r.prototype.height=function(){return this.y+this._height},o.prototype.drawConnectors=function(e){for(var t=this.coverage.ranges(),n=1;n<t.length;++n){var i=t[n],r=t[n-1];if(r&&i.min()>r.max()){var o=r.max(),a=i.min(),s=(o+a)/2;"hat+"===this.connector?(e.moveTo(o,this.h/2),e.lineTo(s,0),e.lineTo(a,this.h/2)):"hat-"===this.connector?(e.moveTo(o,this.h/2),e.lineTo(s,this.h),e.lineTo(a,this.h/2)):"collapsed+"===this.connector?(e.moveTo(o,this.h/2),e.lineTo(a,this.h/2),a-o>4&&(e.moveTo(s-2,this.h/2-3),e.lineTo(s+2,this.h/2),e.lineTo(s-2,this.h/2+3))):"collapsed-"===this.connector?(e.moveTo(o,this.h/2),e.lineTo(a,this.h/2),a-o>4&&(e.moveTo(s+2,this.h/2-3),e.lineTo(s-2,this.h/2),e.lineTo(s+2,this.h/2+3))):(e.moveTo(o,this.h/2),e.lineTo(a,this.h/2))}r=i}},o.prototype.draw=function(e,t){for(var n=0;n<this.glyphs.length;++n){var i=this.glyphs[n];i.draw(e,t)}e.strokeStyle="black",e.beginPath(),this.drawConnectors(e),e.stroke()},o.prototype.toSVG=function(){for(var e=P(N,"g"),t=0;t<this.glyphs.length;++t)e.appendChild(this.glyphs[t].toSVG());var n=new F;this.drawConnectors(n);var i=n.toPathData();if(i.length>0){var r=P(N,"path",null,{d:n.toPathData(),fill:"none",stroke:"black",strokeWidth:.5});e.appendChild(r)}return e},o.prototype.min=function(){return this.coverage.min()},o.prototype.max=function(){return this.coverage.max()},o.prototype.height=function(){return this.h},a.prototype.min=function(){return this.points[0]},a.prototype.max=function(){return this.points[this.points.length-2]},a.prototype.height=function(){return this._height},a.prototype.draw=function(e){e.save(),e.strokeStyle=this.color,e.lineWidth=2,e.beginPath();for(var t=0;t<this.points.length;t+=2){var n=this.points[t],i=this.points[t+1];0==t?e.moveTo(n,i):e.lineTo(n,i)}e.stroke(),e.restore()},a.prototype.toSVG=function(){for(var e=new F,t=0;t<this.points.length;t+=2){var n=this.points[t],i=this.points[t+1];0==t?e.moveTo(n,i):e.lineTo(n,i)}return P(N,"path",null,{d:e.toPathData(),fill:"none",stroke:this.color,strokeWidth:"2px"})},s.prototype.toSVG=function(){var e=this.glyph.toSVG(),t={};return"above"==this.align?(e=P(N,"g",e,{transform:"translate(0, "+(2|this.textHeight)+")"}),t.y=this.textHeight):t.y=this.glyph.height()+15,this.font&&(t.fontSize=7),"center"==this.anchor?t.x=(this.glyph.min()+this.glyph.max()-this.textLen)/2:t.x=this.glyph.min(),P(N,"g",[e,P(N,"text",this.text,t)])},s.prototype.min=function(){return this.glyph.min()},s.prototype.max=function(){return this.measured?Math.max(this.glyph.max(),1*this.glyph.min()+this.textLen+10):this.glyph.max()},s.prototype.height=function(){var e=this.glyph.height();return this.measured&&(e+="above"==this.align?this.textHeight+2:20),e},s.prototype.draw=function(e,t){"above"==this.align&&(e.save(),e.translate(0,this.textHeight+2)),this.glyph.draw(e),"above"==this.align&&e.restore(),t.registerGlyph(this)},s.prototype.drawOverlay=function(e,t,n){e.fillStyle="black",this.font&&(e.save(),e.font=this.font);var i;"center"==this.anchor?i=(this.glyph.min()+this.glyph.max()-this.textLen)/2:(i=this.glyph.min(),t>i&&(i=Math.min(t,this.glyph.max()-this.textLen))),e.fillText(this.text,i,"above"==this.align?this.textHeight:this.glyph.height()+15),this.font&&e.restore()},l.prototype.draw=function(e){var t=this._height/2;e.beginPath(),e.moveTo(this._x,0),e.lineTo(this._x,this._height),e.moveTo(this._x-t,t),e.lineTo(this._x+t,t),e.strokeStyle=this._stroke,e.lineWidth=1,e.stroke()},l.prototype.toSVG=function(){var e=this._height/2,t=new F;return t.moveTo(this._x,0),t.lineTo(this._x,this._height),t.moveTo(this._x-e,e),t.lineTo(this._x+e,e),P(N,"path",null,{d:t.toPathData(),fill:"none",stroke:this._stroke,strokeWidth:"1px"})},l.prototype.min=function(){return this._x-this._height/2},l.prototype.max=function(){return this._x+this._height/2},l.prototype.height=function(){return this._height},u.prototype.draw=function(e){var t=this._height/2;e.beginPath(),e.moveTo(this._x-t,0),e.lineTo(this._x+t,this._height),e.moveTo(this._x-t,this._height),e.lineTo(this._x+t,0),e.strokeStyle=this._stroke,e.lineWidth=1,e.stroke()},u.prototype.toSVG=function(){var e=this._height/2,t=new F;return t.moveTo(this._x-e,0),t.lineTo(this._x+e,this._height),t.moveTo(this._x-e,this._height),t.lineTo(this._x+e,0),P(N,"path",null,{d:t.toPathData(),fill:"none",stroke:this._stroke,strokeWidth:"1px"})},u.prototype.min=function(){return this._x-this._height/2},u.prototype.max=function(){return this._x+this._height/2},u.prototype.height=function(){return this._height},c.prototype=Object.create(i.prototype),c.prototype.drawPath=function(e){var t=this._height/2,n=this._width/2;"S"===this._dir?(e.moveTo(this._x,this._height),e.lineTo(this._x-n,0),e.lineTo(this._x+n,0)):"W"===this._dir?(e.moveTo(this._x+n,t),e.lineTo(this._x-n,0),e.lineTo(this._x-n,this._height)):"E"===this._dir?(e.moveTo(this._x-n,t),e.lineTo(this._x+n,0),e.lineTo(this._x+n,this._height)):(e.moveTo(this._x,0),e.lineTo(this._x+n,this._height),e.lineTo(this._x-n,this._height)),e.closePath()},c.prototype.min=function(){return this._x-this._height/2},c.prototype.max=function(){return this._x+this._height/2},c.prototype.height=function(){return this._height},h.prototype.draw=function(e){var t=this._height/2;e.fillStyle=this._stroke,e.beginPath(),e.arc(this._x,t,t,0,6.29),this._fill&&(e.fillStyle=this._fill,e.fill()),this._stroke&&(e.strokeStyle=this._stroke,e.stroke())},h.prototype.toSVG=function(){var e=this._height/2;return P(N,"circle",null,{cx:this._x,cy:e,r:e,fill:this._fill||"none",stroke:this._stroke||"none",strokeWidth:"1px"})},h.prototype.min=function(){return this._x-this._height/2},h.prototype.max=function(){return this._x+this._height/2},h.prototype.height=function(){return this._height},d.prototype.draw=function(e,t){this.glyph&&this.glyph.draw(e,t)},d.prototype.toSVG=function(){return this.glyph?this.glyph.toSVG():P(N,"g")},d.prototype.min=function(){return this._min},d.prototype.max=function(){return this._max},d.prototype.height=function(){return this.glyph?this.glyph.height():1},f.prototype=Object.create(i.prototype),f.prototype.min=function(){return this._min},f.prototype.max=function(){return this._max},f.prototype.height=function(){return this._height},f.prototype.drawPath=function(e){var t=this._max,n=this._min,i=this._height,r=0,o=0,a=this._height+2,s=.333333*this._height,l=0;this._ori&&("+"===this._ori?o=.5*this._height:"-"===this._ori&&(r=.5*this._height)),a>t-n&&(n=(t+n-a)/2,t=n+a),e.moveTo(n+r,l+s),e.lineTo(t-o,l+s),e.lineTo(t-o,l),e.lineTo(t,l+this._height/2),e.lineTo(t-o,l+i),e.lineTo(t-o,l+s+s),e.lineTo(n+r,l+s+s),e.lineTo(n+r,l+i),e.lineTo(n,l+i/2),e.lineTo(n+r,l),e.lineTo(n+r,l+s)},p.prototype=Object.create(i.prototype),p.prototype.min=function(){return this._min},p.prototype.max=function(){return this._max},p.prototype.height=function(){return this._height},p.prototype.drawPath=function(e){var t=this._min,n=this._max,i=this._height,r=i/2;e.moveTo(t,r),e.lineTo(n,r),e.moveTo(t,0),e.lineTo(t,i),e.moveTo(n,0),e.lineTo(n,i)},_.prototype.min=function(){return this._min},_.prototype.max=function(){return this._max},_.prototype.height=function(){return this._height},_.prototype.drawPath=function(e){var t=this._min,n=this._max,i=this._height,r=i/2;"hat"===this._style?(e.moveTo(t,r),e.lineTo((t+n)/2,"-"===this._strand?i:0),e.lineTo(n,r)):(e.moveTo(t,r),e.lineTo(n,r))},_.prototype.draw=function(e){e.beginPath(),this.drawPath(e),e.strokeStyle=this._stroke,"dashed"===this._style&&e.setLineDash?(e.save(),e.setLineDash([3]),e.stroke(),e.restore()):e.stroke()},_.prototype.toSVG=function(){var e=new F;this.drawPath(e);var t={d:e.toPathData(),stroke:this._stroke||"none"};return"dashed"===this._style&&(t.strokeDasharray="3"),P(N,"path",null,t)},g.prototype.min=function(){return this._min},g.prototype.max=function(){return this._max},g.prototype.height=function(){return this._height},g.prototype.drawStemPath=function(e){var t=this._min,n=this._max,i=this._height,r=i/2;e.moveTo(t,r),e.lineTo(n,r)},g.prototype.drawTrigsPath=function(e){var t=this._min,n=this._max,i=this._height,r=i/2;e.moveTo(t,0),e.lineTo(t+i,r),e.lineTo(t,i),e.lineTo(t,0),e.moveTo(n,0),e.lineTo(n-i,r),e.lineTo(n,i),e.lineTo(n,0)},g.prototype.draw=function(e){e.beginPath(),this.drawStemPath(e),e.strokeStyle=this._stroke,e.stroke(),e.beginPath(),this.drawTrigsPath(e),e.fillStyle=this._fill,e.fill()},g.prototype.toSVG=function(){var e=new F;this.drawStemPath(e);var t=new F;return this.drawTrigsPath(t),P(N,"g",[P(N,"path",null,{d:e.toPathData(),stroke:this._stroke||"none"}),P(N,"path",null,{d:t.toPathData(),fill:this._fill||"none"})])},m.prototype=Object.create(i.prototype),m.prototype.min=function(){return this._min},m.prototype.max=function(){return this._max},m.prototype.height=function(){return this._height},m.prototype.drawPath=function(e){var t=this._min,n=this._max,i=this._height;if(this._parallel){var r=i/2,o=.4*i;this._sw?(e.moveTo(t+r,i-o),e.lineTo(t+r,i),e.lineTo(t,r),e.lineTo(t+r,0),e.lineTo(t+r,o)):(e.moveTo(t,i-o),e.lineTo(t,o)),this._ne?(e.lineTo(n-r,o),e.lineTo(n-r,0),e.lineTo(n,r),e.lineTo(n-r,i),e.lineTo(n-r,i-o)):(e.lineTo(n,o),e.lineTo(n,i-o)),e.closePath()}else{var a=(t+n)/2,o=.4*(n-t),s=i/3;this._ne?(e.moveTo(t+o,s),e.lineTo(t,s),e.lineTo(a,0),e.lineTo(n,s),e.lineTo(n-o,s)):(e.moveTo(t+o,0),e.lineTo(n-o,0)),this._sw?(e.lineTo(n-o,i-s),e.lineTo(n,i-s),e.lineTo(a,i),e.lineTo(t,i-s),e.lineTo(t+o,i-s)):(e.lineTo(n-o,i),e.lineTo(t+o,i)),e.closePath()}},v.prototype.min=function(){return this._min},v.prototype.max=function(){return this._max},v.prototype.height=function(){return this._height},v.prototype.toSVG=function(){return P(N,"rect",null,{x:this._min,y:0,width:this._max-this._min,height:this._height,stroke:this._stroke||"none",fill:this._fill||"none"})},v.prototype.draw=function(e){if(this._fill&&(e.fillStyle=this._fill,e.fillRect(this._min,0,this._max-this._min,this._height)),this._stroke){e.strokeStyle=this._stroke,e.strokeRect(this._min,0,this._max-this._min,this._height),e.beginPath();for(var t=2;t<this._height;t+=3)e.moveTo(this._min,t),e.lineTo(this._max,t);e.stroke()}},y.prototype.min=function(){return this._min},y.prototype.max=function(){return Math.max(this._max,this._min+this._textLen)},y.prototype.height=function(){return this._height},y.prototype.draw=function(e){e.fillStyle=this._fill,e.fillText(this._string,this._min,this._height-4)},y.prototype.toSVG=function(){return P(N,"text",this._string,{x:this._min,y:this._height-4})},w.prototype.min=function(){return this._min},w.prototype.max=function(){return this._max},w.prototype.height=function(){return this._height},w.prototype.draw=function(e){var t=this._seq,n=this._fill;if(t){var i=(this._max-this._min+1)/t.length,r=(3-this._readframe)%3,o=(t.length-r)%3,a="+"==this._orientation?r:o;a>0&&(e.fillStyle=n,e.fillRect(this._min,0,i*a,this._height));for(var s=a;s<t.length;s+=3){var l=t.substr(s,3).toUpperCase();"-"==this._orientation&&(l=x(l));var u=l in D?D[l]:"?";n=3==l.length?b(u,s,this._fill):this._fill,e.fillStyle=n,e.fillRect(this._min+s*i,0,i*l.length,this._height),i>=8&&3==l.length&&(e.fillStyle="white",e.fillText(u,this._min+(s+1)*i,this._height))}}},w.prototype.toSVG=function(){var e=P(N,"g"),t=this._seq,n=this._fill;if(!t)return e;var i=(this._max-this._min+1)/t.length,r=(3-this._readframe)%3,o=(t.length-r)%3,a="+"==this._orientation?r:o;a>0&&e.appendChild(P(N,"rect",null,{x:this._min,y:0,width:i*a,height:this._height,fill:n}));for(var s=a;s<t.length;s+=3){var l=t.substr(s,3).toUpperCase();"-"==this._orientation&&(l=x(l));var u=l in D?D[l]:"?";n=3==l.length?b(u,s,this._fill):this._fill,e.appendChild(P(N,"rect",null,{x:this._min+s*i,y:0,width:i*l.length,height:this._height,fill:n})),i>=8&&3==l.length&&e.appendChild(P(N,"text",u,{x:this._min+(s+1)*i,y:this._height,fill:"white"}))}return e},function(e){function t(e,t,n,i,r,o,a,s,l,u){this.baseColors=e,this._strandColor=t,this._min=n,this._max=i,this._height=r,this._seq=o,this._ref=a,this._scheme=s,this._quals=l,this._fillbg=u}var n=window.devicePixelRatio>1,i={},r=new RegExp("^[ACGT-]$"),o=function(e){return e>=8};t.prototype.min=function(){return this._min},t.prototype.max=function(){return this._max},t.prototype.height=function(){return this._height},t.prototype.alphaForQual=function(e){return.1+.9*Math.max(0,Math.min(1*e/30,1))},t.prototype.draw=function(e){var t=this._seq,a=this._ref,s="mismatch"===this._scheme||"mismatch-all"===this._scheme,l="mismatch-all"===this._scheme,u=t?t.length:this._max-this._min+1,c=(this._max-this._min+1)/u;s&&!o(c)&&(e.fillStyle=this._strandColor,e.fillRect(this._min,this._height/4,this._max-this._min,this._height/2));for(var h=0;u>h;++h){var d=t?t.substr(h,1).toUpperCase():"N";if(r.test(d)||o(c)){var f=this.baseColors[d];if(this._quals){var p=this._quals.charCodeAt(h)-33,_=e.globalAlpha;e.globalAlpha=this.alphaForQual(p)}if(!f){var g=a?a.substr(h,1).toUpperCase():"N";f="N"==d||"N"==g?"gray":this._strandColor,l&&(d=g)}e.fillStyle=f;var m=r.test(d);if(!this._fillbg&&o(c)&&m||e.fillRect(this._min+h*c,0,c,this._height),o(c)&&m){var v=f+"_"+d,y=i[v];if(!y){y=document.createElement("canvas"),n?(y.width=16,y.height=20):(y.width=8,y.height=10);var b=y.getContext("2d");n&&b.scale(2,2),b.fillStyle=this._fillbg?"black":f;var x=b.measureText(d).width;b.fillText(d,.5*(8-x),8),i[v]=y}n?e.drawImage(y,this._min+h*c+.5*(c-8),0,8,10):e.drawImage(y,this._min+h*c+.5*(c-8),0)}this._quals&&(e.globalAlpha=_)}}},t.prototype.toSVG=function(){for(var e=this._seq,t=this._ref,n=("mismatch"===this._scheme||"mismatch-all"===this._scheme,"mismatch-all"===this._scheme),i=(this._max-this._min+1)/this._seq.length,a=P(N,"g"),s=0;s<e.length;++s){var l=e?e.substr(s,1).toUpperCase():"N",u=this.baseColors[l];if(!u){var c=t?t.substr(s,1).toUpperCase():"N";u="N"==l||"N"==c?"gray":this._strandColor,n&&(l=c)}var h=1;if(this._quals){var d=this._quals.charCodeAt(s)-33;h=this.alphaForQual(d)}var f=r.test(l);!this._fillbg&&o(i)&&f||a.appendChild(P(N,"rect",null,{x:this._min+s*i,y:0,width:i,height:this._height,fill:u,fillOpacity:h})),o(i)&&f&&a.appendChild(P(N,"text",l,{x:this._min+(.5+s)*i,y:8,textAnchor:"middle",fill:this._fillbg?"black":u,fillOpacity:h}))}return a},e.SequenceGlyph=t}(this),S.prototype.height=function(){return this._height?this._height:this.glyph.height()+this._y},S.prototype.min=function(){return this.glyph.min()+this._x},S.prototype.max=function(){return this.glyph.max()+this._x},S.prototype.minY=function(){return this._y},S.prototype.maxY=function(){return this._y+this.glyph.height()},S.prototype.draw=function(e,t){e.save(),e.translate(this._x,this._y),this.glyph.draw(e,t),e.restore()},S.prototype.toSVG=function(){var e=this.glyph.toSVG();return e.setAttribute("transform","translate("+this._x+","+this._y+")"),e},A.prototype.min=function(){return this._x-2},A.prototype.max=function(){return this._x+2},A.prototype.height=function(){return this._height},A.prototype.draw=function(e){e.save(),e.globalAlpha=.3,e.fillStyle=this._fill,e.beginPath(),e.arc(this._x,this._y,1.5,0,6.29),e.fill(),e.restore()},A.prototype.toSVG=function(){return P(N,"circle",null,{cx:this._x,cy:this._y,r:2,fill:this._fill,stroke:"none"})},k.prototype.notSelectable=!0,k.prototype.min=function(){return-1e5},k.prototype.max=function(){return 1e5},k.prototype.height=function(){return this._height},k.prototype.draw=function(e){e.save(),e.strokeStyle="black",e.lineWidth=.1,e.beginPath();for(var t=0;t<=this._height;t+=10)e.moveTo(-5e3,t),e.lineTo(5e3,t);e.stroke(),e.restore()},k.prototype.toSVG=function(){for(var e=new F,t=0;t<=this._height;t+=10)e.moveTo(-5e3,t),e.lineTo(5e3,t);return P(N,"path",null,{d:e.toPathData(),fill:"none",stroke:"black",strokeWidth:"0.1px"})},C.prototype=Object.create(i.prototype),C.prototype.min=function(){return this._x-this._r},C.prototype.max=function(){return this._x+this._r},C.prototype.height=function(){return 2*this._r},C.prototype.drawPath=function(e){for(var t=this._x,n=this._r,i=this._r,r=0;r<this._points;++r){var o=6.28*r/this._points,a=t+i*Math.sin(o),s=n-i*Math.cos(o);0==r?e.moveTo(a,s):e.lineTo(a,s),o=6.28*(r+.5)/this._points,a=t+.4*i*Math.sin(o),s=n-.4*i*Math.cos(o),e.lineTo(a,s)}e.closePath()},T.prototype.draw=function(e){var t=this._height/2;e.fillStyle=this._stroke,e.beginPath(),e.arc(this._x,t,t-this._overhang,0,6.29),e.moveTo(this._x,0),e.lineTo(this._x,this._height),this._fill&&(e.fillStyle=this._fill,e.fill()),this._stroke&&(e.strokeStyle=this._stroke,e.stroke())},T.prototype.toSVG=function(){var e=this._hh;return P(N,"g",[P(N,"circle",null,{cx:this._x,cy:e,r:e-this._overhang}),P(N,"line",null,{x1:this._x,y1:0,x2:this._x,y2:this._height})],{fill:this._fill||"none",stroke:this._stroke||"none",strokeWidth:"1px"})},T.prototype.min=function(){return this._x-this._hh},T.prototype.max=function(){return this._x+this._hh},T.prototype.height=function(){return this._height},E.prototype.translate=function(e,t){this.ox+=e,this.oy+=t},E.prototype.registerGlyph=function(e){this.glyphs.push({x:this.ox,y:this.oy,glyph:e})},E.prototype.draw=function(e,t,n){for(var i=0;i<this.glyphs.length;++i){var r=this.glyphs[i];e.save(),e.translate(r.x,r.y),r.glyph.drawOverlay(e,t,n),e.restore()}},e.exports={BoxGlyph:r,GroupGlyph:o,LineGraphGlyph:a,LabelledGlyph:s,CrossGlyph:l,ExGlyph:u,TriangleGlyph:c,DotGlyph:h,PaddedGlyph:d,AArrowGlyph:f,SpanGlyph:p,LineGlyph:_,PrimersGlyph:g,ArrowGlyph:m,TooManyGlyph:v,TextGlyph:y,SequenceGlyph:this.SequenceGlyph,AminoAcidGlyph:w,TranslatedGlyph:S,GridGlyph:k,StarGlyph:C,PointGlyph:A,PlimsollGlyph:T,OverlayLabelCanvas:E}},function(e,t,n){"use strict";function i(e,t){if("number"!=typeof e||"number"!=typeof t)throw"Bad range "+e+","+t;this._min=e,this._max=t}function r(e){this._ranges=e}function o(e,t){if(e instanceof Array||(e=[e],t&&e.push(t)),0==e.length)return null;if(1==e.length)return e[0];for(var n=[],o=0;o<e.length;++o)e[o]._pushRanges(n);n=n.sort(u);var a=[],s=n[0];s=new i(s._min,s._max);for(var l=1;l<n.length;++l){var c=n[l];c._min>s._max+1?(a.push(s),s=new i(c._min,c._max)):c._max>s._max&&(s._max=c._max)}return a.push(s),1==a.length?a[0]:new r(a)}function a(e,t){for(var n=e.ranges(),o=t.ranges(),a=n.length,s=o.length,l=0,u=0,c=[];a>l&&s>u;){var e=n[l],t=o[u],h=Math.max(e.min(),t.min()),d=Math.min(e.max(),t.max());d>=h&&c.push(new i(h,d)),e.max()>t.max()?++u:++l}return 0==c.length?null:1==c.length?c[0]:new r(c)}function s(e){for(var t=0,n=e.ranges(),i=0;i<n.length;++i){var r=n[i];t+=r.max()-r.min()+1}return t}function l(e,t){return e.min()<t.min()?-1:e.min()>t.min()?1:e.max()<t.max()?-1:t.max()>e.max()?1:0}function u(e,t){return e._min<t._min?-1:e._min>t._min?1:e._max<t._max?-1:t._max>e._max?1:0}i.prototype.min=function(){return this._min},i.prototype.max=function(){return this._max},i.prototype.contains=function(e){return e>=this._min&&e<=this._max},i.prototype.isContiguous=function(){return!0},i.prototype.ranges=function(){return[this]},i.prototype._pushRanges=function(e){e.push(this)},i.prototype.toString=function(){return"["+this._min+"-"+this._max+"]"},r.prototype.min=function(){return this._ranges[0].min()},r.prototype.max=function(){return this._ranges[this._ranges.length-1].max()},r.prototype.contains=function(e){for(var t=0;t<this._ranges.length;++t)if(this._ranges[t].contains(e))return!0;return!1},r.prototype.isContiguous=function(){return this._ranges.length>1},r.prototype.ranges=function(){return this._ranges},r.prototype._pushRanges=function(e){for(var t=0;t<this._ranges.length;++t)e.push(this._ranges[t])},r.prototype.toString=function(){for(var e="",t=0;t<this._ranges.length;++t)t>0&&(e+=","),e+=this._ranges[t].toString();return e},e.exports={Range:i,union:o,intersection:a,coverage:s,rangeOver:l,_rangeOrder:u}},function(e,t,n){function i(){this.ops=[]}var r="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xlink";i.prototype.moveTo=function(e,t){this.ops.push("M "+e+" "+t)},i.prototype.lineTo=function(e,t){this.ops.push("L "+e+" "+t)},i.prototype.closePath=function(){this.ops.push("Z")},i.prototype.toPathData=function(){return this.ops.join(" ")},e.exports={NS_SVG:r,NS_XLINK:o,SVGPath:i}},function(e,t,n){function i(e){for(var t,n=[];null!=(t=r.exec(e));){var i=t[1];0==i.length&&(i=1),n.push({cnt:0|i,op:t[2]})}return n}var r=new RegExp("([0-9]*)([MIDS])","g");e.exports={parseCigar:i}},function(e,t,n){function i(e){return(0|e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function r(e){var t=""+e,n=t.indexOf(".");if(0>n)return t;var i=2;return"-"==t.substring(0,1)&&++i,n>=i?t.substring(0,n):t.substring(0,n+2)}e.exports={formatLongInt:i,formatQuantLabel:r}},function(e,t,n){"use strict";function i(e,t){function n(e){return p[e%p.length]*Math.pow(10,e/p.length|0)}t||(t=f);for(var i=p.length;e*n(i)<t;)++i;return n(i)}function r(e,t){var n=e.viewport.getContext("2d"),i=e.browser.retina&&window.devicePixelRatio>1,r=e.browser.featurePanelWidth+2e3;i&&(r*=2);var a=0|e.viewport.width;r-50>a&&(e.viewport.width=a=r);var s=50;t&&t.seq&&(s+=25);var l=s;i&&(l*=2),e.viewport.height=l,e.viewport.style.height=""+s+"px",e.viewport.style.width=i?""+a/2+"px":""+a+"px",e.layoutHeight=s,e.updateHeight(),e.background&&(n.fillStyle=e.background,n.fillRect(0,0,a,e.viewport.height)),i&&n.scale(2,2),n.translate(1e3,0),o(e,t,n),e.norigin=e.browser.viewStart,e.viewportHolder.style.left="-1000px"}function o(e,t,n){var r=e.browser.scale,o=e.browser.viewStart-1e3/r|0,a=e.browser.viewEnd+2e3/r,s=e.browser.currentSeqMax,u=a;s>0&&a>s&&(u=s);for(var c=i(r),h=Math.max(0,(o/c|0)*c),d=e.browser.viewStart;u>=h;)n.fillStyle=h/c%2==0?"white":"black",n.strokeStyle="black",n.fillRect((h-d)*r,8,c*r,3),n.strokeRect((h-d)*r,8,c*r,3),n.fillStyle="black",n.fillText(l(h),(h-d)*r,22),h+=c;if(t&&t.seq)for(var f=o;a>=f;++f)if(f>=t.start&&f<=t.end){var p=t.seq.substr(f-t.start,1).toUpperCase(),_=e.browser.baseColors[p];if(_||(_="gray"),n.fillStyle=_,r>=8){var g=n.measureText(p).width;n.fillText(p,(f-d)*r+.5*(r-g),52)}else n.fillRect((f-d)*r,42,r,12)}}function a(e,t){var n=e.browser.scale,r=e.browser.viewStart-1e3/n|0,o=e.browser.viewEnd+2e3/n,a=e.browser.currentSeqMax,s=(0|e.viewport.width,o);a>0&&o>a&&(s=a);for(var c=i(n),d=Math.max(0,(r/c|0)*c),f=e.browser.viewStart,p=u(h,"g",[],{fontSize:"8pt"});s>=d;)p.appendChild(u(h,"rect",null,{x:(d-f)*n,y:8,width:c*n,height:3,fill:d/c%2==0?"white":"black",stroke:"black"})),p.appendChild(u(h,"text",l(d),{x:(d-f)*n,y:28,fill:"black",stroke:"none"})),d+=c;if(t&&t.seq)for(var _=r;o>=_;++_)if(_>=t.start&&_<=t.end){var g=t.seq.substr(_-t.start,1).toUpperCase(),m=e.browser.baseColors[g];m||(m="gray"),n>=8?p.appendChild(u(h,"text",g,{x:(.5+_-f)*n,y:52,textAnchor:"middle",fill:m})):p.appendChild(u(h,"rect",null,{x:(_-f)*n,y:42,width:n,height:12,fill:m}))}return p}var s=n(248),l=s.formatLongInt,u=s.makeElementNS,c=n(270),h=c.NS_SVG,d=(c.NS_XLINK,c.SVGPath,n(272)),l=d.formatLongInt,f=100,p=[1,2,5],h="http://www.w3.org/2000/svg";e.exports={drawSeqTier:r,drawSeqTierGC:o,svgSeqTier:a}},function(e,t,n){"use strict";function i(e){this.genomes={},this.url=e}function r(){}function o(e){this.hub=e}function a(e,t,n){n=n||{},n.salt=!0,u(e,function(r,a){if(a)return t(null,a);var s=r.split(g),l=new i(e);n.credentials&&(l.credentials=n.credentials);for(var h=0;h<s.length-2;h+=3)l[s[h+1]]=s[h+2];if(l.genomesFile){var d=c(e,l.genomesFile);u(d,function(e,i){if(i)return t(null,i);for(var r=e.split(_),a=0;a<r.length;++a){var s=r[a].split(g),u=new o(l);n.credentials&&(u.credentials=n.credentials);for(var h=0;h<s.length-2;h+=3)u[s[h+1]]=s[h+2];u.twoBitPath&&(u.twoBitPath=c(d,u.twoBitPath)),u.genome&&u.trackDb&&(u.absURL=c(d,u.trackDb),l.genomes[u.genome]=u)}t(l)},n)}else t(null,"No genomesFile")},n)}function s(e,t){return e.priority&&t.priority?1*e.priority-1*t.priority:e.priority?1:t.priority?-1:e.shortLabel.localeCompare(t.shortLabel)}var l=n(248),u=l.textXHR,c=l.relativeURL,h=l.shallowCopy,d=n(251),f=d.DASStylesheet,p=d.DASStyle,_=/\n\s*\n/,g=/(\w+) +(.+)\n?/,m=/subGroup[1-9]/,v="http://genome.ucsc.edu/images/";r.prototype.get=function(e){return this[e]?this[e]:this._parent?this._parent.get(e):void 0},o.prototype.getTracks=function(e){var t=this;return this._tracks?e(this._tracks):void u(this.absURL,function(n,i){if(i)return e(null,i);n=n.replace("\\\n"," ");for(var o=[],a={},s=n.split(_),l=0;l<s.length;++l){var u=s[l].replace(/\#.*/g,"").split(g),c=new r;c._db=t;for(var h=0;h<u.length-2;h+=3){var d=u[h+1],f=u[h+2];if(d.match(m)){c.subgroups||(c.subgroups={});for(var p=f.split(/\s/),v=p[0],y={name:p[1],tags:[],titles:[]},b=2;b<p.length;++b){var x=p[b].split(/=/);y.tags.push(x[0]),y.titles.push(x[1])}c.subgroups[v]=y}else if("subGroups"===d){var p=f.split(/(\w+)=(\w+)/);c.sgm={};for(var b=0;b<p.length-2;b+=3)c.sgm[p[b+1]]=p[b+2]}else c[u[h+1]]=u[h+2]}c.track&&(c.type||c.container||c.view||c.bigDataUrl)&&(o.push(c),a[c.track]=c)}for(var w=[],S=[],A=0;A<o.length;++A){
var c=o[A],k=!0;if(c.parent){var C=c.parent.split(/\s+/),T=a[C[0]];T?(c._parent=T,T.children||(T.children=[]),T.children.push(c),T&&(k=!1)):console.log("Couldn't find parent "+C[0]+"("+c.parent+")")}c.compositeTrack?S.push(c):k&&w.push(c)}for(var E=0;E<S.length;++E){var M=S[E];if(M.children){for(var L=!1,R=0;R<M.children.length;++R){var d=M.children[R];d.view&&(d.shortLabel=M.shortLabel+": "+d.shortLabel,w.push(d),L=!0)}L||w.push(M)}}return t._tracks=w,e(t._tracks,null)},{credentials:this.credentials,salt:!0})},r.prototype.toDallianceSource=function(){var e={name:this.shortLabel,desc:this.longLabel};this._db.mapping&&(e.mapping=this._db.mapping);var t=this.get("pennantIcon");if(t){var n=t.split(/\s+/);e.pennant=v+n[0]}var i=this.get("searchTrix");if(i&&(e.trixURI=c(this._db.absURL,i)),"multiWig"==this.container){e.merge="concat",e.overlay=[];var r=this.children||[];e.style=[],e.noDownsample=!0;for(var o=0;o<r.length;++o){var a=r[o],s=a.toDallianceSource();if(e.overlay.push(s),s.style)for(var l=0;l<s.style.length;++l){var u=s.style[l];u.method=a.shortLabel,"transparentOverlay"==this.aggregate&&(u.style.ALPHA=.5),e.style.push(u)}}return e}var h=this.type;if(!h){for(var d=this;d._parent&&!d.type;)d=d._parent;h=d.type}if(h){var f=h.split(/\s+/);if("bigBed"==f[0]&&this.bigDataUrl){var p=0|f[1],_="+"==f[2];return e.bwgURI=c(this._db.absURL,this.bigDataUrl),e.style=this.bigbedStyles(),this._db.credentials&&(e.credentials=!0),p>=12&&_&&(e.collapseSuperGroups=!0),e}return"bigWig"==f[0]&&this.bigDataUrl?(e.bwgURI=c(this._db.absURL,this.bigDataUrl),e.style=this.bigwigStyles(),e.noDownsample=!0,this.yLineOnOff&&"on"==this.yLineOnOff&&(e.quantLeapThreshold=void 0!==this.yLineMark?1*this.yLineMark:0),this._db.credentials&&(e.credentials=!0),e):"bam"==f[0]&&this.bigDataUrl?(e.bamURI=c(this._db.absURL,this.bigDataUrl),this._db.credentials&&(e.credentials=!0),e):"vcfTabix"==f[0]&&this.bigDataUrl?(e.uri=c(this._db.absURL,this.bigDataUrl),e.tier_type="tabix",e.payload="vcf",this._db.credentials&&(e.credentials=!0),e):void console.log("Unsupported "+this.type)}},r.prototype.bigwigStyles=function(){var e=this.type;if(!e){for(var t=this;t._parent&&!t.type;)t=t._parent;e=t.type}if(e){var n,i,r=e.split(/\s+/);r.length>=3&&(n=1*r[1],i=1*r[2]);var o;if(this.maxHeightPixels){var a=this.maxHeightPixels.split(/:/);3==a.length?o=0|a[1]:console.log("maxHeightPixels should be of the form max:default:min")}var s="bars";this.graphTypeDefault&&(s=this.graphTypeDefault);var l="black",u=null;this.color&&(l="rgb("+this.color+")"),this.altColor&&(u="rgb("+this.altColor+")");var c=new f,h=new p;return"points"==s?h.glyph="POINT":h.glyph="HISTOGRAM",u?(h.COLOR1=l,h.COLOR2=u):h.BGCOLOR=l,h.HEIGHT=o||30,(n||i)&&(h.MIN=n,h.MAX=i),c.pushStyle({type:"default"},null,h),c.styles}},r.prototype.bigbedStyles=function(){var e="on"==(""+this.get("itemRgb")).toLowerCase(),t=this.get("visibility")||"full",n=this.get("color");n=n?"rgb("+n+")":"blue";var i=new f,r=new p;r.glyph="BOX",r.FGCOLOR="black",r.BGCOLOR=n,r.HEIGHT="full"==t||"pack"==t?12:8,r.BUMP="full"==t||"pack"==t,r.LABEL="full"==t||"pack"==t,r.ZINDEX=20,e&&(r.BGITEM=!0);var o=this.get("colorByStrand");if(o){var a=o.split(/\s+/),s=h(r);s.BGCOLOR="rgb("+a[0]+")",i.pushStyle({type:"bigwig",orientation:"+"},null,s);var l=h(r);l.BGCOLOR="rgb("+a[1]+")",i.pushStyle({type:"bigwig",orientation:"-"},null,l)}else i.pushStyle({type:"bigwig"},null,r);var u=new p;u.glyph="BOX",u.FGCOLOR="black",e&&(u.BGITEM=!0),u.BGCOLOR="red",u.HEIGHT=10,u.BUMP=!0,u.ZINDEX=20,i.pushStyle({type:"translation"},null,u);var c=new p;return c.glyph="BOX",c.FGCOLOR="black",c.BGCOLOR="white",c.HEIGHT=10,c.ZINDEX=10,c.BUMP=!0,c.LABEL=!0,i.pushStyle({type:"transcript"},null,c),i.styles},e.exports={connectTrackHub:a,THUB_COMPARE:s}},function(e,t,n){"use strict";var i={CONFIG:5,MAJOR:0,MINOR:13,MICRO:5,PATCH:"",BRANCH:"dev"};i.toString=function(){var e=""+this.MAJOR+"."+this.MINOR+"."+this.MICRO;return this.PATCH&&(e+=this.PATCH),this.BRANCH&&""!=this.BRANCH&&(e=e+"-"+this.BRANCH),e},e.exports=i},function(e,t,n){"use strict";function i(e,t,n,i){"string"==typeof e?(this.uri=e,this.srcTag=t,this.destTag=n,this.coords=i):(this.uri=e.uri,this.srcTag=e.srcTag,this.destTag=e.destTag,this.coords=_(e.coords),this.type=e.type,this.credentials=e.credentials),this.chainsBySrc={},this.chainsByDest={},this.postFetchQueues={},this.fetchedTiles={},this.granularity=1e6,"bigbed"==this.type?this.chainFetcher=new o(this.uri,this.credentials):"alias"==this.type?this.chainFetcher=new u(e):this.chainFetcher=new r(this.uri,this.srcTag,this.destTag)}function r(e,t,n){this.source=new h(e),this.srcTag=t,this.destTag=n}function o(e,t){var n=this;this.uri=e,this.credentials=t,this.bwg=new x(function(e,t){b(new v(n.uri,{credentials:n.credentials}),function(n,i){n?e(n):t(i)})}),this.bwg.then(function(e,t){t&&console.log(t)})}function a(e){return parseInt(e)}function s(e){return 0==e.indexOf("chr")?e.substr(3):e}function l(e){for(var t={srcChr:s(e.srcChrom),srcMin:parseInt(e.srcStart),srcMax:parseInt(e.srcEnd),srcOri:e.srcOri,destChr:s(e.segment),destMin:e.min-1,destMax:e.max,destOri:e.ori,blocks:[]},n=e.srcStarts.split(",").map(a),i=e.destStarts.split(",").map(a),r=e.blockLens.split(",").map(a),o=0;o<n.length;++o)t.blocks.push([n[o],i[o],r[o]]);return t}function u(e){this.conf=e,this.forwardAliases={};for(var t=e.sequenceAliases||[],n=0;n<t.length;++n){var i=t[n];if(!(i.length<2)){for(var r=[],o=0;o<i.length-1;++o)r.push(i[o]);this.forwardAliases[i[i.length-1]]=r}}}var c=n(251),h=c.DASSource,d=c.DASSegment,f=n(248),p=f.pusho,_=f.shallowCopy,g=n(271).parseCigar,m=n(277),v=m.URLFetchable,y=n(278),b=y.makeBwg,x=n(255).Promise;i.prototype.exportConfig=function(){return{uri:this.uri,srcTag:this.srcTag,destTag:this.destTag,coords:this.coords,type:this.type,credentials:this.credentials}},i.prototype.mapPoint=function(e,t){for(var n=this.chainsBySrc[e]||[],i=0;i<n.length;++i){var r=n[i];if(t>=r.srcMin&&t<=r.srcMax){var o;o="-"==r.srcOri?r.srcMax-t:t-r.srcMin;for(var a=r.blocks,s=0;s<a.length;++s){var l=a[s],u=l[0],c=l[1],h=l[2];if(o>=u&&u+h>=o){var d,f=o-u;return d="-"==r.destOri?r.destMax-c-f:f+c+r.destMin,{seq:r.destChr,pos:d,flipped:r.srcOri!=r.destOri}}}}}return null},i.prototype.mapSegment=function(e,t,n){for(var i=this.chainsBySrc[e]||[],r=[],o=0;o<i.length;++o){var a=i[o];if(n>=a.srcMin&&t<=a.srcMax){var s,l;"-"==a.srcOri?(s=a.srcMax-n,l=a.srcMax-t):(s=t-a.srcMin,l=n-a.srcMin);for(var u=a.blocks,c=0;c<u.length;++c){var h=u[c],d=h[0],f=h[1],p=h[2];if(l>=d&&d+p>=s){var _={segment:a.destChr,flipped:"-"==a.srcOri^"-"==a.destOri};"-"==a.destOri?(s>=d?_.max=a.destMax-f-s+d:(_.max=a.destMax-f,_.partialMax=d-s),d+p>=l?_.min=a.destMax-f-l+d:(_.min=a.destMax-f-p,_.partialMin=l-d-p)):(s>=d?_.min=a.destMin+f+s-d:(_.min=a.destMin+f,_.partialMin=d-s),d+p>=l?_.max=a.destMin+f+l-d:(_.max=a.destMin+f+p,_.partialMax=l-d-p)),r.push(_)}}}}return r},i.prototype.unmapPoint=function(e,t){for(var n=this.chainsByDest[e]||[],i=0;i<n.length;++i){var r=n[i];if(t>=r.destMin&&t<=r.destMax){var o;o="-"==r.srcOri?r.destMax-t:t-r.destMin;for(var a=r.blocks,s=0;s<a.length;++s){var l=a[s],u=l[0],c=l[1],h=l[2];if(o>=c&&c+h>=o){var d,f=o-c,d=f+u+r.srcMin;return d="-"==r.destOri?r.srcMax-u-f:f+u+r.srcMin,{seq:r.srcChr,pos:d,flipped:r.srcOri!=r.destOri}}}}}return null},i.prototype.sourceBlocksForRange=function(e,t,n,i){for(var r=1,o=2,a=this,s=t/this.granularity|0,l=n/this.granularity|0,u=!1,c=!1,h=s;l>=h;++h){var f=e+"_"+h;this.fetchedTiles[f]!=o&&(u=!0,this.fetchedTiles[f]!=r&&(this.fetchedTiles[f]=r,c=!0))}if(u)this.postFetchQueues[e]||this.chainFetcher.fetchChains(e,s*this.granularity,(l+1)*this.granularity-1).then(function(t){a.chainsByDest||(a.chainsByDest[e]=[]);for(var n=0;n<t.length;++n){var i=t[n],r=a.chainsBySrc[i.srcChr];if(r){for(var u=!1,c=0;c<r.length;++c){var h=r[c];if(h.srcMin==i.srcMin&&h.srcMax==i.srcMax){u=!0;break}}u||r.push(i)}else a.chainsBySrc[i.srcChr]=[i];var d=a.chainsByDest[i.destChr];if(d){for(var u=!1,c=0;c<d.length;++c){var h=d[c];if(h.destMin==i.destMin&&h.destMax==i.destMax){u=!0;break}}u||d.push(i)}else a.chainsByDest[i.destChr]=[i]}for(var f=s;l>=f;++f){var p=e+"_"+f;a.fetchedTiles[p]=o}if(a.postFetchQueues[e]){for(var _=a.postFetchQueues[e],g=0;g<_.length;++g)_[g]();a.postFetchQueues[e]=null}})["catch"](function(e){console.log(e)}),p(this.postFetchQueues,e,function(){a.sourceBlocksForRange(e,t,n,i)});else{for(var _=[],g=this.chainsByDest[e]||[],m=0;m<g.length;++m){var v=g[m];if(t<=v.destMax&&n>=v.destMin){var y,b;"-"==v.srcOri?(y=v.destMax-n,b=v.destMax-t):(y=t-v.destMin,b=n-v.destMin);for(var x=v.blocks,w=0;w<x.length;++w){var S=x[w],A=S[0],k=S[1],C=S[2];if(b>=k&&k+C>=y){var T=Math.max(y,k)-k,E=Math.min(b,k+C)-k;"-"==v.destOri?_.push(new d(v.srcChr,v.srcMax-A-E,v.srcMax-A-T)):_.push(new d(v.srcChr,v.srcMin+T+A,v.srcMin+E+A))}}}}i(_)}},r.prototype.fetchChains=function(e,t,n){var i=this;return new x(function(t,n){i.source.alignments(e,{},function(e){for(var n=[],r=0;r<e.length;++r)for(var o=e[r],a=0;a<o.blocks.length;++a){for(var s,l,u=o.blocks[a],c=0;c<u.segments.length;++c){var h=u.segments[c],d=o.objects[h.object];d.dbSource===i.srcTag?s=h:d.dbSource===i.destTag&&(l=h)}if(s&&l){for(var f={srcChr:o.objects[s.object].accession,srcMin:0|s.min,srcMax:0|s.max,srcOri:s.strand,destChr:o.objects[l.object].accession,destMin:0|l.min,destMax:0|l.max,destOri:l.strand,blocks:[]},p=g(s.cigar),_=g(l.cigar),m=0,v=0,y=0,b=0;y<p.length&&b<_.length;)if("M"==p[y].op&&"M"==_[b].op){var x=Math.min(p[y].cnt,_[b].cnt);f.blocks.push([m,v,x]),p[y].cnt==x?++y:p[y].cnt-=x,_[b].cnt==x?++b:_[b]-=x,m+=x,v+=x}else"I"==p[y].op?v+=p[y++].cnt:"I"==_[b].op&&(m+=_[b++].cnt);n.push(f)}}t(n)})})},o.prototype.fetchChains=function(e,t,n){return this.bwg.then(function(i,r){if(!i)throw Error("No BWG");return new x(function(r,o){i.getUnzoomedView().readWigData(e,t,n,function(e){r(e.map(l))})})})},u.prototype.fetchChains=function(e,t,n){for(var i=[],r=this.forwardAliases[e]||[],o=0;o<r.length;++o)i.push({srcChr:r[o],srcMin:1,srcMax:1e9,srcOri:"+",destChr:e,destMin:1,destMax:1e9,destOri:"+",blocks:[[1,1,1e9]]});return x.resolve(i)},e.exports={Chainset:i}},function(e,t,n){"use strict";function i(e){this.blob=e}function r(e,t,n,i){i||("object"==typeof t?(i=t,t=void 0):i={}),this.url=e,this.start=t||0,n&&(this.end=n),this.opts=i}function o(e){if(!e)return null;for(var t=new Uint8Array(e.length),n=0;n<t.length;++n)t[n]=e.charCodeAt(n);return t.buffer}function a(e,t){return e[t+7]<<24|e[t+6]<<16|e[t+5]<<8|e[t+4]}function s(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function l(e,t){return e[t+1]<<8|e[t]}function u(e,t){return e[t]}function c(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}var h=n(248),d=h.shallowCopy,f=n(249),p=f.b64_sha1;i.prototype.slice=function(e,t){var n;return n=this.blob.slice?t?this.blob.slice(e,e+t):this.blob.slice(e):t?this.blob.webkitSlice(e,e+t):this.blob.webkitSlice(e),new i(n)},i.prototype.salted=function(){return this},"undefined"!=typeof FileReader?i.prototype.fetch=function(e){var t=new FileReader;t.onloadend=function(n){e(o(t.result))},t.readAsBinaryString(this.blob)}:i.prototype.fetch=function(e){var t=new FileReaderSync;try{var n=t.readAsArrayBuffer(this.blob);e(n)}catch(i){e(null,i)}},r.prototype.slice=function(e,t){if(0>e)throw"Bad slice "+e;var n=this.start,i=this.end;return n&&e?n+=e:n=e||n,i=t&&n?n+t-1:i||t-1,new r(this.url,n,i,this.opts)};var _=0,g=navigator.userAgent.indexOf("Safari")>=0&&navigator.userAgent.indexOf("Chrome")<0;r.prototype.fetchAsText=function(e){try{var t,n=new XMLHttpRequest,i=this.url;if((g||this.opts.salt)&&i.indexOf("?")<0&&(i=i+"?salt="+p(""+Date.now()+","+ ++_)),n.open("GET",i,!0),this.end){if(this.end-this.start>1e8)throw"Monster fetch!";n.setRequestHeader("Range","bytes="+this.start+"-"+this.end),t=this.end-this.start+1}n.onreadystatechange=function(){return 4==n.readyState?e(200==n.status||206==n.status?n.responseText:null):void 0},this.opts.credentials&&(n.withCredentials=!0),n.send("")}catch(r){return e(null)}},r.prototype.salted=function(){var e=d(this.opts);return e.salt=!0,new r(this.url,this.start,this.end,e)},r.prototype.fetch=function(e,t){var n=this;t=t||{};var i=t.attempt||1,r=t.truncatedLength;if(i>3)return e(null);try{var a;t.timeout&&!this.opts.credentials&&(a=setTimeout(function(){return console.log("timing out "+u),l.abort(),e(null,"Timeout")},t.timeout));var s,l=new XMLHttpRequest,u=this.url;if((g||this.opts.salt)&&u.indexOf("?")<0&&(u=u+"?salt="+p(""+Date.now()+","+ ++_)),l.open("GET",u,!0),l.overrideMimeType("text/plain; charset=x-user-defined"),this.end){if(this.end-this.start>1e8)throw"Monster fetch!";l.setRequestHeader("Range","bytes="+this.start+"-"+this.end),s=this.end-this.start+1}l.responseType="arraybuffer",l.onreadystatechange=function(){if(4==l.readyState){if(a&&clearTimeout(a),200==l.status||206==l.status){if(l.response){var t=l.response.byteLength;return!s||s==t||r&&t==r?e(l.response):n.fetch(e,{attempt:i+1,truncatedLength:t})}if(l.mozResponseArrayBuffer)return e(l.mozResponseArrayBuffer);var u=l.responseText;return!s||s==u.length||r&&u.length==r?e(o(l.responseText)):n.fetch(e,{attempt:i+1,truncatedLength:u.length})}return n.fetch(e,{attempt:i+1})}},this.opts.credentials&&(l.withCredentials=!0),l.send("")}catch(c){return e(null)}},function(e){var t=new ArrayBuffer(8),n=new Uint8Array(t),i=new Float32Array(t);e.readFloat=function(e,t){return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],i[0]}}(this),e.exports={BlobFetchable:i,URLFetchable:r,readInt:s,readIntBE:c,readInt64:a,readShort:l,readByte:u,readFloat:this.readFloat}},function(e,t,n){"use strict";function i(e,t){var n=e[t]+e[t+1]*M+e[t+2]*L+e[t+3]*R+e[t+4]*O;return n}function r(){}function o(e,t,n,i){this.bwg=e,this.cirTreeOffset=t,this.cirTreeLength=n,this.isSummary=i}function a(e,t,n){var o=new r;o.data=e,o.name=n,o.data.slice(0,512).salted().fetch(function(e){if(!e)return t(null,"Couldn't fetch file");var n=e,r=new Uint8Array(n),a=new Int16Array(n),s=new Int32Array(n),l=r[0]+M*r[1]+L*r[2]+R*r[3];if(l==w)o.type="bigwig";else{if(l!=A)return l==S||l==k?t(null,"Currently don't support big-endian BBI files"):t(null,"Not a supported format, magic=0x"+l.toString(16));o.type="bigbed"}o.version=a[2],o.numZoomLevels=a[3],o.chromTreeOffset=i(r,8),o.unzoomedDataOffset=i(r,16),o.unzoomedIndexOffset=i(r,24),o.fieldCount=a[16],o.definedFieldCount=a[17],o.asOffset=i(r,36),o.totalSummaryOffset=i(r,44),o.uncompressBufSize=s[13],o.extHeaderOffset=i(r,56),o.zoomLevels=[];for(var u=0;u<o.numZoomLevels;++u){var c=s[6*u+16],h=i(r,24*u+72),d=i(r,24*u+80);o.zoomLevels.push({reduction:c,dataOffset:h,indexOffset:d})}o.readChromTree(function(){o.getAutoSQL(function(e){return o.schema=e,t(o)})})},{timeout:5e3})}function s(e,t,n,i,r){this.bbi=e,this.type=t,this.fieldCount=n,this.offset=i,this.field=r}var l=n(269),u=l.Range,c=l.union,h=l.intersection,d=n(251),f=d.DASFeature,p=d.DASGroup,_=n(248),g=_.shallowCopy,m=n(277),v=m.readInt,y=n(279),b=y.inflateBuffer,x=y.arrayCopy,w=2291137574,S=654086024,A=2273964779,k=3958540679,C=1,T=2,E=3,M=256,L=65536,R=16777216,O=4294967296,P=new RegExp("^[0-9]+,[0-9]+,[0-9]+");r.prototype.readChromTree=function(e){var t=this;this.chromsToIDs={},this.idsToChroms={},this.maxID=0;var n=this.unzoomedDataOffset,r=n-this.chromTreeOffset&3;n=n+4-r,this.data.slice(this.chromTreeOffset,n-this.chromTreeOffset).fetch(function(n){var r=new Uint8Array(n),o=new Int16Array(n),a=new Int32Array(n),s=(a[0],a[1],a[2]),l=(a[3],i(r,16),32),u=function(e){var n=r[e],a=o[e/2+1];e+=4;for(var l=0;a>l;++l)if(0==n){e+=s;var c=i(r,e);e+=8,c-=t.chromTreeOffset,u(c)}else{for(var h="",d=0;s>d;++d){var f=r[e++];0!=f&&(h+=String.fromCharCode(f))}var p=r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e+0];r[e+7]<<24|r[e+6]<<16|r[e+5]<<8|r[e+4];e+=8,t.chromsToIDs[h]=p,0==h.indexOf("chr")&&(t.chromsToIDs[h.substr(3)]=p),t.idsToChroms[p]=h,t.maxID=Math.max(t.maxID,p)}};u(l),e(t)})},o.prototype.readWigData=function(e,t,n,i){var r=this.bwg.chromsToIDs[e];return void 0===r?i([]):void this.readWigDataById(r,t,n,i)},o.prototype.readWigDataById=function(e,t,n,r){var o=this;if(!this.cirHeader)return void this.bwg.data.slice(this.cirTreeOffset,48).fetch(function(i){o.cirHeader=i;var a=new Int32Array(o.cirHeader);o.cirBlockSize=a[1],o.readWigDataById(e,t,n,r)});var a=[],s=0,l=(Date.now(),function(i,r,o,a){return(0>e||i==e)&&n>=r&&o>=t}),h=function(e,t){if(o.bwg.instrument&&console.log("level="+t+"; offset="+e+"; time="+(0|Date.now())),s+=e.length,1==e.length&&e[0]-o.cirTreeOffset==48&&o.cachedCirRoot)return f(o.cachedCirRoot,0,t),--s,void(0==s&&o.fetchFeatures(l,a,r));for(var n,i=4+32*o.cirBlockSize,h=0;h<e.length;++h){var p=new u(e[h],e[h]+i);n=n?c(n,p):p}for(var _=n.ranges(),g=0;g<_.length;++g){var m=_[g];d(e,m,t)}},d=function(e,t,n,i){t.max()-t.min();o.bwg.data.slice(t.min(),t.max()-t.min()).fetch(function(i){for(var u=0;u<e.length;++u)t.contains(e[u])&&(f(i,e[u]-t.min(),n),e[u]-o.cirTreeOffset==48&&e[u]-t.min()==0&&(o.cachedCirRoot=i),--s,0==s&&o.fetchFeatures(l,a,r))})},f=function(r,o,s){var l=new Uint8Array(r),u=new Int16Array(r),c=new Int32Array(r),d=l[o],f=u[o/2+1];if(o+=4,0!=d)for(var p=0;f>p;++p){var _=o/4,g=c[_],m=c[_+1],v=c[_+2],y=c[_+3],b=i(l,o+16),x=i(l,o+24);(0>e||e>g||g==e&&n>=m)&&(0>e||v>e||v==e&&y>=t)&&a.push({offset:b,size:x}),o+=32}else{for(var w=[],p=0;f>p;++p){var _=o/4,g=c[_],m=c[_+1],v=c[_+2],y=c[_+3],b=i(l,o+16);(0>e||e>g||g==e&&n>=m)&&(0>e||v>e||v==e&&y>=t)&&w.push(b),o+=24}w.length>0&&h(w,s+1)}};h([o.cirTreeOffset+48],1)},o.prototype.fetchFeatures=function(e,t,n){var i=this;if(t.sort(function(e,t){return(0|e.offset)-(0|t.offset)}),0==t.length)n([]);else{var r=[],o=function(e,t,n,o){o||(o={});var a=new f;a._chromId=e,a.segment=i.bwg.idsToChroms[e],a.min=t,a.max=n,a.type="bigwig";for(var s in o)a[s]=o[s];r.push(a)},a=function(){if(0==t.length){Date.now();return void n(r)}var s=t[0];if(s.data)i.parseFeatures(s.data,o,e),t.splice(0,1),a();else{for(var l=s.offset,u=s.size,c=1;c<t.length&&t[c].offset==l+u;)u+=t[c].size,++c;i.bwg.data.slice(l,u).fetch(function(e){for(var n=0,r=0;u>n;){var o,s=t[r];if(i.bwg.uncompressBufSize>0)o=b(e,n+2,s.size-2);else{var l=new Uint8Array(s.size);x(new Uint8Array(e,n,s.size),0,l,0,s.size),o=l.buffer}s.data=o,n+=s.size,++r}a()})}};a()}},o.prototype.parseFeatures=function(e,t,n){var i=new Uint8Array(e);if(this.isSummary)for(var r=new Int16Array(e),o=new Int32Array(e),a=new Float32Array(e),s=e.byteLength/32,l=0;s>l;++l){var d=o[8*l],f=o[8*l+1],_=o[8*l+2],m=o[8*l+3],v=(a[8*l+4],a[8*l+5]),y=a[8*l+6];a[8*l+7];if(n(d,f+1,_)){var b={type:"bigwig",score:y/m,maxScore:v};"bigbed"==this.bwg.type&&(b.type="density"),t(d,f+1,_,b)}}else if("bigwig"==this.bwg.type){var r=new Int16Array(e),o=new Int32Array(e),a=new Float32Array(e),d=o[0],x=o[1],w=(o[2],o[3]),S=o[4],A=i[20],s=r[11];if(A==E)for(var l=0;s>l;++l){var k=a[l+6],M=x+l*w+1,L=x+l*w+S;n(d,M,L)&&t(d,M,L,{score:k})}else if(A==T)for(var l=0;s>l;++l){var f=o[2*l+6]+1,_=f+S-1,k=a[2*l+7];n(d,f,_)&&t(d,f,_,{score:k})}else if(A==C)for(var l=0;s>l;++l){var f=o[3*l+6]+1,_=o[3*l+7],k=a[3*l+8];f>_&&(f=_),n(d,f,_)&&t(d,f,_,{score:k})}else console.log("Currently not handling bwgType="+A)}else{if("bigbed"!=this.bwg.type)throw Error("Don't know what to do with "+this.bwg.type);for(var R=0,O=this.bwg.definedFieldCount,D=this.bwg.schema;R<i.length;){var d=i[R+3]<<24|i[R+2]<<16|i[R+1]<<8|i[R+0],f=i[R+7]<<24|i[R+6]<<16|i[R+5]<<8|i[R+4],_=i[R+11]<<24|i[R+10]<<16|i[R+9]<<8|i[R+8];R+=12;for(var I="";;){var N=i[R++];if(0==N)break;I+=String.fromCharCode(N)}var F,B={};if(F=I.length>0?I.split("	"):[],F.length>0&&O>3&&(B.label=F[0]),F.length>1&&O>4){var k=parseInt(F[1]);isNaN(k)||(B.score=k)}if(F.length>2&&O>5&&(B.orientation=F[2]),F.length>5&&O>8){var z=F[5];P.test(z)&&(B.itemRgb="rgb("+z+")")}if(F.length>O-3&&D)for(var H=O-3;H<F.length;++H)B[D.fields[H+3].name]=F[H];if(n(d,f+1,_,F))if(12>O)t(d,f+1,_,B);else{var q=0|F[3],G=0|F[4],j=0|F[6],U=F[7].split(","),V=F[8].split(",");if(B.exonFrames){var W=B.exonFrames.split(",");B.exonFrames=void 0}B.type="transcript";var X=new p;for(var K in B)X[K]=B[K];if(X.id=F[0],X.segment=this.bwg.idsToChroms[d],X.min=f+1,X.max=_,X.notes=[],B.groups=[X],F.length>9){var Y=B.geneName||F[9],Z=Y;F.length>10&&(Z=F[10]),B.geneName2&&(Z=B.geneName2);var $=g(X);$.id=Y,$.label=Z,$.type="gene",B.groups.push($)}for(var J=[],Q=0;j>Q;++Q){var ee=(0|V[Q])+f,te=ee+(0|U[Q]),ne=new u(ee,te);J.push(ne)}for(var ie=c(J),re=ie.ranges(),oe=0;oe<re.length;++oe){var ae=re[oe];t(d,ae.min()+1,ae.max(),B)}if(G>q){var se="+"==B.orientation?new u(q,G+3):new u(q-3,G),le=h(ie,se);if(le){B.type="translation";for(var ue=le.ranges(),ce=0,he=0;ue[0].min()>re[he].max();)he++;for(var oe=0;oe<ue.length;++oe){var de=oe;"-"==B.orientation&&(de=ue.length-oe-1);var ae=ue[de];if(B.readframe=ce,W){var fe=parseInt(W[de+he]);"number"==typeof fe&&fe>=0&&2>=fe&&(B.readframe=fe,B.readframeExplicit=!0)}var pe=ae.max()-ae.min();ce=(ce+pe)%3,t(d,ae.min()+1,ae.max(),B)}}}}}}},o.prototype.getFirstAdjacent=function(e,t,n,i){var r=this.bwg.chromsToIDs[e];return void 0===r?i([]):void this.getFirstAdjacentById(r,t,n,i)},o.prototype.getFirstAdjacentById=function(e,t,n,r){var o=this;if(!this.cirHeader)return void this.bwg.data.slice(this.cirTreeOffset,48).fetch(function(i){o.cirHeader=i;var a=new Int32Array(o.cirHeader);o.cirBlockSize=a[1],o.getFirstAdjacentById(e,t,n,r)});var a=null,s=-1,l=-1,h=0,d=(Date.now(),function(e,t){h+=e.length;for(var n,i=4+32*o.cirBlockSize,r=0;r<e.length;++r){var a=new u(e[r],e[r]+i);n=n?c(n,a):a}for(var s=n.ranges(),l=0;l<s.length;++l){var d=s[l];f(e,d,t)}}),f=function(i,s,l,u){s.max()-s.min();o.bwg.data.slice(s.min(),s.max()-s.min()).fetch(function(u){for(var c=0;c<i.length;++c)if(s.contains(i[c])&&(p(u,i[c]-s.min(),l),--h,0==h)){if(!a)return n>0&&(0!=e||t>0)?o.getFirstAdjacentById(0,0,n,r):0>n&&(e!=o.bwg.maxID||1e9>t)?o.getFirstAdjacentById(o.bwg.maxID,1e9,n,r):r([]);o.fetchFeatures(function(i,r,o,a){return 0>n&&(e>i||t>o)||n>0&&(i>e||r>t)},[a],function(e){for(var t=null,i=-1,o=-1,a=0;a<e.length;++a){var s=e[a],l=s._chromId,u=s.min,c=s.max;(null==t||0>n&&(l>i||c>o)||n>0&&(i>l||o>u))&&(t=s,o=0>n?c:u,i=l)}return r(null!=t?[t]:[])})}})},p=function(r,u,c){var h=new Uint8Array(r),f=new Int16Array(r),p=new Int32Array(r),_=h[u],g=f[u/2+1];if(u+=4,0!=_)for(var m=0;g>m;++m){var v=u/4,y=p[v],b=p[v+1],x=p[v+2],w=p[v+3],S=i(h,u+16),A=i(h,u+24);(0>n&&(e>y||y==e&&t>=b)||n>0&&(x>e||x==e&&w>=t))&&(/_random/.exec(o.bwg.idsToChroms[y])||(null==a||0>n&&(x>s||x==s&&w>l)||n>0&&(s>y||y==s&&l>b))&&(a={offset:S,size:A},l=0>n?w:b,s=0>n?x:y)),u+=32}else{for(var k=-1,C=-1,T=-1,m=0;g>m;++m){var v=u/4,y=p[v],b=p[v+1],x=p[v+2],w=p[v+3],S=p[v+4]<<32|p[v+5];(0>n&&(e>y||y==e&&t>=b)&&x>=e||n>0&&(x>e||x==e&&w>=t)&&e>=y)&&(0>k||w>C)&&(k=S,C=0>n?w:b,T=0>n?x:y),u+=24}k>=0&&d([k],c+1)}};d([o.cirTreeOffset+48],1)},r.prototype.readWigData=function(e,t,n,i){this.getUnzoomedView().readWigData(e,t,n,i)},r.prototype.getUnzoomedView=function(){if(!this.unzoomedView){var e=4e3,t=this.zoomLevels[0];t&&(e=this.zoomLevels[0].dataOffset-this.unzoomedIndexOffset),this.unzoomedView=new o(this,this.unzoomedIndexOffset,e,!1)}return this.unzoomedView},r.prototype.getZoomedView=function(e){var t=this.zoomLevels[e];return t.view||(t.view=new o(this,t.indexOffset,4e3,!0)),t.view},r.prototype._tsFetch=function(e,t,n,i,r){var o=this;if(!(e>=this.zoomLevels.length-1)){var a;return a=0>e?this.getUnzoomedView():this.getZoomedView(e),a.readWigDataById(t,n,i,r)}if(this.topLevelReductionCache){for(var s=[],l=this.topLevelReductionCache,u=0;u<l.length;++u)l[u]._chromId==t&&s.push(l[u]);return r(s)}this.getZoomedView(this.zoomLevels.length-1).readWigDataById(-1,0,3e8,function(a){return o.topLevelReductionCache=a,o._tsFetch(e,t,n,i,r)})},r.prototype.thresholdSearch=function(e,t,n,i,r){function o(){if(0==l.length)return r(null);l.sort(function(e,t){var i=e.zoom-t.zoom;return 0!=i?i:(i=e.chrOrd-t.chrOrd,0!=i?i:e.min-t.min*n)});var e=l.splice(0,1)[0];a._tsFetch(e.zoom,e.chr,e.min,e.max,function(a){var s=n>0?0:3e8;e.fromRef&&(s=t);for(var u=0;u<a.length;++u){var c,h=a[u];if(c=void 0!=h.maxScore?h.maxScore:h.score,n>0){if(c>i)if(e.zoom<0){if(h.min>s)return r(h)}else h.max>s&&l.push({chr:e.chr,chrOrd:e.chrOrd,zoom:e.zoom-2,min:h.min,max:h.max,fromRef:e.fromRef})}else if(c>i)if(e.zoom<0){if(h.max<s)return r(h)}else h.min<s&&l.push({chr:e.chr,chrOrd:e.chrOrd,zoom:e.zoom-2,min:h.min,max:h.max,fromRef:e.fromRef})}o()})}n=0>n?-1:1;for(var a=this,s=this.chromsToIDs[e],l=[{chrOrd:0,chr:s,zoom:a.zoomLevels.length-4,min:0,max:3e8,fromRef:!0}],u=1;u<=this.maxID+1;++u){var c=(s+n*u)%(this.maxID+1);0>c&&(c+=this.maxID+1),l.push({chrOrd:u,chr:c,zoom:a.zoomLevels.length-1,min:0,max:3e8})}o()},r.prototype.getAutoSQL=function(e){return this.asOffset?void this.data.slice(this.asOffset,2048).fetch(function(t){for(var n=new Uint8Array(t),i="",r=0;r<n.length&&0!=n[r];++r)i+=String.fromCharCode(n[r]);var o=/(\w+)\s+(\w+)\s+("([^"]+)")?\s+\(\s*/,a=/([\w\[\]]+)\s+(\w+)\s*;\s*("([^"]+)")?\s*/g,s=o.exec(i);if(s){var l={declType:s[1],name:s[2],comment:s[4],fields:[]};i=i.substring(s[0]);for(var u=a.exec(i);null!=u;u=a.exec(i))l.fields.push({type:u[1],name:u[2],comment:u[4]});return e(l)}}):e(null)},r.prototype.getExtraIndices=function(e){var t=this;return this.version<4||0==this.extHeaderOffset||"bigbed"!=this.type?e(null):void this.data.slice(this.extHeaderOffset,64).fetch(function(n){if(!n)return e(null,"Couldn't fetch extension header");var r=new Uint8Array(n),o=new Int16Array(n),a=(new Int32Array(n),o[0],o[1]),l=i(r,4);return 0==a?e(null):void t.data.slice(l,20*a).fetch(function(n){if(!n)return e(null,"Couldn't fetch index info");for(var r=new Uint8Array(n),o=new Int16Array(n),l=(new Int32Array(n),[]),u=0;a>u;++u){var c=o[10*u],h=o[10*u+1],d=i(r,20*u+4),f=o[10*u+8],p=new s(t,c,h,d,f);l.push(p)}e(l)})})},s.prototype.lookup=function(e,t){var n=this;this.bbi.data.slice(this.offset,32).fetch(function(r){function o(r){n.bbi.data.slice(r,4+l*(u+c)).fetch(function(r){var a=new Uint8Array(r),s=new Uint16Array(r),l=(new Uint32Array(r),a[0]),h=s[1],d=4;if(0!=l){for(var f=0;h>f;++f){for(var p="",_=0;u>_;++_){var g=a[d++];0!=g&&(p+=String.fromCharCode(g))}if(p==e){var m=i(a,d),y=v(a,d+8);return n.bbi.getUnzoomedView().fetchFeatures(function(t,i,r,o){return o&&o.length>n.field-3?o[n.field-3]==e:void 0},[{offset:m,size:y}],t)}d+=c}return t([])}for(var b=null,f=0;h>f;++f){for(var p="",_=0;u>_;++_){var g=a[d++];0!=g&&(p+=String.fromCharCode(g))}var x=i(a,d);if(d+=8,e.localeCompare(p)<0&&b)return void o(b);b=x}o(b)})}var a=new Uint8Array(r),s=(new Int16Array(r),new Int32Array(r)),l=(s[0],s[1]),u=s[2],c=s[3],h=(i(a,16),32);o(n.offset+h)})},e.exports={makeBwg:a,BIG_BED_MAGIC:A,BIG_WIG_MAGIC:w}},function(e,t,n){function i(){}function r(){this.was=[0]}function o(e,t,n){this.hufts=new Int32Array(3*_),this.window=new Uint8Array(n),this.end=n,this.checkfn=t,this.mode=j,this.reset(e,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new a,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new s}function a(){}function s(){}function l(e,t,n,i,r){return e[0]=Q,t[0]=ee,n[0]=te,i[0]=ne,x}function u(e,t,n,i,r){if(0!=r){if(!e)throw"Undef src";if(!n)throw"Undef dest";0==t&&r==e.length?h(e,n,i):be?h(e.subarray(t,t+r),n,i):1==e.BYTES_PER_ELEMENT&&r>100?h(new Uint8Array(e.buffer,e.byteOffset+t,r),n,i):c(e,t,n,i,r)}}function c(e,t,n,i,r){for(var o=0;r>o;++o)n[i+o]=e[t+o]}function h(e,t,n){t.set(e,n)}function d(e,t,n,r){e=t?n?new Uint8Array(e,t,n):new Uint8Array(e,t,e.byteLength-t):new Uint8Array(e);var o=new i;o.inflateInit(p,!0),o.next_in=e,o.next_in_index=0,o.avail_in=e.length;for(var a=[],s=0;;){var l=new Uint8Array(32e3);o.next_out=l,o.next_out_index=0,o.avail_out=l.length;var c=o.inflate(v);if(c!=x&&c!=w&&c!=T)throw o.msg;if(0!=o.avail_out){var h=new Uint8Array(l.length-o.avail_out);u(l,0,h,0,l.length-o.avail_out),l=h}if(a.push(l),s+=l.length,c==w||c==T)break}if(r&&(r[0]=(t||0)+o.next_in_index),1==a.length)return a[0].buffer;for(var d=new Uint8Array(s),f=0,_=0;_<a.length;++_){var g=a[_];u(g,0,d,f,g.length),f+=g.length}return d.buffer}var f=15,p=f,_=1440,g=15,m=32,v=0,y=4,b=8,x=0,w=1,S=2,A=-2,k=-3,C=-4,T=-5,E=0,M=1,L=2,R=3,O=4,P=5,D=6,I=7,N=8,F=9,B=10,z=11,H=12,q=13,G=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],j=0,U=1,V=2,W=3,X=4,K=5,Y=6,Z=7,$=8,J=9,Q=9,ee=5,te=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],ne=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],re=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ae=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];
i.prototype.inflateInit=function(e,t){return e||(e=p),t&&(t=!1),this.istate=new r,this.istate.inflateInit(this,t?-e:e)},i.prototype.inflate=function(e){return null==this.istate?A:this.istate.inflate(this,e)},i.prototype.inflateEnd=function(){if(null==this.istate)return A;var e=istate.inflateEnd(this);return this.istate=null,e},i.prototype.inflateSync=function(){return istate.inflateSync(this)},i.prototype.inflateSetDictionary=function(e,t){return istate.inflateSetDictionary(this,e,t)},r.prototype.inflateReset=function(e){return null==e||null==e.istate?A:(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=0!=e.istate.nowrap?I:E,e.istate.blocks.reset(e,null),x)},r.prototype.inflateEnd=function(e){return null!=this.blocks&&this.blocks.free(e),this.blocks=null,x},r.prototype.inflateInit=function(e,t){return e.msg=null,this.blocks=null,nowrap=0,0>t&&(t=-t,nowrap=1),8>t||t>15?(this.inflateEnd(e),A):(this.wbits=t,e.istate.blocks=new o(e,0!=e.istate.nowrap?null:this,1<<t),this.inflateReset(e),x)},r.prototype.inflate=function(e,t){var n,i;if(null==e||null==e.istate||null==e.next_in)return A;for(t=t==y?T:x,n=T;;)switch(e.istate.mode){case E:if(0==e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,(15&(e.istate.method=e.next_in[e.next_in_index++]))!=b){e.istate.mode=q,e.msg="unknown compression method",e.istate.marker=5;break}if((e.istate.method>>4)+8>e.istate.wbits){e.istate.mode=q,e.msg="invalid window size",e.istate.marker=5;break}e.istate.mode=M;case M:if(0==e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,i=255&e.next_in[e.next_in_index++],((e.istate.method<<8)+i)%31!=0){e.istate.mode=q,e.msg="incorrect header check",e.istate.marker=5;break}if(0==(i&m)){e.istate.mode=I;break}e.istate.mode=L;case L:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=R;case R:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=O;case O:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=P;case P:return 0==e.avail_in?n:(n=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.adler=e.istate.need,e.istate.mode=D,S);case D:return e.istate.mode=q,e.msg="need dictionary",e.istate.marker=0,A;case I:if(n=e.istate.blocks.proc(e,n),n==k){e.istate.mode=q,e.istate.marker=0;break}if(n==x&&(n=t),n!=w)return n;if(n=t,e.istate.blocks.reset(e,e.istate.was),0!=e.istate.nowrap){e.istate.mode=H;break}e.istate.mode=N;case N:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=F;case F:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=B;case B:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=z;case z:if(0==e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.istate.was[0]!=e.istate.need){e.istate.mode=q,e.msg="incorrect data check",e.istate.marker=5;break}e.istate.mode=H;case H:return w;case q:return k;default:return A}},r.prototype.inflateSetDictionary=function(e,t,n){var i=0,r=n;return null==e||null==e.istate||e.istate.mode!=D?A:e._adler.adler32(1,t,0,n)!=e.adler?k:(e.adler=e._adler.adler32(0,null,0,0),r>=1<<e.istate.wbits&&(r=(1<<e.istate.wbits)-1,i=n-r),e.istate.blocks.set_dictionary(t,i,r),e.istate.mode=I,x)};var se=[0,0,255,255];r.prototype.inflateSync=function(e){var t,n,i,r,o;if(null==e||null==e.istate)return A;if(e.istate.mode!=q&&(e.istate.mode=q,e.istate.marker=0),0==(t=e.avail_in))return T;for(n=e.next_in_index,i=e.istate.marker;0!=t&&4>i;)e.next_in[n]==se[i]?i++:i=0!=e.next_in[n]?0:4-i,n++,t--;return e.total_in+=n-e.next_in_index,e.next_in_index=n,e.avail_in=t,e.istate.marker=i,4!=i?k:(r=e.total_in,o=e.total_out,this.inflateReset(e),e.total_in=r,e.total_out=o,e.istate.mode=I,x)},r.prototype.inflateSyncPoint=function(e){return null==e||null==e.istate||null==e.istate.blocks?A:e.istate.blocks.sync_point()};var le=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];o.prototype.reset=function(e,t){t&&(t[0]=this.check),this.mode==Y&&this.codes.free(e),this.mode=j,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(e.adler=this.check=e._adler.adler32(0,null,0,0))},o.prototype.proc=function(e,t){var n,i,r,o,a,s,c;for(o=e.next_in_index,a=e.avail_in,i=this.bitb,r=this.bitk,s=this.write,c=s<this.read?this.read-s-1:this.end-s;;)switch(this.mode){case j:for(;3>r;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=x,a--,i|=(255&e.next_in[o++])<<r,r+=8}switch(n=7&i,this.last=1&n,n>>>1){case 0:i>>>=3,r-=3,n=7&r,i>>>=n,r-=n,this.mode=U;break;case 1:var h=new Int32Array(1),d=new Int32Array(1),f=[],p=[];l(h,d,f,p,e),this.codes.init(h[0],d[0],f[0],0,p[0],0,e),i>>>=3,r-=3,this.mode=Y;break;case 2:i>>>=3,r-=3,this.mode=W;break;case 3:return i>>>=3,r-=3,this.mode=q,e.msg="invalid block type",t=k,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t)}break;case U:for(;32>r;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=x,a--,i|=(255&e.next_in[o++])<<r,r+=8}if((~i>>>16&65535)!=(65535&i))return this.mode=q,e.msg="invalid stored block lengths",t=k,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);this.left=65535&i,i=r=0,this.mode=0!=this.left?V:0!=this.last?Z:j;break;case V:if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,write=s,this.inflate_flush(e,t);if(0==c&&(s==end&&0!=read&&(s=0,c=s<this.read?this.read-s-1:this.end-s),0==c&&(this.write=s,t=this.inflate_flush(e,t),s=this.write,c=s<this.read?this.read-s-1:this.end-s,s==this.end&&0!=this.read&&(s=0,c=s<this.read?this.read-s-1:this.end-s),0==c)))return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);if(t=x,n=this.left,n>a&&(n=a),n>c&&(n=c),u(e.next_in,o,this.window,s,n),o+=n,a-=n,s+=n,c-=n,0!=(this.left-=n))break;this.mode=0!=this.last?Z:j;break;case W:for(;14>r;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=x,a--,i|=(255&e.next_in[o++])<<r,r+=8}if(this.table=n=16383&i,(31&n)>29||(n>>5&31)>29)return this.mode=J,e.msg="too many length or distance symbols",t=k,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);if(n=258+(31&n)+(n>>5&31),null==this.blens||this.blens.length<n)this.blens=new Int32Array(n);else for(var _=0;n>_;_++)this.blens[_]=0;i>>>=14,r-=14,this.index=0,mode=X;case X:for(;this.index<4+(this.table>>>10);){for(;3>r;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=x,a--,i|=(255&e.next_in[o++])<<r,r+=8}this.blens[le[this.index++]]=7&i,i>>>=3,r-=3}for(;this.index<19;)this.blens[le[this.index++]]=0;if(this.bb[0]=7,n=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,e),n!=x)return t=n,t==k&&(this.blens=null,this.mode=J),this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,write=s,this.inflate_flush(e,t);this.index=0,this.mode=K;case K:for(;;){if(n=this.table,!(this.index<258+(31&n)+(n>>5&31)))break;var _,g,m;for(n=this.bb[0];n>r;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=x,a--,i|=(255&e.next_in[o++])<<r,r+=8}if(n=this.hufts[3*(this.tb[0]+(i&G[n]))+1],m=this.hufts[3*(this.tb[0]+(i&G[n]))+2],16>m)i>>>=n,r-=n,this.blens[this.index++]=m;else{for(_=18==m?7:m-14,g=18==m?11:3;n+_>r;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=x,a--,i|=(255&e.next_in[o++])<<r,r+=8}if(i>>>=n,r-=n,g+=i&G[_],i>>>=_,r-=_,_=this.index,n=this.table,_+g>258+(31&n)+(n>>5&31)||16==m&&1>_)return this.blens=null,this.mode=J,e.msg="invalid bit length repeat",t=k,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);m=16==m?this.blens[_-1]:0;do this.blens[_++]=m;while(0!=--g);this.index=_}}this.tb[0]=-1;var h=new Int32Array(1),d=new Int32Array(1),f=new Int32Array(1),p=new Int32Array(1);if(h[0]=9,d[0]=6,n=this.table,n=this.inftree.inflate_trees_dynamic(257+(31&n),1+(n>>5&31),this.blens,h,d,f,p,this.hufts,e),n!=x)return n==k&&(this.blens=null,this.mode=q),t=n,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);this.codes.init(h[0],d[0],this.hufts,f[0],this.hufts,p[0],e),this.mode=Y;case Y:if(this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,(t=this.codes.proc(this,e,t))!=w)return this.inflate_flush(e,t);if(t=x,this.codes.free(e),o=e.next_in_index,a=e.avail_in,i=this.bitb,r=this.bitk,s=this.write,c=s<this.read?this.read-s-1:this.end-s,0==this.last){this.mode=j;break}this.mode=Z;case Z:if(this.write=s,t=this.inflate_flush(e,t),s=this.write,c=s<this.read?this.read-s-1:this.end-s,this.read!=this.write)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);mode=H;case $:return t=w,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);case J:return t=k,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);default:return t=A,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t)}},o.prototype.free=function(e){this.reset(e,null),this.window=null,this.hufts=null},o.prototype.set_dictionary=function(e,t,n){u(e,t,window,0,n),this.read=this.write=n},o.prototype.sync_point=function(){return this.mode==U},o.prototype.inflate_flush=function(e,t){var n,i,r;return i=e.next_out_index,r=this.read,n=(r<=this.write?this.write:this.end)-r,n>e.avail_out&&(n=e.avail_out),0!=n&&t==T&&(t=x),e.avail_out-=n,e.total_out+=n,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,r,n)),u(this.window,r,e.next_out,i,n),i+=n,r+=n,r==this.end&&(r=0,this.write==this.end&&(this.write=0),n=this.write-r,n>e.avail_out&&(n=e.avail_out),0!=n&&t==T&&(t=x),e.avail_out-=n,e.total_out+=n,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,r,n)),u(this.window,r,e.next_out,i,n),i+=n,r+=n),e.next_out_index=i,this.read=r,t};var ue=0,ce=1,he=2,de=3,fe=4,pe=5,_e=6,ge=7,me=8,ve=9;a.prototype.init=function(e,t,n,i,r,o,a){this.mode=ue,this.lbits=e,this.dbits=t,this.ltree=n,this.ltree_index=i,this.dtree=r,this.dtree_index=o,this.tree=null},a.prototype.proc=function(e,t,n){var i,r,o,a,s,l,u,c=0,h=0,d=0;for(d=t.next_in_index,a=t.avail_in,c=e.bitb,h=e.bitk,s=e.write,l=s<e.read?e.read-s-1:e.end-s;;)switch(this.mode){case ue:if(l>=258&&a>=10&&(e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,n=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,e,t),d=t.next_in_index,a=t.avail_in,c=e.bitb,h=e.bitk,s=e.write,l=s<e.read?e.read-s-1:e.end-s,n!=x)){this.mode=n==w?ge:ve;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=ce;case ce:for(i=this.need;i>h;){if(0==a)return e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);n=x,a--,c|=(255&t.next_in[d++])<<h,h+=8}if(r=3*(this.tree_index+(c&G[i])),c>>>=this.tree[r+1],h-=this.tree[r+1],o=this.tree[r],0==o){this.lit=this.tree[r+2],this.mode=_e;break}if(0!=(16&o)){this.get=15&o,this.len=this.tree[r+2],this.mode=he;break}if(0==(64&o)){this.need=o,this.tree_index=r/3+this.tree[r+2];break}if(0!=(32&o)){this.mode=ge;break}return this.mode=ve,t.msg="invalid literal/length code",n=k,e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);case he:for(i=this.get;i>h;){if(0==a)return e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);n=x,a--,c|=(255&t.next_in[d++])<<h,h+=8}this.len+=c&G[i],c>>=i,h-=i,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=de;case de:for(i=this.need;i>h;){if(0==a)return e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);n=x,a--,c|=(255&t.next_in[d++])<<h,h+=8}if(r=3*(this.tree_index+(c&G[i])),c>>=this.tree[r+1],h-=this.tree[r+1],o=this.tree[r],0!=(16&o)){this.get=15&o,this.dist=this.tree[r+2],this.mode=fe;break}if(0==(64&o)){this.need=o,this.tree_index=r/3+this.tree[r+2];break}return this.mode=ve,t.msg="invalid distance code",n=k,e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);case fe:for(i=this.get;i>h;){if(0==a)return e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);n=x,a--,c|=(255&t.next_in[d++])<<h,h+=8}this.dist+=c&G[i],c>>=i,h-=i,this.mode=pe;case pe:for(u=s-this.dist;0>u;)u+=e.end;for(;0!=this.len;){if(0==l&&(s==e.end&&0!=e.read&&(s=0,l=s<e.read?e.read-s-1:e.end-s),0==l&&(e.write=s,n=e.inflate_flush(t,n),s=e.write,l=s<e.read?e.read-s-1:e.end-s,s==e.end&&0!=e.read&&(s=0,l=s<e.read?e.read-s-1:e.end-s),0==l)))return e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);e.window[s++]=e.window[u++],l--,u==e.end&&(u=0),this.len--}this.mode=ue;break;case _e:if(0==l&&(s==e.end&&0!=e.read&&(s=0,l=s<e.read?e.read-s-1:e.end-s),0==l&&(e.write=s,n=e.inflate_flush(t,n),s=e.write,l=s<e.read?e.read-s-1:e.end-s,s==e.end&&0!=e.read&&(s=0,l=s<e.read?e.read-s-1:e.end-s),0==l)))return e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);n=x,e.window[s++]=this.lit,l--,this.mode=ue;break;case ge:if(h>7&&(h-=8,a++,d--),e.write=s,n=e.inflate_flush(t,n),s=e.write,l=s<e.read?e.read-s-1:e.end-s,e.read!=e.write)return e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);this.mode=me;case me:return n=w,e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);case ve:return n=k,e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n);default:return n=A,e.bitb=c,e.bitk=h,t.avail_in=a,t.total_in+=d-t.next_in_index,t.next_in_index=d,e.write=s,e.inflate_flush(t,n)}},a.prototype.free=function(e){},a.prototype.inflate_fast=function(e,t,n,i,r,o,a,s){var l,c,h,d,f,p,_,g,m,v,y,b,S,A,C,T;_=s.next_in_index,g=s.avail_in,f=a.bitb,p=a.bitk,m=a.write,v=m<a.read?a.read-m-1:a.end-m,y=G[e],b=G[t];do{for(;20>p;)g--,f|=(255&s.next_in[_++])<<p,p+=8;if(l=f&y,c=n,h=i,T=3*(h+l),0!=(d=c[T]))for(;;){if(f>>=c[T+1],p-=c[T+1],0!=(16&d)){for(d&=15,S=c[T+2]+(f&G[d]),f>>=d,p-=d;15>p;)g--,f|=(255&s.next_in[_++])<<p,p+=8;for(l=f&b,c=r,h=o,T=3*(h+l),d=c[T];;){if(f>>=c[T+1],p-=c[T+1],0!=(16&d)){for(d&=15;d>p;)g--,f|=(255&s.next_in[_++])<<p,p+=8;if(A=c[T+2]+(f&G[d]),f>>=d,p-=d,v-=S,m>=A)C=m-A,m-C>0&&2>m-C?(a.window[m++]=a.window[C++],a.window[m++]=a.window[C++],S-=2):(a.window[m++]=a.window[C++],a.window[m++]=a.window[C++],S-=2);else{C=m-A;do C+=a.end;while(0>C);if(d=a.end-C,S>d){if(S-=d,m-C>0&&d>m-C){do a.window[m++]=a.window[C++];while(0!=--d)}else u(a.window,C,a.window,m,d),m+=d,C+=d,d=0;C=0}}do a.window[m++]=a.window[C++];while(0!=--S);break}if(0!=(64&d))return s.msg="invalid distance code",S=s.avail_in-g,S=S>p>>3?p>>3:S,g+=S,_-=S,p-=S<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=_-s.next_in_index,s.next_in_index=_,a.write=m,k;l+=c[T+2],l+=f&G[d],T=3*(h+l),d=c[T]}break}if(0!=(64&d))return 0!=(32&d)?(S=s.avail_in-g,S=S>p>>3?p>>3:S,g+=S,_-=S,p-=S<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=_-s.next_in_index,s.next_in_index=_,a.write=m,w):(s.msg="invalid literal/length code",S=s.avail_in-g,S=S>p>>3?p>>3:S,g+=S,_-=S,p-=S<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=_-s.next_in_index,s.next_in_index=_,a.write=m,k);if(l+=c[T+2],l+=f&G[d],T=3*(h+l),0==(d=c[T])){f>>=c[T+1],p-=c[T+1],a.window[m++]=c[T+2],v--;break}}else f>>=c[T+1],p-=c[T+1],a.window[m++]=c[T+2],v--}while(v>=258&&g>=10);return S=s.avail_in-g,S=S>p>>3?p>>3:S,g+=S,_-=S,p-=S<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=_-s.next_in_index,s.next_in_index=_,a.write=m,x},s.prototype.huft_build=function(e,t,n,i,r,o,a,s,l,c,h){var d,f,p,m,v,y,b,w,S,A,C,E,M,L,R;A=0,v=n;do this.c[e[t+A]]++,A++,v--;while(0!=v);if(this.c[0]==n)return a[0]=-1,s[0]=0,x;for(w=s[0],y=1;g>=y&&0==this.c[y];y++);for(b=y,y>w&&(w=y),v=g;0!=v&&0==this.c[v];v--);for(p=v,w>v&&(w=v),s[0]=w,L=1<<y;v>y;y++,L<<=1)if((L-=this.c[y])<0)return k;if((L-=this.c[v])<0)return k;for(this.c[v]+=L,this.x[1]=y=0,A=1,M=2;0!=--v;)this.x[M]=y+=this.c[A],M++,A++;v=0,A=0;do 0!=(y=e[t+A])&&(this.v[this.x[y]++]=v),A++;while(++v<n);for(n=this.x[p],this.x[0]=v=0,A=0,m=-1,E=-w,this.u[0]=0,C=0,R=0;p>=b;b++)for(d=this.c[b];0!=d--;){for(;b>E+w;){if(m++,E+=w,R=p-E,R=R>w?w:R,(f=1<<(y=b-E))>d+1&&(f-=d+1,M=b,R>y))for(;++y<R&&!((f<<=1)<=this.c[++M]);)f-=this.c[M];if(R=1<<y,this.hn[0]+R>_)return k;this.u[m]=C=this.hn[0],this.hn[0]+=R,0!=m?(this.x[m]=v,this.r[0]=y,this.r[1]=w,y=v>>>E-w,this.r[2]=C-this.u[m-1]-y,u(this.r,0,l,3*(this.u[m-1]+y),3)):a[0]=C}for(this.r[1]=b-E,A>=n?this.r[0]=192:h[A]<i?(this.r[0]=this.v[A]<256?0:96,this.r[2]=this.v[A++]):(this.r[0]=o[this.v[A]-i]+16+64,this.r[2]=r[this.v[A++]-i]),f=1<<b-E,y=v>>>E;R>y;y+=f)u(this.r,0,l,3*(C+y),3);for(y=1<<b-1;0!=(v&y);y>>>=1)v^=y;for(v^=y,S=(1<<E)-1;(v&S)!=this.x[m];)m--,E-=w,S=(1<<E)-1}return 0!=L&&1!=p?T:x},s.prototype.inflate_trees_bits=function(e,t,n,i,r){var o;return this.initWorkArea(19),this.hn[0]=0,o=this.huft_build(e,0,19,19,null,null,n,t,i,this.hn,this.v),o==k?r.msg="oversubscribed dynamic bit lengths tree":(o==T||0==t[0])&&(r.msg="incomplete dynamic bit lengths tree",o=k),o},s.prototype.inflate_trees_dynamic=function(e,t,n,i,r,o,a,s,l){var u;return this.initWorkArea(288),this.hn[0]=0,u=this.huft_build(n,0,e,257,ie,re,o,i,s,this.hn,this.v),u!=x||0==i[0]?(u==k?l.msg="oversubscribed literal/length tree":u!=C&&(l.msg="incomplete literal/length tree",u=k),u):(this.initWorkArea(288),u=this.huft_build(n,e,t,0,oe,ae,a,r,s,this.hn,this.v),u!=x||0==r[0]&&e>257?(u==k?l.msg="oversubscribed distance tree":u==T?(l.msg="incomplete distance tree",u=k):u!=C&&(l.msg="empty distance tree with lengths",u=k),u):x)},s.prototype.initWorkArea=function(e){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(e),this.c=new Int32Array(g+1),this.r=new Int32Array(3),this.u=new Int32Array(g),this.x=new Int32Array(g+1)),this.v.length<e&&(this.v=new Int32Array(e));for(var t=0;e>t;t++)this.v[t]=0;for(var t=0;g+1>t;t++)this.c[t]=0;for(var t=0;3>t;t++)this.r[t]=0;u(this.c,0,this.u,0,g),u(this.c,0,this.x,0,g+1)};var ye=new Uint8Array(1),be="function"==typeof ye.subarray;e.exports={inflateBuffer:d,arrayCopy:u}},function(e,t,n){"use strict";function i(e){var t="bp";return e>1e9?(e/=1e9,t="Gb"):e>1e6?(e/=1e6,t="Mb"):e>1e3&&(e/=1e3,t="kb"),""+Math.round(e)+t}var r=n(247),o=r.Browser,a=n(248),s=a.makeElement,l=(a.removeChildren,n(272)),u=l.formatLongInt,c=n(281);n(282),n(283),n(284),n(285),n(286),n(287),o.prototype.initUI=function(e,t){this.noSourceCSS||["bootstrap-scoped.css","dalliance-scoped.css","font-awesome.min.css"].forEach(function(e){document.head.appendChild(s("link","",{rel:"stylesheet",href:this.resolveURL("$$css/"+e)}))}.bind(this));var n=this;n.disableDefaultFeaturePopup||this.addFeatureListener(function(e,t,i,r){n.featurePopup(e,t,i,r)}),e.classList.add("dalliance");var r=n.toolbar=s("div",null,{className:"btn-toolbar toolbar"}),o=n.coordSystem.speciesName+" "+n.nameForCoordSystem(n.coordSystem);this.setDocumentTitle&&(document.title=o+" :: dalliance");var a=s("input","",{className:"loc-field"});n.makeTooltip(a,"Enter a genomic location or gene name");var l=s("p","",{className:"loc-status"}),h=s("a",[s("i",null,{className:"fa fa-search-plus"})],{className:"btn"}),d=new c({width:n.zoomSliderWidth});n.makeTooltip(d,"Highlighted button shows current zoom level, gray button shows inactive zoom level (click or tap SPACE to toggle).");var f=s("a",[s("i",null,{className:"fa fa-search-minus"})],{className:"btn"}),p=s("a",[s("i",null,{className:"fa fa-eraser"})],{className:"btn"}),_=s("a",[s("i",null,{className:"fa fa-plus"})],{className:"btn"}),g=s("a",[s("i",null,{className:"fa fa-bookmark"})],{className:"btn"}),m=s("a",[s("i",null,{className:"fa fa-print"})],{className:"btn"}),v=(s("a",[s("i",null,{className:"fa fa-refresh"})],{className:"btn"}),s("a",[s("i",null,{className:"fa fa-cogs"})],{className:"btn"})),y=s("a",[s("i",null,{className:"fa fa-question"})],{className:"btn"}),b=s("a",[s("i",null,{className:"fa fa-road"})],{className:"btn"});n.makeTooltip(b,"Configure currently selected track(s) (E)");var x=s("a",[s("i",null,{className:"fa fa-angle-left"})],{className:"btn"},{width:"5px"}),w=s("a",[s("i",null,{className:"fa fa-angle-right"})],{className:"btn pull-right"},{width:"5px"}),S=s("div",null,{className:"btn-group pull-right"});this.noTrackAdder||S.appendChild(_),this.noTrackEditor||S.appendChild(b),this.noExport||S.appendChild(m),this.noOptions||S.appendChild(v),this.noHelp||S.appendChild(y),this.setUiMode=function(e){this.uiMode=e;var t={help:y,add:_,opts:v,"export":m,tier:b};for(var n in t)n==e?t[n].classList.add("active"):t[n].classList.remove("active")},this.noLeapButtons||r.appendChild(w),S.firstChild&&r.appendChild(S),this.noLeapButtons||r.appendChild(x),this.noTitle||r.appendChild(s("div",s("h4",o,{},{margin:"0px"}),{className:"btn-group title"})),this.noLocationField||r.appendChild(s("div",[a,l],{className:"btn-group loc-group"})),this.noClearHighlightsButton||r.appendChild(p),this.noZoomSlider||r.appendChild(s("div",[h,s("span",d,{className:"btn"}),f],{className:"btn-group"})),this.toolbarBelow?(e.appendChild(t),e.appendChild(r)):(e.appendChild(r),e.appendChild(t));var A=Math.log(2)/Math.log(10),k=Math.log(5)/Math.log(10),C=function(e){var t,i=(e/n.zoomExpt+Math.log(n.zoomBase))/Math.log(10),r=0|i,o=i-r;return t=.01>o?r:A+.01>=o?r+A:k+.01>=o?r+k:r+1,(t*Math.log(10)-Math.log(n.zoomBase))*n.zoomExpt},T=function(e){d.addLabel(e,i(Math.exp(e/n.zoomExpt)*n.zoomBase))};this.addViewListener(function(e,t,i,r,o){a.value=e+":"+u(t)+".."+u(i),d.min=0|o.min,d.max=0|o.max,o.isSnapZooming?(d.value=o.alternate,d.value2=o.current,d.active=2):(d.value=o.current,d.value2=o.alternate,d.active=1),o.current==o.min?h.classList.add("disabled"):h.classList.remove("disabled"),o.current==o.max?f.classList.add("disabled"):f.classList.remove("disabled"),d.removeLabels();var s=o.min,l=o.max,c=l-s,_=4;n.zoomSliderWidth&&n.zoomSliderWidth<150&&(_=3),T(C(s));for(var g=1;_-1>g;++g)T(C(s+1*g*c/(_-1)));T(C(l)),n.storeStatus&&n.storeViewStatus(),n.highlights.length>0?p.style.display="inline-block":p.style.display="none"}),this.addTierListener(function(){n.storeStatus&&n.storeTierStatus()}),a.addEventListener("keydown",function(e){if(40==e.keyCode&&(e.preventDefault(),e.stopPropagation(),n.setSelectedTier(0)),10==e.keyCode||13==e.keyCode){e.preventDefault();var t=a.value;n.search(t,function(e){e?l.textContent=""+e:l.textContent=""})}},!1);var E;_.addEventListener("click",function(e){E&&E.displayed?n.removeAllPopups():E=n.showTrackAdder(e)},!1),n.makeTooltip(_,"Add a new track from the registry or an indexed file. (A)"),h.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),n.zoomStep(-10)},!1),n.makeTooltip(h,"Zoom in (+)"),f.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),n.zoomStep(10)},!1),n.makeTooltip(f,"Zoom out (-)"),d.addEventListener("change",function(e){var t=2==d.active;t!=n.isSnapZooming&&(n.savedZoom=n.zoomSliderValue-n.zoomMin,n.isSnapZooming=t);var i=1==d.active?d.value:d.value2;n.zoomSliderValue=1*i,n.zoom(Math.exp(1*i/n.zoomExpt))},!1),g.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault()},!1),n.makeTooltip(g,"Favourite regions"),m.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),n.openExportPanel()},!1),n.makeTooltip(m,"Export publication-quality SVG. (X)");v.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),n.toggleOptsPopup(e)},!1),n.makeTooltip(v,"Configure options."),y.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),n.toggleHelpPopup(e)}),n.makeTooltip(y,"Help; Keyboard shortcuts. (H)"),b.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),1==n.selectedTiers.length&&n.openTierPanel(n.tiers[n.selectedTiers[0]])},!1),x.addEventListener("click",function(e){n.leap(n.reverseKeyScrolling?-1:1,!1)},!1),n.makeTooltip(x,function(e){var t,i=n.getSelectedTier();return i>=0&&(t=n.tiers[i]),t&&t.featureSource&&n.sourceAdapterIsCapable(t.featureSource,"quantLeap")&&"number"==typeof t.quantLeapThreshold?'Jump to the next region with a score above the threshold in the selected track "'+(t.config.name||t.dasSource.name)+'"" (ctrl+LEFT)':t&&t.featureSource&&n.sourceAdapterIsCapable(t.featureSource,"leap")?'Jump to the next feature in the selected track "'+(t.config.name||t.dasSource.name)+'" (ctrl+LEFT)':"Jump left (shift+LEFT)"}),w.addEventListener("click",function(e){n.leap(n.reverseKeyScrolling?1:-1,!1)},!1),n.makeTooltip(w,function(e){var t,i=n.getSelectedTier();return i>=0&&(t=n.tiers[i]),t&&t.featureSource&&n.sourceAdapterIsCapable(t.featureSource,"quantLeap")&&"number"==typeof t.quantLeapThreshold?'Jump to the next region with a score above the threshold in the selected track "'+(t.config.name||t.dasSource.name)+'"" (ctrl+RIGHT)':t&&t.featureSource&&n.sourceAdapterIsCapable(t.featureSource,"leap")?'Jump to the next feature in the selected track "'+(t.config.name||t.dasSource.name)+'" (ctrl+RIGHT)':"Jump right (shift+RIGHT)"}),n.addTierSelectionListener(function(){var e,t=n.getSelectedTier();t>=0&&(e=n.tiers[t]);var i=!1;e&&e.featureSource&&(n.sourceAdapterIsCapable(e.featureSource,"quantLeap")&&"number"==typeof e.quantLeapThreshold?i=!0:n.sourceAdapterIsCapable(e.featureSource,"leap")&&(i=!0)),x.firstChild.className=i?"fa fa-angle-double-left":"fa fa-angle-left",w.firstChild.className=i?"fa fa-angle-double-right":"fa fa-angle-right"}),p.addEventListener("click",function(e){n.clearHighlights()},!1),n.makeTooltip(p,"Clear highlights (C)"),n.addTierSelectionWrapListener(function(e){0>e&&(n.setSelectedTier(null),a.focus())}),n.addTierSelectionListener(function(e){if("tier"===n.uiMode)if(0==e.length)n.hideToolPanel(),n.manipulatingTier=null,n.uiMode="none";else{var t=n.tiers[e[0]];t!=n.manipulatingTier&&n.openTierPanel(t)}});var M=function(e){65==e.keyCode||97==e.keyCode?(e.preventDefault(),e.stopPropagation(),n.showTrackAdder()):72==e.keyCode||104==e.keyCode?(e.stopPropagation(),e.preventDefault(),n.toggleHelpPopup(e)):69==e.keyCode||101==e.keyCode?(e.stopPropagation(),e.preventDefault(),1==n.selectedTiers.length&&n.openTierPanel(n.tiers[n.selectedTiers[0]])):88==e.keyCode||120==e.keyCode?(e.stopPropagation(),e.preventDefault(),n.openExportPanel()):(67==e.keyCode||99==e.keyCode)&&(e.stopPropagation(),e.preventDefault(),n.clearHighlights())};e.addEventListener("focus",function(t){e.addEventListener("keydown",M,!1)},!1),e.addEventListener("blur",function(t){e.removeEventListener("keydown",M,!1)},!1),e.addEventListener("keydown",function(e){27===e.keyCode&&"none"!==n.uiMode&&(e.preventDefault(),e.stopPropagation(),n.setUiMode("none"),n.hideToolPanel(),n.selectedTiers&&n.selectedTiers.length>0&&n.browserHolder.focus())},!1)},o.prototype.showToolPanel=function(e,t){var n=this;this.activeToolPanel&&this.activeToolPanel.parentElement.removeChild(this.activeToolPanel);var i;i=t?e:s("div",e,{},{overflowY:"auto",width:"100%"});var r=s("div",s("i",null,{className:"fa fa-caret-right"}),{className:"tool-divider"});r.addEventListener("click",function(e){n.hideToolPanel(),n.setUiMode("none")},!1),this.makeTooltip(r,"Close tool panel (ESC)"),this.activeToolPanel=s("div",[r,i],{className:"tool-holder"}),this.svgHolder.appendChild(this.activeToolPanel),this.resizeViewer();var n=this},o.prototype.hideToolPanel=function(){this.activeToolPanel&&this.activeToolPanel.parentElement.removeChild(this.activeToolPanel),this.svgHolder.style.width="100%",this.activeToolPanel=null,this.resizeViewer()},o.prototype.toggleHelpPopup=function(e){if("help"===this.uiMode)this.hideToolPanel(),this.setUiMode("none");else{var t=s("iframe",null,{scrolling:"yes",seamless:"seamless",src:this.resolveURL("$$help/index.html"),className:"help-panel"});this.showToolPanel(t,!1),this.setUiMode("help")}},o.prototype.toggleOptsPopup=function(e){var t=this;if("opts"===this.uiMode)this.hideToolPanel(),this.setUiMode("none");else{var n=s("div",null,{className:"form-horizontal"},{boxSizing:"border-box",MozBoxSizing:"border-box",display:"inline-block",verticalAlign:"top"}),i=s("table");i.cellPadding=5;var r=s("input","",{type:"checkbox",checked:t.reverseScrolling});r.addEventListener("change",function(e){t.reverseScrolling=r.checked,t.storeStatus()},!1),i.appendChild(s("tr",[s("td","Reverse trackpad scrolling",{align:"right"}),s("td",r)]));var o=s("input","",{type:"checkbox",checked:t.reverseKeyScrolling});o.addEventListener("change",function(e){t.reverseKeyScrolling=o.checked,t.storeStatus()},!1),i.appendChild(s("tr",[s("td","Reverse scrolling buttons and keys",{align:"right"}),s("td",o)]));var a=s("select");a.appendChild(s("option","Left",{value:"left"})),a.appendChild(s("option","Center",{value:"center"})),a.appendChild(s("option","Right",{value:"right"})),a.appendChild(s("option","None",{value:"none"})),a.value=t.rulerLocation,a.addEventListener("change",function(e){t.rulerLocation=a.value,t.positionRuler();for(var n=0;n<t.tiers.length;++n)t.tiers[n].paintQuant();t.storeStatus()},!1),i.appendChild(s("tr",[s("td","Vertical guideline",{align:"right"}),s("td",a)]));var l=s("input","",{type:"checkbox",checked:t.singleBaseHighlight});l.addEventListener("change",function(e){t.singleBaseHighlight=l.checked,t.positionRuler(),t.storeStatus()},!1),l.setAttribute("id","singleBaseHightlightButton"),i.appendChild(s("tr",[s("td","Display and highlight current genome location",{align:"right"}),s("td",l)])),n.appendChild(i);var u=s("button","Reset browser",{className:"btn"},{marginLeft:"auto",marginRight:"auto",display:"block"});u.addEventListener("click",function(e){t.reset()},!1),n.appendChild(u),this.showToolPanel(n),this.setUiMode("opts")}}},function(e,t,n){"use strict";function i(e){function t(e){e=Math.min(e,r),e=Math.max(e,i),l=e,d.style.left=""+l+"px"}function n(e){e=Math.min(e,r),e=Math.max(e,i),u=e,f.style.left=""+u+"px"}e=e||{};var i=0,r=e.width||200,a=0,s=200,l=50,u=100,c=[],h=o("hr",null,{className:"slider-track"},{width:""+(0|r)+"px"}),d=o("hr",null,{className:"slider-thumb active"}),f=o("hr",null,{className:"slider-thumb"}),p=o("div",[h,d,f],{className:"slider"},{width:""+((0|r)+10)+"px"});p.removeLabels=function(){for(var e=0;e<c.length;++e)p.removeChild(c[e]);c=[]},p.addLabel=function(e,t){var n=o("div",t,{className:"slider-label"},{left:""+(i+(e-a)*(r-i)/(s-a)|0)+"px"});p.appendChild(n),c.push(n)};var _=document.createEvent("HTMLEvents");_.initEvent("change",!0,!1),Object.defineProperty(p,"value",{get:function(){return a+(l-i)*(s-a)/(r-i)},set:function(e){var n=i+(e-a)*(r-i)/(s-a);
t(n)}}),Object.defineProperty(p,"value2",{get:function(){return a+(u-i)*(s-a)/(r-i)},set:function(e){var t=i+(e-a)*(r-i)/(s-a);n(t)}}),Object.defineProperty(p,"active",{get:function(){return d.classList.contains("active")?1:2},set:function(e){1==e?(d.classList.add("active"),f.classList.remove("active")):(f.classList.add("active"),d.classList.remove("active"))}}),Object.defineProperty(p,"min",{get:function(){return a},set:function(e){a=e}}),Object.defineProperty(p,"max",{get:function(){return s},set:function(e){s=e}});var g,m,v=function(e){m=this==d?1:2,m!=p.active&&(p.active=m,p.dispatchEvent(_)),e.stopPropagation(),e.preventDefault(),window.addEventListener("mousemove",y,!1),window.addEventListener("mouseup",b,!1),g=e.clientX-(1==m?l:u)};d.addEventListener("mousedown",v,!1),f.addEventListener("mousedown",v,!1);var y=function(e){1==m?t(e.clientX-g):n(e.clientX-g),p.dispatchEvent(_)},b=function(e){window.removeEventListener("mousemove",y,!1),window.removeEventListener("mouseup",b,!1)};return p}var r=n(248),o=r.makeElement;e.exports=i},function(e,t,n){"use strict";function i(e){for(var t=0;t<e.styles.length;++t){var n=e.styles[t].style;if("__SEQUENCE"===n.glyph)return n}}var r=n(247),o=r.Browser,a=n(248),s=a.makeElement,l=n(251),u=l.isDasBooleanTrue,c=(l.isDasBooleanNotFalse,l.copyStylesheet),h=n(252),d=h.dasColourForName,f={DOT:!0,EX:!0,STAR:!0,SQUARE:!0,CROSS:!0,TRIANGLE:!0,PLIMSOLL:!0};o.prototype.openTierPanel=function(e){if("tier"===this.uiMode&&this.manipulatingTier===e)this.hideToolPanel(),this.setUiMode("none");else{var t=function(e){e.BGGRAD||(1==k?("LINEPLOT"==e.glyph||f[e.glyph]?e.FGCOLOR=g.value:e.BGCOLOR=g.value,e.COLOR1=e.COLOR2=e.COLOR3=null):(e.COLOR1=g.value,e.COLOR2=m.value,k>2?e.COLOR3=v.value:e.COLOR3=null),e._gradient=null,e._plusColor=y.value,e._minusColor=b.value)},n=function(t){for(var n=c(e.stylesheet),i=e.browser.zoomForCurrentScale(),r=0;r<n.styles.length;++r){var o=n.styles[r];o.zoom&&o.zoom!=i||t(o.style)}return n},r=function(i){e.mergeStylesheet(n(t))};this.manipulatingTier=e;var o=s("div",null,{className:"tier-edit"});if(e.dasSource.mapping){var a=this.chains[e.dasSource.mapping].coords;o.appendChild(s("div","Mapped from "+a.auth+a.version,null,{background:"gray",paddingBottom:"5px",marginBottom:"5px",textAlign:"center"}))}var l=s("div","Editing styles for current zoom level",null,{background:"gray",paddingBottom:"5px",marginBottom:"5px",textAlign:"center",display:"none"});o.appendChild(l);var h=s("input",null,{type:"text"}),p=s("input",null,{type:"checkbox",disabled:this.disablePinning}),_=s("select");_.appendChild(s("option","Histogram",{value:"HISTOGRAM"})),_.appendChild(s("option","Line Plot",{value:"LINEPLOT"})),_.appendChild(s("option","Ribbon",{value:"GRADIENT"})),_.appendChild(s("option","Scatter",{value:"SCATTER"}));var g=s("input",null,{type:"text",value:"#dd00dd"}),m=s("input",null,{type:"text",value:"#dd00dd"}),v=s("input",null,{type:"text",value:"#dd00dd"}),y=s("input",null,{type:"text",value:"#ffa07a"}),b=s("input",null,{type:"text",value:"#87cefa"});try{g.type=m.type=v.type="color",y.type=b.type="color"}catch(x){}var w=[g,m,v],S=s("i",null,{className:"fa fa-plus-circle"}),A=s("i",null,{className:"fa fa-minus-circle"}),k=1,C=s("td",w),T=function(e){k=e;for(var t=0;e>t;++t)w[t].style.display="block";for(var t=e;t<w.length;++t)w[t].style.display="none"};S.addEventListener("click",function(e){3>k&&(T(k+1),r(null))},!1),A.addEventListener("click",function(e){k>1&&(T(k-1),r(null))},!1);var E=s("input",null,{type:"text",value:"0.0"}),M=s("input",null,{type:"text",value:"10.0"}),L=s("input",null,{type:"checkbox"}),R=s("input",null,{type:"checkbox"}),O=s("input",null,{type:"checkbox",checked:void 0!==e.quantLeapThreshold}),P=s("input",null,{type:"text",value:e.quantLeapThreshold,disabled:!O.checked}),D=s("input",null,{type:"text",value:"50"}),I=s("input",null,{type:"checkbox"}),N=s("input",null,{type:"text"}),F=s("input",null,{type:"checkbox"}),B=null;if(e.stylesheet.styles.length>0){B=e.stylesheet.styles[0].style}var z=function(){if("string"==typeof e.config.name?h.value=e.config.name:h.value=e.dasSource.name,p.checked=e.pinned,e.forceHeight?D.value=""+e.forceHeight:B&&B.HEIGHT&&(D.value=""+B.HEIGHT),"number"==typeof e.quantLeapThreshold?(O.checked=!0,P.disabled=!1,parseFloat(P.value)!=e.quantLeapThreshold&&(P.value=e.quantLeapThreshold)):(O.checked=!1,P.disabled=!0),"number"==typeof e.subtierMax?N.value=""+e.subtierMax:N.value=""+(e.dasSource.subtierMax||e.browser.defaultSubtierMax),e.stylesheet.styles.length>0){for(var t=null,n=!1,r=!1,o=e.browser.zoomForCurrentScale(),a=0,s=0;s<e.stylesheet.styles.length;++s){var c=e.stylesheet.styles[s];if(!c.zoom||c.zoom==o){++a;var f=e.stylesheet.styles[s].style;t||(t=B=f),("LINEPLOT"==f.glyph||"HISTOGRAM"==f.glyph||"GRADIENT"==f.glyph||u(f.SCATTER))&&(n||(t=B=f),n=!0)}}if(!t)return;l.style.display=a==e.stylesheet.styles.length?"none":"block",r=n&&1==a;t.COLOR2||t.BGGRAD;n?(Z.style.display="table-row",$.style.display="table-row",Q.style.display="none",ee.style.display="none"):(Z.style.display="none",$.style.display="none",Q.style.display="table-row",I.checked=u(B.BUMP),N.disabled=!u(B.BUMP),ee.style.display="table-row",F.checked=u(B.LABEL)),r?(W.style.display="table-row",X.style.display="table-row"):(W.style.display="none",X.style.display="none");var x=1;t.COLOR1?(g.value=d(t.COLOR1).toHexString(),t.COLOR2&&(m.value=d(t.COLOR2).toHexString(),t.COLOR3?(v.value=d(t.COLOR3).toHexString(),x=3):x=2)):"LINEPLOT"==t.glyph||"DOT"==t.glyph&&t.FGCOLOR?g.value=d(t.FGCOLOR).toHexString():t.BGCOLOR&&(g.value=d(t.BGCOLOR).toHexString()),T(x),t._plusColor&&(y.value=d(t._plusColor).toHexString()||t._plusColor),t._minusColor&&(b.value=d(t._minusColor).toHexString()||t._minusColor),u(t.SCATTER)?_.value="SCATTER":_.value=t.glyph;var w,S;if(void 0!==t.MIN){var A=parseFloat(t.MIN);isNaN(A)||(w=A)}if(e.forceMinDynamic||void 0===t.MIN&&void 0===e.forceMin?(L.checked=!1,E.disabled=!0):(L.checked=!0,E.disabled=!1),void 0!==t.MAX){var A=parseFloat(t.MAX);isNaN(A)||(S=A)}e.forceMaxDynamic||void 0===t.MAX&&void 0===e.forceMax?(R.checked=!1,M.disabled=!0):(R.checked=!0,M.disabled=!1),void 0!=e.forceMin&&(w=e.forceMin),void 0!=e.forceMax&&(S=e.forceMax),"number"==typeof w&&w!=parseFloat(E.value)&&(E.value=w),"number"==typeof S&&S!=parseFloat(M.value)&&(M.value=S);var k=i(e.stylesheet);k?(q.style.display="table-row",H.checked="mismatch"===k.__SEQCOLOR,j.style.display="table-row",G.checked=u(k.__INSERTIONS),V.style.display="table-row",U.checked=void 0===k.__disableQuals||k.__disableQuals===!1,console.log(k.__disableQuals)):(q.style.display="none",j.style.display="none",V.style.display="none"),k&&H.checked&&!r?(K.style.display="table-row",Y.style.display="table-row"):(K.style.display="none",Y.style.display="none")}n&&e.browser.sourceAdapterIsCapable(e.featureSource,"quantLeap")?J.style.display="table-row":J.style.display="none"},H=s("input",null,{type:"checkbox"}),q=s("tr",[s("th","Highlight mismatches & strands"),s("td",H)]);H.addEventListener("change",function(t){var n=c(e.stylesheet),r=i(n);r.__SEQCOLOR=H.checked?"mismatch":"base",e.mergeStylesheet(n)});var G=s("input",null,{type:"checkbox"}),j=s("tr",[s("th","Show insertions"),s("td",G)]);G.addEventListener("change",function(t){var n=c(e.stylesheet),r=i(n);r.__INSERTIONS=G.checked?"yes":"no",e.mergeStylesheet(n)});var U=s("input",null,{type:"checkbox"}),V=s("tr",[s("th","Reflect base quality as base color transparency"),s("td",U)]);U.addEventListener("change",function(t){var n=c(e.stylesheet),r=i(n);r.__disableQuals=!U.checked,console.log(r.__disableQuals),e.mergeStylesheet(n)});var W=s("tr",[s("th","Style"),s("td",_)]),X=s("tr",[s("th",["Colour(s)",S,A]),C]),K=s("tr",[s("th","Plus Strand Color"),s("td",y)]),Y=s("tr",[s("th","Minus Strand Color"),s("td",b)]),Z=s("tr",[s("th","Min value"),s("td",[L," ",E])]),$=s("tr",[s("th","Max value"),s("td",[R," ",M])]),J=s("tr",[s("th","Threshold leap:"),s("td",[O," ",P])]),Q=s("tr",[s("th","Bump overlaps"),s("td",[I," limit: ",N])]),ee=s("tr",[s("th","Label features"),s("td",F)]),te=s("table",[s("tr",[s("th","Name",{},{width:"150px",textAlign:"right"}),h]),s("tr",[s("th","Pin to top"),p]),s("tr",[s("th","Height"),s("td",D)]),W,X,K,Y,Z,$,J,Q,ee,q,j,V]);z(),o.appendChild(te);var ne=s("button","Reset track",{className:"btn"},{marginLeft:"auto",marginRight:"auto",display:"block"});ne.addEventListener("click",function(t){e.setConfig({})},!1),o.appendChild(ne),h.addEventListener("input",function(t){e.mergeConfig({name:h.value})},!1),p.addEventListener("change",function(t){e.mergeConfig({pinned:p.checked})},!1);for(var ie=0;ie<w.length;++ie)w[ie].addEventListener("change",r,!1);y.addEventListener("change",r,!1),b.addEventListener("change",r,!1),_.addEventListener("change",function(i){var r=n(function(e){"SCATTER"===_.value?(e.SCATTER=!0,e.glyph="DOT",e.SIZE="3"):(e.glyph=_.value,e.SCATTER=void 0),t(e)});e.mergeStylesheet(r)},!1),L.addEventListener("change",function(t){var n={forceMinDynamic:!L.checked};E.disabled=!L.checked;var i=parseFloat(E.value);L.checked&&"number"==typeof i&&!isNaN(i)&&(n.forceMin=parseFloat(i)),e.mergeConfig(n)}),E.addEventListener("input",function(t){var n=parseFloat(E.value);"number"!=typeof n||isNaN(n)||e.mergeConfig({forceMin:n})},!1),R.addEventListener("change",function(t){var n={forceMaxDynamic:!R.checked};M.disabled=!R.checked;var i=parseFloat(M.value);R.checked&&"number"==typeof i&&!isNaN(i)&&(n.forceMax=parseFloat(i)),e.mergeConfig(n)}),M.addEventListener("input",function(t){var n=parseFloat(M.value);"number"!=typeof n||isNaN(n)||e.mergeConfig({forceMax:n})},!1),D.addEventListener("input",function(t){var n=parseFloat(D.value);"number"!=typeof n||isNaN(n)||e.mergeConfig({height:Math.min(500,0|n)})},!1);var re=function(){if(P.disabled=!O.checked,O.checked){var t=parseFloat(P.value);"number"!=typeof t||isNaN(t)||e.mergeConfig({quantLeapThreshold:parseFloat(P.value)})}else e.mergeConfig({quantLeapThreshold:null})};O.addEventListener("change",function(e){re()},!1),P.addEventListener("input",function(e){re()},!1),F.addEventListener("change",function(t){var i=n(function(e){e.LABEL=F.checked?"yes":"no"});e.mergeStylesheet(i)},!1),I.addEventListener("change",function(t){var i=n(function(e){e.BUMP=I.checked?"yes":"no"});e.mergeStylesheet(i)},!1),N.addEventListener("input",function(t){var n=parseInt(N.value);"number"==typeof n&&n>0&&e.mergeConfig({subtierMax:n})},!1),this.showToolPanel(o),this.setUiMode("tier"),e.addTierListener(z);var oe=e.browser.scale;e.browser.addViewListener(function(){e.browser.scale!=oe&&(oe=e.browser.scale,z())})}}},function(e,t,n){var i=n(247),r=i.Browser,o=n(248),a=o.shallowCopy,s=n(249),l=s.hex_sha1,u=n(251),c=u.copyStylesheet;r.prototype.exportFullConfig=function(e){e=e||{};var t={chr:this.chr,viewStart:0|this.viewStart,viewEnd:0|this.viewEnd,cookieKey:"dalliance_"+l(Date.now()),coordSystem:this.coordSystem,sources:this.exportSourceConfig(),chains:this.exportChains()};return this.prefix&&(t.prefix=this.prefix),t},r.prototype.exportChains=function(){var e={},t=this.chains||{};for(var n in t)e[n]=t[n].exportConfig();return e},r.prototype.exportSourceConfig=function(e){e=e||{};for(var t=[],n=0;n<this.tiers.length;++n){var i=this.tiers[n],r=a(i.dasSource);r.noPersist||(r.coords=void 0,r.props=void 0,r.disabled||(r.disabled=void 0),i.config.stylesheet?(r.style=c(i.config.stylesheet).styles,r.stylesheet_uri=void 0):r.style&&(r.style=c({styles:r.style}).styles),"string"==typeof i.config.name&&(r.name=i.config.name),void 0!==i.config.height&&(r.forceHeight=i.config.height),void 0!==i.config.forceMin&&(r.forceMin=i.config.forceMin),i.config.forceMinDynamic&&(r.forceMinDynamic=i.config.forceMinDynamic),void 0!==i.config.forceMax&&(r.forceMax=i.config.forceMax),void 0!==i.config.bumped&&(r.bumped=i.config.bumped),i.config.forceMaxDynamic&&(r.forceMaxDynamic=i.config.forceMaxDynamic),t.push(r))}return t},r.prototype.exportPageTemplate=function(e){e=e||{};var t='<html>\n  <head>\n    <script language="javascript" src="'+this.resolveURL("$$dalliance-compiled.js")+'"></script>\n    <script language="javascript">\n      var dalliance_browser = new Browser('+JSON.stringify(this.exportFullConfig(e),null,2)+');\n    </script>\n  </head>\n  <body>\n    <div id="svgHolder">Dalliance goes here</div>\n  </body>\n<html>\n';return t}},function(e,t,n){var i=n(247),r=i.Browser,o=n(248),a=o.makeElement,s=o.removeChildren;r.prototype.openExportPanel=function(){var e=this;if("export"===this.uiMode)this.hideToolPanel(),this.setUiMode("none");else{var t=a("div",null,{className:"export-form"}),n=a("select");n.appendChild(a("option","SVG",{value:"svg"})),n.appendChild(a("option","Image",{value:"png"})),n.appendChild(a("option","Dalliance config",{value:"config"})),n.appendChild(a("option","Dalliance sources",{value:"sources"})),n.appendChild(a("option","Dalliance page",{value:"page"})),n.value="svg",n.addEventListener("change",function(e){s(u),p()},!1),t.appendChild(a("p",["Export as: ",n]));var i=a("input",null,{type:"checkbox",checked:this.exportHighlights});i.addEventListener("change",function(t){e.exportHighlights=i.checked,e.storeStatus()},!1);var r=a("input",null,{type:"checkbox",checked:this.exportRuler});r.addEventListener("change",function(t){e.exportRuler=r.checked,e.storeStatus()},!1);var o=a("input",null,{type:"text",value:"1.0"}),l=a("button","Export",{className:"btn btn-primary"});l.addEventListener("click",function(t){s(u);var l,c,h,d;if("svg"===n.value)l=URL.createObjectURL(e.makeSVG({highlights:i.checked,ruler:r.checked?e.rulerLocation:"none"})),c="SVG",h="image/svg",d="dalliance-view.svg";else if("png"===n.value){var f=parseFloat(o.value);if(.1>f||f>10)return void alert("bad scale "+f);l=e.exportImage({highlights:i.checked,ruler:r.checked?e.rulerLocation:"none",resolutionMultiplier:f}),c="Image",h="image/png",d="dalliance-view.png"}else if("config"===n.value){var p=JSON.stringify(e.exportFullConfig(),null,2),_=new Blob([p],{type:"text/plain"});l=URL.createObjectURL(_),c="Configuration",h="text/plain",d="dalliance-config.json"}else if("sources"===n.value){var p=JSON.stringify(e.exportSourceConfig(),null,2),_=new Blob([p],{type:"text/plain"});l=URL.createObjectURL(_),c="Source array",h="text/plain",d="dalliance-sources.json"}else if("page"===n.value){var g=e.exportPageTemplate(),h="text/html",_=new Blob([g],{type:h});l=URL.createObjectURL(_),c="Page template",d="dalliance-view.html"}if(l){var m=a("a","[Download]",{href:l,download:d,type:h}),v=a("a","[Preview in browser]",{href:l,type:h,target:"_new"});u.appendChild(a("p",[""+c+" created: ",m,v]))}},!1),e.addViewListener(function(){s(u)}),e.addTierListener(function(){s(u)});var u=a("p",""),c=a("tr",[a("th","Include highlights",{},{width:"200px",textAlign:"right"}),a("td",i)]),h=a("tr",[a("th","Include vertical guideline"),a("td",r)]),d=a("tr",[a("th","Scale multiplier"),a("td",o)]),f=a("table",[c,h,d]),p=function(){var e=n.value;c.style.display="svg"==e||"png"==e?"table-row":"none",h.style.display="svg"==e||"png"==e?"table-row":"none",d.style.display="png"==e?"table-row":"none"};p(),t.appendChild(f),t.appendChild(l),t.appendChild(u),"none"!==this.uiMode&&this.hideToolPanel(),this.browserHolder.insertBefore(t,this.svgHolder),this.activeToolPanel=t,this.setUiMode("export")}}},function(e,t,n){"use strict";function i(e,t,n,i){e.fillText(t,n-e.measureText(t).width,i)}var r=n(247),o=r.Browser,a=n(268),s=a.OverlayLabelCanvas,l=n(272),u=l.formatQuantLabel,c=n(273).drawSeqTierGC;o.prototype.exportImage=function(e){e=e||{};for(var t=this.featurePanelWidth,n=3,r=0,o=0;o<this.tiers.length;++o){o>0&&(r+=n);var a=this.tiers[o];void 0!==a.layoutHeight&&(r+=a.layoutHeight)}var l=e.resolutionMultiplier||1,h=200,d=(t+h)*l|0,f=r*l|0,p=makeElement("canvas",null,{width:d,height:f}),_=p.getContext("2d");_.fillStyle="white",_.fillRect(0,0,d,f),_.scale(l,l);for(var g=0,o=0;o<this.tiers.length;++o){var a=this.tiers[o],m=(a.glyphCacheOrigin-this.viewStart)*this.scale,v=new s;_.save(),_.translate(0,g),_.save(),_.beginPath(),_.moveTo(h,0),_.lineTo(h+t,0),_.lineTo(h+t,a.layoutHeight),_.lineTo(h,a.layoutHeight),_.closePath(),_.clip(),_.translate(h,0),_.save(),_.translate(m,0),a.subtiers?a.paintToContext(_,v,m+1e3):c(a,a.currentSequence,_),_.restore(),_.save(),_.translate(m,0),v.draw(_,-m,t-m),_.restore(),_.restore();for(var y=!1,b=0,x=a.subtiers||[],w=0;w<x.length;++w){var S=x[w];if(S.quant){y=!0;var A=S.quant,k=S.height,C=2;k>40&&(C=1+(k/20|0));var T=k/(C-1),E=(A.max-A.min)/(C-1);_.beginPath(),_.moveTo(h+5,b),_.lineTo(h,b),_.lineTo(h,b+S.height),_.lineTo(h+5,b+S.height);for(var M=1;C-1>M;++M){var L=M*T;_.moveTo(h,b+L),_.lineTo(h+3,b+L)}_.strokeStyle="black",_.strokeWidth=2,_.stroke(),_.fillStyle="black",i(_,u(A.max),h-3,b+7),i(_,u(A.min),h-3,b+S.height);for(var M=1;C-1>M;++M){var L=M*T;i(_,u(1*A.max-M*E),h-3,b+L+3)}}b+=S.height+n}var R;R="string"==typeof a.config.name?a.config.name:a.dasSource.name;var O=_.measureText(R).width;_.fillStyle="black",_.fillText(R,h-(y?22:12)-O,(a.layoutHeight+6)/2),_.restore(),g+=a.layoutHeight+n}if(e.highlights){_.save(),_.beginPath(),_.moveTo(h,0),_.lineTo(h+t,0),_.lineTo(h+t,g),_.lineTo(h,g),_.closePath(),_.clip(),_.translate(h+m,0);for(var P=this.viewStart,D=this.viewStart,I=this.viewEnd,N=0;N<this.highlights.length;++N){var k=this.highlights[N];(k.chr===this.chr||k.chr==="chr"+this.chr)&&k.min<I&&k.max>D&&(_.globalAlpha=this.defaultHighlightAlpha,_.fillStyle=this.defaultHighlightFill,_.fillRect((k.min-P)*this.scale,0,(k.max-k.min)*this.scale,g))}_.restore()}var F=-1;return"center"==e.ruler?F=h+(this.viewEnd-this.viewStart+1)*this.scale/2:"left"==e.ruler?F=h:"right"==e.ruler&&(F=h+(this.viewEnd-this.viewStart+1)*this.scale),F>=0&&(_.strokeStyle="blue",_.beginPath(),_.moveTo(F,0),_.lineTo(F,g),_.stroke()),p.toDataURL("image/png")}},function(e,t,n){var i=n(247),r=i.Browser,o=n(248),a=(o.makeElement,o.makeElementNS),s=n(275),l=n(273).svgSeqTier,u=n(270),c=u.NS_SVG,h=u.NS_XLINK,d=u.SVGPath,f=n(272),p=f.formatQuantLabel;r.prototype.makeSVG=function(e){e=e||{};var t=e.minTierHeight||20,n=3,i=this,r=document.implementation.createDocument(c,"svg",null),o=a(c,"g",null,{fontFamily:"helvetica",fontSize:"8pt"});r.documentElement.appendChild(o);var u=200,f=a(c,"a",a(c,"text","Graphics from Dalliance "+s,{x:(i.featurePanelWidth+u+20)/2,y:30,strokeWidth:0,fontSize:"12pt",textAnchor:"middle",fill:"blue"}));f.setAttribute("xmlns:xlink",h),f.setAttribute("xlink:href","http://www.biodalliance.org/"),o.appendChild(f);var _=a(c,"rect",null,{x:u,y:50,width:i.featurePanelWidth,height:1e5}),g=a(c,"clipPath",_,{id:"featureClip"});o.appendChild(g);for(var m=70,v=a(c,"g",null,{}),y=0;y<i.tiers.length;++y){var b=i.tiers[y],x=a(c,"g",null,{clipPath:"url(#featureClip)",clipRule:"nonzero"}),w=a(c,"g"),S=m,A=a(c,"rect",null,{x:0,y:S,width:"10000",height:50,fill:b.background});if(x.appendChild(A),b.sequenceSource){var k=l(b,b.currentSequence);x.appendChild(a(c,"g",k,{transform:"translate("+u+", "+m+")"})),m+=80}else{if(!b.subtiers)continue;for(var C=(b.glyphCacheOrigin-i.viewStart)*i.scale,T=!1,E=0;E<b.subtiers.length;++E){m+=n;for(var M=b.subtiers[E],L=[],R=0;R<M.glyphs.length;++R){var O=M.glyphs[R];L.push(O.toSVG())}if(x.appendChild(a(c,"g",L,{transform:"translate("+(u+C)+", "+m+")"})),M.quant){T=!0;var P=M.quant,D=M.height,I=2;D>40&&(I=1+(D/20|0));var N=D/(I-1),F=(P.max-P.min)/(I-1),B=new d;B.moveTo(u+5,m),B.lineTo(u,m),B.lineTo(u,m+M.height),B.lineTo(u+5,m+M.height);for(var z=1;I-1>z;++z){var H=z*N;B.moveTo(u,m+H),B.lineTo(u+3,m+H)}w.appendChild(a(c,"path",null,{d:B.toPathData(),fill:"none",stroke:"black",strokeWidth:"2px"})),w.appendChild(a(c,"text",p(P.max),{x:u-3,y:m+7,textAnchor:"end"})),w.appendChild(a(c,"text",p(P.min),{x:u-3,y:m+M.height,textAnchor:"end"}));for(var z=1;I-1>z;++z){var H=z*N;w.appendChild(a(c,"text",p(1*P.max-z*F),{x:u-3,y:m+H+3,textAnchor:"end"}))}}m+=M.height+n}t>m-S&&(m=S+t)}var q;q="string"==typeof b.config.name?b.config.name:b.dasSource.name,w.appendChild(a(c,"text",q,{x:u-(T?20:12),y:(m+S+8)/2,fontSize:"10pt",textAnchor:"end"})),A.setAttribute("height",m-S),v.appendChild(a(c,"g",[x,w]))}if(e.highlights)for(var G=this.highlights||[],j=0;j<G.length;++j){var D=G[j];if((D.chr==this.chr||D.chr=="chr"+this.chr)&&D.min<this.viewEnd&&D.max>this.viewStart){var U=(Math.max(D.min,this.viewStart)-this.viewStart)*this.scale,V=(Math.min(D.max,this.viewEnd)-this.viewStart)*this.scale;v.appendChild(a(c,"rect",null,{x:u+U,y:70,width:V-U,height:m-70,stroke:"none",fill:this.defaultHighlightFill,fillOpacity:this.defaultHighlightAlpha}))}}var W=-1;"center"==e.ruler?W=u+(this.viewEnd-this.viewStart)*this.scale/2:"left"==e.ruler?W=u:"right"==e.ruler&&(W=u+(this.viewEnd-this.viewStart)*this.scale),W>=0&&v.appendChild(a(c,"line",null,{x1:W,y1:70,x2:W,y2:m,stroke:"blue"})),o.appendChild(v),r.documentElement.setAttribute("width",i.featurePanelWidth+20+u),r.documentElement.setAttribute("height",m+50);var X=new Blob([(new XMLSerializer).serializeToString(r)],{type:"image/svg+xml"});return X}},function(e,t,n){"use strict";var i=n(247),r=i.Browser,o=n(254),a=o.sourceDataURI,s=o.sourcesAreEqual,l=n(275),u=n(248),c=u.miniJSONify,h=n(249),d=h.hex_sha1;r.prototype.nukeStatus=function(){delete localStorage["dalliance."+this.cookieKey+".view-chr"],delete localStorage["dalliance."+this.cookieKey+".view-start"],delete localStorage["dalliance."+this.cookieKey+".view-end"],delete localStorage["dalliance."+this.cookieKey+".current-seq-length"],delete localStorage["dalliance."+this.cookieKey+".showing-alt-zoom"],delete localStorage["dalliance."+this.cookieKey+".saved-zoom"],delete localStorage["dalliance."+this.cookieKey+".sources"],delete localStorage["dalliance."+this.cookieKey+".hubs"],delete localStorage["dalliance."+this.cookieKey+".version"],delete localStorage["dalliance."+this.cookieKey+".reverse-scrolling"],delete localStorage["dalliance."+this.cookieKey+".reverse-key-scrolling"],delete localStorage["dalliance."+this.cookieKey+".ruler-location"]},r.prototype.storeStatus=function(){this.storeViewStatus(),this.storeTierStatus()},r.prototype.storeViewStatus=function(){!this.cookieKey||this.noPersist||this.noPersistView||(localStorage["dalliance."+this.cookieKey+".view-chr"]=this.chr,localStorage["dalliance."+this.cookieKey+".view-start"]=0|this.viewStart,localStorage["dalliance."+this.cookieKey+".view-end"]=0|this.viewEnd,localStorage["dalliance."+this.cookieKey+".showing-alt-zoom"]=""+this.isSnapZooming,localStorage["dalliance."+this.cookieKey+".saved-zoom"]=this.savedZoom,this.currentSeqMax&&(localStorage["dalliance."+this.cookieKey+".current-seq-length"]=this.currentSeqMax))},r.prototype.storeTierStatus=function(){if(this.cookieKey&&!this.noPersist){for(var e=[],t=0;t<this.tiers.length;++t){var n=this.tiers[t],i=n.dasSource;i.noPersist||e.push({source:n.dasSource,config:n.config||{}})}localStorage["dalliance."+this.cookieKey+".sources"]=JSON.stringify(e);for(var r={},o=[],a=0;a<this.hubObjects.length;++a){var s=this.hubObjects[a],u={url:s.hub.url,genome:s.genome};s.credentials&&(u.credentials=s.credentials),s.mapping&&(u.mapping=s.mapping),r[u.url]=!0,o.push(u)}for(var a=0;a<this.hubs.length;++a){var u=this.hubs[a];"string"==typeof u&&(u={url:u}),r[u.url]||o.push(u)}localStorage["dalliance."+this.cookieKey+".hubs"]=JSON.stringify(o),localStorage["dalliance."+this.cookieKey+".reverse-scrolling"]=this.reverseScrolling,localStorage["dalliance."+this.cookieKey+".reverse-key-scrolling"]=this.reverseKeyScrolling,localStorage["dalliance."+this.cookieKey+".single-base-highlight"]=this.singleBaseHighlight,localStorage["dalliance."+this.cookieKey+".ruler-location"]=this.rulerLocation,localStorage["dalliance."+this.cookieKey+".export-ruler"]=this.exportRuler,localStorage["dalliance."+this.cookieKey+".export-highlights"]=this.exportHighlights,localStorage["dalliance."+this.cookieKey+".version"]=l.CONFIG}},r.prototype.restoreStatus=function(){if(!this.noPersist){var e=localStorage["dalliance."+this.cookieKey+".version"];if(e=e?0|e:-100,l.CONFIG==e){var t=localStorage["dalliance."+this.cookieKey+".configHash"]||"",n=d(c({sources:this.sources,hubs:this.hubs}));if(n!=t)return void(localStorage["dalliance."+this.cookieKey+".configHash"]=n);for(var i={},r=0;r<this.sources.length;++r){var o=this.sources[r];if(o){var u=a(o),h=i[u];h||(i[u]=h=[]),h.push(o)}}if(!this.noPersistView){var f=localStorage["dalliance."+this.cookieKey+".view-chr"],p=0|localStorage["dalliance."+this.cookieKey+".view-start"],_=0|localStorage["dalliance."+this.cookieKey+".view-end"];if(f&&p&&_){this.chr=f,this.viewStart=p,this.viewEnd=_;var g=localStorage["dalliance."+this.cookieKey+".current-seq-length"];g&&(this.currentSeqMax=0|g),this.isSnapZooming="true"==localStorage["dalliance."+this.cookieKey+".showing-alt-zoom"];var m=parseFloat(localStorage["dalliance."+this.cookieKey+".saved-zoom"]);"number"!=typeof m||isNaN(m)||(this.savedZoom=m)}}var v=localStorage["dalliance."+this.cookieKey+".reverse-scrolling"];this.reverseScrolling=v&&"true"==v;var y=localStorage["dalliance."+this.cookieKey+".reverse-key-scrolling"];this.reverseKeyScrolling=y&&"true"==y;var b=localStorage["dalliance."+this.cookieKey+".single-base-highlight"];this.singleBaseHighlight=b&&"true"==b;var x=localStorage["dalliance."+this.cookieKey+".ruler-location"];x&&(this.rulerLocation=x);var w=localStorage["dalliance."+this.cookieKey+".export-ruler"];w&&(this.exportRuler="true"===w);var w=localStorage["dalliance."+this.cookieKey+".export-highlights"];w&&(this.exportHighlights="true"===w);var S=localStorage["dalliance."+this.cookieKey+".sources"];if(S){var A=JSON.parse(S);this.sources=[],this.restoredConfigs=[];for(var r=0;r<A.length;++r){var o=this.sources[r]=A[r].source;this.restoredConfigs[r]=A[r].config;for(var u=a(o),h=i[u]||[],k=0;k<h.length;++k){var C=h[k];if(s(o,C))for(var T in C)C.hasOwnProperty(T)&&("function"==typeof C[T]||C[T]instanceof Blob)&&(o[T]=C[T])}}}var E=localStorage["dalliance."+this.cookieKey+".hubs"];return E&&(this.hubs=JSON.parse(E)),!0}}},r.prototype.reset=function(){for(var e=this.tiers.length-1;e>=0;--e)this.removeTier({index:e},!0);for(var e=0;e<this.defaultSources.length;++e){var t=this.defaultSources[e];t.disabled||this.addTier(this.defaultSources[e])}this.highlights.splice(0,this.highlights.length),this.setLocation(this.defaultChr,this.defaultStart,this.defaultEnd)}},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<e.length;++n){var i=e[n];i===t?i.classList.add("active"):i.classList.remove("active")}}var r=n(247),o=r.Browser,a=n(254),s=a.sourcesAreEqual,l=n(248),u=l.makeElement,c=l.removeChildren,h=l.Observed,d=n(274),f=d.THUB_COMPARE,p=d.connectTrackHub,_=n(289),g=_.makeTreeTableSection,m=n(290).probeResource,v=n(277),y=v.URLFetchable,b=v.BlobFetchable,x=v.readInt,w=n(291),S=w.unbgzf,A=n(292),k=(A.BAM_MAGIC,A.BAI_MAGIC),C=n(293),T=C.TABIX_MAGIC,E=n(251),M=E.DASSource,L=E.DASSegment,R=E.DASRegistry,O=E.coordsMatch,P=n(294).EncodeFetchable;o.prototype.currentlyActive=function(e){for(var t=0;t<this.tiers.length;++t)if(s(this.tiers[t].dasSource,e))return this.tiers[t];return!1},o.prototype.makeButton=function(e,t){var n=u("a",e,{href:"#"});return t&&this.makeTooltip(n,t),u("li",n)},o.prototype.showTrackAdder=function(e){function t(e){we.style.display="none",de.style.display="none",xe.style.display="none",ae=!1,c(ue);for(var t=u("div",null,{},{width:"100%"}),n=[],i=0;i<e.length;++i)n.push(e[i]);n.sort(function(e,t){return e.shortLabel.toLowerCase().trim().localeCompare(t.shortLabel.toLowerCase().trim())});for(var r=[],o=[],a=0;a<n.length;++a){var s=n[a];s.children&&s.children.length>0&&"multiWig"!=s.container?r.push(s):o.push(s)}o.length>0&&r.push({shortLabel:"Others",priority:-1e8,children:o}),r.sort(f);for(var l=[],h=0;h<r.length;++h){var d=r[h],p=d;!p.dimensions&&p._parent&&p._parent.dimensions&&(p=p._parent);var _={};if(p.dimensions)for(var m=p.dimensions.split(/(\w+)=(\w+)/),v=0;v<m.length-2;v+=3)_[m[v+1]]=m[v+2];if(_.dimX&&_.dimY){for(var y=_.dimX,b=_.dimY,x=p.subgroups[y],w=p.subgroups[b],S={},A=0;A<d.children.length;++A){var k=d.children[A],C=k.sgm[y],T=k.sgm[b];S[C]||(S[C]={}),S[C][T]=k}var E=u("table",null,{className:"table table-striped table-condensed"},{tableLayout:"fixed"}),M=u("tr");M.appendChild(u("th",null,{},{width:"150px",height:"100px"}));for(var L=0;L<x.titles.length;++L){var R=u("th",u("div",x.titles[L],{},{transform:"rotate(-60deg)",transformOrigin:"0% 100%",webkitTransform:"rotate(-60deg) translate(20px,10px)",webkitTransformOrigin:"0% 100%",textAlign:"left"}),{},{width:"35px",height:"100px",verticalAlign:"bottom"});M.appendChild(R)}E.appendChild(M);for(var O=u("tbody",null,{className:"table table-striped table-condensed"}),P=0;P<w.titles.length;++P){var T=w.tags[P],I=u("tr");I.appendChild(u("th",w.titles[P]),{});for(var N=0;N<x.titles.length;++N){var C=x.tags[N],F=u("td");if(S[C]&&S[C][T]){var s=S[C][T],B=s.toDallianceSource();if(!B)continue;var z=u("tr"),H=u("td");H.style.textAlign="center";var q=u("input");q.type="checkbox",q.dalliance_source=B,ce&&(q.dalliance_mapping=ce),l.push(q),F.appendChild(q),q.addEventListener("change",function(e){e.target.checked?D.addTier(e.target.dalliance_source):D.removeTier(e.target.dalliance_source)})}I.appendChild(F)}O.appendChild(I)}E.appendChild(O),t.appendChild(g(d.shortLabel,E,0==h))}else{var G=u("tbody",null,{className:"table table-striped table-condensed"}),j=u("table",G,{className:"table table-striped table-condensed"},{width:"100%",tableLayout:"fixed"}),U=0;d.children.sort(f);for(var i=0;i<d.children.length;++i){var s=d.children[i],B=s.toDallianceSource();if(B){var z=u("tr"),H=u("td",null,{},{width:"30px"});H.style.textAlign="center";var q=u("input");q.type="checkbox",q.dalliance_source=B,ce&&(q.dalliance_mapping=ce),l.push(q),H.appendChild(q),q.addEventListener("change",function(e){e.target.checked?D.addTier(e.target.dalliance_source):D.removeTier(e.target.dalliance_source)}),z.appendChild(H);var V=u("td");V.appendChild(document.createTextNode(s.shortLabel)),s.longLabel&&s.longLabel.length>0&&D.makeTooltip(V,s.longLabel),z.appendChild(V),G.appendChild(z),++U}}r.length>1||"Others"!==d.shortLabel?t.appendChild(g(d.shortLabel,j,0==h)):t.appendChild(j)}}var W=function(){for(var e=0;e<l.length;++e){var t=l[e],n=D.currentlyActive(t.dalliance_source);n?(t.checked=!0,t.disabled=null!=n.sequenceSource):t.checked=!1}};W(),D.addTierListener(function(e){W()}),ue.appendChild(t)}function n(){i(N,K),ae="bin",we.style.display="none",de.style.display="inline",xe.style.display="none",c(ue);var e=u("div",null,{},{paddingLeft:"10px",paddingRight:"10px"});e.appendChild(u("h3","Add custom URL-based data")),e.appendChild(u("p",["You can add indexed binary data hosted on an web server that supports CORS (",u("a","full details",{href:"http://www.biodalliance.org/bin.html"}),").  Currently supported formats are bigwig, bigbed, and indexed BAM."])),e.appendChild(u("br")),e.appendChild(document.createTextNode("URL: ")),Q=u("input","",{size:80,value:"http://www.biodalliance.org/datasets/ensGene.bb"},{width:"100%"}),e.appendChild(Q),e.appendChild(u("br")),e.appendChild(u("b","- or -")),e.appendChild(u("br")),e.appendChild(document.createTextNode("File: ")),ie=u("input",null,{type:"file",multiple:"multiple"}),e.appendChild(ie),e.appendChild(u("p",'Clicking the "Add" button below will initiate a series of test queries.')),ue.appendChild(e),Q.focus()}function r(){i(N,$),we.style.display="none",de.style.display="inline",xe.style.display="none",ae="hub-connect",we.style.visibility="hidden",c(ue);var e=u("div",null,{},{paddingLeft:"10px",paddingRight:"10px"});e.appendChild(u("h3","Connect to a track hub.")),e.appendChild(u("p",['Enter the top-level URL (usually points to a file called "hub.txt") of a UCSC-style track hub'])),Q=u("input","",{size:120,value:"http://www.biodalliance.org/datasets/testhub/hub.txt"},{width:"100%"}),e.appendChild(Q),ue.appendChild(e),Q.focus()}function o(){i(N,X),we.style.display="none",de.style.display="inline",xe.style.display="none",ae="das",c(ue);var e=u("div",null,{},{paddingLeft:"10px",
paddingRight:"10px"});e.appendChild(u("h3","Add custom DAS data")),e.appendChild(u("p","This interface is intended for adding custom or lab-specific data.  Public data can be added more easily via the registry interface.")),e.appendChild(document.createTextNode("URL: ")),e.appendChild(u("br")),Q=u("input","",{size:80,value:"http://www.derkholm.net:8080/das/medipseq_reads/"},{width:"100%"}),e.appendChild(Q),e.appendChild(u("p",'Clicking the "Add" button below will initiate a series of test queries.  If the source is password-protected, you may be prompted to enter credentials.')),ue.appendChild(e),Q.focus()}function a(){if(ae){if("das"===ae){var e=Q.value.trim();/^.+:\/\//.exec(e)||(e="http://"+e);var t=new M({name:"temporary",uri:e});fe(t)}else if("bin"===ae){var i=ie.files;if(i&&i.length>0)ve(i);else{var e=Q.value.trim();/^.+:\/\//.exec(e)||(e="http://"+e);var a={uri:e},l=e.toLowerCase();0==l.indexOf("https://www.encodeproject.org/")&&l.indexOf("@@download")>=0&&(a.transport="encode"),_e(a)}}else if("reset"===ae)o();else if("reset-bin"===ae)n();else if("reset-hub"===ae)r();else if("prompt-bai"===ae){var i=ie.files;i&&i.length>0&&i[0]?(se.baiBlob=i[0],v(se)):d(se)}else if("prompt-tbi"===ae){var i=ie.files;i&&i.length>0&&i[0]?(se.indexBlob=i[0],w(se)):_(se)}else if("finalize"===ae||"finalize-bin"===ae){se.name=ee.value;var u=te.value;"__default__"!=u?se.mapping=u:se.mapping=void 0,ne&&(se.maxbins=ne.checked),re.value.length>1&&oe.value.length>1&&(se.xUser=re.value,se.xPass=oe.value),D.addTier(se),"finalize-bin"==ae?n():o()}else if("hub-connect"===ae){var e=Q.value.trim();/^.+:\/\//.exec(e)||(e="http://"+e),s(e)}else if("multiple"===ae){for(var c=0;c<me.length;++c){var h=me[c];if(!h.hidden&&("bam"!=h.tier_type||h.indexBlob||h.indexUri)&&("tabix"!=h.tier_type||h.indexBlob||h.indexUri)){var t=pe(h);t&&(t.noPersist=!0,D.addTier(t))}}n()}}else D.removeAllPopups()}function s(e,n,r){n=n||{};for(var o=0;o<D.hubObjects.length;++o){var a=D.hubObjects[o];if(a.hub.url==e){for(var l=0;l<N.length;++l)N[l].hub==a&&i(N,N[l]);return void a.getTracks(function(e,n){n&&console.log(n),t(e)})}}p(e,function(o,a){if(a)return r?(c(ue),ue.appendChild(u("h2","Error connecting to track hub")),ue.appendChild(u("p",a)),void(ae="reset-hub")):s(e,{credentials:!0},!0);var l=null,h=null;for(var d in o.genomes){var f=null,p=!1;if(d==D.coordSystem.ucscName)p=!0;else for(var _ in D.chains){var g=D.chains[_];d==g.coords.ucscName&&(f=_,p=!0)}if(p){var m={url:e,genome:d};n.credentials&&(m.credentials=!0),f&&(m.mapping=f,o.genomes[d].mapping=f),D.hubs.push(m),D.hubObjects.push(o.genomes[d]);var v=U(o.genomes[d]);J.appendChild(v),f&&l||(l=o.genomes[d],h=v)}}return l?(D.notifyTier(),i(N,h),l.getTracks(function(e,n){t(e)}),void 0):(c(ue),ue.appendChild(u("h2","No data for this genome")),ue.appendChild(u("p","This URL appears to be a valid track-hub, but it doesn't contain any data for the coordinate system of this browser")),ue.appendChild(u("p","coordSystem.ucscName = "+D.coordSystem.ucscName)),void(ae="reset-hub"))},n)}function l(e,t){function n(){return t?ge(e):l(e,!0)}var i=e.uri;if(t){var r=/(.+)\/[^\/]+\/?/.exec(i);r&&(i=r[1]+"/sources")}new R(i,{credentials:e.credentials}).sources(function(t){if(!t||0==t.length)return n();var i=null;if(1==t.length)i=t[0];else for(var r=0;r<t.length;++r)if(t[r].uri===e.uri){i=t[r];break}var o=!1,a=!1;if(i&&(e.name=i.name,e.desc=i.desc,i.maxbins?e.maxbins=!0:e.maxbins=!1,i.capabilities&&(e.capabilities=i.capabilities),a=!0,i.coords&&1==i.coords.length)){var s=i.coords[0];if(O(s,D.coordSystem))o=!0;else if(D.chains)for(var l in D.chains)O(s,D.chains[l].coords)&&(e.mapping=l,o=!0)}return ge(e,o,a)},function(){return n()})}function d(e){we.style.display="none",de.style.display="inline",xe.style.display="inline",c(ue),ae="prompt-bai",ue.appendChild(u("h2","Select an index file")),ue.appendChild(u("p","Dalliance requires a BAM index (.bai) file when displaying BAM data.  These normally accompany BAM files.  For security reasons, web applications like Dalliance can only access local files which you have explicity selected.  Please use the file chooser below to select the appropriate BAI file")),ue.appendChild(document.createTextNode("Index file: ")),ie=u("input",null,{type:"file"}),ue.appendChild(ie),se=e}function _(e){we.style.display="none",de.style.display="inline",xe.style.display="inline",c(ue),ae="prompt-tbi",ue.appendChild(u("h2","Select an index file")),ue.appendChild(u("p","Dalliance requires a Tabix index (.tbi) file when displaying VCF data.  For security reasons, web applications like Dalliance can only access local files which you have explicity selected.  Please use the file chooser below to select the appropriate BAI file")),ue.appendChild(document.createTextNode("Index file: ")),ie=u("input",null,{type:"file"}),ue.appendChild(ie),se=e}function v(e){var t;t=e.baiBlob?new b(e.baiBlob):"encode"==e.transport?new P(e.bamURI+".bai"):new y(e.bamURI+".bai",{credentials:e.credentials}),t.slice(0,256).fetch(function(t){var n=!1;if(t){var i=new Uint8Array(t),r=x(i,0);n=r==k}return n?ge(e,!1,!1,!0):A("You have selected a valid BAM file, but a corresponding index (.bai) file was not found.  Please index your BAM (samtools index) and place the BAI file in the same directory")})}function w(e){var t;t=e.indexBlob?new b(e.indexBlob):new y(e.uri+".tbi"),t.slice(0,65536).fetch(function(t){var n=!1;if(t){var i=new Uint8Array(t);if(31==i[0]||139==i[1]){var r=S(t);i=new Uint8Array(r);var o=x(i,0);n=o==T}}return n?ge(e,!1,!1,!0):A('You have selected a valid VCF file, but a corresponding index (.tbi) file was not found.  Please index your VCF ("tabix -p vcf -f myfile.vcf.gz") and place the .tbi file in the same directory')})}function A(e){we.style.display="none",de.style.display="inline",xe.style.display="inline",c(ue),e=e||"Custom data format not recognized",ue.appendChild(u("h2","Error adding custom data")),ue.appendChild(u("p",e)),ue.appendChild(u("p","Currently supported formats are bigBed, bigWig, and BAM.")),ae="reset-bin"}if("add"===this.uiMode)return this.hideToolPanel(),void this.setUiMode("none");var C,E,D=this,I=u("div",null,{className:"dalliance"},{width:"100%",display:"inline-block",boxSizing:"border-box",MozBoxSizing:"border-box",verticalAlign:"top",paddingRight:"15px"}),N=[];if(!this.noRegistryTabs){var F=this.makeButton("Registry","Browse compatible datasources from the DAS registry");N.push(F);for(var B in this.mappableSources){var z=function(e){var t=D.makeButton(D.chains[e].srcTag,"Browse datasources mapped from "+D.chains[e].srcTag);N.push(t),t.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),i(N,t),C(D.mappableSources[e],e)},!1)};z(B)}}for(var H={},q=0;q<this.defaultSources.length;++q){var G=this.defaultSources[q],j=G.group||"Defaults";H[j]?H[j].push(G):H[j]=[G]}var U=function(e){var n=e.hub,o=u("i",null,{className:"fa fa-list-alt"},{cursor:"context-menu"}),a=n.shortLabel||"Unknown";e.mapping&&(a=a+" ("+e.genome+")");var s=u("span",[a," ",o]),l=D.makeButton(s,n.longLabel);return l.hub=e,N.push(l),l.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),i(N,l),c(ue);var r=D.makeLoader(24);r.style.marginLeft="auto",r.style.marginRight="auto",r.style.marginTop="100px",ue.appendChild(u("div",r,null,{textAlign:"center"})),we.style.display="none",de.style.display="none",xe.style.display="none",e.getTracks(function(e,n){n&&console.log(n),t(e)})},!1),o.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var n=u("li",u("a","Remove hub")),o=u("li",u("a","Enable all")),a=u("li",u("a","Disable all")),s=u("ul",[n,o,a],{className:"dropdown-menu"},{display:"block"}),c=t.clientX,h=t.clientY;c+=document.documentElement.scrollLeft||document.body.scrollLeft,h+=document.documentElement.scrollTop||document.body.scrollTop,s.style.position="absolute",s.style.top=""+(h+10)+"px",s.style.left=""+(c-30)+"px",D.hPopupHolder.appendChild(s);var d=function(e){console.log("cc"),document.body.removeEventListener("click",d,!0),D.hPopupHolder.removeChild(s)};document.body.addEventListener("click",d,!0),n.addEventListener("click",function(t){for(var n=0;n<D.hubObjects.length;++n)if(D.hubObjects[n].absURL==e.absURL){D.hubObjects.splice(n,1);break}for(var n=0;n<D.hubs.length;++n){var o=D.hubs[n];if("string"==typeof o&&(o={url:o}),o.url==e.hub.url&&!o.genome||o.genome==e.genome){D.hubs.splice(n,1);break}}D.notifyTier(),J.removeChild(l),i(N,$),r()},!1),o.addEventListener("click",function(t){e.getTracks(function(e,t){t&&console.log(t);for(var n=0;n<e.length;++n){var i=e[n].toDallianceSource();D.currentlyActive(i)||D.addTier(i)}})},!1),a.addEventListener("click",function(t){e.getTracks(function(e,t){t&&console.log(t);for(var n=0;n<e.length;++n){var i=e[n].toDallianceSource();D.currentlyActive(i)&&D.removeTier(i)}})},!1)},!1),l},V=null,W=null;for(var j in H)!function(e,t){var n=D.makeButton(e,"Browse the default set of data for this browser");n.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),i(N,n),C(new h(t))},!1),N.push(n),V||(V=n,W=t)}(j,H[j]);var X=this.makeButton("DAS","Add arbitrary DAS data");N.push(X);var K=this.makeButton("Binary","Add data in bigwig or bigbed format");N.push(K);for(var Y=0;Y<this.hubObjects.length;++Y){var Z=this.hubObjects[Y];U(Z)}var $=this.makeButton("+","Connect to a new track-hub");N.push($);var J=u("ul",N,{className:"nav nav-tabs"},{marginBottom:"0px"});I.appendChild(J);var Q,ee,te,ne,ie,re,oe,ae=!1,se=null,le=u("form",null,{},{display:"inline-block",width:"100%"});le.addEventListener("submit",function(e){return e.stopPropagation(),e.preventDefault(),a(),!1},!0);var ue=u("div");ue.style.position="relative",ue.style.overflow="scroll",le.appendChild(ue);var ce,he;C=function(e,t){we.style.display="none",de.style.display="none",xe.style.display="none",he&&he.removeListener(E),ce=t,he=e,he.addListenerAndFire(E)},E=function(e){ae=!1;var t=[];if(c(ue),!e)return void ue.appendChild(u("p","Dalliance was unable to retrieve data source information from the DAS registry, please try again later"));for(var n=u("tbody",null,{className:"table table-striped table-condensed"},{width:"100%"}),i=u("table",n,{className:"table table-striped table-condensed"},{width:"100%",tableLayout:"fixed"}),r=0,o=[],a=0;a<e.length;++a)o.push(e[a]);o.sort(function(e,t){return e.name.toLowerCase().trim().localeCompare(t.name.toLowerCase().trim())});for(var a=0;a<o.length;++a){var s=o[a],l=u("tr"),h=u("td",null,{},{width:"30px"});if(h.style.textAlign="center",!s.props||s.props.cors){var d=u("input");d.type="checkbox",d.dalliance_source=s,ce&&(d.dalliance_mapping=ce),h.appendChild(d),t.push(d),d.addEventListener("change",function(e){e.target.checked?D.addTier(e.target.dalliance_source):D.removeTier(e.target.dalliance_source)})}else h.appendChild(document.createTextNode("!")),D.makeTooltip(h,u("span",["This data source isn't accessible because it doesn't support ",u("a","CORS",{href:"http://www.w3.org/TR/cors/"}),"."]));l.appendChild(h);var f=u("td");f.appendChild(document.createTextNode(s.name)),s.desc&&s.desc.length>0&&D.makeTooltip(f,s.desc),l.appendChild(f),n.appendChild(l),++r}var p=function(){for(var e=0;e<t.length;++e){var n=t[e],i=D.currentlyActive(n.dalliance_source);i?n.checked=!0:n.checked=!1}};p(),D.addTierListener(function(e){p()}),ue.appendChild(i)},F&&F.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),i(N,F),C(D.availableSources)},!1),K.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),n()},!1),$.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r()},!1),X.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),o()},!1);var de=u("button","Add",{className:"btn btn-primary"});de.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),a()},!1);var fe=function(e,t){var n=D.knownSpace;if(!n)return void alert("Can't confirm track-addition to an uninit browser.");var i=0|Math.max(n.min,(n.min+n.max-100)/2),r=new L(n.chr,i,Math.min(i+99,n.max));e.features(r,{},function(n,i){if(!i){var r=new RegExp("/([^/]+)/?$"),o=r.exec(e.uri);return o&&(e.name=o[1]),void l(e)}return t?(c(ue),ue.appendChild(u("h2","Custom data not found")),ue.appendChild(u("p","DAS uri: "+e.uri+" is not answering features requests")),void(ae="reset")):(e.credentials=!0,void fe(e,!0))})},pe=function(e){var t={name:e.name};return e.credentials&&(t.credentials=e.credentials),e.mapping&&"__default__"!=e.mapping&&(t.mapping=e.mapping),e.transport&&(t.transport=e.transport),"bwg"==e.tier_type?(e.blob?t.bwgBlob=e.blob:e.uri&&(t.bwgURI=e.uri),t):"bam"==e.tier_type?(e.blob?(t.bamBlob=e.blob,t.baiBlob=e.indexBlob):(t.bamURI=e.uri,t.baiURI=e.indexUri),t):"tabix"==e.tier_type?(t.tier_type="tabix",t.payload=e.payload,e.blob?(t.blob=e.blob,t.indexBlob=e.indexBlob):(t.uri=e.uri,t.indexUri=e.indexUri),t):"memstore"==e.tier_type?(t.tier_type="memstore",t.payload=e.payload,e.blob?t.blob=e.blob:t.uri=e.uri,t):void 0},_e=function(e){m(e,function(e,t){if(!t){var n=pe(e);return"bam"==e.tier_type?v(n):"tabix"==e.tier_type?w(n):ge(n,!1,!1,!0)}c(ue);var i=u("div");i.appendChild(u("h2","Couldn't access custom data")),i.appendChild(u("p",""+t)),ue.appendChild(i),console.log(e),"https:"===window.location.protocol&&0==e.uri.indexOf("http:")&&D.canFetchPlainHTTP().then(function(e){e||i.appendChild(u("p",[u("strong","HTTP warning: "),"you may not be able to access HTTP resources from an instance of Biodalliance which you are accessing via HTTPS.",u("a","[More info]",{href:D.httpWarningURL,target:"_blank"})]))}),ae="reset-bin"})},ge=function(e,t,n,i){if(we.style.display="none",de.style.display="inline",xe.style.display="inline",c(ue),ue.appendChild(u("h2","Add custom data: step 2")),ue.appendChild(document.createTextNode("Label: ")),ee=u("input","",{value:e.name}),ue.appendChild(ee),re=u("input",""),oe=u("input",""),ue.appendChild(u("br")),ue.appendChild(u("br")),ue.appendChild(u("h4","Coordinate system: ")),te=u("select",null),te.appendChild(u("option",D.nameForCoordSystem(D.coordSystem),{value:"__default__"})),D.chains)for(var r in D.chains){var o=D.chains[r].coords;te.appendChild(u("option",D.nameForCoordSystem(o),{value:r}))}te.value=e.mapping||"__default__",ue.appendChild(te),t?ue.appendChild(u("p","(Based on server response, probably doesn't need changing.)")):(ue.appendChild(u("p",[u("b","Warning: "),"unable to determine the correct value from server responses.  Please check carefully."])),ue.appendChild(u("p","If you don't see the mapping you're looking for, please contact thomas@biodalliance.org"))),i||(ue.appendChild(document.createTextNode("Quantitative: ")),ne=u("input",null,{type:"checkbox",checked:!0}),"undefined"!=typeof e.maxbins&&(ne.checked=e.maxbins),ue.appendChild(ne),n?ue.appendChild(u("p","(Based on server response, probably doesn't need changing.)")):ue.appendChild(u("p",[u("b","Warning: "),"unable to determine correct value.  If in doubt, leave checked."]))),e.bwgBlob&&ue.appendChild(u("p",[u("b","Warning: "),"data added from local file.  Due to the browser security model, the track will disappear if you reload Dalliance."])),ee.focus(),ae="bin"===ae||"prompt-bai"===ae||"prompt-tbi"===ae?"finalize-bin":"finalize",se=e},me=null,ve=function(e){var t=me=[];ae="multiple";for(var n=0;n<e.length;++n){var i=e[n];i&&t.push({blob:i})}for(var n=0;n<t.length;++n)ye(t[n]);be()},ye=function(e){m(e,function(e,t){t&&(e.error=t);for(var n=[],i={},r={},o=0;o<me.length;++o){var a=me[o];"bam"!=a.tier_type||a.indexBlob||(i[a.blob.name]=a),"tabix"!=a.tier_type||a.indexBlob||(r[a.blob.name]=a)}for(var o=0;o<me.length;++o){var a=me[o];if("bai"===a.tier_type){var s=new RegExp("(.+)\\.bai$"),l=s.exec(a.blob.name);l&&i[l[1]]&&(i[l[1]].indexBlob=a.blob,n.push(o))}else if("tabix-index"===a.tier_type){var u=new RegExp("(.+)\\.tbi$"),l=u.exec(a.blob.name);l&&r[l[1]]&&(r[l[1]].indexBlob=a.blob,n.push(o))}}for(var c=n.length-1;c>=0;--c)me.splice(n[c],1);be()})},be=function(){c(ue);var e=!1,t=u("table",me.filter(function(e){return!e.hidden}).map(function(t){var n=u("tr");n.appendChild(u("td",t.name||t.blob.name));var i;i=t.error?u("span","Error",null,{color:"red"}):t.tier_type?t.payload||t.tier_type:D.makeLoader(16);var r,o="unknown";if("bwg"==t.tier_type||"memstore"==t.tier_type?o="okay":"bam"==t.tier_type?o=t.indexBlob?"okay":"needs-index":"tabix"==t.tier_type&&(o=t.indexBlob?"okay":"needs-index"),"okay"==o){if(r=u("select",null,null,{width:"150px"}),r.appendChild(u("option",D.nameForCoordSystem(D.coordSystem),{value:"__default__"})),D.chains)for(var a in D.chains){var s=D.chains[a].coords;r.appendChild(u("option",D.nameForCoordSystem(s),{value:a}))}r.value=t.mapping||"__default__",r.addEventListener("change",function(e){t.mapping=r.value,console.log(t)},!1)}else"needs-index"==o&&(r=u("span","Needs index",{},{color:"red"}),e=!0);return u("tr",[u("td",t.name||t.blob.name),u("td",i),u("td",r)])}),{className:"table table-striped table-condensed"});if(ue.appendChild(t),e){ue.appendChild(u("p","Some of these files are missing required index (.bai or .tbi) files.  For security reasons, web applications like Dalliance can only access local files which you have explicity selected.  Please use the file chooser below to select the appropriate index file")),ue.appendChild(document.createTextNode("Index file(s): "));var n=u("input",null,{type:"file",multiple:"multiple"});ue.appendChild(n),n.addEventListener("change",function(e){console.log("fileset changed");for(var t=n.files||[],i=0;i<t.length;++i){var r=t[i];if(r){var o={blob:r,hidden:!0};me.push(o),ye(o)}}},!1)}},xe=u("button","Cancel",{className:"btn"});xe.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),"finalize-bin"===ae?n():o()},!1);var we=u("button","Refresh",{className:"btn"});we.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),D.queryRegistry(ce)},!1),this.makeTooltip(we,"Click to re-fetch data from the DAS registry");var Se=u("div",[de," ",xe," ",we]);Se.style.margin="10px",le.appendChild(Se),I.appendChild(le),C(D.availableSources),this.showToolPanel(I),this.setUiMode("add"),V&&(i(N,V),C(new h(W)))}},function(e,t,n){"use strict";function i(e,t,n){function i(){n?(r.className="fa fa-caret-down",t.style.display="table"):(r.className="fa fa-caret-right",t.style.display="none")}var r=s("i");i(),r.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),n=!n,i()},!1);var o=s("h6",[r," ",e],{},{display:"block",background:"gray",color:"white",width:"100%",padding:"5px 2px",margin:"0px"});return s("div",[o,t],{})}var r=n(247),o=r.Browser,a=n(248),s=a.makeElement,l=a.removeChildren;o.prototype.removeAllPopups=function(){l(this.hPopupHolder),l(this.popupHolder)},o.prototype.makeTooltip=function(e,t){var n,i=!1,r=this,o=null;n=function(t){i=!1,o&&(clearTimeout(o),o=null),e.removeEventListener("mouseout",n,!1)};var a=function(n){var l=n.clientX+window.scrollX,u=n.clientY+window.scrollY;o||(o=setTimeout(function(){var n;n="function"==typeof t?t():t;var c=s("div",[s("div",null,{className:"tooltip-arrow"}),s("div",n,{className:"tooltip-inner"})],{className:"tooltip bottom in"},{display:"block",top:""+(u+20)+"px",left:""+Math.max(l-30,20)+"px"});r.hPopupHolder.appendChild(c);var h;h=function(t){try{r.hPopupHolder.removeChild(c)}catch(n){}window.removeEventListener("mousemove",h,!1),i&&(null==e.offsetParent||a(t))},window.addEventListener("mousemove",h,!1),o=null},1e3))};e.addEventListener("mouseover",function(t){i=!0,e.addEventListener("mouseout",n,!1),a(t)},!1),e.addEventListener("DOMNodeRemovedFromDocument",function(e){i=!1,o&&(clearTimeout(o),o=null)},!1)},o.prototype.popit=function(e,t,n,i){var r=this;i||(i={}),e||(e={});var o,a,l=i.width||200;if(e.clientX)var o=e.clientX,a=e.clientY;else o=500,a=50;o+=document.documentElement.scrollLeft||document.body.scrollLeft,a+=document.documentElement.scrollTop||document.body.scrollTop;var u=window.innerWidth,c=a,h=Math.min(o-l/2-4,u-l-30),d=s("div");if(d.className="popover fade "+(e.clientX?"bottom ":"")+"in",d.style.display="block",d.style.position="absolute",d.style.top=""+c+"px",d.style.left=""+h+"px",d.style.width=l+"px",l>276&&(d.style.maxWidth=l+"px"),d.appendChild(s("div",null,{className:"arrow"})),t){var f=s("button","",{className:"close"});f.innerHTML="&times;",f.addEventListener("mouseover",function(e){f.style.color="red"},!1),f.addEventListener("mouseout",function(e){f.style.color="black"},!1),f.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r.removeAllPopups()},!1);var p,_,g,m,v=s("h4",[s("span",t,null,{maxWidth:"200px"}),f],{},{paddingLeft:"10px",paddingRight:"10px"});g=function(e){e.stopPropagation(),e.preventDefault(),h+=e.clientX-p,8>h&&(h=8),h>u-l-32&&(h=u-l-26),c+=e.clientY-_,c=Math.max(10,c),d.style.top=""+c+"px",d.style.left=""+Math.min(h,u-l-10)+"px",p=e.clientX,_=e.clientY},m=function(e){e.stopPropagation(),e.preventDefault(),window.removeEventListener("mousemove",g,!1),window.removeEventListener("mouseup",m,!1)},v.addEventListener("mousedown",function(e){e.preventDefault(),e.stopPropagation(),p=e.clientX,_=e.clientY,window.addEventListener("mousemove",g,!1),window.addEventListener("mouseup",m,!1)},!1),d.appendChild(v)}d.appendChild(s("div",n,{className:"popover-content"},{padding:"0px"})),this.hPopupHolder.appendChild(d);var y={node:d,displayed:!0};return d.addEventListener("DOMNodeRemoved",function(e){e.target==d&&(y.displayed=!1)},!1),y},e.exports={makeTreeTableSection:i}},function(e,t,n){"use strict";function i(e,t,n){var o,u=new RegExp("^\\w+\\s[0-9]+\\s[0-9]+.*$"),d=/([^=]+)=\"?([^\"]+)\"?/,p=/^##\s*fileformat=VCFv4\..+/;o=e.blob?new s(e.blob):"encode"==e.transport?new y(e.uri):new a(e.uri,{credentials:e.credentials}),o.slice(0,65536).salted().fetch(function(o,a){if(!o)return n||(e.credentials=!0,i(e,t,!0)),t(e,"Couldn't fetch data");var s=new Uint8Array(o),m=new Uint32Array(o,0,1),y=m[0];if(y==c||y==h){e.tier_type="bwg";var b=new RegExp("/?([^/]+?)(.bw|.bb|.bigWig|.bigBed)?$"),x=b.exec(e.uri||e.blob.name);return x&&(e.name=x[1]),t(e,null)}if(y==g)return e.tier_type="bai",t(e,null);if(31==s[0]||139==s[1]){var w=f(o),S=new Uint8Array(w);if(y=l(S,0),y==_){e.tier_type="bam";var b=new RegExp("/?([^/]+?)(.bam)?$"),x=b.exec(e.uri||e.blob.name);return x&&(e.name=x[1]),t(e,null)}if(y==v)return e.tier_type="tabix-index",t(e,null);if(1768301347==y){e.tier_type="tabix",e.payload="vcf";var b=new RegExp("/?([^/]+?)(.vcf)?(.gz)?$"),x=b.exec(e.uri||e.blob.name);return x&&(e.name=x[1]),t(e,null)}return console.log("magic = "+y.toString(16)),t(e,"Unsupported format")}var A=String.fromCharCode.apply(null,s),k=A.split("\n");if(k.length>0&&p.test(k[0])){e.tier_type="memstore",e.payload="vcf";var b=new RegExp("/?([^/]+?)(.vcf)?$"),x=b.exec(e.uri||e.blob.name);return x&&!e.name&&(e.name=x[1]),t(e,null)}for(var C=0;C<k.length;++C){var T=k[C].replace("\r","");if(0!=T.length&&0!=T.indexOf("browser")){if(0==T.indexOf("track")){for(var E="bed",M=T.split(/\s/),L=1;L<M.length;++L){var R=d.exec(M[L]);R&&("type"==R[1]&&"wiggle_0"==R[2]?E="wig":"name"==R[0]&&(e.name=R[2]))}return r(e,E),t(e,null)}if(0==T.indexOf("fixedStep"))return r(e,"wig"),t(e,null);if(0==T.indexOf("variableStep"))return r(e,"wig"),t(e,null);if(u.test(T))return r(e,null),t(e,null);break}}return t(e,"Unsupported format")},{timeout:1500})}function r(e,t){e.tier_type="memstore";var n=new RegExp("/?([^/]+?)(.(bed|wig))?$"),i=n.exec(e.uri||e.blob.name);i&&(e.name||(e.name=i[1]),!t&&i[3]&&(t=i[3])),e.payload=t||"bed"}var o=n(277),a=o.URLFetchable,s=o.BlobFetchable,l=o.readInt,u=n(278),c=u.BIG_WIG_MAGIC,h=u.BIG_BED_MAGIC,d=n(291),f=d.unbgzf,p=n(292),_=p.BAM_MAGIC,g=p.BAI_MAGIC,m=n(293),v=m.TABIX_MAGIC,y=n(294).EncodeFetchable;e.exports={probeResource:i}},function(e,t,n){function i(e,t){this.block=e,this.offset=t}function r(e,t){var n=4294967296*(255&e[t+6])+16777216*(255&e[t+5])+65536*(255&e[t+4])+256*(255&e[t+3])+(255&e[t+2]),r=e[t+1]<<8|e[t];return 0==n&&0==r?null:new i(n,r)}function o(e,t){t=Math.min(t||1,e.byteLength-50);for(var n=[],i=[0],r=0;i[0]<t;){var o=new Uint8Array(e,i[0],12),a=o[11]<<8|o[10],s=c(e,12+a+i[0],Math.min(65536,e.byteLength-12-a-i[0]),i);i[0]+=8,r+=s.byteLength,n.push(s)}if(1==n.length)return n[0];for(var l=new Uint8Array(r),u=0,d=0;d<n.length;++d){var f=new Uint8Array(n[d]);h(f,0,l,u,f.length),u+=f.length}return l.buffer}function a(e,t){this.minv=e,this.maxv=t}function s(e,t){return--t,e>>14==t>>14?4681+(e>>14):e>>17==t>>17?585+(e>>17):e>>20==t>>20?73+(e>>20):e>>23==t>>23?9+(e>>23):e>>26==t>>26?1+(e>>26):0}function l(e,t){var n,i=[];for(--t,i.push(0),n=1+(e>>26);1+(t>>26)>=n;++n)i.push(n);for(n=9+(e>>23);9+(t>>23)>=n;++n)i.push(n);for(n=73+(e>>20);73+(t>>20)>=n;++n)i.push(n);for(n=585+(e>>17);585+(t>>17)>=n;++n)i.push(n);for(n=4681+(e>>14);4681+(t>>14)>=n;++n)i.push(n);return i}var u=n(279),c=u.inflateBuffer,h=u.arrayCopy;i.prototype.toString=function(){return""+this.block+":"+this.offset};e.exports={unbgzf:o,readVob:r,reg2bin:s,reg2bins:l,Chunk:a}},function(e,t,n){"use strict";function i(){}function r(e,t){var n=t,i=u(e,n);n+=4;for(var r=0;i>r;++r){var o=(u(e,n),u(e,n+4));n+=8+16*o}var a=u(e,n);n+=4;for(var s=1e9,l=n,c=0;a>c;++c){var h=p(e,l);if(l+=8,h){var d=h.block;h.offset>0&&(d+=65536),s>d&&(s=d);break}}return n+=8*a,{minBlockIndex:s,nbin:i,length:n-t}}function o(e,t,n,a,s){function l(e){if(!e)return a(null,"Couldn't access BAM");var t=_(e,e.byteLength),n=new Uint8Array(t),i=u(n,0);if(i!=v)return a(null,"Not a BAM file, magic=0x"+i.toString(16));for(var r=u(n,4),o="",s=0;r>s;++s)o+=String.fromCharCode(n[s+8]);var l=u(n,r+8),c=r+12;h.chrToIndex={},h.indexToChr=[];for(var s=0;l>s;++s){for(var d=u(n,c),f="",p=0;d-1>p;++p)f+=String.fromCharCode(n[c+4+p]);u(n,c+d+4);h.chrToIndex[f]=s,0==f.indexOf("chr")?h.chrToIndex[f.substring(3)]=s:h.chrToIndex["chr"+f]=s,h.indexToChr.push(f),c=c+8+d}return h.indices?a(h):void 0}function c(e){if(!e)return"Couldn't access BAI";var t=new Uint8Array(e),n=u(t,0);if(n!=y)return a(null,"Not a BAI file, magic=0x"+n.toString(16));var i=u(t,4);h.indices=[];for(var o=8,s=0;i>s;++s){var l=o,c=r(t,l);o+=c.length,d=Math.min(c.minBlockIndex,d);var f=c.nbin;f>0&&(h.indices[s]=new Uint8Array(e,l,o-l))}return!0}var h=new i;h.data=e,h.bai=t,h.indexChunks=n;var d=h.indexChunks?h.indexChunks.minBlockIndex:1e9;if(h.indexChunks){var f=h.indexChunks.chunks;h.indices=[];for(var p=0;p<f.length;p++)h.indices[p]=null;h.data.slice(0,d).fetch(l)}else h.bai.fetch(function(t){var i=c(t);i!==!0?h.bai.url&&"undefined"==typeof s?(h.bai.url=h.data.url.replace(new RegExp(".bam$"),".bai"),o(e,h.bai,n,a,!0)):a(null,i):h.data.slice(0,d).fetch(l,{timeout:5e3})},{timeout:5e3})}function a(){}var s=n(269),l=(s.Range,s.union,s.intersection,n(277)),u=l.readInt,c=l.readShort,h=l.readByte,d=(l.readInt64,l.readFloat),f=n(291),p=f.readVob,_=f.unbgzf,g=f.reg2bins,m=f.Chunk,v=21840194,y=21578050,b={MULTIPLE_SEGMENTS:1,ALL_SEGMENTS_ALIGN:2,SEGMENT_UNMAPPED:4,NEXT_SEGMENT_UNMAPPED:8,REVERSE_COMPLEMENT:16,NEXT_REVERSE_COMPLEMENT:32,FIRST_SEGMENT:64,LAST_SEGMENT:128,SECONDARY_ALIGNMENT:256,QC_FAIL:512,DUPLICATE:1024,SUPPLEMENTARY:2048};i.prototype.blocksForRange=function(e,t,n){var i=this.indices[e];if(!i)return[];for(var r=g(t,n),o=[],a=0;a<r.length;++a)o[r[a]]=!0;for(var s=[],l=[],c=u(i,0),h=4,d=0;c>d;++d){var f=u(i,h),_=u(i,h+4);if(h+=8,o[f])for(var v=0;_>v;++v){var y=p(i,h),b=p(i,h+8);(4681>f?l:s).push(new m(y,b)),h+=16}else h+=16*_}for(var x=u(i,h),w=null,S=Math.min(t>>14,x-1),A=Math.min(n>>14,x-1),a=S;A>=a;++a){var k=p(i,h+4+8*a);k&&(!w||k.block<w.block||k.offset<w.offset)&&(w=k)}var C=[];if(null!=w)for(var a=0;a<l.length;++a){var T=l[a];T.maxv.block>=w.block&&T.maxv.offset>=w.offset&&C.push(T)}l=C;for(var E=[],a=0;a<l.length;++a)E.push(l[a]);for(var a=0;a<s.length;++a)E.push(s[a]);E.sort(function(e,t){var n=e.minv.block-t.minv.block;return 0!=n?n:e.minv.offset-t.minv.offset});var M=[];if(E.length>0){for(var L=E[0],a=1;a<E.length;++a){var R=E[a];R.minv.block==L.maxv.block?L=new m(L.minv,R.maxv):(M.push(L),L=R)}M.push(L)}return M},i.prototype.fetch=function(e,t,n,i,r){function o(){if(d>=s.length)return i(h);if(c){var e=new Uint8Array(c),u=a.readBamRecords(e,s[d].minv.offset,h,t,n,l,r);return c=null,++d,u?i(h):o()}var f=s[d],p=f.minv.block,g=f.maxv.block+65536;a.data.slice(p,g-p).fetch(function(e){return c=_(e,f.maxv.block-f.minv.block+1),o()})}var a=this;r=r||{};var s,l=this.chrToIndex[e];if(void 0===l)s=[];else{if(null===this.indices[l]&&this.indexChunks.chunks[l]){var u=this.indexChunks.chunks[l];return this.bai.slice(u[0],u[1]).fetch(function(o){var a=new Uint8Array(o);return this.indices[l]=a,this.fetch(e,t,n,i,r)}.bind(this))}s=this.blocksForRange(l,t,n),s||i(null,"Error in index fetch")}var c,h=[],d=0;o()};var x=["=","A","C","x","G","x","x","x","T","x","x","x","x","x","x","N"],w=["M","I","D","N","S","H","P","=","X","?","?","?","?","?","?","?"];i.prototype.readBamRecords=function(e,t,n,i,r,o,s){for(;;){var l=u(e,t),f=t+l+4;if(f>=e.length)return!1;var p=new a,_=u(e,t+4),g=u(e,t+8),m=u(e,t+12),v=(65280&m)>>8,y=255&m,b=u(e,t+16),S=(4294901760&b)>>16,A=65535&b,k=u(e,t+20),C=u(e,t+24),T=u(e,t+28);u(e,t+32);if(p.segment=this.indexToChr[_],p.flag=S,p.pos=g,p.mq=v,s.light&&(p.seqLength=k),!s.light){C>=0&&(p.nextSegment=this.indexToChr[C],p.nextPos=T);for(var E="",M=0;y-1>M;++M)E+=String.fromCharCode(e[t+36+M]);p.readName=E;for(var L=t+36+y,R="",O=0;A>O;++O){var P=u(e,L);R=R+(P>>4)+w[15&P],L+=4}p.cigar=R;for(var D="",I=k+1>>1,M=0;I>M;++M){var N=e[L+M];D+=x[(240&N)>>4],D.length<k&&(D+=x[15&N])}L+=I,p.seq=D;for(var F="",M=0;k>M;++M)F+=String.fromCharCode(e[L+M]+33);for(L+=k,p.quals=F;f>L;){var B,z=String.fromCharCode(e[L],e[L+1]),H=String.fromCharCode(e[L+2]);if("A"==H)B=String.fromCharCode(e[L+3]),L+=4;else if("i"==H||"I"==H)B=u(e,L+3),L+=7;else if("c"==H||"C"==H)B=e[L+3],L+=4;else if("s"==H||"S"==H)B=c(e,L+3),L+=5;else if("f"==H)B=d(e,L+3),L+=7;else if("Z"==H||"H"==H)for(L+=3,B="";;){var q=e[L++];if(0==q)break;B+=String.fromCharCode(q)}else{if("B"!=H)throw"Unknown type "+H;var G,j,U=String.fromCharCode(e[L+3]),V=u(e,L+4);if("i"==U||"I"==U||"f"==U)G=4,j="f"==U?d:u;else if("s"==U||"S"==U)G=2,j=c;else{if("c"!=U&&"C"!=U)throw"Unknown array type "+U;G=1,j=h}L+=8,B=[];for(var W=0;V>W;++W)B.push(j(e,L)),L+=G}p[z]=B}}if((!i||p.pos<=r&&p.pos+k>=i)&&(void 0===o||_==o)&&n.push(p),p.pos>r)return!0;t=f}},e.exports={makeBam:o,BAM_MAGIC:v,BAI_MAGIC:y,BamFlags:b}},function(e,t,n){"use strict";function i(){}function r(e,t,n){var r=new i;r.data=e,r.tbi=t,r.tbi.fetch(function(e){if(!e)return n(null,"Couldn't access Tabix");var t=h(e,e.byteLength),i=new Uint8Array(t),a=l(i,0);if(a!=o)return n(null,"Not a tabix index");var s=l(i,4);r.format=l(i,8),r.colSeq=l(i,12),r.colStart=l(i,16),r.colEnd=l(i,20),r.meta=l(i,24),r.skip=l(i,28);l(i,32);r.indices=[];var u=36;r.chrToIndex={},r.indexToChr=[];for(var d=0;s>d;++d){for(var f="";;){var p=i[u++];if(0==p)break;f+=String.fromCharCode(p)}r.chrToIndex[f]=d,0==f.indexOf("chr")?r.chrToIndex[f.substring(3)]=d:r.chrToIndex["chr"+f]=d,r.indexToChr.push(f)}for(var _=1e9,g=0;s>g;++g){var m=u,v=l(i,u);u+=4;for(var y=0;v>y;++y){var b=(l(i,u),l(i,u+4));u+=8+16*b}var x=l(i,u);u+=4;for(var w=u,d=0;x>d;++d){var S=c(i,w);if(w+=8,S){var A=S.block;S.offset>0&&(A+=65536),_>A&&(_=A);break}}u+=8*x;v>0&&(r.indices[g]=new Uint8Array(t,m,u-m))}r.headerMax=_,n(r)},{timeout:5e3})}var o=21578324,a=n(269),s=(a.Range,a.union,a.intersection,n(277)),l=s.readInt,u=(s.readShort,s.readByte,s.readInt64,s.readFloat,n(291)),c=u.readVob,h=u.unbgzf,d=u.reg2bins,f=u.Chunk;i.prototype.blocksForRange=function(e,t,n){var i=this.indices[e];if(!i)return[];for(var r=d(t,n),o=[],a=0;a<r.length;++a)o[r[a]]=!0;for(var s=[],u=[],h=l(i,0),p=4,_=0;h>_;++_){var g=l(i,p),m=l(i,p+4);if(p+=8,o[g])for(var v=0;m>v;++v){var y=c(i,p),b=c(i,p+8);(4681>g?u:s).push(new f(y,b)),p+=16}else p+=16*m}for(var x=l(i,p),w=null,S=Math.min(t>>14,x-1),A=Math.min(n>>14,x-1),a=S;A>=a;++a){var k=c(i,p+4+8*a);k&&(!w||k.block<w.block||k.offset<w.offset)&&(w=k)}var C=[];if(null!=w)for(var a=0;a<u.length;++a){
var T=u[a];T.maxv.block>=w.block&&T.maxv.offset>=w.offset&&C.push(T)}u=C;for(var E=[],a=0;a<u.length;++a)E.push(u[a]);for(var a=0;a<s.length;++a)E.push(s[a]);E.sort(function(e,t){var n=e.minv.block-t.minv.block;return 0!=n?n:e.minv.offset-t.minv.offset});var M=[];if(E.length>0){for(var L=E[0],a=1;a<E.length;++a){var R=E[a];R.minv.block==L.maxv.block?L=new f(L.minv,R.maxv):(M.push(L),L=R)}M.push(L)}return M},i.prototype.fetch=function(e,t,n,i){function r(){if(d>=s.length)return i(c);if(u){var e=new Uint8Array(u);return o.readRecords(e,s[d].minv.offset,c,t,n,l),u=null,++d,r()}var a=s[d],f=a.minv.block,p=a.maxv.block+65536;o.data.slice(f,p-f).fetch(function(e){return u=h(e,a.maxv.block-a.minv.block+1),r()})}var o=this,a=this.chrToIndex[e];if(void 0==a)return i([]);var s,l=this.indexToChr[a];void 0===a?s=[]:(s=this.blocksForRange(a,t,n),s||i(null,"Error in index fetch"));var u,c=[],d=0;r()},i.prototype.readRecords=function(e,t,n,i,r,o){e:for(;;){for(var a="";t<e.length;){var s=e[t++];if(10==s){var l=a.split("	");if(l[this.colSeq-1]==o){var u=parseInt(l[this.colStart-1]),c=u;this.colEnd>0&&(c=parseInt(l[this.colEnd-1])),65536&this.format&&++u,r>=u&&c>=i&&n.push(a)}continue e}a+=String.fromCharCode(s)}return}},i.prototype.fetchHeader=function(e){var t=this;t.data.slice(0,t.headerMax).fetch(function(n){if(!n)return e(null,"Fetch failed");for(var i=new Uint8Array(h(n,n.byteLength)),r=0,o="",a=[];r<i.length;){var s=i[r++];if(10==s){if(o.charCodeAt(0)!=t.meta)return e(a);a.push(o),o=""}else o+=String.fromCharCode(s)}e(a)})},e.exports={connectTabix:r,TABIX_MAGIC:o}},function(e,t,n){"use strict";function i(e,t){return e.indexOf("?")<0&&(e+="?soft=true"),new s(function(n,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState)if(r.status>=300)i("Error code "+r.status);else{var e=JSON.parse(r.response);n(t?e:e.location)}},r.open("GET",e,!0),r.setRequestHeader("Accept","application/json"),r.responseType="text",r.send("")})}function r(e){this.rawurl=e}function o(e,t,n,i){i||("object"==typeof t?(i=t,t=void 0):i={}),this.url="string"==typeof e?new r(e):e,this.start=t||0,n&&(this.end=n),this.opts=i}function a(e){if(!e)return null;for(var t=new Uint8Array(e.length),n=0;n<t.length;++n)t[n]=e.charCodeAt(n);return t.buffer}var s=n(255).Promise;r.prototype.getURLPromise=function(){return this.urlPromise&&this.urlPromiseValidity>Date.now()?this.urlPromise:(this.urlPromise=i(this.rawurl,!0).then(function(e){return e.location}),this.urlPromiseValidity=Date.now()+432e5,this.urlPromise)},o.prototype.slice=function(e,t){if(0>e)throw"Bad slice "+e;var n=this.start,i=this.end;return n&&e?n+=e:n=e||n,i=t&&n?n+t-1:i||t-1,new o(this.url,n,i,this.opts)},o.prototype.fetchAsText=function(e){var t,n=this,i=new XMLHttpRequest;n.url.getURLPromise().then(function(r){if(i.open("GET",r,!0),n.end){if(n.end-n.start>1e8)throw"Monster fetch!";i.setRequestHeader("Range","bytes="+n.start+"-"+n.end),t=n.end-n.start+1}i.onreadystatechange=function(){return 4==i.readyState?e(200==i.status||206==i.status?i.responseText:null):void 0},n.opts.credentials&&(i.withCredentials=!0),i.send("")})["catch"](function(t){return console.log(t),e(null)})},o.prototype.salted=function(){return this},o.prototype.fetch=function(e,t,n){var i=this;return t=t||1,t>3?e(null):void i.url.getURLPromise().then(function(r){var o,s=new XMLHttpRequest;if(s.open("GET",r,!0),s.overrideMimeType("text/plain; charset=x-user-defined"),i.end){if(i.end-i.start>1e8)throw"Monster fetch!";s.setRequestHeader("Range","bytes="+i.start+"-"+i.end),o=i.end-i.start+1}s.responseType="arraybuffer",s.onreadystatechange=function(){if(4==s.readyState){if(200==s.status||206==s.status){if(s.response){var r=s.response.byteLength;return!o||o==r||n&&r==n?e(s.response):i.fetch(e,t+1,r)}if(s.mozResponseArrayBuffer)return e(s.mozResponseArrayBuffer);var l=s.responseText;return!o||o==l.length||n&&l.length==n?e(a(s.responseText)):i.fetch(e,t+1,l.length)}return i.fetch(e,t+1)}},i.opts.credentials&&(s.withCredentials=!0),s.send("")})["catch"](function(e){console.log(e)})},e.exports={lookupEncodeURI:i,EncodeFetchable:o}},function(e,t,n){"use strict";function i(e,t,n){var i=l(n.type,t.type),r=l(n.label,t.label,n.id,t.id);r&&0!=r.indexOf("__dazzle")&&(i=i+": "+r),this.hit=e,this.feature=t,this.group=n,this.title=i,this.sections=[]}function r(e,t){var n=[];if(e)for(var i=0;i<e.length;++i)u(n,e[i]);if(t)for(var i=0;i<t.length;++i)u(n,t[i]);return n}var o=n(247),a=o.Browser,s=n(248),l=s.pick,u=s.pushnew,c=s.makeElement,h=new RegExp("^([A-Za-z_-]+)=(.+)");a.prototype.addFeatureInfoPlugin=function(e){this.featureInfoPlugins||(this.featureInfoPlugins=[]),this.featureInfoPlugins.push(e)},i.prototype.setTitle=function(e){this.title=e},i.prototype.add=function(e,t){"string"==typeof t&&(t=c("span",t)),this.sections.push({label:e,info:t})},a.prototype.featurePopup=function(e,t,n,o){var a=n.length,s=--a>=0?n[a]:{},l=--a>=0?n[a]:{},u=new i(n,s,l);u.tier=o;for(var d=this.featureInfoPlugins||[],f=0;f<d.length;++f)try{d[f](s,u)}catch(p){console.log(p.stack||p)}for(d=o.featureInfoPlugins||[],f=0;f<d.length;++f)try{d[f](s,u)}catch(p){console.log(p.stack||p)}this.removeAllPopups();var _=c("table",null,{className:"table table-striped table-condensed"});_.style.width="100%",_.style.margin="0px";var g=0;if(s.method){var m=c("tr",[c("th","Method"),c("td",s.method)]);_.appendChild(m),++g}var v;v=l.segment?l:s;var m=c("tr",[c("th","Location"),c("td",v.segment+":"+v.min+"-"+v.max,{},{minWidth:"200px"})]);if(_.appendChild(m),++g,void 0!==s.score&&null!==s.score&&"-"!=s.score&&!s.suppressScore){var m=c("tr",[c("th","Score"),c("td",""+s.score)]);_.appendChild(m),++g}var y=r(l.links,s.links);if(y&&y.length>0){var m=c("tr",[c("th","Links"),c("td",y.map(function(e){return c("div",c("a",e.desc,{href:e.uri,target:"_new"}))}))]);_.appendChild(m),++g}for(var b=r(l.notes,s.notes),x=0;x<b.length;++x){var w="Note",S=b[x],A=S.match(h);A&&(w=A[1],S=A[2]);var m=c("tr",[c("th",w),c("td",S)]);_.appendChild(m),++g}for(var k=0;k<u.sections.length;++k){var C=u.sections[k];_.appendChild(c("tr",[c("th",C.label),c("td",C.info)]))}this.popit(e,u.title||"Feature",_,{width:450})}},function(e,t,n){"use strict";var i=n(247),r=i.Browser,o=n(248),a=o.shallowCopy;r.prototype.mergeSelectedTiers=function(){for(var e=[],t=[],n=0;n<this.selectedTiers.length;++n){var i=this.tiers[this.selectedTiers[n]];e.push(a(i.dasSource));for(var r=i.stylesheet.styles,o=0;o<r.length;++o){var s=r[o],l=a(s);l.method=i.dasSource.name.replace(/[()+*?]/g,"\\$&"),l._methodRE=null,l.style=a(s.style),void 0===l.style.ZINDEX&&(l.style.ZINDEX=n),i.forceMin&&(l.style.MIN=i.forceMin),i.forceMax&&(l.style.MAX=i.forceMax),t.push(l)}}this.addTier({name:"Merged",merge:"concat",overlay:e,noDownsample:!0,style:t}),this.setSelectedTier(this.tiers.length-1)}},function(e,t,n){"use strict";function i(e,t){var n=parseFloat(e.replace(/,/g,""));return"k"===t||"K"===t?1e3*n|0:"m"==t||"M"===t?1e6*n|0:0|n}var r=n(247),o=r.Browser,a=n(277),s=a.URLFetchable,l=n(298).connectTrix,u=/^([\d+,\w,\.,\_,\-]+):([0-9,\.]+?)([KkMmGg])?((-|\.\.)+([0-9,\.]+)([KkMmGg])?)?$/;o.prototype.search=function(e,t){var n=this,r=u.exec(e);if(r){var o,a,c=r[1];if(r[6])o=i(r[2],r[3]),a=i(r[6],r[7]);else{var h=this.viewEnd-this.viewStart+1;o=i(r[2],r[3])-h/2|0,a=o+h-1}this.setLocation(c,o,a,t)}else{if(!e||0==e.length)return!1;var d=0,f=!1,p=function(i,r){if(--d,r)return t(r);i||(i=[]);for(var o=5e8,a=-1e8,s=null,l=0;l<i.length;++l){var u=i[l];null==s&&(s=u.segment),o=Math.min(o,u.min),a=Math.max(a,u.max)}if(s){f=!0,n.highlightRegion(s,o,a);var c=Math.max(2500,.3*(a-o+1)|0);n.setLocation(s,o-c,a+c,t)}else if(0==d&&!f)return t("no match for '"+e+"'")},_=function(t,n){n.lookup(e,function(n,i){if(null==n||n.length<2)return t.featureSource.search(e,p);var r=n[1].split(",")[0];return t.featureSource.search(r,p)})};if(this.searchEndpoint)return d=1,this.doDasSearch(n.searchEndpoint,e,p);for(var g=0;g<this.tiers.length;++g)!function(t){n.sourceAdapterIsCapable(t.featureSource,"search")?t.dasSource.trixURI?(++d,t.trix?_(t,t.trix):l(new s(t.dasSource.trixURI),new s(t.dasSource.trixURI+"x"),function(e){t.trix=e,_(t,e)})):(++d,t.featureSource.search(e,p)):t.dasSource.provides_search&&(++d,n.doDasSearch(t.dasSource,e,p))}(this.tiers[g])}},o.prototype.doDasSearch=function(e,t,n){e.features(null,{group:t,type:"transcript"},function(e){e||(e=[]);for(var i=[],r=0;r<e.length;++r){var o=e[r];o.label.toLowerCase()==t.toLowerCase()&&i.push(o)}return n(i)},!1)}},function(e,t,n){"use strict";function i(e,t,n){t.fetchAsText(function(t){if(!t)return n(null,"Couldn't fetch index-index");for(var i=t.split(/(.+)([0-9A-F]{10})\n/),o=[],a=[],s=1;s<i.length;s+=3)o.push(i[s]),a.push(parseInt(i[s+1],16));return n(new r(o,a,e))})}function r(e,t,n){this.keys=e,this.offsets=t,this.ix=n}r.prototype.lookup=function(e,t){for(var n,i=(e+"     ").substring(0,5).toLowerCase(),r=0;r<this.keys.length;++r)if(i.localeCompare(this.keys[r])<0){n=this.ix.slice(this.offsets[r-1],this.offsets[r]-this.offsets[r-1]);break}n||(n=this.ix.slice(this.offsets[this.offsets.length-1])),n.fetchAsText(function(n){for(var i=n.split("\n"),r=0;r<i.length;++r)if(0==i[r].indexOf(e.toLowerCase()+" "))return t(i[r].split(" "));return t(null)})},e.exports={connectTrix:i}},function(e,t,n){"use strict";function i(e,t){ne[e]=t}function r(e,t){ie[e]=t}function o(e){return ie[e]?ie[e](e):void 0}function a(e){var t=this;this.source=e,this.cfsid="cfs"+ ++re,e.name&&(this.name=e.name),e.addChangeListener&&e.addChangeListener(function(){t.cfsid="cfs"+ ++re})}function s(){this.busy=0,this.activityListeners=[],this.readinessListeners=[],this.readiness=null}function l(e){this.dasSource=new O(e),this.busy=0,this.activityListeners=[]}function u(e){this.dasSource=new O(e),this.awaitedEntryPoints=new k;var t=this;this.dasSource.entryPoints(function(e){t.awaitedEntryPoints.provide(e)})}function c(e){var t=this;this.source=e,this.twoBit=new k;var n;if(e.twoBitURI)n=new B(e.twoBitURI);else{if(!e.twoBitBlob)throw Error("No twoBitURI or twoBitBlob parameter");n=new z(e.twoBitBlob)}q(n,function(e,n){n?console.log(n):t.twoBit.provide(e)})}function h(e){s.call(this);var t=this;if(this.readiness="Connecting",this.bwgSource=this.opts=e,t.bwgHolder=new k,this.opts.preflight){var n=oe[this.opts.preflight];if(!n){n=new k,oe[this.opts.preflight]=n;var i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&(200==i.status?n.provide("success"):n.provide("failure"))},i.open("get",this.opts.preflight+"?"+hex_sha1("salt"+Date.now()),!0),this.opts.credentials&&(i.withCredentials=!0),i.send("")}n.await(function(e){"success"===e&&t.init()})}else t.init()}function d(e,t){s.call(this);this.worker=t,this.readiness="Connecting",this.bwgSource=this.opts=e,this.keyHolder=new k,this.init()}function f(e,t){if(!(e.flag&W.SEGMENT_UNMAPPED)){var n;if(n=e.seq?e.seq.length:e.seqLength,e.cigar){n=0;for(var i=Z(e.cigar),r=0;r<i.length;++r){var o=i[r];("M"==o.op||"D"==o.op)&&(n+=o.cnt)}}var a=new D;return a.min=e.pos+1,a.max=e.pos+n,a.segment=e.segment,a.type="bam",a.id=e.readName,a.notes=["MQ="+e.mq],a.cigar=e.cigar,a.seq=e.seq,a.quals=e.quals,a.orientation=e.flag&W.REVERSE_COMPLEMENT?"-":"+",a.bamRecord=e,t&&e.flag&W.MULTIPLE_SEGMENTS&&(a.groups=[{id:e.readName,type:"readpair"}]),a}}function p(e){s.call(this);var t=this;if(this.bamSource=e,this.opts={credentials:e.credentials,preflight:e.preflight,bamGroup:e.bamGroup},this.bamHolder=new k,this.opts.preflight){var n=oe[this.opts.preflight];if(!n){n=new k,oe[this.opts.preflight]=n;var i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&(200==i.status?n.provide("success"):n.provide("failure"))},i.open("get",this.opts.preflight+"?"+hex_sha1("salt"+Date.now()),!0),this.opts.credentials&&(i.withCredentials="true"),i.send("")}n.await(function(e){"success"===e&&t.init()})}else t.init()}function _(e,t){s.call(this);this.bamSource=e,this.worker=t,this.opts={credentials:e.credentials,preflight:e.preflight,bamGroup:e.bamGroup},this.keyHolder=new k,this.init()}function g(e,t){this.source=e,this.mapping=t,this.activityListeners=[],this.busy=0}function m(){}function v(){}function y(e){this.store=new J(e.jbURI,e.jbQuery)}var b=n(247),x=b.Browser,w=n(250),S=w.DasTier,A=n(248),k=A.Awaited,C=A.arrayIndexOf,T=A.shallowCopy,E=A.resolveUrlToPage,M=n(251),L=M.DASStylesheet,R=M.DASStyle,O=M.DASSource,P=M.DASSegment,D=M.DASFeature,I=M.DASSequence,N=M.DASLink,F=n(277),B=F.URLFetchable,z=F.BlobFetchable,H=n(300),q=H.makeTwoBit,G=n(278),j=G.makeBwg,U=n(292),V=U.makeBam,W=U.BamFlags,X=n(269),K=X.Range,Y=X.union,Z=n(271).parseCigar,$=n(301).OverlayFeatureSource,J=n(302).JBrowseStore,Q=n(276).Chainset,ee=n(253),te=(ee.StyleFilterSet,n(294).EncodeFetchable),ne={},ie={};S.prototype.initSources=function(){var e=this,t=this.browser.createSources(this.dasSource);this.featureSource=t.features||new m,this.sequenceSource=t.sequence,this.featureSource&&this.featureSource.addChangeListener&&this.featureSource.addChangeListener(function(){e.browser.refreshTier(e)})},x.prototype.createSources=function(e){var t=this.sourceCache.get(e);if(t)return t;var n,i;if("sequence"==e.tier_type||e.twoBitURI||e.twoBitBlob)i=e.twoBitURI||e.twoBitBlob?new c(e):new u(e);else if(e.tier_type&&ne[e.tier_type]){var r=ne[e.tier_type],o=r(e);n=o.features,i=o.sequence}else if(e.bwgURI||e.bwgBlob){var s=this.getWorker();n=s?new d(e,s):new h(e)}else if(e.bamURI||e.bamBlob){var s=this.getWorker();n=s?new _(e,s):new p(e)}else e.jbURI?n=new y(e):(e.uri||e.features_uri)&&(n=new l(e));if(e.overlay){var t=[];n&&t.push(new a(n));for(var f=0;f<e.overlay.length;++f){var m=this.createSources(e.overlay[f]);m&&m.features&&t.push(m.features)}n=new $(t,e)}return e.sequenceAliases&&(n=new g(n,new Q({type:"alias",sequenceAliases:e.sequenceAliases}))),e.mapping&&(n=new g(n,this.chains[e.mapping])),e.name&&n&&!n.name&&(n.name=e.name),null!=n&&(n=new a(n)),(null!=n||null!=i)&&(t={features:n,sequence:i},this.sourceCache.put(e,t)),t},S.prototype.fetchStylesheet=function(e){var t;t=!this.dasSource.stylesheet_uri&&(this.dasSource.tier_type||this.dasSource.bwgURI||this.dasSource.bwgBlob||this.dasSource.bamURI||this.dasSource.bamBlob||this.dasSource.twoBitURI||this.dasSource.twoBitBlob||this.dasSource.jbURI||this.dasSource.overlay)?this.getSource():new l(this.dasSource),t.getStyleSheet(e)};var re=0;a.prototype.addReadinessListener=function(e){return this.source.addReadinessListener?this.source.addReadinessListener(e):void e(null)},a.prototype.removeReadinessListener=function(e){return this.source.removeReadinessListener?this.source.removeReadinessListener(e):void 0},a.prototype.search=function(e,t){return this.source.search?this.source.search(e,t):void 0},a.prototype.getDefaultFIPs=function(e){return this.source.getDefaultFIPs?this.source.getDefaultFIPs(e):void 0},a.prototype.getStyleSheet=function(e){this.source.getStyleSheet(e)},a.prototype.getScales=function(){return this.source.getScales()},a.prototype.addActivityListener=function(e){this.source.addActivityListener&&this.source.addActivityListener(e)},a.prototype.removeActivityListener=function(e){this.source.removeActivityListener&&this.source.removeActivityListener(e)},a.prototype.addChangeListener=function(e){this.source.addChangeListener&&this.source.addChangeListener(e)},a.prototype.removeChangeListener=function(e){this.source.removeChangeListener&&this.source.removeChangeListener(e)},a.prototype.findNextFeature=function(e,t,n,i){this.source.findNextFeature(e,t,n,i)},a.prototype.quantFindNextFeature=function(e,t,n,i,r){this.source.quantFindNextFeature(e,t,n,i,r)},a.prototype.capabilities=function(){return this.source.capabilities?this.source.capabilities():{}},a.prototype.fetch=function(e,t,n,i,r,o,a,s){if(!o)throw Error("Fetch pool is null");var l=this,u=this.cfsid,c=o.awaitedFeatures[u];if(c&&c.started){if(c.styleFilters.doesNotContain(s))return void l.source.fetch(e,t,n,i,r,o,a,s)}else c?c.styleFilters.addAll(s):(c=new k,c.styleFilters=s,o.awaitedFeatures[u]=c,o.requestsIssued.then(function(){c.started=!0,l.source.fetch(e,t,n,i,c.styleFilters.typeList(),o,function(e,t,n,i){c.res||c.provide({status:e,features:t,scale:n,coverage:i})},c.styleFilters)})["catch"](function(e){console.log(e)}));c.await(function(e){a(e.status,e.features,e.scale,e.coverage)})},s.prototype.addReadinessListener=function(e){this.readinessListeners.push(e),e(this.readiness)},s.prototype.removeReadinessListener=function(e){var t=C(this.readinessListeners,e);t>=0&&this.readinessListeners.splice(t,1)},s.prototype.notifyReadiness=function(){for(var e=0;e<this.readinessListeners.length;++e)try{this.readinessListeners[e](this.readiness)}catch(t){console.log(t)}},s.prototype.addActivityListener=function(e){this.activityListeners.push(e)},s.prototype.removeActivityListener=function(e){var t=C(this.activityListeners,e);t>=0&&this.activityListeners.splice(t,1)},s.prototype.notifyActivity=function(){for(var e=0;e<this.activityListeners.length;++e)try{this.activityListeners[e](this.busy)}catch(t){console.log(t)}},s.prototype.getScales=function(){return null},s.prototype.fetch=function(e,t,n,i,r,o,a){return a(null,[],1e9)},s.prototype.getStyleSheet=function(e){var t=new L,n=new R;return n.glyph="BOX",n.BGCOLOR="blue",n.FGCOLOR="black",t.pushStyle({type:"default"},null,n),e(t)},l.prototype.addActivityListener=function(e){this.activityListeners.push(e)},l.prototype.removeActivityListener=function(e){var t=C(this.activityListeners,e);t>=0&&this.activityListeners.splice(t,1)},l.prototype.notifyActivity=function(){for(var e=0;e<this.activityListeners.length;++e)try{this.activityListeners[e](this.busy)}catch(t){console.log(t)}},l.prototype.getStyleSheet=function(e){this.dasSource.stylesheet(function(t){e(t)},function(){e(null,"Couldn't fetch DAS stylesheet")})},l.prototype.fetch=function(e,t,n,i,r,o,a){if(r&&0==r.length)return void a(null,[],i);if(this.dasSource.uri||this.dasSource.features_uri){if(this.dasSource.dasStaticFeatures&&this.cachedStaticFeatures)return a(null,this.cachedStaticFeatures,this.cachedStaticScale);var s=this.dasSource.maxbins!==!1,l={type:r};s&&(l.maxbins=1+((n-t)/i|0));var u=this;u.busy++,u.notifyActivity(),this.dasSource.features(new P(e,t,n),l,function(e,t){u.busy--,u.notifyActivity();var n=i;s||(n=.1),!t&&u.dasSource.dasStaticFeatures&&(u.cachedStaticFeatures=e,u.cachedStaticScale=n),a(t,e,n)})}},l.prototype.findNextFeature=this.sourceFindNextFeature=function(e,t,n,i){if(this.dasSource.capabilities&&C(this.dasSource.capabilities,"das1:adjacent-feature")>=0){var r=this;if(this.dasAdjLock)return console.log("Already looking for a next feature, be patient!");this.dasAdjLock=!0;var o={adjacent:e+":"+(0|t)+":"+(n>0?"F":"B")},a=thisTier.getDesiredTypes(thisTier.browser.scale);a&&(o.types=a),thisTier.dasSource.features(null,o,function(e){r.dasAdjLock=!1,e.length>0&&null!=e[0]&&i(e[0])})}},u.prototype.fetch=function(e,t,n,i,r){this.dasSource.sequence(new P(e,t,n),function(e){return 1==e.length?r(null,e[0]):r("Didn't get sequence")})},u.prototype.getSeqInfo=function(e,t){this.awaitedEntryPoints.await(function(n){for(var i=0;i<n.length;++i)if(n[i].name==e)return t({length:n[i].end});return t()})},c.prototype.fetch=function(e,t,n,i,r){this.twoBit.await(function(i){i.fetch(e,t,n,function(i,o){if(o)return r(o,null);var a=new I(e,t,n,"DNA",i);return r(null,a)})})},c.prototype.getSeqInfo=function(e,t){this.twoBit.await(function(n){var i=n.getSeq(e);i?n.getSeq(e).length(function(e){t({length:e})}):t()})},l.prototype.getScales=function(){return[]};var oe={};h.prototype=Object.create(s.prototype),h.prototype.init=function(){var e,t=this,n=this.bwgSource.uri||this.bwgSource.bwgURI;e=n?"encode"===this.bwgSource.transport?new te(n,{credentials:this.opts.credentials}):new B(n,{credentials:this.opts.credentials}):new z(this.bwgSource.bwgBlob),j(e,function(e,n){n?(t.error=n,t.readiness=null,t.notifyReadiness(),t.bwgHolder.provide(null)):(t.bwgHolder.provide(e),t.readiness=null,t.notifyReadiness(),"bigbed"==e.type&&e.getExtraIndices(function(e){t.extraIndices=e}))})},h.prototype.capabilities=function(){var e={leap:!0};if(this.bwgHolder.res&&"bigwig"==this.bwgHolder.res.type&&(e.quantLeap=!0),this.extraIndices&&this.extraIndices.length>0){e.search=[];for(var t=0;t<this.extraIndices.length;++t)e.search.push(this.extraIndices[t].field)}return e},h.prototype.fetch=function(e,t,n,i,r,o,a){var s=this;this.bwgHolder.await(function(o){if(null==o)return a(s.error||"Can't access binary file",null,null);var l,u=!r||0==r.length||C(r,"density")>=0;if(s.opts.clientBin&&(u=!1),"bigwig"==o.type||u||"undefined"!=typeof s.opts.forceReduction){for(var c=-1,h=0;h<o.zoomLevels.length&&o.zoomLevels[h].reduction<=i;++h)c=h;"undefined"!=typeof s.opts.forceReduction&&(c=s.opts.forceReduction),l=0>c?o.getUnzoomedView():o.getZoomedView(c)}else l=o.getUnzoomedView();s.busy++,s.notifyActivity(),l.readWigData(e,t,n,function(e){s.busy--,s.notifyActivity();var i=1e9;if("bigwig"===o.type){var r=(n-t)/e.length/2;i>r&&(i=r)}if(s.opts.link)for(var l=0;l<e.length;++l){var u=e[l];u.label&&(u.links=[new N("Link",s.opts.link.replace(/\$\$/,u.label))])}a(null,e,i)})})},h.prototype.quantFindNextFeature=function(e,t,n,i,r){var o=this;o.busy++,o.notifyActivity(),this.bwgHolder.res.thresholdSearch(e,t,n,i,function(e,t){return o.busy--,o.notifyActivity(),r(e,t)})},h.prototype.findNextFeature=function(e,t,n,i){var r=this;r.busy++,r.notifyActivity(),this.bwgHolder.res.getUnzoomedView().getFirstAdjacent(e,t,n,function(e){r.busy--,r.notifyActivity(),e.length>0&&null!=e[0]&&i(e[0])})},h.prototype.getScales=function(){var e=this.bwgHolder.res;if(e){for(var t=[1],n=0;n<e.zoomLevels.length;++n)t.push(e.zoomLevels[n].reduction);return t}return null},h.prototype.search=function(e,t){if(!this.extraIndices||0==this.extraIndices.length)return t(null,"No indices available");var n=this.extraIndices[0];return n.lookup(e,t)},h.prototype.getDefaultFIPs=function(e){return this.opts.noExtraFeatureInfo?!0:void this.bwgHolder.await(function(t){if(t&&t.schema&&t.definedFieldCount<t.schema.fields.length){var n=function(e,n){for(var i=0;i<n.hit.length;++i)if(n.hit[i].isSuperGroup)return;for(var r=t.definedFieldCount;r<t.schema.fields.length;++r){var o=t.schema.fields[r];n.add(o.comment,e[o.name])}};e(n)}})},h.prototype.getStyleSheet=function(e){this.bwgHolder.await(function(t){if(!t)return e(null,"bbi error");var n=new L;if("bigbed"==t.type){var i=new R;i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="blue",i.HEIGHT=8,i.BUMP=!0,i.LABEL=!0,i.ZINDEX=20,n.pushStyle({type:"bigwig"},null,i),i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="red",i.HEIGHT=10,i.BUMP=!0,i.ZINDEX=20,n.pushStyle({type:"translation"},null,i);var r=new R;r.glyph="BOX",r.FGCOLOR="black",r.BGCOLOR="white",r.HEIGHT=10,r.ZINDEX=10,r.BUMP=!0,r.LABEL=!0,n.pushStyle({type:"transcript"},null,r);var o=new R;o.glyph="HISTOGRAM",o.COLOR1="white",o.COLOR2="black",o.HEIGHT=30,n.pushStyle({type:"density"},null,o)}else{var i=new R;i.glyph="HISTOGRAM",i.COLOR1="white",i.COLOR2="black",i.HEIGHT=30,n.pushStyle({type:"default"},null,i)}return 12==t.definedFieldCount&&t.fieldCount>=14&&(n.geneHint=!0),e(n)})},d.prototype=Object.create(s.prototype),d.prototype.init=function(){var e=this,t=this.uri||this.bwgSource.uri||this.bwgSource.bwgURI,n=this.bwgSource.blob||this.bwgSource.bwgBlob,i=function(t,n){e.readiness=null,e.notifyReadiness(),t?e.worker.postCommand({command:"meta",connection:t},function(n,i){i?(e.error=i,e.keyHolder.provide(null)):(e.meta=n,e.keyHolder.provide(t))}):(e.error=n,e.keyHolder.provide(null))};n?this.worker.postCommand({command:"connectBBI",blob:n},i):this.worker.postCommand({command:"connectBBI",uri:E(t),transport:this.bwgSource.transport,credentials:this.bwgSource.credentials},i)},d.prototype.capabilities=function(){var e={leap:!0};if(this.meta&&"bigwig"==this.meta.type&&(e.quantLeap=!0),this.meta&&this.meta.extraIndices&&this.meta.extraIndices.length>0){e.search=[];for(var t=0;t<this.meta.extraIndices.length;++t)e.search.push(this.meta.extraIndices[t].field)}return e},d.prototype.fetch=function(e,t,n,i,r,o,a){var s=this;s.busy++,s.notifyActivity(),this.keyHolder.await(function(o){if(!o)return s.busy--,s.notifyActivity(),a(s.error||"Can't access binary file",null,null);var l=-1,u=!r||0==r.length||C(r,"density")>=0;if(s.opts.clientBin&&(u=!1),"bigwig"==s.meta.type||u||"undefined"!=typeof s.opts.forceReduction){for(var c=1;c<s.meta.zoomLevels.length&&s.meta.zoomLevels[c]<=i;++c)l=c-1;"undefined"!=typeof s.opts.forceReduction&&(l=s.opts.forceReduction)}s.worker.postCommand({command:"fetch",connection:o,chr:e,min:t,max:n,zoom:l},function(e,i){s.busy--,s.notifyActivity();var r=1e9;if("bigwig"===s.meta.type){var o=(n-t)/e.length/2;r>o&&(r=o)}if(s.opts.link)for(var l=0;l<e.length;++l){var u=e[l];u.label&&(u.links=[new N("Link",s.opts.link.replace(/\$\$/,u.label))])}a(i,e,r)})})},d.prototype.quantFindNextFeature=function(e,t,n,i,r){var o=this;this.busy++,this.notifyActivity(),this.worker.postCommand({command:"quantLeap",connection:this.keyHolder.res,chr:e,pos:t,dir:n,threshold:i,under:!1},function(e,t){return console.log(e,t),o.busy--,o.notifyActivity(),r(e,t)})},d.prototype.findNextFeature=function(e,t,n,i){var r=this;this.busy++,this.notifyActivity(),this.worker.postCommand({command:"leap",connection:this.keyHolder.res,chr:e,pos:t,dir:n},function(e,t){r.busy--,r.notifyActivity(),e.length>0&&null!=e[0]&&i(e[0])})},d.prototype.getScales=function(){var e=this.meta;return e?e.zoomLevels:null},d.prototype.search=function(e,t){if(!this.meta.extraIndices||0==this.meta.extraIndices.length)return t(null,"No indices available");var n=this;this.busy++,this.notifyActivity();var i=this.meta.extraIndices[0];this.worker.postCommand({command:"search",connection:this.keyHolder.res,query:e,index:i},function(e,i){n.busy--,n.notifyActivity(),t(e,i)})},d.prototype.getDefaultFIPs=function(e){if(this.opts.noExtraFeatureInfo)return!0;var t=this;this.keyHolder.await(function(n){var i=t.meta;if(i&&i.schema&&i.definedFieldCount<i.schema.fields.length){var r=function(e,t){for(var n=0;n<t.hit.length;++n)if(t.hit[n].isSuperGroup)return;for(var r=i.definedFieldCount;r<i.schema.fields.length;++r){var o=i.schema.fields[r];t.add(o.comment,e[o.name])}};e(r)}})},d.prototype.getStyleSheet=function(e){var t=this;this.keyHolder.await(function(n){var i=t.meta;if(!i)return e(null,"bbi error");var r=new L;if("bigbed"==i.type){var o=new R;o.glyph="BOX",o.FGCOLOR="black",o.BGCOLOR="blue",o.HEIGHT=8,o.BUMP=!0,o.LABEL=!0,o.ZINDEX=20,r.pushStyle({type:"bigwig"},null,o),o.glyph="BOX",o.FGCOLOR="black",o.BGCOLOR="red",o.HEIGHT=10,o.BUMP=!0,o.ZINDEX=20,r.pushStyle({type:"translation"},null,o);var a=new R;a.glyph="BOX",a.FGCOLOR="black",a.BGCOLOR="white",a.HEIGHT=10,a.ZINDEX=10,a.BUMP=!0,a.LABEL=!0,r.pushStyle({type:"transcript"},null,a);var s=new R;s.glyph="HISTOGRAM",s.COLOR1="white",s.COLOR2="black",s.HEIGHT=30,r.pushStyle({type:"density"},null,s)}else{var o=new R;o.glyph="HISTOGRAM",o.COLOR1="white",o.COLOR2="black",o.HEIGHT=30,r.pushStyle({type:"default"},null,o)}return 12==i.definedFieldCount&&i.fieldCount>=14&&(r.geneHint=!0),e(r)})},p.prototype=Object.create(s.prototype),p.prototype.init=function(){var e,t,n=this;this.bamSource.bamBlob?(e=new z(this.bamSource.bamBlob),t=new z(this.bamSource.baiBlob)):(e=new B(this.bamSource.bamURI,{credentials:this.opts.credentials}),t=new B(this.bamSource.baiURI||this.bamSource.bamURI+".bai",{credentials:this.opts.credentials})),V(e,t,null,function(e,t){n.readiness=null,n.notifyReadiness(),e?n.bamHolder.provide(e):(n.error=t,n.bamHolder.provide(null))})},p.prototype.fetch=function(e,t,n,i,r,o,a){var s=r&&1==r.length&&"density"==r[0],l=this;l.busy++,l.notifyActivity(),this.bamHolder.await(function(i){return i?void i.fetch(e,t,n,function(e,t){if(l.busy--,l.notifyActivity(),t)a(t,null,null);else{for(var n=[],i=0;i<e.length;++i){var r=e[i],o=f(r,l.opts.bamGroup);o&&n.push(o)}a(null,n,1e9)}},{light:s}):(l.busy--,l.notifyActivity(),a(l.error||"Couldn't fetch BAM"))})},p.prototype.getScales=function(){return 1e9},p.prototype.getStyleSheet=function(e){this.bamHolder.await(function(t){var n=new L,i=new R;i.glyph="HISTOGRAM",i.COLOR1="black",i.COLOR2="red",i.HEIGHT=30,n.pushStyle({type:"density"},"low",i),n.pushStyle({type:"density"},"medium",i);var r=new R;return r.glyph="__SEQUENCE",r.FGCOLOR="black",r.BGCOLOR="blue",r.HEIGHT=8,r.BUMP=!0,r.LABEL=!1,r.ZINDEX=20,n.pushStyle({type:"bam"},"high",r),e(n)})},_.prototype=Object.create(s.prototype),_.prototype.init=function(){var e=this,t=this.bamSource.uri||this.bamSource.bamURI,n=this.bamSource.indexUri||this.bamSource.baiURI||t+".bai",i=this.bamSource.bamBlob||this.bamSource.blob,r=this.bamSource.baiBlob||this.bamSource.indexBlob,o=function(t,n){e.readiness=null,e.notifyReadiness(),t?e.keyHolder.provide(t):(e.error=n,e.keyHolder.provide(null))};i?this.worker.postCommand({command:"connectBAM",blob:i,indexBlob:r},o):this.worker.postCommand({command:"connectBAM",uri:E(t),indexUri:E(n),credentials:this.bamSource.credentials,indexChunks:this.bamSource.indexChunks},o)},_.prototype.fetch=function(e,t,n,i,r,o,a){var s=r&&1==r.length&&"density"==r[0],l=this;l.busy++,l.notifyActivity(),this.keyHolder.await(function(i){return i?void l.worker.postCommand({command:"fetch",connection:i,chr:e,min:t,max:n,opts:{light:s}},function(e,t){if(l.busy--,l.notifyActivity(),t)a(t,null,null);else{for(var n=[],i=0;i<e.length;++i){var r=e[i],o=f(r,l.opts.bamGroup);o&&n.push(o)}a(null,n,1e9)}}):(l.busy--,l.notifyActivity(),a(l.error||"Couldn't fetch BAM"))})},_.prototype.getScales=function(){return 1e9},_.prototype.getStyleSheet=function(e){this.keyHolder.await(function(t){var n=new L,i=new R;i.glyph="HISTOGRAM",i.COLOR1="black",i.COLOR2="red",i.HEIGHT=30,n.pushStyle({type:"density"},"low",i),n.pushStyle({type:"density"},"medium",i);var r=new R;return r.glyph="__SEQUENCE",r.FGCOLOR="black",r.BGCOLOR="blue",r.HEIGHT=8,r.BUMP=!0,r.LABEL=!1,r.ZINDEX=20,n.pushStyle({type:"bam"},"high",r),e(n)})},g.prototype.addActivityListener=function(e){this.activityListeners.push(e)},g.prototype.removeActivityListener=function(e){var t=C(this.activityListeners,e);t>=0&&this.activityListeners.splice(t,0)},g.prototype.notifyActivity=function(){for(var e=0;e<this.activityListeners.length;++e)try{this.activityListeners[e](this.busy)}catch(t){console.log(t)}},g.prototype.getStyleSheet=function(e){return this.source.getStyleSheet(e)},g.prototype.getScales=function(){return this.source.getScales()},g.prototype.getDefaultFIPs=function(e){return this.source.getDefaultFIPs?this.source.getDefaultFIPs(e):void 0},g.prototype.simplifySegments=function(e,t){if(0==e.length)return e;e.sort(function(e,t){var n=e.name-t.name;return n?n:(n=e.start-t.start,n?n:e.end-t.end)});for(var n=[],i=e[0],r=0;r<e.length;++r){var o=e[r];o.name!=i.name||o.start>i.end+t?(n.push(i),i=o):i=new P(i.name,Math.min(i.start,o.start),Math.max(i.end,o.end))}return n.push(i),n},g.prototype.fetch=function(e,t,n,i,r,o,a,s){var l=this,u=n-t+1;l.busy++,l.notifyActivity(),this.mapping.sourceBlocksForRange(e,t,n,function(e){if(0==e.length)l.busy--,l.notifyActivity(),a("No mapping available for this regions",[],i);else{e=l.simplifySegments(e,Math.max(100,.05*u));var t,n=[],c=null,h=e.length;e.map(function(e){l.source.fetch(e.name,e.start,e.end,i,r,o,function(i,r,o){if(i&&!t&&(t=i),r)for(var s=0;s<r.length;++s){var u=r[s],d=u.segment;0==d.indexOf("chr")&&(d=d.substr(3));var f=l.mapping.mapSegment(d,u.min,u.max);if(0==f.length)u.parts&&u.parts.length>0&&n.push(u);else for(var p=0;p<f.length;++p){var _=f[p],g=T(u);g.segment=_.segment,g.min=_.min,g.max=_.max,_.partialMin&&(g.partialMin=_.partialMin),_.partialMax&&(g.partialMax=_.partialMax),_.flipped&&("-"==u.orientation?g.orientation="+":"+"==u.orientation&&(g.orientation="-")),n.push(g)}}var m=l.mapping.mapPoint(e.name,e.start),v=l.mapping.mapPoint(e.name,e.end);if(m&&v){var y=new K(m.pos,v.pos);c=c?Y(c,y):y}--h,0==h&&(l.busy--,l.notifyActivity(),a(t,n,o,c))},s)})}})},m.prototype.getScales=function(){return null},m.prototype.fetch=function(e,t,n,i,r,o,a){
return a(null,[],1e9)},m.prototype.getStyleSheet=function(e){var t=new L,n=new R;return n.glyph="BOX",n.BGCOLOR="blue",n.FGCOLOR="black",t.pushStyle({type:"default"},null,n),e(t)},v.prototype.fetch=function(e,t,n,i,r){return r(null,null)},y.prototype.getScales=function(){return null},y.prototype.getStyleSheet=function(e){var t=new L,n=new R;return n.glyph="BOX",n.FGCOLOR="black",n.BGCOLOR="green",n.HEIGHT=8,n.BUMP=!0,n.LABEL=!0,n.ZINDEX=20,t.pushStyle({type:"default"},null,n),e(t)},y.prototype.fetch=function(e,t,n,i,r,o,a){if(r&&0==r.length)return void a(null,[],i);var s={};this.store.features(new P(e,t,n),s,function(e,t){a(t,e,1e5)})},x.prototype.sourceAdapterIsCapable=function(e,t){return e.capabilities?e.capabilities()[t]:!1},e.exports={FeatureSourceBase:s,TwoBitSequenceSource:c,DASSequenceSource:u,MappedFeatureSource:g,CachingFeatureSource:a,BWGFeatureSource:h,RemoteBWGFeatureSource:d,BAMFeatureSource:p,RemoteBAMFeatureSource:_,DummyFeatureSource:m,DummySequenceSource:v,registerSourceAdapterFactory:i,registerParserFactory:r,makeParser:o},n(303),n(304),n(305),n(306),n(307)},function(e,t,n){"use strict";function i(){}function r(e,t){var n=new i;n.data=e;var r=12500;n.data.slice(0,r).fetch(function(e){if(!e)return t(null,"Couldn't access data");var i=new Uint8Array(e),a=s(i,0);if(a==f)n.readInt=s;else{if(a!=p)return t(null,"Not a .2bit file, magic=0x"+a.toString(16));n.readInt=l}var u=n.readInt(i,4);if(0!=u)return t(null,"Unsupported version "+u);n.seqCount=n.readInt(i,8),n.seqDict={};var c=16,h=0,d=0,_=function(){for(;h<n.seqCount;){var e=i[c];if(c+e+6>=i.length)return n.data.slice(d+c,r).fetch(function(e){d+=c,c=0,i=new Uint8Array(e),_()});++c;for(var a="",s=1;e>=s;++s)a+=String.fromCharCode(i[c++]);var l=n.readInt(i,c);c+=4,n.seqDict[a]=new o(n,l),++h}return t(n)};_()})}function o(e,t){this.tbf=e,this.offset=t}var a=n(277),s=a.readInt,l=a.readIntBE,u=n(269),c=u.Range,h=u.union,d=u.intersection,f=440477507,p=1126646042;i.prototype.getSeq=function(e){var t=this.seqDict[e];return t||(t=this.seqDict["chr"+e]),t},i.prototype.fetch=function(e,t,n,i){var r=this.getSeq(e);return r?t>=n?i(""):void r.fetch(t,n,i):i(null,"Couldn't find "+e)},o.prototype.init=function(e){if(this.seqOffset)return e();var t=this;t.tbf.data.slice(t.offset,8).fetch(function(n){if(!n)return e("Fetch failed");var i=new Uint8Array(n);t._length=t.tbf.readInt(i,0),t.nBlockCnt=t.tbf.readInt(i,4),t.tbf.data.slice(t.offset+8,8*t.nBlockCnt+4).fetch(function(n){if(!n)return e("Fetch failed");for(var i=new Uint8Array(n),r=null,o=0;o<t.nBlockCnt;++o){var a=t.tbf.readInt(i,4*o),s=t.tbf.readInt(i,4*(o+t.nBlockCnt)),l=new c(a,a+s-1);r=r?h(r,l):l}return t.nBlocks=r,t.mBlockCnt=t.tbf.readInt(i,8*t.nBlockCnt),t.seqLength=(t._length+3)/4|0,t.seqOffset=t.offset+16+8*(t.nBlockCnt+t.mBlockCnt),e()})})};var _=["T","C","A","G"];o.prototype.fetch=function(e,t,n){--e,--t;var i=this;this.init(function(r){if(r)return n(null,r);var o=e>>2,a=t+3>>2;return 0>o||a>i.seqLength?n("Coordinates out of bounds: "+e+":"+t):void i.tbf.data.slice(i.seqOffset+o,a-o).salted().fetch(function(r){function a(e){for(;e>=f;){var t,n=(f>>2)-o,i=3&f,r=s[n];t=0==i?r>>6&3:1==i?r>>4&3:2==i?r>>2&3:3&r,h+=_[t],++f}}if(null==r)return n("SeqFetch failed");var s=new Uint8Array(r),l=[];if(i.nBlocks){var u=d(new c(e,t),i.nBlocks);u&&(l=u.ranges())}for(var h="",f=e,p=0;p<l.length;++p){var g=l[p];if(f>g.min())throw"N mismatch...";for(f<g.min()&&a(g.min()-1);f<=g.max();)h+="N",++f}return t>=f&&a(t),n(h)})})},o.prototype.length=function(e){var t=this;this.init(function(n){return n?e(null,n):e(t._length)})},e.exports={makeTwoBit:r}},function(e,t,n){"use strict";function i(e,t){this.sources=e,this.opts=t||{},this.activityListeners=[],this.readinessListeners=[],this.changeListeners=[],this.business=[],this.readiness=[];for(var n=0;n<this.sources.length;++n)this.initN(n);"function"==typeof t.merge?this.merge=t.merge:"concat"==t.merge?this.merge=a:"alternates"==t.merge?(this.merge=a,this.filterDispatchOnMethod=!0):this.merge=o}function r(e,t,n){this.source=e,this.callback=t,this.sources=n,this.count=n.length,this.returnCount=0,this.statusCount=0,this.returns=[],this.features=[],this.statuses=[],this.scale=null}function o(e){for(var t=[],n=1;n<e.length;++n){for(var i={},r=e[n],o=0;o<r.length;++o)i[this.keyForFeature(r[o])]=r[o];t.push(i)}for(var a=[],s=e[0],o=0;o<s.length;++o){for(var l=s[o],u=0;u<t.length;++u){var i=t[u];if(r=i[this.keyForFeature(l)])for(var c in r)"score"===c?l.score2=r.score:"min"===c||"max"===c||"segment"===c||"_cachedStyle"===c||(l[c]=r[c])}a.push(l)}return a}function a(e,t){for(var n=[],i=0;i<e.length;++i)for(var r=e[i],o=t[i].name,a=0;a<r.length;++a){var s=r[a];s.method=o,n.push(s)}return n}function s(e,t){return e.capabilities?e.capabilities()[t]:!1}var l=n(248),u=l.shallowCopy,c=l.arrayIndexOf;i.prototype.initN=function(e){var t=this.sources[e],n=this;this.business[e]=0,t.addActivityListener&&t.addActivityListener(function(t){n.business[e]=t,n.notifyActivity()}),t.addChangeListener&&t.addChangeListener(function(){n.notifyChange()}),t.addReadinessListener&&t.addReadinessListener(function(t){n.readiness[e]=t,n.notifyReadiness()})},i.prototype.addReadinessListener=function(e){this.readinessListeners.push(e),this.notifyReadinessListener(e)},i.prototype.removeReadinessListener=function(e){var t=c(this.readinessListeners,e);t>=0&&this.readinessListeners.splice(t,1)},i.prototype.notifyReadiness=function(){for(var e=0;e<this.readinessListeners.length;++e)this.notifyReadinessListener(this.readinessListeners[e])},i.prototype.notifyReadinessListener=function(e){for(var t=null,n=0;n<this.readiness.length;++n)if(null!=this.readiness[n]){t=this.readiness[n];break}try{e(t)}catch(i){console.log(i)}},i.prototype.addActivityListener=function(e){this.activityListeners.push(e)},i.prototype.removeActivityListener=function(e){var t=c(this.activityListeners,e);t>=0&&this.activityListeners.splice(t,1)},i.prototype.notifyActivity=function(){for(var e=0,t=0;t<this.business.length;++t)e+=this.business[t];for(var n=0;n<this.activityListeners.length;++n)try{this.activityListeners[n](e)}catch(i){console.log(i)}},i.prototype.addChangeListener=function(e){this.changeListeners.push(e)},i.prototype.removeChangeListener=function(e){var t=c(this.changeListeners,e);t>=0&&this.changeListeners.splice(t,1)},i.prototype.notifyChange=function(){for(var e=0;e<this.changeListeners.length;++e)try{this.changeListeners[e](this.busy)}catch(t){console.log(t)}},i.prototype.getScales=function(){return this.sources[0].getScales()},i.prototype.getStyleSheet=function(e){return this.sources[0].getStyleSheet(e)},i.prototype.capabilities=function(){var e={},t=this.sources[0];t.capabilities&&(e=u(t.capabilities()));for(var n=1;n<this.sources.length;++n){var i=this.sources[n];if(i.capabilities){var r=i.capabilities();r.search&&(e.search=r.search)}}return e},i.prototype.search=function(e,t){for(var n=0;n<this.sources.length;++n)if(s(this.sources[n],"search"))return this.sources[n].search(e,t)},i.prototype.fetch=function(e,t,n,i,o,a,s,l){var u;if(this.filterDispatchOnMethod){u=[];for(var c=l.list(),h=0;h<this.sources.length;++h)for(var d=this.sources[h],f=0;f<c.length;++f){var p=c[f];if(!p.method||p.method==d.name){u.push(d);break}}}else u=this.sources;for(var _=new r(this,s,u),h=0;h<u.length;++h)this.fetchN(_,h,u[h],e,t,n,i,o,a,l)},i.prototype.fetchN=function(e,t,n,i,r,o,a,s,l,u){n.fetch(i,r,o,a,s,l,function(n,i,r){return e.completed(t,n,i,r)},u)},i.prototype.quantFindNextFeature=function(e,t,n,i,r){return this.sources[0].quantFindNextFeature(e,t,n,i,r)},i.prototype.findNextFeature=function(e,t,n,i){return this.sources[0].findNextFeature(e,t,n,i)},r.prototype.completed=function(e,t,n,i){if((null==this.scale||0==e)&&(this.scale=i),this.returns[e])throw"Multiple returns for source "+e;if(this.returns[e]=!0,this.returnCount++,this.features[e]=n,t&&(this.statuses[e]=t,this.statusCount++),this.returnCount==this.count){if(this.statusCount>0){for(var r="",o=0;o<this.count;++o){var a=this.statuses[o];a&&(r.length>0&&(r+=", "),r+=a)}return this.callback(r,null,this.scale)}this.callback(null,this.source.merge(this.features,this.sources),this.scale)}},i.prototype.getDefaultFIPs=function(e){for(var t=0;t<this.sources.length;++t){var n=this.sources[t];n.getDefaultFIPs&&n.getDefaultFIPs(e)}},i.prototype.keyForFeature=function(e){return""+e.min+".."+e.max},e.exports={OverlayFeatureSource:i}},function(e,t,n){function i(e,t){this.base=e,this.query=t}var r=n(251),o=(r.DASStylesheet,r.DASStyle,r.DASFeature);r.DASGroup;i.prototype.features=function(e,t,n){t=t||{},url=this.base+"/features/"+e.name;var i=[];this.query&&i.push(this.query),e.isBounded&&(i.push("start="+e.start),i.push("end="+e.end)),i.length>0&&(url=url+"?"+i.join("&"));var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState)if(r.status>=300)n(null,"Error code "+r.status);else{var t=JSON.parse(r.response).features,i=[];for(fi=0;fi<t.length;++fi){var a=t[fi],s=new o;s.segment=e,s.min=(0|a.start)+1,s.max=0|a.end,a.name&&(s.label=a.name),s.type=a.type||"unknown",i.push(s)}n(i)}},r.open("GET",url,!0),r.responseType="text",r.send("")},e.exports={JBrowseStore:i}},function(e,t,n){"use strict";function i(e){if(a.call(this),this.source=e,this.base=e.uri||"//rest.ensembl.org",0===this.base.indexOf("//")){var t=window.location.protocol;"http:"==t||"https:"==t||(this.base="http:"+this.base)}this.species=e.species||"human","string"==typeof e.type?this.type=[e.type]:this.type=e.type||["regulatory"]}var r=n(299),o=r.registerSourceAdapterFactory,a=r.FeatureSourceBase,s=n(251),l=s.DASStylesheet,u=s.DASStyle,c=s.DASFeature,h=s.DASGroup;i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i.prototype.getStyleSheet=function(e){var t=new l,n=new u;n.glyph="__NONE",this.type.indexOf("exon")>=0&&t.pushStyle({type:"transcript"},null,n),(this.type.indexOf("exon")>=0||this.type.indexOf("transcript")>=0)&&t.pushStyle({type:"gene"},null,n);var i=new u;i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="red",i.HEIGHT=8,i.BUMP=!0,i.LABEL=!0,i.ZINDEX=10,t.pushStyle({type:"cds"},null,i);var r=new u;r.glyph="SQUARE",r.BUMP="yes",r.LABEL="no",r.FGCOLOR="blue",t.pushStyle({type:"variation",method:".+_UTR_variant"},null,r);var r=new u;r.glyph="TRIANGLE",r.DIRECTION="S",r.BUMP="yes",r.LABEL="no",r.FGCOLOR="blue",t.pushStyle({type:"variation",method:"missense_variant"},null,r);var r=new u;r.glyph="TRIANGLE",r.DIRECTION="N",r.BUMP="yes",r.LABEL="no",r.FGCOLOR="blue",t.pushStyle({type:"variation",method:"splice_.+_variant"},null,r);var r=new u;r.glyph="STAR",r.POINTS=6,r.BUMP="yes",r.LABEL="no",r.FGCOLOR="blue",t.pushStyle({type:"variation",method:"regulatory_region_variant"},null,r);var r=new u;r.glyph="PLIMSOLL",r.BUMP="yes",r.LABEL="no",r.FGCOLOR="rgb(50,80,255)",r.STROKECOLOR="black",t.pushStyle({type:"variation"},null,r);var r=new u;r.glyph="SQUARE",r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",t.pushStyle({type:"indel",method:".+_UTR_variant"},null,r);var r=new u;r.glyph="TRIANGLE",r.DIRECTION="S",r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",t.pushStyle({type:"indel",method:"missense_variant"},null,r);var r=new u;r.glyph="TRIANGLE",r.DIRECTION="N",r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",t.pushStyle({type:"indel",method:"splice_.+_variant"},null,r);var r=new u;r.glyph="STAR",r.POINTS=6,r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",t.pushStyle({type:"indel",method:"regulatory_region_variant"},null,r);var r=new u;r.glyph="PLIMSOLL",r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",r.STROKECOLOR="black",t.pushStyle({type:"indel"},null,r);var o=new u;return o.glyph="BOX",o.FGCOLOR="black",o.BGCOLOR="orange",o.HEIGHT=8,o.BUMP=!0,o.LABEL=!0,o.ZINDEX=20,t.pushStyle({type:"default"},null,o),e(t)},i.prototype.getScales=function(){return[]},i.prototype.fetch=function(e,t,n,i,r,o,a){for(var s=this,l=this.base+"/overlap/region/"+this.species+"/"+e+":"+t+"-"+n,u=[],d=0;d<this.type.length;++d)u.push("feature="+this.type[d]);u.push("content-type=application/json"),l=l+"?"+u.join(";");var f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==f.readyState)if(s.busy--,s.notifyActivity(),f.status>=300){var t="Error code "+f.status;try{var n=JSON.parse(f.response);n.error&&(t=n.error)}catch(i){}a(t,null)}else{for(var r=JSON.parse(f.response),o=[],l=0;l<r.length;++l){var u=r[l],d=[],p=new c;if(p.segment=e,p.min=0|u.start,p.max=0|u.end,p.type=u.feature_type||"unknown",p.id=u.ID,u.Parent){var _=new h;_.id=u.Parent,p.groups=[_]}u.strand&&(u.strand<0?p.orientation="-":u.strand>0&&(p.orientation="+")),u.consequence_type&&(p.method=u.consequence_type),u.alt_alleles&&(d.push("Alleles="+u.alt_alleles.join("/")),u.alt_alleles.length>1&&(u.alt_alleles[1].length!=u.alt_alleles[0].length||"-"==u.alt_alleles[1])&&(p.type="indel")),d.length>0&&(p.notes=d),o.push(p)}a(null,o)}},s.busy++,s.notifyActivity(),f.open("GET",l,!0),f.responseType="text",f.send("")},o("ensembl",function(e){return{features:new i(e)}})},function(e,t,n){"use strict";function i(e){s.call(this),this.readiness="Connecting",this.source=e,this.tabixHolder=new d;var t=this,n=a(e.payload);if(!n)throw"Unsuported tabix payload "+e.payload;this.parser=n;var i,r;this.source.blob?(i=new c(this.source.blob),r=new c(this.source.indexBlob)):(i=new u(this.source.uri,{credentials:this.source.credentials}),r=new u(this.source.indexURI||this.source.uri+".tbi",{credentials:this.source.credentials})),f(i,r,function(e,i){t.tabixHolder.provide(e),e.fetchHeader(function(e,t){if(e){for(var i=n.createSession(function(){}),r=0;r<e.length;++r)i.parse(e[r]);i.flush()}}),t.readiness=null,t.notifyReadiness()})}var r=n(299),o=r.registerSourceAdapterFactory,a=r.makeParser,s=r.FeatureSourceBase,l=n(277),u=l.URLFetchable,c=l.BlobFetchable,h=n(248),d=h.Awaited,f=n(293).connectTabix;i.prototype=Object.create(s.prototype),i.prototype.fetch=function(e,t,n,i,r,o,a){var s=this;s.busy++,s.notifyActivity(),this.tabixHolder.await(function(i){i.fetch(e,t,n,function(e,t){s.busy--,s.notifyActivity();for(var n=[],i=s.parser.createSession(function(e){n.push(e)}),r=0;r<e.length;++r){i.parse(e[r])}i.flush(),a(null,n,1e9)})})},i.prototype.getStyleSheet=function(e){this.parser&&this.parser.getStyleSheet&&this.parser.getStyleSheet(e)},i.prototype.getDefaultFIPs=function(e){this.parser&&this.parser.getDefaultFIPs&&this.parser.getDefaultFIPs(e)},o("tabix",function(e){return{features:new i(e)}})},function(e,t,n){"use strict";function i(){this.featuresByChr={},this.maxLength=1,this.chrRing=null}function r(e){if(this.source=e,l.call(this),this.storeHolder=new h,this.parser=s(e.payload),!this.parser)throw"Unsupported memstore payload: "+e.payload;var t=this;this._load(function(e,n){if(e){for(var r=new i,o=[],a=e.split("\n"),s=t.parser.createSession(function(e){o.push(e)}),l=0;l<a.length;++l){var u=a[l];u.length>0&&s.parse(u)}s.flush(),r.addFeatures(o),t.storeHolder.provide(r)}else t.error=n||"No data",t.storeHolder.provide(null)})}var o=n(299),a=o.registerSourceAdapterFactory,s=o.makeParser,l=o.FeatureSourceBase,u=n(251),c=(u.DASStylesheet,u.DASStyle,u.DASFeature,u.DASGroup,n(248)),h=c.Awaited,d=c.textXHR;i.prototype.addFeatures=function(e){for(var t={},n=0;n<e.length;++n){var i=e[n],r=i.segment||i.chr,o=this.featuresByChr[r];o||(o=[],this.featuresByChr[r]=o),o.push(i),t[r]=!0;var a=i.max-i.min+1;a>this.maxLength&&(this.maxLength=a)}for(r in t){var o=this.featuresByChr[r];o.sort(function(e,t){var n=e.min-t.min;return 0!=n?n:e.max-t.max})}this.chrRing=null},i.prototype._indexFor=function(e,t){for(var n=0,i=e.length;i>n;){var r=(n+i)/2|0;if(r>=e.length)return e.length;var o=e[r];t<o.min?i=r:n=r+1}return i},i.prototype.fetch=function(e,t,n){var i=this.featuresByChr[e];if(i||(i=0==e.indexOf("chr")?this.featuresByChr[e.substring(3)]:this.featuresByChr["chr"+e]),!i)return[];for(var r=Math.max(0,this._indexFor(i,t-this.maxLength-1)),o=Math.min(i.length-1,this._indexFor(i,n)),a=[],s=r;o>=s;++s){var l=i[s];l.min<=n&&l.max>=t&&a.push(l)}return a},i.prototype.findNextFeature=function(e,t,n){if(null==this.chrRing){this.chrRing=[];for(var e in this.featuresByChr)this.chrRing.push(e);this.chrRing.sort()}var i=this.featuresByChr[e];if(i||(0==e.indexOf("chr")?(e=e.substring(3),i=this.featuresByChr[e]):(e="chr"+e,i=this.featuresByChr[e])),!i)return null;var r=Math.max(0,Math.min(this._indexFor(i,t),i.length-1));if(n>0){for(;r<i.length;){var o=i[r++];if(o.min>t)return o}var a=this.chrRing.indexOf(e)+1;return a>=this.chrRing.length&&(a=0),this.findNextFeature(this.chrRing[a],0,n)}for(;r>=0;){var o=i[r--];if(o.max<t)return o}var a=this.chrRing.indexOf(e)-1;return 0>a&&(a=this.chrRing.length-1),this.findNextFeature(this.chrRing[a],1e10,n)},r.prototype=Object.create(l.prototype),r.prototype._load=function(e){if(this.source.blob){var t=new FileReader;t.onloadend=function(){return e(t.result,t.error)},t.readAsText(this.source.blob)}else{if(this.source.credentials)var n={credentials:this.source.credentials};d(this.source.uri,e,n)}},r.prototype.fetch=function(e,t,n,i,r,o,a){var s=this;this.storeHolder.await(function(i){if(i){var r=i.fetch(e,t,n);return a(null,r,1e8)}return a(s.error)})},r.prototype.getStyleSheet=function(e){this.parser&&this.parser.getStyleSheet&&this.parser.getStyleSheet(e)},r.prototype.getDefaultFIPs=function(e){this.parser&&this.parser.getDefaultFIPs&&this.parser.getDefaultFIPs(e)},r.prototype.getScales=function(){return 1e8},r.prototype.findNextFeature=function(e,t,n,i){var r=this;this.storeHolder.await(function(o){return o?i(o.findNextFeature(e,t,n)):i(null,r.error)})},r.prototype.capabilities=function(){var e={leap:!0};return e},a("memstore",function(e){return{features:new r(e)}})},function(e,t,n){"use strict";function i(e){this.type=e}function r(e,t){this.parser=e,this.sink=t}function o(e,t){this.parser=e,this.sink=t,this.wigState=null}var a=n(269),s=a.Range,l=a.union,u=a.intersection,c=n(299),h=c.registerParserFactory,d=n(251),f=d.DASStylesheet,p=d.DASStyle,_=(d.DASFeature,d.DASGroup),g=n(248),m=g.shallowCopy;i.prototype.createSession=function(e){return"wig"==this.type?new o(this,e):new r(this,e)};var v=/([^=]+)=(.+)/,y=/\s/,b=new RegExp("^[0-9]+,[0-9]+,[0-9]+");r.prototype.parse=function(e){var t=e.split(y);if(!(t.length<3)){var n=parseInt(t[1])+1,i=parseInt(t[2]),r={segment:t[0],min:n,max:i};if(t.length>3&&"."!==t[3]&&(r.label=t[3]),t.length>4&&(r.score=parseFloat(t[4])),t.length>5&&(r.orientation=t[5]),t.length>8){var o=t[8];b.test(o)&&(r.itemRgb="rgb("+o+")")}if(t.length>=12){var a=parseInt(t[6]),c=parseInt(t[7]),h=parseInt(t[9]),d=t[10].split(",").map(function(e){return parseInt(e)}),f=t[11].split(",").map(function(e){return parseInt(e)});r.type="transcript";var p=new _;if(p.id=t[3],p.type="transcript",p.notes=[],r.groups=[p],t.length>12){var g=t[12],v=g;t.length>13&&(v=t[13]);var x=new _;x.id=g,x.label=v,x.type="gene",r.groups.push(x)}for(var w=null,S=0;h>S;++S){var A=f[S]+n,k=A+d[S],C=new s(A,k);w=w?l(w,C):C}for(var T=w.ranges(),E=0;E<T.length;++E){var M=T[E],L=m(r);L.min=M.min(),L.max=M.max(),this.sink(L)}if(c>a){var R="+"==r.orientation?new s(a,c+3):new s(a-3,c),O=u(w,R);if(O){r.type="translation";for(var P=O.ranges(),D=0,E=0;E<P.length;++E){var I=E;"-"==r.orientation&&(I=P.length-E-1);var M=P[I],L=m(r);L.min=M.min(),L.max=M.max(),r.readframe=D;var N=M.max()-M.min();D=(D+N)%3,this.sink(L)}}}}else this.sink(r)}},r.prototype.flush=function(){},o.prototype.parse=function(e){var t=e.split(y);if("fixedStep"==t[0]){this.wigState="fixedStep",this.chr=this.pos=this.step=null,this.span=1;for(var n=1;n<t.length;++n){var i=v.exec(t[n]);i&&("chrom"==i[1]?this.chr=i[2]:"start"==i[1]?this.pos=parseInt(i[2]):"step"==i[1]?this.step=parseInt(i[2]):"span"==i[1]&&(this.span=parseInt(i[2])))}}else if("variableStep"==t[0]){this.wigState="variableStep",this.chr=null,this.span=1;for(var n=1;n<t.length;++n){var i=v.exec(t[n]);"chrom"==i[1]?this.chr=i[2]:"span"==i[1]&&(this.span=parseInt(i[2]))}}else if(this.wigState){if("fixedStep"==this.wigState){if(1!=t.length)return;var r=parseFloat(t[0]),o={segment:this.chr,min:this.pos,max:this.pos+this.span-1,score:r};this.pos+=this.step,this.sink(o)}else if("variableStep"==this.wigState){if(2!=t.length)return;var a=parseInt(t[0]),r=parseFloat(t[1]),o={segment:this.chr,min:a,max:a+this.span-1,score:r};this.sink(o)}}else{if(t.length<4)return;var o={segment:t[0],min:parseInt(t[1])+1,max:parseInt(t[2]),score:parseFloat(t[3])};this.sink(o)}},o.prototype.flush=function(){},i.prototype.getStyleSheet=function(e){var t=new f;if("wig"==this.type){var n=new p;n.glyph="HISTOGRAM",n.BGCOLOR="blue",n.HEIGHT=30,t.pushStyle({type:"default"},null,n)}else{var n=new p;n.glyph="BOX",n.FGCOLOR="black",n.BGCOLOR="blue",n.HEIGHT=8,n.BUMP=!0,n.LABEL=!0,n.ZINDEX=20,t.pushStyle({type:"default"},null,n);var n=new p;n.glyph="BOX",n.FGCOLOR="black",n.BGCOLOR="red",n.HEIGHT=10,n.BUMP=!0,n.ZINDEX=20,t.pushStyle({type:"translation"},null,n);var i=new p;i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="white",i.HEIGHT=10,i.ZINDEX=10,i.BUMP=!0,i.LABEL=!0,t.pushStyle({type:"transcript"},null,i);var r=new p;r.glyph="HISTOGRAM",r.COLOR1="white",r.COLOR2="black",r.HEIGHT=30,t.pushStyle({type:"density"},null,r)}return e(t)},h("bed",function(e){return new i(e)}),h("wig",function(e){return new i(e)})},function(e,t,n){"use strict";function i(){this.info=[]}function r(e,t){this.parser=e,this.sink=t}var o=n(299),a=o.registerParserFactory,s=n(251),l=s.DASStylesheet,u=s.DASStyle,c=s.DASFeature,h=(s.DASGroup,/([^;=]+)(=([^;]+))?;?/),d=/##INFO=<([^>]+)>/,f=/([^,=]+)=([^,]+|"[^"]+"),?/;i.prototype.createSession=function(e){return new r(this,e)},r.prototype.parse=function(e){if(0!=e.length)if("#"!=e[0]){var t=e.split("	"),n=new c;n.segment=t[0],n.id=t[2],n.refAllele=t[3],n.altAlleles=t[4].split(","),n.min=parseInt(t[1]),n.max=n.min+n.refAllele.length-1;var i=t[7].split(h);n.info={};for(var r=0;r<i.length;r+=4)n.info[i[r+1]]=i[r+3];var o=n.altAlleles[0],a=n.refAllele;o.length>a.length?(n.type="insertion",0==o.indexOf(a)?(n.insertion=o.substr(a.length),n.min+=a.length,n.max=n.min-1):n.insertion=o):o.length<a.length?n.type="deletion":n.type="substitution",this.sink(n)}else if(e.length>1&&"#"==e[1]){var s=d.exec(e);if(s){for(var t=s[1].split(f),l=null,u=null,r=0;r<t.length-1;r+=3){var p=t[r+1],_=t[r+2].replace(/"/g,"");"ID"==p?l=_:"Description"==p&&(u=_)}l&&u&&this.parser.info.push({id:l,desc:u})}return}},r.prototype.flush=function(){},i.prototype.getStyleSheet=function(e){var t=new l,n=new u;n.glyph="__INSERTION",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="rgb(50,80,255)",n.BGCOLOR="#888888",n.STROKECOLOR="black",t.pushStyle({type:"insertion"},null,n);var n=new u;n.glyph="PLIMSOLL",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="rgb(255, 60, 60)",n.BGCOLOR="#888888",n.STROKECOLOR="black",t.pushStyle({type:"deletion"},null,n);var n=new u;return n.glyph="PLIMSOLL",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="rgb(50,80,255)",n.BGCOLOR="#888888",n.STROKECOLOR="black",t.pushStyle({type:"default"},null,n),e(t)},i.prototype.getDefaultFIPs=function(e){var t=this,n=function(e,n){if(n.add("Ref. allele",e.refAllele),n.add("Alt. alleles",e.altAlleles.join(",")),e.info)for(var i=0;i<t.info.length;++i){var r=t.info[i],o=e.info[r.id];void 0!==o&&n.add(r.desc,o)}};e(n)},a("vcf",function(){return new i})},function(e,t,n){"use strict";function i(){var e=this;this.reqs=[],this.awaitedFeatures={},this.requestsIssued=new E(function(t,n){e.notifyRequestsIssued=t})}function r(e,t,n,i,r,o,a){this.chr=e,this.min=t,this.max=n,this.coverage=a,this.scale=i,this.features=r||[],this.status=o}function o(e,t,n,i,r,o){this.tierMap=e,this.chr=t,this.min=n,this.max=i,this.scale=r,this.seqSource=o||new m,this.viewCount=0,this.featureCache={},this.latestViews={}}function a(e,t,n){for(var i=[],r={},o=0;o<e.length;++o){var a=e[o];a.min&&a.max?a.groups&&a.groups.length>0?u(r,a.groups[0].id,a):a.min<=n&&a.max>=t&&i.push(a):i.push(a)}for(var s in r){for(var l=r[s],c=1e11,h=-1e11,o=0;o<l.length;++o){var a=l[o];c=Math.min(c,a.min),h=Math.max(h,a.max)}if(n>=c||h>=t)for(var o=0;o<l.length;++o)i.push(l[o])}return i}var s=n(248),l=s.Awaited,u=s.pusho,c=n(299),h=c.MappedFeatureSource,d=c.CachingFeatureSource,f=c.BWGFeatureSource,p=c.RemoteBWGFeatureSource,_=c.BAMFeatureSource,g=c.RemoteBAMFeatureSource,m=c.DummySequenceSource,v=c.DummyFeatureSource,y=n(301).OverlayFeatureSource,b=n(269),x=b.Range,w=(b.union,b.intersection),S=n(309),A=S.downsample,k=S.getBaseCoverage,C=n(251),T=C.DASSequence,E=n(255).Promise;i.prototype.addRequest=function(e){this.reqs.push(e)},i.prototype.abortAll=function(){for(var e=0;e<this.reqs.length;++e)this.reqs[e].abort()},r.prototype.toString=function(){return this.chr+":"+this.min+".."+this.max+";scale="+this.scale},o.prototype.cancel=function(){this.cancelled=!0},o.prototype.bestCacheOverlapping=function(e,t,n){var i=this.featureCache[this.tierMap[0]];return i?i:null},o.prototype.retrieveFeatures=function(e,t,n,r,o,a){if(o!=o)throw"retrieveFeatures called with silly scale";if(t!=this.chr)throw"Can't extend Known Space to a new chromosome";1>n&&(n=1),this.min=n,this.max=r,this.scale=o,this.pool&&this.pool.abortAll(),this.pool=new i,this.awaitedSeq=new l,this.seqWasFetched=!1,this.viewCount++,this.startFetchesForTiers(e,a),this.pool.notifyRequestsIssued()},o.prototype.invalidate=function(e,t){this.pool&&(this.featureCache[e]=null,this.startFetchesForTiers([e],t))},o.prototype.startFetchesForTiers=function(e,t){for(var n,i=this,r=this.awaitedSeq,o=!1,a=0;a<e.length;++a)try{this.startFetchesFor(e[a],r,t)&&(o=!0)}catch(s){var l=e[a];l.currentFeatures=[],l.currentSequence=null,console.log("Error fetching tier source"),console.log(s),n=s,t(s,l)}if(o&&!this.seqWasFetched){this.seqWasFetched=!0;var u=this.min,c=this.max;if(this.cs&&this.cs.start<=u&&this.cs.end>=c){var h;return h=this.cs.start==u&&this.cs.end==c?this.cs:new T(this.cs.name,u,c,this.cs.alphabet,this.cs.seq.substring(u-this.cs.start,c+1-this.cs.start)),r.provide(h)}this.seqSource.fetch(this.chr,u,c,this.pool,function(e,t){t?((!i.cs||u<=i.cs.start&&c>=i.cs.end||u>=i.cs.end||c<=i.cs.start||c-u>i.cs.end-i.cs.start)&&(i.cs=t),r.provide(t)):(console.log("Sequence loading failed",e),r.provide(null))})}if(n)throw n},o.prototype.startFetchesFor=function(e,t,n){var i,o=this,s=this.viewCount,l=e.getSource()||new v,u=e.needsSequence(this.scale),c=o.featureCache[e],h=e.getActiveStyleFilters(this.scale);h&&(i=h.typeList());var d=this.chr,f=this.min,p=this.max;if(void 0===i)return!1;if(c&&c.chr===this.chr&&c.min<=f&&c.max>=p){var _=c.features;(c.min<f||c.max>p)&&(_=a(_,f,p)),o.provision(e,c.chr,w(c.coverage,new x(f,p)),c.scale,i,_,c.status,u?t:null,n);var g=l.getScales();if(c.scale<=this.scale||!g)return u}return l.instrument&&console.log("Starting  fetch "+s+" ("+f+", "+p+")"),l.fetch(d,f,p,this.scale,i,this.pool,function(a,h,_,g){l.instrument&&console.log("Finishing fetch "+s);var m=o.latestViews[e]||-1;o.cancelled||m>s||(g||(g=new x(f,p)),(!c||f<c.min||p>c.max)&&(o.featureCache[e]=new r(d,f,p,_,h,a,g)),o.latestViews[e]=s,o.provision(e,d,g,_,i,h,a,u?t:null,n))},h),u},o.prototype.provision=function(e,t,n,i,r,o,a,s,l){if(a&&e.setFeatures(t,n,i,[],null),!a){for(var u=!1,c=!1,m=e.getSource();h.prototype.isPrototypeOf(m)||d.prototype.isPrototypeOf(m)||y.prototype.isPrototypeOf(m);)m=y.prototype.isPrototypeOf(m)?m.sources[0]:m.source;(f.prototype.isPrototypeOf(m)||p.prototype.isPrototypeOf(m)||_.prototype.isPrototypeOf(m)||g.prototype.isPrototypeOf(m))&&(u=!0),m.opts&&(m.opts.forceReduction||m.opts.noDownsample)||u&&r&&1==r.length&&r.indexOf("density")>=0&&(o=A(o,this.scale)),r&&1==r.length&&r.indexOf("base-coverage")>=0&&(c=!0),s?s.await(function(r){c&&(o=k(o,r,e.browser.baseColors)),e.setFeatures(t,n,i,o,r)}):e.setFeatures(t,n,i,o)}l(a,e)},e.exports={KnownSpace:o}},function(e,t,n){"use strict";function i(e){return _[e%_.length]*Math.pow(10,e/_.length|0)}function r(e,t,n){this.scale=e,this.tot=0,this.cnt=0,this.hasScore=!1,this.min=t,this.max=n,this.features=[]}function o(e,t){return e.min<t.min?-1:e.min>t.min?1:e.max<t.max?-1:t.max>e.max?1:0}function a(e,t){for(var n=0;i(n+1)<t;)++n;for(var o=i(n),a=[],s=-1e10,l=1e10,u=0;u<e.length;++u){var c=e[u];if(c.groups&&c.groups.length>0)return e;var h=c.min/o|0,f=c.max/o|0;s=Math.max(s,f),l=Math.min(l,h);for(var p=h;f>=p;++p){var _=a[p];_||(_=new r(o,p*o,(p+1)*o-1),a[p]=_),_.feature(c)}}for(var g=[],p=l;s>=p;++p){var _=a[p];if(_){var c=new d;c.segment=e[0].segment,c.min=p*o+1,c.max=(p+1)*o,c.score=_.score(),c.type="density",g.push(c)}}Date.now();return g}function s(e){this._pos=e,this._bases={},this._totalCount=0}function l(e,t,n){for(var i=f(n),r=[],o=[],a=0,s=0;s<i.length;++s){var l=i[s];if("M"==l.op)r.push(e.substr(a,l.cnt)),o.push(t.substr(a,l.cnt)),a+=l.cnt;else if("D"==l.op)for(var u=0;u<l.cnt;++u)r.push("-"),o.push("Z");else"I"==l.op?a+=l.cnt:"S"==l.op?a+=l.cnt:console.log("unknown cigop"+l.op)}var c={seq:r.join(""),quals:o.join("")};return c}function u(e,t,n){var i=[];if(e){var r=0|e.start,o=0|e.end;if(n>=r&&o>=t){for(var a=Math.max(t,r),s=Math.min(n,o),l=0;a-t>l;l++)i.push("N");i.push(e.seq.substr(a-r,s-a+1));for(var l=0;n-s>l;l++)i.push("N")}}return i.join("")}function c(e,t,n){for(var i=null,r=null,o=[],a=0;a<e.length;++a){var c=e[a];if(c.groups&&c.groups.length>0)return e;for(var h=l(c.seq,c.quals,c.cigar),f=h.seq,_=h.quals,g=c.orientation,m=c.min||0,v=c.max||0,y=0,b=m;v>=b;++b){var x=o[b];x||(x=new s(b),o[b]=x);var w=f.charAt(y),S=_.charCodeAt(y)-33;x.recordBase(w,S,g),y++}i=i?Math.min(i,m):m,r=r?Math.max(r,v):v}for(var A=u(t,i,r),k=[],y=0,b=i;r>=b;++b){var x=o[b];if(x){var c=new d;if(c.segment=e[0].segment,c.min=x.pos(),c.max=c.min,c.notes=[],c.notes=c.notes.concat(x.infoList()),c.type="base-coverage",c.suppressScore=!0,A){var C=A.charAt(y),T="Ref="+C;c.notes.unshift(T);for(var E=x.baseScoreList(C,.2),M=0;M<E.length;M++){var w=E[M].base,L=E[M].score,R=p(c);R.score=L,(E.length>1||w!=C)&&(R.itemRgb=n[w]),k.push(R)}}else k.push(c)}y++}return k}var h=n(251),d=h.DASFeature,f=n(271).parseCigar,p=n(248).shallowCopy,_=[1,2,5];r.prototype.score=function(){if(0==this.cnt)return 0;if(this.hasScore)return this.tot/this.cnt;var e=this.features;e.sort(o);for(var t=-1e10,n=0,i=0,r=1;r<e.length;++r){var a=e[r],s=Math.max(a.min,this.min),l=Math.min(a.max,this.max);i+=l-s+1,s>t?(n+=l-s+1,t=l):l>t&&(n+=l-t,t=l)}return n>0?1*i/n:0},r.prototype.feature=function(e){void 0!==e.score&&(this.tot+=e.score,this.hasScore=!0),++this.cnt,this.features.push(e)},s.prototype.recordBase=function(e,t,n){if(this._bases[e]){var i=this._bases[e];i.cnt++,i.totalQual+=t,i.strandCnt[n]++}else{var r={"+":0,"-":0};r[n]++,this._bases[e]={cnt:1,totalQual:t,strandCnt:r}}this._totalCount++},s.prototype.totalCount=function(){return this._totalCount},s.prototype.pos=function(){return this._pos},s.prototype.infoList=function(){var e=[],t=this._totalCount,n="Depth="+t.toString();e.push(n);for(var i in this._bases){var r=this._bases[i],o=r.cnt,a=100*o/t,s=r.strandCnt["+"],l=r.strandCnt["-"],u=r.totalQual/o,c=[i,"=",o," (",a.toFixed(0),"%, ",s," +, ",l," -, Qual: ",u.toFixed(0),")"];e.push(c.join(""))}return e},s.prototype.baseScoreList=function(e,t){var n=[],i=this._totalCount,r=t*i;for(var o in this._bases){var a=this._bases[o].cnt;if(!(r>a||o==e)){var s={base:o,score:i};n.push(s),i-=a}}return n.push({base:e,score:i}),n},e.exports={downsample:a,getBaseCoverage:c}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.update=t.getReducer=t.changeReducer=t.actionCreators=t.init=t.CHANGE=void 0;var o=n(231),a=i(o),s=n(232),l=t.CHANGE="@CHANGE",u=(t.init=function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{index:e,currentIndex:t,lastCurrentIndex:null}},t.actionCreators=r({},l,function(e){return r({type:l,payload:e},s.GLOBAL_ACTION,!0)}),t.changeReducer=function(e,t){return Object.assign({},e,{
lastCurrentIndex:e.currentIndex,currentIndex:t.payload})});t.getReducer=function(e){return(0,s.createReducer)(r({},l,u))},t.update=function(e,t,n){var i=a["default"].select(n),r=2e3;e.currentIndex===e.lastCurrentIndex?i.style("display",e.index===e.currentIndex?"block":"none").style("transform",null).style("opacity",null):e.index===e.lastCurrentIndex?i.style("transform","scale(1)").style("opacity","1").transition().duration(r).ease("cubic-in-out").style("transform",e.currentIndex>e.lastCurrentIndex?"scale(10)":"scale(0.1)").style("opacity","0").each("end",function(){i.style("display","none").style("transform",null).style("opacity",null)}):e.index===e.currentIndex?null===e.lastCurrentIndex?i.style("display","block").style("transform",null).style("opacity",null):i.style("display","block").style("transform",e.currentIndex<e.lastCurrentIndex?"scale(10)":"scale(0.1)").style("opacity","0").transition().duration(r).ease("cubic-in-out").style("transform","scale(1)").style("opacity","1").each("end",function(){i.style("display","block").style("transform",null).style("opacity",null)}):i.style("display","none").style("transform",null).style("opacity",null)}},function(e,t,n){var i=n(312);"string"==typeof i&&(i=[[e.id,i,""]]);n(314)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(313)(),t.push([e.id,".btn,body{font-family:Helvetica Neue,Helvetica,Arial,sans-serif!important}body{font-size:14px}.escher-container{background-color:#f3f3f3;text-align:center;position:relative}body.fill-screen,html.fill-screen{height:100%;width:100%}body.fill-screen{overflow:hidden}.fill-screen-div{margin:0;padding:0;position:fixed;top:0;bottom:0;left:0;right:0}.escher-3d-transform-container,.escher-zoom-container,.full-screen-on,svg.escher-svg{height:100%!important;width:100%!important;overflow:hidden}.escher-container #status{position:absolute;bottom:10px;left:20px;color:red;background-color:#fff;font-size:16px}.escher-container #menu{display:block;margin:5px auto 0;border:1px solid #ddd;background-color:hsla(0,0%,100%,.95);border-radius:0}.escher-container .help-button{float:right;padding:0 5px;font-size:12px;background-color:#f5f5f5}.escher-container .dropdown-menu{border:1px solid #ddd;background-color:hsla(0,0%,100%,.95);border-radius:0;margin:0;text-align:left}.escher-container .dropdown-menu>li>a{font-size:15px}.escher-container .dropdown-menu>.escher-disabled>a{color:#e0e0e0;pointer-events:none}.escher-container .dropdown{background-color:hsla(0,0%,100%,.95)}@media (max-width:550px){.escher-container .dropdown-button{padding:5px 9px}}@media (min-width:550px){.escher-container .dropdown-button{font-size:18px}.escher-container .help-button{font-size:16px}}.escher-container .search-menu-container{position:absolute;width:100%;top:0;left:0;margin:0;text-align:center;pointer-events:none}.escher-container .search-menu-container-inline{width:320px;display:inline-block;text-align:left;pointer-events:auto}@media (min-width:550px){.escher-container .search-menu-container-inline{width:410px}}.escher-container .search-container{display:block;background:hsla(0,0%,100%,.95);padding:3px;border:1px solid #ddd;margin:2px 0 0}.escher-container .search-bar{display:inline-block;border:1px solid #ddd;margin-right:4px;width:114px;height:29px;border-radius:3px}.escher-container .search-counter{display:inline-block;padding:0 8px}.escher-container .settings-box-background{display:block;position:absolute;top:0;left:0;width:100%;height:100%;z-index:9;background:rgba(0,0,0,.4);padding:5% 0;text-align:center}.escher-container .settings-box-container{display:inline-block;position:relative;width:90%;max-width:520px;height:100%;z-index:10}.escher-container .settings-button{position:absolute;top:5px;right:20px;z-index:10}.escher-container .settings-button-close{right:60px}.escher-container .settings-box{display:inline-block;max-height:100%;width:100%;overflow-y:scroll;overflow-x:hidden;background:hsla(0,0%,100%,.95);padding:8px;margin:0;border:1px solid #ddd;text-align:left}.escher-container .settings-section-heading-large{font-size:17px;font-weight:700;margin-top:15px}.escher-container .settings-section-heading{font-weight:700;margin-top:15px}.escher-container .settings-table{width:100%}.escher-container .settings-table td{padding:3px 5px}.escher-container td.options-label{width:88px}.escher-container td.options-label-wide{width:192px}.escher-container .settings-number{text-align:center;color:#aaa;font-style:italic}.escher-container .input-cell{width:23%;font-size:13px}.escher-container .scale-bar-input{width:100%;text-align:left}.escher-container .no-data-input{width:23%;margin:0 4px}.escher-container label.option-group{margin:0 10px 0 0}.escher-container label.option-group span{margin:0 0 0 4px}.escher-container label.full-line{width:100%}.escher-container label{font-weight:inherit}.escher-container .settings-tip{font-style:italic}.escher-container .scale-editor{position:relative;width:100%;height:190px;font-size:12px}.escher-container .scale-editor .centered{position:absolute;width:440px;left:35px;top:0}.escher-container .scale-editor .data-not-loaded{position:absolute;z-index:5;left:60px;top:25px;text-align:center;width:400px;font-size:15px;color:#b19ec0}.escher-container .scale-editor .add{position:absolute;top:0;right:0;width:20px;cursor:pointer}.escher-container .scale-editor .trash-container{position:absolute;top:0;left:0;width:420px;height:20px}.escher-container .scale-editor .trash{position:absolute;top:0;left:0;cursor:pointer}.escher-container .scale-editor .scale-svg{position:absolute;width:440px;height:80px;top:20px;left:0}.escher-container .scale-editor .input-container{position:absolute;top:56px;left:0;width:420px}.escher-container .scale-editor .input-container input{position:absolute;left:0;top:0}.escher-container .scale-editor input[disabled]{background-color:#f1ecfa}.escher-container .scale-editor .row-label{position:absolute;left:0}.escher-container .scale-editor .input-set{position:absolute;top:0;box-shadow:0 2px 14px #c5c5c5}.escher-container .scale-editor .input-set.selected-set{z-index:5}.escher-container .scale-editor .domain-type-picker{position:absolute;top:0;right:0;height:14px;background-color:#e8e8e8}.escher-container .scale-editor .picker rect{color:#000;opacity:.4}.escher-container .scale-editor .no-data{position:absolute;left:0;width:100%}.escher-container .scale-editor .no-data-heading{font-weight:700}.escher-container .scale-editor .no-data .input-group{position:absolute;top:0;left:0}.escher-container .scale-editor .no-data .input-group input,.escher-container .scale-editor .no-data .input-group span{position:absolute;top:17px}.escher-container .close-button{margin-left:4px;float:right}.escher-container ul#button-panel{position:absolute;left:4px;top:20%;margin-top:-30px;pointer-events:none;padding-left:0}.escher-container ul#button-panel li{pointer-events:auto;list-style:none}.escher-container .input-close-button{position:absolute;right:0;width:18px;bottom:0;padding:0;border-width:0;margin:0;background:none;font-size:16px;font-weight:400}.escher-container .simple-button{width:40px;height:40px;border:1px solid #2e2f2f;background-image:linear-gradient(#4f5151,#474949 6%,#3f4141);color:#fff;background-color:#474949;border-color:#474949;padding:6px 0 9px;font-size:17px;line-height:1.42857143;border-radius:4px;text-align:center;vertical-align:middle;cursor:pointer;margin:3px 0 0}.escher-container #rxn-input{z-index:10}.escher-container .input-close-button:hover{color:#f33;font-weight:700}.escher-container .light{color:#8b8b8be;font-weight:400}.escher-container #text-edit-input input{width:500px;border:1px solid #ccc;font-size:22px}.escher-container #quick-jump-menu{position:absolute;right:10px;bottom:10px;width:300px}@media (max-width:550px){.escher-container #quick-jump-menu{display:none}}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function i(e,t){for(var n=0;n<e.length;n++){var i=e[n],r=f[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(u(i.parts[o],t))}else{for(var a=[],o=0;o<i.parts.length;o++)a.push(u(i.parts[o],t));f[i.id]={id:i.id,refs:1,parts:a}}}}function r(e){for(var t=[],n={},i=0;i<e.length;i++){var r=e[i],o=r[0],a=r[1],s=r[2],l=r[3],u={css:a,media:s,sourceMap:l};n[o]?n[o].parts.push(u):t.push(n[o]={id:o,parts:[u]})}return t}function o(e,t){var n=g(),i=y[y.length-1];if("top"===e.insertAt)i?i.nextSibling?n.insertBefore(t,i.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),y.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=y.indexOf(e);t>=0&&y.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",o(e,t),t}function l(e){var t=document.createElement("link");return t.rel="stylesheet",o(e,t),t}function u(e,t){var n,i,r;if(t.singleton){var o=v++;n=m||(m=s(t)),i=c.bind(null,n,o,!1),r=c.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(t),i=d.bind(null,n),r=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(t),i=h.bind(null,n),r=function(){a(n)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}function c(e,t,n,i){var r=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=b(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function h(e,t){var n=t.css,i=t.media;t.sourceMap;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function d(e,t){var n=t.css,i=(t.media,t.sourceMap);i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var r=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}var f={},p=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},_=p(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),g=p(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,v=0,y=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=_()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=r(e);return i(n,t),function(e){for(var o=[],a=0;a<n.length;a++){var s=n[a],l=f[s.id];l.refs--,o.push(l)}if(e){var u=r(e);i(u,t)}for(var a=0;a<o.length;a++){var l=o[a];if(0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete f[l.id]}}}};var b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t){e.exports=[{map_name:"e_coli_core.Core metabolism",map_id:"0df3827fde8464e80f455a773a52c274",map_description:"E. coli core metabolic network\nLast Modified Fri Dec 05 2014 16:39:44 GMT-0800 (PST)",homepage:"https://escher.github.io",schema:"https://escher.github.io/escher/jsonschema/1-0-0#"},{reactions:{1576693:{name:"Phosphoglycerate kinase",bigg_id:"PGK",segments:{291:{to_node_id:"1576836",from_node_id:"1576835",b2:null,b1:null},292:{to_node_id:"1576834",from_node_id:"1576836",b2:null,b1:null},293:{to_node_id:"1576835",from_node_id:"1576485",b2:{y:2789.230249470758,x:1055},b1:{y:2822.4341649025255,x:1055}},294:{to_node_id:"1576835",from_node_id:"1576486",b2:{y:2790,x:1055},b1:{y:2825,x:1055}},295:{to_node_id:"1576487",from_node_id:"1576834",b2:{y:2615,x:1055},b1:{y:2650,x:1055}},296:{to_node_id:"1576488",from_node_id:"1576834",b2:{y:2617.5658350974745,x:1055},b1:{y:2650.769750529242,x:1055}}},genes:[{bigg_id:"b2926",name:"pgk"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"3pg_c"},{coefficient:1,bigg_id:"13dpg_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:1,bigg_id:"adp_c"}],label_x:1065,label_y:2715,gene_reaction_rule:"b2926"},1576694:{name:"Phosphogluconate dehydrogenase",bigg_id:"GND",segments:{297:{to_node_id:"1576837",from_node_id:"1576838",b2:null,b1:null},298:{to_node_id:"1576839",from_node_id:"1576837",b2:null,b1:null},299:{to_node_id:"1576838",from_node_id:"1576489",b2:{y:1265,x:1921.339540236634},b1:{y:1265,x:1884.7984674554473}},300:{to_node_id:"1576838",from_node_id:"1576490",b2:{y:1265,x:1920.5},b1:{y:1265,x:1882}},301:{to_node_id:"1576491",from_node_id:"1576839",b2:{y:1265,x:2029.2015325445527},b1:{y:1265,x:1992.660459763366}},302:{to_node_id:"1576492",from_node_id:"1576839",b2:{y:1265,x:2041.0312423743285},b1:{y:1265,x:1996.2093727122985}},303:{to_node_id:"1576493",from_node_id:"1576839",b2:{y:1265,x:2066},b1:{y:1265,x:2003.7}}},genes:[{bigg_id:"b2029",name:"gnd"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"ru5p__D_c"},{coefficient:1,bigg_id:"nadph_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"6pgc_c"}],label_x:1930.5045166015625,label_y:1313.710205078125,gene_reaction_rule:"b2029"},1576695:{name:"O2 transport  diffusion ",bigg_id:"O2t",segments:{304:{to_node_id:"1576840",from_node_id:"1576494",b2:{y:1660,x:4755},b1:{y:1660,x:4821.5}},305:{to_node_id:"1576495",from_node_id:"1576840",b2:{y:1660,x:4495},b1:{y:1660,x:4610.5}}},genes:[{bigg_id:"s0001",name:"None"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"o2_c"},{coefficient:-1,bigg_id:"o2_e"}],label_x:4557.1943359375,label_y:1635.4964599609375,gene_reaction_rule:"s0001"},1576696:{name:"NAD P  transhydrogenase",bigg_id:"THD2",segments:{306:{to_node_id:"1576841",from_node_id:"1576842",b2:null,b1:null},307:{to_node_id:"1576843",from_node_id:"1576841",b2:null,b1:null},308:{to_node_id:"1576842",from_node_id:"1576496",b2:{y:724.5066228070302,x:3510},b1:{y:580.5856339661426,x:3331.1220703125}},309:{to_node_id:"1576842",from_node_id:"1576497",b2:{y:750.137689584216,x:3510},b1:{y:654.7419446101471,x:3418.143798828125}},310:{to_node_id:"1576842",from_node_id:"1576498",b2:{y:777.5,x:3510},b1:{y:725,x:3510}},311:{to_node_id:"1576499",from_node_id:"1576843",b2:{y:995.287841796875,x:3510},b1:{y:921.2841796875,x:3510}},312:{to_node_id:"1576500",from_node_id:"1576843",b2:{y:1078.144282674624,x:3740.4462890625},b1:{y:1061.6865465211372,x:3508.388671875}},313:{to_node_id:"1576501",from_node_id:"1576843",b2:{y:1081.817596989458,x:3624.41748046875},b1:{y:1038.7769502394156,x:3506.777099609375}}},genes:[{bigg_id:"b1602",name:"pntB"},{bigg_id:"b1603",name:"pntA"}],reversibility:!1,metabolites:[{coefficient:-2,bigg_id:"h_e"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"nadh_c"},{coefficient:1,bigg_id:"nadph_c"},{coefficient:2,bigg_id:"h_c"},{coefficient:1,bigg_id:"nad_c"}],label_x:3532.891845703125,label_y:872.8489990234375,gene_reaction_rule:"b1602 and b1603"},1576697:{name:"Fumarase",bigg_id:"FUM",segments:{314:{to_node_id:"1576845",from_node_id:"1576844",b2:null,b1:null},315:{to_node_id:"1576504",from_node_id:"1576845",b2:{y:3134,x:2652.5},b1:{y:3093.4,x:2674.55}},316:{to_node_id:"1576844",from_node_id:"1576502",b2:{y:3010.0650991921693,x:2736.5037173099395},b1:{y:2982.216997307231,x:2758.679057699798}},317:{to_node_id:"1576844",from_node_id:"1576503",b2:{y:3003.8745504813855,x:2741.433228320378},b1:{y:2961.5818349379524,x:2775.110761067927}}},genes:[{bigg_id:"b4122",name:"fumB"},{bigg_id:"b1611",name:"fumC"},{bigg_id:"b1612",name:"fumA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"fum_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"mal__L_c"}],label_x:2759.057373046875,label_y:3066,gene_reaction_rule:"b1612 or b4122 or b1611"},1576698:{name:"Isocitrate dehydrogenase (NADP)",bigg_id:"ICDHyr",segments:{318:{to_node_id:"1576846",from_node_id:"1576847",b2:null,b1:null},319:{to_node_id:"1576848",from_node_id:"1576846",b2:null,b1:null},320:{to_node_id:"1576847",from_node_id:"1576505",b2:{y:3933.673891941737,x:3498.9695345126847},b1:{y:3958.5796398057905,x:3468.565115042282}},321:{to_node_id:"1576847",from_node_id:"1576506",b2:{y:3936.593890513596,x:3495.4048609314546},b1:{y:3968.312968378653,x:3456.6828697715146}},322:{to_node_id:"1576507",from_node_id:"1576848",b2:{y:3735.4876397766343,x:3702.9108389651055},b1:{y:3767.3462919329904,x:3674.9732516895315}},323:{to_node_id:"1576508",from_node_id:"1576848",b2:{y:3749.7955576929353,x:3690.36389556158},b1:{y:3771.6386673078805,x:3671.209168668474}},324:{to_node_id:"1576509",from_node_id:"1576848",b2:{y:3715.2337610392046,x:3720.671932627159},b1:{y:3761.2701283117613,x:3680.3015797881476}}},genes:[{bigg_id:"b1136",name:"icd"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"nadph_c"},{coefficient:1,bigg_id:"akg_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"icit_c"}],label_x:3616,label_y:3836,gene_reaction_rule:"b1136"},1576699:{name:"Pyruvate dehydrogenase",bigg_id:"PDH",segments:{325:{to_node_id:"1576850",from_node_id:"1576849",b2:null,b1:null},326:{to_node_id:"1576851",from_node_id:"1576850",b2:null,b1:null},327:{to_node_id:"1576849",from_node_id:"1576510",b2:{y:3945,x:1413.3472975166192},b1:{y:3945,x:1374.4909917220637}},328:{to_node_id:"1576849",from_node_id:"1576511",b2:{y:3945,x:1373.75},b1:{y:3945,x:1242.5}},329:{to_node_id:"1576849",from_node_id:"1576512",b2:{y:3945,x:1411.736306507171},b1:{y:3945,x:1369.1210216905704}},330:{to_node_id:"1576513",from_node_id:"1576851",b2:{y:3945,x:1606.478150704935},b1:{y:3945,x:1570.4434452114806}},331:{to_node_id:"1576514",from_node_id:"1576851",b2:{y:3945,x:1635},b1:{y:3945,x:1579}},332:{to_node_id:"1576515",from_node_id:"1576851",b2:{y:3945,x:1613.309518948453},b1:{y:3945,x:1572.492855684536}}},genes:[{bigg_id:"b0114",name:"aceE"},{bigg_id:"b0115",name:"aceF"},{bigg_id:"b0116",name:"lpd"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"nadh_c"},{coefficient:-1,bigg_id:"coa_c"},{coefficient:-1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"accoa_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"co2_c"}],label_x:1417.72802734375,label_y:3920.71923828125,gene_reaction_rule:"b0114 and b0115 and b0116"},1576700:{name:"Phosphoenolpyruvate carboxylase",bigg_id:"PPC",segments:{333:{to_node_id:"1576852",from_node_id:"1576854",b2:null,b1:null},334:{to_node_id:"1576853",from_node_id:"1576852",b2:null,b1:null},335:{to_node_id:"1576854",from_node_id:"1576516",b2:{y:3452.2308899862983,x:1334.4013835391315},b1:{y:3438.769633287661,x:1302.6712784637714}},336:{to_node_id:"1576854",from_node_id:"1576517",b2:{y:3440.1599283734054,x:1305.9484025944557},b1:{y:3398.5330945780183,x:1207.828008648186}},337:{to_node_id:"1576854",from_node_id:"1576518",b2:{y:3447.322871456709,x:1322.8324827193853},b1:{y:3422.409571522363,x:1264.1082757312843}},338:{to_node_id:"1576519",from_node_id:"1576853",b2:{y:3543.994528732819,x:1552.8353869664456},b1:{y:3526.498358619846,x:1510.9506160899336}},339:{to_node_id:"1576520",from_node_id:"1576853",b2:{y:3552.157197214914,x:1572.3763206054002},b1:{y:3528.947159164474,x:1516.81289618162}},340:{to_node_id:"1576521",from_node_id:"1576853",b2:{y:3691.624192938869,x:2580.289220436279},b1:{y:3708.0419942097856,x:1966.279649431665}}},genes:[{bigg_id:"b3956",name:"ppc"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"oaa_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"pep_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:-1,bigg_id:"co2_c"}],label_x:1490.0008544921875,label_y:3479.666748046875,gene_reaction_rule:"b3956"},1576701:{name:"Enolase",bigg_id:"ENO",segments:{341:{to_node_id:"1576856",from_node_id:"1576522",b2:{y:3175,x:1055},b1:{y:3173.322021484375,x:1055}},342:{to_node_id:"1576855",from_node_id:"1576856",b2:null,b1:null},343:{to_node_id:"1576517",from_node_id:"1576855",b2:{y:3320,x:1055},b1:{y:3281.5,x:1055}},344:{to_node_id:"1576523",from_node_id:"1576855",b2:{y:3319.0832691319597,x:1055},b1:{y:3281.224980739588,x:1055}}},genes:[{bigg_id:"b2779",name:"eno"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"pep_c"},{coefficient:1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"2pg_c"}],label_x:1065,label_y:3215,gene_reaction_rule:"b2779"},1576702:{name:"Glucose-6-phosphate isomerase",bigg_id:"PGI",segments:{345:{to_node_id:"1576857",from_node_id:"1576524",b2:{y:1330,x:1055},b1:{y:1284.5,x:1055}},346:{to_node_id:"1576525",from_node_id:"1576857",b2:{y:1470,x:1055},b1:{y:1417.5,x:1055}}},genes:[{bigg_id:"b4025",name:"pgi"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"g6p_c"},{coefficient:1,bigg_id:"f6p_c"}],label_x:1065,label_y:1385,gene_reaction_rule:"b4025"},1576703:{name:"Ammonia reversible transport",bigg_id:"NH4t",segments:{347:{to_node_id:"1576858",from_node_id:"1576526",b2:{y:4677.5,x:3989},b1:{y:4733.15,x:3989}},348:{to_node_id:"1576527",from_node_id:"1576858",b2:{y:4519.5,x:3989},b1:{y:4574.45,x:3989}}},genes:[{bigg_id:"b0451",name:"amtB"},{bigg_id:"s0001",name:"None"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"nh4_e"},{coefficient:1,bigg_id:"nh4_c"}],label_x:3999,label_y:4588,gene_reaction_rule:"s0001 or b0451"},1576704:{name:"Fructose-bisphosphatase",bigg_id:"FBP",segments:{349:{to_node_id:"1576859",from_node_id:"1576861",b2:null,b1:null},350:{to_node_id:"1576860",from_node_id:"1576859",b2:null,b1:null},351:{to_node_id:"1576861",from_node_id:"1576528",b2:{y:1782.1026313764871,x:835},b1:{y:1822.0087712549569,x:835}},352:{to_node_id:"1576861",from_node_id:"1576529",b2:{y:1805.8044115262064,x:835},b1:{y:1901.0147050873545,x:835}},353:{to_node_id:"1576525",from_node_id:"1576860",b2:{y:1539.7003591385833,x:835},b1:{y:1627.410107741575,x:835}},354:{to_node_id:"1576530",from_node_id:"1576860",b2:{y:1600.9687576256715,x:835},b1:{y:1645.7906272877015,x:835}}},genes:[{bigg_id:"b4232",name:"fbp"},{bigg_id:"b3925",name:"glpX"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"fdp_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"f6p_c"}],label_x:751.3809814453125,label_y:1733.561767578125,gene_reaction_rule:"b3925 or b4232"},1576705:{name:"Succinate exchange",bigg_id:"EX_succ_e",segments:{355:{to_node_id:"1576863",from_node_id:"1576531",b2:{y:2880,x:4978.5},b1:{y:2880,x:4945.95}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"succ_e"}],label_x:4968.927734375,label_y:2845.8271484375,gene_reaction_rule:""},1576706:{name:"Isocitrate lyase",bigg_id:"ICL",segments:{357:{to_node_id:"1576865",from_node_id:"1576505",b2:{y:3916.5,x:3415},b1:{y:3958.15,x:3413.6}},358:{to_node_id:"1576864",from_node_id:"1576865",b2:null,b1:null},359:{to_node_id:"1576532",from_node_id:"1576864",b2:{y:3612.2266277927156,x:3417},b1:{y:3719.8679883378145,x:3417}},360:{to_node_id:"1576533",from_node_id:"1576864",b2:{y:3316.4974972260998,x:3417},b1:{y:3631.14924916783,x:3417}}},genes:[{bigg_id:"b4015",name:"aceA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"succ_c"},{coefficient:1,bigg_id:"glx_c"},{coefficient:-1,bigg_id:"icit_c"}],label_x:3427,label_y:3847,gene_reaction_rule:"b4015"},1576707:{name:"Adenylate kinase",bigg_id:"ADK1",segments:{361:{to_node_id:"1576866",from_node_id:"1576867",b2:null,b1:null},362:{to_node_id:"1576536",from_node_id:"1576866",b2:{y:1441.4029541015625,x:4146.15869140625},b1:{y:1352.2913818359375,x:4145.83056640625}},363:{to_node_id:"1576867",from_node_id:"1576534",b2:{y:1173.8036262051405,x:4145},b1:{y:1112.6787540171351,x:4145}},364:{to_node_id:"1576867",from_node_id:"1576535",b2:{y:1177.1034937162894,x:4145},b1:{y:1123.6783123876312,x:4145}}},genes:[{bigg_id:"b0474",name:"adk"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"amp_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:2,bigg_id:"adp_c"}],label_x:3997.07177734375,label_y:1251.6114501953125,gene_reaction_rule:"b0474"},1576708:{name:"L-Glutamine exchange",bigg_id:"EX_gln__L_e",segments:{365:{to_node_id:"1576868",from_node_id:"1576537",b2:{y:4158,x:4951},b1:{y:4158,x:4902.7}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"gln__L_e"}],label_x:4933.3095703125,label_y:4131.884765625,gene_reaction_rule:""},1576710:{name:"CO2 exchange",bigg_id:"EX_co2_e",segments:{367:{to_node_id:"1576871",from_node_id:"1576544",b2:{y:4834,x:3621},b1:{y:4778,x:3621}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"co2_e"}],label_x:3631,label_y:4904,gene_reaction_rule:""},1576711:{name:"Transaldolase",bigg_id:"TALA",segments:{369:{to_node_id:"1576872",from_node_id:"1576873",b2:null,b1:null},370:{to_node_id:"1576874",from_node_id:"1576872",b2:null,b1:null},371:{to_node_id:"1576873",from_node_id:"1576545",b2:{y:1856.1727017464573,x:2173.815906732547},b1:{y:1892.1518443631908,x:2283.184776999114}},372:{to_node_id:"1576873",from_node_id:"1576546",b2:{y:1856.1728238167698,x:2175.402576654422},b1:{y:1890.5651744413158,x:2064.2112662569266}},373:{to_node_id:"1576547",from_node_id:"1576874",b2:{y:2171.7496092324754,x:2178},b1:{y:2076.976957965055,x:2178}},374:{to_node_id:"1576548",from_node_id:"1576874",b2:{y:2170.2455578331073,x:2178.000244140625},b1:{y:2077.4778177405574,x:2178}}},genes:[{bigg_id:"b2464",name:"talA"},{bigg_id:"b0008",name:"talB"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"s7p_c"},{coefficient:-1,bigg_id:"g3p_c"},{coefficient:1,bigg_id:"f6p_c"},{coefficient:1,bigg_id:"e4p_c"}],label_x:2197.5205078125,label_y:2008.8013916015625,gene_reaction_rule:"b2464 or b0008"},1576712:{name:"Pyruvate kinase",bigg_id:"PYK",segments:{375:{to_node_id:"1576876",from_node_id:"1576875",b2:null,b1:null},376:{to_node_id:"1576877",from_node_id:"1576876",b2:null,b1:null},377:{to_node_id:"1576875",from_node_id:"1576549",b2:{y:3640.769750529242,x:1055},b1:{y:3607.5658350974745,x:1055}},378:{to_node_id:"1576875",from_node_id:"1576550",b2:{y:3634.8195639293895,x:1055},b1:{y:3587.7318797646312,x:1055}},379:{to_node_id:"1576875",from_node_id:"1576517",b2:{y:3613,x:1055},b1:{y:3515,x:1055}},380:{to_node_id:"1576511",from_node_id:"1576877",b2:{y:3845,x:1055},b1:{y:3775,x:1055}},381:{to_node_id:"1576551",from_node_id:"1576877",b2:{y:3802.008771254957,x:1055},b1:{y:3762.102631376487,x:1055}}},genes:[{bigg_id:"b1854",name:"pykA"},{bigg_id:"b1676",name:"pykF"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pep_c"},{coefficient:-1,bigg_id:"adp_c"},{coefficient:1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"h_c"}],label_x:1065,label_y:3695,gene_reaction_rule:"b1854 or b1676"},1576713:{name:"L glutamate transport via proton symport  reversible",bigg_id:"GLUt2r",segments:{382:{to_node_id:"1576878",from_node_id:"1576880",b2:null,b1:null},383:{to_node_id:"1576879",from_node_id:"1576878",b2:null,b1:null},384:{to_node_id:"1576880",from_node_id:"1576552",b2:{y:3635,x:4794.600721137178},b1:{y:3635,x:4831.002403790594}},385:{to_node_id:"1576880",from_node_id:"1576553",b2:{y:3635,x:4791.314625451064},b1:{y:3635,x:4820.0487515035475}},386:{to_node_id:"1576554",from_node_id:"1576879",b2:{y:3635,x:4394.492321020364},b1:{y:3635,x:4497.047696306109}},387:{to_node_id:"1576555",from_node_id:"1576879",b2:{y:3635,x:4499.835695074495},b1:{y:3635,x:4528.650708522348}}},genes:[{bigg_id:"b4077",name:"gltP"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"glu__L_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"glu__L_e"},{coefficient:-1,bigg_id:"h_e"}],label_x:4655,label_y:3625,gene_reaction_rule:"b4077"},1576714:{name:"D-lactate exchange",bigg_id:"EX_lac__D_e",segments:{388:{to_node_id:"1576881",from_node_id:"1576556",b2:{y:4880,x:1055},b1:{y:4861.19384765625,x:1055}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"lac__D_e"}],label_x:1065,label_y:4915,gene_reaction_rule:""},1576715:{name:"Pyruvate exchange",bigg_id:"EX_pyr_e",segments:{390:{to_node_id:"1576884",from_node_id:"1576557",b2:{y:3945,x:215},b1:{y:3945,x:257}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pyr_e"}],label_x:96.76921081542969,label_y:3904.851318359375,gene_reaction_rule:""},1576716:{name:"Ribulose 5-phosphate 3-epimerase",bigg_id:"RPE",segments:{392:{to_node_id:"1576885",from_node_id:"1576493",b2:{y:1340,x:2100},b1:{y:1287.5,x:2138.5}},393:{to_node_id:"1576558",from_node_id:"1576885",b2:{y:1485,x:1995},b1:{y:1436,x:2030}}},genes:[{bigg_id:"b4301",name:"sgcE"},{bigg_id:"b3386",name:"rpe"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"xu5p__D_c"},{coefficient:-1,bigg_id:"ru5p__D_c"}],label_x:1937.57958984375,label_y:1422.4544677734375,gene_reaction_rule:"b3386 or b4301"},1576717:{name:"H+ exchange",bigg_id:"EX_h_e",segments:{394:{to_node_id:"1576887",from_node_id:"1576559",b2:{y:2229.5,x:4918},b1:{y:2229.15,x:4870.4}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"}],label_x:4920.2587890625,label_y:2195.827392578125,gene_reaction_rule:""},1576720:{name:"Succinyl-CoA synthetase (ADP-forming)",bigg_id:"SUCOAS",segments:{396:{to_node_id:"1576888",from_node_id:"1576889",b2:null,b1:null},397:{to_node_id:"1576890",from_node_id:"1576888",b2:null,b1:null},398:{to_node_id:"1576889",from_node_id:"1576567",b2:{y:2962.1615434463,x:3574.4760538225205},b1:{y:2929.871811487667,x:3542.920179408402}},399:{to_node_id:"1576889",from_node_id:"1576568",b2:{y:2964.923830429043,x:3577.1755615556553},b1:{y:2939.079434763476,x:3551.9185385188516}},400:{to_node_id:"1576889",from_node_id:"1576533",b2:{y:2954.5162418879845,x:3567.004509117803},b1:{y:2904.387472959949,x:3518.015030392677}},401:{to_node_id:"1576569",from_node_id:"1576890",b2:{y:3112.853617863234,x:3706.5785261677484},b1:{y:3077.95608535897,x:3678.1735578503244}},402:{to_node_id:"1576570",from_node_id:"1576890",b2:{y:3120.815793594307,x:3713.059366879087},b1:{y:3080.344738078292,x:3680.117810063726}},403:{to_node_id:"1576571",from_node_id:"1576890",b2:{y:3107.574578569538,x:3702.2816337193913},b1:{y:3076.3723735708613,x:3676.8844901158172}}},genes:[{bigg_id:"b0729",name:"sucD"},{bigg_id:"b0728",name:"sucC"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"coa_c"},{coefficient:1,bigg_id:"adp_c"},{coefficient:-1,bigg_id:"succ_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:1,bigg_id:"succoa_c"},{coefficient:1,bigg_id:"pi_c"}],label_x:3641,label_y:3010,gene_reaction_rule:"b0728 and b0729"},1576721:{name:"Phosphofructokinase",bigg_id:"PFK",segments:{404:{to_node_id:"1576891",from_node_id:"1576893",b2:null,b1:null},405:{to_node_id:"1576892",from_node_id:"1576891",b2:null,b1:null},406:{to_node_id:"1576893",from_node_id:"1576525",b2:{y:1668.25,x:1055},b1:{y:1617.5,x:1055}},407:{to_node_id:"1576893",from_node_id:"1576572",b2:{y:1674.9065411518764,x:1055},b1:{y:1639.6884705062548,x:1055}},408:{to_node_id:"1576573",from_node_id:"1576892",b2:{y:1822.4341649025257,x:1055},b1:{y:1789.2302494707578,x:1055}},409:{to_node_id:"1576529",from_node_id:"1576892",b2:{y:1850,x:1055},b1:{y:1797.5,x:1055}},410:{to_node_id:"1576574",from_node_id:"1576892",b2:{y:1835.2079728939614,x:1055},b1:{y:1793.0623918681883,x:1055}}},genes:[{bigg_id:"b1723",name:"pfkB"},{bigg_id:"b3916",name:"pfkA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"adp_c"},{coefficient:-1,bigg_id:"f6p_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:1,bigg_id:"fdp_c"}],label_x:1065,label_y:1725,gene_reaction_rule:"b3916 or b1723"},1576722:{name:"L-Glutamate exchange",bigg_id:"EX_glu__L_e",segments:{411:{to_node_id:"1576895",from_node_id:"1576552",b2:{y:3635,x:4949},b1:{y:3634.3,x:4902.8}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"glu__L_e"}],label_x:4936.36669921875,label_y:3680.79150390625,
gene_reaction_rule:""},1576723:{name:"Transketolase",bigg_id:"TKT2",segments:{413:{to_node_id:"1576896",from_node_id:"1576897",b2:null,b1:null},414:{to_node_id:"1576898",from_node_id:"1576896",b2:null,b1:null},415:{to_node_id:"1576897",from_node_id:"1576547",b2:{y:1735,x:1772.8736958157247},b1:{y:1735,x:1954.5789860524153}},416:{to_node_id:"1576897",from_node_id:"1576558",b2:{y:1735,x:1741.208765402248},b1:{y:1735,x:1849.0292180074937}},417:{to_node_id:"1576525",from_node_id:"1576898",b2:{y:1587.43115234375,x:1280.4546812716637},b1:{y:1741.3470458984375,x:1235.776382408843}},418:{to_node_id:"1576575",from_node_id:"1576898",b2:{y:1735,x:1312.7516245895065},b1:{y:1735,x:1318.2979239002893}}},genes:[{bigg_id:"b2465",name:"tktB"},{bigg_id:"b2935",name:"tktA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"xu5p__D_c"},{coefficient:-1,bigg_id:"e4p_c"},{coefficient:1,bigg_id:"g3p_c"},{coefficient:1,bigg_id:"f6p_c"}],label_x:1520.71923828125,label_y:1702.785400390625,gene_reaction_rule:"b2935 or b2465"},1576724:{name:"Glutamine synthetase",bigg_id:"GLNS",segments:{419:{to_node_id:"1576900",from_node_id:"1576901",b2:null,b1:null},420:{to_node_id:"1576899",from_node_id:"1576900",b2:null,b1:null},421:{to_node_id:"1576901",from_node_id:"1576554",b2:{y:3812.091159595566,x:4364},b1:{y:3725.970531985219,x:4364}},422:{to_node_id:"1576901",from_node_id:"1576576",b2:{y:3830.8679841164862,x:4364},b1:{y:3788.5599470549537,x:4364}},423:{to_node_id:"1576901",from_node_id:"1576577",b2:{y:3835.8273009599397,x:4364},b1:{y:3805.0910031997996,x:4364}},424:{to_node_id:"1576578",from_node_id:"1576899",b2:{y:4007.2677048056653,x:4364},b1:{y:3924.4803114416995,x:4364}},425:{to_node_id:"1576579",from_node_id:"1576899",b2:{y:3936.762432936357,x:4364},b1:{y:3903.3287298809073,x:4364}},426:{to_node_id:"1576580",from_node_id:"1576899",b2:{y:3956.314560089181,x:4364},b1:{y:3909.1943680267545,x:4364}},427:{to_node_id:"1576581",from_node_id:"1576899",b2:{y:3978.617241644675,x:4364},b1:{y:3915.8851724934025,x:4364}}},genes:[{bigg_id:"b3870",name:"glnA"},{bigg_id:"b1297",name:"puuA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"glu__L_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"nh4_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"adp_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"gln__L_c"}],label_x:4377.22314453125,label_y:3875.114990234375,gene_reaction_rule:"b3870 or b1297"},1576726:{name:"NAD transhydrogenase",bigg_id:"NADTRHD",segments:{434:{to_node_id:"1576907",from_node_id:"1576906",b2:null,b1:null},435:{to_node_id:"1576905",from_node_id:"1576907",b2:null,b1:null},436:{to_node_id:"1576906",from_node_id:"1576501",b2:{y:1270,x:3592.9455878111676},b1:{y:1270.0001220703125,x:3627.146913797642}},437:{to_node_id:"1576906",from_node_id:"1576500",b2:{y:1270,x:3595.5},b1:{y:1270,x:3655}},438:{to_node_id:"1576496",from_node_id:"1576905",b2:{y:1270,x:3400},b1:{y:1270,x:3449}},439:{to_node_id:"1576497",from_node_id:"1576905",b2:{y:1270,x:3418.3388104489154},b1:{y:1270,x:3446.2829175487373}}},genes:[{bigg_id:"b1602",name:"pntB"},{bigg_id:"b3962",name:"sthA"},{bigg_id:"b1603",name:"pntA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"nadh_c"},{coefficient:1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:-1,bigg_id:"nadph_c"}],label_x:3478.431396484375,label_y:1319.6259765625,gene_reaction_rule:"b3962 or (b1602 and b1603)"},1576727:{name:"2-Oxogluterate dehydrogenase",bigg_id:"AKGDH",segments:{440:{to_node_id:"1576909",from_node_id:"1576908",b2:null,b1:null},441:{to_node_id:"1576910",from_node_id:"1576909",b2:null,b1:null},442:{to_node_id:"1576908",from_node_id:"1576509",b2:{y:3502.6153909632244,x:3779.130177270645},b1:{y:3555.384636544082,x:3777.1005909021505}},443:{to_node_id:"1576908",from_node_id:"1576585",b2:{y:3494.907757737772,x:3779.4266247023934},b1:{y:3529.6925257925727,x:3778.088749007978}},444:{to_node_id:"1576908",from_node_id:"1576586",b2:{y:3498.5402671676266,x:3779.2869128012453},b1:{y:3541.8008905587553,x:3777.623042670817}},445:{to_node_id:"1576570",from_node_id:"1576910",b2:{y:3259.378766045427,x:3769.134046698861},b1:{y:3308.813629813628,x:3773.940214009658}},446:{to_node_id:"1576587",from_node_id:"1576910",b2:{y:3277.236984619066,x:3770.8702623935205},b1:{y:3314.1710953857196,x:3774.4610787180563}},447:{to_node_id:"1576588",from_node_id:"1576910",b2:{y:3276.99346892041,x:3770.846587256151},b1:{y:3314.098040676123,x:3774.453976176845}}},genes:[{bigg_id:"b0116",name:"lpd"},{bigg_id:"b0726",name:"sucA"},{bigg_id:"b0727",name:"sucB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"nadh_c"},{coefficient:-1,bigg_id:"coa_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:1,bigg_id:"succoa_c"},{coefficient:-1,bigg_id:"akg_c"}],label_x:3793,label_y:3392,gene_reaction_rule:"b0116 and b0726 and b0727"},1576728:{name:"Pyruvate formate lyase",bigg_id:"PFL",segments:{448:{to_node_id:"1576911",from_node_id:"1576912",b2:null,b1:null},449:{to_node_id:"1576913",from_node_id:"1576911",b2:null,b1:null},450:{to_node_id:"1576912",from_node_id:"1576589",b2:{y:3995,x:1239.5565547885194},b1:{y:3995,x:1203.521849295065}},451:{to_node_id:"1576912",from_node_id:"1576511",b2:{y:3995,x:1224.0767078078675},b1:{y:3995,x:1151.9223593595584}},452:{to_node_id:"1576514",from_node_id:"1576913",b2:{y:3995,x:1567.0690632574556},b1:{y:3995,x:1460.6207189772367}},453:{to_node_id:"1576590",from_node_id:"1576913",b2:{y:3995,x:1469.8292804986534},b1:{y:3995,x:1431.4487841495961}}},genes:[{bigg_id:"b3114",name:"tdcE"},{bigg_id:"b3951",name:"pflD"},{bigg_id:"b3952",name:"pflC"},{bigg_id:"b0903",name:"pflB"},{bigg_id:"b0902",name:"pflA"},{bigg_id:"b2579",name:"grcA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pyr_c"},{coefficient:-1,bigg_id:"coa_c"},{coefficient:1,bigg_id:"accoa_c"},{coefficient:1,bigg_id:"for_c"}],label_x:1310.09130859375,label_y:4046.8837890625,gene_reaction_rule:"((b0902 and b0903) and b2579) or (b0902 and b0903) or (b0902 and b3114) or (b3951 and b3952)"},1576729:{name:"O2 exchange",bigg_id:"EX_o2_e",segments:{454:{to_node_id:"1576914",from_node_id:"1576494",b2:{y:1660,x:4910},b1:{y:1660,x:4868}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"o2_e"}],label_x:4894.58984375,label_y:1633.8848876953125,gene_reaction_rule:""},1576730:{name:"Phosphoenolpyruvate carboxykinase",bigg_id:"PPCK",segments:{456:{to_node_id:"1576916",from_node_id:"1576917",b2:null,b1:null},457:{to_node_id:"1576918",from_node_id:"1576916",b2:null,b1:null},458:{to_node_id:"1576917",from_node_id:"1576591",b2:{y:3557.6148705803193,x:1495.4573041787805},b1:{y:3566.049568601064,x:1519.8576805959353}},459:{to_node_id:"1576917",from_node_id:"1576521",b2:{y:3678.777694102544,x:1757.8986662821364},b1:{y:3758.886258987647,x:2521.6033016696215}},460:{to_node_id:"1576592",from_node_id:"1576918",b2:{y:3492.675272400688,x:1304.0258172020633},b1:{y:3499.9025817202064,x:1325.707745160619}},461:{to_node_id:"1576593",from_node_id:"1576918",b2:{y:3483.931701701515,x:1277.7951051045454},b1:{y:3497.2795105104547,x:1317.8385315313635}},462:{to_node_id:"1576517",from_node_id:"1576918",b2:{y:3454.321462634956,x:1188.9643879048676},b1:{y:3488.3964387904866,x:1291.1893163714603}}},genes:[{bigg_id:"b3403",name:"pck"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"pep_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"oaa_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:1,bigg_id:"adp_c"}],label_x:1377.3328857421875,label_y:3600.33447265625,gene_reaction_rule:"b3403"},1576731:{name:"Phosphate reversible transport via symport",bigg_id:"PIt2r",segments:{463:{to_node_id:"1576920",from_node_id:"1576921",b2:null,b1:null},464:{to_node_id:"1576919",from_node_id:"1576920",b2:null,b1:null},465:{to_node_id:"1576921",from_node_id:"1576594",b2:{y:4742.1,x:2880},b1:{y:4782,x:2880}},466:{to_node_id:"1576921",from_node_id:"1576595",b2:{y:4740.280870394058,x:2880},b1:{y:4775.936234646861,x:2880}},467:{to_node_id:"1576596",from_node_id:"1576919",b2:{y:4464.789040942943,x:2880},b1:{y:4503.436712282883,x:2880}},468:{to_node_id:"1576597",from_node_id:"1576919",b2:{y:4475,x:2880},b1:{y:4506.5,x:2880}}},genes:[{bigg_id:"b3493",name:"pitA"},{bigg_id:"b2987",name:"pitB"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:-1,bigg_id:"pi_e"}],label_x:2916.97509765625,label_y:4649.33837890625,gene_reaction_rule:"b2987 or b3493"},1576732:{name:"2 oxoglutarate reversible transport via symport",bigg_id:"AKGt2r",segments:{469:{to_node_id:"1576924",from_node_id:"1576923",b2:null,b1:null},470:{to_node_id:"1576922",from_node_id:"1576924",b2:null,b1:null},471:{to_node_id:"1576923",from_node_id:"1576598",b2:{y:3228,x:4811.5},b1:{y:3228,x:4857}},472:{to_node_id:"1576923",from_node_id:"1576599",b2:{y:3228,x:4807.306616216525},b1:{y:3228,x:4843.0220540550845}},473:{to_node_id:"1576509",from_node_id:"1576922",b2:{y:3228,x:4074.584218822},b1:{y:3228,x:4373.7752656466}},474:{to_node_id:"1576600",from_node_id:"1576922",b2:{y:3228,x:4449.798467455447},b1:{y:3228,x:4486.339540236634}}},genes:[{bigg_id:"b2587",name:"kgtP"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"},{coefficient:1,bigg_id:"akg_c"},{coefficient:-1,bigg_id:"akg_e"},{coefficient:1,bigg_id:"h_c"}],label_x:4594.6474609375,label_y:3197.05029296875,gene_reaction_rule:"b2587"},1576733:{name:"Fructose-bisphosphate aldolase",bigg_id:"FBA",segments:{53:{to_node_id:"1576925",from_node_id:"1576926",b2:null,b1:null},54:{to_node_id:"1576575",from_node_id:"1576925",b2:{y:2120,x:1055},b1:{y:2067.5,x:1055}},55:{to_node_id:"1576601",from_node_id:"1576925",b2:{y:2081.141357421875,x:929.645751953125},b1:{y:2082.5,x:1055}},475:{to_node_id:"1576926",from_node_id:"1576529",b2:{y:1974.28076171875,x:1055},b1:{y:1970.4088134765625,x:1055}}},genes:[{bigg_id:"b2097",name:"fbaB"},{bigg_id:"b2925",name:"fbaA"},{bigg_id:"b1773",name:"ydjI"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"dhap_c"},{coefficient:1,bigg_id:"g3p_c"},{coefficient:-1,bigg_id:"fdp_c"}],label_x:969.7942504882812,label_y:2031.01611328125,gene_reaction_rule:"b2097 or b1773 or b2925"},1576734:{name:"Triose-phosphate isomerase",bigg_id:"TPI",segments:{56:{to_node_id:"1576927",from_node_id:"1576601",b2:{y:2195,x:911.3470458984375},b1:{y:2195,x:911.255859375}},57:{to_node_id:"1576575",from_node_id:"1576927",b2:{y:2195,x:1005},b1:{y:2195,x:970}}},genes:[{bigg_id:"b3919",name:"tpiA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"dhap_c"},{coefficient:1,bigg_id:"g3p_c"}],label_x:936.438232421875,label_y:2245.297119140625,gene_reaction_rule:"b3919"},1576735:{name:"Cytochrome oxidase bd (ubiquinol-8: 2 protons)",bigg_id:"CYTBD",segments:{58:{to_node_id:"1576928",from_node_id:"1576930",b2:null,b1:null},59:{to_node_id:"1576929",from_node_id:"1576928",b2:null,b1:null},60:{to_node_id:"1576930",from_node_id:"1576602",b2:{y:1900,x:4595.5},b1:{y:1895.1654052734375,x:4416.69775390625}},61:{to_node_id:"1576930",from_node_id:"1576495",b2:{y:1900,x:4572.371881863104},b1:{y:1900,x:4437.906272877015}},62:{to_node_id:"1576930",from_node_id:"1576542",b2:{y:1900,x:4581.906341374356},b1:{y:1890.3310546875,x:4368.162902237436}},63:{to_node_id:"1576539",from_node_id:"1576929",b2:{y:1903.22314453125,x:4842.38515985191},b1:{y:1900,x:4715.894014752448}},64:{to_node_id:"1576603",from_node_id:"1576929",b2:{y:1900,x:4775},b1:{y:1900,x:4715.5}},65:{to_node_id:"1576604",from_node_id:"1576929",b2:{y:1758.1868896484375,x:4884.545828600423},b1:{y:1901.611572265625,x:4821.203885298877}}},genes:[{bigg_id:"b0978",name:"cbdA"},{bigg_id:"b0734",name:"cydB"},{bigg_id:"b0979",name:"cbdB"},{bigg_id:"b0733",name:"cydA"}],reversibility:!1,metabolites:[{coefficient:-.5,bigg_id:"o2_c"},{coefficient:1,bigg_id:"q8_c"},{coefficient:2,bigg_id:"h_e"},{coefficient:-1,bigg_id:"q8h2_c"},{coefficient:-2,bigg_id:"h_c"},{coefficient:1,bigg_id:"h2o_c"}],label_x:4560.4169921875,label_y:1954.46044921875,gene_reaction_rule:"(b0978 and b0979) or (b0733 and b0734)"},1576736:{name:"Ribose-5-phosphate isomerase",bigg_id:"RPI",segments:{66:{to_node_id:"1576931",from_node_id:"1576605",b2:{y:1490,x:2362},b1:{y:1535.5,x:2401.9}},67:{to_node_id:"1576493",from_node_id:"1576931",b2:{y:1345,x:2230},b1:{y:1401,x:2282.5}}},genes:[{bigg_id:"b2914",name:"rpiA"},{bigg_id:"b4090",name:"rpiB"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"ru5p__D_c"},{coefficient:-1,bigg_id:"r5p_c"}],label_x:2315,label_y:1415,gene_reaction_rule:"b2914 or b4090"},1576737:{name:"Malate synthase",bigg_id:"MALS",segments:{68:{to_node_id:"1576934",from_node_id:"1576933",b2:null,b1:null},69:{to_node_id:"1576932",from_node_id:"1576934",b2:null,b1:null},70:{to_node_id:"1576933",from_node_id:"1576532",b2:{y:3464.029731004742,x:3021.7099591823435},b1:{y:3508.4324366824735,x:3086.3665306078124}},71:{to_node_id:"1576933",from_node_id:"1576606",b2:{y:3455.108224908018,x:3008.7189941643073},b1:{y:3478.694083026728,x:3043.063313881025}},72:{to_node_id:"1576933",from_node_id:"1576607",b2:{y:3460.23788356471,x:3016.1884971205427},b1:{y:3495.7929452157005,x:3067.961657068476}},73:{to_node_id:"1576608",from_node_id:"1576932",b2:{y:3305.691868266011,x:2791.915894512527},b1:{y:3330.4075604798036,x:2827.674768353758}},74:{to_node_id:"1576609",from_node_id:"1576932",b2:{y:3288.6581354094164,x:2767.2713448476666},b1:{y:3325.297440622825,x:2820.2814034543}},75:{to_node_id:"1576504",from_node_id:"1576932",b2:{y:3264.9901959981144,x:2733.0283686781227},b1:{y:3318.197058799434,x:2810.0085106034367}}},genes:[{bigg_id:"b2976",name:"glcB"},{bigg_id:"b4014",name:"aceB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"coa_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"mal__L_c"},{coefficient:-1,bigg_id:"accoa_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"glx_c"}],label_x:2921,label_y:3378,gene_reaction_rule:"b4014 or b2976"},1576739:{name:"Phosphotransacetylase",bigg_id:"PTAr",segments:{76:{to_node_id:"1576937",from_node_id:"1576935",b2:null,b1:null},77:{to_node_id:"1576936",from_node_id:"1576937",b2:null,b1:null},78:{to_node_id:"1576935",from_node_id:"1576514",b2:{y:4047,x:1715},b1:{y:4005,x:1715}},79:{to_node_id:"1576935",from_node_id:"1576612",b2:{y:4049.339540236634,x:1715},b1:{y:4012.7984674554473,x:1715}},80:{to_node_id:"1576613",from_node_id:"1576936",b2:{y:4140,x:1715},b1:{y:4115.5,x:1715}},81:{to_node_id:"1576614",from_node_id:"1576936",b2:{y:4157.201532544553,x:1715},b1:{y:4120.660459763366,x:1715}}},genes:[{bigg_id:"b2297",name:"pta"},{bigg_id:"b2458",name:"eutD"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"accoa_c"},{coefficient:1,bigg_id:"actp_c"},{coefficient:-1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"coa_c"}],label_x:1725,label_y:4075,gene_reaction_rule:"b2297 or b2458"},1576741:{name:"GLNabc",bigg_id:"GLNabc",segments:{82:{to_node_id:"1576939",from_node_id:"1576940",b2:null,b1:null},83:{to_node_id:"1576938",from_node_id:"1576939",b2:null,b1:null},84:{to_node_id:"1576940",from_node_id:"1576537",b2:{y:4158,x:4519.05},b1:{y:4158,x:4668.5}},85:{to_node_id:"1576940",from_node_id:"1576615",b2:{y:4158,x:4474.209372712298},b1:{y:4158,x:4519.031242374329}},86:{to_node_id:"1576940",from_node_id:"1576616",b2:{y:4158,x:4470.660459763366},b1:{y:4158,x:4507.201532544553}},87:{to_node_id:"1576578",from_node_id:"1576938",b2:{y:4158,x:4324.643760591755},b1:{y:4158,x:4387.893128177527}},88:{to_node_id:"1576617",from_node_id:"1576938",b2:{y:4158,x:4332.993902665717},b1:{y:4158,x:4390.398170799715}},89:{to_node_id:"1576618",from_node_id:"1576938",b2:{y:4158,x:4362.798467455447},b1:{y:4158,x:4399.339540236634}},90:{to_node_id:"1576619",from_node_id:"1576938",b2:{y:4158,x:4350.968757625671},b1:{y:4158,x:4395.790627287702}}},genes:[{bigg_id:"b0811",name:"glnH"},{bigg_id:"b0810",name:"glnP"},{bigg_id:"b0809",name:"glnQ"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"gln__L_e"},{coefficient:1,bigg_id:"adp_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"gln__L_c"}],label_x:4535.24462890625,label_y:4133.49658203125,gene_reaction_rule:"b0811 and b0810 and b0809"},1576742:{name:"Malic enzyme (NAD)",bigg_id:"ME1",segments:{91:{to_node_id:"1576942",from_node_id:"1576941",b2:null,b1:null},92:{to_node_id:"1576943",from_node_id:"1576942",b2:null,b1:null},93:{to_node_id:"1576941",from_node_id:"1576504",b2:{y:3307.175835174097,x:2355.6483296518063},b1:{y:3253.9194505803225,x:2462.161098839355}},94:{to_node_id:"1576941",from_node_id:"1576620",b2:{y:3321.8944463483363,x:2326.2111073033275},b1:{y:3302.9814878277875,x:2364.0370243444254}},95:{to_node_id:"1576511",from_node_id:"1576943",b2:{y:3870.856276574083,x:1117.2138384533964},b1:{y:3474.7533185191,x:2020.4933629618001}},96:{to_node_id:"1576621",from_node_id:"1576943",b2:{y:3419.8328677803524,x:2130.3342644392947},b1:{y:3398.949860334106,x:2172.1002793317884}},97:{to_node_id:"1576622",from_node_id:"1576943",b2:{y:3415,x:2140},b1:{y:3397.5,x:2175}}},genes:[{bigg_id:"b1479",name:"maeA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"mal__L_c"},{coefficient:1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"nadh_c"}],label_x:2188.595703125,label_y:3321.438232421875,gene_reaction_rule:"b1479"},1576743:{name:"Glucose 6-phosphate dehydrogenase",bigg_id:"G6PDH2r",segments:{98:{to_node_id:"1576945",from_node_id:"1576946",b2:null,b1:null},99:{to_node_id:"1576944",from_node_id:"1576945",b2:null,b1:null},100:{to_node_id:"1576946",from_node_id:"1576623",b2:{y:1265,x:1270.6197527491188},b1:{y:1265,x:1232.3991758303962}},101:{to_node_id:"1576946",from_node_id:"1576524",b2:{y:1265,x:1252.2},b1:{y:1265,x:1171}},102:{to_node_id:"1576624",from_node_id:"1576944",b2:{y:1265,x:1393.0018939122203},b1:{y:1265,x:1346.800568173666}},103:{to_node_id:"1576625",from_node_id:"1576944",b2:{y:1265,x:1381.6008241696038},b1:{y:1265,x:1343.3802472508812}},104:{to_node_id:"1576626",from_node_id:"1576944",b2:{y:1265,x:1417},b1:{y:1265,x:1354}}},genes:[{bigg_id:"b1852",name:"zwf"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"g6p_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:1,bigg_id:"nadph_c"},{coefficient:1,bigg_id:"6pgl_c"}],label_x:1261.46337890625,label_y:1320.0572509765625,gene_reaction_rule:"b1852"},1576744:{name:"Acetate exchange",bigg_id:"EX_ac_e",segments:{105:{to_node_id:"1576947",from_node_id:"1576627",b2:{y:4890,x:1715},b1:{y:4888.64794921875,x:1715}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"ac_e"}],label_x:1742.4544677734375,label_y:4917.06640625,gene_reaction_rule:""},1576745:{name:"Glutaminase",bigg_id:"GLUN",segments:{107:{to_node_id:"1576951",from_node_id:"1576950",b2:null,b1:null},108:{to_node_id:"1576949",from_node_id:"1576951",b2:null,b1:null},109:{to_node_id:"1576950",from_node_id:"1576628",b2:{y:3888.700961498954,x:4247},b1:{y:3916.003204996513,x:4247}},110:{to_node_id:"1576950",from_node_id:"1576578",b2:{y:3909.550345620285,x:4247},b1:{y:3985.501152067616,x:4247}},111:{to_node_id:"1576629",from_node_id:"1576949",b2:{y:3777.1681351239463,x:4247},b1:{y:3803.650440537184,x:4247}},112:{to_node_id:"1576554",from_node_id:"1576949",b2:{y:3723.4986338899794,x:4247},b1:{y:3787.5495901669938,x:4247}}},genes:[{bigg_id:"b1524",name:"glsB"},{bigg_id:"b0485",name:"glsA"},{bigg_id:"b1812",name:"pabB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"glu__L_c"},{coefficient:-1,bigg_id:"gln__L_c"},{coefficient:1,bigg_id:"nh4_c"},{coefficient:-1,bigg_id:"h2o_c"}],label_x:4253.77685546875,label_y:3866.338134765625,gene_reaction_rule:"b1812 or b0485 or b1524"},1576746:{name:"ATP maintenance requirement",bigg_id:"ATPM",segments:{113:{to_node_id:"1576953",from_node_id:"1576952",b2:null,b1:null},114:{to_node_id:"1576954",from_node_id:"1576953",b2:null,b1:null},115:{to_node_id:"1576952",from_node_id:"1576534",b2:{y:1176,x:4215},b1:{y:1120,x:4215}},116:{to_node_id:"1576952",from_node_id:"1576630",b2:{y:1187.2720779386423,x:4215},b1:{y:1157.5735931288073,x:4215}},117:{to_node_id:"1576631",from_node_id:"1576954",b2:{y:1411.0327780786686,x:4215},b1:{y:1368.3098334236006,x:4215}},118:{to_node_id:"1576632",from_node_id:"1576954",b2:{y:1388.0788655293195,x:4215},b1:{y:1361.423659658796,x:4215}},119:{to_node_id:"1576536",from_node_id:"1576954",b2:{y:1430,x:4215},b1:{y:1374,x:4215}}},genes:[],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"adp_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"pi_c"}],label_x:4241.11474609375,label_y:1266.1151123046875,gene_reaction_rule:""},1576747:{name:"D-lactate dehydrogenase",bigg_id:"LDH_D",segments:{120:{to_node_id:"1576957",from_node_id:"1576956",b2:null,b1:null},121:{to_node_id:"1576955",from_node_id:"1576957",b2:null,b1:null},122:{to_node_id:"1576956",from_node_id:"1576633",b2:{y:4240.660459763366,x:1055},b1:{y:4277.201532544553,x:1055}},123:{to_node_id:"1576956",from_node_id:"1576584",b2:{y:4243,x:1055},b1:{y:4285,x:1055}},124:{to_node_id:"1576634",from_node_id:"1576955",b2:{y:4060.9687576256715,x:1055},b1:{y:4105.790627287702,x:1055}},125:{to_node_id:"1576511",from_node_id:"1576955",b2:{y:4035,x:1055},b1:{y:4098,x:1055}},126:{to_node_id:"1576635",from_node_id:"1576955",b2:{y:4072.7984674554473,x:1055},b1:{y:4109.339540236634,x:1055}}},genes:[{bigg_id:"b1380",name:"ldhA"},{bigg_id:"b2133",name:"dld"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"lac__D_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"nadh_c"}],label_x:1065,label_y:4165,gene_reaction_rule:"b2133 or b1380"},1576748:{name:"Malate dehydrogenase",bigg_id:"MDH",segments:{127:{to_node_id:"1576959",from_node_id:"1576960",b2:null,b1:null},128:{to_node_id:"1576958",from_node_id:"1576959",b2:null,b1:null},129:{to_node_id:"1576960",from_node_id:"1576504",b2:{y:3317.969496697346,x:2583.827817722433},b1:{y:3264.23165565782,x:2588.092725741443}},130:{to_node_id:"1576960",from_node_id:"1576636",b2:{y:3327.0487806839114,x:2583.107239628261},b1:{y:3294.4959356130375,x:2585.69079876087}},131:{to_node_id:"1576637",from_node_id:"1576958",b2:{y:3538.2116199944217,x:2579.5809926922},b1:{y:3480.6634859983265,x:2578.47429780766}},132:{to_node_id:"1576638",from_node_id:"1576958",b2:{y:3505.0826757349405,x:2578.9438976102874},b1:{y:3470.7248027204823,x:2578.2831692830864}},133:{to_node_id:"1576521",from_node_id:"1576958",b2:{y:3595.960728582294,x:2580.6915524727365},b1:{y:3497.9882185746883,x:2578.807465741821}}},genes:[{bigg_id:"b3236",name:"mdh"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"mal__L_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"oaa_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"nadh_c"}],label_x:2587,label_y:3394,gene_reaction_rule:"b3236"},1576749:{name:"H2O transport via diffusion",bigg_id:"H2Ot",segments:{134:{to_node_id:"1576961",from_node_id:"1576639",b2:{y:4684,x:3257},b1:{y:4733,x:3257}},135:{to_node_id:"1576640",from_node_id:"1576961",b2:{y:4524,x:3257},b1:{y:4587,x:3257}}},genes:[{bigg_id:"s0001",name:"None"},{bigg_id:"b0875",name:"aqpZ"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"h2o_e"}],label_x:3267,label_y:4604,gene_reaction_rule:"b0875 or s0001"},1576750:{name:"H2O exchange",bigg_id:"EX_h2o_e",segments:{136:{to_node_id:"1576962",from_node_id:"1576639",b2:{y:4839,x:3257},b1:{y:4779.5,x:3257}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h2o_e"}],label_x:3267,label_y:4914,gene_reaction_rule:""},1576751:{name:"Transketolase",bigg_id:"TKT1",segments:{138:{to_node_id:"1576965",from_node_id:"1576964",b2:null,b1:null},139:{to_node_id:"1576966",from_node_id:"1576965",b2:null,b1:null},140:{to_node_id:"1576964",from_node_id:"1576605",b2:{y:1605.9896167668144,x:2175},b1:{y:1557.80791851959,x:2171.826416015625}},141:{to_node_id:"1576964",from_node_id:"1576558",b2:{y:1607.9527328943145,x:2175},b1:{y:1558.0047151164654,x:2171.82666015625}},142:{to_node_id:"1576546",from_node_id:"1576966",b2:{y:1816.322080948729,x:2070.2734375},b1:{y:1823.819109636181,x:2173.413330078125}},143:{to_node_id:"1576545",from_node_id:"1576966",b2:{y:1821.0824569252916,x:2297.1806640625},b1:{y:1822.232439714306,x:2175}}},genes:[{bigg_id:"b2465",name:"tktB"},{bigg_id:"b2935",name:"tktA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"xu5p__D_c"},{coefficient:-1,bigg_id:"r5p_c"},{coefficient:1,bigg_id:"g3p_c"},{coefficient:1,bigg_id:"s7p_c"}],label_x:2185,label_y:1685,gene_reaction_rule:"b2935 or b2465"},1576752:{name:"CO2 transporter via diffusion",bigg_id:"CO2t",segments:{144:{to_node_id:"1576967",from_node_id:"1576544",b2:{y:4679,x:3621},b1:{y:4731.5,x:3621}},145:{to_node_id:"1576641",from_node_id:"1576967",b2:{y:4519,x:3621},b1:{y:4578.5,x:3621}}},genes:[{bigg_id:"s0001",name:"None"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"co2_e"},{coefficient:1,bigg_id:"co2_c"}],label_x:3631,label_y:4594,gene_reaction_rule:"s0001"},1576753:{name:"2-Oxoglutarate exchange",bigg_id:"EX_akg_e",segments:{146:{to_node_id:"1576969",from_node_id:"1576598",b2:{y:3228,x:4977},b1:{y:3228,x:4938.5}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"akg_e"}],label_x:5042,label_y:3218,gene_reaction_rule:""},1576754:{name:"Phosphoenolpyruvate synthase",bigg_id:"PPS",segments:{148:{to_node_id:"1576972",from_node_id:"1576970",b2:null,b1:null},149:{to_node_id:"1576971",from_node_id:"1576972",b2:null,b1:null},150:{to_node_id:"1576970",from_node_id:"1576642",b2:{y:3821.7705098312485,x:835},b1:{y:3860.9016994374947,x:835}},151:{to_node_id:"1576970",from_node_id:"1576511",b2:{y:3844.115214431216,x:835},b1:{y:3935.384048104053,x:835}},152:{to_node_id:"1576970",from_node_id:"1576643",b2:{y:3820,x:835},b1:{y:3855,x:835}},153:{to_node_id:"1576517",from_node_id:"1576971",b2:{y:3391.8647304430565,x:835},b1:{y:3485.059419132917,x:835}},154:{to_node_id:"1576644",from_node_id:"1576971",b2:{y:3469.0983005625053,x:835},b1:{y:3508.2294901687515,x:835}},155:{to_node_id:"1576645",from_node_id:"1576971",b2:{y:3475,x:835},b1:{y:3510,x:835}},156:{to_node_id:"1576646",from_node_id:"1576971",b2:{y:3454.289321881345,x:835},b1:{y:3503.7867965644036,x:835}}},genes:[{bigg_id:"b1702",name:"ppsA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pyr_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:1,bigg_id:"amp_c"},{coefficient:1,bigg_id:"pep_c"},{coefficient:2,bigg_id:"h_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:-1,bigg_id:"h2o_c"}],label_x:741.8604125976562,label_y:3669.90869140625,gene_reaction_rule:"b1702"},1576755:{name:"D-Glucose exchange",bigg_id:"EX_glc__D_e",segments:{157:{to_node_id:"1576974",from_node_id:"1576647",b2:{y:623.4132690429688,x:1056.6529541015625},b1:{y:625.4632568359375,x:1055.066162109375}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"glc__D_e"}],label_x:1082.5206298828125,label_y:598.4705200195312,gene_reaction_rule:""},1576756:{name:"ETOHt2r",bigg_id:"ETOHt2r",segments:{159:{to_node_id:"1576976",from_node_id:"1576977",b2:null,b1:null},160:{to_node_id:"1576975",from_node_id:"1576976",b2:null,b1:null},161:{to_node_id:"1576977",from_node_id:"1576648",b2:{y:4745.660459763366,x:2500},b1:{y:4782.201532544553,x:2500}},162:{to_node_id:"1576977",from_node_id:"1576649",b2:{y:4745,x:2500},b1:{y:4780,x:2500}},163:{to_node_id:"1576650",from_node_id:"1576975",b2:{y:4377.798467455447,x:2500},b1:{y:4414.339540236634,x:2500}},164:{to_node_id:"1576829",from_node_id:"1576975",b2:{y:4328.998762383821,x:2500},b1:{y:4399.699628715146,x:2500}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"},{coefficient:1,bigg_id:"etoh_c"},{coefficient:-1,bigg_id:"etoh_e"},{coefficient:1,bigg_id:"h_c"}],label_x:2530.6279296875,label_y:4611.404296875,gene_reaction_rule:""},1576757:{name:"Phosphoglycerate mutase",bigg_id:"PGM",segments:{165:{to_node_id:"1576978",from_node_id:"1576522",b2:{y:3060,x:1055},b1:{y:3105.5,x:1055}},166:{to_node_id:"1576486",from_node_id:"1576978",b2:{y:2935,x:1055},b1:{y:2977,x:1055}}},genes:[{bigg_id:"b3612",name:"gpmM"},{bigg_id:"b4395",name:"ytjC"},{bigg_id:"b0755",name:"gpmA"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"3pg_c"},{coefficient:-1,bigg_id:"2pg_c"}],label_x:1065,label_y:2985,gene_reaction_rule:"b3612 or b4395 or b0755"},1576758:{name:"Ethanol exchange",bigg_id:"EX_etoh_e",segments:{167:{to_node_id:"1576980",from_node_id:"1576649",b2:{y:4887.93359375,x:2500},b1:{y:4875.1484375,x:2500}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"etoh_e"}],label_x:2519.520751953125,label_y:4934.28076171875,gene_reaction_rule:""},1576759:{name:"Acetate kinase",bigg_id:"ACKr",segments:{169:{to_node_id:"1576982",from_node_id:"1576981",b2:null,b1:null},170:{to_node_id:"1576983",from_node_id:"1576982",b2:null,b1:null},171:{to_node_id:"1576981",from_node_id:"1576651",b2:{y:4320.660459763366,x:1715},b1:{y:4357.201532544553,x:1715}},172:{to_node_id:"1576981",from_node_id:"1576652",b2:{y:4317,x:1715},b1:{y:4345,x:1715}},173:{to_node_id:"1576653",from_node_id:"1576983",b2:{y:4202.798467455447,x:1715},b1:{y:4239.339540236634,x:1715}},174:{to_node_id:"1576613",from_node_id:"1576983",b2:{y:4215,x:1715},b1:{y:4243,x:1715}}},genes:[{bigg_id:"b2296",name:"ackA"},{bigg_id:"b3115",name:"tdcD"},{bigg_id:"b1849",name:"purT"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"adp_c"},{coefficient:-1,bigg_id:"ac_c"},{coefficient:1,bigg_id:"actp_c"},{coefficient:-1,bigg_id:"atp_c"}],label_x:1737.694091796875,label_y:4293.5615234375,gene_reaction_rule:"b3115 or b2296 or b1849"},1576760:{name:"Ammonia exchange",bigg_id:"EX_nh4_e",segments:{175:{to_node_id:"1576985",from_node_id:"1576526",b2:{y:4837.5,x:3990},b1:{y:4781.15,x:3989.3}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"nh4_e"}],label_x:4001,label_y:4908,gene_reaction_rule:""},1576761:{name:"Glutamate synthase (NADPH)",bigg_id:"GLUSy",segments:{177:{to_node_id:"1576988",from_node_id:"1576986",b2:null,b1:null},178:{to_node_id:"1576987",from_node_id:"1576988",b2:null,b1:null},179:{to_node_id:"1576986",from_node_id:"1576509",b2:{y:4155.746259618145,x:4119.22314453125},b1:{y:4145.014875810485,x:3943.568359375}},180:{to_node_id:"1576986",from_node_id:"1576654",b2:{y:3902.6240384299276,x:4116},b1:{y:3936.7467947664254,x:4116}},181:{to_node_id:"1576986",from_node_id:"1576578",b2:{y:3924.538472874492,x:4116},b1:{y:4009.7949095816407,x:4116}},182:{to_node_id:"1576986",from_node_id:"1576655",b2:{y:3907.2123007471773,x:4116},b1:{y:3952.041002490592,x:4116}},183:{to_node_id:"1576656",from_node_id:"1576987",b2:{y:3790.445677833893,x:4116},b1:{y:3830.733703350168,x:4116}},184:{to_node_id:"1576554",from_node_id:"1576987",b2:{y:3721.4298613416263,x:4116},b1:{y:3810.0289584024877,x:4116}}},genes:[{bigg_id:"b3212",name:"gltB"},{bigg_id:"b3213",name:"gltD"}],reversibility:!1,metabolites:[{coefficient:2,bigg_id:"glu__L_c"},{coefficient:1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nadph_c"},{coefficient:-1,bigg_id:"gln__L_c"},{coefficient:-1,bigg_id:"akg_c"}],label_x:3984.18701171875,label_y:3851.553955078125,gene_reaction_rule:"b3212 and b3213"},1576762:{name:"Phosphate exchange",bigg_id:"EX_pi_e",segments:{185:{to_node_id:"1576989",from_node_id:"1576594",b2:{y:4909.82177734375,x:2880},b1:{y:4896.2666015625,x:2879.999755859375}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"pi_e"}],label_x:2902.694091796875,label_y:4926.21484375,gene_reaction_rule:""},1576763:{name:"Fumarate transport via proton symport  2 H ",bigg_id:"FUMt2_2",segments:{187:{to_node_id:"1576993",from_node_id:"1576991",b2:null,b1:null},188:{to_node_id:"1576992",from_node_id:"1576993",b2:null,b1:null},189:{to_node_id:"1576991",from_node_id:"1576657",b2:{y:718,x:2840},b1:{y:690,x:2840}},190:{to_node_id:"1576991",from_node_id:"1576658",
b2:{y:714.3395402366342,x:2840},b1:{y:677.7984674554473,x:2840}},191:{to_node_id:"1576659",from_node_id:"1576992",b2:{y:1032.2015325445527,x:2840},b1:{y:995.6604597633658,x:2840}},192:{to_node_id:"1576503",from_node_id:"1576992",b2:{y:1950.0011597931211,x:2840},b1:{y:1271.0003479379363,x:2840}}},genes:[{bigg_id:"b3528",name:"dctA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"fum_c"},{coefficient:2,bigg_id:"h_c"},{coefficient:-1,bigg_id:"fum_e"},{coefficient:-2,bigg_id:"h_e"}],label_x:2851.586669921875,label_y:845.8676147460938,gene_reaction_rule:"b3528"},1576764:{name:"Acetate reversible transport via proton symport",bigg_id:"ACt2r",segments:{193:{to_node_id:"1576995",from_node_id:"1576994",b2:null,b1:null},194:{to_node_id:"1576996",from_node_id:"1576995",b2:null,b1:null},195:{to_node_id:"1576994",from_node_id:"1576627",b2:{y:4760,x:1715},b1:{y:4779.13232421875,x:1716.5867919921875}},196:{to_node_id:"1576994",from_node_id:"1576660",b2:{y:4760.660459763366,x:1715},b1:{y:4787.680536450803,x:1715}},197:{to_node_id:"1576652",from_node_id:"1576996",b2:{y:4450.38818359375,x:1715},b1:{y:4489.49560546875,x:1715}},198:{to_node_id:"1576661",from_node_id:"1576996",b2:{y:4430.253057299197,x:1719.76025390625},b1:{y:4485.835145705384,x:1715}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"ac_e"},{coefficient:1,bigg_id:"ac_c"}],label_x:1740.8675537109375,label_y:4638.470703125,gene_reaction_rule:""},1576765:{name:"D-glucose transport via PEP:Pyr PTS",bigg_id:"GLCpts",segments:{199:{to_node_id:"1576997",from_node_id:"1576998",b2:null,b1:null},200:{to_node_id:"1576999",from_node_id:"1576997",b2:null,b1:null},201:{to_node_id:"1576998",from_node_id:"1576662",b2:{y:830.8607140720374,x:1056.2982974892807},b1:{y:817.6128620109578,x:962.100078544998}},202:{to_node_id:"1576998",from_node_id:"1576647",b2:{y:852.0646158583277,x:1054.6540059434642},b1:{y:841.218336226978,x:1054.4691636917553}},203:{to_node_id:"1576663",from_node_id:"1576999",b2:{y:1091.99109457335,x:1162.89990234375},b1:{y:1155.6497636747395,x:1056.5867919921875}},204:{to_node_id:"1576524",from_node_id:"1576999",b2:{y:1159.3526000976562,x:1055},b1:{y:1156.4998046875,x:1056.5867919921875}}},genes:[{bigg_id:"b1621",name:"malX"},{bigg_id:"b2416",name:"ptsI"},{bigg_id:"b1817",name:"manX"},{bigg_id:"b1101",name:"ptsG"},{bigg_id:"b1818",name:"manY"},{bigg_id:"b1819",name:"manZ"},{bigg_id:"b2415",name:"ptsH"},{bigg_id:"b2417",name:"crr"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pep_c"},{coefficient:1,bigg_id:"pyr_c"},{coefficient:-1,bigg_id:"glc__D_e"},{coefficient:1,bigg_id:"g6p_c"}],label_x:1074.520263671875,label_y:929.0499877929688,gene_reaction_rule:"(b2417 and b1101 and b2415 and b2416) or (b1817 and b1818 and b1819 and b2415 and b2416) or (b2417 and b1621 and b2415 and b2416)"},1576766:{name:"Succinate transport out via proton antiport",bigg_id:"SUCCt3",segments:{205:{to_node_id:"1577000",from_node_id:"1577002",b2:null,b1:null},206:{to_node_id:"1577001",from_node_id:"1577000",b2:null,b1:null},207:{to_node_id:"1577002",from_node_id:"1576664",b2:{y:2844.388427734375,x:4392.512762612581},b1:{y:2928.186767578125,x:4395.992900114855}},208:{to_node_id:"1577002",from_node_id:"1576533",b2:{y:2846,x:4388.970989302984},b1:{y:2846,x:3989.9032976766134}},209:{to_node_id:"1576531",from_node_id:"1577001",b2:{y:2846,x:4852.764726786234},b1:{y:2844.388427734375,x:4830.28303131712}},210:{to_node_id:"1576665",from_node_id:"1577001",b2:{y:2757.366943359375,x:4896.373608481642},b1:{y:2844.388427734375,x:4895.4172094976175}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"succ_c"},{coefficient:1,bigg_id:"succ_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"h_e"}],label_x:4451.38818359375,label_y:2819.884765625,gene_reaction_rule:""},1576768:{name:"6-phosphogluconolactonase",bigg_id:"PGL",segments:{211:{to_node_id:"1577003",from_node_id:"1577005",b2:null,b1:null},212:{to_node_id:"1577004",from_node_id:"1577003",b2:null,b1:null},213:{to_node_id:"1577005",from_node_id:"1576626",b2:{y:1265,x:1600.5},b1:{y:1265,x:1562}},214:{to_node_id:"1577005",from_node_id:"1576667",b2:{y:1265,x:1600.6197527491188},b1:{y:1265,x:1562.3991758303962}},215:{to_node_id:"1576668",from_node_id:"1577004",b2:{y:1265,x:1711.6008241696038},b1:{y:1265,x:1673.3802472508812}},216:{to_node_id:"1576490",from_node_id:"1577004",b2:{y:1265,x:1742},b1:{y:1265,x:1682.5}}},genes:[{bigg_id:"b0767",name:"pgl"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"6pgl_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"6pgc_c"}],label_x:1599.3970947265625,label_y:1312.1234130859375,gene_reaction_rule:"b0767"},1576769:{name:"Glyceraldehyde-3-phosphate dehydrogenase",bigg_id:"GAPD",segments:{217:{to_node_id:"1577008",from_node_id:"1577006",b2:null,b1:null},218:{to_node_id:"1577007",from_node_id:"1577008",b2:null,b1:null},219:{to_node_id:"1577006",from_node_id:"1576575",b2:{y:2322.5,x:1055},b1:{y:2270,x:1055}},220:{to_node_id:"1577006",from_node_id:"1576669",b2:{y:2326.9376081318114,x:1055},b1:{y:2284.7920271060384,x:1055}},221:{to_node_id:"1577006",from_node_id:"1576670",b2:{y:2330.769750529242,x:1055},b1:{y:2297.5658350974745,x:1055}},222:{to_node_id:"1576487",from_node_id:"1577007",b2:{y:2500,x:1055},b1:{y:2454.5,x:1055}},223:{to_node_id:"1576671",from_node_id:"1577007",b2:{y:2495.2079728939616,x:1055},b1:{y:2453.0623918681886,x:1055}},224:{to_node_id:"1576672",from_node_id:"1577007",b2:{y:2482.4341649025255,x:1055},b1:{y:2449.230249470758,x:1055}}},genes:[{bigg_id:"b1779",name:"gapA"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"13dpg_c"},{coefficient:-1,bigg_id:"g3p_c"},{coefficient:1,bigg_id:"nadh_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:-1,bigg_id:"pi_c"}],label_x:1065,label_y:2385,gene_reaction_rule:"b1779"},1576770:{name:"Fumarate exchange",bigg_id:"EX_fum_e",segments:{225:{to_node_id:"1577009",from_node_id:"1576657",b2:{y:560,x:2840},b1:{y:623,x:2840}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"fum_e"}],label_x:2915.057373046875,label_y:529.8175659179688,gene_reaction_rule:""},1576771:{name:"Succinate transport via proton symport  2 H ",bigg_id:"SUCCt2_2",segments:{227:{to_node_id:"1577011",from_node_id:"1577013",b2:null,b1:null},228:{to_node_id:"1577012",from_node_id:"1577011",b2:null,b1:null},229:{to_node_id:"1577013",from_node_id:"1576673",b2:{y:3027,x:4806.816653826392},b1:{y:3027,x:4832.0555127546395}},230:{to_node_id:"1577013",from_node_id:"1576531",b2:{y:3027,x:4826.039349194016},b1:{y:3027,x:4896.1311639800515}},231:{to_node_id:"1576533",from_node_id:"1577012",b2:{y:3027,x:3972.294403079054},b1:{y:3027,x:4366.8883209237165}},232:{to_node_id:"1576674",from_node_id:"1577012",b2:{y:3027,x:4486},b1:{y:3027,x:4521}}},genes:[{bigg_id:"b3528",name:"dctA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"succ_c"},{coefficient:-1,bigg_id:"succ_e"},{coefficient:2,bigg_id:"h_c"},{coefficient:-2,bigg_id:"h_e"}],label_x:4501.95703125,label_y:2997.661865234375,gene_reaction_rule:"b3528"},1576772:{name:"Glutamate dehydrogenase (NADP)",bigg_id:"GLUDy",segments:{233:{to_node_id:"1577015",from_node_id:"1577016",b2:null,b1:null},234:{to_node_id:"1577014",from_node_id:"1577015",b2:null,b1:null},235:{to_node_id:"1577016",from_node_id:"1576675",b2:{y:3632,x:4133.6977705423415},b1:{y:3632,x:4170.325901807804}},236:{to_node_id:"1577016",from_node_id:"1576554",b2:{y:3632,x:4137.5},b1:{y:3632,x:4183}},237:{to_node_id:"1577016",from_node_id:"1576676",b2:{y:3632,x:4129.669190203266},b1:{y:3632,x:4156.897300677553}},238:{to_node_id:"1576677",from_node_id:"1577014",b2:{y:3632,x:4021.2725815852687},b1:{y:3632,x:4060.9817744755806}},239:{to_node_id:"1576678",from_node_id:"1577014",b2:{y:3632,x:4000.5855310681522},b1:{y:3632,x:4054.775659320446}},240:{to_node_id:"1576509",from_node_id:"1577014",b2:{y:3632,x:3911.98117576612},b1:{y:3632,x:4028.194352729836}},241:{to_node_id:"1576679",from_node_id:"1577014",b2:{y:3632,x:4036.853918777118},b1:{y:3632,x:4065.6561756331353}}},genes:[{bigg_id:"b1761",name:"gdhA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"glu__L_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:1,bigg_id:"nh4_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"nadph_c"},{coefficient:1,bigg_id:"akg_c"},{coefficient:-1,bigg_id:"h2o_c"}],label_x:4025.81298828125,label_y:3671.95703125,gene_reaction_rule:"b1761"},1576773:{name:"ATP synthase (four protons for one ATP)",bigg_id:"ATPS4r",segments:{242:{to_node_id:"1577019",from_node_id:"1577017",b2:null,b1:null},243:{to_node_id:"1577018",from_node_id:"1577019",b2:null,b1:null},244:{to_node_id:"1577017",from_node_id:"1576680",b2:{y:1150,x:4729},b1:{y:1150,x:4785}},245:{to_node_id:"1577017",from_node_id:"1576681",b2:{y:1150,x:4746.487950057818},b1:{y:1332.100830078125,x:4877.134963734394}},246:{to_node_id:"1577017",from_node_id:"1576536",b2:{y:1150,x:4796.204440681362},b1:{y:1523.8707275390625,x:4965.504060083706}},247:{to_node_id:"1576682",from_node_id:"1577018",b2:{y:1150,x:4520},b1:{y:1148.3885498046875,x:4558.046875}},248:{to_node_id:"1576683",from_node_id:"1577018",b2:{y:1150,x:4542.7265625},b1:{y:1148.388427734375,x:4575.66162109375}},249:{to_node_id:"1576534",from_node_id:"1577018",b2:{y:1043.64013671875,x:4324.116846450839},b1:{y:1148.3885498046875,x:4366.332368388376}}},genes:[{bigg_id:"b3731",name:"atpC"},{bigg_id:"b3738",name:"atpB"},{bigg_id:"b3733",name:"atpG"},{bigg_id:"b3739",name:"atpI"},{bigg_id:"b3734",name:"atpA"},{bigg_id:"b3736",name:"atpF"},{bigg_id:"b3737",name:"atpE"},{bigg_id:"b3735",name:"atpH"},{bigg_id:"b3732",name:"atpD"}],reversibility:!0,metabolites:[{coefficient:-4,bigg_id:"h_e"},{coefficient:1,bigg_id:"atp_c"},{coefficient:3,bigg_id:"h_c"},{coefficient:-1,bigg_id:"adp_c"},{coefficient:-1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"h2o_c"}],label_x:4558.97119140625,label_y:1122.273193359375,gene_reaction_rule:"((b3736 and b3737 and b3738) and (b3731 and b3732 and b3733 and b3734 and b3735)) or ((b3736 and b3737 and b3738) and (b3731 and b3732 and b3733 and b3734 and b3735) and b3739)"},1576774:{name:"Citrate synthase",bigg_id:"CS",segments:{250:{to_node_id:"1577022",from_node_id:"1577020",b2:null,b1:null},251:{to_node_id:"1577021",from_node_id:"1577022",b2:null,b1:null},252:{to_node_id:"1577020",from_node_id:"1576514",b2:{y:3745.4027250468985,x:2627.479742988546},b1:{y:3679.773731927161,x:1727.7705707040077}},253:{to_node_id:"1577020",from_node_id:"1576684",b2:{y:3823.2954829227556,x:2728.8970628128327},b1:{y:3791.3182764091857,x:2693.656876042776}},254:{to_node_id:"1577020",from_node_id:"1576521",b2:{y:3822.7470798256522,x:2728.292700216025},b1:{y:3789.4902660855073,x:2691.642334053416}},255:{to_node_id:"1576685",from_node_id:"1577021",b2:{y:3962.7252091426644,x:2898.7018369997472},b1:{y:3931.4175627427994,x:2857.610551099924}},256:{to_node_id:"1576686",from_node_id:"1577021",b2:{y:3971.425553937104,x:2910.1210395424487},b1:{y:3934.0276661811313,x:2861.0363118627347}},257:{to_node_id:"1576687",from_node_id:"1577021",b2:{y:3980.7262047116856,x:2922.328143684087},b1:{y:3936.817861413506,x:2864.698443105226}}},genes:[{bigg_id:"b0720",name:"gltA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"coa_c"},{coefficient:-1,bigg_id:"oaa_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"cit_c"},{coefficient:-1,bigg_id:"accoa_c"},{coefficient:-1,bigg_id:"h2o_c"}],label_x:2808,label_y:3876,gene_reaction_rule:"b0720"},1576775:{name:"Pyruvate transport in via proton symport",bigg_id:"PYRt2",segments:{258:{to_node_id:"1577025",from_node_id:"1577023",b2:null,b1:null},259:{to_node_id:"1577024",from_node_id:"1577025",b2:null,b1:null},260:{to_node_id:"1577023",from_node_id:"1576688",b2:{y:3945,x:359.3395402366342},b1:{y:3945,x:322.7984674554473}},261:{to_node_id:"1577023",from_node_id:"1576557",b2:{y:3945,x:360},b1:{y:3945,x:325}},262:{to_node_id:"1576511",from_node_id:"1577024",b2:{y:3945,x:850},b1:{y:3945,x:706.5}},263:{to_node_id:"1576689",from_node_id:"1577024",b2:{y:3945,x:697.2015325445527},b1:{y:3945,x:660.6604597633658}}},genes:[],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"pyr_e"},{coefficient:-1,bigg_id:"h_e"}],label_x:462.6368408203125,label_y:3908.02490234375,gene_reaction_rule:""},1576776:{name:"Malic enzyme (NADP)",bigg_id:"ME2",segments:{264:{to_node_id:"1577026",from_node_id:"1577028",b2:null,b1:null},265:{to_node_id:"1577027",from_node_id:"1577026",b2:null,b1:null},266:{to_node_id:"1577028",from_node_id:"1576690",b2:{y:3350.7069760509485,x:2325.4883732484195},b1:{y:3329.0232535031614,x:2361.6279108280646}},267:{to_node_id:"1577028",from_node_id:"1576504",b2:{y:3332.720745600581,x:2355.4654239990323},b1:{y:3269.069152001936,x:2461.551413330107}},268:{to_node_id:"1576691",from_node_id:"1577027",b2:{y:3434.0831891575845,x:2171.8336216848306},b1:{y:3417.2249567472754,x:2205.550086505449}},269:{to_node_id:"1576511",from_node_id:"1577027",b2:{y:3895.002675936253,x:1164.309223322806},b1:{y:3495.997238327751,x:2048.005523344498}},270:{to_node_id:"1576692",from_node_id:"1577027",b2:{y:3439.4108823397055,x:2161.178235320589},b1:{y:3418.8232647019117,x:2202.3534705961765}}},genes:[{bigg_id:"b2463",name:"maeB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"pyr_c"},{coefficient:-1,bigg_id:"mal__L_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:1,bigg_id:"nadph_c"}],label_x:2281.107177734375,label_y:3432.36328125,gene_reaction_rule:"b2463"},1576777:{name:"Formate exchange",bigg_id:"EX_for_e",segments:{271:{to_node_id:"1577030",from_node_id:"1576666",b2:{y:4884.95458984375,x:1460},b1:{y:4885.96044921875,x:1461.5867919921875}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"for_e"}],label_x:1476.3470458984375,label_y:4913.4130859375,gene_reaction_rule:""},1577490:{name:"Acetaldehyde dehydrogenase (acetylating)",bigg_id:"ACALD",segments:{273:{to_node_id:"1577032",from_node_id:"1577031",b2:null,b1:null},274:{to_node_id:"1577033",from_node_id:"1577032",b2:null,b1:null},275:{to_node_id:"1577031",from_node_id:"1576817",b2:{y:3945,x:2065.5},b1:{y:3945,x:2125}},276:{to_node_id:"1577031",from_node_id:"1576825",b2:{y:3945,x:2058.56912760471},b1:{y:3945,x:2101.8970920157}},277:{to_node_id:"1577031",from_node_id:"1576828",b2:{y:3945,x:2053.52081728299},b1:{y:3945,x:2085.0693909433}},278:{to_node_id:"1576514",from_node_id:"1577033",b2:{y:3945,x:1847.5},b1:{y:3945,x:1940.25}},279:{to_node_id:"1576832",from_node_id:"1577033",b2:{y:3945,x:1934.9306090567002},b1:{y:3945,x:1966.47918271701}},280:{to_node_id:"1576812",from_node_id:"1577033",b2:{y:3945,x:1918.1029079843004},b1:{y:3945,x:1961.4308723952902}}},genes:[{bigg_id:"b1241",name:"adhE"},{bigg_id:"b0351",name:"mhpF"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"nadh_c"},{coefficient:-1,bigg_id:"coa_c"},{coefficient:-1,bigg_id:"acald_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"accoa_c"}],label_x:1939.0750732421875,label_y:3998.470458984375,gene_reaction_rule:"b0351 or b1241"},1577497:{name:"Acetaldehyde reversible transport",bigg_id:"ACALDt",segments:{281:{to_node_id:"1577034",from_node_id:"1576815",b2:{y:4707,x:2210},b1:{y:4796.55283203125,x:2210}},282:{to_node_id:"1576817",from_node_id:"1577034",b2:{y:4257.5,x:2210},b1:{y:4476.25,x:2210}}},genes:[{bigg_id:"s0001",name:"None"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"acald_c"},{coefficient:-1,bigg_id:"acald_e"}],label_x:2248.561767578125,label_y:4579.041015625,gene_reaction_rule:"s0001"},1577498:{name:"Acetaldehyde exchange",bigg_id:"EX_acald_e",segments:{283:{to_node_id:"1577035",from_node_id:"1576815",b2:{y:4894,x:2210.5},b1:{y:4889.1484375,x:2210.15}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"acald_e"}],label_x:2227.346923828125,label_y:4922.892578125,gene_reaction_rule:""},1577507:{name:"Alcohol dehydrogenase (ethanol)",bigg_id:"ALCD2x",segments:{2:{to_node_id:"1577042",from_node_id:"1577041",b2:null,b1:null},3:{to_node_id:"1577043",from_node_id:"1577042",b2:null,b1:null},4:{to_node_id:"1577041",from_node_id:"1576829",b2:{y:4118.6722220553565,x:2391.0059522021684},b1:{y:4162.240740184523,x:2437.6865073405606}},5:{to_node_id:"1577041",from_node_id:"1576822",b2:{y:4111.911975251582,x:2383.7628306266947},b1:{y:4139.7065841719395,x:2413.5427687556494}},6:{to_node_id:"1576817",from_node_id:"1577043",b2:{y:4004.2974661013272,x:2279.744301694572},b1:{y:4050.989239830398,x:2323.3232905083714}},7:{to_node_id:"1576813",from_node_id:"1577043",b2:{y:4033.046682944248,x:2306.576904081298},b1:{y:4059.6140048832744,x:2331.3730712243896}},8:{to_node_id:"1576824",from_node_id:"1577043",b2:{y:4021.1795086945217,x:2295.5008747815536},b1:{y:4056.0538526083565,x:2328.0502624344663}}},genes:[{bigg_id:"b1241",name:"adhE"},{bigg_id:"b0356",name:"frmA"},{bigg_id:"b1478",name:"adhP"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"acald_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"nadh_c"},{coefficient:-1,bigg_id:"etoh_c"}],label_x:2356.4794921875,label_y:4047.4384765625,gene_reaction_rule:"b0356 or b1478 or b1241"},1577514:{name:"Formate transport in via proton symport",bigg_id:"FORt2",segments:{9:{to_node_id:"1577045",from_node_id:"1577044",b2:null,b1:null},10:{to_node_id:"1577046",from_node_id:"1577045",b2:null,b1:null},11:{to_node_id:"1577044",from_node_id:"1576666",b2:{y:4749.209372712298,x:1360},b1:{y:4827.353507999329,x:1360}},12:{to_node_id:"1577044",from_node_id:"1576833",b2:{y:4744.773286702694,x:1360},b1:{y:4779.244289008981,x:1360}},13:{to_node_id:"1576590",from_node_id:"1577046",b2:{y:4275.94781629675,x:1360},b1:{y:4411.784344889025,x:1360}},14:{to_node_id:"1576811",from_node_id:"1577046",b2:{y:4422.5658350974745,x:1360},b1:{y:4455.769750529243,x:1360}}},genes:[{bigg_id:"b2492",name:"focB"},{bigg_id:"b0904",name:"focA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"for_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"for_c"},{coefficient:-1,bigg_id:"h_e"}],label_x:1255.7530517578125,label_y:4574.13232421875,gene_reaction_rule:"b0904 or b2492"},1577518:{name:"Formate transport via diffusion",bigg_id:"FORti",segments:{15:{to_node_id:"1577047",from_node_id:"1576590",b2:{y:4263.5,x:1460},b1:{y:4145.55,x:1460}},16:{to_node_id:"1576666",from_node_id:"1577047",b2:{y:4654.322265625,x:1460},b1:{y:4488.7,x:1460}}},genes:[{bigg_id:"b2492",name:"focB"},{bigg_id:"b0904",name:"focA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"for_e"},{coefficient:-1,bigg_id:"for_c"}],label_x:1479.5206298828125,label_y:4509.27197265625,gene_reaction_rule:"b0904 or b2492"},1577520:{name:"Fumarate reductase",bigg_id:"FRD7",segments:{17:{to_node_id:"1577049",from_node_id:"1577048",b2:null,b1:null},18:{to_node_id:"1577050",from_node_id:"1577049",b2:null,b1:null},19:{to_node_id:"1577048",from_node_id:"1576503",b2:{y:2600,x:3020.2689151278832},b1:{y:2600,x:2880.896383759611}},20:{to_node_id:"1577048",from_node_id:"1576830",b2:{y:2600,x:3057.152680682408},b1:{y:2600,x:3003.842268941361}},21:{to_node_id:"1576814",from_node_id:"1577050",b2:{y:2600,x:3213.824115301167},b1:{y:2600,x:3162.14723459035}},22:{to_node_id:"1576533",from_node_id:"1577050",b2:{y:2600,x:3333.4483135103533},b1:{y:2600,x:3198.034494053106}}},genes:[{bigg_id:"b4152",name:"frdC"},{bigg_id:"b4151",name:"frdD"},{bigg_id:"b4154",name:"frdA"},{bigg_id:"b4153",name:"frdB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"succ_c"},{coefficient:-1,bigg_id:"fum_c"},{coefficient:1,bigg_id:"q8_c"},{coefficient:-1,bigg_id:"q8h2_c"}],label_x:3078.744384765625,label_y:2572.54541015625,gene_reaction_rule:"b4151 and b4152 and b4153 and b4154"},1577524:{name:"Fructose transport via PEPPyr PTS  f6p generating ",bigg_id:"FRUpts2",segments:{23:{to_node_id:"1577052",from_node_id:"1577051",b2:null,b1:null},24:{to_node_id:"1577053",from_node_id:"1577052",b2:null,b1:null},25:{to_node_id:"1577051",from_node_id:"1576826",b2:{y:1361.5867919921875,x:526.550048828125},b1:{y:1360,x:465}},26:{to_node_id:"1577051",from_node_id:"1576819",b2:{y:1360,x:396.1378949970459},b1:{y:1452.0322265625,x:400.008457770101}},27:{to_node_id:"1576525",from_node_id:"1577053",b2:{y:1361.586669921875,x:917.1118252292455},b1:{y:1363.1734619140625,x:860.370260215258}},28:{to_node_id:"1576821",from_node_id:"1577053",b2:{y:1240.992919921875,x:861.106575008484},b1:{y:1364.76025390625,x:861.4990623462952}}},genes:[{bigg_id:"b1819",name:"manZ"},{bigg_id:"b1817",name:"manX"},{bigg_id:"b2415",name:"ptsH"},{bigg_id:"b2416",name:"ptsI"},{bigg_id:"b1818",name:"manY"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pep_c"},{coefficient:1,bigg_id:"f6p_c"},{coefficient:-1,bigg_id:"fru_e"},{coefficient:1,bigg_id:"pyr_c"}],label_x:456.41497802734375,label_y:1327.7852783203125,gene_reaction_rule:"b1817 and b1818 and b1819 and b2415 and b2416"},1577529:{name:"D-Fructose exchange",bigg_id:"EX_fru_e",segments:{29:{to_node_id:"1577054",from_node_id:"1576826",b2:{y:1360,x:241},b1:{y:1360,x:282.3}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"fru_e"}],label_x:125.35597229003906,label_y:1321.438232421875,gene_reaction_rule:""},1577532:{name:"Malate transport via proton symport  2 H ",bigg_id:"MALt2_2",segments:{31:{to_node_id:"1577057",from_node_id:"1577056",b2:null,b1:null},32:{to_node_id:"1577058",from_node_id:"1577057",b2:null,b1:null},33:{to_node_id:"1577056",from_node_id:"1576831",b2:{y:720.0576036932963,x:2610},b1:{y:682.8586789776543,x:2610}},34:{to_node_id:"1577056",from_node_id:"1576816",b2:{y:723.1,x:2610},b1:{y:693,x:2610}},35:{to_node_id:"1576810",from_node_id:"1577058",b2:{y:1032.2015325445527,x:2610},b1:{y:995.6604597633658,x:2610}},36:{to_node_id:"1576504",from_node_id:"1577058",b2:{y:2086.013675322326,x:2610},b1:{y:1311.8041025966977,x:2610}}},genes:[{bigg_id:"b3528",name:"dctA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"mal__L_c"},{coefficient:2,bigg_id:"h_c"},{coefficient:-1,bigg_id:"mal__L_e"},{coefficient:-2,bigg_id:"h_e"}],label_x:2623.173583984375,label_y:844.3793334960938,gene_reaction_rule:"b3528"},1577537:{name:"L-Malate exchange",bigg_id:"EX_mal__L_e",segments:{37:{to_node_id:"1577059",from_node_id:"1576816",b2:{y:560,x:2610},b1:{y:623,x:2610}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"mal__L_e"}],label_x:2356.597412109375,label_y:513.949951171875,gene_reaction_rule:""},1577540:{name:"NADH dehydrogenase (ubiquinone-8 & 3 protons)",bigg_id:"NADH16",segments:{39:{to_node_id:"1577062",from_node_id:"1577061",b2:null,b1:null},40:{to_node_id:"1577063",from_node_id:"1577062",b2:null,b1:null},41:{to_node_id:"1577061",from_node_id:"1576820",b2:{y:2570,x:4582},b1:{y:2570,x:4470}},42:{to_node_id:"1577061",from_node_id:"1576827",b2:{y:2570,x:4595.729021023612},b1:{y:2567.302001953125,x:4458.799047943291}},43:{to_node_id:"1577061",from_node_id:"1576539",b2:{y:2570,x:4542.513923505967},b1:{y:2375.007080078125,x:4706.342147363639}},44:{to_node_id:"1576808",from_node_id:"1577063",b2:{y:2570,x:4780},b1:{y:2568.388427734375,x:4766.45361328125}},45:{to_node_id:"1576809",from_node_id:"1577063",b2:{y:2655.409912109375,x:4928.099683314913},b1:{y:2570.000244140625,x:4798.6355690569735}},46:{to_node_id:"1576542",from_node_id:"1577063",b2:{y:2507.151123046875,x:4630.938294107013},b1:{y:2571.611572265625,x:4800.053949169604}}},genes:[{bigg_id:"b2284",name:"nuoF"},{bigg_id:"b2279",name:"nuoK"},{bigg_id:"b2287",name:"nuoB"},{bigg_id:"b2286",name:"nuoC"},{bigg_id:"b2288",name:"nuoA"},{bigg_id:"b2283",name:"nuoG"},{bigg_id:"b2277",name:"nuoM"},{bigg_id:"b2281",name:"nuoI"},{bigg_id:"b2280",name:"nuoJ"},{bigg_id:"b2276",name:"nuoN"},{bigg_id:"b2282",name:"nuoH"},{bigg_id:"b2278",name:"nuoL"},{bigg_id:"b2285",name:"nuoE"}],reversibility:!1,metabolites:[{coefficient:3,bigg_id:"h_e"},{coefficient:-1,bigg_id:"q8_c"},{coefficient:-1,bigg_id:"nadh_c"},{coefficient:1,bigg_id:"q8h2_c"},{coefficient:-4,bigg_id:"h_c"},{coefficient:1,bigg_id:"nad_c"}],label_x:4589.75537109375,label_y:2624.46044921875,gene_reaction_rule:"b2276 and b2277 and b2278 and b2279 and b2280 and b2281 and b2282 and b2283 and b2284 and b2285 and b2286 and b2287 and b2288"},1577545:{name:"Succinate dehydrogenase (irreversible)",bigg_id:"SUCDi",segments:{47:{to_node_id:"1577065",from_node_id:"1577064",b2:null,b1:null},48:{to_node_id:"1577066",from_node_id:"1577065",b2:null,b1:null},49:{to_node_id:"1577064",from_node_id:"1576814",b2:{y:2816.4590794794085,x:3193.7934732750823},b1:{y:2815.1969315980286,x:3225.9782442502737}},50:{to_node_id:"1577064",from_node_id:"1576533",b2:{y:2815.5590310361767,x:3216.7447085774984},b1:{y:2812.1967701205886,x:3302.482361924995}},51:{to_node_id:"1576503",from_node_id:"1577066",b2:{y:2843.2084583195547,x:2952.624089386102},b1:{y:2831.162537495866,x:3040.3872268158307}},52:{to_node_id:"1576830",from_node_id:"1577066",b2:{y:2833.0526323200284,x:3026.6165359540787},b1:{y:2828.1157896960085,x:3062.5849607862237}}},genes:[{bigg_id:"b0724",name:"sdhB"},{bigg_id:"b0721",name:"sdhC"},{bigg_id:"b0722",name:"sdhD"},{bigg_id:"b0723",name:"sdhA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"succ_c"},{coefficient:1,bigg_id:"fum_c"},{coefficient:-1,bigg_id:"q8_c"},{coefficient:1,bigg_id:"q8h2_c"}],label_x:3108.851318359375,label_y:2862.949951171875,gene_reaction_rule:"b0721 and b0722 and b0723 and b0724"},1577546:{name:"D lactate transport via proton symport",bigg_id:"D_LACt2",segments:{476:{to_node_id:"1577068",from_node_id:"1577067",b2:null,b1:null},477:{to_node_id:"1577068",from_node_id:"1577069",b2:null,b1:null},478:{to_node_id:"1576556",from_node_id:"1577067",b2:{y:4736.89501953125,x:1054.9998779296875},b1:{y:4692.98193359375,x:1055}},479:{to_node_id:"1577071",from_node_id:"1577067",b2:{y:4715.98193359375,x:1076},b1:{y:4696.98193359375,x:1055}},480:{to_node_id:"1576584",from_node_id:"1577069",b2:{y:4413.36767578125,x:1055},b1:{y:4474.7353515625,x:1053.4132080078125}},481:{to_node_id:"1577072",from_node_id:"1577069",b2:{y:4451.7353515625,x:1074.4132080078125},b1:{y:4470.7353515625,x:1053.4132080078125}}},genes:[{bigg_id:"b3603",name:"lldP"},{bigg_id:"b2975",name:"glcA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"lac__D_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"lac__D_c"},{coefficient:-1,bigg_id:"h_e"}],label_x:1078.65283203125,label_y:4609.72607421875,gene_reaction_rule:"b2975 or b3603"},1577547:{name:"Biomass Objective Function with GAM",bigg_id:"BIOMASS_Ecoli_core_w_GAM",segments:{482:{to_node_id:"1577075",from_node_id:"1577074",b2:null,b1:null},483:{to_node_id:"1577075",from_node_id:"1577076",b2:null,b1:null},484:{to_node_id:"1577073",from_node_id:"1577074",b2:{y:4573.30322265625,x:5455.328125},b1:{y:4685.48193359375,x:5334.0517578125}},485:{to_node_id:"1577077",from_node_id:"1577076",b2:{y:4926.6220703125,x:5391.197265625},b1:{y:4793.48193359375,x:5334.0517578125}},486:{to_node_id:"1577078",from_node_id:"1577074",b2:{y:4630.19921875,x:5427.28515625},b1:{y:4681.48193359375,x:5334.0517578125}},487:{to_node_id:"1577079",from_node_id:"1577074",b2:{y:4516.16943359375,x:5423.4208984375},b1:{y:4681.48193359375,x:5334.0517578125}},488:{to_node_id:"1577080",from_node_id:"1577074",b2:{y:4453.01611328125,x:5350.98828125},b1:{y:4681.48193359375,x:5334.0517578125}},489:{to_node_id:"1577081",from_node_id:"1577076",b2:{y:5001.37158203125,x:5337.27587890625},b1:{y:4793.48193359375,x:5334.0517578125}},490:{to_node_id:"1577082",from_node_id:"1577074",b2:{y:4413.09912109375,x:5307.541015625},b1:{y:4681.48193359375,x:5334.0517578125}},491:{to_node_id:"1577083",from_node_id:"1577074",b2:{y:4523.05615234375,x:5316.9716796875},b1:{y:4681.48193359375,x:5334.0517578125}},492:{to_node_id:"1577084",from_node_id:"1577074",b2:{y:4533.61865234375,x:5258.0712890625},b1:{y:4681.48193359375,x:5334.0517578125}},493:{to_node_id:"1577085",from_node_id:"1577074",b2:{y:4544.18115234375,x:5197.05859375},b1:{y:4681.48193359375,x:5334.0517578125}},494:{to_node_id:"1577086",from_node_id:"1577074",b2:{y:4564.25048828125,x:5140.27099609375},b1:{y:4681.48193359375,x:5334.0517578125}},495:{to_node_id:"1577087",from_node_id:"1577076",b2:{y:4938.26416015625,x:5273.55517578125},b1:{y:4793.48193359375,x:5334.0517578125}},496:{to_node_id:"1577088",from_node_id:"1577074",b2:{y:4579.03759765625,x:5068.69580078125},b1:{y:4681.48193359375,x:5334.0517578125}},497:{to_node_id:"1577089",from_node_id:"1577074",b2:{y:4594.88134765625,x:5023.52734375},b1:{y:4681.48193359375,x:5334.0517578125}},498:{to_node_id:"1577090",from_node_id:"1577076",b2:{y:4899.2412109375,x:5215.0458984375},b1:{y:4793.48193359375,x:5334.0517578125}},499:{to_node_id:"1577091",from_node_id:"1577076",b2:{y:4977.43115234375,x:5353.5947265625},b1:{y:4789.48193359375,x:5334.0517578125}},500:{to_node_id:"1577092",from_node_id:"1577074",b2:{y:4611.78173828125,x:4962.51416015625},b1:{y:4681.48193359375,x:5334.0517578125}},501:{to_node_id:"1577093",from_node_id:"1577074",b2:{y:4637.1318359375,x:4907.83935546875},b1:{y:4681.48193359375,x:5334.0517578125}},502:{to_node_id:"1577094",from_node_id:"1577074",b2:{y:4664.59423828125,x:4851.0517578125},b1:{y:4681.48193359375,x:5334.0517578125}},503:{to_node_id:"1577095",from_node_id:"1577074",b2:{y:4685.7197265625,x:4807.9951171875},b1:{y:4681.48193359375,x:5334.0517578125}},504:{to_node_id:"1577096",from_node_id:"1577076",b2:{y:4868.333984375,x:5114.79541015625},b1:{y:4793.48193359375,x:5334.0517578125}},505:{to_node_id:"1577097",from_node_id:"1577074",b2:{y:4717.4072265625,x:4780.78271484375},b1:{y:4681.48193359375,x:5334.0517578125}},506:{to_node_id:"1577098",from_node_id:"1577076",b2:{y:4820.185546875,x:5099.533203125},b1:{y:4793.48193359375,x:5334.0517578125}}},genes:[],reversibility:!1,metabolites:[{coefficient:3.7478,bigg_id:"coa_c"},{coefficient:-.8977,bigg_id:"r5p_c"},{coefficient:-1.496,bigg_id:"3pg_c"},{coefficient:-.361,bigg_id:"e4p_c"},{coefficient:-.2557,bigg_id:"gln__L_c"},{coefficient:3.547,bigg_id:"nadh_c"},{coefficient:-2.8328,bigg_id:"pyr_c"},{coefficient:-.0709,bigg_id:"f6p_c"},{coefficient:-13.0279,bigg_id:"nadph_c"},{coefficient:-3.7478,bigg_id:"accoa_c"},{coefficient:-1.7867,bigg_id:"oaa_c"},{coefficient:-.129,bigg_id:"g3p_c"},{coefficient:-3.547,bigg_id:"nad_c"},{coefficient:59.81,bigg_id:"pi_c"},{coefficient:-.205,bigg_id:"g6p_c"},{coefficient:4.1182,bigg_id:"akg_c"},{coefficient:-.5191,bigg_id:"pep_c"},{coefficient:-4.9414,bigg_id:"glu__L_c"},{coefficient:-59.81,bigg_id:"atp_c"},{coefficient:59.81,bigg_id:"adp_c"},{coefficient:59.81,bigg_id:"h_c"},{coefficient:-59.81,bigg_id:"h2o_c"},{coefficient:13.0279,bigg_id:"nadp_c"}],label_x:5392.94580078125,label_y:4746.6962890625,gene_reaction_rule:""},1577548:{name:"Aconitase (half-reaction A, Citrate hydro-lyase)",bigg_id:"ACONTa",segments:{507:{to_node_id:"1577100",from_node_id:"1577099",b2:null,b1:null},508:{to_node_id:"1577100",from_node_id:"1577101",b2:null,b1:null},509:{to_node_id:"1577102",from_node_id:"1577101",b2:{y:3993.9154608910203,x:3112.4765239553985},b1:{y:4044.558477078102,x:3125.4142208172407}},510:{to_node_id:"1577103",from_node_id:"1577101",b2:{y:4045.94073519232,x:3126.6630443215304},b1:{y:4044.2013827305695,x:3108.646756937047}},511:{to_node_id:"1576685",from_node_id:"1577099",b2:{y:4010.3555557486548,x:3025.1432055426353},b1:{y:4012.0956406322803,x:3025.7810749583687}}},genes:[{bigg_id:"b0118",name:"acnB"},{bigg_id:"b1276",name:"acnA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"cit_c"},{coefficient:1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"acon_C_c"}],label_x:2982.991259697708,label_y:4088.6436288689247,gene_reaction_rule:"b0118 or b1276"},1577549:{name:"Aconitase (half-reaction B, Isocitrate hydro-lyase)",bigg_id:"ACONTb",segments:{512:{to_node_id:"1577105",from_node_id:"1577104",b2:null,b1:null},513:{to_node_id:"1577105",from_node_id:"1577106",b2:null,b1:null},514:{to_node_id:"1577102",from_node_id:"1577104",
b2:{y:3991.5491179659602,x:3266.0226278968735},b1:{y:4044.360816430351,x:3261.354277099013}},515:{to_node_id:"1576505",from_node_id:"1577106",b2:{y:4013.1918298584474,x:3345.4226198631072},b1:{y:4014.8024620364417,x:3344.105236291347}},516:{to_node_id:"1577103",from_node_id:"1577104",b2:{y:4046.222560627323,x:3260.813883986344},b1:{y:4046.056264386829,x:3262.862957011229}}},genes:[{bigg_id:"b1276",name:"acnA"},{bigg_id:"b0118",name:"acnB"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"icit_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"acon_C_c"}],label_x:3291.833217745038,label_y:4081.35343547726,gene_reaction_rule:"b0118 or b1276"}},nodes:{1576485:{node_is_primary:!1,name:"ATP",label_x:1165,node_type:"metabolite",y:2805,x:1145,bigg_id:"atp_c",label_y:2805},1576486:{node_is_primary:!0,name:"3-Phospho-D-glycerate",label_x:1085,node_type:"metabolite",y:2875,x:1055,bigg_id:"3pg_c",label_y:2875},1576487:{node_is_primary:!0,name:"3-Phospho-D-glyceroyl phosphate",label_x:1085,node_type:"metabolite",y:2565,x:1055,bigg_id:"13dpg_c",label_y:2565},1576488:{node_is_primary:!1,name:"ADP",label_x:1165,node_type:"metabolite",y:2635,x:1145,bigg_id:"adp_c",label_y:2635},1576489:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:1907,node_type:"metabolite",y:1165,x:1907,bigg_id:"nadp_c",label_y:1145},1576490:{node_is_primary:!0,name:"6-Phospho-D-gluconate",label_x:1800.0250244140625,node_type:"metabolite",y:1265,x:1827,bigg_id:"6pgc_c",label_y:1235},1576491:{node_is_primary:!1,name:"CO2",label_x:2007,node_type:"metabolite",y:1165,x:2007,bigg_id:"co2_c",label_y:1145},1576492:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:2080,node_type:"metabolite",y:1165,x:2057,bigg_id:"nadph_c",label_y:1140},1576493:{node_is_primary:!0,name:"D-Ribulose 5-phosphate",label_x:2155,node_type:"metabolite",y:1265,x:2155,bigg_id:"ru5p__D_c",label_y:1235},1576494:{node_is_primary:!0,name:"O2",label_x:4840.3310546875,node_type:"metabolite",y:1660,x:4850,bigg_id:"o2_e",label_y:1702.89208984375},1576495:{node_is_primary:!0,name:"O2",label_x:4259.09326171875,node_type:"metabolite",y:1660,x:4330,bigg_id:"o2_c",label_y:1677.4388427734375},1576496:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide phosphate",label_x:3330,node_type:"metabolite",y:1270,x:3330,bigg_id:"nadp_c",label_y:1310},1576497:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide - reduced",label_x:3450,node_type:"metabolite",y:1120,x:3420,bigg_id:"nadh_c",label_y:1150},1576498:{node_is_primary:!1,name:"H+",label_x:3529.338134765625,node_type:"metabolite",y:650,x:3510,bigg_id:"h_e",label_y:639.6690673828125},1576499:{node_is_primary:!1,name:"H+",label_x:3522.892333984375,node_type:"metabolite",y:1080.287841796875,x:3510,bigg_id:"h_c",label_y:1099.0072021484375},1576500:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:3740,node_type:"metabolite",y:1270,x:3740,bigg_id:"nadph_c",label_y:1310},1576501:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide",label_x:3556.820068359375,node_type:"metabolite",y:1147.3958740234375,x:3625.7841796875,bigg_id:"nad_c",label_y:1187.06494140625},1576502:{node_is_primary:!1,name:"H2O",label_x:2693.4130859375,node_type:"metabolite",y:2921,x:2715,bigg_id:"h2o_c",label_y:2896.71923828125},1576503:{node_is_primary:!0,name:"Fumarate",label_x:2867.189453125,node_type:"metabolite",y:2920,x:2843,bigg_id:"fum_c",label_y:2939.602783203125},1576504:{node_is_primary:!0,name:"L-Malate",label_x:2506.83544921875,node_type:"metabolite",y:3192,x:2621,bigg_id:"mal__L_c",label_y:3174.826416015625},1576505:{node_is_primary:!0,name:"Isocitrate",label_x:3344.32373046875,node_type:"metabolite",y:3976,x:3413,bigg_id:"icit_c",label_y:3949.222900390625},1576506:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:3495,node_type:"metabolite",y:4065,x:3495,bigg_id:"nadp_c",label_y:4098},1576507:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:3557.6474609375,node_type:"metabolite",y:3660,x:3659,bigg_id:"nadph_c",label_y:3655.388427734375},1576508:{node_is_primary:!1,name:"CO2",label_x:3539.820068359375,node_type:"metabolite",y:3710,x:3620,bigg_id:"co2_c",label_y:3711.611572265625},1576509:{node_is_primary:!0,name:"2-Oxoglutarate",label_x:3669.712158203125,node_type:"metabolite",y:3627,x:3746,bigg_id:"akg_c",label_y:3611.942626953125},1576510:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:1394.189697265625,node_type:"metabolite",y:3855,x:1365,bigg_id:"nad_c",label_y:3851.826416015625},1576511:{node_is_primary:!0,name:"Pyruvate",label_x:1025,node_type:"metabolite",y:3945,x:1055,bigg_id:"pyr_c",label_y:3965},1576512:{node_is_primary:!1,name:"Coenzyme A",label_x:1287.066162109375,node_type:"metabolite",y:3905,x:1315,bigg_id:"coa_c",label_y:3887.545654296875},1576513:{node_is_primary:!1,name:"CO2",label_x:1595,node_type:"metabolite",y:3855,x:1605,bigg_id:"co2_c",label_y:3835},1576514:{node_is_primary:!0,name:"Acetyl-CoA",label_x:1695,node_type:"metabolite",y:3945,x:1715,bigg_id:"accoa_c",label_y:3965},1576515:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:1647.545654296875,node_type:"metabolite",y:3885,x:1655,bigg_id:"nadh_c",label_y:3855.4794921875},1576516:{node_is_primary:!1,name:"H2O",label_x:1315,node_type:"metabolite",y:3375,x:1295,bigg_id:"h2o_c",label_y:3375},1576517:{node_is_primary:!0,name:"Phosphoenolpyruvate",label_x:1085,node_type:"metabolite",y:3375,x:1055,bigg_id:"pep_c",label_y:3355},1576518:{node_is_primary:!1,name:"CO2",label_x:1215,node_type:"metabolite",y:3345,x:1205,bigg_id:"co2_c",label_y:3325},1576519:{node_is_primary:!1,name:"H+",label_x:1635,node_type:"metabolite",y:3475,x:1615,bigg_id:"h_c",label_y:3475},1576520:{node_is_primary:!1,name:"Phosphate",label_x:1685,node_type:"metabolite",y:3515,x:1665,bigg_id:"pi_c",label_y:3515},1576521:{node_is_primary:!0,name:"Oxaloacetate",label_x:2692,node_type:"metabolite",y:3724,x:2659,bigg_id:"oaa_c",label_y:3724},1576522:{node_is_primary:!0,name:"D-Glycerate 2-phosphate",label_x:1093,node_type:"metabolite",y:3125,x:1055,bigg_id:"2pg_c",label_y:3125},1576523:{node_is_primary:!1,name:"H2O",label_x:886.289794921875,node_type:"metabolite",y:3325,x:965,bigg_id:"h2o_c",label_y:3307.958740234375},1576524:{node_is_primary:!0,name:"D-Glucose 6-phosphate",label_x:1075,node_type:"metabolite",y:1265,x:1055,bigg_id:"g6p_c",label_y:1245},1576525:{node_is_primary:!0,name:"D-Fructose 6-phosphate",label_x:1075,node_type:"metabolite",y:1545,x:1055,bigg_id:"f6p_c",label_y:1525},1576526:{node_is_primary:!0,name:"Ammonium",label_x:4019,node_type:"metabolite",y:4757,x:3989,bigg_id:"nh4_e",label_y:4757},1576527:{node_is_primary:!0,name:"Ammonium",label_x:4019,node_type:"metabolite",y:4441,x:3989,bigg_id:"nh4_c",label_y:4441},1576528:{node_is_primary:!1,name:"H2O",label_x:672.9427490234375,node_type:"metabolite",y:1855,x:765,bigg_id:"h2o_c",label_y:1861.3470458984375},1576529:{node_is_primary:!0,name:"D-Fructose 1,6-bisphosphate",label_x:1096.404296875,node_type:"metabolite",y:1925,x:1055,bigg_id:"fdp_c",label_y:1928.173583984375},1576530:{node_is_primary:!1,name:"Phosphate",label_x:686.744140625,node_type:"metabolite",y:1565,x:755,bigg_id:"pi_c",label_y:1563.4132080078125},1576531:{node_is_primary:!0,name:"Succinate",label_x:4950.4462890625,node_type:"metabolite",y:2880,x:4932,bigg_id:"succ_e",label_y:2915.280517578125},1576532:{node_is_primary:!0,name:"Glyoxylate",label_x:3211.3271484375,node_type:"metabolite",y:3570,x:3180,bigg_id:"glx_c",label_y:3543.267578125},1576533:{node_is_primary:!0,name:"Succinate",label_x:3439.01611328125,node_type:"metabolite",y:2867,x:3420,bigg_id:"succ_c",label_y:2838.810302734375},1576534:{node_is_primary:!0,name:"ATP",label_x:4215,node_type:"metabolite",y:1040,x:4215,bigg_id:"atp_c",label_y:1010},1576535:{node_is_primary:!0,name:"AMP",label_x:4033.388427734375,node_type:"metabolite",y:1070,x:4065,bigg_id:"amp_c",label_y:1030.661865234375},1576536:{node_is_primary:!0,name:"ADP",label_x:4196.611328125,node_type:"metabolite",y:1510,x:4215,bigg_id:"adp_c",label_y:1556.1151123046875},1576537:{node_is_primary:!0,name:"L-Glutamine",label_x:4851.38134765625,node_type:"metabolite",y:4158,x:4882,bigg_id:"gln__L_e",label_y:4199.2802734375},1576539:{node_is_primary:!0,name:"Ubiquinone-8",label_x:4686.61181640625,node_type:"metabolite",y:2215.0361328125,x:4758.67626953125,bigg_id:"q8_c",label_y:2192.47509765625},1576542:{node_is_primary:!0,name:"Ubiquinol-8",label_x:4411.00048828125,node_type:"metabolite",y:2210.3310546875,x:4508.47509765625,bigg_id:"q8h2_c",label_y:2217.395751953125},1576544:{node_is_primary:!0,name:"CO2",label_x:3651,node_type:"metabolite",y:4754,x:3621,bigg_id:"co2_e",label_y:4754},1576545:{node_is_primary:!0,name:"Glyceraldehyde 3-phosphate",label_x:2375.091552734375,node_type:"metabolite",y:1865,x:2358.984130859375,bigg_id:"g3p_c",label_y:1898.4132080078125},1576546:{node_is_primary:!0,name:"Sedoheptulose 7-phosphate",label_x:1955.8675537109375,node_type:"metabolite",y:1865,x:1983.082275390625,bigg_id:"s7p_c",label_y:1814.314697265625},1576547:{node_is_primary:!0,name:"D-Erythrose 4-phosphate",label_x:1922.7852783203125,node_type:"metabolite",y:2190,x:1945,bigg_id:"e4p_c",label_y:2242.214599609375},1576548:{node_is_primary:!0,name:"D-Fructose 6-phosphate",label_x:2367.636962890625,node_type:"metabolite",y:2186.826416015625,x:2362.636962890625,bigg_id:"f6p_c",label_y:2216.826416015625},1576549:{node_is_primary:!1,name:"H+",label_x:911.677978515625,node_type:"metabolite",y:3625,x:965,bigg_id:"h_c",label_y:3612.305908203125},1576550:{node_is_primary:!1,name:"ADP",label_x:903.744140625,node_type:"metabolite",y:3555,x:965,bigg_id:"adp_c",label_y:3528.02490234375},1576551:{node_is_primary:!1,name:"ATP",label_x:929.1323852539062,node_type:"metabolite",y:3815,x:965,bigg_id:"atp_c",label_y:3794.372314453125},1576552:{node_is_primary:!0,name:"L-Glutamate",label_x:4883,node_type:"metabolite",y:3634,x:4883,bigg_id:"glu__L_e",label_y:3604},1576553:{node_is_primary:!1,name:"H+",label_x:4857.23046875,node_type:"metabolite",y:3703,x:4825,bigg_id:"h_e",label_y:3723},1576554:{node_is_primary:!0,name:"L-Glutamate",label_x:4221.2158203125,node_type:"metabolite",y:3632,x:4248,bigg_id:"glu__L_c",label_y:3601},1576555:{node_is_primary:!1,name:"H+",label_x:4503.1796875,node_type:"metabolite",y:3688,x:4478,bigg_id:"h_c",label_y:3696.834716796875},1576556:{node_is_primary:!0,name:"D-Lactate",label_x:1088.470458984375,node_type:"metabolite",y:4835,x:1055,bigg_id:"lac__D_e",label_y:4857.21484375},1576557:{node_is_primary:!0,name:"Pyruvate",label_x:249.61181640625,node_type:"metabolite",y:3945,x:275,bigg_id:"pyr_e",label_y:3994.041015625},1576558:{node_is_primary:!0,name:"D-Xylulose 5-phosphate",label_x:1944.76025390625,node_type:"metabolite",y:1555,x:1945,bigg_id:"xu5p__D_c",label_y:1599.5205078125},1576559:{node_is_primary:!0,name:"H+",label_x:4867.7265625,node_type:"metabolite",y:2229,x:4850,bigg_id:"h_e",label_y:2273.503662109375},1576567:{node_is_primary:!1,name:"Coenzyme A",label_x:3448.892578125,node_type:"metabolite",y:2960,x:3460,bigg_id:"coa_c",label_y:2991.107421875},1576568:{node_is_primary:!1,name:"ATP",label_x:3496.826416015625,node_type:"metabolite",y:3030,x:3500,bigg_id:"atp_c",label_y:3062.694091796875},1576569:{node_is_primary:!1,name:"Phosphate",label_x:3814,node_type:"metabolite",y:3051,x:3794,bigg_id:"pi_c",label_y:3051},1576570:{node_is_primary:!0,name:"Succinyl-CoA",label_x:3772.230712890625,node_type:"metabolite",y:3193,x:3739,bigg_id:"succoa_c",label_y:3193.479248046875},1576571:{node_is_primary:!1,name:"ADP",label_x:3788,node_type:"metabolite",y:3116,x:3768,bigg_id:"adp_c",label_y:3126},1576572:{node_is_primary:!1,name:"ATP",label_x:1165,node_type:"metabolite",y:1645,x:1145,bigg_id:"atp_c",label_y:1645},1576573:{node_is_primary:!1,name:"ADP",label_x:1165,node_type:"metabolite",y:1805,x:1145,bigg_id:"adp_c",label_y:1805},1576574:{node_is_primary:!1,name:"H+",label_x:1165,node_type:"metabolite",y:1855,x:1145,bigg_id:"h_c",label_y:1855},1576575:{node_is_primary:!0,name:"Glyceraldehyde 3-phosphate",label_x:1085,node_type:"metabolite",y:2195,x:1055,bigg_id:"g3p_c",label_y:2195},1576576:{node_is_primary:!1,name:"ATP",label_x:4474,node_type:"metabolite",y:3755,x:4440,bigg_id:"atp_c",label_y:3753},1576577:{node_is_primary:!1,name:"Ammonium",label_x:4477,node_type:"metabolite",y:3805,x:4440,bigg_id:"nh4_c",label_y:3811},1576578:{node_is_primary:!0,name:"L-Glutamine",label_x:4245,node_type:"metabolite",y:4094,x:4246,bigg_id:"gln__L_c",label_y:4130},1576579:{node_is_primary:!1,name:"ADP",label_x:4454,node_type:"metabolite",y:3954,x:4434,bigg_id:"adp_c",label_y:3954},1576580:{node_is_primary:!1,name:"H+",label_x:4454,node_type:"metabolite",y:4004,x:4434,bigg_id:"h_c",label_y:4004},1576581:{node_is_primary:!1,name:"Phosphate",label_x:4454,node_type:"metabolite",y:4054,x:4434,bigg_id:"pi_c",label_y:4054},1576584:{node_is_primary:!0,name:"D-Lactate",label_x:1089,node_type:"metabolite",y:4345,x:1055,bigg_id:"lac__D_c",label_y:4349},1576585:{node_is_primary:!1,name:"Coenzyme A",label_x:3628.99267578125,node_type:"metabolite",y:3506,x:3684,bigg_id:"coa_c",label_y:3483.05029296875},1576586:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:3606.208740234375,node_type:"metabolite",y:3558,x:3684,bigg_id:"nad_c",label_y:3539.885009765625},1576587:{node_is_primary:!1,name:"CO2",label_x:3898,node_type:"metabolite",y:3285,x:3872,bigg_id:"co2_c",label_y:3285},1576588:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:3846,node_type:"metabolite",y:3233,x:3820,bigg_id:"nadh_c",label_y:3233},1576589:{node_is_primary:!1,name:"Coenzyme A",label_x:1165,node_type:"metabolite",y:4045,x:1165,bigg_id:"coa_c",label_y:4065},1576590:{node_is_primary:!0,name:"Formate",label_x:1495.230712890625,node_type:"metabolite",y:4095,x:1460,bigg_id:"for_c",label_y:4083.958984375},1576591:{node_is_primary:!1,name:"ATP",label_x:1525,node_type:"metabolite",y:3625,x:1505,bigg_id:"atp_c",label_y:3625},1576592:{node_is_primary:!1,name:"ADP",label_x:1285,node_type:"metabolite",y:3545,x:1285,bigg_id:"adp_c",label_y:3575},1576593:{node_is_primary:!1,name:"CO2",label_x:1215,node_type:"metabolite",y:3515,x:1215,bigg_id:"co2_c",label_y:3535},1576594:{node_is_primary:!0,name:"Phosphate",label_x:2910,node_type:"metabolite",y:4839,x:2880,bigg_id:"pi_e",label_y:4839},1576595:{node_is_primary:!1,name:"H+",label_x:2733.83544921875,node_type:"metabolite",y:4778,x:2793,bigg_id:"h_e",label_y:4763.8515625},1576596:{node_is_primary:!1,name:"H+",label_x:2754.13232421875,node_type:"metabolite",y:4452,x:2793,bigg_id:"h_c",label_y:4426.61181640625},1576597:{node_is_primary:!0,name:"Phosphate",label_x:2921,node_type:"metabolite",y:4430,x:2880,bigg_id:"pi_c",label_y:4428},1576598:{node_is_primary:!0,name:"2-Oxoglutarate",label_x:4922,node_type:"metabolite",y:3228,x:4922,bigg_id:"akg_e",label_y:3268},1576599:{node_is_primary:!1,name:"H+",label_x:4861.39599609375,node_type:"metabolite",y:3321,x:4834,bigg_id:"h_e",label_y:3334.553955078125},1576600:{node_is_primary:!1,name:"H+",label_x:4490.337890625,node_type:"metabolite",y:3328,x:4472,bigg_id:"h_c",label_y:3342.330810546875},1576601:{node_is_primary:!0,name:"Dihydroxyacetone phosphate",label_x:739.3148193359375,node_type:"metabolite",y:2195,x:855,bigg_id:"dhap_c",label_y:2179.132568359375},1576602:{node_is_primary:!1,name:"H+",label_x:4234.01416015625,node_type:"metabolite",y:1895.1654052734375,x:4301.69775390625,bigg_id:"h_c",label_y:1903.8848876953125},1576603:{node_is_primary:!1,name:"H+",label_x:4858.38818359375,node_type:"metabolite",y:1900,x:4860,bigg_id:"h_e",label_y:1950.6187744140625},1576604:{node_is_primary:!1,name:"H2O",label_x:4452.77001953125,node_type:"metabolite",y:1760.9495849609375,x:4439.09375,bigg_id:"h2o_c",label_y:1736.77685546875},1576605:{node_is_primary:!0,name:"Alpha-D-Ribose 5-phosphate",label_x:2418.413330078125,node_type:"metabolite",y:1555,x:2419,bigg_id:"r5p_c",label_y:1601.1072998046875},1576606:{node_is_primary:!1,name:"Acetyl-CoA",label_x:3125,node_type:"metabolite",y:3402,x:3105,bigg_id:"accoa_c",label_y:3402},1576607:{node_is_primary:!1,name:"H2O",label_x:3190,node_type:"metabolite",y:3480,x:3170,bigg_id:"h2o_c",label_y:3480},1576608:{node_is_primary:!1,name:"H+",label_x:2891,node_type:"metabolite",y:3220,x:2871,bigg_id:"h_c",label_y:3220},1576609:{node_is_primary:!1,name:"Coenzyme A",label_x:2800,node_type:"metabolite",y:3168,x:2780,bigg_id:"coa_c",label_y:3168},1576612:{node_is_primary:!1,name:"Phosphate",label_x:1835,node_type:"metabolite",y:4035,x:1815,bigg_id:"pi_c",label_y:4035},1576613:{node_is_primary:!0,name:"Acetyl phosphate",label_x:1745,node_type:"metabolite",y:4175,x:1715,bigg_id:"actp_c",label_y:4175},1576614:{node_is_primary:!1,name:"Coenzyme A",label_x:1835,node_type:"metabolite",y:4135,x:1815,bigg_id:"coa_c",label_y:4135},1576615:{node_is_primary:!1,name:"ATP",label_x:4552.7265625,node_type:"metabolite",y:4258,x:4535,bigg_id:"atp_c",label_y:4269.94287109375},1576616:{node_is_primary:!1,name:"H2O",label_x:4481.77685546875,node_type:"metabolite",y:4258,x:4485,bigg_id:"h2o_c",label_y:4287.6689453125},1576617:{node_is_primary:!1,name:"Phosphate",label_x:4268.884765625,node_type:"metabolite",y:4258,x:4285,bigg_id:"pi_c",label_y:4287.6689453125},1576618:{node_is_primary:!1,name:"ADP",label_x:4381.77685546875,node_type:"metabolite",y:4258,x:4385,bigg_id:"adp_c",label_y:4290.89208984375},1576619:{node_is_primary:!1,name:"H+",label_x:4331.77734375,node_type:"metabolite",y:4258,x:4335,bigg_id:"h_c",label_y:4286.0576171875},1576620:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:2380,node_type:"metabolite",y:3220,x:2360,bigg_id:"nad_c",label_y:3220},1576621:{node_is_primary:!1,name:"CO2",label_x:1979.703125,node_type:"metabolite",y:3420,x:2060,bigg_id:"co2_c",label_y:3415.23974609375},1576622:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:1994.9427490234375,node_type:"metabolite",y:3370,x:2080,bigg_id:"nadh_c",label_y:3350.958740234375},1576623:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:1257,node_type:"metabolite",y:1160,x:1257,bigg_id:"nadp_c",label_y:1140},1576624:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:1430,node_type:"metabolite",y:1160,x:1407,bigg_id:"nadph_c",label_y:1140},1576625:{node_is_primary:!1,name:"H+",label_x:1357,node_type:"metabolite",y:1160,x:1357,bigg_id:"h_c",label_y:1140},1576626:{node_is_primary:!0,name:"6-phospho-D-glucono-1,5-lactone",label_x:1507,node_type:"metabolite",y:1265,x:1507,bigg_id:"6pgl_c",label_y:1235},1576627:{node_is_primary:!0,name:"Acetate",label_x:1759.0985107421875,node_type:"metabolite",y:4845,x:1715,bigg_id:"ac_e",label_y:4848.173828125},1576628:{node_is_primary:!1,name:"H2O",label_x:4175.82763671875,node_type:"metabolite",y:3940,x:4201,bigg_id:"h2o_c",label_y:3972.89208984375},1576629:{node_is_primary:!1,name:"Ammonium",label_x:4160.99267578125,node_type:"metabolite",y:3762,x:4193,bigg_id:"nh4_c",label_y:3793.22314453125},1576630:{node_is_primary:!1,name:"H2O",label_x:4295,node_type:"metabolite",y:1140,x:4275,bigg_id:"h2o_c",label_y:1140},1576631:{node_is_primary:!1,name:"Phosphate",label_x:4305,node_type:"metabolite",y:1450,x:4285,bigg_id:"pi_c",label_y:1450},1576632:{node_is_primary:!1,name:"H+",label_x:4305,node_type:"metabolite",y:1380,x:4285,bigg_id:"h_c",label_y:1380},1576633:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:935,node_type:"metabolite",y:4255,x:955,bigg_id:"nad_c",label_y:4255},1576634:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:935,node_type:"metabolite",y:4045,x:955,bigg_id:"nadh_c",label_y:4045},1576635:{node_is_primary:!1,name:"H+",label_x:935,node_type:"metabolite",y:4095,x:955,bigg_id:"h_c",label_y:4095},1576636:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:2690,node_type:"metabolite",y:3310,x:2670,bigg_id:"nad_c",label_y:3320},1576637:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:2710,node_type:"metabolite",y:3585,x:2680,bigg_id:"nadh_c",label_y:3590},1576638:{node_is_primary:!1,name:"H+",label_x:2692,node_type:"metabolite",y:3510,x:2660,bigg_id:"h_c",label_y:3510},1576639:{node_is_primary:!0,name:"H2O",label_x:3287,node_type:"metabolite",y:4754,x:3257,bigg_id:"h2o_e",label_y:4754},1576640:{node_is_primary:!0,name:"H2O",label_x:3287,node_type:"metabolite",y:4434,x:3257,bigg_id:"h2o_c",label_y:4434},1576641:{node_is_primary:!0,name:"CO2",label_x:3651,node_type:"metabolite",y:4434,x:3621,bigg_id:"co2_c",label_y:4434},1576642:{node_is_primary:!1,name:"ATP",label_x:670.5706176757812,node_type:"metabolite",y:3855,x:735,bigg_id:"atp_c",label_y:3840.71923828125},1576643:{node_is_primary:!1,name:"H2O",label_x:681.677978515625,node_type:"metabolite",y:3805,x:735,bigg_id:"h2o_c",label_y:3787.545654296875},1576644:{node_is_primary:!1,name:"H+",label_x:672.1574096679688,node_type:"metabolite",y:3475,x:735,bigg_id:"h_c",label_y:3478.173583984375},1576645:{node_is_primary:!1,name:"AMP",label_x:640.4221801757812,node_type:"metabolite",y:3525,x:735,bigg_id:"amp_c",label_y:3545.6279296875},1576646:{node_is_primary:!1,name:"Phosphate",label_x:684.8515014648438,node_type:"metabolite",y:3425,x:735,bigg_id:"pi_c",label_y:3409.13232421875},1576647:{node_is_primary:!0,name:"D-Glucose",label_x:1085.066162109375,node_type:"metabolite",y:705,x:1055.066162109375,bigg_id:"glc__D_e",label_y:705},1576648:{node_is_primary:!1,name:"H+",label_x:2620,node_type:"metabolite",y:4760,x:2600,bigg_id:"h_e",label_y:4760},1576649:{node_is_primary:!0,name:"Ethanol",label_x:2530,node_type:"metabolite",y:4830,x:2500,bigg_id:"etoh_e",label_y:4830},1576650:{node_is_primary:!1,name:"H+",label_x:2620,node_type:"metabolite",y:4400,x:2600,bigg_id:"h_c",label_y:4400},1576651:{node_is_primary:!1,name:"ATP",label_x:1835,node_type:"metabolite",y:4335,x:1815,bigg_id:"atp_c",label_y:4335},1576652:{node_is_primary:!0,name:"Acetate",label_x:1745,node_type:"metabolite",y:4385,x:1715,bigg_id:"ac_c",label_y:4385},1576653:{node_is_primary:!1,name:"ADP",label_x:1835,node_type:"metabolite",y:4225,x:1815,bigg_id:"adp_c",label_y:4225},1576654:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:3993.9423828125,node_type:"metabolite",y:3932,x:4029,bigg_id:"nadph_c",label_y:3909.05029296875},1576655:{node_is_primary:!1,name:"H+",label_x:4002,node_type:"metabolite",y:3982,x:4029,bigg_id:"h_c",label_y:3986},1576656:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:3957.985595703125,node_type:"metabolite",y:3759,x:4043,bigg_id:"nadp_c",label_y:3736.215576171875},1576657:{node_is_primary:!0,name:"Fumarate",label_x:2879.817626953125,node_type:"metabolite",y:650,x:2840,bigg_id:"fum_e",label_y:635.0911865234375},1576658:{node_is_primary:!1,name:"H+",label_x:2962.214599609375,node_type:"metabolite",y:700,x:2940,bigg_id:"h_e",label_y:718.4132080078125},1576659:{node_is_primary:!1,name:"H+",label_x:2954.28076171875,node_type:"metabolite",y:1010,x:2940,bigg_id:"h_c",label_y:1038.4132080078125},1576660:{node_is_primary:!1,name:"H+",label_x:1835,node_type:"metabolite",y:4775,x:1815,bigg_id:"h_e",label_y:4775},1576661:{node_is_primary:!1,name:"H+",label_x:1839.76025390625,node_type:"metabolite",y:4452.45458984375,x:1819.76025390625,bigg_id:"h_c",label_y:4452.45458984375},1576662:{node_is_primary:!1,name:"Phosphoenolpyruvate",label_x:877.8765258789062,node_type:"metabolite",y:974.4060668945312,x:957.694091796875,bigg_id:"pep_c",label_y:976.9517211914062},1576663:{node_is_primary:!1,name:"Pyruvate",label_x:1193.082275390625,node_type:"metabolite",y:972.8192138671875,x:1161.3470458984375,bigg_id:"pyr_c",label_y:986.47216796875},1576664:{node_is_primary:!1,name:"H+",label_x:4818.7197265625,node_type:"metabolite",y:2921.942138671875,x:4791.7197265625,bigg_id:"h_e",label_y:2921.942138671875},1576665:{node_is_primary:!1,name:"H+",label_x:4389.423828125,node_type:"metabolite",y:2763.553955078125,x:4461.380859375,bigg_id:"h_c",label_y:2763.9423828125},1576666:{node_is_primary:!0,name:"Formate",label_x:1500,node_type:"metabolite",y:4843.322265625,x:1460,bigg_id:"for_e",label_y:4843.322265625},1576667:{node_is_primary:!1,name:"H2O",label_x:1587,node_type:"metabolite",y:1160,x:1587,bigg_id:"h2o_c",label_y:1140},1576668:{node_is_primary:!1,name:"H+",label_x:1687,node_type:"metabolite",y:1160,x:1687,bigg_id:"h_c",label_y:1140},1576669:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:1165,node_type:"metabolite",y:2265,x:1145,bigg_id:"nad_c",label_y:2265},1576670:{node_is_primary:!1,name:"Phosphate",label_x:1165,node_type:"metabolite",y:2315,x:1145,bigg_id:"pi_c",label_y:2315},1576671:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:1165,node_type:"metabolite",y:2515,x:1145,bigg_id:"nadh_c",label_y:2515},1576672:{node_is_primary:!1,name:"H+",label_x:1169,node_type:"metabolite",y:2465,x:1145,bigg_id:"h_c",label_y:2465},1576673:{node_is_primary:!1,name:"H+",label_x:4836,node_type:"metabolite",y:3087,x:4836,bigg_id:"h_e",label_y:3115},1576674:{node_is_primary:!1,name:"H+",label_x:4456,node_type:"metabolite",y:3087,x:4456,bigg_id:"h_c",label_y:3109},1576675:{node_is_primary:!1,name:"H2O",label_x:4210,node_type:"metabolite",y:3558,x:4192,bigg_id:"h2o_c",label_y:3530},1576676:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:4142,node_type:"metabolite",y:3558,x:4142,bigg_id:"nadp_c",label_y:3528},1576677:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:3935.431640625,node_type:"metabolite",y:3558,x:3992,bigg_id:"nadph_c",label_y:3532.22314453125},1576678:{node_is_primary:!1,name:"Ammonium",label_x:3856.820068359375,node_type:"metabolite",y:3558,x:3942,bigg_id:"nh4_c",label_y:3573.222900390625},1576679:{node_is_primary:!1,name:"H+",label_x:4050,node_type:"metabolite",y:3558,x:4042,bigg_id:"h_c",label_y:3530},1576680:{node_is_primary:!1,name:"H+",label_x:4865,node_type:"metabolite",y:1150,x:4865,bigg_id:"h_e",label_y:1180},1576681:{node_is_primary:!1,name:"Phosphate",label_x:4459.546875,node_type:"metabolite",y:1330,x:4495,bigg_id:"pi_c",label_y:1293.5970458984375},1576682:{node_is_primary:!1,name:"H+",label_x:4398.884765625,node_type:"metabolite",y:1150,x:4415,bigg_id:"h_c",label_y:1187.7266845703125},1576683:{node_is_primary:!1,name:"H2O",label_x:4482.7265625,node_type:"metabolite",y:1030,x:4482.7265625,bigg_id:"h2o_c",label_y:1010},1576684:{node_is_primary:!1,name:"H2O",label_x:2599.520751953125,node_type:"metabolite",y:3860,x:2610,bigg_id:"h2o_c",label_y:3890.1484375},1576685:{node_is_primary:!0,name:"Citrate",label_x:2972.653076171875,node_type:"metabolite",y:3986,x:2971,bigg_id:"cit_c",label_y:3943.1826171875},1576686:{node_is_primary:!1,name:"Coenzyme A",label_x:2786.826416015625,node_type:"metabolite",y:4091,x:2806,bigg_id:"coa_c",label_y:4132.21484375},1576687:{node_is_primary:!1,name:"H+",label_x:2899.041015625,node_type:"metabolite",y:4117,x:2897,bigg_id:"h_c",label_y:4155.8671875},1576688:{node_is_primary:!1,name:"H+",label_x:351.3470764160156,node_type:"metabolite",y:4045,x:345,bigg_id:"h_e",label_y:4072.933837890625},1576689:{node_is_primary:!1,name:"H+",label_x:675,node_type:"metabolite",y:4045,x:675,bigg_id:"h_c",label_y:4077.694091796875},1576690:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:2450,node_type:"metabolite",y:3370,x:2430,bigg_id:"nadp_c",label_y:3370},1576691:{node_is_primary:!1,name:"CO2",label_x:2280,node_type:"metabolite",y:3510,x:2260,bigg_id:"co2_c",label_y:3510},1576692:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:2220,node_type:"metabolite",y:3540,x:2200,bigg_id:"nadph_c",label_y:3550},1576808:{node_is_primary:!1,name:"H+",label_x:4874.1728515625,node_type:"metabolite",y:2570,x:4850,bigg_id:"h_e",label_y:2601.280517578125},1576809:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide",label_x:4356.72412109375,node_type:"metabolite",y:2646.77685546875,x:4449.00732421875,bigg_id:"nad_c",label_y:2646.95849609375},1576810:{node_is_primary:!1,name:"H+",label_x:2473.50439453125,node_type:"metabolite",y:1010,x:2510,bigg_id:"h_c",label_y:1043.1734619140625},1576811:{node_is_primary:!1,name:"H+",label_x:1245.23974609375,node_type:"metabolite",y:4440,x:1270,bigg_id:"h_c",label_y:4424.13232421875},1576812:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:1868.892578125,node_type:"metabolite",y:3860,x:1890,bigg_id:"nadh_c",label_y:3840.810302734375},1576813:{node_is_primary:!1,name:"H+",label_x:2406,node_type:"metabolite",y:3980,x:2392,bigg_id:"h_c",label_y:3965},1576814:{node_is_primary:!1,name:"Ubiquinone-8",label_x:3228.082275390625,node_type:"metabolite",y:2730,x:3210,bigg_id:"q8_c",label_y:2736.34716796875},1576815:{node_is_primary:!0,name:"Acetaldehyde",label_x:2240,node_type:"metabolite",y:4837.65283203125,x:2210,bigg_id:"acald_e",label_y:4837.65283203125},1576816:{node_is_primary:!0,name:"L-Malate",label_x:2640,node_type:"metabolite",y:650,x:2610,bigg_id:"mal__L_e",label_y:630},1576817:{node_is_primary:!0,name:"Acetaldehyde",label_x:2210,node_type:"metabolite",y:3945,x:2210,bigg_id:"acald_c",label_y:3905},1576819:{node_is_primary:!1,name:"Phosphoenolpyruvate",label_x:554.497314453125,node_type:"metabolite",y:1448.4132080078125,x:565.6046142578125,bigg_id:"pep_c",label_y:1479.5206298828125},1576820:{node_is_primary:!1,name:"H+",label_x:4273.546875,node_type:"metabolite",y:2570,x:4310,bigg_id:"h_c",label_y:2604.6689453125},1576821:{node_is_primary:!1,name:"Pyruvate",label_x:692.5455932617188,node_type:"metabolite",y:1237.785400390625,x:714.76025390625,bigg_id:"pyr_c",label_y:1207.785400390625},1576822:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:2496,node_type:"metabolite",y:4065,x:2482,bigg_id:"nad_c",label_y:4051},1576824:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:2347,node_type:"metabolite",y:3935,x:2333,bigg_id:"nadh_c",label_y:3921},1576825:{node_is_primary:!1,name:"Coenzyme A",label_x:2140,node_type:"metabolite",y:3860,x:2130,bigg_id:"coa_c",label_y:3840},1576826:{node_is_primary:!0,name:"D-Fructose",label_x:284.1323547363281,node_type:"metabolite",y:1360,x:300,bigg_id:"fru_e",label_y:1405.8675537109375},1576827:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide - reduced",label_x:4322.0859375,node_type:"metabolite",y:2478.91357421875,x:4417.8271484375,bigg_id:"nadh_c",label_y:2462.79833984375},1576828:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:2070,node_type:"metabolite",y:3860,x:2070,bigg_id:"nad_c",label_y:3840},1576829:{node_is_primary:!0,name:"Ethanol",label_x:2522,node_type:"metabolite",y:4228,x:2501,bigg_id:"etoh_c",label_y:4206},1576830:{node_is_primary:!1,name:"Ubiquinol-8",label_x:3041.5869140625,node_type:"metabolite",y:2740,x:3020,bigg_id:"q8h2_c",label_y:2740},1576831:{node_is_primary:!1,name:"H+",label_x:2460.1826171875,node_type:"metabolite",y:700,x:2510,bigg_id:"h_e",label_y:722.5455932617188},1576832:{node_is_primary:!1,name:"H+",label_x:1950,node_type:"metabolite",y:3860,x:1950,bigg_id:"h_c",label_y:3840},1576833:{node_is_primary:!1,name:"H+",label_x:1228.8927001953125,node_type:"metabolite",y:4770,x:1270,bigg_id:"h_e",label_y:4750.95849609375},1576834:{y:2665,x:1055,node_type:"multimarker"},1576835:{y:2775,x:1055,node_type:"multimarker"},1576836:{y:2725,x:1055,node_type:"midmarker"},1576837:{y:1265,x:1957,node_type:"midmarker"},1576838:{y:1265,x:1937,node_type:"multimarker"},1576839:{y:1265,x:1977,node_type:"multimarker"},1576840:{y:1660,x:4660,node_type:"midmarker"},1576841:{y:820,x:3510,node_type:"midmarker"},1576842:{y:800,x:3510,node_type:"multimarker"},1576843:{y:870,x:3510,node_type:"multimarker"},
1576844:{y:3022,x:2727,node_type:"multimarker"},1576845:{y:3076,x:2684,node_type:"midmarker"},1576846:{y:3846,x:3606,node_type:"midmarker"},1576847:{y:3923,x:3512,node_type:"multimarker"},1576848:{y:3781,x:3663,node_type:"multimarker"},1576849:{y:3945,x:1430,node_type:"multimarker"},1576850:{y:3945,x:1495,node_type:"midmarker"},1576851:{y:3945,x:1555,node_type:"multimarker"},1576852:{y:3486,x:1414,node_type:"midmarker"},1576853:{y:3519,x:1493,node_type:"multimarker"},1576854:{y:3458,x:1348,node_type:"multimarker"},1576855:{y:3265,x:1055,node_type:"multimarker"},1576856:{y:3225,x:1055,node_type:"midmarker"},1576857:{y:1395,x:1055,node_type:"midmarker"},1576858:{y:4598,x:3989,node_type:"midmarker"},1576859:{y:1715,x:835,node_type:"midmarker"},1576860:{y:1665,x:835,node_type:"multimarker"},1576861:{y:1765,x:835,node_type:"multimarker"},1576863:{y:2880,x:5025,node_type:"midmarker"},1576864:{y:3766,x:3417,node_type:"multimarker"},1576865:{y:3857,x:3417,node_type:"midmarker"},1576866:{y:1260,x:4145,node_type:"midmarker"},1576867:{y:1200,x:4145,node_type:"multimarker"},1576868:{y:4158,x:5020,node_type:"midmarker"},1576871:{y:4914,x:3621,node_type:"midmarker"},1576872:{y:1995,x:2178,node_type:"midmarker"},1576873:{y:1955,x:2175,node_type:"multimarker"},1576874:{y:2035,x:2178,node_type:"multimarker"},1576875:{y:3655,x:1055,node_type:"multimarker"},1576876:{y:3705,x:1055,node_type:"midmarker"},1576877:{y:3745,x:1055,node_type:"multimarker"},1576878:{y:3635,x:4645,node_type:"midmarker"},1576879:{y:3635,x:4541,node_type:"multimarker"},1576880:{y:3635,x:4779,node_type:"multimarker"},1576881:{y:4925,x:1055,node_type:"midmarker"},1576884:{y:3945,x:155,node_type:"midmarker"},1576885:{y:1415,x:2045,node_type:"midmarker"},1576887:{y:2230,x:4986,node_type:"midmarker"},1576888:{y:3020,x:3631,node_type:"midmarker"},1576889:{y:2976,x:3588,node_type:"multimarker"},1576890:{y:3063,x:3666,node_type:"multimarker"},1576891:{y:1735,x:1055,node_type:"midmarker"},1576892:{y:1775,x:1055,node_type:"multimarker"},1576893:{y:1690,x:1055,node_type:"multimarker"},1576895:{y:3636,x:5015,node_type:"midmarker"},1576896:{y:1735,x:1525,node_type:"midmarker"},1576897:{y:1735,x:1695,node_type:"multimarker"},1576898:{y:1735,x:1405,node_type:"multimarker"},1576899:{y:3889,x:4364,node_type:"multimarker"},1576900:{y:3869,x:4364,node_type:"midmarker"},1576901:{y:3849,x:4364,node_type:"multimarker"},1576905:{y:1270,x:3470,node_type:"multimarker"},1576906:{y:1270,x:3570,node_type:"multimarker"},1576907:{y:1270,x:3520,node_type:"midmarker"},1576908:{y:3480,x:3780,node_type:"multimarker"},1576909:{y:3402,x:3783,node_type:"midmarker"},1576910:{y:3330,x:3776,node_type:"multimarker"},1576911:{y:3995,x:1335,node_type:"midmarker"},1576912:{y:3995,x:1255,node_type:"multimarker"},1576913:{y:3995,x:1415,node_type:"multimarker"},1576914:{y:1660,x:4970,node_type:"midmarker"},1576916:{y:3526,x:1404,node_type:"midmarker"},1576917:{y:3554,x:1485,node_type:"multimarker"},1576918:{y:3503,x:1335,node_type:"multimarker"},1576919:{y:4520,x:2880,node_type:"multimarker"},1576920:{y:4580,x:2880,node_type:"midmarker"},1576921:{y:4725,x:2880,node_type:"multimarker"},1576922:{y:3228,x:4502,node_type:"multimarker"},1576923:{y:3228,x:4792,node_type:"multimarker"},1576924:{y:3228,x:4662,node_type:"midmarker"},1576925:{y:2045,x:1055,node_type:"multimarker"},1576926:{y:1995,x:1055,node_type:"midmarker"},1576927:{y:2195,x:955,node_type:"midmarker"},1576928:{y:1900,x:4660,node_type:"midmarker"},1576929:{y:1900,x:4690,node_type:"multimarker"},1576930:{y:1900,x:4630,node_type:"multimarker"},1576931:{y:1425,x:2305,node_type:"midmarker"},1576932:{y:3341,x:2843,node_type:"multimarker"},1576933:{y:3445,x:2994,node_type:"multimarker"},1576934:{y:3388,x:2911,node_type:"midmarker"},1576935:{y:4065,x:1715,node_type:"multimarker"},1576936:{y:4105,x:1715,node_type:"multimarker"},1576937:{y:4085,x:1715,node_type:"midmarker"},1576938:{y:4158,x:4415,node_type:"multimarker"},1576939:{y:4158,x:4435,node_type:"midmarker"},1576940:{y:4158,x:4455,node_type:"multimarker"},1576941:{y:3330,x:2310,node_type:"multimarker"},1576942:{y:3360,x:2250,node_type:"midmarker"},1576943:{y:3390,x:2190,node_type:"multimarker"},1576944:{y:1265,x:1327,node_type:"multimarker"},1576945:{y:1265,x:1307,node_type:"midmarker"},1576946:{y:1265,x:1287,node_type:"multimarker"},1576947:{y:4935,x:1715,node_type:"midmarker"},1576949:{y:3815,x:4247,node_type:"multimarker"},1576950:{y:3877,x:4247,node_type:"multimarker"},1576951:{y:3857,x:4247,node_type:"midmarker"},1576952:{y:1200,x:4215,node_type:"multimarker"},1576953:{y:1260,x:4215,node_type:"midmarker"},1576954:{y:1350,x:4215,node_type:"multimarker"},1576955:{y:4125,x:1055,node_type:"multimarker"},1576956:{y:4225,x:1055,node_type:"multimarker"},1576957:{y:4175,x:1055,node_type:"midmarker"},1576958:{y:3456,x:2578,node_type:"multimarker"},1576959:{y:3404,x:2577,node_type:"midmarker"},1576960:{y:3341,x:2582,node_type:"multimarker"},1576961:{y:4614,x:3257,node_type:"midmarker"},1576962:{y:4924,x:3257,node_type:"midmarker"},1576964:{y:1645,x:2175,node_type:"multimarker"},1576965:{y:1695,x:2175,node_type:"midmarker"},1576966:{y:1735,x:2175,node_type:"multimarker"},1576967:{y:4604,x:3621,node_type:"midmarker"},1576969:{y:3228,x:5032,node_type:"midmarker"},1576970:{y:3805,x:835,node_type:"multimarker"},1576971:{y:3525,x:835,node_type:"multimarker"},1576972:{y:3645,x:835,node_type:"midmarker"},1576974:{y:543.4132690429688,x:1056.6529541015625,node_type:"midmarker"},1576975:{y:4430,x:2500,node_type:"multimarker"},1576976:{y:4550,x:2500,node_type:"midmarker"},1576977:{y:4730,x:2500,node_type:"multimarker"},1576978:{y:2995,x:1055,node_type:"midmarker"},1576980:{y:4937.93359375,x:2500,node_type:"midmarker"},1576981:{y:4305,x:1715,node_type:"multimarker"},1576982:{y:4275,x:1715,node_type:"midmarker"},1576983:{y:4255,x:1715,node_type:"multimarker"},1576985:{y:4918,x:3991,node_type:"midmarker"},1576986:{y:3888,x:4116,node_type:"multimarker"},1576987:{y:3848,x:4116,node_type:"multimarker"},1576988:{y:3868,x:4116,node_type:"midmarker"},1576989:{y:4925.107421875,x:2880,node_type:"midmarker"},1576991:{y:730,x:2840,node_type:"multimarker"},1576992:{y:980,x:2840,node_type:"multimarker"},1576993:{y:840,x:2840,node_type:"midmarker"},1576994:{y:4745,x:1715,node_type:"multimarker"},1576995:{y:4585,x:1715,node_type:"midmarker"},1576996:{y:4501.49560546875,x:1715,node_type:"multimarker"},1576997:{y:1008.8675537109375,x:1056.5865478515625,node_type:"midmarker"},1576998:{y:976.1735229492188,x:1057,node_type:"multimarker"},1576999:{y:1041.710205078125,x:1056.5867919921875,node_type:"multimarker"},1577000:{y:2846,x:4667,node_type:"midmarker"},1577001:{y:2846,x:4770,node_type:"multimarker"},1577002:{y:2846,x:4560,node_type:"multimarker"},1577003:{y:1265,x:1637,node_type:"midmarker"},1577004:{y:1265,x:1657,node_type:"multimarker"},1577005:{y:1265,x:1617,node_type:"multimarker"},1577006:{y:2345,x:1055,node_type:"multimarker"},1577007:{y:2435,x:1055,node_type:"multimarker"},1577008:{y:2395,x:1055,node_type:"midmarker"},1577009:{y:470,x:2840,node_type:"midmarker"},1577011:{y:3027,x:4666,node_type:"midmarker"},1577012:{y:3027,x:4536,node_type:"multimarker"},1577013:{y:3027,x:4796,node_type:"multimarker"},1577014:{y:3632,x:4078,node_type:"multimarker"},1577015:{y:3632,x:4098,node_type:"midmarker"},1577016:{y:3632,x:4118,node_type:"multimarker"},1577017:{y:1150,x:4705,node_type:"multimarker"},1577018:{y:1150,x:4625,node_type:"multimarker"},1577019:{y:1150,x:4665,node_type:"midmarker"},1577020:{y:3837,x:2744,node_type:"multimarker"},1577021:{y:3918,x:2840,node_type:"multimarker"},1577022:{y:3886,x:2798,node_type:"midmarker"},1577023:{y:3945,x:375,node_type:"multimarker"},1577024:{y:3945,x:645,node_type:"multimarker"},1577025:{y:3945,x:505,node_type:"midmarker"},1577026:{y:3390,x:2260,node_type:"midmarker"},1577027:{y:3410,x:2220,node_type:"multimarker"},1577028:{y:3360,x:2310,node_type:"multimarker"},1577030:{y:4925,x:1460,node_type:"midmarker"},1577031:{y:3945,x:2040,node_type:"multimarker"},1577032:{y:3945,x:2010,node_type:"midmarker"},1577033:{y:3945,x:1980,node_type:"multimarker"},1577034:{y:4570,x:2210,node_type:"midmarker"},1577035:{y:4944,x:2211,node_type:"midmarker"},1577041:{y:4100,x:2371,node_type:"multimarker"},1577042:{y:4086,x:2356,node_type:"midmarker"},1577043:{y:4071,x:2342,node_type:"multimarker"},1577044:{y:4730,x:1360,node_type:"multimarker"},1577045:{y:4600,x:1360,node_type:"midmarker"},1577046:{y:4470,x:1360,node_type:"multimarker"},1577047:{y:4432,x:1460,node_type:"midmarker"},1577048:{y:2600,x:3080,node_type:"multimarker"},1577049:{y:2600,x:3110,node_type:"midmarker"},1577050:{y:2600,x:3140,node_type:"multimarker"},1577051:{y:1361.5867919921875,x:576.050048828125,node_type:"multimarker"},1577052:{y:1361.586669921875,x:640,node_type:"midmarker"},1577053:{y:1361.586669921875,x:704.5778198242188,node_type:"multimarker"},1577054:{y:1360,x:182,node_type:"midmarker"},1577056:{y:736,x:2610,node_type:"multimarker"},1577057:{y:756,x:2610,node_type:"midmarker"},1577058:{y:980,x:2610,node_type:"multimarker"},1577059:{y:470,x:2610,node_type:"midmarker"},1577061:{y:2570,x:4630,node_type:"multimarker"},1577062:{y:2570,x:4670,node_type:"midmarker"},1577063:{y:2570,x:4710,node_type:"multimarker"},1577064:{y:2817,x:3180,node_type:"multimarker"},1577065:{y:2819,x:3129,node_type:"midmarker"},1577066:{y:2826,x:3078,node_type:"multimarker"},1577067:{y:4660.98193359375,x:1055,node_type:"multimarker"},1577068:{y:4583.8583984375,x:1055,node_type:"midmarker"},1577069:{y:4506.7353515625,x:1053.4132080078125,node_type:"multimarker"},1577071:{node_is_primary:!1,name:"H+",label_x:1125,node_type:"metabolite",y:4750.98193359375,x:1095,bigg_id:"h_e",label_y:4760.98193359375},1577072:{node_is_primary:!1,name:"H+",label_x:1123.4132080078125,node_type:"metabolite",y:4416.7353515625,x:1093.4132080078125,bigg_id:"h_c",label_y:4426.7353515625},1577073:{node_is_primary:!1,name:"H2O",label_x:5539.50146484375,node_type:"metabolite",y:4574.02490234375,x:5527.4580078125,bigg_id:"h2o_c",label_y:4562.89990234375},1577074:{y:4717.48193359375,x:5334.0517578125,node_type:"multimarker"},1577075:{y:4737.48193359375,x:5334.0517578125,node_type:"midmarker"},1577076:{y:4757.48193359375,x:5334.0517578125,node_type:"multimarker"},1577077:{node_is_primary:!1,name:"ADP",label_x:5529.1103515625,node_type:"metabolite",y:4924.5068359375,x:5503.33544921875,bigg_id:"adp_c",label_y:4931.337890625},1577078:{node_is_primary:!1,name:"L-Glutamate",label_x:5555.015625,node_type:"metabolite",y:4651.92236328125,x:5534.521484375,bigg_id:"glu__L_c",label_y:4645.02197265625},1577079:{node_is_primary:!1,name:"Glyceraldehyde 3-phosphate",label_x:5534.87109375,node_type:"metabolite",y:4517.58447265625,x:5512.26513671875,bigg_id:"g3p_c",label_y:4508.57177734375},1577080:{node_is_primary:!1,name:"D-Erythrose 4-phosphate",label_x:5442.19677734375,node_type:"metabolite",y:4466.33544921875,x:5437.546875,bigg_id:"e4p_c",label_y:4450.9853515625},1577081:{node_is_primary:!1,name:"H+",label_x:5204.56640625,node_type:"metabolite",y:4994.3544921875,x:5262.95361328125,bigg_id:"h_c",label_y:5025.4677734375},1577082:{node_is_primary:!1,name:"Alpha-D-Ribose 5-phosphate",label_x:5390.7685546875,node_type:"metabolite",y:4418.7158203125,x:5403.0185546875,bigg_id:"r5p_c",label_y:4391.7470703125},1577083:{node_is_primary:!1,name:"ATP",label_x:5152.708984375,node_type:"metabolite",y:4488.05615234375,x:5183.9716796875,bigg_id:"atp_c",label_y:4461.08740234375},1577084:{node_is_primary:!1,name:"D-Fructose 6-phosphate",label_x:5052.6396484375,node_type:"metabolite",y:4498.61865234375,x:5087.0712890625,bigg_id:"f6p_c",label_y:4477.9873046875},1577085:{node_is_primary:!1,name:"Pyruvate",label_x:4962.07666015625,node_type:"metabolite",y:4509.18115234375,x:4988.05859375,bigg_id:"pyr_c",label_y:4488.5498046875},1577086:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:4860.95166015625,node_type:"metabolite",y:4529.25048828125,x:4893.27099609375,bigg_id:"nad_c",label_y:4501.22509765625},1577087:{node_is_primary:!1,name:"Coenzyme A",label_x:5175.48828125,node_type:"metabolite",y:4931.947265625,x:5208.85205078125,bigg_id:"coa_c",label_y:4975.3330078125},1577088:{node_is_primary:!1,name:"Oxaloacetate",label_x:4770.38916015625,node_type:"metabolite",y:4544.03759765625,x:4783.69580078125,bigg_id:"oaa_c",label_y:4522.349609375},1577089:{node_is_primary:!1,name:"D-Glucose 6-phosphate",label_x:4679.8271484375,node_type:"metabolite",y:4559.88134765625,x:4700.52734375,bigg_id:"g6p_c",label_y:4537.1376953125},1577090:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:5078.88623046875,node_type:"metabolite",y:4897.1259765625,x:5134.0517578125,bigg_id:"nadh_c",label_y:4936.322265625},1577091:{node_is_primary:!1,name:"2-Oxoglutarate",label_x:5497.31591796875,node_type:"metabolite",y:4979.51025390625,x:5481.046875,bigg_id:"akg_c",label_y:5004.2978515625},1577092:{node_is_primary:!1,name:"Acetyl-CoA",label_x:4556.52001953125,node_type:"metabolite",y:4576.78173828125,x:4601.51416015625,bigg_id:"accoa_c",label_y:4549.81298828125},1577093:{node_is_primary:!1,name:"3-Phospho-D-glycerate",label_x:4459.6201171875,node_type:"metabolite",y:4602.1318359375,x:4508.83935546875,bigg_id:"3pg_c",label_y:4576.21923828125},1577094:{node_is_primary:!1,name:"Phosphoenolpyruvate",label_x:4379.6201171875,node_type:"metabolite",y:4629.59423828125,x:4414.0517578125,bigg_id:"pep_c",label_y:4607.90673828125},1577095:{node_is_primary:!1,name:"L-Glutamine",label_x:4253.14453125,node_type:"metabolite",y:4650.7197265625,x:4332.9951171875,bigg_id:"gln__L_c",label_y:4627.97607421875},1577096:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:4968.08447265625,node_type:"metabolite",y:4864.818359375,x:5028.71435546875,bigg_id:"nadp_c",label_y:4902.36181640625},1577097:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:4203.775390625,node_type:"metabolite",y:4682.4072265625,x:4267.78271484375,bigg_id:"nadph_c",label_y:4664.94482421875},1577098:{node_is_primary:!1,name:"Phosphate",label_x:4884.8583984375,node_type:"metabolite",y:4831.37548828125,x:4933.43505859375,bigg_id:"pi_c",label_y:4859.1142578125},1577099:{y:4023.6457547875243,x:3055.6239109998846,node_type:"multimarker"},1577100:{y:4030.8645761345497,x:3074.275683525833,node_type:"midmarker"},1577101:{y:4038.0833974815746,x:3092.9274560517806,node_type:"multimarker"},1577102:{node_is_primary:!1,name:"H2O",label_x:3189.1795476587818,node_type:"metabolite",y:3976.144484067998,x:3188.1170476587818,bigg_id:"h2o_c",label_y:3930.712355161748},1577103:{node_is_primary:!0,name:"Cis-Aconitate",label_x:3156.1556150985407,node_type:"metabolite",y:4053.2845721909744,x:3197.4642088485407,bigg_id:"acon_C_c",label_y:4098.026271409724},1577104:{y:4035.7165277261324,x:3294.488060371458,node_type:"multimarker"},1577105:{y:4027.896160086635,x:3312.895717745038,node_type:"midmarker"},1577106:{y:4020.0757924471372,x:3331.3033751186185,node_type:"multimarker"}},canvas:{y:314.36893920898433,x:7.857062530517567,height:4860.457037353515,width:5894.515691375733},text_labels:{}}]},function(e,t){e.exports={PMEACPE:104e-8,GLYCLTtex:-34642e-8,"D-LACt2pp":6.33e-26,UAMAGS:.014389,RNTR3c2:.01399,DDPA:.19735,Htex:-55.4374,ADNtex:-9.35e-26,DHPS2:34642e-8,UPP3MT:11547e-8,BMOCOS:632e-7,ACACT4r:.18428,EX_lac__D_e:-6.33e-26,P5CR:.11447,TMPPP:11547e-8,ATPM:3.15,EX_glyclt_e:34642e-8,GLUTRR:.0018476,GLUTRS:.0018476,MN2tpp:35781e-8,G1PACT:.048928,KAS15:-2.1e-18,HBZOPT:11547e-8,G5SADs:.11447,MOADSUx:2527e-7,ACACT3r:.18428,THRt4pp:.0026952,THDPS:.19208,PANTS:29826e-8,E4PD:11547e-8,PPNCL2:29826e-8,ACOAD1f:-.18428,ACLS:.45271,NTPP9:5.98e-29,DM_4CRSOL:11547e-8,ACODA:.15317,CITtex:-3.68e-27,EX_h_e:55.4374,APRAUR:23095e-8,IG3PS:.049057,EX_nh4_e:-5.5929,PE160abcpp:.023792,PPND:.071521,ADSL2r:.23199,DNMPPA:34642e-8,UAGPT3:.014389,ASPTA:-1.516,GART:.057821,ADNt2rpp:-9.35e-26,THD2pp:6.3354,TDSK:.010075,TYRL:11547e-8,LEUTAi:.23329,MG2t3_2pp:.0044921,NNATr:.0011796,PIt2rpp:.4995,PE161abcpp:.010905,GSNK:9.17e-27,SDPDS:.19208,HMBS:23095e-8,MDH:.36955,PPBNGS:92379e-8,PPPGO3:11547e-8,FCLT:11547e-8,ASPK:.55359,PTAr:15.8552,H2Otpp:2.2223,EX_succ_e:.17164,EX_meoh_e:104e-8,PPKr:-1.8145,MOHMT:29826e-8,SADT2:.12835,DHDPS:.19208,UDCPDP:.014389,ACtex:-16.1569,HACD5:.18428,DHAD1:.45271,DHAD2:.15044,HACD4:.18428,PDX5PS:11547e-8,MNtex:35781e-8,HSTPT:.049057,MEPCT:.0012371,CO2tex:.18918,ACOAD5f:-.18428,PRPPS:.48307,DPR:29826e-8,DHFR:.013896,DHFS:34642e-8,NH4tpp:5.5929,VALTA:-.21912,MPTSS:2527e-7,OGMEACPD:104e-8,PPNDH:.095934,PGM:-37.8918,THRt2rpp:-.0026952,ADK1:1.3595,GLUPRT:.23211,OGMEACPS:104e-8,SUCOAS:.27178,CHORS:.19735,ETOHtrpp:-15.8782,FE2tpp:.0042736,EPMEACPR:104e-8,DHNPA2r:34642e-8,KDOPP:.020149,KDOPS:.020149,OCBT:.15317,FADRx:1.1319,ORPT:-.17129,EX_ac_e:16.1569,USHD:.010075,GMPS2:.1262,UAAGDS:.014389,PRAMPC:.049057,I2FE2SS2:13463e-8,RHCCE:23198e-8,CYSS:.12835,DUTPDP:.013549,ADEt2rpp:-1.41e-27,IPMD:.23329,PRATPP:.049057,BMOGDS1:632e-7,PAPSR:.12835,"5DOAN":34746e-8,BMOGDS2:632e-7,INSt2rpp:9.27e-26,DHDPRy:.19208,PRAIS:.23211,MECDPS:.0012371,MPTAT:12635e-8,SO4tex:.1306,IMPC:-.28105,PGCD:.86143,EX_k_e:-.10107,EX_cu2_e:-36713e-8,IMPD:.1262,ACOAD2f:-.18428,PHETA1:-.095934,MALCOAMT:104e-8,PSD161:.038947,OGMEACPR:104e-8,Eciomass_iJO1366_core_53p95M:-.51782,H2Otex:2.2223,ACONTa:.55675,ACONTb:.55675,DURIPP:2.08e-28,DALAt2pp:.0071946,PRFGS:.23211,DAPDC:.1777,GLCptspp:20,PSCVT:.19735,"3OAS140":.040299,PSSA161:.038947,PSSA160:.033044,ASPCT:.17129,ADNK1:57944e-8,CLtex:.0026952,AGPAT160:.033044,AGPAT161:.038947,DXPS:.001468,CAt6pp:-.0026952,FUM:.36837,PRMICI:.049057,OPHHX3:11547e-8,EX_ca2_e:-.0026952,DAPE:.19208,DBTS:104e-8,KARA1:-.45271,KARA2:.15044,ZN2tpp:17658e-8,ILETA:-.15044,FMNAT:11547e-8,ENO:37.8918,IPPMIb:-.23329,IPPMIa:-.23329,HACD1:.18428,AOXSr2:104e-8,HACD3:.18428,HACD2:.18428,CITt3pp:3.68e-27,G1SAT:.0018476,HACD7:.14398,HACD6:.14398,SHCHF:11547e-8,ACACT5r:.18428,MCTP1App:.0071946,EX_zn2_e:-17658e-8,DHPPDA2:23095e-8,UPP3S:23095e-8,ACOAD6f:-.14398,ADSS:.15485,SHSL1:.079698,MTHFR2:.07993,PSP_L:.86143,G5SD:.11447,IGPS:.029434,ADSK:.12835,DNTPPA:34642e-8,ALATA_L:-.30104,EX_etoh_e:15.8782,UAGAAT:.020149,AIRC2:.23199,AIRC3:-.23199,MPTS:12635e-8,DB4PS:46189e-8,HISTP:.049057,TRPAS2:-.029434,MPTG:.0071946,TMDS:.013549,IGPDH:.049057,PDH:-3.88e-11,HISTD:.049057,ASP1DC:29826e-8,OHPBAT:11547e-8,I2FE2SR:104e-8,I2FE2SS:1481e-7,NI2tpp:16726e-8,I2FE2ST:145e-7,PGAMT:-.048928,I4FE4ST:13463e-8,I4FE4SR:13463e-8,OPMEACPD:104e-8,DXPRIi:.0012371,OPMEACPS:104e-8,OPMEACPR:104e-8,DM_MTHTHF:23198e-8,DHORDfum:.17129,CLt3_2pp:.0013476,PRASCSi:.23199,NDPK8:9.24e-27,RPE:-.402,NDPK2:.22022,NDPK3:.093676,NDPK1:.4094,TRDR:.12835,NDPK7:8.42e-30,NDPK4:.013549,NDPK5:-9.17e-27,MCOATA:.040301,HPPK2:34642e-8,G3PD2:-.071991,CO2tpp:.18918,DTMPK:.013549,PGI:20,FACOAE120:.040299,AACPS4:.077894,AACPS7:.040299,MGSA:-7.3e-26,GLCtex:20,BTS5:104e-8,AACPS3:.066088,NI2tex:16726e-8,"3HAD40":-2.1e-18,FORtppi:34.175,G3PAT160:.033044,G3PAT161:.038947,MECDPDH5:.0012371,ACCOAC:.040302,GHMT2r:.54934,MOAT2:.010075,RNTR1c2:.013549,UPPDC1:11547e-8,AMPMS2:11547e-8,UDCPDPS:285e-7,DHQTi:.19735,PERD:11547e-8,HSK:.28181,IPDPS:.0010931,EX_co2_e:-.18918,ACOTA:-.15317,RBFSb:23095e-8,SULRi:.12835,RBFSa:46189e-8,ALCD2x:-15.8782,UAPGR:.014389,THRS:.28181,GAPD:38.7532,QULNS:.0011796,OCTDPS:11547e-8,ASNS2:.12482,ATPPRT:.049057,CU2tex:36713e-8,Kt2pp:.10107,EGMEACPR:104e-8,THRD_L:.15044,DHQS:.19735,ACGS:.15317,DM_AMOB:104e-8,PRAIi:.029434,MEOHtex:-104e-8,ACGK:.15317,CBMKr:.32446,GK1:.1262,ACACT6r:.14398,FE2tex:.0042736,FACOAE161:.077894,FACOAE160:.066088,CU2tpp:36713e-8,GRTT:14395e-8,UMPK:.19576,EX_pi_e:-.4995,GCALDD:34642e-8,ECOAH6:.14398,ECOAH7:.14398,ECOAH4:.18428,ECOAH5:.18428,ECOAH2:.18428,ECOAH3:.18428,ECOAH1:.18428,ANPRT:.029434,ANS:.029434,ACOAD3f:-.18428,POR5:.056315,NADK:23147e-8,FORtex:-34.175,PNTK:29826e-8,EX_cobalt2_e:-129e-7,UAGCVT:.014389,"D-LACtex":6.33e-26,ACHBS:.15044,DHPTDCs2:23198e-8,A5PISO:.020149,ARGSL:.15317,CTPS2:.083123,EX_mg2_e:-.0044921,TALA:-.10226,GARFT:.17429,UAMAS:.014389,ARGSS:.15317,PPCDC:29826e-8,HSST:.079698,"3OAR140":.040299,EXe3_e:-.0040431,MOX:-.0011796,AMAOTr:104e-8,CS:.55675,UGMDDS:.014389,PUNP4:9.17e-27,PUNP5:4.04e-26,PUNP6:-6.27e-27,ACOAD7f:-.066088,PUNP1:-57944e-8,PUNP3:-9.17e-27,SO4t2pp:.1306,PMPK:11547e-8,CPPPGO2:11547e-8,ASPO6:.0011796,ADEtex:-1.41e-27,TMPK:11547e-8,INSH:-1.05e-30,INSK:5.23e-26,DMPPS:14395e-8,CPMPS:12635e-8,ACKr:-15.8552,DHORTS:-.17129,ACACT2r:.18428,PPC:1.7044,netFlux:796.663,EX_mobd_e:-668e-7,PPM:-57944e-8,PRAGSr:.23211,IPPS:.23329,EXor_e:34.175,TPI:19.4759,DADK:8.72e-27,SDPTA:-.19208,SUCCtex:-.17164,ALAALAr:.014389,BPNT:.12835,Zn2tex:17658e-8,CA2tex:.0026952,DASYN160:.033044,PSERT:.86143,GLNS:.93757,"3OAR40":-2.1e-18,AICART:.28105,URIH:1.05e-30,THZPSN3:11547e-8,LPADSS:.010075,EX_so4_e:-.1306,NNDPR:.0011796,RBFK:11547e-8,PTPATi:29826e-8,RPI:-.38138,ETOHtex:-15.8782,MG2tex:.0044921,AHCYSNS:23198e-8,DASYN161:.038947,EX_h2o_e:-2.2223,NADS1:.0011796,TKT2:-.29973,TKT1:-.10226,EX_ni2_e:-16726e-8,PPM2:5.06e-28,MTHTHFSs:23198e-8,METS:.07993,KDOCT2:.020149,SERAT:.12835,K2L4Aabcpp:.010075,GLUR:-.014389,NH4tex:5.5929,RNTR2c2:.01399,CHRPL:11547e-8,EX_glc_e:-20,PMDPHT:23095e-8,ACALD:-15.8782,ACOAD4f:-.18428,ACt2rpp:-16.1569,GLYCLTt2rpp:-34642e-8,GLU5K:.11447,SHKK:.19735,GTPCI:34642e-8,PDX5PO2:11547e-8,ATPS4rpp:-13.212,U23GAAT:.020149,RNTR4c2:.013549,PAPPT3:.014389,CHORM:.16745,ACACT1r:.18428,Ktex:.10107,DHAPT:15.7582,ICYSDS:93466e-8,FE3abcpp:.0040431,HCO3E:.27229,DM_5DRIB:34746e-8,OMCDC:.23329,AGPR:-.15317,SHK3Dr:.19735,CYTK1:.093676,PSD160:.033044,FE3tex:.0040431,TYRTA:-.071521,EXe2_e:-.0042736,ALAR:.021584,UHGADA:.020149,PItex:.4995,GLUDy:-4.4,DMATT:14395e-8,MOCOS:632e-7,F6PA:15.7582,MEOHtrpp:-104e-8,ICDHyr:.55675,MOBDtex:668e-7,ACACT7r:.14398,XPPT:-6.24e-29,MTHFC:.45545,MTHFD:.45545,TRPS3:.029434,COBALT2tpp:129e-7,OPHBDC:11547e-8,FBA:3.7909,K2L4Aabctex:.010075,OMPDC:.17129,MOAT:.010075,PFK:3.7909,CYSTL:.079698,GTPCII2:23095e-8,UAGDP:.048928,ASAD:-.55359,SHCHD2:11547e-8,SUCCt3pp:.17164,EX_cl_e:-.0026952,NTD8:9.17e-27,MOBDabcpp:668e-7,NTD6:-8.72e-27,ADCL:34642e-8,DGK1:-9.17e-27,NTD1:7.23e-29,DPCOAK:29826e-8,HSDy:-.3615,EX_mn2_e:-35781e-8,METAT:69595e-8,ADCS:34642e-8,PGK:-38.7532,INStex:9.27e-26,COBALT2tex:129e-7,PFL:34.2315,GF6PTA:.048928,CTECOAI7:-.077894,ADSL1r:.15485,CDPMEK:.0012371}},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=t.NavButtons=void 0;var o=n(231),a=r(o),s=n(232),l=n(310),u=i(l),c=t.NavButtons=(0,s.createView)({init:function(e,t,n){return{addressedActionIn:e,addressedActionOut:t,currentIndex:n,lastCurrentIndex:null}},getReducer:u.getReducer,create:function(e,t,n,i,r){var o=a["default"].select(n);o.append("button").attr("id","button-in").attr("class","my-button").text("⬆︎").on("click",r(e.addressedActionIn)||null),o.append("button").attr("id","button-out").attr("class","my-button").text("⬇︎").on("click",r(e.addressedActionOut)||null)},update:function(e,t,n){var i=a["default"].select(n);i.select("#button-in").classed("my-button-disabled",e.currentIndex===t.pages.length-1),i.select("#button-out").classed("my-button-disabled",0===e.currentIndex)}});t["default"]=c},function(e,t,n){var i=n(319);"string"==typeof i&&(i=[[e.id,i,""]]);n(314)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(313)(),t.push([e.id,"#app{perspective:200px}.fill,.page{height:100%;width:100%;position:absolute;top:0;left:0}.page{will-change:transform,opacity}.genome-center,.webgl-message{height:60%;width:90%;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.webgl-message{text-align:center}.centered{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.title-img{width:90%}.title-questions-img{width:100%}.start-img{position:absolute;top:7px;left:110px;width:150px}.cell-img{width:50%}.protein-screen{position:relative;top:0;left:0;transform:none;width:100%}#nav-buttons{transform:rotateX(10deg) translateZ(10px);left:80px;top:50px;z-index:10;position:absolute}span.hidden{display:block!important}.my-button{display:inline-block;zoom:1;line-height:normal;white-space:nowrap;vertical-align:middle;text-align:center;cursor:pointer;font-family:inherit;font-size:32px;padding:.5em 1em;color:rgba(0,0,0,.8);border:none transparent;background-color:#e6e6e6;text-decoration:none;border-radius:2px}.my-button:hover{background-image:linear-gradient(transparent,rgba(0,0,0,.05) 40%,rgba(0,0,0,.1))}.my-button-disabled{border:none;background-image:none;filter:alpha(opacity=40);opacity:.4;cursor:not-allowed;box-shadow:none}.overlay{position:absolute;background-color:rgba(245,226,229,.91);font-size:1.6em;padding:30px;font-weight:200;width:50%;text-align:justify;border-radius:4px}.overlay>p{text-indent:1.5em}@media (min-width:850px){.overlay{font-size:2em}}@media (max-width:450px){.overlay{font-size:1.2em}}.bottom{bottom:5%}.top{top:15%}.left{left:5%}.right{right:5%}.center{left:50%;transform:translate(-50%)}",""])}]);
//# sourceMappingURL=bundle.min.js.map