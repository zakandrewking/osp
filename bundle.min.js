!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){n(1),t.exports=n(191)},function(t,e,n){(function(t){"use strict";if(n(2),n(189),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0}).call(e,function(){return this}())},function(t,e,n){n(3),n(36),n(42),n(44),n(46),n(48),n(50),n(52),n(53),n(54),n(55),n(56),n(57),n(58),n(59),n(60),n(61),n(62),n(63),n(66),n(67),n(68),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(78),n(79),n(80),n(82),n(83),n(84),n(86),n(87),n(88),n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(104),n(105),n(109),n(110),n(112),n(113),n(118),n(119),n(122),n(124),n(126),n(128),n(129),n(130),n(132),n(133),n(135),n(136),n(137),n(138),n(145),n(148),n(149),n(151),n(152),n(153),n(154),n(155),n(156),n(157),n(158),n(159),n(160),n(161),n(162),n(164),n(165),n(166),n(167),n(168),n(169),n(171),n(172),n(173),n(174),n(176),n(177),n(179),n(180),n(182),n(183),n(184),n(187),n(188),t.exports=n(7)},function(t,e,n){"use strict";var i,r=n(4),o=n(5),a=n(10),s=n(9),l=n(16),u=n(17),c=n(19),h=n(20),d=n(21),f=n(11),p=n(22),_=n(15),g=n(18),m=n(23),v=n(25),y=n(27),b=n(28),x=n(29),w=n(26),S=n(13)("__proto__"),A=n(30),k=n(35)(!1),C=Object.prototype,T=Array.prototype,E=T.slice,M=T.join,L=r.setDesc,R=r.getDesc,O=r.setDescs,P={};a||(i=!f(function(){return 7!=L(u("div"),"a",{get:function(){return 7}}).a}),r.setDesc=function(t,e,n){if(i)try{return L(t,e,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(p(t)[e]=n.value),t},r.getDesc=function(t,e){if(i)try{return R(t,e)}catch(n){}return c(t,e)?s(!C.propertyIsEnumerable.call(t,e),t[e]):void 0},r.setDescs=O=function(t,e){p(t);for(var n,i=r.getKeys(e),o=i.length,a=0;o>a;)r.setDesc(t,n=i[a++],e[n]);return t}),o(o.S+o.F*!a,"Object",{getOwnPropertyDescriptor:r.getDesc,defineProperty:r.setDesc,defineProperties:O});var D="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),I=D.concat("length","prototype"),N=D.length,F=function(){var t,e=u("iframe"),n=N,i=">";for(e.style.display="none",l.appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object</script"+i),t.close(),F=t.F;n--;)delete F.prototype[D[n]];return F()},B=function(t,e){return function(n){var i,r=v(n),o=0,a=[];for(i in r)i!=S&&c(r,i)&&a.push(i);for(;e>o;)c(r,i=t[o++])&&(~k(a,i)||a.push(i));return a}},z=function(){};o(o.S,"Object",{getPrototypeOf:r.getProto=r.getProto||function(t){return t=m(t),c(t,S)?t[S]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?C:null},getOwnPropertyNames:r.getNames=r.getNames||B(I,I.length,!0),create:r.create=r.create||function(t,e){var n;return null!==t?(z.prototype=p(t),n=new z,z.prototype=null,n[S]=t):n=F(),void 0===e?n:O(n,e)},keys:r.getKeys=r.getKeys||B(D,N,!1)});var H=function(t,e,n){if(!(e in P)){for(var i=[],r=0;e>r;r++)i[r]="a["+r+"]";P[e]=Function("F,a","return new F("+i.join(",")+")")}return P[e](t,n)};o(o.P,"Function",{bind:function(t){var e=_(this),n=E.call(arguments,1),i=function(){var r=n.concat(E.call(arguments));return this instanceof i?H(e,r.length,r):d(e,r,t)};return g(e.prototype)&&(i.prototype=e.prototype),i}}),o(o.P+o.F*f(function(){l&&E.call(l)}),"Array",{slice:function(t,e){var n=x(this.length),i=h(this);if(e=void 0===e?n:e,"Array"==i)return E.call(this,t,e);for(var r=b(t,n),o=b(e,n),a=x(o-r),s=Array(a),l=0;a>l;l++)s[l]="String"==i?this.charAt(r+l):this[r+l];return s}}),o(o.P+o.F*(w!=Object),"Array",{join:function(t){return M.call(w(this),void 0===t?",":t)}}),o(o.S,"Array",{isArray:n(32)});var q=function(t){return function(e,n){_(e);var i=w(this),r=x(i.length),o=t?r-1:0,a=t?-1:1;if(arguments.length<2)for(;;){if(o in i){n=i[o],o+=a;break}if(o+=a,t?0>o:o>=r)throw TypeError("Reduce of empty array with no initial value")}for(;t?o>=0:r>o;o+=a)o in i&&(n=e(n,i[o],o,this));return n}},G=function(t){return function(e){return t(this,e,arguments[1])}};o(o.P,"Array",{forEach:r.each=r.each||G(A(0)),map:G(A(1)),filter:G(A(2)),some:G(A(3)),every:G(A(4)),reduce:q(!1),reduceRight:q(!0),indexOf:G(k),lastIndexOf:function(t,e){var n=v(this),i=x(n.length),r=i-1;for(arguments.length>1&&(r=Math.min(r,y(e))),0>r&&(r=x(i+r));r>=0;r--)if(r in n&&n[r]===t)return r;return-1}}),o(o.S,"Date",{now:function(){return+new Date}});var j=function(t){return t>9?t:"0"+t};o(o.P+o.F*(f(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!f(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){if(!isFinite(this))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),i=0>e?"-":e>9999?"+":"";return i+("00000"+Math.abs(e)).slice(i?-6:-4)+"-"+j(t.getUTCMonth()+1)+"-"+j(t.getUTCDate())+"T"+j(t.getUTCHours())+":"+j(t.getUTCMinutes())+":"+j(t.getUTCSeconds())+"."+(n>99?n:"0"+j(n))+"Z"}})},function(t,e){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(t,e,n){var i=n(6),r=n(7),o=n(8),a=n(12),s=n(14),l="prototype",u=function(t,e,n){var c,h,d,f,p=t&u.F,_=t&u.G,g=t&u.S,m=t&u.P,v=t&u.B,y=_?i:g?i[e]||(i[e]={}):(i[e]||{})[l],b=_?r:r[e]||(r[e]={}),x=b[l]||(b[l]={});_&&(n=e);for(c in n)h=!p&&y&&c in y,d=(h?y:n)[c],f=v&&h?s(d,i):m&&"function"==typeof d?s(Function.call,d):d,y&&!h&&a(y,c,d),b[c]!=d&&o(b,c,f),m&&x[c]!=d&&(x[c]=d)};i.core=r,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,t.exports=u},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){var n=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},function(t,e,n){var i=n(4),r=n(9);t.exports=n(10)?function(t,e,n){return i.setDesc(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){t.exports=!n(11)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e,n){var i=n(6),r=n(8),o=n(13)("src"),a="toString",s=Function[a],l=(""+s).split(a);n(7).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,a){"function"==typeof n&&(n.hasOwnProperty(o)||r(n,o,t[e]?""+t[e]:l.join(String(e))),n.hasOwnProperty("name")||r(n,"name",e)),t===i?t[e]=n:(a||delete t[e],r(t,e,n))})(Function.prototype,a,function(){return"function"==typeof this&&this[o]||s.call(this)})},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){var i=n(15);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){t.exports=n(6).document&&document.documentElement},function(t,e,n){var i=n(18),r=n(6).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(18);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){var i=n(24);t.exports=function(t){return Object(i(t))}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var i=n(26),r=n(24);t.exports=function(t){return i(r(t))}},function(t,e,n){var i=n(20);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(27),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),0>t?r(t+e,0):o(t,e)}},function(t,e,n){var i=n(27),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){var i=n(14),r=n(26),o=n(23),a=n(29),s=n(31);t.exports=function(t){var e=1==t,n=2==t,l=3==t,u=4==t,c=6==t,h=5==t||c;return function(d,f,p){for(var _,g,m=o(d),v=r(m),y=i(f,p,3),b=a(v.length),x=0,w=e?s(d,b):n?s(d,0):void 0;b>x;x++)if((h||x in v)&&(_=v[x],g=y(_,x,m),t))if(e)w[x]=g;else if(g)switch(t){case 3:return!0;case 5:return _;case 6:return x;case 2:w.push(_)}else if(u)return!1;return c?-1:l||u?u:w}}},function(t,e,n){var i=n(18),r=n(32),o=n(33)("species");t.exports=function(t,e){var n;return r(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!r(n.prototype)||(n=void 0),i(n)&&(n=n[o],null===n&&(n=void 0))),new(void 0===n?Array:n)(e)}},function(t,e,n){var i=n(20);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(34)("wks"),r=n(13),o=n(6).Symbol;t.exports=function(t){return i[t]||(i[t]=o&&o[t]||(o||r)("Symbol."+t))}},function(t,e,n){var i=n(6),r="__core-js_shared__",o=i[r]||(i[r]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e,n){var i=n(25),r=n(29),o=n(28);t.exports=function(t){return function(e,n,a){var s,l=i(e),u=r(l.length),c=o(a,u);if(t&&n!=n){for(;u>c;)if(s=l[c++],s!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c;return!t&&-1}}},function(t,e,n){"use strict";var i=n(4),r=n(6),o=n(19),a=n(10),s=n(5),l=n(12),u=n(11),c=n(34),h=n(37),d=n(13),f=n(33),p=n(38),_=n(39),g=n(40),m=n(32),v=n(22),y=n(25),b=n(9),x=i.getDesc,w=i.setDesc,S=i.create,A=_.get,k=r.Symbol,C=r.JSON,T=C&&C.stringify,E=!1,M=f("_hidden"),L=i.isEnum,R=c("symbol-registry"),O=c("symbols"),P="function"==typeof k,D=Object.prototype,I=a&&u(function(){return 7!=S(w({},"a",{get:function(){return w(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=x(D,e);i&&delete D[e],w(t,e,n),i&&t!==D&&w(D,e,i)}:w,N=function(t){var e=O[t]=S(k.prototype);return e._k=t,a&&E&&I(D,t,{configurable:!0,set:function(e){o(this,M)&&o(this[M],t)&&(this[M][t]=!1),I(this,t,b(1,e))}}),e},F=function(t){return"symbol"==typeof t},B=function(t,e,n){return n&&o(O,e)?(n.enumerable?(o(t,M)&&t[M][e]&&(t[M][e]=!1),n=S(n,{enumerable:b(0,!1)})):(o(t,M)||w(t,M,b(1,{})),t[M][e]=!0),I(t,e,n)):w(t,e,n)},z=function(t,e){v(t);for(var n,i=g(e=y(e)),r=0,o=i.length;o>r;)B(t,n=i[r++],e[n]);return t},H=function(t,e){return void 0===e?S(t):z(S(t),e)},q=function(t){var e=L.call(this,t);return e||!o(this,t)||!o(O,t)||o(this,M)&&this[M][t]?e:!0},G=function(t,e){var n=x(t=y(t),e);return!n||!o(O,e)||o(t,M)&&t[M][e]||(n.enumerable=!0),n},j=function(t){for(var e,n=A(y(t)),i=[],r=0;n.length>r;)o(O,e=n[r++])||e==M||i.push(e);return i},U=function(t){for(var e,n=A(y(t)),i=[],r=0;n.length>r;)o(O,e=n[r++])&&i.push(O[e]);return i},V=function(t){if(void 0!==t&&!F(t)){for(var e,n,i=[t],r=1,o=arguments;o.length>r;)i.push(o[r++]);return e=i[1],"function"==typeof e&&(n=e),(n||!m(e))&&(e=function(t,e){return n&&(e=n.call(this,t,e)),F(e)?void 0:e}),i[1]=e,T.apply(C,i)}},W=u(function(){var t=k();return"[null]"!=T([t])||"{}"!=T({a:t})||"{}"!=T(Object(t))});P||(k=function(){if(F(this))throw TypeError("Symbol is not a constructor");return N(d(arguments.length>0?arguments[0]:void 0))},l(k.prototype,"toString",function(){return this._k}),F=function(t){return t instanceof k},i.create=H,i.isEnum=q,i.getDesc=G,i.setDesc=B,i.setDescs=z,i.getNames=_.get=j,i.getSymbols=U,a&&!n(41)&&l(D,"propertyIsEnumerable",q,!0));var X={"for":function(t){return o(R,t+="")?R[t]:R[t]=k(t)},keyFor:function(t){return p(R,t)},useSetter:function(){E=!0},useSimple:function(){E=!1}};i.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(t){var e=f(t);X[t]=P?e:N(e)}),E=!0,s(s.G+s.W,{Symbol:k}),s(s.S,"Symbol",X),s(s.S+s.F*!P,"Object",{create:H,defineProperty:B,defineProperties:z,getOwnPropertyDescriptor:G,getOwnPropertyNames:j,getOwnPropertySymbols:U}),C&&s(s.S+s.F*(!P||W),"JSON",{stringify:V}),h(k,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(t,e,n){var i=n(4).setDesc,r=n(19),o=n(33)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){var i=n(4),r=n(25);t.exports=function(t,e){for(var n,o=r(t),a=i.getKeys(o),s=a.length,l=0;s>l;)if(o[n=a[l++]]===e)return n}},function(t,e,n){var i=n(25),r=n(4).getNames,o={}.toString,a="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return r(t)}catch(e){return a.slice()}};t.exports.get=function(t){return a&&"[object Window]"==o.call(t)?s(t):r(i(t))}},function(t,e,n){var i=n(4);t.exports=function(t){var e=i.getKeys(t),n=i.getSymbols;if(n)for(var r,o=n(t),a=i.isEnum,s=0;o.length>s;)a.call(t,r=o[s++])&&e.push(r);return e}},function(t,e){t.exports=!1},function(t,e,n){var i=n(5);i(i.S+i.F,"Object",{assign:n(43)})},function(t,e,n){var i=n(4),r=n(23),o=n(26);t.exports=n(11)(function(){var t=Object.assign,e={},n={},i=Symbol(),r="abcdefghijklmnopqrst";return e[i]=7,r.split("").forEach(function(t){n[t]=t}),7!=t({},e)[i]||Object.keys(t({},n)).join("")!=r})?function(t,e){for(var n=r(t),a=arguments,s=a.length,l=1,u=i.getKeys,c=i.getSymbols,h=i.isEnum;s>l;)for(var d,f=o(a[l++]),p=c?u(f).concat(c(f)):u(f),_=p.length,g=0;_>g;)h.call(f,d=p[g++])&&(n[d]=f[d]);return n}:Object.assign},function(t,e,n){var i=n(5);i(i.S,"Object",{is:n(45)})},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},function(t,e,n){var i=n(5);i(i.S,"Object",{setPrototypeOf:n(47).set})},function(t,e,n){var i=n(4).getDesc,r=n(18),o=n(22),a=function(t,e){if(o(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n(14)(Function.call,i(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(o){e=!0}return function(t,n){return a(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:a}},function(t,e,n){"use strict";var i=n(49),r={};r[n(33)("toStringTag")]="z",r+""!="[object z]"&&n(12)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(t,e,n){var i=n(20),r=n(33)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=(e=Object(t))[r])?n:o?i(e):"Object"==(a=i(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var i=n(18);n(51)("freeze",function(t){return function(e){return t&&i(e)?t(e):e}})},function(t,e,n){var i=n(5),r=n(7),o=n(11);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){var i=n(18);n(51)("seal",function(t){return function(e){return t&&i(e)?t(e):e}})},function(t,e,n){var i=n(18);n(51)("preventExtensions",function(t){return function(e){return t&&i(e)?t(e):e}})},function(t,e,n){var i=n(18);n(51)("isFrozen",function(t){return function(e){return i(e)?t?t(e):!1:!0}})},function(t,e,n){var i=n(18);n(51)("isSealed",function(t){return function(e){return i(e)?t?t(e):!1:!0}})},function(t,e,n){var i=n(18);n(51)("isExtensible",function(t){return function(e){return i(e)?t?t(e):!0:!1}})},function(t,e,n){var i=n(25);n(51)("getOwnPropertyDescriptor",function(t){return function(e,n){return t(i(e),n)}})},function(t,e,n){var i=n(23);n(51)("getPrototypeOf",function(t){return function(e){return t(i(e))}})},function(t,e,n){var i=n(23);n(51)("keys",function(t){return function(e){return t(i(e))}})},function(t,e,n){n(51)("getOwnPropertyNames",function(){return n(39).get})},function(t,e,n){var i=n(4).setDesc,r=n(9),o=n(19),a=Function.prototype,s=/^\s*function ([^ (]*)/,l="name";l in a||n(10)&&i(a,l,{configurable:!0,get:function(){var t=(""+this).match(s),e=t?t[1]:"";return o(this,l)||i(this,l,r(5,e)),e}})},function(t,e,n){"use strict";var i=n(4),r=n(18),o=n(33)("hasInstance"),a=Function.prototype;o in a||i.setDesc(a,o,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i.getProto(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){"use strict";var i=n(4),r=n(6),o=n(19),a=n(20),s=n(64),l=n(11),u=n(65).trim,c="Number",h=r[c],d=h,f=h.prototype,p=a(i.create(f))==c,_="trim"in String.prototype,g=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=_?e.trim():u(e,3);var n,i,r,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var a,l=e.slice(2),c=0,h=l.length;h>c;c++)if(a=l.charCodeAt(c),48>a||a>r)return NaN;return parseInt(l,i)}}return+e};h(" 0o1")&&h("0b1")&&!h("+0x1")||(h=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof h&&(p?l(function(){f.valueOf.call(n)}):a(n)!=c)?new d(g(e)):g(e)},i.each.call(n(10)?i.getNames(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),function(t){o(d,t)&&!o(h,t)&&i.setDesc(h,t,i.getDesc(d,t))}),h.prototype=f,f.constructor=h,n(12)(r,c,h))},function(t,e,n){var i=n(18);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(5),r=n(24),o=n(11),a="	\n\x0B\f\r   ᠎             　\u2028\u2029\ufeff",s="["+a+"]",l="​",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),h=function(t,e){var n={};n[t]=e(d),i(i.P+i.F*o(function(){return!!a[t]()||l[t]()!=l}),"String",n)},d=h.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(c,"")),t};t.exports=h},function(t,e,n){var i=n(5);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var i=n(5),r=n(6).isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},function(t,e,n){var i=n(5);i(i.S,"Number",{isInteger:n(69)})},function(t,e,n){var i=n(18),r=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&r(t)===t}},function(t,e,n){var i=n(5);i(i.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var i=n(5),r=n(69),o=Math.abs;i(i.S,"Number",{isSafeInteger:function(t){return r(t)&&o(t)<=9007199254740991}})},function(t,e,n){var i=n(5);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var i=n(5);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var i=n(5);i(i.S,"Number",{parseFloat:parseFloat})},function(t,e,n){var i=n(5);i(i.S,"Number",{parseInt:parseInt})},function(t,e,n){var i=n(5),r=n(77),o=Math.sqrt,a=Math.acosh;i(i.S+i.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:r(t-1+o(t-1)*o(t+1))}})},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&1e-8>t?t-t*t/2:Math.log(1+t)}},function(t,e,n){function i(t){return isFinite(t=+t)&&0!=t?0>t?-i(-t):Math.log(t+Math.sqrt(t*t+1)):t}var r=n(5);r(r.S,"Math",{asinh:i})},function(t,e,n){var i=n(5);i(i.S,"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var i=n(5),r=n(81);i(i.S,"Math",{cbrt:function(t){return r(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:0>t?-1:1}},function(t,e,n){var i=n(5);i(i.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var i=n(5),r=Math.exp;i(i.S,"Math",{cosh:function(t){return(r(t=+t)+r(-t))/2}})},function(t,e,n){var i=n(5);i(i.S,"Math",{expm1:n(85)})},function(t,e){t.exports=Math.expm1||function(t){return 0==(t=+t)?t:t>-1e-6&&1e-6>t?t+t*t/2:Math.exp(t)-1}},function(t,e,n){var i=n(5),r=n(81),o=Math.pow,a=o(2,-52),s=o(2,-23),l=o(2,127)*(2-s),u=o(2,-126),c=function(t){return t+1/a-1/a};i(i.S,"Math",{fround:function(t){var e,n,i=Math.abs(t),o=r(t);return u>i?o*c(i/u/s)*u*s:(e=(1+s/a)*i,n=e-(e-i),n>l||n!=n?o*(1/0):o*n)}})},function(t,e,n){var i=n(5),r=Math.abs;i(i.S,"Math",{hypot:function(t,e){for(var n,i,o=0,a=0,s=arguments,l=s.length,u=0;l>a;)n=r(s[a++]),n>u?(i=u/n,o=o*i*i+1,u=n):n>0?(i=n/u,o+=i*i):o+=n;return u===1/0?1/0:u*Math.sqrt(o)}})},function(t,e,n){var i=n(5),r=Math.imul;i(i.S+i.F*n(11)(function(){return-5!=r(4294967295,5)||2!=r.length}),"Math",{imul:function(t,e){var n=65535,i=+t,r=+e,o=n&i,a=n&r;return 0|o*a+((n&i>>>16)*a+o*(n&r>>>16)<<16>>>0)}})},function(t,e,n){var i=n(5);i(i.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,e,n){var i=n(5);i(i.S,"Math",{log1p:n(77)})},function(t,e,n){var i=n(5);i(i.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var i=n(5);i(i.S,"Math",{sign:n(81)})},function(t,e,n){var i=n(5),r=n(85),o=Math.exp;i(i.S+i.F*n(11)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(r(t)-r(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,n){var i=n(5),r=n(85),o=Math.exp;i(i.S,"Math",{tanh:function(t){var e=r(t=+t),n=r(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},function(t,e,n){var i=n(5);i(i.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var i=n(5),r=n(28),o=String.fromCharCode,a=String.fromCodePoint;i(i.S+i.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],i=arguments,a=i.length,s=0;a>s;){if(e=+i[s++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(65536>e?o(e):o(((e-=65536)>>10)+55296,e%1024+56320))}return n.join("")}})},function(t,e,n){var i=n(5),r=n(25),o=n(29);i(i.S,"String",{raw:function(t){for(var e=r(t.raw),n=o(e.length),i=arguments,a=i.length,s=[],l=0;n>l;)s.push(String(e[l++])),a>l&&s.push(String(i[l]));return s.join("")}})},function(t,e,n){"use strict";n(65)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var i=n(100)(!0);n(101)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){var i=n(27),r=n(24);t.exports=function(t){return function(e,n){var o,a,s=String(r(e)),l=i(n),u=s.length;return 0>l||l>=u?t?"":void 0:(o=s.charCodeAt(l),55296>o||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):o:t?s.slice(l,l+2):(o-55296<<10)+(a-56320)+65536)}}},function(t,e,n){"use strict";var i=n(41),r=n(5),o=n(12),a=n(8),s=n(19),l=n(102),u=n(103),c=n(37),h=n(4).getProto,d=n(33)("iterator"),f=!([].keys&&"next"in[].keys()),p="@@iterator",_="keys",g="values",m=function(){return this};t.exports=function(t,e,n,v,y,b,x){u(n,e,v);var w,S,A=function(t){if(!f&&t in E)return E[t];switch(t){case _:return function(){return new n(this,t)};case g:return function(){return new n(this,t)}}return function(){return new n(this,t)}},k=e+" Iterator",C=y==g,T=!1,E=t.prototype,M=E[d]||E[p]||y&&E[y],L=M||A(y);if(M){var R=h(L.call(new t));c(R,k,!0),!i&&s(E,p)&&a(R,d,m),C&&M.name!==g&&(T=!0,L=function(){return M.call(this)})}if(i&&!x||!f&&!T&&E[d]||a(E,d,L),l[e]=L,l[k]=m,y)if(w={values:C?L:A(g),keys:b?L:A(_),entries:C?A("entries"):L},x)for(S in w)S in E||o(E,S,w[S]);else r(r.P+r.F*(f||T),e,w);return w}},function(t,e){t.exports={}},function(t,e,n){"use strict";var i=n(4),r=n(9),o=n(37),a={};n(8)(a,n(33)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i.create(a,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){"use strict";var i=n(5),r=n(100)(!1);i(i.P,"String",{codePointAt:function(t){return r(this,t)}})},function(t,e,n){"use strict";var i=n(5),r=n(29),o=n(106),a="endsWith",s=""[a];i(i.P+i.F*n(108)(a),"String",{endsWith:function(t){var e=o(this,t,a),n=arguments,i=n.length>1?n[1]:void 0,l=r(e.length),u=void 0===i?l:Math.min(r(i),l),c=String(t);return s?s.call(e,c,u):e.slice(u-c.length,u)===c}})},function(t,e,n){var i=n(107),r=n(24);t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},function(t,e,n){var i=n(18),r=n(20),o=n(33)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},function(t,e,n){var i=n(33)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(r){}}return!0}},function(t,e,n){"use strict";var i=n(5),r=n(106),o="includes";i(i.P+i.F*n(108)(o),"String",{includes:function(t){return!!~r(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var i=n(5);i(i.P,"String",{repeat:n(111)})},function(t,e,n){"use strict";var i=n(27),r=n(24);t.exports=function(t){var e=String(r(this)),n="",o=i(t);if(0>o||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e,n){"use strict";var i=n(5),r=n(29),o=n(106),a="startsWith",s=""[a];i(i.P+i.F*n(108)(a),"String",{startsWith:function(t){var e=o(this,t,a),n=arguments,i=r(Math.min(n.length>1?n[1]:void 0,e.length)),l=String(t);return s?s.call(e,l,i):e.slice(i,i+l.length)===l}})},function(t,e,n){"use strict";var i=n(14),r=n(5),o=n(23),a=n(114),s=n(115),l=n(29),u=n(116);r(r.S+r.F*!n(117)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,c,h=o(t),d="function"==typeof this?this:Array,f=arguments,p=f.length,_=p>1?f[1]:void 0,g=void 0!==_,m=0,v=u(h);if(g&&(_=i(_,p>2?f[2]:void 0,2)),void 0==v||d==Array&&s(v))for(e=l(h.length),n=new d(e);e>m;m++)n[m]=g?_(h[m],m):h[m];else for(c=v.call(h),n=new d;!(r=c.next()).done;m++)n[m]=g?a(c,_,[r.value,m],!0):r.value;return n.length=m,n}})},function(t,e,n){var i=n(22);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(o){var a=t["return"];throw void 0!==a&&i(a.call(t)),o}}},function(t,e,n){var i=n(102),r=n(33)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){var i=n(49),r=n(33)("iterator"),o=n(102);t.exports=n(7).getIteratorMethod=function(t){return void 0!=t?t[r]||t["@@iterator"]||o[i(t)]:void 0}},function(t,e,n){var i=n(33)("iterator"),r=!1;try{var o=[7][i]();o["return"]=function(){r=!0},Array.from(o,function(){throw 2})}catch(a){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){n=!0},o[i]=function(){return a},t(o)}catch(s){}return n}},function(t,e,n){"use strict";var i=n(5);i(i.S+i.F*n(11)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments,n=e.length,i=new("function"==typeof this?this:Array)(n);n>t;)i[t]=e[t++];return i.length=n,i}})},function(t,e,n){"use strict";var i=n(120),r=n(121),o=n(102),a=n(25);t.exports=n(101)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,n):"values"==e?r(0,t[n]):r(0,[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){var i=n(33)("unscopables"),r=Array.prototype;void 0==r[i]&&n(8)(r,i,{}),t.exports=function(t){r[i][t]=!0}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){n(123)("Array")},function(t,e,n){"use strict";var i=n(6),r=n(4),o=n(10),a=n(33)("species");t.exports=function(t){var e=i[t];o&&e&&!e[a]&&r.setDesc(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(5);i(i.P,"Array",{copyWithin:n(125)}),n(120)("copyWithin")},function(t,e,n){"use strict";var i=n(23),r=n(28),o=n(29);t.exports=[].copyWithin||function(t,e){var n=i(this),a=o(n.length),s=r(t,a),l=r(e,a),u=arguments,c=u.length>2?u[2]:void 0,h=Math.min((void 0===c?a:r(c,a))-l,a-s),d=1;for(s>l&&l+h>s&&(d=-1,l+=h-1,s+=h-1);h-- >0;)l in n?n[s]=n[l]:delete n[s],s+=d,l+=d;return n}},function(t,e,n){var i=n(5);i(i.P,"Array",{fill:n(127)}),n(120)("fill")},function(t,e,n){"use strict";var i=n(23),r=n(28),o=n(29);t.exports=[].fill||function(t){for(var e=i(this),n=o(e.length),a=arguments,s=a.length,l=r(s>1?a[1]:void 0,n),u=s>2?a[2]:void 0,c=void 0===u?n:r(u,n);c>l;)e[l++]=t;return e}},function(t,e,n){"use strict";var i=n(5),r=n(30)(5),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),i(i.P+i.F*a,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(120)(o)},function(t,e,n){"use strict";var i=n(5),r=n(30)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),i(i.P+i.F*a,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(120)(o)},function(t,e,n){var i=n(4),r=n(6),o=n(107),a=n(131),s=r.RegExp,l=s,u=s.prototype,c=/a/g,h=/a/g,d=new s(c)!==c;!n(10)||d&&!n(11)(function(){return h[n(33)("match")]=!1,s(c)!=c||s(h)==h||"/a/i"!=s(c,"i")})||(s=function(t,e){var n=o(t),i=void 0===e;return this instanceof s||!n||t.constructor!==s||!i?d?new l(n&&!i?t.source:t,e):l((n=t instanceof s)?t.source:t,n&&i?a.call(t):e):t},i.each.call(i.getNames(l),function(t){t in s||i.setDesc(s,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})}),u.constructor=s,s.prototype=u,n(12)(r,"RegExp",s)),n(123)("RegExp")},function(t,e,n){"use strict";var i=n(22);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var i=n(4);n(10)&&"g"!=/./g.flags&&i.setDesc(RegExp.prototype,"flags",{configurable:!0,get:n(131)})},function(t,e,n){n(134)("match",1,function(t,e){return function(n){"use strict";var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))}})},function(t,e,n){"use strict";var i=n(8),r=n(12),o=n(11),a=n(24),s=n(33);t.exports=function(t,e,n){var l=s(t),u=""[t];o(function(){var e={};return e[l]=function(){return 7},7!=""[t](e)})&&(r(String.prototype,t,n(a,l,u)),i(RegExp.prototype,l,2==e?function(t,e){return u.call(t,this,e)}:function(t){return u.call(t,this)}))}},function(t,e,n){n(134)("replace",2,function(t,e,n){return function(i,r){"use strict";var o=t(this),a=void 0==i?void 0:i[e];return void 0!==a?a.call(i,o,r):n.call(String(o),i,r)}})},function(t,e,n){n(134)("search",1,function(t,e){return function(n){"use strict";var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))}})},function(t,e,n){n(134)("split",2,function(t,e,n){return function(i,r){"use strict";var o=t(this),a=void 0==i?void 0:i[e];return void 0!==a?a.call(i,o,r):n.call(String(o),i,r)}})},function(t,e,n){"use strict";var i,r=n(4),o=n(41),a=n(6),s=n(14),l=n(49),u=n(5),c=n(18),h=n(22),d=n(15),f=n(139),p=n(140),_=n(47).set,g=n(45),m=n(33)("species"),v=n(141),y=n(142),b="Promise",x=a.process,w="process"==l(x),S=a[b],A=function(t){var e=new S(function(){});return t&&(e.constructor=Object),S.resolve(e)===e},k=function(){function t(e){var n=new S(e);return _(n,t.prototype),n}var e=!1;try{if(e=S&&S.resolve&&A(),_(t,S),t.prototype=r.create(S.prototype,{constructor:{
value:t}}),t.resolve(5).then(function(){})instanceof t||(e=!1),e&&n(10)){var i=!1;S.resolve(r.setDesc({},"then",{get:function(){i=!0}})),e=i}}catch(o){e=!1}return e}(),C=function(t,e){return o&&t===S&&e===i?!0:g(t,e)},T=function(t){var e=h(t)[m];return void 0!=e?e:t},E=function(t){var e;return c(t)&&"function"==typeof(e=t.then)?e:!1},M=function(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=d(e),this.reject=d(n)},L=function(t){try{t()}catch(e){return{error:e}}},R=function(t,e){if(!t.n){t.n=!0;var n=t.c;y(function(){for(var i=t.v,r=1==t.s,o=0,s=function(e){var n,o,a=r?e.ok:e.fail,s=e.resolve,l=e.reject;try{a?(r||(t.h=!0),n=a===!0?i:a(i),n===e.promise?l(TypeError("Promise-chain cycle")):(o=E(n))?o.call(n,s,l):s(n)):l(i)}catch(u){l(u)}};n.length>o;)s(n[o++]);n.length=0,t.n=!1,e&&setTimeout(function(){var e,n,r=t.p;O(r)&&(w?x.emit("unhandledRejection",i,r):(e=a.onunhandledrejection)?e({promise:r,reason:i}):(n=a.console)&&n.error&&n.error("Unhandled promise rejection",i)),t.a=void 0},1)})}},O=function(t){var e,n=t._d,i=n.a||n.c,r=0;if(n.h)return!1;for(;i.length>r;)if(e=i[r++],e.fail||!O(e.promise))return!1;return!0},P=function(t){var e=this;e.d||(e.d=!0,e=e.r||e,e.v=t,e.s=2,e.a=e.c.slice(),R(e,!0))},D=function(t){var e,n=this;if(!n.d){n.d=!0,n=n.r||n;try{if(n.p===t)throw TypeError("Promise can't be resolved itself");(e=E(t))?y(function(){var i={r:n,d:!1};try{e.call(t,s(D,i,1),s(P,i,1))}catch(r){P.call(i,r)}}):(n.v=t,n.s=1,R(n,!1))}catch(i){P.call({r:n,d:!1},i)}}};k||(S=function(t){d(t);var e=this._d={p:f(this,S,b),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{t(s(D,e,1),s(P,e,1))}catch(n){P.call(e,n)}},n(144)(S.prototype,{then:function(t,e){var n=new M(v(this,S)),i=n.promise,r=this._d;return n.ok="function"==typeof t?t:!0,n.fail="function"==typeof e&&e,r.c.push(n),r.a&&r.a.push(n),r.s&&R(r,!1),i},"catch":function(t){return this.then(void 0,t)}})),u(u.G+u.W+u.F*!k,{Promise:S}),n(37)(S,b),n(123)(b),i=n(7)[b],u(u.S+u.F*!k,b,{reject:function(t){var e=new M(this),n=e.reject;return n(t),e.promise}}),u(u.S+u.F*(!k||A(!0)),b,{resolve:function(t){if(t instanceof S&&C(t.constructor,this))return t;var e=new M(this),n=e.resolve;return n(t),e.promise}}),u(u.S+u.F*!(k&&n(117)(function(t){S.all(t)["catch"](function(){})})),b,{all:function(t){var e=T(this),n=new M(e),i=n.resolve,o=n.reject,a=[],s=L(function(){p(t,!1,a.push,a);var n=a.length,s=Array(n);n?r.each.call(a,function(t,r){var a=!1;e.resolve(t).then(function(t){a||(a=!0,s[r]=t,--n||i(s))},o)}):i(s)});return s&&o(s.error),n.promise},race:function(t){var e=T(this),n=new M(e),i=n.reject,r=L(function(){p(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r&&i(r.error),n.promise}})},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError(n+": use the 'new' operator!");return t}},function(t,e,n){var i=n(14),r=n(114),o=n(115),a=n(22),s=n(29),l=n(116);t.exports=function(t,e,n,u){var c,h,d,f=l(t),p=i(n,u,e?2:1),_=0;if("function"!=typeof f)throw TypeError(t+" is not iterable!");if(o(f))for(c=s(t.length);c>_;_++)e?p(a(h=t[_])[0],h[1]):p(t[_]);else for(d=f.call(t);!(h=d.next()).done;)r(d,p,h.value,e)}},function(t,e,n){var i=n(22),r=n(15),o=n(33)("species");t.exports=function(t,e){var n,a=i(t).constructor;return void 0===a||void 0==(n=i(a)[o])?e:r(n)}},function(t,e,n){var i,r,o,a=n(6),s=n(143).set,l=a.MutationObserver||a.WebKitMutationObserver,u=a.process,c=a.Promise,h="process"==n(20)(u),d=function(){var t,e,n;for(h&&(t=u.domain)&&(u.domain=null,t.exit());i;)e=i.domain,n=i.fn,e&&e.enter(),n(),e&&e.exit(),i=i.next;r=void 0,t&&t.enter()};if(h)o=function(){u.nextTick(d)};else if(l){var f=1,p=document.createTextNode("");new l(d).observe(p,{characterData:!0}),o=function(){p.data=f=-f}}else o=c&&c.resolve?function(){c.resolve().then(d)}:function(){s.call(a,d)};t.exports=function(t){var e={fn:t,next:void 0,domain:h&&u.domain};r&&(r.next=e),i||(i=e,o()),r=e}},function(t,e,n){var i,r,o,a=n(14),s=n(21),l=n(16),u=n(17),c=n(6),h=c.process,d=c.setImmediate,f=c.clearImmediate,p=c.MessageChannel,_=0,g={},m="onreadystatechange",v=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},y=function(t){v.call(t.data)};d&&f||(d=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++_]=function(){s("function"==typeof t?t:Function(t),e)},i(_),_},f=function(t){delete g[t]},"process"==n(20)(h)?i=function(t){h.nextTick(a(v,t,1))}:p?(r=new p,o=r.port2,r.port1.onmessage=y,i=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(t){c.postMessage(t+"","*")},c.addEventListener("message",y,!1)):i=m in u("script")?function(t){l.appendChild(u("script"))[m]=function(){l.removeChild(this),v.call(t)}}:function(t){setTimeout(a(v,t,1),0)}),t.exports={set:d,clear:f}},function(t,e,n){var i=n(12);t.exports=function(t,e){for(var n in e)i(t,n,e[n]);return t}},function(t,e,n){"use strict";var i=n(146);n(147)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=i.getEntry(this,t);return e&&e.v},set:function(t,e){return i.def(this,0===t?0:t,e)}},i,!0)},function(t,e,n){"use strict";var i=n(4),r=n(8),o=n(144),a=n(14),s=n(139),l=n(24),u=n(140),c=n(101),h=n(121),d=n(13)("id"),f=n(19),p=n(18),_=n(123),g=n(10),m=Object.isExtensible||p,v=g?"_s":"size",y=0,b=function(t,e){if(!p(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!f(t,d)){if(!m(t))return"F";if(!e)return"E";r(t,d,++y)}return"O"+t[d]},x=function(t,e){var n,i=b(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,r){var c=t(function(t,o){s(t,c,e),t._i=i.create(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=o&&u(o,n,t[r],t)});return o(c.prototype,{clear:function(){for(var t=this,e=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete e[n.i];t._f=t._l=void 0,t[v]=0},"delete":function(t){var e=this,n=x(e,t);if(n){var i=n.n,r=n.p;delete e._i[n.i],n.r=!0,r&&(r.n=i),i&&(i.p=r),e._f==n&&(e._f=i),e._l==n&&(e._l=r),e[v]--}return!!n},forEach:function(t){for(var e,n=a(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.n:this._f;)for(n(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!x(this,t)}}),g&&i.setDesc(c.prototype,"size",{get:function(){return l(this[v])}}),c},def:function(t,e,n){var i,r,o=x(t,e);return o?o.v=n:(t._l=o={i:r=b(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=o),i&&(i.n=o),t[v]++,"F"!==r&&(t._i[r]=o)),t},getEntry:x,setStrong:function(t,e,n){c(t,e,function(t,e){this._t=t,this._k=e,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?"keys"==e?h(0,n.k):"values"==e?h(0,n.v):h(0,[n.k,n.v]):(t._t=void 0,h(1))},n?"entries":"values",!n,!0),_(e)}}},function(t,e,n){"use strict";var i=n(6),r=n(5),o=n(12),a=n(144),s=n(140),l=n(139),u=n(18),c=n(11),h=n(117),d=n(37);t.exports=function(t,e,n,f,p,_){var g=i[t],m=g,v=p?"set":"add",y=m&&m.prototype,b={},x=function(t){var e=y[t];o(y,t,"delete"==t?function(t){return _&&!u(t)?!1:e.call(this,0===t?0:t)}:"has"==t?function(t){return _&&!u(t)?!1:e.call(this,0===t?0:t)}:"get"==t?function(t){return _&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof m&&(_||y.forEach&&!c(function(){(new m).entries().next()}))){var w,S=new m,A=S[v](_?{}:-0,1)!=S,k=c(function(){S.has(1)}),C=h(function(t){new m(t)});C||(m=e(function(e,n){l(e,m,t);var i=new g;return void 0!=n&&s(n,p,i[v],i),i}),m.prototype=y,y.constructor=m),_||S.forEach(function(t,e){w=1/e===-(1/0)}),(k||w)&&(x("delete"),x("has"),p&&x("get")),(w||A)&&x(v),_&&y.clear&&delete y.clear}else m=f.getConstructor(e,t,p,v),a(m.prototype,n);return d(m,t),b[t]=m,r(r.G+r.W+r.F*(m!=g),b),_||f.setStrong(m,t,p),m}},function(t,e,n){"use strict";var i=n(146);n(147)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(this,t=0===t?0:t,t)}},i)},function(t,e,n){"use strict";var i=n(4),r=n(12),o=n(150),a=n(18),s=n(19),l=o.frozenStore,u=o.WEAK,c=Object.isExtensible||a,h={},d=n(147)("WeakMap",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){if(a(t)){if(!c(t))return l(this).get(t);if(s(t,u))return t[u][this._i]}},set:function(t,e){return o.def(this,t,e)}},o,!0,!0);7!=(new d).set((Object.freeze||Object)(h),7).get(h)&&i.each.call(["delete","has","get","set"],function(t){var e=d.prototype,n=e[t];r(e,t,function(e,i){if(a(e)&&!c(e)){var r=l(this)[t](e,i);return"set"==t?this:r}return n.call(this,e,i)})})},function(t,e,n){"use strict";var i=n(8),r=n(144),o=n(22),a=n(18),s=n(139),l=n(140),u=n(30),c=n(19),h=n(13)("weak"),d=Object.isExtensible||a,f=u(5),p=u(6),_=0,g=function(t){return t._l||(t._l=new m)},m=function(){this.a=[]},v=function(t,e){return f(t.a,function(t){return t[0]===e})};m.prototype={get:function(t){var e=v(this,t);return e?e[1]:void 0},has:function(t){return!!v(this,t)},set:function(t,e){var n=v(this,t);n?n[1]=e:this.a.push([t,e])},"delete":function(t){var e=p(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,i){var o=t(function(t,r){s(t,o,e),t._i=_++,t._l=void 0,void 0!=r&&l(r,n,t[i],t)});return r(o.prototype,{"delete":function(t){return a(t)?d(t)?c(t,h)&&c(t[h],this._i)&&delete t[h][this._i]:g(this)["delete"](t):!1},has:function(t){return a(t)?d(t)?c(t,h)&&c(t[h],this._i):g(this).has(t):!1}}),o},def:function(t,e,n){return d(o(e))?(c(e,h)||i(e,h,{}),e[h][t._i]=n):g(t).set(e,n),t},frozenStore:g,WEAK:h}},function(t,e,n){"use strict";var i=n(150);n(147)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(this,t,!0)}},i,!1,!0)},function(t,e,n){var i=n(5),r=Function.apply;i(i.S,"Reflect",{apply:function(t,e,n){return r.call(t,e,n)}})},function(t,e,n){var i=n(4),r=n(5),o=n(15),a=n(22),s=n(18),l=Function.bind||n(7).Function.prototype.bind;r(r.S+r.F*n(11)(function(){function t(){}return!(Reflect.construct(function(){},[],t)instanceof t)}),"Reflect",{construct:function(t,e){o(t);var n=arguments.length<3?t:o(arguments[2]);if(t==n){if(void 0!=e)switch(a(e).length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(l.apply(t,r))}var u=n.prototype,c=i.create(s(u)?u:Object.prototype),h=Function.apply.call(t,c,e);return s(h)?h:c}})},function(t,e,n){var i=n(4),r=n(5),o=n(22);r(r.S+r.F*n(11)(function(){Reflect.defineProperty(i.setDesc({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){o(t);try{return i.setDesc(t,e,n),!0}catch(r){return!1}}})},function(t,e,n){var i=n(5),r=n(4).getDesc,o=n(22);i(i.S,"Reflect",{deleteProperty:function(t,e){var n=r(o(t),e);return n&&!n.configurable?!1:delete t[e]}})},function(t,e,n){"use strict";var i=n(5),r=n(22),o=function(t){this._t=r(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(103)(o,"Object",function(){var t,e=this,n=e._k;do if(e._i>=n.length)return{value:void 0,done:!0};while(!((t=n[e._i++])in e._t));return{value:t,done:!1}}),i(i.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,n){function i(t,e){var n,a,u=arguments.length<3?t:arguments[2];return l(t)===u?t[e]:(n=r.getDesc(t,e))?o(n,"value")?n.value:void 0!==n.get?n.get.call(u):void 0:s(a=r.getProto(t))?i(a,e,u):void 0}var r=n(4),o=n(19),a=n(5),s=n(18),l=n(22);a(a.S,"Reflect",{get:i})},function(t,e,n){var i=n(4),r=n(5),o=n(22);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return i.getDesc(o(t),e)}})},function(t,e,n){var i=n(5),r=n(4).getProto,o=n(22);i(i.S,"Reflect",{getPrototypeOf:function(t){return r(o(t))}})},function(t,e,n){var i=n(5);i(i.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var i=n(5),r=n(22),o=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(t){return r(t),o?o(t):!0}})},function(t,e,n){var i=n(5);i(i.S,"Reflect",{ownKeys:n(163)})},function(t,e,n){var i=n(4),r=n(22),o=n(6).Reflect;t.exports=o&&o.ownKeys||function(t){var e=i.getNames(r(t)),n=i.getSymbols;return n?e.concat(n(t)):e}},function(t,e,n){var i=n(5),r=n(22),o=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(t){r(t);try{return o&&o(t),!0}catch(e){return!1}}})},function(t,e,n){function i(t,e,n){var a,c,h=arguments.length<4?t:arguments[3],d=r.getDesc(l(t),e);if(!d){if(u(c=r.getProto(t)))return i(c,e,n,h);d=s(0)}return o(d,"value")?d.writable!==!1&&u(h)?(a=r.getDesc(h,e)||s(0),a.value=n,r.setDesc(h,e,a),!0):!1:void 0===d.set?!1:(d.set.call(h,n),!0)}var r=n(4),o=n(19),a=n(5),s=n(9),l=n(22),u=n(18);a(a.S,"Reflect",{set:i})},function(t,e,n){var i=n(5),r=n(47);r&&i(i.S,"Reflect",{setPrototypeOf:function(t,e){r.check(t,e);try{return r.set(t,e),!0}catch(n){return!1}}})},function(t,e,n){"use strict";var i=n(5),r=n(35)(!0);i(i.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(120)("includes")},function(t,e,n){"use strict";var i=n(5),r=n(100)(!0);i(i.P,"String",{at:function(t){return r(this,t)}})},function(t,e,n){"use strict";var i=n(5),r=n(170);i(i.P,"String",{padLeft:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){var i=n(29),r=n(111),o=n(24);t.exports=function(t,e,n,a){var s=String(o(t)),l=s.length,u=void 0===n?" ":String(n),c=i(e);if(l>=c)return s;""==u&&(u=" ");var h=c-l,d=r.call(u,Math.ceil(h/u.length));return d.length>h&&(d=d.slice(0,h)),a?d+s:s+d}},function(t,e,n){"use strict";var i=n(5),r=n(170);i(i.P,"String",{padRight:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(65)("trimLeft",function(t){return function(){return t(this,1)}})},function(t,e,n){"use strict";n(65)("trimRight",function(t){return function(){return t(this,2)}})},function(t,e,n){var i=n(5),r=n(175)(/[\\^$*+?.()|[\]{}]/g,"\\$&");i(i.S,"RegExp",{escape:function(t){return r(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){var i=n(4),r=n(5),o=n(163),a=n(25),s=n(9);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=a(t),l=i.setDesc,u=i.getDesc,c=o(r),h={},d=0;c.length>d;)n=u(r,e=c[d++]),e in h?l(h,e,s(0,n)):h[e]=n;return h}})},function(t,e,n){var i=n(5),r=n(178)(!1);i(i.S,"Object",{values:function(t){return r(t)}})},function(t,e,n){var i=n(4),r=n(25),o=i.isEnum;t.exports=function(t){return function(e){for(var n,a=r(e),s=i.getKeys(a),l=s.length,u=0,c=[];l>u;)o.call(a,n=s[u++])&&c.push(t?[n,a[n]]:a[n]);return c}}},function(t,e,n){var i=n(5),r=n(178)(!0);i(i.S,"Object",{entries:function(t){return r(t)}})},function(t,e,n){var i=n(5);i(i.P,"Map",{toJSON:n(181)("Map")})},function(t,e,n){var i=n(140),r=n(49);t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");var e=[];return i(this,!1,e.push,e),e}}},function(t,e,n){var i=n(5);i(i.P,"Set",{toJSON:n(181)("Set")})},function(t,e,n){var i=n(4),r=n(5),o=n(14),a=n(7).Array||Array,s={},l=function(t,e){i.each.call(t.split(","),function(t){void 0==e&&t in a?s[t]=a[t]:t in[]&&(s[t]=o(Function.call,[][t],e))})};l("pop,reverse,shift,keys,values,entries",1),l("indexOf,every,some,forEach,map,filter,find,findIndex,includes",3),l("join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill"),r(r.S,"Array",s)},function(t,e,n){var i=n(6),r=n(5),o=n(21),a=n(185),s=i.navigator,l=!!s&&/MSIE .\./.test(s.userAgent),u=function(t){return l?function(e,n){return t(o(a,[].slice.call(arguments,2),"function"==typeof e?e:Function(e)),n)}:t};r(r.G+r.B+r.F*l,{setTimeout:u(i.setTimeout),setInterval:u(i.setInterval)})},function(t,e,n){"use strict";var i=n(186),r=n(21),o=n(15);t.exports=function(){for(var t=o(this),e=arguments.length,n=Array(e),a=0,s=i._,l=!1;e>a;)(n[a]=arguments[a++])===s&&(l=!0);return function(){var i,o=this,a=arguments,u=a.length,c=0,h=0;if(!l&&!u)return r(t,n,o);if(i=n.slice(),l)for(;e>c;c++)i[c]===s&&(i[c]=a[h++]);for(;u>h;)i.push(a[h++]);return r(t,i,o)}}},function(t,e,n){t.exports=n(6)},function(t,e,n){var i=n(5),r=n(143);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},function(t,e,n){n(119);var i=n(6),r=n(8),o=n(102),a=n(33)("iterator"),s=i.NodeList,l=i.HTMLCollection,u=s&&s.prototype,c=l&&l.prototype,h=o.NodeList=o.HTMLCollection=o.Array;u&&!u[a]&&r(u,a,h),c&&!c[a]&&r(c,a,h)},function(t,e,n){(function(e,n){!function(e){"use strict";function i(t,e,n,i){var r=Object.create((e||o).prototype),a=new p(i||[]);return r._invoke=h(t,n,a),r}function r(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(i){return{type:"throw",arg:i}}}function o(){}function a(){}function s(){}function l(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function u(t){this.arg=t}function c(t){function e(e,n){var i=t[e](n),r=i.value;return r instanceof u?Promise.resolve(r.arg).then(o,a):Promise.resolve(r).then(function(t){return i.value=t,i})}function i(t,n){function i(){return e(t,n)}return r=r?r.then(i,i):new Promise(function(t){t(i())})}"object"==typeof n&&n.domain&&(e=n.domain.bind(e));var r,o=e.bind(t,"next"),a=e.bind(t,"throw");e.bind(t,"return");this._invoke=i}function h(t,e,n){var i=w;return function(o,a){if(i===A)throw new Error("Generator is already running");if(i===k){if("throw"===o)throw a;return g()}for(;;){var s=n.delegate;if(s){if("return"===o||"throw"===o&&s.iterator[o]===m){n.delegate=null;var l=s.iterator["return"];if(l){var u=r(l,s.iterator,a);if("throw"===u.type){o="throw",a=u.arg;continue}}if("return"===o)continue}var u=r(s.iterator[o],s.iterator,a);if("throw"===u.type){n.delegate=null,o="throw",a=u.arg;continue}o="next",a=m;var c=u.arg;if(!c.done)return i=S,c;n[s.resultName]=c.value,n.next=s.nextLoc,n.delegate=null}if("next"===o)n._sent=a,i===S?n.sent=a:n.sent=m;else if("throw"===o){if(i===w)throw i=k,a;n.dispatchException(a)&&(o="next",a=m)}else"return"===o&&n.abrupt("return",a);i=A;var u=r(t,e,n);if("normal"===u.type){i=n.done?k:S;var c={value:u.arg,done:n.done};if(u.arg!==C)return c;n.delegate&&"next"===o&&(a=m)}else"throw"===u.type&&(i=k,o="throw",a=u.arg)}}}function d(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function f(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(d,this),this.reset(!0)}function _(t){if(t){var e=t[y];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(v.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=m,r.done=!0,r};return i.next=i}}return{next:g}}function g(){return{value:m,done:!0}}var m,v=Object.prototype.hasOwnProperty,y="function"==typeof Symbol&&Symbol.iterator||"@@iterator",b="object"==typeof t,x=e.regeneratorRuntime;if(x)return void(b&&(t.exports=x));x=e.regeneratorRuntime=b?t.exports:{},x.wrap=i;var w="suspendedStart",S="suspendedYield",A="executing",k="completed",C={},T=s.prototype=o.prototype;a.prototype=T.constructor=s,s.constructor=a,a.displayName="GeneratorFunction",x.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return e?e===a||"GeneratorFunction"===(e.displayName||e.name):!1},x.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):t.__proto__=s,t.prototype=Object.create(T),t},x.awrap=function(t){return new u(t)},l(c.prototype),x.async=function(t,e,n,r){var o=new c(i(t,e,n,r));return x.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},l(T),T[y]=function(){return this},T.toString=function(){return"[object Generator]"},x.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},x.values=_,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=m,this.done=!1,this.delegate=null,this.tryEntries.forEach(f),!t)for(var e in this)"t"===e.charAt(0)&&v.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=m)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,i){return o.type="throw",o.arg=t,n.next=e,!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var a=v.call(r,"catchLoc"),s=v.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&v.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?this.next=r.finallyLoc:this.complete(o),C},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),f(n),C}},"catch":function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;f(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},C}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(e,function(){return this}(),n(190))},function(t,e){function n(){u=!1,a.length?l=a.concat(l):c=-1,l.length&&i()}function i(){if(!u){var t=setTimeout(n);u=!0;for(var e=l.length;e;){for(a=l,l=[];++c<e;)a&&a[c].run();c=-1,e=l.length}a=null,u=!1,clearTimeout(t)}}function r(t,e){this.fun=t,this.array=e}function o(){}var a,s=t.exports={},l=[],u=!1,c=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new r(t,e)),1!==l.length||u||setTimeout(i,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=o,s.addListener=o,s.once=o,s.off=o,s.removeListener=o,s.removeAllListeners=o,s.emit=o,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}var r=(n(192),n(231)),o=i(r),a=n(232),s=n(234),l=n(244),u=i(l);n(318);var c=(0,s.applyMiddleware)((0,a.createMiddleware)(u["default"]))(s.createStore),h=o["default"].select("body").append("div").attr("class","fill").style("display","block"),d=(0,a.run)(u["default"],h.node(),c,u["default"].init(4));o["default"].select(document).on("keydown",function(){38===o["default"].event.keyCode?d.goIn():40===o["default"].event.keyCode&&d.goOut()}),window.setTimeout(function(){d.change(0),o["default"].select("#spinner").style("display","none")},3e3)},function(t,e,n){/**
	* @license
	*
	* Escher
	* Author: Zachary King
	*
	* The MIT License (MIT)
	*
	* This software is Copyright © 2015 The Regents of the University of
	* California. All Rights Reserved.
	*
	* Permission is hereby granted, free of charge, to any person obtaining a copy
	* of this software and associated documentation files (the "Software"), to deal
	* in the Software without restriction, including without limitation the rights
	* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	* copies of the Software, and to permit persons to whom the Software is
	* furnished to do so, subject to the following conditions:
	*
	* The above copyright notice and this permission notice shall be included in
	* all copies or substantial portions of the Software.
	*
	* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	* THE SOFTWARE.
	*/
t.exports={version:n(193).version,Builder:n(194),Map:n(209),Behavior:n(211),KeyManager:n(215),DataMenu:n(229),UndoStack:n(214),CobraModel:n(205),utils:n(195),SearchIndex:n(218),Settings:n(224),data_styles:n(206),ui:n(222),"static":n(230),ZoomContainer:n(207)}},function(t,e){t.exports={version:"1.4.0-beta.6",builder_embed:"svg.escher-svg .gene-label,svg.escher-svg .label{text-rendering:optimizelegibility;cursor:default}svg.escher-svg #mouse-node{fill:none}svg.escher-svg #canvas{stroke:#ccc;stroke-width:7px;fill:#fff}svg.escher-svg .resize-rect{fill:#000;opacity:0;stroke:none}svg.escher-svg .label{font-family:sans-serif;font-style:italic;font-weight:700;font-size:8px;fill:#000;stroke:none}svg.escher-svg .reaction-label{font-size:30px;fill:#202078;text-rendering:optimizelegibility}svg.escher-svg .node-label{font-size:20px}svg.escher-svg .gene-label{font-size:18px;fill:#202078}svg.escher-svg .text-label .label,svg.escher-svg .text-label-input{font-size:50px}svg.escher-svg .node-circle{stroke-width:2px}svg.escher-svg .midmarker-circle,svg.escher-svg .multimarker-circle{fill:#fff;fill-opacity:.2;stroke:#323232}svg.escher-svg g.selected .node-circle{stroke-width:6px;stroke:#1471c7}svg.escher-svg g.selected .label{fill:#1471c7}svg.escher-svg .metabolite-circle{stroke:#a24510;fill:#e0865b}svg.escher-svg g.selected .metabolite-circle{stroke:#050200}svg.escher-svg .segment{stroke:#334E75;stroke-width:10px;fill:none}svg.escher-svg .arrowhead{fill:#334E75}svg.escher-svg .stoichiometry-label-rect{fill:#fff;opacity:.5}svg.escher-svg .stoichiometry-label{fill:#334E75;font-size:17px}svg.escher-svg .membrane{fill:none;stroke:#fb0}svg.escher-svg .brush .extent{fill-opacity:.1;fill:#000;stroke:#fff;shape-rendering:crispEdges}svg.escher-svg #brush-container .background{fill:none}svg.escher-svg .bezier-circle{fill:#fff}svg.escher-svg .bezier-circle.b1{stroke:red}svg.escher-svg .bezier-circle.b2{stroke:#00f}svg.escher-svg .connect-line{stroke:#c8c8c8}svg.escher-svg .direction-arrow{stroke:#000;stroke-width:1px;fill:#fff;opacity:.3}svg.escher-svg .start-reaction-cursor{cursor:pointer}svg.escher-svg .start-reaction-target{stroke:#646464;fill:none;opacity:.5}svg.escher-svg .rotation-center-line{stroke:red;stroke-width:5px}svg.escher-svg .highlight{fill:#D97000;text-decoration:underline}svg.escher-svg .cursor-grab{cursor:grab;cursor:-webkit-grab}svg.escher-svg .cursor-grabbing{cursor:grabbing;cursor:-webkit-grabbing}svg.escher-svg .edit-text-cursor{cursor:text}"}},function(t,e,n){function i(t,e,n,i,r){if(i||(i=d3.select("body").append("div")),r||(r={}),n||(n=z),this.map_data=t,this.model_data=e,this.embedded_css=n,this.selection=i,this.selection.datum(this),this.options=k.set_options(r,{menu:"all",scroll_behavior:"pan",use_3d_transform:!k.check_browser("safari"),enable_editing:!0,enable_keys:!0,enable_search:!0,fill_screen:!1,zoom_to_element:null,full_screen_button:!1,ignore_bootstrap:!1,starting_reaction:null,never_ask_before_quit:!1,unique_map_id:null,primary_metabolite_radius:20,secondary_metabolite_radius:10,marker_radius:5,gene_font_size:18,hide_secondary_metabolites:!1,show_gene_reaction_rules:!1,hide_all_labels:!1,reaction_data:null,reaction_styles:["color","size","text"],reaction_compare_style:"log2_fold",reaction_scale:[{type:"min",color:"#c8c8c8",size:12},{type:"median",color:"#9696ff",size:20},{type:"max",color:"#ff0000",size:25}],reaction_no_data_color:"#dcdcdc",reaction_no_data_size:8,gene_data:null,and_method_in_gene_reaction_rule:"mean",metabolite_data:null,metabolite_styles:["color","size","text"],metabolite_compare_style:"log2_fold",metabolite_scale:[{type:"min",color:"#fffaf0",size:20},{type:"median",color:"#f1c470",size:30},{type:"max",color:"#800000",size:40}],metabolite_no_data_color:"#ffffff",metabolite_no_data_size:10,identifiers_on_map:"bigg_id",highlight_missing:!1,allow_building_duplicate_reactions:!1,cofactors:["atp","adp","nad","nadh","nadp","nadph","gtp","gdp","h","coa","ump","h20","ppi"],first_load_callback:null},{primary_metabolite_radius:!0,secondary_metabolite_radius:!0,marker_radius:!0,gene_font_size:!0,reaction_no_data_size:!0,metabolite_no_data_size:!0}),k.check_for_parent_tag(this.selection,"svg"))throw new Error("Builder cannot be placed within an svg node becuase UI elements are html-based.");var o=function(t,e){this.options[t]=e}.bind(this),a=function(t){return this.options[t]}.bind(this),s=["hide_secondary_metabolites","show_gene_reaction_rules","hide_all_labels","scroll_behavior","reaction_styles","reaction_compare_style","reaction_scale","reaction_no_data_color","reaction_no_data_size","and_method_in_gene_reaction_rule","metabolite_styles","metabolite_compare_style","metabolite_scale","metabolite_no_data_color","metabolite_no_data_size","identifiers_on_map","highlight_missing","allow_building_duplicate_reactions"];this.settings=new D(o,a,s),["reaction_scale","metabolite_scale"].forEach(function(t){this.settings.streams[t].onValue(function(e){["min","max"].forEach(function(n){var i=e.reduce(function(t,e){return t||e.type==n},!1);i||(e.push({type:n,color:"#ffffff",size:10}),this.settings.set_conditional(t,e))}.bind(this))}.bind(this))}.bind(this)),this.callback_manager=R(),null!==this.options.first_load_callback&&this.callback_manager.set("first_load",this.options.first_load_callback),this.load_model(this.model_data,!1),this.load_map(this.map_data,!1),this._update_data(!0,!0),this.settings.status_bus.onValue(function(t){if("accepted"===t){if(this._update_data(!0,!0,["reaction","metabolite"],!1),null!==this.zoom_container){var e=this.settings.get_option("scroll_behavior");this.zoom_container.set_scroll_behavior(e)}null!==this.map&&(this.map.draw_all_nodes(!1),this.map.draw_all_reactions(!0,!1))}}.bind(this)),this.callback_manager.run("first_load",this)}function r(t,e){void 0===e&&(e=!0),null===t?this.cobra_model=null:this.cobra_model=M.from_cobra_json(t),this.map&&(this.map.cobra_model=this.cobra_model,e&&this._update_data(!0,!1),this.settings.get_option("highlight_missing")&&this.map.draw_all_reactions(!1,!1)),this.callback_manager.run("load_model",null,t,e)}function o(t,e){void 0===e&&(e=!0);k.remove_child_nodes(this.selection),this.zoom_container=new T(this.selection,this.options.scroll_behavior,this.options.use_3d_transform,this.options.fill_screen);var n=this.zoom_container.zoomed_sel,i=this.zoom_container.svg;null!==t?this.map=E.from_data(t,i,this.embedded_css,n,this.zoom_container,this.settings,this.cobra_model,this.options.enable_search):this.map=new E(i,this.embedded_css,n,this.zoom_container,this.settings,this.cobra_model,null,this.options.enable_search),this.zoom_container.callback_manager.set("svg_start",function(){this.map.set_status("Drawing ...")}.bind(this)),this.zoom_container.callback_manager.set("svg_finish",function(){this.map.set_status("")}.bind(this)),e&&this._update_data(!1,!0),this.build_input=C(this.selection,this.map,this.zoom_container,this.settings),this.text_edit_input=N(this.selection,this.map,this.zoom_container),this.brush=new L(n,!1,this.map,".canvas-group"),this.map.canvas.callback_manager.set("resize",function(){this.brush.toggle(!0)}.bind(this)),this._setup_modes(this.map,this.brush,this.zoom_container);var r=this.selection.append("div").attr("class","search-menu-container").append("div").attr("class","search-menu-container-inline"),o=r.append("div"),a=r.append("div"),s=this.selection.append("div");this.search_bar=P(a,this.map.search_index,this.map),this.search_bar.callback_manager.set("show",function(){this.settings_bar.toggle(!1)}.bind(this));var l=this.selection.append("div");this.settings_bar=I(l,this.settings,this.map,function(t,e){var n=this.options[t+"_styles"];if(e&&-1==n.indexOf("abs"))n.push("abs");else if(!e){var i=n.indexOf("abs");-1!=i&&(this.options[t+"_styles"]=n.slice(0,i).concat(n.slice(i+1)))}this._update_data(!1,!0,t)}.bind(this)),this.settings_bar.callback_manager.set("show",function(){this.search_bar.toggle(!1)}.bind(this));var u=this._get_keys(this.map,this.zoom_container,this.search_bar,this.settings_bar,this.options.enable_editing,this.options.full_screen_button);if(this.map.key_manager.assigned_keys=u,this.map.key_manager.input_list=[this.build_input,this.search_bar,this.settings_bar,this.text_edit_input],this.map.key_manager.update(),this.map.key_manager.toggle(this.options.enable_keys),"all"===this.options.menu&&(this.options.ignore_bootstrap?console.error("Cannot create the dropdown menus if ignore_bootstrap = true"):this._set_up_menu(o,this.map,this.map.key_manager,u,this.options.enable_editing,this.options.enable_keys,this.options.full_screen_button)),this._set_up_button_panel(s,u,this.options.enable_editing,this.options.enable_keys,this.options.full_screen_button,this.options.menu,this.options.ignore_bootstrap),this.options.zoom_to_element){var c=this.options.zoom_to_element.type,h=this.options.zoom_to_element.id;if("undefined"==typeof c||-1==["reaction","node"].indexOf(c))throw new Error('zoom_to_element type must be "reaction" or "node"');if("undefined"==typeof h)throw new Error("zoom_to_element must include id");"reaction"==c?this.map.zoom_to_reaction(h):"node"==c&&this.map.zoom_to_node(h)}else if(null!==t)this.map.zoom_extent_canvas();else if(null!==this.options.starting_reaction&&null!==this.cobra_model){var d=this.zoom_container.get_size(),f={x:d.width/2,y:d.height/4};this.map.new_reaction_from_scratch(this.options.starting_reaction,f,90),this.map.zoom_extent_nodes()}else this.map.zoom_extent_canvas();this._setup_status(this.selection,this.map);this._setup_quick_jump(this.selection),this.options.enable_editing?this.zoom_mode():this.view_mode(),this.options.enable_editing&&this._setup_confirm_before_exit(),this.map.draw_everything()}function a(t){this.search_bar.toggle(!1),this.build_input.toggle("build"==t),this.build_input.direction_arrow.toggle("build"==t),"all"==this.options.menu&&this.options.enable_editing&&this._toggle_direction_buttons("build"==t),this.brush.toggle("brush"==t),this.zoom_container.toggle_pan_drag("zoom"==t||"view"==t),this.map.canvas.toggle_resize("zoom"==t||"brush"==t),"rotate"==t?(this.map.behavior.toggle_selectable_drag(!1),this.map.behavior.toggle_rotation_mode(!0)):(this.map.behavior.toggle_rotation_mode("rotate"==t),this.map.behavior.toggle_selectable_drag("brush"==t)),this.map.behavior.toggle_selectable_click("build"==t||"brush"==t),this.map.behavior.toggle_label_drag("brush"==t),this.map.behavior.toggle_label_mousedown("brush"==t),this.map.behavior.toggle_text_label_edit("text"==t),this.map.behavior.toggle_bezier_drag("brush"==t),("view"==t||"text"==t)&&this.map.select_none(),"rotate"==t&&this.map.deselect_text_labels(),this.map.draw_everything()}function s(){this.callback_manager.run("view_mode"),this._set_mode("view")}function l(){this.callback_manager.run("build_mode"),this._set_mode("build")}function u(){this.callback_manager.run("brush_mode"),this._set_mode("brush")}function c(){this.callback_manager.run("zoom_mode"),this._set_mode("zoom")}function h(){this.callback_manager.run("rotate_mode"),this._set_mode("rotate")}function d(){this.callback_manager.run("text_mode"),this._set_mode("text")}function f(t){this.options.reaction_data=t,this._update_data(!0,!0,"reaction"),this.map.set_status("")}function p(t,e){e&&this.settings.set_conditional("show_gene_reaction_rules",!1),this.options.gene_data=t,this._update_data(!0,!0,"reaction"),this.map.set_status("")}function _(t){this.options.metabolite_data=t,this._update_data(!0,!0,"metabolite"),this.map.set_status("")}function g(t,e,n,i){function r(t,e,n){var i={};return null!==e&&k.extend(i,e.reactions),null!==n&&k.extend(i,n.reactions,!0),B.import_and_check(t,"gene_data",i)}void 0===n&&(n=["reaction","metabolite"]),void 0===i&&(i=!0);var o,a,s,l=-1!=n.indexOf("metabolite"),u=-1!=n.indexOf("reaction");l&&e&&null!==this.map&&(o=B.import_and_check(this.options.metabolite_data,"metabolite_data"),this.map.apply_metabolite_data_to_map(o),i&&this.map.draw_all_nodes(!1)),u&&(null!==this.options.reaction_data&&e&&null!==this.map?(a=B.import_and_check(this.options.reaction_data,"reaction_data"),this.map.apply_reaction_data_to_map(a),i&&this.map.draw_all_reactions(!1,!1)):null!==this.options.gene_data&&e&&null!==this.map?(s=r(this.options.gene_data,this.cobra_model,this.map),this.map.apply_gene_data_to_map(s),i&&this.map.draw_all_reactions(!1,!1)):e&&null!==this.map&&(this.map.apply_reaction_data_to_map(null),i&&this.map.draw_all_reactions(!1,!1))),this.update_model_timer&&clearTimeout(this.update_model_timer);var c=5;this.update_model_timer=setTimeout(function(){l&&t&&null!==this.cobra_model&&(o||(o=B.import_and_check(this.options.metabolite_data,"metabolite_data")),this.cobra_model.apply_metabolite_data(o,this.options.metabolite_styles,this.options.metabolite_compare_style)),u&&(null!==this.options.reaction_data&&t&&null!==this.cobra_model?(a||(a=B.import_and_check(this.options.reaction_data,"reaction_data")),this.cobra_model.apply_reaction_data(a,this.options.reaction_styles,this.options.reaction_compare_style)):null!==this.options.gene_data&&t&&null!==this.cobra_model?(s||(s=r(this.options.gene_data,this.cobra_model,this.map)),this.cobra_model.apply_gene_data(s,this.options.reaction_styles,this.options.identifiers_on_map,this.options.reaction_compare_style,this.options.and_method_in_gene_reaction_rule)):t&&null!==this.cobra_model&&this.cobra_model.apply_reaction_data(null,this.options.reaction_styles,this.options.reaction_compare_style)),this.callback_manager.run("update_data",null,t,e,n,i)}.bind(this),c)}function m(t,e,n,i,r,o,a,s){function l(t,e){function n(t){if(!("map_id"in t[0]&&"reactions"in t[1]&&"nodes"in t[1]&&"canvas"in t[1]))throw new Error("Bad map data.")}if(t)return console.warn(t),void this.map.set_status("Error loading map: "+t,2e3);try{n(e),this.load_map(e),this.map.set_status("Loaded map "+e[0].map_name,3e3)}catch(i){console.warn(i),this.map.set_status("Error loading map: "+i,2e3)}}function u(t,e){if(t)return console.warn(t),void this.map.set_status("Error loading model: "+t,2e3);try{this.load_model(e,!0),this.build_input.toggle(!1),"id"in e?this.map.set_status("Loaded model "+e.id,3e3):this.map.set_status("Loaded model (no model id)",3e3)}catch(n){console.warn(n),this.map.set_status("Error loading model: "+n,2e3)}}function c(t,e){return t?(console.warn(t),void this.map.set_status("Could not parse file as JSON or CSV",2e3)):(null!==e&&this.set_gene_data(null),void this.set_reaction_data(e))}function h(t,e){return t?(console.warn(t),void this.map.set_status("Could not parse file as JSON or CSV",2e3)):void this.set_metabolite_data(e)}function d(t,e){return t?(console.warn(t),void this.map.set_status("Could not parse file as JSON or CSV",2e3)):(null!==e&&this.set_reaction_data(null),this.settings.set_conditional("show_gene_reaction_rules",!0),void this.set_gene_data(e))}var f=t.attr("id","menu").append("ul").attr("class","nav nav-pills");O.dropdown_menu(f,"Map").button({key:i.save,text:"Save map JSON",key_text:o?" (Ctrl+S)":null}).button({text:"Load map JSON",key_text:o?" (Ctrl+O)":null,input:{assign:n.assigned_keys.load,key:"fn",fn:l.bind(this),pre_fn:function(){e.set_status("Loading map ...")},failure_fn:function(){e.set_status("")}}}).button({key:i.save_svg,text:"Export as SVG",key_text:o?" (Ctrl+Shift+S)":null}).button({key:i.clear_map,text:"Clear map"});var p=O.dropdown_menu(f,"Model").button({text:"Load COBRA model JSON",key_text:o?" (Ctrl+M)":null,input:{assign:n.assigned_keys.load_model,key:"fn",fn:u.bind(this),pre_fn:function(){e.set_status("Loading model ...")},failure_fn:function(){e.set_status("")}}}).button({id:"convert_map",key:i.convert_map,text:"Update names and gene reaction rules using model"}).button({id:"clear_model",key:i.clear_model,text:"Clear model"}),_=function(){p.dropdown.selectAll("li").classed("escher-disabled",function(t){return"clear_model"!=t.id&&"convert_map"!=t.id||null!==this.cobra_model?null:!0}.bind(this))}.bind(this);_(),this.callback_manager.set("load_model",_);var g=O.dropdown_menu(f,"Data").button({input:{assign:n.assigned_keys.load_reaction_data,key:"fn",fn:c.bind(this),accept_csv:!0,pre_fn:function(){e.set_status("Loading reaction data ...")},failure_fn:function(){e.set_status("")}},text:"Load reaction data"}).button({key:i.clear_reaction_data,text:"Clear reaction data"}).divider().button({input:{fn:d.bind(this),accept_csv:!0,pre_fn:function(){e.set_status("Loading gene data ...")},failure_fn:function(){e.set_status("")}},text:"Load gene data"}).button({key:i.clear_gene_data,text:"Clear gene data"}).divider().button({input:{fn:h.bind(this),accept_csv:!0,pre_fn:function(){e.set_status("Loading metabolite data ...")},failure_fn:function(){e.set_status("")}},text:"Load metabolite data"}).button({key:i.clear_metabolite_data,text:"Clear metabolite data"}),m=function(){g.dropdown.selectAll("li").classed("escher-disabled",function(t){return t?"Clear reaction data"==t.text&&null===this.options.reaction_data?!0:"Clear gene data"==t.text&&null===this.options.gene_data?!0:"Clear metabolite data"==t.text&&null===this.options.metabolite_data?!0:null:null}.bind(this))}.bind(this);m(),this.callback_manager.set("update_data",m);var v=O.dropdown_menu(f,"Edit",!0);r?v.button({key:i.zoom_mode,id:"zoom-mode-menu-button",text:"Pan mode",key_text:o?" (Z)":null}).button({key:i.brush_mode,id:"brush-mode-menu-button",text:"Select mode",key_text:o?" (V)":null}).button({key:i.build_mode,id:"build-mode-menu-button",text:"Add reaction mode",key_text:o?" (N)":null}).button({key:i.rotate_mode,id:"rotate-mode-menu-button",text:"Rotate mode",key_text:o?" (R)":null}).button({key:i.text_mode,id:"text-mode-menu-button",text:"Text mode",key_text:o?" (T)":null}).divider().button({key:i["delete"],text:"Delete",key_text:o?" (Del)":null}).button({key:i.undo,text:"Undo",key_text:o?" (Ctrl+Z)":null}).button({key:i.redo,text:"Redo",key_text:o?" (Ctrl+Shift+Z)":null}).button({key:i.toggle_primary,text:"Toggle primary/secondary",key_text:o?" (P)":null}).button({key:i.cycle_primary,text:"Rotate reactant locations",key_text:o?" (C)":null}).button({key:i.select_all,text:"Select all",key_text:o?" (Ctrl+A)":null}).button({key:i.select_none,text:"Select none",key_text:o?" (Ctrl+Shift+A)":null}).button({key:i.invert_selection,text:"Invert selection"}):v.button({key:i.view_mode,id:"view-mode-menu-button",text:"View mode"});var y=O.dropdown_menu(f,"View",!0).button({key:i.zoom_in,text:"Zoom in",key_text:o?" (Ctrl and +)":null}).button({key:i.zoom_out,text:"Zoom out",key_text:o?" (Ctrl and -)":null}).button({key:i.extent_nodes,text:"Zoom to nodes",key_text:o?" (Ctrl+0)":null}).button({key:i.extent_canvas,text:"Zoom to canvas",key_text:o?" (Ctrl+1)":null}).button({key:i.search,text:"Find",key_text:o?" (Ctrl+F)":null});a&&y.button({key:i.full_screen,text:"Full screen",key_text:o?" (Ctrl+2)":null}),r&&(y.button({key:i.toggle_beziers,id:"bezier-button",text:"Show control points",key_text:o?" (B)":null}),e.callback_manager.set("toggle_beziers.button",function(t){f.select("#bezier-button").select(".dropdown-button-text").text((t?"Hide":"Show")+" control points"+(o?" (B)":""))})),y.divider().button({key:i.show_settings,text:"Settings",key_text:o?" (Ctrl+,)":null}),f.append("a").attr("class","help-button").attr("target","#").attr("href","https://escher.readthedocs.org").text("?");var b=function(t){$(this.selection.node()).find("#"+t).button("toggle");var e=["zoom-mode-menu-button","brush-mode-menu-button","build-mode-menu-button","rotate-mode-menu-button","view-mode-menu-button","text-mode-menu-button"];e.forEach(function(e){var n=e.replace("-menu","");this.selection.select("#"+e).select("span").classed("glyphicon",n==t).classed("glyphicon-ok",n==t)}.bind(this))};this.callback_manager.set("zoom_mode",b.bind(this,"zoom-mode-button")),this.callback_manager.set("brush_mode",b.bind(this,"brush-mode-button")),this.callback_manager.set("build_mode",b.bind(this,"build-mode-button")),this.callback_manager.set("rotate_mode",b.bind(this,"rotate-mode-button")),this.callback_manager.set("view_mode",b.bind(this,"view-mode-button")),this.callback_manager.set("text_mode",b.bind(this,"text-mode-button"))}function v(t,e,n,i,r,o,a){var s=t.append("ul").attr("class","nav nav-pills nav-stacked").attr("id","button-panel");if(O.individual_button(s.append("li"),{key:e.zoom_in,text:"+",icon:"glyphicon glyphicon-plus-sign",tooltip:"Zoom in",key_text:i?" (Ctrl and +)":null,ignore_bootstrap:a}),O.individual_button(s.append("li"),{key:e.zoom_out,text:"–",icon:"glyphicon glyphicon-minus-sign",tooltip:"Zoom out",key_text:i?" (Ctrl and -)":null,ignore_bootstrap:a}),O.individual_button(s.append("li"),{key:e.extent_canvas,text:"↔",icon:"glyphicon glyphicon-resize-full",tooltip:"Zoom to canvas",key_text:i?" (Ctrl+1)":null,ignore_bootstrap:a}),r&&O.individual_button(s.append("li"),{key:e.full_screen,text:"▣",icon:"glyphicon glyphicon-fullscreen",tooltip:"Full screen",key_text:i?" (Ctrl+2)":null,ignore_bootstrap:a}),n&&"all"===o){O.radio_button_group(s.append("li")).button({key:e.zoom_mode,id:"zoom-mode-button",text:"Z",icon:"glyphicon glyphicon-move",tooltip:"Pan mode",key_text:i?" (Z)":null,ignore_bootstrap:a}).button({key:e.brush_mode,text:"V",id:"brush-mode-button",icon:"glyphicon glyphicon-hand-up",tooltip:"Select mode",key_text:i?" (V)":null,ignore_bootstrap:a}).button({key:e.build_mode,text:"N",id:"build-mode-button",icon:"glyphicon glyphicon-plus",tooltip:"Add reaction mode",key_text:i?" (N)":null,ignore_bootstrap:a}).button({key:e.rotate_mode,text:"R",id:"rotate-mode-button",icon:"glyphicon glyphicon-repeat",tooltip:"Rotate mode",key_text:i?" (R)":null,ignore_bootstrap:a}).button({key:e.text_mode,text:"T",id:"text-mode-button",icon:"glyphicon glyphicon-font",tooltip:"Text mode",key_text:i?" (T)":null,ignore_bootstrap:a}),this.direction_buttons=s.append("li");O.button_group(this.direction_buttons).button({key:e.direction_arrow_left,text:"←",icon:"glyphicon glyphicon-arrow-left",tooltip:"Direction arrow (←)",ignore_bootstrap:a}).button({key:e.direction_arrow_right,text:"→",icon:"glyphicon glyphicon-arrow-right",tooltip:"Direction arrow (→)",ignore_bootstrap:a}).button({key:e.direction_arrow_up,text:"↑",icon:"glyphicon glyphicon-arrow-up",tooltip:"Direction arrow (↑)",ignore_bootstrap:a}).button({key:e.direction_arrow_down,text:"↓",icon:"glyphicon glyphicon-arrow-down",tooltip:"Direction arrow (↓)",ignore_bootstrap:a})}}function y(t){H.isUndefined(t)&&(t="block"===!this.direction_buttons.style("display")),this.direction_buttons.style("display",t?"block":"none")}function b(t,e){var n=t.append("div").attr("id","status");return e.callback_manager.set("set_status",function(t){n.html(t)}),n}function x(t){var e=function(t,e,n){if(this.options.enable_editing&&!this.options.never_ask_before_quit&&!confirm("You will lose any unsaved changes.\n\nAre you sure you want to switch maps?"))return void(n&&n(!1));this.map.set_status("Loading map "+t+" ...");var i=k.name_to_url(t,e);d3.json(i,function(t,e){return t?(console.warn("Could not load data: "+t),this.map.set_status("Could not load map",2e3),void(n&&n(!1))):(n&&n(!0),this.load_map(e),void this.map.set_status(""))}.bind(this))}.bind(this);this.quick_jump=F(t,e)}function w(t,e,n){var i={};t.callback_manager.set("start_rotation",function(){i.brush=e.enabled,e.toggle(!1),i.zoom=n.zoom_on,n.toggle_pan_drag(!1),i.selectable_mousedown=null!=t.behavior.selectable_mousedown,t.behavior.toggle_selectable_click(!1),i.label_mousedown=null!=t.behavior.label_mousedown,t.behavior.toggle_label_mousedown(!1)}),t.callback_manager.set("end_rotation",function(){e.toggle(i.brush),n.toggle_pan_drag(i.zoom),t.behavior.toggle_selectable_click(i.selectable_mousedown),t.behavior.toggle_label_mousedown(i.label_mousedown),i={}})}function S(t,e,n,i,r,o){var a={save:{key:"ctrl+s",target:t,fn:t.save},save_svg:{key:"ctrl+shift+s",target:t,fn:t.save_svg},load:{key:"ctrl+o",fn:null},convert_map:{target:t,fn:t.convert_map},clear_map:{target:t,fn:t.clear_map},load_model:{key:"ctrl+m",fn:null},clear_model:{fn:this.load_model.bind(this,null,!0)},load_reaction_data:{fn:null},clear_reaction_data:{target:this,fn:function(){this.set_reaction_data(null)}},load_metabolite_data:{fn:null},clear_metabolite_data:{target:this,fn:function(){this.set_metabolite_data(null)}},load_gene_data:{fn:null},clear_gene_data:{target:this,fn:function(){this.set_gene_data(null,!0)}},zoom_in:{key:"ctrl+=",target:e,fn:e.zoom_in},zoom_out:{key:"ctrl+-",target:e,fn:e.zoom_out},extent_nodes:{key:"ctrl+0",target:t,fn:t.zoom_extent_nodes},extent_canvas:{key:"ctrl+1",target:t,fn:t.zoom_extent_canvas},search:{key:"ctrl+f",fn:n.toggle.bind(n,!0)},view_mode:{target:this,fn:this.view_mode,ignore_with_input:!0},show_settings:{key:"ctrl+,",target:i,fn:i.toggle}};return o&&k.extend(a,{full_screen:{key:"ctrl+2",target:t,fn:t.full_screen}}),r&&k.extend(a,{build_mode:{key:"n",target:this,fn:this.build_mode,ignore_with_input:!0},zoom_mode:{key:"z",target:this,fn:this.zoom_mode,ignore_with_input:!0},brush_mode:{key:"v",target:this,fn:this.brush_mode,ignore_with_input:!0},rotate_mode:{key:"r",target:this,fn:this.rotate_mode,ignore_with_input:!0},text_mode:{key:"t",target:this,fn:this.text_mode,ignore_with_input:!0},toggle_beziers:{key:"b",target:t,fn:t.toggle_beziers,ignore_with_input:!0},"delete":{key:"ctrl+backspace",target:t,fn:t.delete_selected,ignore_with_input:!0},delete_del:{key:"del",target:t,fn:t.delete_selected,ignore_with_input:!0},toggle_primary:{key:"p",target:t,fn:t.toggle_selected_node_primary,ignore_with_input:!0},cycle_primary:{key:"c",target:t,fn:t.cycle_primary_node,ignore_with_input:!0},direction_arrow_right:{key:"right",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.right,ignore_with_input:!0},direction_arrow_down:{key:"down",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.down,ignore_with_input:!0},direction_arrow_left:{key:"left",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.left,ignore_with_input:!0},direction_arrow_up:{key:"up",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.up,ignore_with_input:!0},undo:{key:"ctrl+z",target:t.undo_stack,fn:t.undo_stack.undo},redo:{key:"ctrl+shift+z",target:t.undo_stack,fn:t.undo_stack.redo},select_all:{key:"ctrl+a",target:t,fn:t.select_all},select_none:{key:"ctrl+shift+a",target:t,fn:t.select_none},invert_selection:{target:t,fn:t.invert_selection}}),a}function A(){window.onbeforeunload=function(t){return t=t||window.event,this.options.never_ask_before_quit?null:"You will lose any unsaved changes."}.bind(this)}var k=n(195),C=n(201),T=n(207),E=n(209),M=n(205),L=n(221),R=n(208),O=n(222),P=n(223),D=n(224),I=n(225),N=n(227),F=n(228),B=n(206),z=n(193).builder_embed,H=n(197),q=k.make_class();q.prototype={init:i,load_map:o,load_model:r,_set_mode:a,view_mode:s,build_mode:l,brush_mode:u,zoom_mode:c,rotate_mode:h,text_mode:d,set_reaction_data:f,set_metabolite_data:_,set_gene_data:p,_update_data:g,_toggle_direction_buttons:y,_set_up_menu:m,_set_up_button_panel:v,_setup_status:b,_setup_quick_jump:x,_setup_modes:w,_get_keys:S,_setup_confirm_before_exit:A},t.exports=q},function(t,e,n){function i(){try{!!new Blob}catch(t){alert("Blob not supported")}}function r(t,e,n){if(void 0===t||null===t)return e;var i={};for(var r in e){var o=r in t&&null!==t[r]&&void 0!==t[r],a=o?t[r]:e[r];n&&r in n&&(a=parseFloat(a),isNaN(a)&&(o?(console.warn("Bad float for option "+r),a=parseFloat(e[r]),isNaN(a)&&(console.warn("Bad float for default "+r),a=null)):(console.warn("Bad float for default "+r),a=null))),i[r]=a}return i}function o(t){for(var e=t.node();e.hasChildNodes();)e.removeChild(e.lastChild)}function a(t,e){var n="";return t&&d3.text(t,function(t,i){t&&console.warn(t),n=i,e(n)}),!1}function s(t,e,n,i){function r(t,e){return-1!==t.indexOf(e,t.length-e.length)}return i?(e&&console.warn("File "+e+" overridden by value."),void n.call(t,null,i)):e?void(r(e,"json")?d3.json(e,function(e,i){n.call(t,e,i)}):r(e,"css")?d3.text(e,function(e,i){n.call(t,e,i)}):n.call(t,"Unrecognized file type",null)):void n.call(t,"No filename",null)}function l(t,e,n){0===e.length&&n.call(t);for(var i=-1,r=e.length;++i<e.length;)s(t,e[i].file,function(e,i){this.call(t,e,i),--r||n.call(t)}.bind(e[i].callback),e[i].value)}function u(){var t,e=function(n){if(!(this instanceof e)){t=!0;var i=new e(arguments);return t=!1,i}"function"==typeof this.init&&this.init.apply(this,t?n:arguments)};return e}function c(t,e){t.select("defs").remove();var n=t.append("defs"),i=n.node();return i.parentNode.insertBefore(i,i.parentNode.firstChild),n.append("style").attr("type","text/css").text(e),n}function h(t,e,n,i,r,o,a,s){var l={};for(var u in i)void 0===i[u]?console.warn("Undefined value for id "+u+" in object. Ignoring."):l[u]=i[u];var c=t.select(e).selectAll(n).data(p(l,r),function(t){return t[r]});o&&c.enter().call(o),a&&c.call(a),s&&c.exit().call(s)}function d(t,e,n,i,r,o,a){var s=t.selectAll(e).data(function(t){return p(t[n],i)},function(t){return t[i]});r&&s.enter().call(r),o&&s.call(o),a&&s.exit().call(a)}function f(t,e){var n=[];for(var i in t){var r=m(t[i]);r[e]=i,n.push(r)}return n}function p(t,e){var n=[];for(var i in t){var r=t[i];r[e]=i,n.push(r)}return n}function _(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,i=t.length;i>n;n++)if(t[n]!=e[n])return!1;return!0}function g(t){for(var e={},n=0,i=t.length;i>n;n++)for(var r=t[n],o=Object.keys(r),a=0,s=o.length;s>a;a++){var l=o[a];if(l in e)e[l][n]=r[l];else{for(var u=[],c=0;i>c;c++)u[c]=null;u[n]=r[l],e[l]=u}}return e}function m(t){if(null==t||"object"!=typeof t)return t;if(t instanceof Array){for(var e=[],n=0,i=t.length;i>n;n++)e[n]=m(t[n]);return e}if(t instanceof Object){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=m(t[r]));return e}throw new Error("Unable to copy obj! Its type isn't supported.")}function v(t,e,n){void 0===n&&(n=!1);for(var i in e){if(i in t&&!n)throw new Error("Attribute "+i+" already in object.");t[i]=e[i]}}function y(t){var e=[];return t.forEach(function(t){t.forEach(function(t){e.indexOf(t)<0&&e.push(t)})}),e}function b(t){for(var e=[],n=0,i=t.length;i>n;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}function x(t,e,n){var i;return function(){var r=this,o=arguments,a=function(){i=null,n||t.apply(r,o)},s=n&&!i;clearTimeout(i),i=setTimeout(a,e),s&&t.apply(r,o)}}function w(t,e){for(var n={},i=-1;++i<e.length;)n[e[i]]=m(t[e[i]]);return e.length!=Object.keys(n).length&&console.warn("did not find correct reaction subset"),n}function S(t,e){for(var n={},i=-1;++i<e.length;)n[e[i]]=t[e[i]];return e.length!=Object.keys(n).length&&console.warn("did not find correct reaction subset"),n}function A(t,e){return null===t||null===e||void 0===t||void 0===e?null:{x:t.x+e.x,y:t.y+e.y}}function k(t,e){return null===t||null===e||void 0===t||void 0===e?null:{x:t.x-e.x,y:t.y-e.y}}function C(t,e){return{x:t.x*e,y:t.y*e}}function T(t,e){i();var n=JSON.stringify(t),r=new Blob([n],{type:"application/json"});tt(r,e+".json")}function E(t,e,n,i){window.File&&window.FileReader&&window.FileList&&window.Blob||e("The File APIs are not fully supported in this browser.",null);var r=new window.FileReader;if(r.onload=function(t){var n,i=t.target.result;try{n=JSON.parse(i)}catch(r){return void e(r,null)}e(null,n)},void 0!==n&&null!==n)try{n()}catch(o){console.warn(o)}r.onabort=function(t){try{i()}catch(e){console.warn(e)}},r.onerror=function(t){try{i()}catch(e){console.warn(e)}},r.readAsText(t)}function M(t,e,n,i,r,o){var a=function(t){var i,r,o=t.target.result;try{i=JSON.parse(o)}catch(a){r="JSON error: "+a;try{i=e(d3.csv.parseRows(o))}catch(a){return void n(r+"\nCSV error: "+a,null)}}n(null,i)};if(void 0!==o&&null!==o)return console.warn("Debugging load_json_or_csv"),a(o);window.File&&window.FileReader&&window.FileList&&window.Blob||n("The File APIs are not fully supported in this browser.",null);var s=new window.FileReader;if(void 0!==i&&null!==i)try{i()}catch(l){console.warn(l)}s.onabort=function(t){try{r()}catch(e){console.warn(e);
}},s.onerror=function(t){try{r()}catch(e){console.warn(e)}},s.onload=a,s.readAsText(t)}function L(t,e,n){i();var r=(new XMLSerializer).serializeToString(e.node());n&&(r=J.xml(r)),r='<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"\n "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n'+r;var o=new Blob([r],{type:"image/svg+xml"});tt(o,t+".svg")}function R(t,e,n){var i=function(t){return O(t,e,n)};return t.map(i)}function O(t,e,n){var i=Math.cos(-e)*(t.x-n.x)+Math.sin(-e)*(t.y-n.y)+n.x-t.x,r=-Math.sin(-e)*(t.x-n.x)+Math.cos(-e)*(t.y-n.y)+n.y-t.y;return{x:i,y:r}}function P(t){var e=t[1].x-t[0].x,n=t[1].y-t[0].y;return 0==e&&n>=0?Math.PI/2:0==e&&0>n?3*Math.PI/2:e>=0&&n>=0?Math.atan(n/e):e>=0?Math.atan(n/e)+2*Math.PI:Math.atan(n/e)+Math.PI}function D(t){return 180*t/Math.PI}function I(t,e,n){var i=Math.atan2(e.x-n.x,n.y-e.y),r=Math.atan2(e.x-n.x+t.x,n.y-e.y-t.y),o=r-i;return o}function N(t,e){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}function F(t,e){e.map(function(n,i){void 0===t[i]&&console.error("Argument is undefined: "+String(e[i]))})}function B(t,e){return t+"_"+e}function z(t){function e(t){var e=/(.*)_([a-z0-9]{1,2})$/,n=e.exec(t);return null===n?null:n.slice(1,3)}var n=e(t);return null===n&&(n=[t,null]),n}function H(t){var e=t.reduce(function(t,e){return t+e}),n=e/t.length;return n}function q(t){t.sort(function(t,e){return t-e});var e=Math.floor(t.length/2);return t.length%2==1?t[e]:(t[e-1]+t[e])/2}function G(t){t.sort(function(t,e){return t-e});var e=Math.floor(t.length/2);return 1==t.length?[t[0],t[0],t[0]]:t.length%2==1?[q(t.slice(0,e)),t[e],q(t.slice(e+1))]:[q(t.slice(0,e)),(t[e-1]+t[e])/2,q(t.slice(e))]}function j(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;t>i;i++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}function U(){return j(12)}function V(t,e){for(t instanceof Array&&(t=t.node());null!==t.parentNode;)if(t=t.parentNode,void 0!==t.tagName&&t.tagName.toLowerCase()===e.toLowerCase())return!0;return!1}function W(t,e){return void 0!==e&&null!==e&&(e=e.replace(/^\/|\/$/g,""),t=[e,t].join("/")),t.replace(/^\/|\/$/g,"")+".json"}function X(t,e){Q.isUndefined(e)&&(e={});for(var n=t.location.search.substring(1),i=n.split("&"),r=0;r<i.length;r++){var o=i[r].split("="),a=decodeURIComponent(o[1]);if(o[0].indexOf("[]")==o[0].length-2){var s=o[0].replace("[]","");s in e||(e[s]=[]),e[s].push(a)}else e[o[0]]=a}return e}function K(t){return t.ownerDocument}function Y(t){return K(t).defaultView}function Z(t){try{return d3.transform(t)}catch(e){return console.error("Cannot run d3.transform, probably becuase this is a node/jsdom test. Returning a tranform object for testing."),{translate:[0,0],rotate:0}}}function $(t){var e=function(){var t,e=navigator.userAgent,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],"IE "+(t[1]||"")):"Chrome"===n[1]&&(t=e.match(/\b(OPR|Edge)\/(\d+)/),null!=t)?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=e.match(/version\/(\d+)/i))&&n.splice(1,1,t[1]),n.join(" "))};try{return e().toLowerCase().indexOf(t)>-1}catch(n){return!1}}var J=n(196),Q=n(197);try{var tt=n(198).saveAs}catch(et){console.warn("filesaverjs not available")}t.exports={set_options:r,remove_child_nodes:o,load_css:a,load_files:l,load_the_file:s,make_class:u,setup_defs:c,draw_an_object:h,draw_a_nested_object:d,make_array:f,make_array_ref:p,compare_arrays:_,array_to_object:g,clone:m,extend:v,unique_concat:y,unique_strings_array:b,debounce:x,object_slice_for_ids:w,object_slice_for_ids_ref:S,c_plus_c:A,c_minus_c:k,c_times_scalar:C,download_json:T,load_json:E,load_json_or_csv:M,download_svg:L,rotate_coords_recursive:R,rotate_coords:O,get_angle:P,to_degrees:D,angle_for_event:I,distance:N,check_undefined:F,compartmentalize:B,decompartmentalize:z,mean:H,median:q,quartiles:G,random_characters:j,generate_map_id:U,check_for_parent_tag:V,name_to_url:W,parse_url_components:X,get_document:K,get_window:Y,d3_transform_catch:Z,check_browser:$}},function(t,e){/**
	* vkBeautify - javascript plugin to pretty-print or minify text in XML, JSON, CSS and SQL formats.
	*  
	* Version - 0.99.00.beta 
	* Copyright (c) 2012 Vadim Kiryukhin
	* vkiryukhin @ gmail.com
	* http://www.eslinstructor.net/vkbeautify/
	* 
	* Dual licensed under the MIT and GPL licenses:
	*   http://www.opensource.org/licenses/mit-license.php
	*   http://www.gnu.org/licenses/gpl.html
	*
	*   Pretty print
	*
	*        vkbeautify.xml(text [,indent_pattern]);
	*        vkbeautify.json(text [,indent_pattern]);
	*        vkbeautify.css(text [,indent_pattern]);
	*        vkbeautify.sql(text [,indent_pattern]);
	*
	*        @text - String; text to beatufy;
	*        @indent_pattern - Integer | String;
	*                Integer:  number of white spaces;
	*                String:   character string to visualize indentation ( can also be a set of white spaces )
	*   Minify
	*
	*        vkbeautify.xmlmin(text [,preserve_comments]);
	*        vkbeautify.jsonmin(text);
	*        vkbeautify.cssmin(text [,preserve_comments]);
	*        vkbeautify.sqlmin(text);
	*
	*        @text - String; text to minify;
	*        @preserve_comments - Bool; [optional];
	*                Set this flag to true to prevent removing comments from @text ( minxml and mincss functions only. )
	*
	*   Examples:
	*        vkbeautify.xml(text); // pretty print XML
	*        vkbeautify.json(text, 4 ); // pretty print JSON
	*        vkbeautify.css(text, '. . . .'); // pretty print CSS
	*        vkbeautify.sql(text, '----'); // pretty print SQL
	*
	*        vkbeautify.xmlmin(text, true);// minify XML, preserve comments
	*        vkbeautify.jsonmin(text);// minify JSON
	*        vkbeautify.cssmin(text);// minify CSS, remove comments ( default )
	*        vkbeautify.sqlmin(text);// minify SQL
	*
	*/
function n(t){var e="    ";if(isNaN(parseInt(t)))e=t;else switch(t){case 1:e=" ";break;case 2:e="  ";break;case 3:e="   ";break;case 4:e="    ";break;case 5:e="     ";break;case 6:e="      ";break;case 7:e="       ";break;case 8:e="        ";break;case 9:e="         ";break;case 10:e="          ";break;case 11:e="           ";break;case 12:e="            "}var n=["\n"];for(ix=0;ix<100;ix++)n.push(n[ix]+e);return n}function i(){this.step="    ",this.shift=n(this.step)}function r(t,e){return e-(t.replace(/\(/g,"").length-t.replace(/\)/g,"").length)}function o(t,e){return t.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+e+e+"AND ").replace(/ BETWEEN /gi,"~::~"+e+"BETWEEN ").replace(/ CASE /gi,"~::~"+e+"CASE ").replace(/ ELSE /gi,"~::~"+e+"ELSE ").replace(/ END /gi,"~::~"+e+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+e+"ON ").replace(/ OR /gi,"~::~"+e+e+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+e+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+e).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+e+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}i.prototype.xml=function(t,e){var i=t.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),r=i.length,o=!1,a=0,s="",l=0,u=e?n(e):this.shift;for(l=0;r>l;l++)i[l].search(/<!/)>-1?(s+=u[a]+i[l],o=!0,(i[l].search(/-->/)>-1||i[l].search(/\]>/)>-1||i[l].search(/!DOCTYPE/)>-1)&&(o=!1)):i[l].search(/-->/)>-1||i[l].search(/\]>/)>-1?(s+=i[l],o=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(s+=i[l],o||a--):i[l].search(/<\w/)>-1&&-1==i[l].search(/<\//)&&-1==i[l].search(/\/>/)?s=s+=o?i[l]:u[a++]+i[l]:i[l].search(/<\w/)>-1&&i[l].search(/<\//)>-1?s=s+=o?i[l]:u[a]+i[l]:i[l].search(/<\//)>-1?s=s+=o?i[l]:u[--a]+i[l]:i[l].search(/\/>/)>-1?s=s+=o?i[l]:u[a]+i[l]:s+=i[l].search(/<\?/)>-1?u[a]+i[l]:i[l].search(/xmlns\:/)>-1||i[l].search(/xmlns\=/)>-1?u[a]+i[l]:i[l];return"\n"==s[0]?s.slice(1):s},i.prototype.json=function(t,e){var e=e?e:this.step;return"undefined"==typeof JSON?t:"string"==typeof t?JSON.stringify(JSON.parse(t),null,e):"object"==typeof t?JSON.stringify(t,null,e):t},i.prototype.css=function(t,e){var i=t.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),r=i.length,o=0,a="",s=0,l=e?n(e):this.shift;for(s=0;r>s;s++)a+=/\{/.exec(i[s])?l[o++]+i[s]:/\}/.exec(i[s])?l[--o]+i[s]:/\*\\/.exec(i[s])?l[o]+i[s]:l[o]+i[s];return a.replace(/^\n{1,}/,"")},i.prototype.sql=function(t,e){var i=t.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),a=i.length,s=[],l=0,u=this.step,c=0,h="",d=0,f=e?n(e):this.shift;for(d=0;a>d;d++)s=d%2?s.concat(i[d]):s.concat(o(i[d],u));for(a=s.length,d=0;a>d;d++){c=r(s[d],c),/\s{0,}\s{0,}SELECT\s{0,}/.exec(s[d])&&(s[d]=s[d].replace(/\,/g,",\n"+u+u)),/\s{0,}\s{0,}SET\s{0,}/.exec(s[d])&&(s[d]=s[d].replace(/\,/g,",\n"+u+u)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(s[d])?(l++,h+=f[l]+s[d]):/\'/.exec(s[d])?(1>c&&l&&l--,h+=s[d]):(h+=f[l]+s[d],1>c&&l&&l--)}return h=h.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},i.prototype.xmlmin=function(t,e){var n=e?t:t.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns");return n.replace(/>\s{0,}</g,"><")},i.prototype.jsonmin=function(t){return"undefined"==typeof JSON?t:JSON.stringify(JSON.parse(t),null,0)},i.prototype.cssmin=function(t,e){var n=e?t:t.replace(/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//g,"");return n.replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},i.prototype.sqlmin=function(t){return t.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},t.exports=new i},function(t,e,n){var i,r;(function(){function n(t){function e(e,n,i,r,o,a){for(;o>=0&&a>o;o+=t){var s=r?r[o]:o;i=n(i,e[s],s,e)}return i}return function(n,i,r,o){i=S(i,o,4);var a=!L(n)&&w.keys(n),s=(a||n).length,l=t>0?0:s-1;return arguments.length<3&&(r=n[a?a[l]:l],l+=t),e(n,i,r,a,l,s)}}function o(t){return function(e,n,i){n=A(n,i);for(var r=M(e),o=t>0?0:r-1;o>=0&&r>o;o+=t)if(n(e[o],o,e))return o;return-1}}function a(t,e,n){return function(i,r,o){var a=0,s=M(i);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return o=n(i,r),i[o]===r?o:-1;if(r!==r)return o=e(p.call(i,a,s),w.isNaN),o>=0?o+a:-1;for(o=t>0?a:s-1;o>=0&&s>o;o+=t)if(i[o]===r)return o;return-1}}function s(t,e){var n=I.length,i=t.constructor,r=w.isFunction(i)&&i.prototype||h,o="constructor";for(w.has(t,o)&&!w.contains(e,o)&&e.push(o);n--;)o=I[n],o in t&&t[o]!==r[o]&&!w.contains(e,o)&&e.push(o)}var l=this,u=l._,c=Array.prototype,h=Object.prototype,d=Function.prototype,f=c.push,p=c.slice,_=h.toString,g=h.hasOwnProperty,m=Array.isArray,v=Object.keys,y=d.bind,b=Object.create,x=function(){},w=function(t){return t instanceof w?t:this instanceof w?void(this._wrapped=t):new w(t)};"undefined"!=typeof t&&t.exports&&(e=t.exports=w),e._=w,w.VERSION="1.8.3";var S=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}},A=function(t,e,n){return null==t?w.identity:w.isFunction(t)?S(t,e,n):w.isObject(t)?w.matcher(t):w.property(t)};w.iteratee=function(t,e){return A(t,e,1/0)};var k=function(t,e){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var r=1;i>r;r++)for(var o=arguments[r],a=t(o),s=a.length,l=0;s>l;l++){var u=a[l];e&&void 0!==n[u]||(n[u]=o[u])}return n}},C=function(t){if(!w.isObject(t))return{};if(b)return b(t);x.prototype=t;var e=new x;return x.prototype=null,e},T=function(t){return function(e){return null==e?void 0:e[t]}},E=Math.pow(2,53)-1,M=T("length"),L=function(t){var e=M(t);return"number"==typeof e&&e>=0&&E>=e};w.each=w.forEach=function(t,e,n){e=S(e,n);var i,r;if(L(t))for(i=0,r=t.length;r>i;i++)e(t[i],i,t);else{var o=w.keys(t);for(i=0,r=o.length;r>i;i++)e(t[o[i]],o[i],t)}return t},w.map=w.collect=function(t,e,n){e=A(e,n);for(var i=!L(t)&&w.keys(t),r=(i||t).length,o=Array(r),a=0;r>a;a++){var s=i?i[a]:a;o[a]=e(t[s],s,t)}return o},w.reduce=w.foldl=w.inject=n(1),w.reduceRight=w.foldr=n(-1),w.find=w.detect=function(t,e,n){var i;return i=L(t)?w.findIndex(t,e,n):w.findKey(t,e,n),void 0!==i&&-1!==i?t[i]:void 0},w.filter=w.select=function(t,e,n){var i=[];return e=A(e,n),w.each(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i},w.reject=function(t,e,n){return w.filter(t,w.negate(A(e)),n)},w.every=w.all=function(t,e,n){e=A(e,n);for(var i=!L(t)&&w.keys(t),r=(i||t).length,o=0;r>o;o++){var a=i?i[o]:o;if(!e(t[a],a,t))return!1}return!0},w.some=w.any=function(t,e,n){e=A(e,n);for(var i=!L(t)&&w.keys(t),r=(i||t).length,o=0;r>o;o++){var a=i?i[o]:o;if(e(t[a],a,t))return!0}return!1},w.contains=w.includes=w.include=function(t,e,n,i){return L(t)||(t=w.values(t)),("number"!=typeof n||i)&&(n=0),w.indexOf(t,e,n)>=0},w.invoke=function(t,e){var n=p.call(arguments,2),i=w.isFunction(e);return w.map(t,function(t){var r=i?e:t[e];return null==r?r:r.apply(t,n)})},w.pluck=function(t,e){return w.map(t,w.property(e))},w.where=function(t,e){return w.filter(t,w.matcher(e))},w.findWhere=function(t,e){return w.find(t,w.matcher(e))},w.max=function(t,e,n){var i,r,o=-(1/0),a=-(1/0);if(null==e&&null!=t){t=L(t)?t:w.values(t);for(var s=0,l=t.length;l>s;s++)i=t[s],i>o&&(o=i)}else e=A(e,n),w.each(t,function(t,n,i){r=e(t,n,i),(r>a||r===-(1/0)&&o===-(1/0))&&(o=t,a=r)});return o},w.min=function(t,e,n){var i,r,o=1/0,a=1/0;if(null==e&&null!=t){t=L(t)?t:w.values(t);for(var s=0,l=t.length;l>s;s++)i=t[s],o>i&&(o=i)}else e=A(e,n),w.each(t,function(t,n,i){r=e(t,n,i),(a>r||r===1/0&&o===1/0)&&(o=t,a=r)});return o},w.shuffle=function(t){for(var e,n=L(t)?t:w.values(t),i=n.length,r=Array(i),o=0;i>o;o++)e=w.random(0,o),e!==o&&(r[o]=r[e]),r[e]=n[o];return r},w.sample=function(t,e,n){return null==e||n?(L(t)||(t=w.values(t)),t[w.random(t.length-1)]):w.shuffle(t).slice(0,Math.max(0,e))},w.sortBy=function(t,e,n){return e=A(e,n),w.pluck(w.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var R=function(t){return function(e,n,i){var r={};return n=A(n,i),w.each(e,function(i,o){var a=n(i,o,e);t(r,i,a)}),r}};w.groupBy=R(function(t,e,n){w.has(t,n)?t[n].push(e):t[n]=[e]}),w.indexBy=R(function(t,e,n){t[n]=e}),w.countBy=R(function(t,e,n){w.has(t,n)?t[n]++:t[n]=1}),w.toArray=function(t){return t?w.isArray(t)?p.call(t):L(t)?w.map(t,w.identity):w.values(t):[]},w.size=function(t){return null==t?0:L(t)?t.length:w.keys(t).length},w.partition=function(t,e,n){e=A(e,n);var i=[],r=[];return w.each(t,function(t,n,o){(e(t,n,o)?i:r).push(t)}),[i,r]},w.first=w.head=w.take=function(t,e,n){return null!=t?null==e||n?t[0]:w.initial(t,t.length-e):void 0},w.initial=function(t,e,n){return p.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},w.last=function(t,e,n){return null!=t?null==e||n?t[t.length-1]:w.rest(t,Math.max(0,t.length-e)):void 0},w.rest=w.tail=w.drop=function(t,e,n){return p.call(t,null==e||n?1:e)},w.compact=function(t){return w.filter(t,w.identity)};var O=function(t,e,n,i){for(var r=[],o=0,a=i||0,s=M(t);s>a;a++){var l=t[a];if(L(l)&&(w.isArray(l)||w.isArguments(l))){e||(l=O(l,e,n));var u=0,c=l.length;for(r.length+=c;c>u;)r[o++]=l[u++]}else n||(r[o++]=l)}return r};w.flatten=function(t,e){return O(t,e,!1)},w.without=function(t){return w.difference(t,p.call(arguments,1))},w.uniq=w.unique=function(t,e,n,i){w.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=A(n,i));for(var r=[],o=[],a=0,s=M(t);s>a;a++){var l=t[a],u=n?n(l,a,t):l;e?(a&&o===u||r.push(l),o=u):n?w.contains(o,u)||(o.push(u),r.push(l)):w.contains(r,l)||r.push(l)}return r},w.union=function(){return w.uniq(O(arguments,!0,!0))},w.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=M(t);r>i;i++){var o=t[i];if(!w.contains(e,o)){for(var a=1;n>a&&w.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},w.difference=function(t){var e=O(arguments,!0,!0,1);return w.filter(t,function(t){return!w.contains(e,t)})},w.zip=function(){return w.unzip(arguments)},w.unzip=function(t){for(var e=t&&w.max(t,M).length||0,n=Array(e),i=0;e>i;i++)n[i]=w.pluck(t,i);return n},w.object=function(t,e){for(var n={},i=0,r=M(t);r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},w.findIndex=o(1),w.findLastIndex=o(-1),w.sortedIndex=function(t,e,n,i){n=A(n,i,1);for(var r=n(e),o=0,a=M(t);a>o;){var s=Math.floor((o+a)/2);n(t[s])<r?o=s+1:a=s}return o},w.indexOf=a(1,w.findIndex,w.sortedIndex),w.lastIndexOf=a(-1,w.findLastIndex),w.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;i>o;o++,t+=n)r[o]=t;return r};var P=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var o=C(t.prototype),a=t.apply(o,r);return w.isObject(a)?a:o};w.bind=function(t,e){if(y&&t.bind===y)return y.apply(t,p.call(arguments,1));if(!w.isFunction(t))throw new TypeError("Bind must be called on a function");var n=p.call(arguments,2),i=function(){return P(t,i,e,this,n.concat(p.call(arguments)))};return i},w.partial=function(t){var e=p.call(arguments,1),n=function(){for(var i=0,r=e.length,o=Array(r),a=0;r>a;a++)o[a]=e[a]===w?arguments[i++]:e[a];for(;i<arguments.length;)o.push(arguments[i++]);return P(t,n,this,this,o)};return n},w.bindAll=function(t){var e,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(e=1;i>e;e++)n=arguments[e],t[n]=w.bind(t[n],t);return t},w.memoize=function(t,e){var n=function(i){var r=n.cache,o=""+(e?e.apply(this,arguments):i);return w.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n},w.delay=function(t,e){var n=p.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},w.defer=w.partial(w.delay,w,1),w.throttle=function(t,e,n){var i,r,o,a=null,s=0;n||(n={});var l=function(){s=n.leading===!1?0:w.now(),a=null,o=t.apply(i,r),a||(i=r=null)};return function(){var u=w.now();s||n.leading!==!1||(s=u);var c=e-(u-s);return i=this,r=arguments,0>=c||c>e?(a&&(clearTimeout(a),a=null),s=u,o=t.apply(i,r),a||(i=r=null)):a||n.trailing===!1||(a=setTimeout(l,c)),o}},w.debounce=function(t,e,n){var i,r,o,a,s,l=function(){var u=w.now()-a;e>u&&u>=0?i=setTimeout(l,e-u):(i=null,n||(s=t.apply(o,r),i||(o=r=null)))};return function(){o=this,r=arguments,a=w.now();var u=n&&!i;return i||(i=setTimeout(l,e)),u&&(s=t.apply(o,r),o=r=null),s}},w.wrap=function(t,e){return w.partial(e,t)},w.negate=function(t){return function(){return!t.apply(this,arguments)}},w.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},w.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},w.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},w.once=w.partial(w.before,2);var D=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];w.keys=function(t){if(!w.isObject(t))return[];if(v)return v(t);var e=[];for(var n in t)w.has(t,n)&&e.push(n);return D&&s(t,e),e},w.allKeys=function(t){if(!w.isObject(t))return[];var e=[];for(var n in t)e.push(n);return D&&s(t,e),e},w.values=function(t){for(var e=w.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=t[e[r]];return i},w.mapObject=function(t,e,n){e=A(e,n);for(var i,r=w.keys(t),o=r.length,a={},s=0;o>s;s++)i=r[s],a[i]=e(t[i],i,t);return a},w.pairs=function(t){for(var e=w.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=[e[r],t[e[r]]];return i},w.invert=function(t){for(var e={},n=w.keys(t),i=0,r=n.length;r>i;i++)e[t[n[i]]]=n[i];return e},w.functions=w.methods=function(t){var e=[];for(var n in t)w.isFunction(t[n])&&e.push(n);return e.sort()},w.extend=k(w.allKeys),w.extendOwn=w.assign=k(w.keys),w.findKey=function(t,e,n){e=A(e,n);for(var i,r=w.keys(t),o=0,a=r.length;a>o;o++)if(i=r[o],e(t[i],i,t))return i},w.pick=function(t,e,n){var i,r,o={},a=t;if(null==a)return o;w.isFunction(e)?(r=w.allKeys(a),i=S(e,n)):(r=O(arguments,!1,!1,1),i=function(t,e,n){return e in n},a=Object(a));for(var s=0,l=r.length;l>s;s++){var u=r[s],c=a[u];i(c,u,a)&&(o[u]=c)}return o},w.omit=function(t,e,n){if(w.isFunction(e))e=w.negate(e);else{var i=w.map(O(arguments,!1,!1,1),String);e=function(t,e){return!w.contains(i,e)}}return w.pick(t,e,n)},w.defaults=k(w.allKeys,!0),w.create=function(t,e){var n=C(t);return e&&w.extendOwn(n,e),n},w.clone=function(t){return w.isObject(t)?w.isArray(t)?t.slice():w.extend({},t):t},w.tap=function(t,e){return e(t),t},w.isMatch=function(t,e){var n=w.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),o=0;i>o;o++){var a=n[o];if(e[a]!==r[a]||!(a in r))return!1}return!0};var N=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof w&&(t=t._wrapped),e instanceof w&&(e=e._wrapped);var r=_.call(t);if(r!==_.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(w.isFunction(a)&&a instanceof a&&w.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var l=n.length;l--;)if(n[l]===t)return i[l]===e;if(n.push(t),i.push(e),o){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!N(t[l],e[l],n,i))return!1}else{var u,c=w.keys(t);if(l=c.length,w.keys(e).length!==l)return!1;for(;l--;)if(u=c[l],!w.has(e,u)||!N(t[u],e[u],n,i))return!1}return n.pop(),i.pop(),!0};w.isEqual=function(t,e){return N(t,e)},w.isEmpty=function(t){return null==t?!0:L(t)&&(w.isArray(t)||w.isString(t)||w.isArguments(t))?0===t.length:0===w.keys(t).length},w.isElement=function(t){return!(!t||1!==t.nodeType)},w.isArray=m||function(t){return"[object Array]"===_.call(t)},w.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},w.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){w["is"+t]=function(e){return _.call(e)==="[object "+t+"]"}}),w.isArguments(arguments)||(w.isArguments=function(t){return w.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(w.isFunction=function(t){return"function"==typeof t||!1}),w.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},w.isNaN=function(t){return w.isNumber(t)&&t!==+t},w.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===_.call(t)},w.isNull=function(t){return null===t},w.isUndefined=function(t){return void 0===t},w.has=function(t,e){return null!=t&&g.call(t,e)},w.noConflict=function(){return l._=u,this},w.identity=function(t){return t},w.constant=function(t){return function(){return t}},w.noop=function(){},w.property=T,w.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},w.matcher=w.matches=function(t){return t=w.extendOwn({},t),function(e){return w.isMatch(e,t)}},w.times=function(t,e,n){var i=Array(Math.max(0,t));e=S(e,n,1);for(var r=0;t>r;r++)i[r]=e(r);return i},w.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},w.now=Date.now||function(){return(new Date).getTime()};var F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},B=w.invert(F),z=function(t){var e=function(e){return t[e]},n="(?:"+w.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}};w.escape=z(F),w.unescape=z(B),w.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),w.isFunction(i)?i.call(t):i};var H=0;w.uniqueId=function(t){var e=++H+"";return t?t+e:e},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\u2028|\u2029/g,U=function(t){return"\\"+G[t]};w.template=function(t,e,n){!e&&n&&(e=n),e=w.defaults({},e,w.templateSettings);var i=RegExp([(e.escape||q).source,(e.interpolate||q).source,(e.evaluate||q).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(i,function(e,n,i,a,s){return o+=t.slice(r,s).replace(j,U),r=s+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(e.variable||"obj","_",o)}catch(s){throw s.source=o,s}var l=function(t){return a.call(this,t,w)},u=e.variable||"obj";return l.source="function("+u+"){\n"+o+"}",l},w.chain=function(t){var e=w(t);return e._chain=!0,e};var V=function(t,e){return t._chain?w(e).chain():e};w.mixin=function(t){w.each(w.functions(t),function(e){var n=w[e]=t[e];w.prototype[e]=function(){var t=[this._wrapped];return f.apply(t,arguments),V(this,n.apply(w,t))}})},w.mixin(w),w.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=c[t];w.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],V(this,n)}}),w.each(["concat","join","slice"],function(t){var e=c[t];w.prototype[t]=function(){return V(this,e.apply(this._wrapped,arguments))}}),w.prototype.value=function(){return this._wrapped},w.prototype.valueOf=w.prototype.toJSON=w.prototype.value,w.prototype.toString=function(){return""+this._wrapped},i=[],r=function(){return w}.apply(e,i),!(void 0!==r&&(t.exports=r))}).call(this)},function(t,e,n){var i,r,o=o||function(t){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var e=t.document,n=function(){return t.URL||t.webkitURL||t},i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in i,o=function(t){var e=new MouseEvent("click");t.dispatchEvent(e)},a=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),s=t.webkitRequestFileSystem,l=t.requestFileSystem||s||t.mozRequestFileSystem,u=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},c="application/octet-stream",h=0,d=500,f=function(e){var i=function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()};t.chrome?i():setTimeout(i,d)},p=function(t,e,n){e=[].concat(e);for(var i=e.length;i--;){var r=t["on"+e[i]];if("function"==typeof r)try{r.call(t,n||t)}catch(o){u(o)}}},_=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t},g=function(e,u,d){d||(e=_(e));var g,m,v,y=this,b=e.type,x=!1,w=function(){p(y,"writestart progress write writeend".split(" "))},S=function(){if(m&&a&&"undefined"!=typeof FileReader){var i=new FileReader;return i.onloadend=function(){var t=i.result;m.location.href="data:attachment/file"+t.slice(t.search(/[,;]/)),y.readyState=y.DONE,w()},i.readAsDataURL(e),void(y.readyState=y.INIT)}if((x||!g)&&(g=n().createObjectURL(e)),m)m.location.href=g;else{var r=t.open(g,"_blank");void 0==r&&a&&(t.location.href=g)}y.readyState=y.DONE,w(),f(g)},A=function(t){return function(){return y.readyState!==y.DONE?t.apply(this,arguments):void 0}},k={create:!0,exclusive:!1};return y.readyState=y.INIT,u||(u="download"),r?(g=n().createObjectURL(e),i.href=g,i.download=u,void setTimeout(function(){o(i),w(),f(g),y.readyState=y.DONE})):(t.chrome&&b&&b!==c&&(v=e.slice||e.webkitSlice,e=v.call(e,0,e.size,c),x=!0),s&&"download"!==u&&(u+=".download"),(b===c||s)&&(m=t),l?(h+=e.size,void l(t.TEMPORARY,h,A(function(t){t.root.getDirectory("saved",k,A(function(t){var n=function(){t.getFile(u,k,A(function(t){t.createWriter(A(function(n){n.onwriteend=function(e){m.location.href=t.toURL(),y.readyState=y.DONE,p(y,"writeend",e),f(t)},n.onerror=function(){var t=n.error;t.code!==t.ABORT_ERR&&S()},"writestart progress write abort".split(" ").forEach(function(t){n["on"+t]=y["on"+t]}),n.write(e),y.abort=function(){n.abort(),y.readyState=y.DONE},y.readyState=y.WRITING}),S)}),S)};t.getFile(u,{create:!1},A(function(t){t.remove(),n()}),A(function(t){t.code===t.NOT_FOUND_ERR?n():S()}))}),S)}),S)):void S())},m=g.prototype,v=function(t,e,n){return new g(t,e,n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return n||(t=_(t)),navigator.msSaveOrOpenBlob(t,e||"download")}:(m.abort=function(){var t=this;t.readyState=t.DONE,p(t,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,v)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof t&&t.exports?t.exports.saveAs=o:null!==n(199)&&null!=n(200)&&(i=[],r=function(){return o}.apply(e,i),!(void 0!==r&&(t.exports=r)))},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,n){function i(t,e,n,i){var r=t.append("div").attr("id","rxn-input");this.placed_div=v(r,e,{x:240,y:0}),this.placed_div.hide();var o=y(r.node(),{backgroundColor:"#eee"});d3.select(o.input),this.completely=o,r.append("button").attr("class","button input-close-button").text("×").on("mousedown",function(){this.hide_dropdown()}.bind(this)),this.map=e;var a=90;this.direction_arrow=new b(e.sel),this.direction_arrow.set_rotation(a),this.setup_map_callbacks(e),this.zoom_container=n,this.setup_zoom_callbacks(n),this.settings=i,this.toggle(!1),this.target_coords=null}function r(t){t.callback_manager.set("select_metabolite_with_id.input",function(t,e){this.is_active&&(this.reload(t,e,!1),this.show_dropdown(e)),this.hide_target()}.bind(this)),t.callback_manager.set("select_selectable.input",function(t,e,n){this.hide_target(),1==t&&this.is_active&&n?(this.reload(e,n,!1),this.show_dropdown(n)):this.toggle(!1)}.bind(this)),t.callback_manager.set("deselect_nodes",function(){this.direction_arrow.hide(),this.hide_dropdown()}.bind(this)),t.callback_manager.set("before_svg_export",function(){this.direction_arrow.hide(),this.hide_target()}.bind(this))}function o(t){t.callback_manager.set("zoom.input",function(){this.is_active&&this.place_at_selected()}.bind(this))}function a(){return this.placed_div.is_visible()}function s(t){void 0===t?this.is_active=!this.is_active:this.is_active=t,this.is_active?(this.toggle_start_reaction_listener(!0),w.isNull(this.target_coords)?this.reload_at_selected():this.placed_div.place(this.target_coords),this.show_dropdown(),this.map.set_status("Click on the canvas or an existing metabolite"),this.direction_arrow.show()):(this.toggle_start_reaction_listener(!1),this.hide_dropdown(),this.map.set_status(null),this.direction_arrow.hide())}function l(t){this.clear_escape=this.map.key_manager.add_escape_listener(function(){this.hide_dropdown()}.bind(this),!0),this.completely.input.blur(),this.completely.repaint(),this.completely.setText(""),this.completely.input.focus()}function u(){this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.placed_div.hide(),this.completely.input.blur(),this.completely.hideDropDown()}function c(){this.map.deselect_text_labels();var t=this.map.select_single_node();if(null!=t){var e={x:t.x,y:t.y};this.place(e)}}function h(t){this.placed_div.place(t),this.direction_arrow.set_location(t),this.direction_arrow.show()}function d(){this.map.deselect_text_labels();var t=this.map.select_single_node();if(null==t)return!1;var e={x:t.x,y:t.y};return this.reload(t,e,!1),!0}function f(t,e,n){function i(t,e){for(var n in e)if(e[n].bigg_id==t)return!0;return!1}if(!n&&!t)return void console.error("No selected node, and not starting from scratch");if(this.place(e),null===this.map.cobra_model)return void this.completely.setText("Cannot add: No model.");var r="name"==this.settings.get_option("identifiers_on_map"),o=this.settings.get_option("allow_building_duplicate_reactions"),a=[],s=this.map.cobra_model.reactions,l=this.map.cobra_model.metabolites,u=this.map.reactions,c=this.map.has_data_on_reactions,h=(this.map.reaction_data,this.map.reaction_data_styles,t?r?t.name:t.bigg_id:""),d=function(t,e){return t.replace(new RegExp("(^| )("+e.join("|")+")($| )","g"),"$1<b>$2</b>$3")},f={};for(var p in s){var _=s[p],g=_.name,v=r?g:p;if(o||!i(p,u))for(var y in _.metabolites)if(n||y==t.bigg_id){if(p in f)continue;l[y].name;if(c)a.push({reaction_data:_.data,html:"<b>"+v+"</b>: "+_.data_string,matches:[v],id:p}),f[p]=!0;else{var b,S={},A=[];if(r)for(b in _.metabolites){var k=l[b].name;S[k]=_.metabolites[b],A.push(k)}else{S=m.clone(_.metabolites);for(b in _.metabolites)A.push(b)}var C=w.flatten(_.genes.map(function(t){return[t.name,t.bigg_id]})),T=x.build_reaction_string(S,_.reversibility,_.lower_bound,_.upper_bound);a.push({html:"<b>"+v+"</b>	"+d(T,[h]),matches:[v].concat(A).concat(C),id:p}),f[p]=!0}}}var E;E=c?function(t,e){return Math.abs(e.reaction_data)-Math.abs(t.reaction_data)}:function(t,e){return t.html.toLowerCase()<e.html.toLowerCase()?-1:1},a=a.sort(E);var M=this.completely;M.options=a,M.setText("");var L=this.direction_arrow,R=function(i){if(null!==i)if(n)this.map.new_reaction_from_scratch(i,e,L.get_rotation());else{if(!(t.node_id in this.map.nodes))return console.error("Selected node no longer exists"),void this.hide_dropdown();this.map.new_reaction_for_metabolite(i,t.node_id,L.get_rotation())}}.bind(this);M.onEnter=function(t){this.setText(""),this.onChange(""),R(t)}}function p(t){if(void 0===t)this.start_reaction_listener=!this.start_reaction_listener;else{if(this.start_reaction_listener==t)return;this.start_reaction_listener=t}this.start_reaction_listener?(this.map.sel.on("click.start_reaction",function(t){if(!this.direction_arrow.dragging){var e={x:d3.mouse(t)[0],y:d3.mouse(t)[1]};this.map.deselect_nodes(),this.map.deselect_text_labels(),this.reload(null,e,!0),this.show_target(this.map,e),this.show_dropdown(e)}}.bind(this,this.map.sel.node())),this.map.sel.classed("start-reaction-cursor",!0)):(this.map.sel.on("click.start_reaction",null),this.map.sel.classed("start-reaction-cursor",!1),this.hide_target())}function _(){this.target_coords&&this.map.sel.selectAll(".start-reaction-target").remove(),this.target_coords=null}function g(t,e){var n=t.sel.selectAll(".start-reaction-target").data([12,5]);n.enter().append("circle").classed("start-reaction-target",!0).attr("r",function(t){return t}).style("stroke-width",4),n.style("visibility","visible").attr("transform","translate("+e.x+","+e.y+")"),this.target_coords=e}var m=n(195),v=n(202),y=n(203),b=n(204),x=n(205),w=n(197),S=m.make_class();S.prototype={init:i,setup_map_callbacks:r,setup_zoom_callbacks:o,is_visible:a,toggle:s,show_dropdown:l,hide_dropdown:u,place_at_selected:c,place:h,reload_at_selected:d,reload:f,toggle_start_reaction_listener:p,hide_target:_,show_target:g},t.exports=S},function(t,e,n){function i(t,e,n){this.div=t,void 0===n&&(n={x:0,y:0}),this.displacement=n,this.map=e}function r(){return"none"!=this.div.style("display")}function o(t){this.div.style("display",null);var e=this.map.zoom_container.window_translate,n=this.map.zoom_container.window_scale,i=this.map.get_size(),r=Math.max(20,Math.min(i.width-270,n*t.x+e.x-this.displacement.x)),o=Math.max(20,Math.min(i.height-40,n*t.y+e.y-this.displacement.y));this.div.style("position","absolute").style("display","block").style("left",r+"px").style("top",o+"px")}function a(){this.div.style("display","none")}var s=n(195),l=s.make_class();l.prototype={init:i,is_visible:r,place:o,hide:a},t.exports=l},function(t,e,n){/**
	 * @license
	 *
	 * complete.ly 1.0.0
	 * MIT Licensing
	 * Copyright (c) 2013 Lorenzo Puccetti
	 *
	 * This Software shall be used for doing good things, not bad things.
	 *
	 *
	 * Modified by Zachary King (c) 2014.
	 *
	 **/
var i=n(195);t.exports=function(t,e){function n(t){return void 0===d&&(d=document.createElement("span"),d.style.visibility="hidden",d.style.position="fixed",d.style.outline="0",d.style.margin="0",d.style.padding="0",d.style.border="0",d.style.left="0",d.style.whiteSpace="pre",d.style.fontSize=e.fontSize,d.style.fontFamily=e.fontFamily,d.style.fontWeight="normal",document.body.appendChild(d)),d.innerHTML=String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),d.getBoundingClientRect().right}document=i.get_document(t),window=i.get_window(t),e=e||{},e.fontSize=e.fontSize||"13px",e.fontFamily=e.fontFamily||"sans-serif",e.promptInnerHTML=e.promptInnerHTML||"",e.color=e.color||"#333",e.hintColor=e.hintColor||"#aaa",e.backgroundColor=e.backgroundColor||"#fff",e.dropDownBorderColor=e.dropDownBorderColor||"#aaa",e.dropDownZIndex=e.dropDownZIndex||"100",e.dropDownOnHoverBackgroundColor=e.dropDownOnHoverBackgroundColor||"#ddd";var r=document.createElement("input");r.type="text",r.spellcheck=!1,r.style.fontSize=e.fontSize,r.style.fontFamily=e.fontFamily,r.style.color=e.color,r.style.backgroundColor=e.backgroundColor,r.style.width="100%",r.style.outline="0",r.style.border="0",r.style.margin="0",r.style.padding="0";var o=r.cloneNode();o.disabled="",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.borderColor="transparent",o.style.boxShadow="none",o.style.color=e.hintColor,r.style.backgroundColor="transparent",r.style.verticalAlign="top",r.style.position="relative";var a=document.createElement("div");a.style.position="relative",a.style.outline="0",a.style.border="0",a.style.margin="0",a.style.padding="0";var s=document.createElement("div");if(s.style.position="absolute",s.style.outline="0",s.style.margin="0",s.style.padding="0",s.style.border="0",s.style.fontSize=e.fontSize,s.style.fontFamily=e.fontFamily,s.style.color=e.color,s.style.backgroundColor=e.backgroundColor,s.style.top="0",s.style.left="0",s.style.overflow="hidden",s.innerHTML=e.promptInnerHTML,s.style.background="transparent",void 0===document.body)throw"document.body is undefined. The library was wired up incorrectly.";document.body.appendChild(s);var l=s.getBoundingClientRect().right;a.appendChild(s),s.style.visibility="visible",s.style.left="-"+l+"px",a.style.marginLeft=l+"px",a.appendChild(o),a.appendChild(r);var u=document.createElement("div");u.style.position="absolute",u.style.visibility="hidden",u.style.outline="0",u.style.margin="0",u.style.padding="0",u.style.textAlign="left",u.style.fontSize=e.fontSize,u.style.fontFamily=e.fontFamily,u.style.backgroundColor=e.backgroundColor,u.style.zIndex=e.dropDownZIndex,u.style.cursor="default",u.style.borderStyle="solid",u.style.borderWidth="1px",u.style.borderColor=e.dropDownBorderColor,u.style.overflowX="hidden",u.style.whiteSpace="pre",u.style.overflowY="scroll";var c=function(t){var n=[],i=0,r=-1,o=null,a=function(){this.style.outline="1px solid #ddd"},s=function(){this.style.outline="0"},l=function(t){t.preventDefault(),u.onmouseselection(this.id)},u={hide:function(){t.style.visibility="hidden"},refresh:function(r,o){t.style.visibility="hidden",i=0,t.innerHTML="";var c=window.innerHeight||document.documentElement.clientHeight,h=t.parentNode.getBoundingClientRect(),d=h.top-6,f=c-h.bottom-6;n=[];for(var p=0;p<o.length;p++){var g=o[p].matches.filter(function(t){return 0==t.toLowerCase().indexOf(r.toLowerCase())});if(0!=g.length){var m=document.createElement("div");if(m.style.color=e.color,m.onmouseover=a,m.onmouseout=s,m.onmousedown=function(t){t.preventDefault()},m.ondblclick=l,m.__hint=g[0],m.id=o[p].id,m.innerHTML=o[p].html,n.push(m),t.appendChild(m),n.length>=_.display_limit){var v=document.createElement("div");v.innerHTML=" "+(o.length-n.length)+" more",n.push(v),t.appendChild(v);break}}}0!==n.length&&(u.highlight(0),d>3*f?(t.style.maxHeight=d+"px",t.style.top="",t.style.bottom="100%"):(t.style.top="100%",t.style.bottom="",t.style.maxHeight=f+"px"),t.style.visibility="visible")},highlight:function(t){-1!=r&&n[r]&&(n[r].style.backgroundColor=e.backgroundColor),n[t].style.backgroundColor=e.dropDownOnHoverBackgroundColor,r=t,o=n[t]},move:function(e){return"hidden"===t.style.visibility?"":i+e===-1||i+e===n.length?n[i].__hint:(i+=e,u.highlight(i),n[i].__hint)},onmouseselection:function(){},get_current_row:function(){return o}};return u},h=c(u);h.onmouseselection=function(t){_.onEnter(t),_.input.focus()},a.appendChild(u),t.appendChild(a);var d,f,p,_={get_hint:function(t){return t},display_limit:1e3,onArrowDown:function(){},onArrowUp:function(){},onEnter:function(){},onTab:function(){},onChange:function(){_.repaint()},startFrom:0,options:[],wrapper:a,input:r,hint:o,dropDown:u,prompt:s,setText:function(t){o.value=t,r.value=t},getText:function(){return r.value},hideDropDown:function(){h.hide()},repaint:function(){var t=r.value,e=_.startFrom,i=_.options,a=i.length,s=t.substring(e);f=t.substring(0,e),o.value="";for(var l=0;a>l;l++){var c=i[l].matches.filter(function(t){return 0==t.toLowerCase().indexOf(s.toLowerCase())});if(0!=c.length){o.value=_.get_hint(c[0]);break}}u.style.left=n(f)+"px",h.refresh(s,_.options)}},g=function(t,e){p=t.value;var n=function(){var n=t.value;p!==n&&(p=n,e(n))};t.addEventListener("input",n,!1),t.addEventListener("keyup",n,!1),t.addEventListener("change",n,!1)};g(r,function(t){_.onChange(t),_.repaint()});var m=function(t){t=t||window.event;var e=t.keyCode;if(33!=e&&34!=e)if(39!=e&&35!=e&&9!=e){if(13==e){var n=h.get_current_row().id;return void _.onEnter(n)}if(40==e){var i=h.move(1);return""==i&&_.onArrowDown(),void(o.value=_.get_hint(i))}if(38==e){var i=h.move(-1);return""==i&&_.onArrowUp(),o.value=_.get_hint(i),t.preventDefault(),void t.stopPropagation()}o.value=""}else if(9==e&&(t.preventDefault(),t.stopPropagation(),0==o.value.length&&_.onTab()),o.value.length>0){r.value=o.value;var a=p!=r.value;p=r.value,a&&_.onChange(r.value)}};return r.addEventListener("keydown",m,!1),_}},function(t,e,n){function i(t){function e(){return"M0 -5 L0 5 L20 5 L20 10 L30 0 L20 -10 L20 -5 Z"}this.arrow_container=t.append("g").attr("id","direction-arrow-container").attr("transform","translate(0,0)rotate(0)"),this.arrow=this.arrow_container.append("path").classed("direction-arrow",!0).attr("d",e()).style("visibility","hidden").attr("transform","translate(30,0)scale(2.5)"),this.sel=t,this.center={x:0,y:0},this._setup_drag(),this.dragging=!1,this.is_visible=!1,this.show()}function r(t){this.center=t;var e=g.d3_transform_catch(this.arrow_container.attr("transform"));this.arrow_container.attr("transform","translate("+t.x+","+t.y+")rotate("+e.rotate+")")}function o(t){var e=g.d3_transform_catch(this.arrow_container.attr("transform"));this.arrow_container.attr("transform","translate("+e.translate+")rotate("+t+")")}function a(t){var e=g.d3_transform_catch(this.arrow_container.attr("transform"));this.arrow_container.attr("transform","translate("+e.translate+")rotate("+(e.rotate+t)+")")}function s(){return g.d3_transform_catch(this.arrow_container.attr("transform")).rotate}function l(t){void 0===t?this.is_visible=!this.is_visible:this.is_visible=t,this.arrow.style("visibility",this.is_visible?"visible":"hidden")}function u(){this.toggle(!0)}function c(){this.toggle(!1)}function h(){this.set_rotation(0)}function d(){this.set_rotation(90)}function f(){this.set_rotation(180)}function p(){this.set_rotation(270)}function _(){var t=d3.behavior.drag().on("dragstart",function(t){d3.event.sourceEvent.stopPropagation(),this.dragging=!0}.bind(this)).on("drag.direction_arrow",function(t){var e={x:d3.event.dx,y:d3.event.dy},n={x:d3.mouse(this.sel.node())[0],y:d3.mouse(this.sel.node())[1]},i=g.angle_for_event(e,n,this.center);this.displace_rotation(g.to_degrees(i))}.bind(this)).on("dragend",function(t){setTimeout(function(){this.dragging=!1}.bind(this),200)}.bind(this));this.arrow_container.call(t)}var g=n(195),m=g.make_class();m.prototype={init:i,set_location:r,set_rotation:o,displace_rotation:a,get_rotation:s,toggle:l,show:u,hide:c,right:h,left:f,up:p,down:d,_setup_drag:_},t.exports=m},function(t,e,n){function i(t,e){var n=function(t){return 1==t?"":String(t)+" "},i=[],r=[];for(var o in t){var a=t[o];a>0?r.push(n(a)+o):i.push(n(Math.abs(a))+o)}var s=i.join(" + ");return s+=e?" ↔ ":" → ",s+=r.join(" + ")}function r(t){if(!t.reactions||!t.metabolites)throw new Error("Bad model data.");var e=new f;return e.reactions=t.reactions,e.metabolites=t.metabolites,e}function o(t){if(!t.reactions||!t.metabolites)throw new Error("Bad model data.");for(var e={},n=0,i=t.genes.length;i>n;n++){var r=t.genes[n],o=r.id;e[o]=r}var a=new f;a.reactions={};for(var n=0,i=t.reactions.length;i>n;n++){var r=t.reactions[n],o=r.id,s=h.clone(r);if(delete s.id,s.bigg_id=o,s.genes=[],s.reversibility=s.lower_bound<0&&s.upper_bound>0,s.upper_bound<=0&&s.lower_bound<0)for(var l in s.metabolites)s.metabolites[l]=-s.metabolites[l];if(delete s.lower_bound,delete s.upper_bound,"gene_reaction_rule"in s){var u=d.genes_for_gene_reaction_rule(s.gene_reaction_rule);u.forEach(function(t){if(t in e){var n=h.clone(e[t]);n.bigg_id=n.id,delete n.id,s.genes.push(n)}else console.warn("Could not find gene for gene_id "+t)})}a.reactions[o]=s}a.metabolites={};for(var n=0,i=t.metabolites.length;i>n;n++){var r=t.metabolites[n],o=r.id,c=h.clone(r);delete c.id,c.bigg_id=o,a.metabolites[o]=c}return a}function a(){this.reactions={},this.metabolites={}}function s(t,e,n){d.apply_reaction_data_to_reactions(this.reactions,t,e,n)}function l(t,e,n){d.apply_metabolite_data_to_nodes(this.metabolites,t,e,n)}function u(t,e,n,i,r){d.apply_gene_data_to_reactions(this.reactions,t,e,n,i,r)}function c(){return{reactions:this.reactions,metabolites:this.metabolites}}var h=n(195),d=n(206),f=h.make_class();f.from_exported_data=r,f.from_cobra_json=o,f.build_reaction_string=i,f.prototype={init:a,apply_reaction_data:s,apply_metabolite_data:l,apply_gene_data:u,model_for_export:c},t.exports=f},function(t,e,n){function i(t,e,n){function i(t,e){var n={},i=[null];for(var r in t){i=t[r].map(function(){return null});break}for(var o in e){var a=e[o],s=a.bigg_id,l={};a.genes.forEach(function(e){["bigg_id","name"].forEach(function(n){var r=t[e[n]]||g.clone(i),o=l[e.bigg_id];if("undefined"==typeof o)l[e.bigg_id]=r;else for(var a=0;a<r.length;a++){var s=r[a];null!==s&&(o[a]=s)}})}),n[s]=l}return n}if(null===t)return null;if(-1==["reaction_data","metabolite_data","gene_data"].indexOf(e))throw new Error("Invalid name argument: "+e);t instanceof Array||(t=[t]);var r=function(){return null===t?null:1==t.length?null:2==t.length?null:console.warn("Bad data style: "+e)};if(r(),t=g.array_to_object(t),"gene_data"==e){if(void 0===n)throw new Error("Must pass all_reactions argument for gene_data");t=i(t,n)}return t}function r(t,e,n){function i(t){return isFinite(t)?t:null}function r(t,e){return e?Math.abs(t):t}function o(t,e,n){return n?Math.abs(e-t):e-t}function a(t,e,n){if(0==t||0==e)return null;var i=e>=t?e/t:-t/e;return n?Math.abs(i):i}function s(t,e,n){if(0==t)return null;if(0>e/t)return null;var i=Math.log(e/t)/Math.log(2);return n?Math.abs(i):i}if(null===t)return null;var l=-1!=e.indexOf("abs");if(1==t.length){var u=_(t[0]);return null===u?null:r(u,l)}if(2!=t.length)throw new Error("Data array must be of length 1 or 2");var c=t.map(_);if(null===c[0]||null===c[1])return null;if("diff"==n)return o(c[0],c[1],l);if("fold"==n)return i(a(c[0],c[1],l));if("log2_fold"==n)return i(s(c[0],c[1],l));throw new Error("Bad data compare_style: "+n)}function o(t){return null===t||null===t[0]?!1:t[0]<0}function a(t,e,n,i,o,a){function s(t,e){return null===t?"nd":e(t)}var l=t,u=null===e,c={};n.forEach(function(t){var n=t[o];if("undefined"==typeof n)throw new Error("Bad value for identifiers_on_map: "+o);if("undefined"==typeof c[n])if(c[n]=!0,u)l=h(l,t.bigg_id,n+"\n");else{var d=e[t.bigg_id];"undefined"==typeof d&&(d=null);var f=r(d,i,a),p=null===f?m:d3.format(".3g");if(1==d.length)l=h(l,t.bigg_id,n+" ("+s(d[0],p)+")\n");else if(2==d.length){var g,v=d.reduce(function(t,e){return t||null!==_(e)},!1);g=v?n+" ("+s(d[0],p)+", "+s(d[1],p)+": "+s(f,p)+")\n":n+" ("+s(d[0],p)+", "+s(d[1],p)+")\n",l=h(l,t.bigg_id,g)}}}),l=l.replace(y,"\n").replace(b,"$1");var d=l.split("\n").map(function(t){for(var e=0,i=n.length;i>e;e++){var r=n[e];if(-1!=t.indexOf(r[o]))return{bigg_id:r.bigg_id,name:r.name,text:t}}return{bigg_id:null,name:null,text:t}});return d}function s(t,e){function n(t,e){return null===t?"(nd)":e(t)}if(null===t)return n(null);if(1==t.length){var i=null===e?m:d3.format(".3g");return n(t[0],i)}if(2==t.length){var i=null===e?m:d3.format(".3g"),r=n(t[0],i);return r+=", "+n(t[1],i),r+=": "+n(e,i)}return""}function l(t){var e=t[0].length,n=[];if(2>e||e>3)throw new Error("CSV file must have 2 or 3 columns");for(var i=1;e>i;i++)n[i-1]={};return t.slice(1).forEach(function(t){for(var e=1,i=t.length;i>e;e++)n[e-1][t[0]]=t[e]}),n}function u(t){var e=t.replace(x,"$1$2").replace(w,"").split(" ").filter(function(t){return""!=t});return g.unique_strings_array(e)}function c(t,e,n){var i=[null],r=1;for(var o in e){i=e[o].map(function(){return null}),r=i.length;break}if(""==t)return g.clone(i);for(var a=[],s=0;r>s;s++){var l=t,u=!0;for(var o in e){var c=_(e[o][s]);null===c?c=0:u=!1,l=h(l,o,c)}if(u)a.push(null);else{for(;;){var d=l;if(d=d.replace(S," $1 "),d=d.replace(C,function(t,e,n,i){var r=n.split(A).map(parseFloat),o=r.reduce(function(t,e){return t+e});return e+o+i}),d=d.replace(T,function(t,e,i,r){var o=i.split(k).map(parseFloat),a="min"==n?Math.min.apply(null,o):o.reduce(function(t,e){return t+e})/o.length;return e+a+r}),d==l)break;l=d}var f=Number(l);isNaN(f)?(console.warn("Could not evaluate "+t),a.push(null)):a.push(f)}}return a}function h(t,e,n){function i(t){return t.replace(v,"\\$1")}var r="(^|[\\s\\(\\)])",o="([\\s\\(\\)]|$)",a=r+i(e)+o;return t.replace(new RegExp(a,"g"),"$1"+n+"$2")}function d(t,e,n,i){var a,l,u,c;if(null===e){for(a in t){l=t[a],l.data=null,l.data_string="";for(u in l.segments)c=l.segments[u],c.data=null;l.gene_string=null}return!1}for(a in t){l=t[a];var h=e[l.bigg_id]||e[l.name]||null,d=r(h,n,i),f=o(h),p=s(h,d);l.data=d,l.data_string=p,l.reverse_flux=f,l.gene_string=null;for(u in l.segments)c=l.segments[u],c.data=l.data,c.reverse_flux=l.reverse_flux}return!0}function f(t,e,n,i){var o;if(null===e){for(o in t)t[o].data=null,t[o].data_string="";return!1}for(o in t){var a=t[o],l=e[a.bigg_id]||e[a.name]||null,u=r(l,n,i),c=s(l,u);a.data=u,a.data_string=c}return!0}function p(t,e,n,i,l,u){if(null===e){for(var h in t){var d=t[h];d.data=null,d.data_string="",d.reverse_flux=!1;for(var f in d.segments){var p=d.segments[f];p.data=null}d.gene_string=null}return!1}var _=[null];for(var h in e){for(var m in e[h]){_=e[h][m].map(function(){return null});break}break}for(var h in t){var v,y,d=t[h],b=d.gene_reaction_rule,x=e[d.bigg_id];"undefined"!=typeof x?(y=x,v=c(b,y,u)):(y={},v=g.clone(_));var w=r(v,n,l),S=o(v),A=s(v,w);d.data=w,d.data_string=A,d.reverse_flux=S;for(var f in d.segments){var p=d.segments[f];p.data=d.data,p.reverse_flux=d.reverse_flux}d.gene_string=a(b,y,d.genes,n,i,l)}return!0}function _(t){var e=Number(t);return isNaN(e)||parseFloat(t)!=e?null:e}var g=n(195);t.exports={import_and_check:i,text_for_data:s,float_for_data:r,reverse_flux_for_data:o,gene_string_for_data:a,csv_converter:l,genes_for_gene_reaction_rule:u,evaluate_gene_reaction_rule:c,replace_gene_in_rule:h,apply_reaction_data_to_reactions:d,apply_metabolite_data_to_nodes:f,apply_gene_data_to_reactions:p};var m=function(t){return t},v=/([.*+?^=!:${}()|\[\]\/\\])/g,y=/\n\s*\n/g,b=/\n\s*(\)*)\s*$/,x=/([\(\) ])(?:and|or)([\)\( ])/gi,w=/[\(\)]/g,S=/\(\s*(\S+)\s*\)/g,A=/\s+or\s+/i,k=/\s+and\s+/i,C=/(^|\()(\s*-?[0-9.]+\s+(?:or\s+-?[0-9.]+\s*)+)(\)|$)/gi,T=/(^|\(|or\s)(\s*-?[0-9.]+\s+(?:and\s+-?[0-9.]+\s*)+)(\sor|\)|$)/gi},function(t,e,n){function i(t,e,n,i){t.classed("escher-container",!0),i&&(d3.select("html").classed("fill-screen",!0),d3.select("body").classed("fill-screen",!0),t.classed("fill-screen-div",!0));var r=t.append("div").attr("class","escher-zoom-container"),o=r.append("div").attr("class","escher-3d-transform-container"),a=o.append("svg").attr("class","escher-svg").attr("xmlns","http://www.w3.org/2000/svg");a.select(".zoom-g").remove();var s=a.append("g").attr("class","zoom-g");this.selection=t,this.zoom_container=r,this.css3_transform_container=o,this.svg=a,this.zoomed_sel=s,this.window_translate={x:0,y:0},this.window_scale=1,this._scroll_behavior=e,this._use_3d_transform=n,this._pan_drag_on=!0,this._zoom_behavior=null,this._zoom_timeout=null,this._svg_scale=this.window_scale,this._svg_translate=this.window_translate,this.callback_manager=new v,this._update_scroll()}function r(t){this._scroll_behavior=t,this._update_scroll()}function o(t){this._use_3d_transform=t}function a(t){y.isUndefined(t)?this._pan_drag_on=!this._pan_drag_on:this._pan_drag_on=t,this._pan_drag_on?(this.zoomed_sel.classed("cursor-grab",!0).classed("cursor-grabbing",!1),this.zoomed_sel.on("mousedown.cursor",function(t){t.classed("cursor-grab",!1).classed("cursor-grabbing",!0)}.bind(null,this.zoomed_sel)).on("mouseup.cursor",function(t){t.classed("cursor-grab",!0).classed("cursor-grabbing",!1)}.bind(null,this.zoomed_sel))):(this.zoomed_sel.style("cursor",null).classed("cursor-grab",!1).classed("cursor-grabbing",!1),this.zoomed_sel.on("mousedown.cursor",null),this.zoomed_sel.on("mouseup.cursor",null)),this._update_scroll()}function s(){if(!y.contains(["zoom","pan","none"],this._scroll_behavior))throw Error("Bad value for scroll_behavior: "+this._scroll_behavior);this.zoom_container.on("mousewheel.zoom",null).on("DOMMouseScroll.zoom",null).on("wheel.zoom",null).on("dblclick.zoom",null).on("mousewheel.escher",null).on("DOMMouseScroll.escher",null).on("wheel.escher",null).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null);try{this._zoom_behavior=d3.behavior.zoom().on("zoom",function(){this.go_to(d3.event.scale,{x:d3.event.translate[0],y:d3.event.translate[1]})}.bind(this))}catch(t){return console.log("Not in a browser, so d3.behavior.zoom does not work."),void(this._zoom_behavior=null)}if(this._zoom_behavior.scale(this.window_scale),this._zoom_behavior.translate([this.window_translate.x,this.window_translate.y]),this.zoom_container.call(this._zoom_behavior),this.zoom_container.on("dblclick.zoom",null),this._pan_drag_on||this.zoom_container.on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null),"zoom"!==this._scroll_behavior&&this.zoom_container.on("mousewheel.zoom",null).on("DOMMouseScroll.zoom",null).on("wheel.zoom",null),"pan"===this._scroll_behavior){var e=function(){var t=d3.event,e=.5;t.stopPropagation(),t.preventDefault(),t.returnValue=!1;var n=function(t,n){var i=y.isUndefined(t)?n:-t/1.5;return i*e},i={x:this.window_translate.x-n(t.wheelDeltaX,t.deltaX),y:this.window_translate.y-n(t.wheelDeltaY,t.deltaY)};this.go_to(this.window_scale,i)}.bind(this);this.zoom_container.on("mousewheel.escher",e),this.zoom_container.on("DOMMouseScroll.escher",e),this.zoom_container.on("wheel.escher",e)}}function l(t,e){m.check_undefined(arguments,["scale","translate"]);var n=this._use_3d_transform;if(!t)throw new Error("Bad scale value");if(!e||!("x"in e)||!("y"in e)||isNaN(e.x)||isNaN(e.y))return console.error("Bad translate value");if(this.window_scale=t,this.window_translate=e,!y.isNull(this._zoom_behavior)){this._zoom_behavior.scale(t);var i=[e.x,e.y];this._zoom_behavior.translate(i)}n?(y.isNull(this._zoom_timeout)||clearTimeout(this._zoom_timeout),this._go_to_3d(t,e,this._svg_scale,this._svg_translate),this._zoom_timeout=y.delay(function(){this._go_to_svg(t,e)}.bind(this),100)):this._go_to_svg(t,e),this.callback_manager.run("go_to")}function u(t,e,n,i){var r=t/n,o=m.c_minus_c(e,m.c_times_scalar(i,r)),a="translate("+o.x+"px,"+o.y+"px) scale("+r+")";this.css3_transform_container.style("transform",a),this.css3_transform_container.style("-webkit-transform",a),this.css3_transform_container.style("transform-origin","0 0"),this.css3_transform_container.style("-webkit-transform-origin","0 0")}function c(){this.css3_transform_container.style("transform",null),this.css3_transform_container.style("-webkit-transform",null),this.css3_transform_container.style("transform-origin",null),this.css3_transform_container.style("-webkit-transform-origin",null)}function h(t,e,n){this.callback_manager.run("svg_start"),y.defer(function(){this._clear_3d(),this.zoomed_sel.attr("transform","translate("+e.x+","+e.y+") scale("+t+")"),this._svg_scale=this.window_scale,this._svg_translate=this.window_translate,y.defer(function(){this.callback_manager.run("svg_finish"),y.isUndefined(n)||n()}.bind(this))}.bind(this))}function d(t){var e=this.get_size(),n={x:e.width/2-((e.width/2-this.window_translate.x)*t+this.window_translate.x),y:e.height/2-((e.height/2-this.window_translate.y)*t+this.window_translate.y)};this.go_to(this.window_scale*t,m.c_plus_c(this.window_translate,n))}function f(){this.zoom_by(1.5)}function p(){this.zoom_by(.667)}function _(){return{width:parseInt(this.selection.style("width"),10),height:parseInt(this.selection.style("height"),10)}}function g(t){var e=120,n=this.get_size(),i={x:{min:-this.window_translate.x/this.window_scale+e/this.window_scale,max:-this.window_translate.x/this.window_scale+(n.width-e)/this.window_scale},y:{min:-this.window_translate.y/this.window_scale+e/this.window_scale,max:-this.window_translate.y/this.window_scale+(n.height-e)/this.window_scale}};t.x<i.x.min?(this.window_translate.x=this.window_translate.x-(t.x-i.x.min)*this.window_scale,this.go_to(this.window_scale,this.window_translate)):t.x>i.x.max&&(this.window_translate.x=this.window_translate.x-(t.x-i.x.max)*this.window_scale,this.go_to(this.window_scale,this.window_translate)),t.y<i.y.min?(this.window_translate.y=this.window_translate.y-(t.y-i.y.min)*this.window_scale,this.go_to(this.window_scale,this.window_translate)):t.y>i.y.max&&(this.window_translate.y=this.window_translate.y-(t.y-i.y.max)*this.window_scale,this.go_to(this.window_scale,this.window_translate))}var m=n(195),v=n(208),y=n(197),b=m.make_class();b.prototype={init:i,set_scroll_behavior:r,set_use_3d_transform:o,_update_scroll:s,toggle_pan_drag:a,go_to:l,_go_to_3d:u,_clear_3d:c,_go_to_svg:h,zoom_by:d,zoom_in:f,zoom_out:p,get_size:_,translate_off_screen:g},t.exports=b},function(t,e,n){function i(){}function r(t,e){return void 0===this.callbacks&&(this.callbacks={}),void 0===this.callbacks[t]&&(this.callbacks[t]=[]),this.callbacks[t].push(e),this}function o(t){return(void 0===this.callbacks||0==Object.keys(this.callbacks).length)&&console.warn("No callbacks to remove"),delete this.callbacks[t],this}function a(t,e){if(l.isUndefined(this.callbacks))return this;l.isUndefined(e)&&(e=null);var n=Array.prototype.slice.call(arguments,2);for(var i in this.callbacks){var r=i.split(".")[0];r==t&&this.callbacks[i].forEach(function(t){t.apply(e,n)})}return this}var s=n(195),l=n(197),u=s.make_class();u.prototype={init:i,set:r,remove:o,run:a},t.exports=u},function(t,e,n){function i(t,e,n,i,r,o,a,s,l,u,c){if(null===a){var h=i.get_size();a={x:-h.width,y:-h.height,width:3*h.width,height:3*h.height}}l=void 0===l||null===l||""==l?"new_map":String(l),u=void 0===u||null===u||""==u?At.generate_map_id():String(u),c=void 0===c||null===c?"":String(c),this.callback_manager=new Lt,this.svg=t,this.defs=At.setup_defs(t,e),this.canvas=new Ot(n,a),this.setup_containers(n),this.sel=n,this.zoom_container=i,this.settings=r,this.cobra_model=o,this.largest_ids={reactions:-1,nodes:-1,segments:-1,text_labels:-1},this.scale=new Tt,this.calc_data_stats("reaction"),this.calc_data_stats("metabolite"),this.scale.connect_to_settings(this.settings,this,M.bind(this)),this.undo_stack=new Mt,this.behavior=new Ct(this,this.undo_stack),this.draw=new kt(this.behavior,this.settings),this.key_manager=new Rt,this.key_manager.ctrl_equals_cmd=!0,this.enable_search=s,this.search_index=new Dt,this.map_name=l,this.map_id=u,this.map_description=c;this.beziers_enabled=!1,this.has_data_on_reactions=!1,this.has_data_on_nodes=!1,this.nodes={},this.reactions={},this.beziers={},this.text_labels={},this.apply_reaction_data_to_map(null),this.apply_metabolite_data_to_map(null),this.apply_gene_data_to_map(null),this.rotation_on=!1,this.listen_for_full_screen(function(){setTimeout(function(){this.zoom_extent_canvas()}.bind(this),50)}.bind(this))}function r(t,e,n,i,r,o,a,s){function l(t,e){return It.isUndefined(e)&&(e=0),It.isUndefined(t)?e:Math.max.apply(null,Object.keys(t).map(function(t){return parseInt(t)}).concat([e]))}var u=t[1].canvas,c=t[0].map_name,h=t[0].map_id,d=t[0].map_description.replace(/(\nLast Modified.*)+$/g,"")+"\nLast Modified "+Date(Date.now()).toString(),f=new Nt(e,n,i,r,o,a,u,s,c,h,d);f.reactions=t[1].reactions,f.nodes=t[1].nodes,f.text_labels=t[1].text_labels;for(var p in f.nodes){var _=f.nodes[p];if(_.connected_segments=[],s){if("metabolite"!=_.node_type)continue;f.search_index.insert("n"+p,{name:_.bigg_id,data:{type:"metabolite",node_id:p}}),f.search_index.insert("n_name"+p,{name:_.name,data:{type:"metabolite",node_id:p}})}}for(var g in f.reactions){var m=f.reactions[g];if(s){f.search_index.insert("r"+g,{name:m.bigg_id,data:{type:"reaction",reaction_id:g}}),f.search_index.insert("r_name"+g,{name:m.name,data:{type:"reaction",reaction_id:g}});for(var v in m.genes){var y=m.genes[v];f.search_index.insert("r"+g+"_g"+v,{name:y.bigg_id,data:{type:"reaction",reaction_id:g}}),f.search_index.insert("r"+g+"_g_name"+v,{name:y.name,data:{type:"reaction",reaction_id:g}})}}var b=[];for(var x in m.segments){var w=m.segments[x];if(w.reversibility=m.reversibility,w.from_node_id in f.nodes&&w.to_node_id in f.nodes){var S=f.nodes[w.from_node_id],A=f.nodes[w.to_node_id];m.metabolites.forEach(function(t){t.bigg_id==S.bigg_id?w.from_node_coefficient=t.coefficient:t.bigg_id==A.bigg_id&&(w.to_node_coefficient=t.coefficient)}),[S,A].forEach(function(t){t.connected_segments.push({segment_id:x,reaction_id:g})});var k=f.nodes[w.from_node_id],C=f.nodes[w.to_node_id];if("metabolite"==k.node_type||"metabolite"==C.node_type){var T=At.c_plus_c(k,At.c_times_scalar(At.c_minus_c(C,k),.5));null===w.b1&&(w.b1=T),null===w.b2&&(w.b2=T)}}else console.warn("Bad node references in segment "+x+". Deleting segment."),b.push(x)}b.forEach(function(t){delete m.segments[t]})}if(s)for(var E in f.text_labels){var M=f.text_labels[E];f.search_index.insert("l"+E,{name:M.text,data:{type:"text_label",text_label_id:E}})}f.beziers=Et.new_beziers_for_reactions(f.reactions),f.largest_ids.reactions=l(f.reactions),f.largest_ids.nodes=l(f.nodes),f.largest_ids.text_labels=l(f.text_labels);var L=0;for(var R in f.reactions)L=l(f.reactions[R].segments,L);return f.largest_ids.segments=L,f.apply_reaction_data_to_map(null),f.apply_metabolite_data_to_map(null),f.apply_gene_data_to_map(null),f}function o(t){t.append("g").attr("id","reactions"),t.append("g").attr("id","nodes"),t.append("g").attr("id","beziers"),t.append("g").attr("id","text-labels")}function a(){this.sel.select("#reactions").selectAll(".reaction").remove(),this.sel.select("#nodes").selectAll(".node").remove(),this.sel.select("#beziers").selectAll(".bezier").remove(),this.sel.select("#text-labels").selectAll(".text-label").remove()}function s(t,e){this.callback_manager.run("set_status",null,t),clearTimeout(this._status_timer),this._status_timer=null,void 0!==e&&(this._status_timer=setTimeout(function(){this.callback_manager.run("set_status",null,"")}.bind(this),e))}function l(){this.reactions={},this.beziers={},this.nodes={},this.text_labels={},this.map_name="new_map",this.map_id=At.generate_map_id(),this.map_description="",this.apply_reaction_data_to_map(null),this.apply_metabolite_data_to_map(null),this.apply_gene_data_to_map(null),this.draw_everything()}function u(){return null!==this.cobra_model}function c(){this.draw_all_reactions(!0,!0),this.draw_all_nodes(!0),this.draw_all_text_labels()}function h(t,e){It.isUndefined(t)&&(t=!0),It.isUndefined(e)&&(e=!0);var n=[];for(var i in this.reactions)n.push(i);this.draw_these_reactions(n,!1),t&&this.beziers_enabled&&this.draw_all_beziers(),e&&this.clear_deleted_reactions(t)}function d(t,e){It.isUndefined(e)&&(e=!0);var n=At.object_slice_for_ids_ref(this.reactions,t),i=function(t){return this.draw.update_reaction(t,this.scale,this.cobra_model,this.nodes,this.defs,this.has_data_on_reactions)}.bind(this);if(At.draw_an_object(this.sel,"#reactions",".reaction",n,"reaction_id",this.draw.create_reaction.bind(this.draw),i),e){var r=Et.bezier_ids_for_reaction_ids(n);this.draw_these_beziers(r)}}function f(t){function e(t){At.draw_a_nested_object(t,".segment-group","segments","segment_id",null,null,function(t){t.remove()})}It.isUndefined(t)&&(t=!0),At.draw_an_object(this.sel,"#reactions",".reaction",this.reactions,"reaction_id",null,e,function(t){t.remove()}),1==t&&this.clear_deleted_beziers()}function p(t){void 0===t&&(t=!0);var e=[];for(var n in this.nodes)e.push(n);this.draw_these_nodes(e),t&&this.clear_deleted_nodes()}function _(t){var e=At.object_slice_for_ids_ref(this.nodes,t),n=function(t){return this.draw.create_node(t,this.nodes,this.reactions)}.bind(this),i=function(t){return this.draw.update_node(t,this.scale,this.has_data_on_nodes,this.behavior.selectable_mousedown,this.behavior.selectable_click,this.behavior.node_mouseover,this.behavior.node_mouseout,this.behavior.selectable_drag,this.behavior.node_label_drag)}.bind(this);At.draw_an_object(this.sel,"#nodes",".node",e,"node_id",n,i)}function g(){At.draw_an_object(this.sel,"#nodes",".node",this.nodes,"node_id",null,null,function(t){t.remove()})}function m(){var t=[];for(var e in this.text_labels)t.push(e);this.draw_these_text_labels(t),this.clear_deleted_text_labels()}function v(t){var e=At.object_slice_for_ids_ref(this.text_labels,t),n=function(t){return this.draw.update_text_label(t,this.behavior)}.bind(this);At.draw_an_object(this.sel,"#text-labels",".text-label",e,"text_label_id",this.draw.create_text_label.bind(this.draw),n)}function y(){At.draw_an_object(this.sel,"#text-labels",".text-label",this.text_labels,"text_label_id",null,null,function(t){t.remove()})}function b(){var t=[];for(var e in this.beziers)t.push(e);this.draw_these_beziers(t),this.clear_deleted_beziers()}function x(t){var e=At.object_slice_for_ids_ref(this.beziers,t),n=function(t){return this.draw.update_bezier(t,this.beziers_enabled,this.behavior.bezier_drag,this.behavior.bezier_mouseover,this.behavior.bezier_mouseout,this.nodes,this.reactions)}.bind(this);At.draw_an_object(this.sel,"#beziers",".bezier",e,"bezier_id",this.draw.create_bezier.bind(this.draw),n)}function w(){At.draw_an_object(this.sel,"#beziers",".bezier",this.beziers,"bezier_id",null,null,function(t){t.remove()})}function S(){this.toggle_beziers(!0)}function A(){this.toggle_beziers(!1)}function k(t){It.isUndefined(t)?this.beziers_enabled=!this.beziers_enabled:this.beziers_enabled=t,this.draw_all_beziers(),this.callback_manager.run("toggle_beziers",null,this.beziers_enabled)}function C(t){var e=this.settings.get_option("reaction_styles"),n=this.settings.get_option("reaction_compare_style"),i=Pt.apply_reaction_data_to_reactions(this.reactions,t,e,n);return this.has_data_on_reactions=i,this.calc_data_stats("reaction")}function T(t){var e=this.settings.get_option("metabolite_styles"),n=this.settings.get_option("metabolite_compare_style"),i=Pt.apply_metabolite_data_to_nodes(this.nodes,t,e,n);return this.has_data_on_nodes=i,this.calc_data_stats("metabolite")}function E(t){var e=this.settings.get_option("reaction_styles"),n=this.settings.get_option("reaction_compare_style"),i=this.settings.get_option("identifiers_on_map"),r=this.settings.get_option("and_method_in_gene_reaction_rule"),o=Pt.apply_gene_data_to_reactions(this.reactions,t,e,i,n,r);return this.has_data_on_reactions=o,this.calc_data_stats("reaction")}function M(){return this.data_statistics}function L(t){function e(t){return function(e){return t.apply(null,e);
}}if(-1==["reaction","metabolite"].indexOf(t))throw new Error("Bad type "+t);"data_statistics"in this?t in this.data_statistics||(this.data_statistics[t]={}):(this.data_statistics={},this.data_statistics[t]={});var n=!0,i=[];if("metabolite"==t)for(var r in this.nodes){var o=this.nodes[r];null!==o.data&&i.push(o.data)}else if("reaction"==t)for(var a in this.reactions){var s=this.reactions[a];null!==s.data&&i.push(s.data)}var l=At.quartiles(i),u=[["min",e(Math.min)],["max",e(Math.max)],["mean",At.mean],["Q1",function(){return l[0]}],["median",function(){return l[1]}],["Q3",function(){return l[2]}]];return u.forEach(function(e){var r,o=e[0];if(0==i.length)r=null;else{var a=e[1];r=a(i)}r!=this.data_statistics[t][o]&&(n=!1),this.data_statistics[t][o]=r}.bind(this)),"reaction"==t?this.callback_manager.run("calc_data_stats__reaction",null,!n):this.callback_manager.run("calc_data_stats__metabolite",null,!n),!n}function R(){var t=[];return this.sel.select("#nodes").selectAll(".selected").each(function(e){t.push(e.node_id)}),t}function O(){var t={};return this.sel.select("#nodes").selectAll(".selected").each(function(e){t[e.node_id]=this.nodes[e.node_id]}.bind(this)),t}function P(){var t=[];return this.sel.select("#text-labels").selectAll(".selected").each(function(e){t.push(e.text_label_id)}),t}function D(){var t={};return this.sel.select("#text-labels").selectAll(".selected").each(function(e){t[e.text_label_id]=this.text_labels[e.text_label_id]}.bind(this)),t}function I(){this.sel.selectAll("#nodes,#text-labels").selectAll(".node,.text-label").classed("selected",!0)}function N(){this.sel.selectAll(".selected").classed("selected",!1)}function F(){var t=this.sel.selectAll("#nodes,#text-labels").selectAll(".node,.text-label");t.classed("selected",function(){return!d3.select(this).classed("selected")})}function B(t){this.deselect_text_labels();var e,n,i=this.sel.select("#nodes").selectAll(".node");i.classed("selected",function(i){var r=String(i.node_id)==String(t);return r&&(n=i,e={x:i.x,y:i.y}),r}),this.sel.selectAll(".start-reaction-target").style("visibility","hidden"),this.callback_manager.run("select_metabolite_with_id",null,n,e)}function z(t,e,n){n=It.isUndefined(n)?!1:n;var i,r=this.sel.selectAll("#nodes,#text-labels").selectAll(".node,.text-label");i=-1==d3.select(t).attr("class").indexOf("text-label")?t.parentNode:t,n?d3.select(i).classed("selected",!d3.select(i).classed("selected")):(r.classed("selected",!1),d3.select(i).classed("selected",!0));var o,a,s=this.sel.select("#nodes").selectAll(".selected"),l=0;s.each(function(t){a=t,o={x:t.x,y:t.y},l++}),this.callback_manager.run("select_selectable",null,l,a,o)}function H(){var t=null,e=this.sel.select("#nodes").selectAll(".selected");return e.classed("selected",function(e,n){return 0==n?(t=e,!0):!1}),t}function q(){var t=this.sel.select("#nodes").selectAll(".node");t.classed("selected",!1),this.callback_manager.run("deselect_nodes")}function G(t,e){this.deselect_nodes();var n=this.sel.select("#text-labels").selectAll(".text-label");n.classed("selected",function(t){return e===t});var i,r=this.sel.select("#text-labels").selectAll(".selected");r.each(function(t){i={x:t.x,y:t.y}}),this.callback_manager.run("select_text_label")}function j(){var t=this.sel.select("#text-labels").selectAll(".text-label");t.classed("selected",!1)}function U(){var t=this.get_selected_nodes(),e=this.get_selected_text_labels();(Object.keys(t).length>=1||Object.keys(e).length>=1)&&this.delete_selectable(t,e,!0)}function V(t,e,n){var i=this.segments_and_reactions_for_nodes(t),r=i.segment_objs_w_segments,o=i.reactions,a=At.clone(t),s=At.clone(r),l=At.clone(o),u=At.clone(e),c=function(e,i,r,o){this.delete_node_data(Object.keys(t)),this.delete_segment_data(r),this.delete_reaction_data(Object.keys(i)),this.delete_text_label_data(Object.keys(o));var a=!1,s=!1;this.has_data_on_reactions&&(a=this.calc_data_stats("reaction")),this.has_data_on_nodes&&(s=this.calc_data_stats("metabolite")),n&&(a?this.draw_all_reactions(!0,!0):this.clear_deleted_reactions(),s?this.draw_all_nodes(!0):this.clear_deleted_nodes(),this.clear_deleted_text_labels())}.bind(this);c(t,o,r,e),this.undo_stack.push(function(){this.extend_nodes(a),this.extend_reactions(l);var i=Object.keys(l);for(var c in s){var h=s[c],d=h.segment;this.reactions[h.reaction_id].segments[h.segment_id]=d,[d.from_node_id,d.to_node_id].forEach(function(t){if(!(t in a)){var e=this.nodes[t];e.connected_segments.push({reaction_id:h.reaction_id,segment_id:h.segment_id})}}.bind(this));var f=h.segment_id,p=h.reaction_id,_={};_[f]=h.segment,At.extend(this.beziers,Et.new_beziers_for_segments(_,p)),-1==i.indexOf(h.reaction_id)&&i.push(h.reaction_id)}if(this.has_data_on_reactions){var g=this.calc_data_stats("reaction");g?this.draw_all_reactions(!0,!1):this.draw_these_reactions(i)}else n&&this.draw_these_reactions(i);if(this.has_data_on_nodes){var g=this.calc_data_stats("metabolite");n&&(g?this.draw_all_nodes(!1):this.draw_these_nodes(Object.keys(a)))}else n&&this.draw_these_nodes(Object.keys(a));At.extend(this.text_labels,u),n&&this.draw_these_text_labels(Object.keys(u)),e=At.clone(u),t=At.clone(a),r=At.clone(s),o=At.clone(l)}.bind(this),function(){c(t,o,r,e)}.bind(this))}function W(t){t.forEach(function(t){if(this.enable_search&&"metabolite"==this.nodes[t].node_type){var e=this.search_index.remove("n"+t)&&this.search_index.remove("n_name"+t);e||console.warn("Could not find deleted metabolite in search index")}delete this.nodes[t]}.bind(this))}function X(t){for(var e in t){var n=t[e],i=this.reactions[n.reaction_id];if(!(n.segment_id in i.segments))return;var r=i.segments[n.segment_id];[r.from_node_id,r.to_node_id].forEach(function(t){if(t in this.nodes){var e=this.nodes[t];e.connected_segments=e.connected_segments.filter(function(t){return t.segment_id!=n.segment_id})}}.bind(this)),["b1","b2"].forEach(function(t){var e=Et.bezier_id_for_segment_id(n.segment_id,t);delete this.beziers[e]}.bind(this)),delete i.segments[n.segment_id]}}function K(t){t.forEach(function(t){var e=this.reactions[t];for(var n in e.segments)["b1","b2"].forEach(function(t){var e=Et.bezier_id_for_segment_id(n,t);delete this.beziers[e]}.bind(this));delete this.reactions[t];var i=this.search_index.remove("r"+t)&&this.search_index.remove("r_name"+t);i||console.warn("Could not find deleted reaction "+t+" in search index");for(var r in e.genes){var i=this.search_index.remove("r"+t+"_g"+r)&&this.search_index.remove("r"+t+"_g_name"+r);i||console.warn("Could not find deleted gene "+r+" in search index")}}.bind(this))}function Y(t){t.forEach(function(t){delete this.text_labels[t];var e=this.search_index.remove("l"+t);e||console.warn("Could not find deleted text label in search index")}.bind(this))}function Z(t,e,n){function i(t,e){if(this.extend_nodes(t),this.has_data_on_nodes){var n=this.apply_metabolite_data_to_nodes(t);n?this.draw_all_nodes(!1):this.draw_these_nodes([e])}else this.draw_these_nodes([e])}if(!this.cobra_model)return console.error("No CobraModel. Cannot build new reaction");var r=At.clone(this.cobra_model.reactions[t]);for(var o in r.metabolites){var a=r.metabolites[o],s=this.cobra_model.metabolites[o];if(0>a){var l=String(++this.largest_ids.nodes),u={x:30,y:10},c={connected_segments:[],x:e.x,y:e.y,node_is_primary:!0,label_x:e.x+u.x,label_y:e.y+u.y,name:s.name,bigg_id:o,node_type:"metabolite"},h={};h[l]=c;break}}i.apply(this,[h,l]);var d=At.clone(h),f=this.new_reaction_for_metabolite(t,l,n,!1),p=f.redo,_=f.undo;return this.undo_stack.push(function(){_(),this.delete_node_data(Object.keys(h)),h=At.clone(d),this.clear_deleted_nodes(),this.deselect_nodes()}.bind(this),function(){i.apply(this,[h,l]),p()}.bind(this)),null}function $(t){if(this.enable_search)for(var e in t){var n=t[e];"metabolite"==n.node_type&&(this.search_index.insert("n"+e,{name:n.bigg_id,data:{type:"metabolite",node_id:e}}),this.search_index.insert("n_name"+e,{name:n.name,data:{type:"metabolite",node_id:e}}))}At.extend(this.nodes,t)}function J(t){if(this.enable_search)for(var e in t){var n=t[e];this.search_index.insert("r"+e,{name:n.bigg_id,data:{type:"reaction",reaction_id:e}}),this.search_index.insert("r_name"+e,{name:n.name,data:{type:"reaction",reaction_id:e}});for(var i in n.genes){var r=n.genes[i];this.search_index.insert("r"+e+"_g"+i,{name:r.bigg_id,data:{type:"reaction",reaction_id:e}}),this.search_index.insert("r"+e+"_g_name"+i,{name:r.name,data:{type:"reaction",reaction_id:e}})}}At.extend(this.reactions,t)}function Q(t,e,n,i){function r(t,e,n,i){if(this.extend_reactions(e),At.extend(this.beziers,n),this.delete_node_data([i]),this.extend_nodes(t),this.has_data_on_reactions){var r=this.calc_data_stats("reaction");r?this.draw_all_reactions(!0,!1):this.draw_these_reactions(Object.keys(e))}else this.draw_these_reactions(Object.keys(e));if(this.has_data_on_nodes){var r=this.calc_data_stats("metabolite");r?this.draw_all_nodes(!1):this.draw_these_nodes(Object.keys(t))}else this.draw_these_nodes(Object.keys(t));for(var o in t){var a=t[o];if(a.node_is_primary&&o!=i){this.select_metabolite_with_id(o);var s={x:a.x,y:a.y};this.zoom_container&&this.zoom_container.translate_off_screen(s)}}}void 0===i&&(i=!0);var o=this.nodes[e],a=this.cobra_model.reactions[t],s=Et.new_reaction(t,a,this.cobra_model.metabolites,e,At.clone(o),this.largest_ids,this.settings.get_option("cofactors"),n),l=s.new_nodes,u=s.new_reactions,c=s.new_beziers;r.apply(this,[l,u,c,e]);var h=At.clone(l),d=At.clone(u),f=At.clone(c),p=function(){if(delete l[e],this.delete_node_data(Object.keys(l)),this.delete_reaction_data(Object.keys(u)),B.apply(this,[e]),l=At.clone(h),u=At.clone(d),c=At.clone(f),this.has_data_on_reactions){var t=this.calc_data_stats("reaction");t?this.draw_all_reactions(!0,!0):this.draw_these_reactions(Object.keys(u))}else this.clear_deleted_reactions(!0);if(this.has_data_on_nodes){var t=this.calc_data_stats("metabolite");t?this.draw_all_nodes(!0):this.draw_these_nodes(Object.keys(l))}else this.clear_deleted_nodes()}.bind(this),_=function(){r.apply(this,[l,u,c,e])}.bind(this);return i&&this.undo_stack.push(p,_),{undo:p,redo:_}}function tt(){var t,e=this.get_selected_nodes(),n=Object.keys(e)[0],i=(e[n],this.reactions),r=this.nodes,o=[];if(r[n].connected_segments.forEach(function(e){t=[e.reaction_id];var r;try{if(r=i[e.reaction_id].segments[e.segment_id],void 0===r)throw new Error("undefined segment")}catch(a){return void console.warn("Could not find connected segment "+e.segment_id)}o.push(r.from_node_id==n?r.to_node_id:r.from_node_id)}),1!=o.length)return void console.error("Only connected nodes with a single reaction can be selected");var a=o[0],s=[n];r[a].connected_segments.forEach(function(t){var e;try{if(e=i[t.reaction_id].segments[t.segment_id],void 0===e)throw new Error("undefined segment")}catch(o){return void console.warn("Could not find connected segment "+t.segment_id)}var l=e.from_node_id==a?e.to_node_id:e.from_node_id,u=r[l];"metabolite"==u.node_type&&l!=n&&s.push(String(l))});for(var l=0;l<s.length;l++)if(r[s[l]].connected_segments.length>1)return void console.error("Only connected nodes with a single reaction can be selected");for(var u in e)if(u!=n&&-1==s.indexOf(u))return void console.warn("Selected nodes are not on the same reaction");var c=[],h=s.length-1,d=r[s[h]],f=d.node_is_primary,p={x:d.x,y:d.y,label_x:d.label_x,label_y:d.label_y};d.connected_segments.length>1&&console.warn("Too many connected segments for node "+d.node_id);var _,g=d.connected_segments[0];try{if(_=i[g.reaction_id].segments[g.segment_id],void 0===_)throw new Error("undefined segment")}catch(m){return void console.error("Could not find connected segment "+g.segment_id)}var v,y={b1:_.b1,b2:_.b2};s.forEach(function(t){var e=r[t],n=e.node_is_primary,o={x:e.x,y:e.y,label_x:e.label_x,label_y:e.label_y},a=e.connected_segments[0],s=i[a.reaction_id].segments[a.segment_id],l={b1:s.b1,b2:s.b2};e.node_is_primary=f,e.x=p.x,e.y=p.y,e.label_x=p.label_x,e.label_y=p.label_y,s.b1=y.b1,s.b2=y.b2,f=n,p=o,y=l,e.node_is_primary&&(v=t),c.push(t)});var b=r[a].connected_segments,h=b.length-1,x=[b[h]];b.forEach(function(t,e){h!=e&&x.push(t)}),r[a].connected_segments=x,this.draw_these_nodes(c),this.draw_these_reactions(t),this.select_metabolite_with_id(v)}function et(){var t=this.get_selected_node_ids(),e=function(t){var e={},n=this.settings.get_option("hide_secondary_metabolites");if(t.forEach(function(t){if(!(t in this.nodes))return void console.warn("Could not find node: "+t);var n=this.nodes[t];"metabolite"==n.node_type&&(n.node_is_primary=!n.node_is_primary,e[t]=n)}.bind(this)),this.draw_these_nodes(Object.keys(e)),n){var i=this.segments_and_reactions_for_nodes(e),r={};for(var o in i.segment_objs_w_segments){var a=i.segment_objs_w_segments[o].reaction_id;r[a]=!0}this.draw_these_reactions(Object.keys(r))}}.bind(this);e(t),this.undo_stack.push(function(){e(t)},function(){e(t)})}function nt(t){var e={},n={},i={},r=this.reactions;for(var o in t){var a=t[o];a.connected_segments.forEach(function(t){var n;try{if(n=r[t.reaction_id].segments[t.segment_id],void 0===n)throw new Error("undefined segment")}catch(o){return void console.warn("Could not find connected segments for node")}var a=At.clone(t);a.segment=At.clone(n),e[t.segment_id]=a,t.reaction_id in i||(i[t.reaction_id]=[]),i[t.reaction_id].push(t.segment_id)})}for(var s in i){var l=r[s],u=i[s],c=!0;for(var h in l.segments)-1==u.indexOf(h)&&(c=!1);c&&(n[s]=l)}return{segment_objs_w_segments:e,reactions:n}}function it(t,e){var n=Et.new_text_label(this.largest_ids,e,t);this.text_labels[n.id]=n.label;this.draw_these_text_labels([n.id]);return this.search_index.insert("l"+n.id,{name:e,data:{type:"text_label",text_label_id:n.id}}),n.id}function rt(t,e,n){var i=this.text_labels[t].text,r=function(e,n){this.text_labels[t].text=e,n&&this.draw_these_text_labels([t]);var i="l"+t,r=this.search_index.remove(i);r||console.warn("Could not find modified text label in search index"),this.search_index.insert(i,{name:e,data:{type:"text_label",text_label_id:t}})}.bind(this);r(e,n),this.undo_stack.push(function(){r(i,n)},function(){r(e,n)})}function ot(t){this._zoom_extent(t,"nodes")}function at(t){this._zoom_extent(t,"canvas")}function st(t,e){It.isUndefined(t)&&(t="nodes"==e?.2:0),It.isUndefined(e)&&(e="canvas");var n,i,r=this.get_size();if(t*=r.height,"nodes"==e){var o={x:null,y:null},a={x:null,y:null};for(var s in this.nodes){var l=this.nodes[s];null===o.x&&(o.x=l.x),null===o.y&&(o.y=l.y),null===a.x&&(a.x=l.x),null===a.y&&(a.y=l.y),o.x=Math.min(o.x,l.x),o.y=Math.min(o.y,l.y),a.x=Math.max(a.x,l.x),a.y=Math.max(a.y,l.y)}n=Math.min((r.width-2*t)/(a.x-o.x),(r.height-2*t)/(a.y-o.y)),i={x:-(o.x*n)+t+(r.width-2*t-(a.x-o.x)*n)/2,y:-(o.y*n)+t+(r.height-2*t-(a.y-o.y)*n)/2}}else{if("canvas"!=e)return console.error("Did not recognize mode");n=Math.min((r.width-2*t)/this.canvas.width,(r.height-2*t)/this.canvas.height),i={x:-(this.canvas.x*n)+t+(r.width-2*t-this.canvas.width*n)/2,y:-(this.canvas.y*n)+t+(r.height-2*t-this.canvas.height*n)/2}}return this.zoom_container.go_to(n,i),null}function lt(){return this.zoom_container.get_size()}function ut(t){var e=this.reactions[t],n=.5,i=this.get_size(),r={x:-e.label_x*n+i.width/2,y:-e.label_y*n+i.height/2};this.zoom_container.go_to(n,r)}function ct(t){var e=this.nodes[t],n=.5,i=this.get_size(),r={x:-e.label_x*n+i.width/2,y:-e.label_y*n+i.height/2};this.zoom_container.go_to(n,r)}function ht(t){var e=this.text_labels[t],n=.5,i=this.get_size(),r={x:-e.x*n+i.width/2,y:-e.y*n+i.height/2};this.zoom_container.go_to(n,r)}function dt(t){this.highlight(this.sel.selectAll("#r"+t).selectAll("text"))}function ft(t){this.highlight(this.sel.selectAll("#n"+t).selectAll("text"))}function pt(t){this.highlight(this.sel.selectAll("#l"+t).selectAll("text"))}function _t(t){this.sel.selectAll(".highlight").classed("highlight",!1),null!==t&&t.classed("highlight",!0)}function gt(){return document.fullscreenEnabled?"fullscreenchange":document.mozFullScreenEnabled?"mozfullscreenchange":document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":null}function mt(t){document.addEventListener(gt(),t),this.full_screen_listener=t}function vt(){document.removeEventListener(gt(),this.full_screen_listener)}function yt(){var t=this.zoom_container.selection,e=t.node(),n=document,i=n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement;if(i)if(t.classed("full-screen-on",!1),n.exitFullscreen)n.exitFullscreen();else if(n.mozCancelFullScreen)n.mozCancelFullScreen();else if(n.webkitExitFullscreen)n.webkitExitFullscreen();else{if(!n.msExitFullscreen)throw Error("Cannot exit full screen");n.msExitFullscreen()}else if(t.classed("full-screen-on",!0),e.requestFullscreen)e.requestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);else{if(!e.msRequestFullscreen)throw Error("Full screen does not seem to be supported on this system.");e.msRequestFullscreen()}}function bt(){At.download_json(this.map_for_export(),this.map_name)}function xt(){var t=[{map_name:this.map_name,map_id:this.map_id,map_description:this.map_description,homepage:"https://escher.github.io",schema:"https://escher.github.io/escher/jsonschema/1-0-0#"},{reactions:At.clone(this.reactions),nodes:At.clone(this.nodes),text_labels:At.clone(this.text_labels),canvas:this.canvas.size_and_location()}];for(var e in t[1].reactions){var n=t[1].reactions[e],i={};["name","bigg_id","reversibility","label_x","label_y","gene_reaction_rule","genes","metabolites"].forEach(function(t){i[t]=n[t]}),i.segments={};for(var r in n.segments){var o=n.segments[r],a={};["from_node_id","to_node_id","b1","b2"].forEach(function(t){a[t]=o[t]}),i.segments[r]=a}t[1].reactions[e]=i}for(var s in t[1].nodes){var l,u=t[1].nodes[s],c={};l="metabolite"==u.node_type?["node_type","x","y","bigg_id","name","label_x","label_y","node_is_primary"]:["node_type","x","y"],l.forEach(function(t){c[t]=u[t]}),t[1].nodes[s]=c}for(var h in t[1].text_labels){var d=t[1].text_labels[h],f={},l=["x","y","text"];l.forEach(function(t){f[t]=d[t]}),t[1].text_labels[h]=f}var p=t[1].canvas,_={},l=["x","y","width","height"];return l.forEach(function(t){_[t]=p[t]}),t[1].canvas=_,t}function wt(){this.callback_manager.run("before_svg_export");var t=this.zoom_container.window_scale,e=this.zoom_container.window_translate,n=this.canvas.size_and_location(),i={w:this.canvas.mouse_node.attr("width"),h:this.canvas.mouse_node.attr("height"),transform:this.canvas.mouse_node.attr("transform")};this.zoom_container._go_to_svg(1,{x:-n.x,y:-n.y},function(){this.svg.attr("width",n.width),this.svg.attr("height",n.height),this.canvas.mouse_node.attr("width","0px"),this.canvas.mouse_node.attr("height","0px"),this.canvas.mouse_node.attr("transform",null);var r=this.sel.selectAll(".multimarker-circle,.midmarker-circle,#canvas").style("visibility","hidden");At.download_svg("saved_map",this.svg,!0),this.zoom_container._go_to_svg(t,e,function(){this.svg.attr("width",null),this.svg.attr("height",null),this.canvas.mouse_node.attr("width",i.w),this.canvas.mouse_node.attr("height",i.h),this.canvas.mouse_node.attr("transform",i.transform),r.style("visibility",null),this.callback_manager.run("after_svg_export")}.bind(this))}.bind(this))}function St(){if(this.callback_manager.run("before_convert_map"),!this.has_cobra_model())throw Error("No COBRA model loaded.");var t,e=this.cobra_model,n={},i=["name","gene_reaction_rule","genes"],r={},o=["name"];for(var a in this.reactions){var s=this.reactions[a];t=!1;for(var l in e.reactions){var u=e.reactions[l];u.bigg_id==s.bigg_id&&(i.forEach(function(t){s[t]=u[t]}),t=!0)}t||(n[a]=!0)}for(var c in this.nodes){var h=this.nodes[c];if("metabolite"==h.node_type){t=!1;for(var d in e.metabolites){var f=e.metabolites[d];f.bigg_id==h.bigg_id&&(o.forEach(function(t){h[t]=f[t]}),t=!0)}t||(r[c]=!0)}}var p=Object.keys(n).length,_=Object.keys(r).length,g=3e3;0==p&&0==_?this.set_status("Successfully converted attributes.",g):0==_?(this.set_status("Converted attributes, but count not find "+p+" reactions in the model.",g),this.settings.set_conditional("highlight_missing",!0)):0==p?(this.set_status("Converted attributes, but count not find "+_+" metabolites in the model.",g),this.settings.set_conditional("highlight_missing",!0)):(this.set_status("Converted attributes, but count not find "+p+" reactions and "+_+" metabolites in the model.",g),this.settings.set_conditional("highlight_missing",!0)),this.draw_everything(),this.callback_manager.run("after_convert_map")}var At=n(195),kt=n(210),Ct=n(211),Tt=n(213),Et=n(212),Mt=n(214),Lt=n(208),Rt=n(215),Ot=n(217),Pt=n(206),Dt=n(218),It=(n(219),n(197)),Nt=At.make_class();Nt.from_data=r,Nt.prototype={init:i,setup_containers:o,reset_containers:a,set_status:s,clear_map:l,select_all:I,select_none:N,invert_selection:F,select_selectable:z,select_metabolite_with_id:B,select_single_node:H,deselect_nodes:q,select_text_label:G,deselect_text_labels:j,new_reaction_from_scratch:Z,extend_nodes:$,extend_reactions:J,new_reaction_for_metabolite:Q,cycle_primary_node:tt,toggle_selected_node_primary:et,new_text_label:it,edit_text_label:rt,delete_selected:U,delete_selectable:V,delete_node_data:W,delete_segment_data:X,delete_reaction_data:K,delete_text_label_data:Y,get_selected_node_ids:R,get_selected_nodes:O,get_selected_text_label_ids:P,get_selected_text_labels:D,segments_and_reactions_for_nodes:nt,draw_everything:c,draw_all_reactions:h,draw_these_reactions:d,clear_deleted_reactions:f,draw_all_nodes:p,draw_these_nodes:_,clear_deleted_nodes:g,draw_all_text_labels:m,draw_these_text_labels:v,clear_deleted_text_labels:y,draw_all_beziers:b,draw_these_beziers:x,clear_deleted_beziers:w,toggle_beziers:k,hide_beziers:A,show_beziers:S,has_cobra_model:u,apply_reaction_data_to_map:C,apply_metabolite_data_to_map:T,apply_gene_data_to_map:E,get_data_statistics:M,calc_data_stats:L,zoom_extent_nodes:ot,zoom_extent_canvas:at,_zoom_extent:st,get_size:lt,zoom_to_reaction:ut,zoom_to_node:ct,zoom_to_text_label:ht,highlight_reaction:dt,highlight_node:ft,highlight_text_label:pt,highlight:_t,listen_for_full_screen:mt,unlisten_for_full_screen:vt,full_screen:yt,save:bt,map_for_export:xt,save_svg:wt,convert_map:St},t.exports=Nt},function(t,e,n){function i(t,e){this.behavior=t,this.settings=e,this.callback_manager=new x}function r(t){t.append("rect").attr("class","membrane"),this.callback_manager.run("create_membrane",this,t)}function o(t){t.attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).style("stroke-width",function(t){return 10}).attr("rx",function(t){return 20}).attr("ry",function(t){return 20}),this.callback_manager.run("update_membrane",this,t)}function a(t){t.append("g").attr("id",function(t){return"r"+t.reaction_id}).attr("class","reaction").call(this.create_reaction_label.bind(this)),this.callback_manager.run("create_reaction",this,t)}function s(t,e,n,i,r,o){t.select(".reaction-label-group").call(function(t){return this.update_reaction_label(t,o)}.bind(this)),y.draw_a_nested_object(t,".segment-group","segments","segment_id",this.create_segment.bind(this),function(t){return this.update_segment(t,e,n,i,r,o)}.bind(this),function(t){t.remove()}),this.callback_manager.run("update_reaction",this,t)}function l(t){var e=t.append("g").attr("class","reaction-label-group");e.append("title"),e.append("text").attr("class","reaction-label label"),e.append("g").attr("class","all-genes-label-group"),this.callback_manager.run("create_reaction_label",this,t)}function u(t,e){var n=(d3.format(".4g"),this.settings.get_option("identifiers_on_map")),i="bigg_id"==n?"name":"bigg_id",r=this.settings.get_option("reaction_styles"),o=this.settings.get_option("show_gene_reaction_rules"),a=this.settings.get_option("hide_all_labels"),s=this.settings.get_option("gene_font_size"),l=this.behavior.label_mousedown,u=this.behavior.label_mouseover,c=this.behavior.label_mouseout;t.attr("transform",function(t){return"translate("+t.label_x+","+t.label_y+")"}).call(this.behavior.turn_off_drag).call(this.behavior.reaction_label_drag);var h=t.select(".reaction-label").attr("visibility",a?"hidden":"visible");a||(h.text(function(t){var i=t[n];return e&&-1!=r.indexOf("text")&&(i+=" "+t.data_string),i}).on("mousedown",l).on("mouseover",u).on("mouseout",c),t.select("title").text(function(t){return t[i]}));var d=t.select(".all-genes-label-group").selectAll(".gene-label-group").data(function(t){var e="gene_string"in t&&null!==t.gene_string&&o&&!a&&-1!==r.indexOf("text"),i="gene_reaction_rule"in t&&null!==t.gene_reaction_rule&&o&&!a;return e?t.gene_string:i?b.gene_string_for_data(t.gene_reaction_rule,null,t.genes,null,n,null):[]}),f=d.enter().append("g").attr("class","gene-label-group");f.append("text").attr("class","gene-label").style("font-size",s+"px"),f.append("title"),d.attr("transform",function(t,e){return"translate(0, "+1.5*s*(e+1)+")"}),d.select("text").text(function(t){return t.text}),d.select("title").text(function(t){return t[i]}),d.exit().remove(),this.callback_manager.run("update_reaction_label",this,t)}function c(t){var e=t.append("g").attr("class","segment-group").attr("id",function(t){return"s"+t.segment_id});e.append("path").attr("class","segment"),e.append("g").attr("class","arrowheads"),e.append("g").attr("class","stoichiometry-labels"),this.callback_manager.run("create_segment",this,t)}function h(t,e,n,i,r,o){var a=this.settings.get_option("reaction_styles"),s=o&&-1!=a.indexOf("size"),l=o&&-1!=a.indexOf("color"),u=this.settings.get_option("reaction_no_data_size"),c=this.settings.get_option("reaction_no_data_color"),h=this.settings.get_option("highlight_missing"),d=this.settings.get_option("hide_secondary_metabolites"),f=this.settings.get_option("primary_metabolite_radius"),p=this.settings.get_option("secondary_metabolite_radius"),_=function(t,n){var i=20,r=13;return n&&(r=null===t?u:e.reaction_size(t),isNaN(r)&&(r=u),i=2*r),{width:i,height:r}},g=function(t,e,n,i){var r=e||n>0?t.height:0,o=i?f:p;return o+r+10};t.selectAll(".segment").datum(function(){return this.parentNode.__data__}).style("visibility",function(t){var e=i[t.from_node_id],n=i[t.to_node_id];return d&&("metabolite"==n.node_type&&!n.node_is_primary||"metabolite"==e.node_type&&!e.node_is_primary)?"hidden":null}).attr("d",function(t){if(null===t.from_node_id||null===t.to_node_id)return null;var e=i[t.from_node_id],n=i[t.to_node_id],r=t.b1,o=t.b2;if("metabolite"==e.node_type){var a=_(t.data,s),l=g(a,t.reversibility,t.from_node_coefficient,e.node_is_primary),u=null===r?n:r;e=v(l,e,u,"start")}if("metabolite"==n.node_type){var a=_(t.data,s),l=g(a,t.reversibility,t.to_node_coefficient,n.node_is_primary),u=null===o?e:o;n=v(l,u,n,"end")}var c="M"+e.x+","+e.y+" ";return null!==r&&null!==o&&(c+="C"+r.x+","+r.y+" "+o.x+","+o.y+" "),c+=n.x+","+n.y}).style("stroke",function(t){var i=this.parentNode.parentNode.__data__.bigg_id,r=h&&null!==n&&!(i in n.reactions);if(r)return"red";if(l){var o=t.data;return null===o?c:e.reaction_color(o)}return null}).style("stroke-width",function(t){if(s){var n=t.data;return null===n?u:e.reaction_size(n)}return null});var m=t.select(".arrowheads").selectAll(".arrowhead").data(function(t){var e=[],n=i[t.from_node_id],r=t.b1,o=i[t.to_node_id],a=t.b2;if(d&&("metabolite"==o.node_type&&!o.node_is_primary||"metabolite"==n.node_type&&!n.node_is_primary))return e;if("metabolite"==n.node_type&&(t.reversibility||t.from_node_coefficient>0)){var l=_(t.data,s),u=g(l,t.reversibility,t.from_node_coefficient,n.node_is_primary),c=null===r?o:r,h=y.to_degrees(y.get_angle([n,c]))+90,f=v(u,n,c,"start");e.push({data:t.data,x:f.x,y:f.y,size:l,rotation:h,show_arrowhead_flux:t.from_node_coefficient<0==t.reverse_flux||0==t.data})}if("metabolite"==o.node_type&&(t.reversibility||t.to_node_coefficient>0)){var l=_(t.data,s),u=g(l,t.reversibility,t.to_node_coefficient,o.node_is_primary),c=null===a?n:a,h=y.to_degrees(y.get_angle([o,c]))+90,f=v(u,c,o,"end");e.push({data:t.data,x:f.x,y:f.y,size:l,rotation:h,show_arrowhead_flux:t.to_node_coefficient<0==t.reverse_flux||0==t.data})}return e});m.enter().append("path").classed("arrowhead",!0),m.attr("d",function(t){return"M"+[-t.size.width/2,0]+" L"+[0,t.size.height]+" L"+[t.size.width/2,0]+" Z"}).attr("transform",function(t){return"translate("+t.x+","+t.y+")rotate("+t.rotation+")"}).style("fill",function(t){if(l){if(t.show_arrowhead_flux){var n=t.data;return null===n?c:e.reaction_color(n)}return"#FFFFFF"}return null}).style("stroke",function(t){if(l){var n=t.data;return null===n?c:e.reaction_color(n)}return null}),m.exit().remove();var b=t.select(".stoichiometry-labels").selectAll(".stoichiometry-label").data(function(t){var e=[],n=i[t.from_node_id],r=t.b1,o=i[t.to_node_id],a=t.b2,l=1.5;if(d&&("metabolite"==o.node_type&&!o.node_is_primary||"metabolite"==n.node_type&&!n.node_is_primary))return e;if("metabolite"==n.node_type&&1!=Math.abs(t.from_node_coefficient)){var u=_(t.data,s),c=l*g(u,!1,0,o.node_is_primary),h=null===r?o:r;h=y.c_plus_c(h,y.rotate_coords(h,.5,n));var f=v(c,n,h,"start");f=y.c_plus_c(f,{x:0,y:7}),e.push({coefficient:Math.abs(t.from_node_coefficient),x:f.x,y:f.y,data:t.data})}if("metabolite"==o.node_type&&1!=Math.abs(t.to_node_coefficient)){var u=_(t.data,s),c=l*g(u,!1,0,o.node_is_primary),h=null===a?n:a;h=y.c_plus_c(h,y.rotate_coords(h,.5,o));var f=v(c,h,o,"end");f=y.c_plus_c(f,{x:0,y:7}),e.push({coefficient:Math.abs(t.to_node_coefficient),x:f.x,y:f.y,data:t.data})}return e});b.enter().append("text").attr("class","stoichiometry-label").attr("text-anchor","middle"),b.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).text(function(t){return t.coefficient}).style("fill",function(t){if(l){var n=t.data;return null===n?c:e.reaction_color(n)}return null}),b.exit().remove(),this.callback_manager.run("update_segment",this,t)}function d(t){var e=t.append("g").attr("id",function(t){return t.bezier_id}).attr("class",function(t){return"bezier"});e.append("path").attr("class","connect-line"),e.append("circle").attr("class",function(t){return"bezier-circle "+t.bezier}).style("stroke-width",String(1)+"px").attr("r",String(7)+"px"),this.callback_manager.run("create_bezier",this,t)}function f(t,e,n,i,r,o,a){var s=this.settings.get_option("hide_secondary_metabolites");return e?(t.attr("visibility","visible"),t.style("visibility",function(t){var e=a[t.reaction_id].segments[t.segment_id],n=o[e.from_node_id],i=o[e.to_node_id];return s&&("metabolite"==i.node_type&&!i.node_is_primary||"metabolite"==n.node_type&&!n.node_is_primary)?"hidden":null}),t.select(".bezier-circle").call(this.behavior.turn_off_drag).call(n).on("mouseover",i).on("mouseout",r).attr("transform",function(t){return null==t.x||null==t.y?"":"translate("+t.x+","+t.y+")"}),t.select(".connect-line").attr("d",function(t){var e,n=a[t.reaction_id].segments[t.segment_id];return e="b1"==t.bezier?o[n.from_node_id]:o[n.to_node_id],null==t.x||null==t.y||null==e.x||null==e.y?"":"M"+t.x+", "+t.y+" "+e.x+","+e.y}),void this.callback_manager.run("update_bezier",this,t)):void t.attr("visibility","hidden")}function p(t,e,n){var i=t.append("g").attr("class","node").attr("id",function(t){return"n"+t.node_id});i.append("circle").attr("class",function(t){var e="node-circle";return null!==t.node_type&&(e+=" "+t.node_type+"-circle"),e});var r=i.filter(function(t){return"metabolite"==t.node_type});r.append("text").attr("class","node-label label"),r.append("title"),this.callback_manager.run("create_node",this,t)}function _(t,e,n,i,r,o,a,s,l){var u=this.settings.get_option("hide_secondary_metabolites"),c=this.settings.get_option("primary_metabolite_radius"),h=this.settings.get_option("secondary_metabolite_radius"),d=this.settings.get_option("marker_radius"),f=this.settings.get_option("hide_all_labels"),p=this.settings.get_option("identifiers_on_map"),_="bigg_id"==p?"name":"bigg_id",g=this.settings.get_option("metabolite_styles"),m={color:this.settings.get_option("metabolite_no_data_color"),
size:this.settings.get_option("metabolite_no_data_size")},v=(t.select(".node-circle").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).style("visibility",function(t){return u&&!t.node_is_primary?"hidden":null}).attr("r",function(t){if("metabolite"==t.node_type){var i=n&&-1!=g.indexOf("size");if(i){var r=t.data;return null===r?m.size:e.metabolite_size(r)}return t.node_is_primary?c:h}return d}).style("fill",function(t){if("metabolite"==t.node_type){var i=n&&-1!=g.indexOf("color");if(i){var r=t.data;return null===r?m.color:e.metabolite_color(r)}return null}return null}).call(this.behavior.turn_off_drag).call(s).on("mousedown",i).on("click",r).on("mouseover",o).on("mouseout",a),t.select(".node-label").attr("visibility",f?"hidden":"visible"));f||(v.style("visibility",function(t){return u&&!t.node_is_primary?"hidden":null}).attr("transform",function(t){return"translate("+t.label_x+","+t.label_y+")"}).text(function(t){var e=t[p];return n&&-1!=g.indexOf("text")&&(e+=" "+t.data_string),e}).call(this.behavior.turn_off_drag).call(l),t.select("title").text(function(t){return t[_]})),this.callback_manager.run("update_node",this,t)}function g(t){t.append("g").attr("id",function(t){return"l"+t.text_label_id}).attr("class","text-label").append("text").attr("class","label"),this.callback_manager.run("create_text_label",this,t)}function m(t){var e=this.behavior.text_label_mousedown,n=this.behavior.text_label_click,i=this.behavior.selectable_drag,r=this.behavior.turn_off_drag;t.select(".label").text(function(t){return t.text}).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).on("mousedown",e).on("click",n).call(r).call(i),this.callback_manager.run("update_text_label",this,t)}function v(t,e,n,i){y.check_undefined(arguments,["reaction_arrow_displacement","start","end","displace"]);var r,o,a=t,s=y.distance(e,n);return a&&s||console.error("Bad value"),"start"==i?(r=e.x+a*(n.x-e.x)/s,o=e.y+a*(n.y-e.y)/s):"end"==i?(r=n.x-a*(n.x-e.x)/s,o=n.y-a*(n.y-e.y)/s):console.error("bad displace value: "+i),{x:r,y:o}}var y=n(195),b=n(206),x=n(208),w=y.make_class();w.prototype={init:i,create_reaction:a,update_reaction:s,create_bezier:d,update_bezier:f,create_node:p,update_node:_,create_text_label:g,update_text_label:m,create_membrane:r,update_membrane:o,create_reaction_label:l,update_reaction_label:u,create_segment:c,update_segment:h},t.exports=w},function(t,e,n){function i(t,e){this.map=t,this.undo_stack=e,this.empty_behavior=function(){},this.rotation_mode_enabled=!1,this.rotation_drag=d3.behavior.drag(),this.selectable_mousedown=null,this.text_label_mousedown=null,this.text_label_click=null,this.selectable_drag=this.empty_behavior,this.node_mouseover=null,this.node_mouseout=null,this.label_mousedown=null,this.label_mouseover=null,this.label_mouseout=null,this.bezier_drag=this.empty_behavior,this.bezier_mouseover=null,this.bezier_mouseout=null,this.reaction_label_drag=this.empty_behavior,this.node_label_drag=this.empty_behavior,this.turn_everything_on()}function r(){this.toggle_selectable_click(!0),this.toggle_selectable_drag(!0),this.toggle_label_drag(!0),this.toggle_label_mousedown(!0)}function o(){this.toggle_selectable_click(!1),this.toggle_selectable_drag(!1),this.toggle_label_drag(!1),this.toggle_label_mousedown(!1)}function a(t){function e(){var t=this.map.sel.selectAll("#rotation-center").data([0]),e=t.enter().append("g").attr("id","rotation-center");e.append("path").attr("d","M-32 0 L32 0").attr("class","rotation-center-line"),e.append("path").attr("d","M0 -32 L0 32").attr("class","rotation-center-line"),t.attr("transform","translate("+this.center.x+","+this.center.y+")").attr("visibility","visible"),t.call(d3.behavior.drag().on("drag",function(t){var e=b.d3_transform_catch(t.attr("transform")),n=[d3.event.dx+e.translate[0],d3.event.dy+e.translate[1]];t.attr("transform","translate("+n+")"),this.center={x:n[0],y:n[1]}}.bind(this,t))),t.on("mouseover",function(){var t=parseFloat(this.selectAll("path").style("stroke-width"));this.selectAll("path").style("stroke-width",2*t+"px")}.bind(t)),t.on("mouseout",function(){this.selectAll("path").style("stroke-width",null)}.bind(t))}function n(t){this.map.sel.select("#rotation-center").attr("visibility","hidden")}function i(t){var e=[],n=[];for(var i in t){var r=t[i];void 0!==r.x&&e.push(r.x),void 0!==r.y&&n.push(r.y)}return{x:b.mean(e),y:b.mean(n)}}void 0===t?this.rotation_mode_enabled=!this.rotation_mode_enabled:this.rotation_mode_enabled=t;var r=this.map.sel.selectAll(".node-circle"),o=this.map.sel.selectAll("#canvas");if(this.rotation_mode_enabled){this.map.callback_manager.run("start_rotation");var a=this.map.get_selected_nodes();if(0==Object.keys(a).length)return void console.warn("No selected nodes");this.center=i(a),e.call(this);var s=this.map,l=Object.keys(a),u=this.map.reactions,c=this.map.nodes,h=this.map.beziers,d=function(t){d3.event.sourceEvent.stopPropagation()},f=function(t,e,n,i){var r=x.rotate_nodes(a,u,h,e,i);s.draw_these_nodes(r.node_ids),s.draw_these_reactions(r.reaction_ids)},p=function(t){},_=function(t,e,n){var i={};l.forEach(function(t){i[t]=c[t]});var r=x.rotate_nodes(i,u,h,-e,n);s.draw_these_nodes(r.node_ids),s.draw_these_reactions(r.reaction_ids)},g=function(t,e,n){var i={};l.forEach(function(t){i[t]=c[t]});var r=x.rotate_nodes(i,u,h,e,n);s.draw_these_nodes(r.node_ids),s.draw_these_reactions(r.reaction_ids)},m=function(){return this.center}.bind(this);this.rotation_drag=this._get_generic_angular_drag(d,f,p,_,g,m,this.map.sel),o.call(this.rotation_drag),this.selectable_drag=this.rotation_drag}else n.call(this),r.on("mousedown.center",null),o.on("mousedown.center",null),o.on("mousedown.drag",null),o.on("touchstart.drag",null),this.rotation_drag=null,this.selectable_drag=null}function s(t){if(void 0===t&&(t=null===this.selectable_mousedown),t){var e=this.map;this.selectable_mousedown=function(t){d3.event.stopPropagation()},this.selectable_click=function(t){d3.event.stopPropagation(),d3.event.defaultPrevented||e.select_selectable(this,t,d3.event.shiftKey)},this.node_mouseover=function(t){d3.select(this).style("stroke-width",null);var e=parseFloat(d3.select(this).style("stroke-width"));d3.select(this.parentNode).classed("selected")||d3.select(this).style("stroke-width",3*e+"px")},this.node_mouseout=function(t){d3.select(this).style("stroke-width",null)}}else this.selectable_mousedown=null,this.selectable_click=null,this.node_mouseover=null,this.node_mouseout=null,this.map.sel.select("#nodes").selectAll(".node-circle").style("stroke-width",null)}function l(t){if(void 0===t&&(t=null==this.text_edit_mousedown),t){var e=this.map;this.selection;this.text_label_mousedown=function(){if(!d3.event.defaultPrevented){var t=b.d3_transform_catch(d3.select(this).attr("transform")).translate,n={x:t[0],y:t[1]};e.callback_manager.run("edit_text_label",null,d3.select(this),n),d3.event.stopPropagation()}},this.text_label_click=null,this.map.sel.select("#text-labels").selectAll(".label").classed("edit-text-cursor",!0),this.map.sel.on("mousedown.new_text_label",function(t){d3.event.preventDefault();var e={x:d3.mouse(t)[0],y:d3.mouse(t)[1]};this.map.callback_manager.run("new_text_label",null,e)}.bind(this,this.map.sel.node()))}else this.text_label_mousedown=this.selectable_mousedown,this.text_label_click=this.selectable_click,this.map.sel.select("#text-labels").selectAll(".label").classed("edit-text-cursor",!1),this.map.sel.on("mousedown.new_text_label",null),this.map.callback_manager.run("hide_text_label_editor")}function u(t){void 0===t&&(t=this.selectable_drag===this.empty_behavior),t?(this.selectable_drag=this._get_selectable_drag(this.map,this.undo_stack),this.bezier_drag=this._get_bezier_drag(this.map,this.undo_stack)):(this.selectable_drag=this.empty_behavior,this.bezier_drag=this.empty_behavior)}function c(t){void 0===t&&(t=this.label_drag===this.empty_behavior),t?(this.reaction_label_drag=this._get_reaction_label_drag(this.map),this.node_label_drag=this._get_node_label_drag(this.map)):(this.reaction_label_drag=this.empty_behavior,this.node_label_drag=this.empty_behavior)}function h(t){if(void 0===t&&(t=null==this.label_mousedown),t){this.map;this.label_mousedown=function(t){},this.label_mouseover=function(t){},this.label_mouseout=function(t){}}else this.label_mousedown=null,this.label_mouseover=null,this.label_mouseout=null,this.map.sel.select(".node-label,.reaction-label").style("fill",null)}function d(t){void 0===t&&(t=this.bezier_drag===this.empty_behavior),t?(this.bezier_drag=this._get_bezier_drag(this.map),this.bezier_mouseover=function(t){d3.select(this).style("stroke-width",String(3)+"px")},this.bezier_mouseout=function(t){d3.select(this).style("stroke-width",String(1)+"px")}):(this.bezier_drag=this.empty_behavior,this.bezier_mouseover=null,this.bezier_mouseout=null)}function f(t){t.on("mousedown.drag",null),t.on("touchstart.drag",null)}function p(t,e){function n(e,n){var i=t.nodes[n],r=t.nodes[e],o=[];return i.connected_segments.forEach(function(i){var a;try{if(a=t.reactions[i.reaction_id].segments[i.segment_id],void 0===a)throw new Error("undefined segment")}catch(s){return void console.warn("Could not find connected segment "+i.segment_id)}if(a.from_node_id==n)a.from_node_id=e;else{if(a.to_node_id!=n)return void console.error("Segment does not connect to dragged node");a.to_node_id=e}r.connected_segments.push(i),o.push(b.clone(i))}),t.delete_node_data([n]),t.sel.selectAll(".node-to-combine").classed("node-to-combine",!1),t.draw_everything(),o}var i=d3.behavior.drag(),r=null,o=null,a=null,s=null,l=null,u=function(e,n){var i=t.text_labels[e];i.x=i.x+n.x,i.y=i.y+n.y};return i.on("dragstart",function(e){if(d3.event.sourceEvent.stopPropagation(),o={x:0,y:0},-1==d3.select(this).attr("class").indexOf("label")){var n=this.parentNode.__data__,i=n.bigg_id,a=this.parentNode;r=setTimeout(function(){a.parentNode.insertBefore(a,a.parentNode.firstChild)},200),t.sel.selectAll(".metabolite-circle").on("mouseover.combine",function(t){t.bigg_id==i&&t.node_id!=n.node_id&&d3.select(this).style("stroke-width",String(12)+"px").classed("node-to-combine",!0)}).on("mouseout.combine",function(e){e.bigg_id==i&&t.sel.selectAll(".node-to-combine").style("stroke-width",String(2)+"px").classed("node-to-combine",!1)})}}),i.on("drag",function(e){d3.select(this.parentNode).classed("selected")||t.select_selectable(this,e);var n={};-1===d3.select(this).attr("class").indexOf("label")?(n.type="node",n.id=this.parentNode.__data__.node_id):(n.type="label",n.id=this.__data__.text_label_id);var i=t.get_selected_node_ids(),r=t.get_selected_text_label_ids();a=[],l=[],"node"==n.type&&-1==i.indexOf(n.id)?a.push(n.id):"label"==n.type&&-1==r.indexOf(n.id)?l.push(n.id):(a=i,l=r),s=[];var c={x:d3.event.dx,y:d3.event.dy};o=b.c_plus_c(o,c),a.forEach(function(e){var n=t.nodes[e],i=x.move_node_and_dependents(n,e,t.reactions,t.beziers,c);s=b.unique_concat([s,i.reaction_ids])}),l.forEach(function(t){u(t,c)}),t.draw_these_nodes(a),t.draw_these_reactions(s),t.draw_these_text_labels(l)}),i.on("dragend",function(){if(null===a)return o=null,a=null,l=null,s=null,void(r=null);var i=[];if(t.sel.selectAll(".node-to-combine").each(function(t){i.push(t.node_id)}),1==i.length){var c=i[0],h=this.parentNode.__data__.node_id,d=b.clone(t.nodes[h]),f=n(c,h);e.push(function(){t.nodes[h]=d;var e=t.nodes[c],n=[];f.forEach(function(i){var r=t.reactions[i.reaction_id].segments[i.segment_id];r.from_node_id==c?r.from_node_id=h:r.to_node_id==c?r.to_node_id=h:console.error("Segment does not connect to fixed node"),e.connected_segments=e.connected_segments.filter(function(t){return!(t.reaction_id==i.reaction_id&&t.segment_id==i.segment_id)}),-1==n.indexOf(i.reaction_id)&&n.push(i.reaction_id)}),t.draw_these_nodes([h]),t.draw_these_reactions(n)},function(){n(c,h)})}else{var p=b.clone(o),_=b.clone(a),g=b.clone(l),m=b.clone(s);e.push(function(){_.forEach(function(e){var n=t.nodes[e];x.move_node_and_dependents(n,e,t.reactions,t.beziers,b.c_times_scalar(p,-1))}),g.forEach(function(t){u(t,b.c_times_scalar(p,-1))}),t.draw_these_nodes(_),t.draw_these_reactions(m),t.draw_these_text_labels(g)},function(){_.forEach(function(e){var n=t.nodes[e];x.move_node_and_dependents(n,e,t.reactions,t.beziers,p)}),g.forEach(function(t){u(t,p)}),t.draw_these_nodes(_),t.draw_these_reactions(m),t.draw_these_text_labels(g)})}t.sel.selectAll(".metabolite-circle").on("mouseover.combine",null).on("mouseout.combine",null),clearTimeout(r),o=null,a=null,l=null,s=null,r=null}),i}function _(t){var e=function(e,n,i,r,o){var a=t.reactions[e].segments[n];a[i]=b.c_plus_c(a[i],o),t.beziers[r].x=a[i].x,t.beziers[r].y=a[i].y},n=function(t){t.dragging=!0},i=function(n,i,r){e(n.reaction_id,n.segment_id,n.bezier,n.bezier_id,i),t.draw_these_reactions([n.reaction_id],!1),t.draw_these_beziers([n.bezier_id])},r=function(t){t.dragging=!1},o=function(n,i){e(n.reaction_id,n.segment_id,n.bezier,n.bezier_id,b.c_times_scalar(i,-1)),t.draw_these_reactions([n.reaction_id],!1),t.draw_these_beziers([n.bezier_id])},a=function(n,i){e(n.reaction_id,n.segment_id,n.bezier,n.bezier_id,i),t.draw_these_reactions([n.reaction_id],!1),t.draw_these_beziers([n.bezier_id])};return this._get_generic_drag(n,i,r,o,a,this.map.sel)}function g(t){var e=function(e,n){var i=t.reactions[e];i.label_x=i.label_x+n.x,i.label_y=i.label_y+n.y},n=function(t){},i=function(n,i,r){e(n.reaction_id,i),t.draw_these_reactions([n.reaction_id])},r=function(t){},o=function(n,i){e(n.reaction_id,b.c_times_scalar(i,-1)),t.draw_these_reactions([n.reaction_id])},a=function(n,i){e(n.reaction_id,i),t.draw_these_reactions([n.reaction_id])};return this._get_generic_drag(n,i,r,o,a,this.map.sel)}function m(t){var e=function(e,n){var i=t.nodes[e];i.label_x=i.label_x+n.x,i.label_y=i.label_y+n.y},n=function(t){},i=function(n,i,r){e(n.node_id,i),t.draw_these_nodes([n.node_id])},r=function(t){},o=function(n,i){e(n.node_id,b.c_times_scalar(i,-1)),t.draw_these_nodes([n.node_id])},a=function(n,i){e(n.node_id,i),t.draw_these_nodes([n.node_id])};return this._get_generic_drag(n,i,r,o,a,this.map.sel)}function v(t,e,n,i,r,o){var a,s=d3.behavior.drag(),l=this.undo_stack,u=o.node();return s.on("dragstart",function(e){d3.event.sourceEvent.stopPropagation(),a={x:0,y:0},t(e)}),s.on("drag",function(t){var n={x:d3.event.dx,y:d3.event.dy},i={x:d3.mouse(u)[0],y:d3.mouse(u)[1]};a=b.c_plus_c(a,n),e(t,n,a,i)}),s.on("dragend",function(t){var e=b.clone(t),o=b.clone(a),s={x:d3.mouse(u)[0],y:d3.mouse(u)[1]};l.push(function(){i(e,o,s)},function(){r(e,o,s)}),n(t)}),s}function y(t,e,n,i,r,o,a){var s,l=d3.behavior.drag(),u=this.undo_stack,c=a.node();return l.on("dragstart",function(e){d3.event.sourceEvent.stopPropagation(),s=0,t(e)}),l.on("drag",function(t){var n={x:d3.event.dx,y:d3.event.dy},i={x:d3.mouse(c)[0],y:d3.mouse(c)[1]},r=o(),a=b.angle_for_event(n,i,r);s+=a,e(t,a,s,r)}),l.on("dragend",function(t){var e=b.clone(t),a=s,l=b.clone(o());u.push(function(){i(e,a,l)},function(){r(e,a,l)}),n(t)}),l}var b=n(195),x=n(212),w=b.make_class();w.prototype={init:i,toggle_rotation_mode:a,turn_everything_on:r,turn_everything_off:o,toggle_selectable_click:s,toggle_text_label_edit:l,toggle_selectable_drag:u,toggle_label_drag:c,toggle_label_mousedown:h,toggle_bezier_drag:d,turn_off_drag:f,_get_selectable_drag:p,_get_bezier_drag:_,_get_reaction_label_drag:g,_get_node_label_drag:m,_get_generic_drag:v,_get_generic_angular_drag:y},t.exports=w},function(t,e,n){function i(t,e,n,i,o,a,l,u){u=Math.PI/180*u;var c,h=String(++a.reactions),p={x:o.x,y:o.y},_=300,g=[p,f.c_plus_c(p,{x:_,y:0})],m={x:(g[0].x+g[1].x)/2,y:(g[0].y+g[1].y)/2};c=Math.abs(u)<Math.PI/4||Math.abs(u-Math.PI)<Math.PI/4?{x:-50,y:-40}:{x:30,y:10};var v=20,y=f.clone(e);f.extend(y,{label_x:m.x+c.x,label_y:m.y+c.y,segments:{}});var b=[],x=[],w=0,S=0,A=!1;for(var k in y.metabolites){var C=n[k],T=y.metabolites[k],E=C.formula,M={coefficient:T,bigg_id:k,name:C.name};if(0>T){M.index=w;var L=/C([0-9]+)/.exec(E);o.bigg_id==M.bigg_id?b.push([M.index,1/0]):L&&-1==l.indexOf(f.decompartmentalize(M.bigg_id)[0])&&b.push([M.index,parseInt(L[1])]),w++}else{M.index=S;var L=/C([0-9]+)/.exec(E);o.bigg_id==M.bigg_id?(x.push([M.index,1/0]),A=!0):L&&-1==l.indexOf(f.decompartmentalize(M.bigg_id)[0])&&x.push([M.index,parseInt(L[1])]),S++}y.metabolites[k]=M}var R=function(t,e){return e[1]>t[1]?e:t},O=b.reduce(R,[0,0])[0],P=x.reduce(R,[0,0])[0];for(var k in y.metabolites){var C=y.metabolites[k];C.coefficient<0?(C.index==O&&(C.is_primary=!0),C.count=w+1):(C.index==P&&(C.is_primary=!0),C.count=S+1)}var D={},I=[{node_type:"anchor_reactants",dis:{x:v*(A?1:-1),y:0}},{node_type:"center",dis:{x:0,y:0}},{node_type:"anchor_products",dis:{x:v*(A?-1:1),y:0}}],N={};I.map(function(t){var e=String(++a.nodes),n="center"==t.node_type?"midmarker":"multimarker";D[e]={node_type:n,x:m.x+t.dis.x,y:m.y+t.dis.y,connected_segments:[],name:null,bigg_id:null,label_x:null,label_y:null,node_is_primary:null},N[t.node_type]=e});var F=[[N.anchor_reactants,N.center],[N.anchor_products,N.center]];F.map(function(t){var e=t[0],n=t[1],i=String(++a.segments);y.segments[i]={b1:null,b2:null,from_node_id:e,to_node_id:n,from_node_coefficient:null,to_node_coefficient:null,reversibility:y.reversibility,data:y.data,reverse_flux:y.reverse_flux},D[e].connected_segments.push({segment_id:i,reaction_id:h}),D[n].connected_segments.push({segment_id:i,reaction_id:h})});var B=D;for(var k in y.metabolites){var z,H,C=y.metabolites[k];C.coefficient<0?(z=O,H=N.anchor_reactants):(z=P,H=N.anchor_products);var q=s(C,z,g,m,_,A);if(o.bigg_id==C.bigg_id){var G=String(++a.segments);y.segments[G]={b1:q.b1,b2:q.b2,from_node_id:H,to_node_id:i,from_node_coefficient:null,to_node_coefficient:C.coefficient,reversibility:y.reversibility,data:y.data,reverse_flux:y.reverse_flux},o.connected_segments.push({segment_id:G,reaction_id:h}),B[H].connected_segments.push({segment_id:G,reaction_id:h})}else{var G=String(++a.segments),j=String(++a.nodes);y.segments[G]={b1:q.b1,b2:q.b2,from_node_id:H,to_node_id:j,from_node_coefficient:null,to_node_coefficient:C.coefficient,reversibility:y.reversibility,data:y.data,reverse_flux:y.reverse_flux},B[j]={connected_segments:[{segment_id:G,reaction_id:h}],x:q.circle.x,y:q.circle.y,node_is_primary:Boolean(C.is_primary),label_x:q.circle.x+c.x,label_y:q.circle.y+c.y,name:C.name,bigg_id:C.bigg_id,node_type:"metabolite"},B[H].connected_segments.push({segment_id:G,reaction_id:h})}}var U=[];for(var t in y.metabolites)U.push({bigg_id:t,coefficient:y.metabolites[t].coefficient});y.metabolites=U;var V={};V[h]=y;var W=d(V);return B[i]=o,r(B,V,W,u,p),{new_reactions:V,new_beziers:W,new_nodes:B}}function r(t,e,n,i,r){var o=function(t){return null===t?null:f.rotate_coords(t,i,r)},s=[],l=[];for(var c in t){var h=t[c],d=o({x:h.x,y:h.y}),p=a(h,e,d);h.connected_segments.map(function(t){var i=e[t.reaction_id];if(void 0!==i){var r=t.segment_id,a=i.segments[r];if(a.to_node_id==c&&a.b2){var s=o(a.b2),l=u(r,"b2");a.b2=f.c_plus_c(a.b2,s),n[l].x=a.b2.x,n[l].y=a.b2.y}else if(a.from_node_id==c&&a.b1){var s=o(a.b1),l=u(r,"b1");a.b1=f.c_plus_c(a.b1,s),n[l].x=a.b1.x,n[l].y=a.b1.y}}}),l=f.unique_concat([l,p.reaction_ids]),s.push(c)}return{node_ids:s,reaction_ids:l}}function o(t,e,n,i,r){var o=a(t,n,r);return t.connected_segments.map(function(t){var a=n[t.reaction_id];if(void 0!==a){var s=t.segment_id,l=a.segments[s];[["b1","from_node_id"],["b2","to_node_id"]].forEach(function(t){var n=t[0],o=t[1];if(l[o]==e&&l[n]){l[n]=f.c_plus_c(l[n],r);var a=i[u(s,n)];a.x=l[n].x,a.y=l[n].y}}),o.reaction_ids.indexOf(t.reaction_id)<0&&o.reaction_ids.push(t.reaction_id)}}),o}function a(t,e,n){t.x=t.x+n.x,t.y=t.y+n.y,t.label_x=t.label_x+n.x,t.label_y=t.label_y+n.y;var i=[];return t.connected_segments.map(function(r){var o=e[r.reaction_id];i.indexOf(r.reaction_id)<0&&(i.push(r.reaction_id),"midmarker"==t.node_type&&(o.label_x=o.label_x+n.x,o.label_y=o.label_y+n.y))}),{reaction_ids:i}}function s(t,e,n,i,r,o){var a,s,l=n[0],n=[f.c_minus_c(n[0],l),f.c_minus_c(n[1],l)],i=f.c_minus_c(i,l),u=80,c=.4,h=.25,d=.7*u,p=40,_=Math.min(2,t.count-1);t.is_primary?a=20:(a=10,s=t.index>e?t.index-1:t.index);var g,m,v,y,b=r-a,x=[{x:a,y:0},{x:b,y:0}];t.coefficient<0!=o&&t.is_primary?(g={x:x[0].x,y:x[0].y},v={x:i.x*(1-c)+x[0].x*c,y:i.y*(1-c)+x[0].y*c},y={x:i.x*h+g.x*(1-h),y:i.y*h+g.y*(1-h)},m={x:n[0].x,y:n[0].y}):t.coefficient<0!=o?(g={x:x[0].x+p,y:x[0].y+(d*s-d*(_-1)/2)},v={x:i.x*(1-c)+x[0].x*c,y:i.y*(1-c)+x[0].y*c},y={x:i.x*h+g.x*(1-h),y:i.y*h+g.y*(1-h)},m={x:n[0].x+p,y:n[0].y+(u*s-u*(_-1)/2)}):t.coefficient>0!=o&&t.is_primary?(g={x:x[1].x,y:x[1].y},v={x:i.x*(1-c)+x[1].x*c,y:i.y*(1-c)+x[1].y*c},y={x:i.x*h+g.x*(1-h),y:i.y*h+g.y*(1-h)},m={x:n[1].x,y:n[1].y}):t.coefficient>0!=o&&(g={x:x[1].x-p,y:x[1].y+(d*s-d*(_-1)/2)},v={x:i.x*(1-c)+x[1].x*c,y:i.y*(1-c)+x[1].y*c},y={x:i.x*h+g.x*(1-h),y:i.y*h+g.y*(1-h)},m={x:n[1].x-p,y:n[1].y+(u*s-u*(_-1)/2)});var w={};return w.b1=f.c_plus_c(l,v),w.b2=f.c_plus_c(l,y),w.circle=f.c_plus_c(l,m),w}function l(t,e,n){var i=String(++t.text_labels),r={text:e,x:n.x,y:n.y};return{id:i,label:r}}function u(t,e){return t+"_"+e}function c(t){var e=[];for(var n in t){var i=t[n];for(var r in i.segments){var o=i.segments[r];["b1","b2"].forEach(function(t){var n=o[t];null!==n&&e.push(u(r,t))})}}return e}function h(t,e){var n={};for(var i in t){var r=t[i];["b1","b2"].forEach(function(t){var o=r[t];if(null!==o){var a=u(i,t);n[a]={bezier:t,x:o.x,y:o.y,reaction_id:e,segment_id:i}}})}return n}function d(t){var e={};for(var n in t){var i=t[n],r=h(i.segments,n);f.extend(e,r)}return e}var f=n(195);t.exports={new_reaction:i,rotate_nodes:r,move_node_and_dependents:o,new_text_label:l,bezier_id_for_segment_id:u,bezier_ids_for_reaction_ids:c,new_beziers_for_segments:h,new_beziers_for_reactions:d}},function(t,e,n){function i(){this.x=d3.scale.linear(),this.y=d3.scale.linear(),this.x_size=d3.scale.linear(),this.y_size=d3.scale.linear(),this.size=d3.scale.linear(),this.reaction_color=d3.scale.linear().clamp(!0),this.reaction_size=d3.scale.linear().clamp(!0),this.metabolite_color=d3.scale.linear().clamp(!0),this.metabolite_size=d3.scale.linear().clamp(!0),this.scale_path=function(t){var e=this.x,n=this.y,i=d3.format(".2f"),t=t.replace(/(M|L)([0-9-.]+),?\s*([0-9-.]+)/g,function(t,r,o,a){return r+[i(e(parseFloat(o))),i(n(parseFloat(a)))].join(", ")}),r=/C([0-9-.]+),?\s*([0-9-.]+)\s*([0-9-.]+),?\s*([0-9-.]+)\s*([0-9-.]+),?\s*([0-9-.]+)/g;return t=t.replace(r,function(t,r,o,a,s,l,u){return"C"+i(e(parseFloat(r)))+","+i(n(parseFloat(o)))+" "+i(e(parseFloat(a)))+","+i(n(parseFloat(s)))+" "+[i(e(parseFloat(l)))+","+i(n(parseFloat(u)))]})}.bind(this),this.scale_decimals=function(t,e,n){var i=d3.format("."+String(n)+"f");return t=t.replace(/([0-9.]+)/g,function(t,n){return i(e(parseFloat(n)))})}}function r(t,e,n){function i(t,e){var n=t.map(function(t){var n;if(t.type in e)n=e[t.type];else{if("value"!=t.type)throw new Error("Bad domain type "+t.type);n=t.value}return{v:n,color:t.color,size:t.size}}).sort(function(t,e){return t.v-e.v});return{domain:n.map(function(t){return t.v}),color_range:n.map(function(t){return t.color}),size_range:n.map(function(t){return t.size})}}var r=function(t){var e=i(t,n().reaction);this.reaction_color.domain(e.domain),this.reaction_size.domain(e.domain),this.reaction_color.range(e.color_range),this.reaction_size.range(e.size_range)}.bind(this),o=function(t){var e=i(t,n().metabolite);this.metabolite_color.domain(e.domain),this.metabolite_size.domain(e.domain),this.metabolite_color.range(e.color_range),this.metabolite_size.range(e.size_range)}.bind(this);t.streams.reaction_scale.onValue(r),t.streams.metabolite_scale.onValue(o),e.callback_manager.set("calc_data_stats__reaction",function(e){e&&r(t.get_option("reaction_scale"))}),e.callback_manager.set("calc_data_stats__metabolite",function(e){e&&o(t.get_option("metabolite_scale"))})}var o=n(195),a=o.make_class();a.prototype={init:i,connect_to_settings:r},t.exports=a},function(t,e,n){function i(){var t=40;this.stack=Array(t),this.current=-1,this.oldest=-1,this.newest=-1,this.end_of_stack=!0,this.top_of_stack=!0}function r(t,e){return t+1>e-1?0:t+1}function o(t,e){return 0>t-1?e-1:t-1}function a(t,e){this.current=r(this.current,this.stack.length),this.end_of_stack?this.oldest=this.current:this.oldest==this.current&&(this.oldest=r(this.oldest,this.stack.length)),this.stack[this.current]={undo:t,redo:e},this.newest=this.current,this.top_of_stack=!0,this.end_of_stack=!1}function s(){return this.end_of_stack?console.warn("End of stack."):(this.stack[this.current].undo(),this.current==this.oldest?this.end_of_stack=!0:this.current=o(this.current,this.stack.length),void(this.top_of_stack=!1))}function l(){return this.top_of_stack?console.warn("Top of stack."):(this.end_of_stack||(this.current=r(this.current,this.stack.length)),this.stack[this.current].redo(),this.current==this.newest&&(this.top_of_stack=!0),void(this.end_of_stack=!1))}var u=n(195),c=u.make_class();c.prototype={init:i,push:a,undo:s,redo:l},t.exports=c},function(t,e,n){function i(t,e,n,i){this.assigned_keys=t||{},this.input_list=e||[],this.mousetrap=n?new h(n):new h,this.ctrl_equals_cmd=d.isBoolean(i)?i:!1,this.mousetrap.stopCallback=function(){return!1},this.enabled=!0,this.update()}function r(t,e){if(!e)return t;var n=d.isArray(t)?t:[t],i=n.reduce(function(t,e){var n=e.replace("ctrl+","meta+");return n!==e&&t.push(n),t},n.slice());return i.length===n.length?t:i}function o(){if(this.mousetrap.reset(),this.enabled)for(var t in this.assigned_keys){var e=this.assigned_keys[t];if(e.key){var n=r(e.key,this.ctrl_equals_cmd);e.input_list=this.input_list,this.mousetrap.bind(n,function(t){var e=!1;if(this.ignore_with_input)for(var n=0,i=this.input_list.length;i>n;n++)if(this.input_list[n].is_visible()){e=!0;break}e||(this.fn?this.fn.call(this.target):console.warn("No function for key: "+this.key),t.preventDefault())}.bind(e),"keydown")}}}function a(t){d.isUndefined(t)&&(t=!this.enabled),this.enabled=t,this.update()}function s(t,e){return this.add_key_listener("enter",t,e)}function l(t,e){return this.add_key_listener("escape",t,e)}function u(t,e,n){d.isUndefined(n)&&(n=!1);var i=this.mousetrap.unbind.bind(this.mousetrap,t);return this.mousetrap.bind(r(t,this.ctrl_equals_cmd),function(t){t.preventDefault(),e(),n&&i()}),i}var c=n(195),h=n(216),d=n(197),f=c.make_class();f.prototype={init:i,update:o,toggle:a,add_escape_listener:l,add_enter_listener:s,add_key_listener:u},t.exports=f},function(t,e,n){var i;!function(r,o,a){function s(t,e,n){return t.addEventListener?void t.addEventListener(e,n,!1):void t.attachEvent("on"+e,n)}function l(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return x[t.which]?x[t.which]:w[t.which]?w[t.which]:String.fromCharCode(t.which).toLowerCase()}function u(t,e){return t.sort().join(",")===e.sort().join(",")}function c(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}function h(t){return t.preventDefault?void t.preventDefault():void(t.returnValue=!1)}function d(t){return t.stopPropagation?void t.stopPropagation():void(t.cancelBubble=!0)}function f(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function p(){if(!b){b={};for(var t in x)t>95&&112>t||x.hasOwnProperty(t)&&(b[x[t]]=t)}return b}function _(t,e,n){return n||(n=p()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}function g(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus"),t.split("+"))}function m(t,e){var n,i,r,o=[];for(n=g(t),r=0;r<n.length;++r)i=n[r],A[i]&&(i=A[i]),e&&"keypress"!=e&&S[i]&&(i=S[i],o.push("shift")),f(i)&&o.push(i);return e=_(i,o,e),{key:i,modifiers:o,action:e}}function v(t,e){return null===t||t===o?!1:t===e?!0:v(t.parentNode,e)}function y(t){function e(t){t=t||{};var e,n=!1;for(e in b)t[e]?n=!0:b[e]=0;n||(S=!1)}function n(t,e,n,i,r,o){var a,s,l=[],c=n.type;if(!g._callbacks[t])return[];for("keyup"==c&&f(t)&&(e=[t]),a=0;a<g._callbacks[t].length;++a)if(s=g._callbacks[t][a],(i||!s.seq||b[s.seq]==s.level)&&c==s.action&&("keypress"==c&&!n.metaKey&&!n.ctrlKey||u(e,s.modifiers))){var h=!i&&s.combo==r,d=i&&s.seq==i&&s.level==o;(h||d)&&g._callbacks[t].splice(a,1),l.push(s)}return l}function i(t,e,n,i){g.stopCallback(e,e.target||e.srcElement,n,i)||t(e,n)===!1&&(h(e),d(e))}function r(t){"number"!=typeof t.which&&(t.which=t.keyCode);var e=l(t);if(e)return"keyup"==t.type&&x===e?void(x=!1):void g.handleKey(e,c(t),t)}function a(){clearTimeout(v),v=setTimeout(e,1e3)}function p(t,n,r,o){function s(e){return function(){S=e,++b[t],a()}}function u(n){i(r,n,t),"keyup"!==o&&(x=l(n)),setTimeout(e,10)}b[t]=0;for(var c=0;c<n.length;++c){var h=c+1===n.length,d=h?u:s(o||m(n[c+1]).action);_(n[c],d,o,t,c)}}function _(t,e,i,r,o){g._directMap[t+":"+i]=e,t=t.replace(/\s+/g," ");var a,s=t.split(" ");return s.length>1?void p(t,s,e,i):(a=m(t,i),g._callbacks[a.key]=g._callbacks[a.key]||[],n(a.key,a.modifiers,{type:a.action},r,t,o),void g._callbacks[a.key][r?"unshift":"push"]({callback:e,modifiers:a.modifiers,action:a.action,seq:r,level:o,combo:t}))}var g=this;if(t=t||o,!(g instanceof y))return new y(t);g.target=t,g._callbacks={},g._directMap={};var v,b={},x=!1,w=!1,S=!1;g._handleKey=function(t,r,o){var a,s=n(t,r,o),l={},u=0,c=!1;for(a=0;a<s.length;++a)s[a].seq&&(u=Math.max(u,s[a].level));for(a=0;a<s.length;++a)if(s[a].seq){if(s[a].level!=u)continue;c=!0,l[s[a].seq]=1,i(s[a].callback,o,s[a].combo,s[a].seq)}else c||i(s[a].callback,o,s[a].combo);var h="keypress"==o.type&&w;o.type!=S||f(t)||h||e(l),w=c&&"keydown"==o.type},g._bindMultiple=function(t,e,n){for(var i=0;i<t.length;++i)_(t[i],e,n)},s(t,"keypress",r),s(t,"keydown",r),s(t,"keyup",r)}for(var b,x={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},w={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},S={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},A={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},k=1;20>k;++k)x[111+k]="f"+k;for(k=0;9>=k;++k)x[k+96]=k;y.prototype.bind=function(t,e,n){var i=this;return t=t instanceof Array?t:[t],i._bindMultiple.call(i,t,e,n),i},y.prototype.unbind=function(t,e){var n=this;return n.bind.call(n,t,function(){},e)},y.prototype.trigger=function(t,e){var n=this;return n._directMap[t+":"+e]&&n._directMap[t+":"+e]({},t),n},y.prototype.reset=function(){var t=this;return t._callbacks={},t._directMap={},t},y.prototype.stopCallback=function(t,e){var n=this;return(" "+e.className+" ").indexOf(" mousetrap ")>-1?!1:v(e,n.target)?!1:"INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable},y.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},y.init=function(){var t=y(o);for(var e in t)"_"!==e.charAt(0)&&(y[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},y.init(),r.Mousetrap=y,"undefined"!=typeof t&&t.exports&&(t.exports=y),i=function(){return y}.call(e,n,e,t),!(i!==a&&(t.exports=i))}(window,document)},function(t,e,n){function i(t,e){this.selection=t,this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.resize_enabled=!0,this.callback_manager=new l,this.setup()}function r(t){void 0===t&&(t=!this.resize_enabled),t?this.selection.selectAll(".drag-rect").style("pointer-events","auto"):this.selection.selectAll(".drag-rect").style("pointer-events","none")}function o(){function t(){d3.event.sourceEvent.stopPropagation()}function e(t,e,n){var i=s.d3_transform_catch(n),r=i.translate;return null!==t&&(r[0]=t),null!==e&&(r[1]=e),"translate("+r+")"}function n(t){var n=t.x;t.x=Math.min(t.x+a.width-l/2,d3.event.x),a.x=t.x,a.width=a.width+(n-t.x),m.attr("transform",function(t){return e(t.x-l/2,null,m.attr("transform"))}),h.attr("transform",function(t){
return e(t.x,null,h.attr("transform"))}).attr("width",a.width*u),d.attr("transform",function(t){return e(t.x,null,d.attr("transform"))}).attr("width",a.width),y.attr("transform",function(t){return e(t.x+l/2,null,y.attr("transform"))}).attr("width",a.width-l),b.attr("transform",function(t){return e(t.x+l/2,null,b.attr("transform"))}).attr("width",a.width-l),a.callback_manager.run("resize")}function i(t){d3.event.sourceEvent.stopPropagation();var n=Math.max(t.x+l/2,t.x+a.width+d3.event.dx);a.width=n-t.x,v.attr("transform",function(t){return e(n-l/2,null,v.attr("transform"))}),h.attr("width",a.width*u),d.attr("width",a.width),y.attr("width",a.width-l),b.attr("width",a.width-l),a.callback_manager.run("resize")}function r(t){d3.event.sourceEvent.stopPropagation();var n=t.y;t.y=Math.min(t.y+a.height-l/2,d3.event.y),a.y=t.y,a.height=a.height+(n-t.y),y.attr("transform",function(t){return e(null,t.y-l/2,y.attr("transform"))}),h.attr("transform",function(t){return e(null,t.y,h.attr("transform"))}).attr("width",a.height*u),d.attr("transform",function(t){return e(null,t.y,d.attr("transform"))}).attr("height",a.height),m.attr("transform",function(t){return e(null,t.y+l/2,m.attr("transform"))}).attr("height",a.height-l),v.attr("transform",function(t){return e(null,t.y+l/2,v.attr("transform"))}).attr("height",a.height-l),a.callback_manager.run("resize")}function o(t){d3.event.sourceEvent.stopPropagation();var n=Math.max(t.y+l/2,t.y+a.height+d3.event.dy);a.height=n-t.y,b.attr("transform",function(t){return e(null,n-l/2,b.attr("transform"))}),h.attr("height",a.height*u),d.attr("height",a.height),m.attr("height",a.height-l),v.attr("height",a.height-l),a.callback_manager.run("resize")}var a=this,l=({x:this.width,y:this.height},100),u=10,c=this.selection.append("g").classed("canvas-group",!0).data([{x:this.x,y:this.y}]),h=c.append("rect").attr("id","mouse-node").attr("width",this.width*u).attr("height",this.height*u).attr("transform","translate("+[a.x-this.width*u/2,a.y-this.height*u/2]+")").attr("pointer-events","all");this.mouse_node=h;var d=c.append("rect").attr("id","canvas").attr("width",this.width).attr("height",this.height).attr("transform","translate("+[a.x,a.y]+")"),f=d3.behavior.drag().origin(Object).on("dragstart",t).on("drag",i),p=d3.behavior.drag().origin(Object).on("dragstart",t).on("drag",n),_=d3.behavior.drag().origin(Object).on("dragstart",t).on("drag",r),g=d3.behavior.drag().origin(Object).on("dragstart",t).on("drag",o),m=c.append("rect").classed("drag-rect",!0).attr("transform",function(t){return"translate("+[t.x-l/2,t.y+l/2]+")"}).attr("height",this.height-l).attr("id","dragleft").attr("width",l).attr("cursor","ew-resize").classed("resize-rect",!0).call(p),v=c.append("rect").classed("drag-rect",!0).attr("transform",function(t){return"translate("+[t.x+a.width-l/2,t.y+l/2]+")"}).attr("id","dragright").attr("height",this.height-l).attr("width",l).attr("cursor","ew-resize").classed("resize-rect",!0).call(f),y=c.append("rect").classed("drag-rect",!0).attr("transform",function(t){return"translate("+[t.x+l/2,t.y-l/2]+")"}).attr("height",l).attr("id","dragtop").attr("width",this.width-l).attr("cursor","ns-resize").classed("resize-rect",!0).call(_),b=c.append("rect").classed("drag-rect",!0).attr("transform",function(t){return"translate("+[t.x+l/2,t.y+a.height-l/2]+")"}).attr("id","dragbottom").attr("height",l).attr("width",this.width-l).attr("cursor","ns-resize").classed("resize-rect",!0).call(g)}function a(){return{x:this.x,y:this.y,width:this.width,height:this.height}}var s=n(195),l=n(208),u=s.make_class();u.prototype={init:i,toggle_resize:r,setup:o,size_and_location:a},t.exports=u},function(t,e,n){function i(){this.index={}}function r(t,e,n,i){if(!n&&t in this.index)throw new Error("id is already in the index");if(i&&!("name"in e&&"data"in e))throw new Error("malformed record");this.index[t]=e}function o(t){return t in this.index?(delete this.index[t],!0):!1}function a(t){var e=RegExp(t,"i"),n=[];for(var i in this.index){var r=this.index[i];e.exec(r.name)&&n.push(r.data)}return n}var s=n(195),l=s.make_class();l.prototype={init:i,insert:r,remove:o,find:a},t.exports=l},function(t,e,n){var i,r;(function(t,o){(function(){function a(t,e){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];this.obs=t,this.sync=e,this.lazy=n,this.queue=[]}function s(){a.apply(this,arguments)}function l(t){a.call(this,t,!0)}function u(t,e,n){this.context=t,this.method=e,this.args=n}function c(t){this.value=t}function h(){this.id=++at}function d(t,e){return this instanceof d?(h.call(this),void(!e&&q.isFunction(t)||(null!=t?t._isNext:void 0)?(this.valueF=t,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=t))):new d(t,e)}function f(t,e){return this instanceof f?void d.call(this,t,e):new f(t,e)}function p(){return this instanceof p?void h.call(this):new p}function _(t){return this instanceof _?(this.error=t,void h.call(this)):new _(t)}function g(t){this.desc=t,this.id=++ht,this.initialDesc=this.desc}function m(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];this.unsubscribe=q.bind(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[];for(var e,n=0;n<t.length;n++)e=t[n],this.add(e)}function v(t,e){this._subscribe=t,this._handleEvent=e,this.subscribe=q.bind(this.subscribe,this),this.handleEvent=q.bind(this.handleEvent,this),this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0,this.subscriptions=[],this.queue=[]}function y(t,e,n){return this instanceof y?(q.isFunction(t)&&(n=e,e=t,t=u.empty),g.call(this,t),D(e),this.dispatcher=new v(e,n),void dt(this)):new y(t,e,n)}function b(t,e,n){v.call(this,e,n),this.property=t,this.subscribe=q.bind(this.subscribe,this),this.current=rt,this.currentValueRootId=void 0,this.propertyEnded=!1}function x(t,e,n){g.call(this,t),D(e),this.dispatcher=new b(this,e,n),dt(this)}function w(){return this instanceof w?(this.unsubAll=q.bind(this.unsubAll,this),this.subscribeAll=q.bind(this.subscribeAll,this),this.guardedSink=q.bind(this.guardedSink,this),this.sink=void 0,this.subscriptions=[],this.ended=!1,void y.call(this,new k.Desc(k,"Bus",[]),this.subscribeAll)):new w}function S(t){return[t,ut()]}var A=Array.prototype.slice,k={toString:function(){return"Bacon"}};k.version="0.7.83";var C=("undefined"!=typeof t&&null!==t?t:this).Error,T=function(){},E=function(t,e){return t},M=function(t){return t.slice(0)},L=function(t,e){if(!e)throw new C(t)},R=function(t){if((null!=t?t._isObservable:void 0)&&!(null!=t?t._isProperty:void 0))throw new C("Observable is not a Property : "+t)},O=function(t){if(!(null!=t?t._isEventStream:void 0))throw new C("not an EventStream : "+t)},P=function(t){if(!(null!=t?t._isObservable:void 0))throw new C("not an Observable : "+t)},D=function(t){return L("not a function : "+t,q.isFunction(t))},I=function(t){return t instanceof Array},N=function(t){return t&&t._isObservable},F=function(t){if(!I(t))throw new C("not an array : "+t)},B=function(t){return L("no arguments supported",0===t.length)},z=function(t){for(var e=arguments.length,n=1;e>1?e>n:n>e;e>1?n++:n--)for(var i in arguments[n])t[i]=arguments[n][i];return t},H=function(t,e){var n={}.hasOwnProperty,i=function(){};i.prototype=e.prototype,t.prototype=new i;for(var r in e)n.call(e,r)&&(t[r]=e[r]);return t},q={indexOf:function(){return Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var n,i=0;i<t.length;i++)if(n=t[i],e===n)return i;return-1}}(),indexWhere:function(t,e){for(var n,i=0;i<t.length;i++)if(n=t[i],e(n))return i;return-1},head:function(t){return t[0]},always:function(t){return function(){return t}},negate:function(t){return function(e){return!t(e)}},empty:function(t){return 0===t.length},tail:function(t){return t.slice(1,t.length)},filter:function(t,e){for(var n,i=[],r=0;r<e.length;r++)n=e[r],t(n)&&i.push(n);return i},map:function(t,e){return function(){for(var n,i=[],r=0;r<e.length;r++)n=e[r],i.push(t(n));return i}()},each:function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n];e(n,i)}},toArray:function(t){return I(t)?t:[t]},contains:function(t,e){return-1!==q.indexOf(t,e)},id:function(t){return t},last:function(t){return t[t.length-1]},all:function(t){for(var e,n=arguments.length<=1||void 0===arguments[1]?q.id:arguments[1],i=0;i<t.length;i++)if(e=t[i],!n(e))return!1;return!0},any:function(t){for(var e,n=arguments.length<=1||void 0===arguments[1]?q.id:arguments[1],i=0;i<t.length;i++)if(e=t[i],n(e))return!0;return!1},without:function(t,e){return q.filter(function(e){return e!==t},e)},remove:function(t,e){var n=q.indexOf(e,t);return n>=0?e.splice(n,1):void 0},fold:function(t,e,n){for(var i,r=0;r<t.length;r++)i=t[r],e=n(e,i);return e},flatMap:function(t,e){return q.fold(e,[],function(e,n){return e.concat(t(n))})},cached:function(t){var e=rt;return function(){return("undefined"!=typeof e&&null!==e?e._isNone:void 0)&&(e=t(),t=void 0),e}},bind:function(t,e){return function(){return t.apply(e,arguments)}},isFunction:function(t){return"function"==typeof t},toString:function(t){var e,n,i,r={}.hasOwnProperty;try{return G++,null==t?"undefined":q.isFunction(t)?"function":I(t)?G>5?"[..]":"["+q.map(q.toString,t).toString()+"]":null!=(null!=t?t.toString:void 0)&&t.toString!==Object.prototype.toString?t.toString():"object"==typeof t?G>5?"{..}":(e=function(){var e=[];for(n in t)r.call(t,n)&&(i=function(){var e;try{return t[n]}catch(e){return e}}(),e.push(q.toString(n)+":"+q.toString(i)));return e}(),"{"+e+"}"):t}finally{G--}}},G=0;k._=q;var j=k.UpdateBarrier=function(){var t,e=[],n={},i=[],r=0,o={},a=function(e){return t?i.push(e):e()},s=function(i,r){if(t){var o=n[i.id];return"undefined"==typeof o||null===o?(o=n[i.id]=[r],e.push(i)):o.push(r)}return r()},l=function(){for(;e.length>0;)u(0,!0);o={}},u=function(t,i){var r=e[t],o=r.id,a=n[o];e.splice(t,1),delete n[o],i&&e.length>0&&c(r);for(var s,l=0;l<a.length;l++)(s=a[l])()},c=function(t){if(!o[t.id]){for(var i,r=t.internalDeps(),a=0;a<r.length;a++)if(i=r[a],c(i),n[i.id]){var s=q.indexOf(e,i);u(s,!1)}o[t.id]=!0}},h=function(e,n,o,a){if(t)return o.apply(n,a);t=e;try{var s=o.apply(n,a);l()}finally{for(t=void 0;r<i.length;){var u=i[r];r++,u()}r=0,i=[]}return s},d=function(){return t?t.id:void 0},f=function(t,e){var n=!1,i=!1,r=function(){return i=!0},o=function(){return n=!0,r()};return r=t.dispatcher.subscribe(function(t){return a(function(){if(!n){var i=e(t);if(i===k.noMore)return o()}})}),i&&r(),o},p=function(){return e.length>0};return{whenDoneWith:s,hasWaiters:p,inTransaction:h,currentEventId:d,wrappedSubscribe:f,afterTransaction:a}}();z(a.prototype,{_isSource:!0,subscribe:function(t){return this.obs.dispatcher.subscribe(t)},toString:function(){return this.obs.toString()},markEnded:function(){return this.ended=!0,!0},consume:function(){return this.lazy?{value:q.always(this.queue[0])}:this.queue[0]},push:function(t){return this.queue=[t],[t]},mayHave:function(){return!0},hasAtLeast:function(){return this.queue.length},flatten:!0}),H(s,a),z(s.prototype,{consume:function(){return this.queue.shift()},push:function(t){return this.queue.push(t)},mayHave:function(t){return!this.ended||this.queue.length>=t},hasAtLeast:function(t){return this.queue.length>=t},flatten:!1}),H(l,a),z(l.prototype,{consume:function(){var t=this.queue;return this.queue=[],{value:function(){return t}}},push:function(t){return this.queue.push(t.value())},hasAtLeast:function(){return!0}}),a.isTrigger=function(t){return(null!=t?t._isSource:void 0)?t.sync:null!=t?t._isEventStream:void 0},a.fromObservable=function(t){return(null!=t?t._isSource:void 0)?t:(null!=t?t._isProperty:void 0)?new a(t,!1):new s(t,!0)},z(u.prototype,{_isDesc:!0,deps:function(){return this.cached||(this.cached=W([this.context].concat(this.args))),this.cached},toString:function(){return q.toString(this.context)+"."+q.toString(this.method)+"("+q.map(q.toString,this.args)+")"}});var U=function(t,e){var n=t||e;if(n&&n._isDesc)return t||e;for(var i=arguments.length,r=Array(i>2?i-2:0),o=2;i>o;o++)r[o-2]=arguments[o];return new u(t,e,r)},V=function(t,e){return e.desc=t,e},W=function(t){return I(t)?q.flatMap(W,t):N(t)?[t]:("undefined"!=typeof t&&null!==t?t._isSource:void 0)?[t.obs]:[]};k.Desc=u,k.Desc.empty=new k.Desc("","",[]);var X=function(t){return function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];if("object"==typeof e&&i.length){var o=e,a=i[0];e=function(){return o[a].apply(o,arguments)},i=i.slice(1)}return t.apply(void 0,[e].concat(i))}},K=function(t){return t=Array.prototype.slice.call(t),Q.apply(void 0,t)},Y=function(t,e){return function(){for(var n=arguments.length,i=Array(n),r=0;n>r;r++)i[r]=arguments[r];return t.apply(void 0,e.concat(i))}},Z=function(t){return function(e){return function(n){if("undefined"!=typeof n&&null!==n){var i=n[e];return q.isFunction(i)?i.apply(n,t):i}}}},$=function(t,e){var n=t.slice(1).split("."),i=q.map(Z(e),n);return function(t){for(var e,n=0;n<i.length;n++)e=i[n],t=e(t);return t}},J=function(t){return"string"==typeof t&&t.length>1&&"."===t.charAt(0)},Q=X(function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return q.isFunction(t)?n.length?Y(t,n):t:J(t)?$(t,n):q.always(t)}),tt=function(t,e){return Q.apply(void 0,[t].concat(e))},et=function(t,e,n,i){if("undefined"!=typeof e&&null!==e?e._isProperty:void 0){var r=e.sampledBy(t,function(t,e){return[t,e]});return i.call(r,function(t){var e=t[0];t[1];return e}).map(function(t){var e=(t[0],t[1]);return e})}return e=tt(e,n),i.call(t,e)},nt=function(t){if(q.isFunction(t))return t;if(J(t)){var e=it(t);return function(t,n){return t[e](n)}}throw new C("not a function or a field key: "+t)},it=function(t){return t.slice(1)};z(c.prototype,{_isSome:!0,getOrElse:function(){return this.value},get:function(){return this.value},filter:function(t){return t(this.value)?new c(this.value):rt},map:function(t){return new c(t(this.value))},forEach:function(t){return t(this.value)},isDefined:!0,toArray:function(){return[this.value]},inspect:function(){return"Some("+this.value+")"},toString:function(){return this.inspect()}});var rt={_isNone:!0,getOrElse:function(t){return t},filter:function(){return rt},map:function(){return rt},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},ot=function(t){return("undefined"!=typeof t&&null!==t?t._isSome:void 0)||("undefined"!=typeof t&&null!==t?t._isNone:void 0)?t:new c(t)};k.noMore="<no-more>",k.more="<more>";var at=0;h.prototype._isEvent=!0,h.prototype.isEvent=function(){return!0},h.prototype.isEnd=function(){return!1},h.prototype.isInitial=function(){return!1},h.prototype.isNext=function(){return!1},h.prototype.isError=function(){return!1},h.prototype.hasValue=function(){return!1},h.prototype.filter=function(){return!0},h.prototype.inspect=function(){return this.toString()},h.prototype.log=function(){return this.toString()},H(d,h),d.prototype.isNext=function(){return!0},d.prototype.hasValue=function(){return!0},d.prototype.value=function(){var t;return(null!=(t=this.valueF)?t._isNext:void 0)?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},d.prototype.fmap=function(t){var e,n;return this.valueInternal?(n=this.valueInternal,this.apply(function(){return t(n)})):(e=this,this.apply(function(){return t(e.value())}))},d.prototype.apply=function(t){return new d(t)},d.prototype.filter=function(t){return t(this.value())},d.prototype.toString=function(){return q.toString(this.value())},d.prototype.log=function(){return this.value()},d.prototype._isNext=!0,H(f,d),f.prototype._isInitial=!0,f.prototype.isInitial=function(){return!0},f.prototype.isNext=function(){return!1},f.prototype.apply=function(t){return new f(t)},f.prototype.toNext=function(){return new d(this)},H(p,h),p.prototype.isEnd=function(){return!0},p.prototype.fmap=function(){return this},p.prototype.apply=function(){return this},p.prototype.toString=function(){return"<end>"},H(_,h),_.prototype.isError=function(){return!0},_.prototype.fmap=function(){return this},_.prototype.apply=function(){return this},_.prototype.toString=function(){return"<error> "+q.toString(this.error)},k.Event=h,k.Initial=f,k.Next=d,k.End=p,k.Error=_;var st=function(t){return new f(t,!0)},lt=function(t){return new d(t,!0)},ut=function(){return new p},ct=function(t){return t&&t._isEvent?t:lt(t)},ht=0,dt=function(){};z(g.prototype,{_isObservable:!0,subscribe:function(t){return j.wrappedSubscribe(this,t)},subscribeInternal:function(t){return this.dispatcher.subscribe(t)},onValue:function(){var t=K(arguments);return this.subscribe(function(e){return e.hasValue()?t(e.value()):void 0})},onValues:function(t){return this.onValue(function(e){return t.apply(void 0,e)})},onError:function(){var t=K(arguments);return this.subscribe(function(e){return e.isError()?t(e.error):void 0})},onEnd:function(){var t=K(arguments);return this.subscribe(function(e){return e.isEnd()?t():void 0})},name:function(t){return this._name=t,this},withDescription:function(){return this.desc=U.apply(void 0,arguments),this},toString:function(){return this._name?this._name:this.desc.toString()},internalDeps:function(){return this.initialDesc.deps()}}),g.prototype.assign=g.prototype.onValue,g.prototype.forEach=g.prototype.onValue,g.prototype.inspect=g.prototype.toString,k.Observable=g,z(m.prototype,{add:function(t){var e=this;if(!this.unsubscribed){var n=!1,i=T;this.starting.push(t);var r=function(){return e.unsubscribed?void 0:(n=!0,e.remove(i),q.remove(t,e.starting))};return i=t(this.unsubscribe,r),this.unsubscribed||n?i():this.subscriptions.push(i),q.remove(t,this.starting),i}},remove:function(t){return this.unsubscribed?void 0:void 0!==q.remove(t,this.subscriptions)?t():void 0},unsubscribe:function(){if(!this.unsubscribed){this.unsubscribed=!0;for(var t=this.subscriptions,e=0;e<t.length;e++)t[e]();return this.subscriptions=[],this.starting=[],[]}},count:function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},empty:function(){return 0===this.count()}}),k.CompositeUnsubscribe=m,v.prototype.hasSubscribers=function(){return this.subscriptions.length>0},v.prototype.removeSub=function(t){return this.subscriptions=q.without(t,this.subscriptions),this.subscriptions},v.prototype.push=function(t){return t.isEnd()&&(this.ended=!0),j.inTransaction(t,this,this.pushIt,[t])},v.prototype.pushToSubscriptions=function(t){try{for(var e=this.subscriptions,n=e.length,i=0;n>i;i++){var r=e[i],o=r.sink(t);(o===k.noMore||t.isEnd())&&this.removeSub(r)}return!0}catch(a){throw this.pushing=!1,this.queue=[],a}},v.prototype.pushIt=function(t){if(this.pushing)return this.queue.push(t),k.more;if(t!==this.prevError){for(t.isError()&&(this.prevError=t),this.pushing=!0,this.pushToSubscriptions(t),this.pushing=!1;this.queue.length;)t=this.queue.shift(),this.push(t);return this.hasSubscribers()?k.more:(this.unsubscribeFromSource(),k.noMore)}},v.prototype.handleEvent=function(t){return this._handleEvent?this._handleEvent(t):this.push(t)},v.prototype.unsubscribeFromSource=function(){this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},v.prototype.subscribe=function(t){var e;return this.ended?(t(ut()),T):(D(t),e={sink:t},this.subscriptions.push(e),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),D(this.unsubSrc)),function(t){return function(){return t.removeSub(e),t.hasSubscribers()?void 0:t.unsubscribeFromSource()}}(this))},k.Dispatcher=v,H(y,g),z(y.prototype,{_isEventStream:!0,toProperty:function(t){var e=0===arguments.length?rt:ot(function(){return t}),n=this.dispatcher,i=new k.Desc(this,"toProperty",[t]);return new x(i,function(t){var i=!1,r=!1,o=T,a=k.more,s=function(){return i?void 0:e.forEach(function(e){return i=!0,a=t(new f(e)),a===k.noMore?(o(),o=T,T):void 0})};return o=n.subscribe(function(n){return n.hasValue()?n.isInitial()&&!r?(e=new c(function(){return n.value()}),k.more):(n.isInitial()||s(),i=!0,e=new c(n),t(n)):(n.isEnd()&&(a=s()),a!==k.noMore?t(n):void 0)}),r=!0,s(),o})},toEventStream:function(){return this},withHandler:function(t){return new y(new k.Desc(this,"withHandler",[t]),this.dispatcher.subscribe,t)}}),k.EventStream=y,k.never=function(){return new y(U(k,"never"),function(t){return t(ut()),T})},k.when=function(){if(0===arguments.length)return k.never();var t=arguments.length,e="when: expecting arguments in the form (Observable+,function)+";L(e,t%2===0);for(var n=[],i=[],r=0,o=[];t>r;){o[r]=arguments[r],o[r+1]=arguments[r+1];for(var s,l=q.toArray(arguments[r]),u=pt(arguments[r+1]),c={f:u,ixs:[]},h=!1,d=0;d<l.length;d++){s=l[d];var f=q.indexOf(n,s);h||(h=a.isTrigger(s)),0>f&&(n.push(s),f=n.length-1);for(var p,_=0;_<c.ixs.length;_++)p=c.ixs[_],p.index===f&&p.count++;c.ixs.push({index:f,count:1})}L("At least one EventStream required",h||!l.length),l.length>0&&i.push(c),r+=2}if(!n.length)return k.never();n=q.map(a.fromObservable,n);var g=q.any(n,function(t){return t.flatten})&&ft(q.map(function(t){return t.obs},n)),m=new k.Desc(k,"when",o),v=new y(m,function(t){var e=[],r=!1,o=function(t){for(var e,i=0;i<t.ixs.length;i++)if(e=t.ixs[i],!n[e.index].hasAtLeast(e.count))return!1;return!0},a=function(t){return!t.sync||t.ended},s=function(t){for(var e,i=0;i<t.ixs.length;i++)if(e=t.ixs[i],!n[e.index].mayHave(e.count))return!0},l=function(t){return!t.source.flatten},u=function(u){return function(c){var h=function(){return j.whenDoneWith(v,f)},d=function(){if(!(e.length>0))return k.more;for(var r,a=k.more,s=e.pop(),u=0;u<i.length;u++)if(r=i[u],o(r)){var c=function(){for(var t,e=[],i=0;i<r.ixs.length;i++)t=r.ixs[i],e.push(n[t.index].consume());return e}();return a=t(s.e.apply(function(){var t,e=function(){for(var t,e=[],n=0;n<c.length;n++)t=c[n],e.push(t.value());return e}();return(t=r).f.apply(t,e)})),e.length&&(e=q.filter(l,e)),a===k.noMore?a:d()}},f=function(){var e=d();return r&&(q.all(n,a)||q.all(i,s))&&(e=k.noMore,t(ut())),e===k.noMore&&c(),e};return u.subscribe(function(n){if(n.isEnd())r=!0,u.markEnded(),h();else if(n.isError())var i=t(n);else u.push(n),u.sync&&(e.push({source:u,e:n}),g||j.hasWaiters()?h():f());return i===k.noMore&&c(),i||k.more})}};return new k.CompositeUnsubscribe(function(){for(var t,e=[],i=0;i<n.length;i++)t=n[i],e.push(u(t));return e}()).unsubscribe});return v};var ft=function(t){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],n=function(t){if(q.contains(e,t))return!0;var i=t.internalDeps();return i.length?(e.push(t),q.any(i,n)):(e.push(t),!1)};return q.any(t,n)},pt=function(t){return q.isFunction(t)?t:q.always(t)};k.groupSimultaneous=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];1===e.length&&I(e[0])&&(e=e[0]);var i=function(){for(var t,n=[],i=0;i<e.length;i++)t=e[i],n.push(new l(t));return n}();return V(new k.Desc(k,"groupSimultaneous",e),k.when(i,function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}))},H(b,v),z(b.prototype,{push:function(t){return t.isEnd()&&(this.propertyEnded=!0),t.hasValue()&&(this.current=new c(t),this.currentValueRootId=j.currentEventId()),v.prototype.push.call(this,t)},maybeSubSource:function(t,e){return e===k.noMore?T:this.propertyEnded?(t(ut()),T):v.prototype.subscribe.call(this,t)},subscribe:function(t){var e=this,n=k.more;if(this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)){var i=j.currentEventId(),r=this.currentValueRootId;return!this.propertyEnded&&r&&i&&i!==r?(j.whenDoneWith(this.property,function(){return e.currentValueRootId===r?t(st(e.current.get().value())):void 0}),this.maybeSubSource(t,n)):(j.inTransaction(void 0,this,function(){return n=t(st(this.current.get().value()))},[]),this.maybeSubSource(t,n))}return this.maybeSubSource(t,n)}}),H(x,g),z(x.prototype,{_isProperty:!0,changes:function(){var t=this;return new y(new k.Desc(this,"changes",[]),function(e){return t.dispatcher.subscribe(function(t){return t.isInitial()?void 0:e(t)})})},withHandler:function(t){return new x(new k.Desc(this,"withHandler",[t]),this.dispatcher.subscribe,t)},toProperty:function(){return B(arguments),this},toEventStream:function(){var t=this;return new y(new k.Desc(this,"toEventStream",[]),function(e){return t.dispatcher.subscribe(function(t){return t.isInitial()&&(t=t.toNext()),e(t)})})}}),k.Property=x,k.constant=function(t){return new x(new k.Desc(k,"constant",[t]),function(e){return e(st(t)),e(ut()),T})},k.fromBinder=function(t){var e=arguments.length<=1||void 0===arguments[1]?q.id:arguments[1],n=new k.Desc(k,"fromBinder",[t,e]);return new y(n,function(n){var i=!1,r=!1,o=function(){return i?void 0:"undefined"!=typeof a&&null!==a?(a(),i=!0):r=!0},a=t(function(){for(var t,i=arguments.length,r=Array(i),a=0;i>a;a++)r[a]=arguments[a];var s=e.apply(this,r);I(s)&&(null!=(t=q.last(s))?t._isEvent:void 0)||(s=[s]);for(var l,u=k.more,c=0;c<s.length;c++)if(l=s[c],u=n(l=ct(l)),u===k.noMore||l.isEnd())return o(),u;return u});return r&&o(),o})},k.Observable.prototype.map=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return et(this,t,n,function(t){return V(new k.Desc(this,"map",[t]),this.withHandler(function(e){return this.push(e.fmap(t))}))})};var _t=function(t){return I(t[0])?t[0]:Array.prototype.slice.call(t)},gt=function(t){return q.isFunction(t[0])?[_t(Array.prototype.slice.call(t,1)),t[0]]:[_t(Array.prototype.slice.call(t,0,t.length-1)),q.last(t)]};k.combineAsArray=function(){for(var t,e=_t(arguments),n=0;n<e.length;n++)t=e[n],N(t)||(e[n]=k.constant(t));if(e.length){var i=function(){for(var t,n=[],i=0;i<e.length;i++)t=e[i],n.push(new a(t,!0));return n}();return V(new k.Desc(k,"combineAsArray",e),k.when(i,function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}).toProperty())}return k.constant([])},k.onValues=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return k.combineAsArray(e.slice(0,e.length-1)).onValues(e[e.length-1])},k.combineWith=function(){var t=gt(arguments),e=t[0],n=t[1],i=new k.Desc(k,"combineWith",[n].concat(e));return V(i,k.combineAsArray(e).map(function(t){return n.apply(void 0,t)}))},k.Observable.prototype.combine=function(t,e){var n=nt(e),i=new k.Desc(this,"combine",[t,e]);return V(i,k.combineAsArray(this,t).map(function(t){return n(t[0],t[1])}))},k.Observable.prototype.withStateMachine=function(t,e){var n=t,i=new k.Desc(this,"withStateMachine",[t,e]);return V(i,this.withHandler(function(t){var i=e(n,t),r=i[0],o=i[1];n=r;for(var a,s=k.more,l=0;l<o.length;l++)if(a=o[l],s=this.push(a),s===k.noMore)return s;return s}))};var mt=function(t,e){return t===e},vt=function(t){return"undefined"!=typeof t&&null!==t?t._isNone:!1};k.Observable.prototype.skipDuplicates=function(){var t=arguments.length<=0||void 0===arguments[0]?mt:arguments[0],e=new k.Desc(this,"skipDuplicates",[]);return V(e,this.withStateMachine(rt,function(e,n){return n.hasValue()?n.isInitial()||vt(e)||!t(e.get(),n.value())?[new c(n.value()),[n]]:[e,[]]:[e,[n]]}))},k.Observable.prototype.awaiting=function(t){var e=new k.Desc(this,"awaiting",[t]);return V(e,k.groupSimultaneous(this,t).map(function(t){return 0===t[1].length}).toProperty(!1).skipDuplicates())},k.Observable.prototype.not=function(){return V(new k.Desc(this,"not",[]),this.map(function(t){return!t}))},k.Property.prototype.and=function(t){return V(new k.Desc(this,"and",[t]),this.combine(t,function(t,e){return t&&e}))},k.Property.prototype.or=function(t){return V(new k.Desc(this,"or",[t]),this.combine(t,function(t,e){return t||e}))},k.scheduler={setTimeout:function(t,e){return setTimeout(t,e)},setInterval:function(t,e){return setInterval(t,e)},clearInterval:function(t){return clearInterval(t)},clearTimeout:function(t){return clearTimeout(t)},now:function(){return(new Date).getTime()}},k.EventStream.prototype.bufferWithTime=function(t){return V(new k.Desc(this,"bufferWithTime",[t]),this.bufferWithTimeOrCount(t,Number.MAX_VALUE))},k.EventStream.prototype.bufferWithCount=function(t){return V(new k.Desc(this,"bufferWithCount",[t]),this.bufferWithTimeOrCount(void 0,t))},k.EventStream.prototype.bufferWithTimeOrCount=function(t,e){var n=function(n){return n.values.length===e?n.flush():void 0!==t?n.schedule():void 0},i=new k.Desc(this,"bufferWithTimeOrCount",[t,e]);return V(i,this.buffer(t,n,n))},k.EventStream.prototype.buffer=function(t){var e=arguments.length<=1||void 0===arguments[1]?T:arguments[1],n=arguments.length<=2||void 0===arguments[2]?T:arguments[2],i={scheduled:null,end:void 0,values:[],flush:function(){if(this.scheduled&&(k.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){var t=this.values;this.values=[];var e=this.push(lt(t));if(null!=this.end)return this.push(this.end);if(e!==k.noMore)return n(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){var e=this;return this.scheduled?void 0:this.scheduled=t(function(){return e.flush()})}},r=k.more;if(!q.isFunction(t)){var o=t;t=function(t){return k.scheduler.setTimeout(t,o)}}return V(new k.Desc(this,"buffer",[]),this.withHandler(function(t){var n=this;return i.push=function(t){return n.push(t)},t.isError()?r=this.push(t):t.isEnd()?(i.end=t,i.scheduled||i.flush()):(i.values.push(t.value()),e(i)),r}))},k.Observable.prototype.filter=function(t){R(t);for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return et(this,t,n,function(t){return V(new k.Desc(this,"filter",[t]),this.withHandler(function(e){return e.filter(t)?this.push(e):k.more}))})},k.once=function(t){return new y(new u(k,"once",[t]),function(e){return e(ct(t)),e(ut()),T})},k.EventStream.prototype.concat=function(t){var e=this;return new y(new k.Desc(e,"concat",[t]),function(n){var i=T,r=e.dispatcher.subscribe(function(e){return e.isEnd()?i=t.dispatcher.subscribe(n):n(e)});return function(){return r(),i()}})},k.Observable.prototype.flatMap=function(){return xt(this,yt(arguments))},k.Observable.prototype.flatMapFirst=function(){return xt(this,yt(arguments),!0)};var yt=function(t){return 1===t.length&&N(t[0])?q.always(t[0]):K(t)},bt=function(t){return N(t)?t:k.once(t)},xt=function(t,e,n,i){var r=[t],o=[],a=new k.Desc(t,"flatMap"+(n?"First":""),[e]),s=new y(a,function(r){var a=new m,s=[],l=function(t){var n=bt(e(t.value()));return o.push(n),a.add(function(t,e){return n.dispatcher.subscribe(function(i){if(i.isEnd())return q.remove(n,o),u(),c(e),k.noMore;("undefined"!=typeof i&&null!==i?i._isInitial:void 0)&&(i=i.toNext());var a=r(i);return a===k.noMore&&t(),a})})},u=function(){var t=s.shift();return t?l(t):void 0},c=function(t){return t(),a.empty()?r(ut()):void 0};return a.add(function(e,o){return t.dispatcher.subscribe(function(t){return t.isEnd()?c(o):t.isError()?r(t):n&&a.count()>1?k.more:a.unsubscribed?k.noMore:i&&a.count()>i?s.push(t):l(t)})}),a.unsubscribe});return s.internalDeps=function(){return o.length?r.concat(o):r},s};k.Observable.prototype.flatMapWithConcurrencyLimit=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];var r=new k.Desc(this,"flatMapWithConcurrencyLimit",[t].concat(n));return V(r,xt(this,yt(n),!1,t))},k.Observable.prototype.flatMapConcat=function(){var t=new k.Desc(this,"flatMapConcat",Array.prototype.slice.call(arguments,0));return V(t,this.flatMapWithConcurrencyLimit.apply(this,[1].concat(A.call(arguments))))},k.later=function(t,e){return V(new k.Desc(k,"later",[t,e]),k.fromBinder(function(n){var i=function(){return n([e,ut()])},r=k.scheduler.setTimeout(i,t);return function(){return k.scheduler.clearTimeout(r)}}))},k.Observable.prototype.bufferingThrottle=function(t){var e=new k.Desc(this,"bufferingThrottle",[t]);return V(e,this.flatMapConcat(function(e){return k.once(e).concat(k.later(t).filter(!1))}))},k.Property.prototype.bufferingThrottle=function(){return k.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()},H(w,y),z(w.prototype,{unsubAll:function(){for(var t,e=this.subscriptions,n=0;n<e.length;n++)t=e[n],
"function"==typeof t.unsub&&t.unsub()},subscribeAll:function(t){if(this.ended)t(ut());else{this.sink=t;for(var e,n=M(this.subscriptions),i=0;i<n.length;i++)e=n[i],this.subscribeInput(e)}return this.unsubAll},guardedSink:function(t){var e=this;return function(n){return n.isEnd()?(e.unsubscribeInput(t),k.noMore):e.sink(n)}},subscribeInput:function(t){return t.unsub=t.input.dispatcher.subscribe(this.guardedSink(t.input)),t.unsub},unsubscribeInput:function(t){for(var e,n=this.subscriptions,i=0;i<n.length;i++)if(e=n[i],e.input===t)return"function"==typeof e.unsub&&e.unsub(),void this.subscriptions.splice(i,1)},plug:function(t){var e=this;if(P(t),!this.ended){var n={input:t};return this.subscriptions.push(n),"undefined"!=typeof this.sink&&this.subscribeInput(n),function(){return e.unsubscribeInput(t)}}},end:function(){return this.ended=!0,this.unsubAll(),"function"==typeof this.sink?this.sink(ut()):void 0},push:function(t){return this.ended||"function"!=typeof this.sink?void 0:this.sink(lt(t))},error:function(t){return"function"==typeof this.sink?this.sink(new _(t)):void 0}}),k.Bus=w;var wt=function(t,e){return X(function(n){for(var i=Y(e,[function(t,e){return n.apply(void 0,t.concat([e]))}]),r=arguments.length,o=Array(r>1?r-1:0),a=1;r>a;a++)o[a-1]=arguments[a];return V(new k.Desc(k,t,[n].concat(o)),k.combineAsArray(o).flatMap(i))})};k.fromCallback=wt("fromCallback",function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return k.fromBinder(function(e){return tt(t,n)(e),T},function(t){return[t,ut()]})}),k.fromNodeCallback=wt("fromNodeCallback",function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return k.fromBinder(function(e){return tt(t,n)(e),T},function(t,e){return t?[new _(t),ut()]:[e,ut()]})}),k.combineTemplate=function(t){function e(t){return t[t.length-1]}function n(t,n,i){return e(t)[n]=i,i}function i(t,e){return function(i,r){return n(i,t,r[e])}}function r(t,e){return function(i){return n(i,t,e)}}function o(t){return I(t)?[]:{}}function a(t,e){return function(i){var r=o(e);return n(i,t,r),i.push(r)}}function s(t,e){if(N(e))return h.push(e),c.push(i(t,h.length-1));if(!e||e.constructor!=Object&&e.constructor!=Array)return c.push(r(t,e));var n=function(t){return t.pop()};return c.push(a(t,e)),u(e),c.push(n)}function l(e){for(var n,i=o(t),r=[i],a=0;a<c.length;a++)(n=c[a])(r,e);return i}function u(t){return q.each(t,s)}var c=[],h=[];return u(t),V(new k.Desc(k,"combineTemplate",[t]),k.combineAsArray(h).map(l))};var St=function(t,e){var n=new y(U(t,"justInitValue"),function(e){var i=void 0,r=t.dispatcher.subscribe(function(t){return t.isEnd()||(i=t),k.noMore});return j.whenDoneWith(n,function(){return"undefined"!=typeof i&&null!==i&&e(i),e(ut())}),r});return n.concat(e).toProperty()};k.Observable.prototype.mapEnd=function(){var t=K(arguments);return V(new k.Desc(this,"mapEnd",[t]),this.withHandler(function(e){return e.isEnd()?(this.push(lt(t(e))),this.push(ut()),k.noMore):this.push(e)}))},k.Observable.prototype.skipErrors=function(){return V(new k.Desc(this,"skipErrors",[]),this.withHandler(function(t){return t.isError()?k.more:this.push(t)}))},k.EventStream.prototype.takeUntil=function(t){var e={};return V(new k.Desc(this,"takeUntil",[t]),k.groupSimultaneous(this.mapEnd(e),t.skipErrors()).withHandler(function(t){if(t.hasValue()){var n=t.value(),i=n[0],r=n[1];if(r.length)return this.push(ut());for(var o,a=k.more,s=0;s<i.length;s++)o=i[s],a=o===e?this.push(ut()):this.push(lt(o));return a}return this.push(t)}))},k.Property.prototype.takeUntil=function(t){var e=this.changes().takeUntil(t);return V(new k.Desc(this,"takeUntil",[t]),St(this,e))},k.Observable.prototype.flatMapLatest=function(){var t=yt(arguments),e=this.toEventStream();return V(new k.Desc(this,"flatMapLatest",[t]),e.flatMap(function(n){return bt(t(n)).takeUntil(e)}))},k.Property.prototype.delayChanges=function(t,e){return V(t,St(this,e(this.changes())))},k.EventStream.prototype.delay=function(t){return V(new k.Desc(this,"delay",[t]),this.flatMap(function(e){return k.later(t,e)}))},k.Property.prototype.delay=function(t){return this.delayChanges(new k.Desc(this,"delay",[t]),function(e){return e.delay(t)})},k.EventStream.prototype.debounce=function(t){return V(new k.Desc(this,"debounce",[t]),this.flatMapLatest(function(e){return k.later(t,e)}))},k.Property.prototype.debounce=function(t){return this.delayChanges(new k.Desc(this,"debounce",[t]),function(e){return e.debounce(t)})},k.EventStream.prototype.debounceImmediate=function(t){return V(new k.Desc(this,"debounceImmediate",[t]),this.flatMapFirst(function(e){return k.once(e).concat(k.later(t).filter(!1))}))},k.Observable.prototype.decode=function(t){return V(new k.Desc(this,"decode",[t]),this.combine(k.combineTemplate(t),function(t,e){return e[t]}))},k.Observable.prototype.scan=function(t,e){var n,i=this;e=nt(e);var r=ot(t),o=!1,a=function(t){var a=!1,s=T,l=k.more,u=function(){return a?void 0:r.forEach(function(e){return a=o=!0,l=t(new f(function(){return e})),l===k.noMore?(s(),s=T):void 0})};return s=i.dispatcher.subscribe(function(n){if(n.hasValue()){if(o&&n.isInitial())return k.more;n.isInitial()||u(),a=o=!0;var i=r.getOrElse(void 0),s=e(i,n.value());return r=new c(s),t(n.apply(function(){return s}))}return n.isEnd()&&(l=u()),l!==k.noMore?t(n):void 0}),j.whenDoneWith(n,u),s};return n=new x(new k.Desc(this,"scan",[t,e]),a)},k.Observable.prototype.diff=function(t,e){return e=nt(e),V(new k.Desc(this,"diff",[t,e]),this.scan([t],function(t,n){return[n,e(t[0],n)]}).filter(function(t){return 2===t.length}).map(function(t){return t[1]}))},k.Observable.prototype.doAction=function(){var t=K(arguments);return V(new k.Desc(this,"doAction",[t]),this.withHandler(function(e){return e.hasValue()&&t(e.value()),this.push(e)}))},k.Observable.prototype.doEnd=function(){var t=K(arguments);return V(new k.Desc(this,"doEnd",[t]),this.withHandler(function(e){return e.isEnd()&&t(),this.push(e)}))},k.Observable.prototype.doError=function(){var t=K(arguments);return V(new k.Desc(this,"doError",[t]),this.withHandler(function(e){return e.isError()&&t(e.error),this.push(e)}))},k.Observable.prototype.doLog=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return V(new k.Desc(this,"doLog",e),this.withHandler(function(t){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,e.concat([t.log()])),this.push(t)}))},k.Observable.prototype.endOnError=function(t){("undefined"==typeof t||null===t)&&(t=!0);for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return et(this,t,n,function(t){return V(new k.Desc(this,"endOnError",[]),this.withHandler(function(e){return e.isError()&&t(e.error)?(this.push(e),this.push(ut())):this.push(e)}))})},g.prototype.errors=function(){return V(new k.Desc(this,"errors",[]),this.filter(function(){return!1}))},k.Observable.prototype.take=function(t){return 0>=t?k.never():V(new k.Desc(this,"take",[t]),this.withHandler(function(e){return e.hasValue()?(t--,t>0?this.push(e):(0===t&&this.push(e),this.push(ut()),k.noMore)):this.push(e)}))},k.Observable.prototype.first=function(){return V(new k.Desc(this,"first",[]),this.take(1))},k.Observable.prototype.mapError=function(){var t=K(arguments);return V(new k.Desc(this,"mapError",[t]),this.withHandler(function(e){return e.isError()?this.push(lt(t(e.error))):this.push(e)}))},k.Observable.prototype.flatMapError=function(t){var e=new k.Desc(this,"flatMapError",[t]);return V(e,this.mapError(function(t){return new _(t)}).flatMap(function(e){return e instanceof _?t(e.error):k.once(e)}))},k.EventStream.prototype.sampledBy=function(t,e){return V(new k.Desc(this,"sampledBy",[t,e]),this.toProperty().sampledBy(t,e))},k.Property.prototype.sampledBy=function(t,e){var n=!1;"undefined"!=typeof e&&null!==e?e=nt(e):(n=!0,e=function(t){return t.value()});var i=new a(this,!1,n),r=new a(t,!0,n),o=k.when([i,r],e),s=t._isProperty?o.toProperty():o;return V(new k.Desc(this,"sampledBy",[t,e]),s)},k.Property.prototype.sample=function(t){return V(new k.Desc(this,"sample",[t]),this.sampledBy(k.interval(t,{})))},k.Observable.prototype.map=function(t){if(t&&t._isProperty)return t.sampledBy(this,E);for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return et(this,t,n,function(t){return V(new k.Desc(this,"map",[t]),this.withHandler(function(e){return this.push(e.fmap(t))}))})},k.Observable.prototype.fold=function(t,e){return V(new k.Desc(this,"fold",[t,e]),this.scan(t,e).sampledBy(this.filter(!1).mapEnd().toProperty()))},g.prototype.reduce=g.prototype.fold;var At=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]],kt=function(t){for(var e,n=0;n<At.length;n++){e=At[n];var i=[t[e[0]],t[e[1]]];if(i[0]&&i[1])return i}for(var r=0;r<At.length;r++){e=At[r];var o=t[e[0]];if(o)return[o,function(){}]}throw new _("No suitable event methods in "+t)};k.fromEventTarget=function(t,e,n){var i=kt(t),r=i[0],o=i[1],a=new k.Desc(k,"fromEvent",[t,e]);return V(a,k.fromBinder(function(n){return r.call(t,e,n),function(){return o.call(t,e,n)}},n))},k.fromEvent=k.fromEventTarget,k.fromPoll=function(t,e){var n=new k.Desc(k,"fromPoll",[t,e]);return V(n,k.fromBinder(function(e){var n=k.scheduler.setInterval(e,t);return function(){return k.scheduler.clearInterval(n)}},e))},k.fromPromise=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?S:arguments[2];return V(new k.Desc(k,"fromPromise",[t]),k.fromBinder(function(n){var i=t.then(n,function(t){return n(new _(t))});return i&&"function"==typeof i.done&&i.done(),e?function(){return"function"==typeof t.abort?t.abort():void 0}:function(){}},n))},k.Observable.prototype.groupBy=function(t){var e=arguments.length<=1||void 0===arguments[1]?k._.id:arguments[1],n={},i=this;return i.filter(function(e){return!n[t(e)]}).map(function(r){var o=t(r),a=i.filter(function(e){return t(e)===o}),s=k.once(r).concat(a),l=e(s,r).withHandler(function(t){return this.push(t),t.isEnd()?delete n[o]:void 0});return n[o]=l,l})},k.fromArray=function(t){if(F(t),t.length){var e=0;return new y(new k.Desc(k,"fromArray",[t]),function(n){var i=!1,r=k.more,o=!1,a=!1,s=function(){if(a=!0,!o){for(o=!0;a;)if(a=!1,r!==k.noMore&&!i){var l=t[e++];r=n(ct(l)),r!==k.noMore&&(e===t.length?n(ut()):j.afterTransaction(s))}return o=!1}};return s(),function(){return i=!0}})}return V(new k.Desc(k,"fromArray",t),k.never())},k.EventStream.prototype.holdWhen=function(t){var e=!1,n=[],i=this;return new y(new k.Desc(this,"holdWhen",[t]),function(r){var o=new m,a=!1,s=function(t){return"function"==typeof t&&t(),o.empty()&&a?r(ut()):void 0};return o.add(function(i,o){return t.subscribeInternal(function(t){if(!t.hasValue())return t.isEnd()?s(o):r(t);if(e=t.value(),!e){var i=n;return n=[],function(){for(var t,e=[],n=0;n<i.length;n++)t=i[n],e.push(r(lt(t)));return e}()}})}),o.add(function(t,o){return i.subscribeInternal(function(t){return e&&t.hasValue()?n.push(t.value()):t.isEnd()&&n.length?s(o):r(t)})}),a=!0,s(),o.unsubscribe})},k.interval=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return V(new k.Desc(k,"interval",[t,e]),k.fromPoll(t,function(){return lt(e)}))},k.$={},k.$.asEventStream=function(t,e,n){var i=this;return q.isFunction(e)&&(n=e,e=void 0),V(new k.Desc(this.selector||this,"asEventStream",[t]),k.fromBinder(function(n){return i.on(t,e,n),function(){return i.off(t,e,n)}},n))},"undefined"!=typeof jQuery&&jQuery&&(jQuery.fn.asEventStream=k.$.asEventStream),"undefined"!=typeof Zepto&&Zepto&&(Zepto.fn.asEventStream=k.$.asEventStream),k.Observable.prototype.last=function(){var t;return V(new k.Desc(this,"last",[]),this.withHandler(function(e){return e.isEnd()?(t&&this.push(t),this.push(ut()),k.noMore):void(t=e)}))},k.Observable.prototype.log=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return this.subscribe(function(t){"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,e.concat([t.log()]))}),this},k.EventStream.prototype.merge=function(t){O(t);var e=this;return V(new k.Desc(e,"merge",[t]),k.mergeAll(this,t))},k.mergeAll=function(){var t=_t(arguments);return t.length?new y(new k.Desc(k,"mergeAll",t),function(e){var n=0,i=function(i){return function(r){return i.dispatcher.subscribe(function(i){if(i.isEnd())return n++,n===t.length?e(ut()):k.more;var o=e(i);return o===k.noMore&&r(),o})}},r=q.map(i,t);return new k.CompositeUnsubscribe(r).unsubscribe}):k.never()},k.repeatedly=function(t,e){var n=0;return V(new k.Desc(k,"repeatedly",[t,e]),k.fromPoll(t,function(){return e[n++%e.length]}))},k.repeat=function(t){var e=0;return k.fromBinder(function(n){function i(t){return t.isEnd()?o?r():o=!0:a=n(t)}function r(){var r;for(o=!0;o&&a!==k.noMore;)r=t(e++),o=!1,r?s=r.subscribeInternal(i):n(ut());return o=!0}var o=!1,a=k.more,s=function(){};return r(),function(){return s()}})},k.retry=function(t){if(!q.isFunction(t.source))throw new C("'source' option has to be a function");var e=t.source,n=t.retries||0,i=t.maxRetries||n,r=t.delay||function(){return 0},o=t.isRetryable||function(){return!0},a=!1,s=null;return V(new k.Desc(k,"retry",[t]),k.repeat(function(){function t(){return e().endOnError().withHandler(function(t){return t.isError()?(s=t,o(s.error)&&n>0?void 0:(a=!0,this.push(t))):(t.hasValue()&&(s=null,a=!0),this.push(t))})}if(a)return null;if(s){var l={error:s.error,retriesDone:i-n},u=k.later(r(l)).filter(!1);return n-=1,u.concat(k.once().flatMap(t))}return t()}))},k.sequentially=function(t,e){var n=0;return V(new k.Desc(k,"sequentially",[t,e]),k.fromPoll(t,function(){var t=e[n++];return n<e.length?t:n===e.length?[t,ut()]:ut()}))},k.Observable.prototype.skip=function(t){return V(new k.Desc(this,"skip",[t]),this.withHandler(function(e){return e.hasValue()&&t>0?(t--,k.more):this.push(e)}))},k.EventStream.prototype.skipUntil=function(t){var e=t.take(1).map(!0).toProperty(!1);return V(new k.Desc(this,"skipUntil",[t]),this.filter(e))},k.EventStream.prototype.skipWhile=function(t){R(t);for(var e=!1,n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];return et(this,t,i,function(t){return V(new k.Desc(this,"skipWhile",[t]),this.withHandler(function(n){return!e&&n.hasValue()&&t(n.value())?k.more:(n.hasValue()&&(e=!0),this.push(n))}))})},k.Observable.prototype.slidingWindow=function(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return V(new k.Desc(this,"slidingWindow",[t,e]),this.scan([],function(e,n){return e.concat([n]).slice(-t)}).filter(function(t){return t.length>=e}))};var Ct=[],dt=function(t){if(Ct.length&&!dt.running)try{dt.running=!0,Ct.forEach(function(e){e(t)})}finally{delete dt.running}};k.spy=function(t){return Ct.push(t)},k.Property.prototype.startWith=function(t){return V(new k.Desc(this,"startWith",[t]),this.scan(t,function(t,e){return e}))},k.EventStream.prototype.startWith=function(t){return V(new k.Desc(this,"startWith",[t]),k.once(t).concat(this))},k.Observable.prototype.takeWhile=function(t){R(t);for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return et(this,t,n,function(t){return V(new k.Desc(this,"takeWhile",[t]),this.withHandler(function(e){return e.filter(t)?this.push(e):(this.push(ut()),k.noMore)}))})},k.EventStream.prototype.throttle=function(t){return V(new k.Desc(this,"throttle",[t]),this.bufferWithTime(t).map(function(t){return t[t.length-1]}))},k.Property.prototype.throttle=function(t){return this.delayChanges(new k.Desc(this,"throttle",[t]),function(e){return e.throttle(t)})},g.prototype.firstToPromise=function(t){var e=this;if("function"!=typeof t){if("function"!=typeof Promise)throw new C("There isn't default Promise, use shim or parameter");t=Promise}return new t(function(t,n){return e.subscribe(function(e){return e.hasValue()&&t(e.value()),e.isError()&&n(e.error),k.noMore})})},g.prototype.toPromise=function(t){return this.last().firstToPromise(t)},k["try"]=function(t){return function(e){try{return k.once(t(e))}catch(n){return new k.Error(n)}}},k.update=function(t){function e(t){return function(){for(var e=arguments.length,n=Array(e),i=0;e>i;i++)n[i]=arguments[i];return function(e){return t.apply(void 0,[e].concat(n))}}}for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];for(var o=i.length-1;o>0;)i[o]instanceof Function||(i[o]=q.always(i[o])),i[o]=e(i[o]),o-=2;return V(new k.Desc(k,"update",[t].concat(i)),k.when.apply(k,i).scan(t,function(t,e){return e(t)}))},k.zipAsArray=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];var i=_t(e);return V(new k.Desc(k,"zipAsArray",i),k.zipWith(i,function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}))},k.zipWith=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];var i=gt(e),r=i[0],o=i[1];return r=q.map(function(t){return t.toEventStream()},r),V(new k.Desc(k,"zipWith",[o].concat(r)),k.when(r,o))},k.Observable.prototype.zip=function(t,e){return V(new k.Desc(this,"zip",[t]),k.zipWith([this,t],e||Array))},null!==n(199)&&null!=n(200)?(i=[],r=function(){return k}.apply(e,i),!(void 0!==r&&(o.exports=r)),"undefined"!=typeof this&&null!==this&&(this.Bacon=k)):"undefined"!=typeof o&&null!==o&&null!=o.exports?(o.exports=k,k.Bacon=k):this.Bacon=k}).call(this)}).call(e,function(){return this}(),n(220)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e,n){function i(t,e,n,i){this.brush_sel=t.append("g").attr("id","brush-container");var r=this.brush_sel.node(),o=t.select(i).node().nextSibling;r!==o&&r.parentNode.insertBefore(r,o),this.enabled=e,this.map=n}function r(t){void 0===t&&(t=!this.enabled),t?this.selection_brush=this.setup_selection_brush():this.brush_sel.selectAll(".brush").remove()}function o(){var t=this.brush_sel,e=this.map.sel.selectAll("#nodes,#text-labels"),n=this.map.canvas.size_and_location(),i=n.width,r=n.height,o=n.x,a=n.y;t.selectAll("g").remove();var s=d3.svg.brush().x(d3.scale.identity().domain([o,o+i])).y(d3.scale.identity().domain([a,a+r])).on("brush",function(){var t,n=d3.event.sourceEvent.shiftKey,i=d3.event.target.extent();t=n?e.selectAll(".node:not(.selected),.text-label:not(.selected)"):e.selectAll(".node,.text-label"),t.classed("selected",function(t){var e=t.x,n=t.y;return i[0][0]<=e&&e<i[1][0]&&i[0][1]<=n&&n<i[1][1]})}).on("brushend",function(){d3.event.target.clear(),d3.select(this).call(d3.event.target)}),l=t.append("g").attr("class","brush").call(s);return t.selectAll(".background").classed("cursor-grab",!1).classed("cursor-grabbing",!1).style("cursor",null),l}var a=n(195),s=a.make_class();s.prototype={init:i,toggle:r,setup_selection_brush:o},t.exports=s},function(t,e,n){function i(t,e){var n=e.ignore_bootstrap||!1;t.attr("class","btn btn-default simple-button");var i=t.append("span"),r=i.append("span");"id"in e&&t.attr("id",e.id),"text"in e&&r.text(e.text),"icon"in e&&!n&&i.classed(e.icon,!0),n||r.attr("class","hidden"),"key"in e&&l(t,e.key),"key_text"in e&&"tooltip"in e&&null!==e.key_text?t.attr("title",e.tooltip+e.key_text):"tooltip"in e&&t.attr("title",e.tooltip)}function r(t,e){var n=t.append("button");i(n,e)}function o(t){var e=t.append("li").attr("class","btn-group-vertical").attr("data-toggle","buttons");return{button:function(t){var n=(t.ignore_bootstrap||!1,e.append("label"));return n.append("input").attr("type","radio"),i(n,t),this}}}function a(t){var e=t.attr("class","btn-group-vertical");return{button:function(t){var n=e.append("button");return i(n,t),this}}}function s(t,e,n){void 0===n&&(n=!1);var i=t.append("li").attr("class","dropdown");i.append("button").text(e+" ").attr("class","btn btn-link btn-sm dropdown-button").attr("data-toggle","dropdown").append("b").attr("class","caret");var r=i.append("ul").attr("class","dropdown-menu").classed("pull-right",n).attr("role","menu").attr("aria-labelledby","dLabel");return{dropdown:i,button:function(t){var e=r.append("li").attr("role","presentation").datum(t),n=e.append("a").attr("href","#"),i=n.append("span").attr("class","dropdown-button-icon"),o=n.append("span").attr("class","dropdown-button-text");if("id"in t&&e.attr("id",t.id),"key_text"in t&&"text"in t&&null!==t.key_text?o.text(" "+t.text+t.key_text):"text"in t&&o.text(" "+t.text),"icon"in t&&i.classed(t.icon,!0),"key"in t)l(n,t.key);else if("input"in t){var a=t.input,s=a.accept_csv?c(n,e,a.pre_fn,a.fn,a.failure_fn):u(n,e,a.pre_fn,a.fn,a.failure_fn);"assign"in a&&"key"in a&&(a.assign[a.key]=s)}return this},divider:function(){return r.append("li").attr("role","presentation").attr("class","divider"),this}}}function l(t,e){t.on("click",function(){e.fn.call(e.target)})}function u(t,e,n,i,r){var o=e.append("input").attr("type","file").style("display","none").on("change",function(){h.load_json(this.files[0],function(t,e){i(t,e),this.value=""}.bind(this),n,r)});return t.on("click",function(t){o.node().click()}),function(){o.node().click()}}function c(t,e,n,i,r){var o=e.append("input").attr("type","file").style("display","none").on("change",function(){h.load_json_or_csv(this.files[0],d.csv_converter,function(t,e){i(t,e),this.value=""}.bind(this),n,r)});return t.on("click",function(t){o.node().click()}),function(){o.node().click()}}var h=n(195),d=n(206);t.exports={individual_button:r,radio_button_group:o,button_group:a,dropdown_menu:s,set_json_input_button:u,set_json_or_csv_input_button:c}},function(t,e,n){function i(t,e,n){var i=t.attr("class","search-container").style("display","none");this.input=i.append("input").attr("class","search-bar");var o=i.append("div").attr("class","btn-group btn-group-sm");o.append("button").attr("class","btn btn-default").on("click",this.previous.bind(this)).append("span").attr("class","glyphicon glyphicon-chevron-left"),o.append("button").attr("class","btn btn-default").on("click",this.next.bind(this)).append("span").attr("class","glyphicon glyphicon-chevron-right"),this.counter=i.append("div").attr("class","search-counter"),i.append("button").attr("class","btn btn-sm btn-default close-button").on("click",function(){this.toggle(!1)}.bind(this)).append("span").attr("class","glyphicon glyphicon-remove"),this.callback_manager=new h,this.selection=i,this.map=n,this.search_index=e,this.current=1,this.results=null;var a=function(t){this.current=1,this.results=r(this.search_index.find(t.value)),this.update()}.bind(this,this.input.node());this.input.on("input",c.debounce(a,200))}function r(t){return d.uniq(t,function(t){var e=p[t.type];return e[0]+t[e[1]]})}function o(){return"none"!==this.selection.style("display")}function a(t){void 0===t?this.is_active=!this.is_active:this.is_active=t,this.is_active?(this.selection.style("display",null),this.counter.text(""),this.input.node().value="",this.input.node().focus(),this.clear_escape=this.map.key_manager.add_escape_listener(function(){this.toggle(!1)}.bind(this),!0),this.clear_next=this.map.key_manager.add_key_listener(["enter","ctrl+g"],function(){this.next()}.bind(this),!1),this.clear_previous=this.map.key_manager.add_key_listener(["shift+enter","shift+ctrl+g"],function(){this.previous()}.bind(this),!1),this.callback_manager.run("show")):(this.map.highlight(null),this.selection.style("display","none"),this.results=null,this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.clear_next&&this.clear_next(),this.clear_next=null,this.clear_previous&&this.clear_previous(),this.clear_previous=null,this.callback_manager.run("hide"))}function s(){if(null===this.results)this.counter.text(""),this.map.highlight(null);else if(0===this.results.length)this.counter.text("0 / 0"),this.map.highlight(null);else{this.counter.text(this.current+" / "+this.results.length);var t=this.results[this.current-1];if("reaction"==t.type)this.map.zoom_to_reaction(t.reaction_id),this.map.highlight_reaction(t.reaction_id);else if("metabolite"==t.type)this.map.zoom_to_node(t.node_id),this.map.highlight_node(t.node_id);else{if("text_label"!=t.type)throw new Error("Bad search index data type: "+t.type);this.map.zoom_to_text_label(t.text_label_id),this.map.highlight_text_label(t.text_label_id)}}}function l(){null!==this.results&&(this.current===this.results.length?this.current=1:this.current+=1,this.update())}function u(){null!==this.results&&(1===this.current?this.current=this.results.length:this.current-=1,this.update())}var c=n(195),h=n(208),d=n(197),f=c.make_class();f.prototype={init:i,is_visible:o,toggle:a,update:s,next:l,previous:u},t.exports=f;var p={metabolite:["m","node_id"],reaction:["r","reaction_id"],text_label:["t","text_label_id"]}},function(t,e,n){function i(t,e,n){this.set_option=t,this.get_option=e,this.status_bus=new d.Bus,this.force_update_bus=new d.Bus,d.Observable.prototype.convert_to_conditional_stream=r,d.Observable.prototype.force_update_with_bus=o,this.busses={},this.streams={};for(var i=0,s=n.length;s>i;i++){var l=n[i],u=a(l,e(l),t,this.status_bus,this.force_update_bus);this.busses[l]=u.bus,this.streams[l]=u.stream}}function r(t){var e=t.map(function(t){return"hold"==t}).not().toProperty(!0),n=t.scan(!1,function(t,e){return 0==t&&("accepted"==e||"rejected"==e)}).not(),i=t.scan(!1,function(t,e){return 0==t&&"hold"==e}).not(),r=d.combineAsArray(this,t),o=r.scan([],function(t,e){if("hold"==e[1])return t.push(e[0]),t;if("accept"==e[1])return t;if("reject"==e[1])return[];if("rejected"==e[1]||"accepted"==e[1])return[e[0]];throw Error("bad status "+e[1])}).filter(e).filter(n).filter(i).flatMap(function(t){return d.fromArray(t)}),a=this.filter(e);return a.merge(o)}function o(t){return d.combineAsArray(this,t.toProperty(!1)).map(function(t){return t[0]})}function a(t,e,n,i,r){var o=new d.Bus,a=o.convert_to_conditional_stream(i).force_update_with_bus(r);return a.onValue(function(e){n(t,e)}),o.push(e),{bus:o,stream:a}}function s(t,e){if(!(t in this.busses))throw new Error("Invalid setting name");this.busses[t].push(e)}function l(){this.status_bus.push("hold")}function u(){this.status_bus.push("reject"),this.status_bus.push("rejected"),this.force_update_bus.push(!0)}function c(){this.status_bus.push("accept"),this.status_bus.push("accepted")}var h=n(195),d=n(219),f=h.make_class();f.prototype={init:i,set_conditional:s,hold_changes:l,abandon_changes:u,accept_changes:c},t.exports=f},function(t,e,n){"strict mode";function i(t,e,n,i){this.sel=t,this.settings=e,this.draw=!1;var r=this.settings.get_option("unique_map_id");this.unique_string=null===r?"":"."+r;var o=t.append("div").attr("class","settings-box-background").style("display","none"),a=o.append("div").attr("class","settings-box-container").style("display","none");a.append("button").attr("class","btn btn-sm btn-default settings-button").on("click",function(){this.accept_changes()}.bind(this)).append("span").attr("class","glyphicon glyphicon-ok"),a.append("button").attr("class","btn btn-sm btn-default settings-button settings-button-close").on("click",function(){this.abandon_changes()}.bind(this)).append("span").attr("class","glyphicon glyphicon-remove");var s=a.append("div").attr("class","settings-box");s.append("div").text("Tip: Hover over an option to see more details about it.").classed("settings-tip",!0),s.append("hr"),s.append("div").text("View and build options").attr("class","settings-section-heading-large"),this.view_gui(s.append("div")),s.append("hr"),s.append("div").text("Reactions").attr("class","settings-section-heading-large");var l=new f(s.append("div"),"reaction",this.settings,n.get_data_statistics.bind(n));n.callback_manager.set("calc_data_stats__reaction",function(t){t&&(l.update(),l.update_no_data())}),s.append("div").text("Reaction or Gene data").attr("class","settings-section-heading"),this.style_gui(s.append("div"),"reaction",function(t){i&&(i("reaction",t),l.update(),l.update_no_data())}),s.append("hr"),s.append("div").text("Metabolites").attr("class","settings-section-heading-large");var u=new f(s.append("div"),"metabolite",this.settings,n.get_data_statistics.bind(n));n.callback_manager.set("calc_data_stats__metabolite",function(t){t&&(u.update(),u.update_no_data())}),s.append("div").text("Metabolite data").attr("class","settings-section-heading"),this.style_gui(s.append("div"),"metabolite",function(t){i&&(i("metabolite",t),u.update(),u.update_no_data())}),this.callback_manager=new d,this.map=n,this.selection=a,this.background=o}function r(){return"none"!=this.selection.style("display")}function o(t){void 0===t&&(t=!this.is_visible()),t?(this.hold_changes(),this.selection.style("display","inline-block"),this.background.style("display","block"),this.selection.select("input").node().focus(),this.clear_escape=this.map.key_manager.add_escape_listener(function(){this.abandon_changes()}.bind(this),!0),this.clear_enter=this.map.key_manager.add_enter_listener(function(){this.accept_changes()}.bind(this),!0),this.callback_manager.run("show")):(this.draw&&this.map.draw_everything(),this.selection.style("display","none"),this.background.style("display","none"),this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.clear_enter&&this.clear_enter(),this.clear_enter=null,this.callback_manager.run("hide"))}function a(){this.settings.hold_changes()}function s(){this.draw=!1,this.settings.abandon_changes(),this.toggle(!1)}function l(){this.sel.selectAll("input").each(function(t){this.blur()}),this.draw=!0,this.settings.accept_changes(),this.toggle(!1)}function u(t,e,n){var i=t.append("table").attr("class","settings-table"),r=this.settings;if(i.append("tr").call(function(t){t.append("td").text("Options:").attr("class","options-label").attr("title","Options for "+e+" data.");var i=t.append("td"),o=[["Absolute value","abs","If checked, use the absolute value when calculating colors and sizes of "+e+"s on the map"],["Size","size","If checked, then size the "+("metabolite"==e?"radius of metabolite circles ":"thickness of reaction lines ")+"according to the value of the "+e+" data"],["Color","color","If checked, then color the "+("metabolite"==e?"metabolite circles ":"reaction lines ")+"according to the value of the "+e+" data"],["Text (Show data in label)","text","If checked, then show data values in the "+e+" labels"]],a=i.selectAll(".option-group").data(o),s=a.enter().append("label").attr("class","option-group"),l=function(){var t=[];return i.selectAll("input").each(function(e){this.checked&&t.push(e[1])}),t};s.append("input").attr("type","checkbox").on("change",function(t){r.set_conditional(e+"_styles",l()),"abs"==t[1]&&n(this.checked)}).each(function(t){r.streams[e+"_styles"].onValue(function(e){this.checked=-1!=e.indexOf(t[1])}.bind(this))}),s.append("span").text(function(t){return t[0]}).attr("title",function(t){return t[2]})}),i.append("tr").call(function(t){t.append("td").text("Comparison:").attr("class","options-label").attr("title","The function that will be used to compare datasets, when paired data is loaded");var n=t.append("td").attr("title","The function that will be used to compare datasets, when paired data is loaded"),i=[["Fold Change","fold"],["Log2(Fold Change)","log2_fold"],["Difference","diff"]],o=n.selectAll(".option-group").data(i),a=o.enter().append("label").attr("class","option-group");a.append("input").attr("type","radio").attr("name",e+"_compare_style"+this.unique_string).attr("value",function(t){return t[1]}).on("change",function(){this.checked&&r.set_conditional(e+"_compare_style",this.value)}).each(function(){r.streams[e+"_compare_style"].onValue(function(t){this.checked=this.value==t}.bind(this))}),a.append("span").text(function(t){return t[0]})}.bind(this)),"reaction"==e){var i=t.append("table").attr("class","settings-table").attr("title","The function that will be used to evaluate AND connections in gene reaction rules (AND connections generally connect components of an enzyme complex)");i.append("tr").call(function(t){t.append("td").text("Method for evaluating AND:").attr("class","options-label-wide");var e=t.append("td"),n=[["Mean","mean"],["Min","min"]],i=e.selectAll(".option-group").data(n),o=i.enter().append("label").attr("class","option-group"),a="and_method_in_gene_reaction_rule";
o.append("input").attr("type","radio").attr("name",a+this.unique_string).attr("value",function(t){return t[1]}).on("change",function(){this.checked&&r.set_conditional(a,this.value)}).each(function(){r.streams[a].onValue(function(t){this.checked=this.value==t}.bind(this))}),o.append("span").text(function(t){return t[0]})}.bind(this))}}function c(t,e,n,i){var r=this.settings,o=t.append("table").attr("class","settings-table");o.append("tr").call(function(t){t.attr("title","The identifiers that are show in the reaction, gene, and metabolite labels on the map."),t.append("td").text("Identifiers:").attr("class","options-label");var e=t.append("td"),n=[["ID's","bigg_id"],["Descriptive names","name"]],i=e.selectAll(".option-group").data(n),o=i.enter().append("label").attr("class","option-group"),a="identifiers_on_map";o.append("input").attr("type","radio").attr("name",a+this.unique_string).attr("value",function(t){return t[1]}).on("change",function(){this.checked&&r.set_conditional(a,this.value)}).each(function(){r.streams[a].onValue(function(t){this.checked=this.value==t}.bind(this))}),o.append("span").text(function(t){return t[0]})}.bind(this));var a=[["scroll_behavior","Scroll to zoom (instead of scroll to pan)","If checked, then the scroll wheel and trackpad will control zoom rather than pan.",{zoom:!0,pan:!1}],["hide_secondary_metabolites","Hide secondary metabolites","If checked, then only the primary metabolites will be displayed."],["show_gene_reaction_rules","Show gene reaction rules","If checked, then gene reaction rules will be displayed below each reaction label. (Gene reaction rules are always shown when gene data is loaded.)"],["hide_all_labels","Hide reaction, gene, and metabolite labels","If checked, hide all reaction, gene, and metabolite labels"],["allow_building_duplicate_reactions","Allow duplicate reactions","If checked, then allow duplicate reactions during model building."],["highlight_missing","Highlight reactions not in model","If checked, then highlight in red all the reactions on the map that are not present in the loaded model."]],s=t.append("div").attr("class","settings-container").selectAll(".option-group").data(a),l=s.enter().append("label").attr("class","option-group full-line");l.append("input").attr("type","checkbox"),l.append("span"),s.attr("title",function(t){return t[2]}),s.select("input").on("change",function(t){if(t.length>=4){for(var e in t[3])if(t[3][e]==this.checked){r.set_conditional(t[0],e);break}}else r.set_conditional(t[0],this.checked)}).each(function(t){r.streams[t[0]].onValue(function(e){t.length>=4?this.checked=t[3][e]:this.checked=e}.bind(this))}),s.select("span").text(function(t){return t[1]}),s.exit().remove(),t.append("div").style("margin-top","16px").classed("settings-tip",!0).text("Tip: To increase map performance, turn off text boxes (i.e. labels and gene reaction rules).")}var h=n(195),d=n(208),f=n(226),p=h.make_class();p.prototype={init:i,is_visible:r,toggle:o,hold_changes:a,abandon_changes:s,accept_changes:l,style_gui:u,view_gui:c},t.exports=p},function(t,e,n){function i(t,e,n,i){var r="grad"+e+this.unique_string;this.w=400,this.h=30,this.x=20,this.input_width=90,this.input_height=24;var o=t.append("div").attr("class","scale-editor");this.data_not_loaded=o.append("div").attr("class","data-not-loaded").text(("reaction"==e?"Reaction and gene":"Metabolite")+" data not loaded"),this.input_label_group=o.append("div").attr("class","input-label-group");var a=o.append("div").style("top",3*this.input_height+56+10+"px").attr("class","no-data");a.append("span").text("Styles for "+e+"s with no data").attr("class","no-data-heading"),this.no_data_container=a.append("div");var s=o.append("div").attr("class","centered");this.add_group=s.append("div"),this.trash_group=s.append("div").attr("class","trash-container");var l=s.append("svg").attr("class","scale-svg");this.input_group=s.append("div").attr("class","input-container"),this.gradient=l.append("defs").append("linearGradient").attr("id",r),l.append("rect").attr("class","rect").attr("fill","url(#"+r+")").attr("width",this.w+"px").attr("height",this.h+"px").attr("x",this.x+"px"),this.pickers_group=l.append("g"),this.type=e,this.settings=n,this.get_data_statistics=i;var u=this.settings.get_option("unique_map_id");this.unique_string=null===u?"":"."+u,this.no_data={},["color","size"].forEach(function(t){this.no_data[t]=null,this.settings.streams[this.type+"_no_data_"+t].onValue(function(e){this.no_data[t]=e,this.update_no_data()}.bind(this))}.bind(this)),this.settings.streams[e+"_scale"].onValue(function(t){this.scale=t,this.update()}.bind(this))}function r(){var t=this.scale,e=this.get_data_statistics()[this.type],n=14,i=35,r=this.x,o=this._data_not_loaded();o&&(t=[{type:"min",color:null,size:null},{type:"max",color:null,size:null}],e={min:0,max:1});var a=d3.scale.linear().domain([0,this.w]).range([e.min,e.max]),s=d3.scale.linear().domain([0,this.w]).range([0,e.max-e.min]),l=function(t,e){this.input_group.selectAll(".input-set").each(function(e){d3.select(this).classed("selected-set",t===e)})}.bind(this),u=function(t){return"value"==t.type?t.value:e[t.type]},c=function(t){this.settings.set_conditional(this.type+"_scale",t),this.scale=t,this.update()}.bind(this),h=t.map(function(t){return{frac:(u(t)-e.min)/(e.max-e.min),color:t.color}}).filter(function(t){return t.frac>=0&&t.frac<=1}).sort(function(t,e){return t.frac-e.frac}),d=this.gradient.selectAll("stop").data(h);d.enter().append("stop"),d.attr("offset",function(t){return 100*t.frac+"%"}).style("stop-color",function(t){return null===t.color?"#F1ECFA":t.color}),d.exit().remove(),this.data_not_loaded.style("visibility",o?null:"hidden");var f=this.pickers_group.selectAll(".picker").data(t),p=d3.behavior.drag();p.on("drag",function(i,r){-1===["value","min","max"].indexOf(t[r].type)&&(t[r].value=u(i),t[r].type="value");var o=t[r].value+s(d3.event.dx),a=s(n+2);o>e.max-a&&(o=e.max-a),o<e.min+a&&(o=e.min+a),o=Math.floor(100*o)/100,t[r].value=o,this.settings.set_conditional(this.type+"_scale",t),this.scale=t,this.update()}.bind(this)),f.enter().append("g").attr("class","picker").style("cursor","pointer").append("rect"),f.select("rect").attr("x",function(t,i){var o=u(t),s=n+2;return"value"==t.type&&o<=e.min?a.invert(e.min)-n/2+r-s:"value"==t.type&&o>=e.max?a.invert(e.max)-n/2+r+s:a.invert(o)-n/2+r}).attr("width",n+"px").attr("height",i+"px").call(p).on("mousedown",l),f.exit().remove();var _=this.trash_group.selectAll("span").data(t);_.enter().append("span"),_.attr("class",function(t,e){return"min"==t.type||"max"==t.type?null:"trash glyphicon glyphicon-trash"}).style("left",function(t){return a.invert(u(t))-n/2+r+"px"}).on("click",function(e,n){"min"!=e.type&&"max"!=e.type&&(t=t.slice(0,n).concat(t.slice(n+1)),this.settings.set_conditional(this.type+"_scale",t),this.scale=t,this.update())}.bind(this)),_.exit().remove();var g=this.add_group.selectAll(".add").data(["add"]);g.enter().append("span").attr("class","add glyphicon glyphicon-plus"),g.on("click",function(i){if(!o){for(var r=(e.max+e.min)/2,a=s(n+2),l=0,h=0,d=t.length;d>h;h++){var f=u(t[h]);Math.abs(f-r)<a&&(r+=a,r>e.max-a&&(r=e.max-a),r<e.min+a&&(r=e.min+a)),r>f&&(l=h)}t.push({type:"value",value:r,color:t[l].color,size:t[l].size}),c(t)}}.bind(this)),g.exit().remove();var m=this.input_label_group.selectAll(".row-label").data(["Value:","Color:","Size:"]);m.enter().append("div").attr("class","row-label").style("height",this.input_height+"px").style("line-height",this.input_height+"px"),m.style("top",function(t,e){return 56+e*this.input_height+"px"}.bind(this)).text(function(t){return t}),m.exit().remove();var v=this.input_group.selectAll(".input-set").data(t),y=v.enter().append("div").attr("class","input-set");y.append("input").attr("class","domain-input").style("width",this.input_width+"px"),y.append("select").attr("class","domain-type-picker"),y.append("input").attr("class","color-input").style("width",this.input_width+"px"),y.append("input").attr("type","color").style("visibility",function(){return"text"==this.type?"hidden":null}).attr("class","color-picker"),y.append("input").attr("class","size-input").style("width",this.input_width+"px"),v.style("height",3*this.input_height+"px").style("width",this.input_width+"px").style("left",function(t){var i,o=u(t),s=n+2;return i="value"==t.type&&o<=e.min?a.invert(e.min)-n/2+r-s:"value"==t.type&&o>=e.max?a.invert(e.max)-n/2+r+s:a.invert(o)-n/2+r,i+this.input_width>this.w+this.x&&(i=i-this.input_width+n/2),i+"px"}.bind(this)).on("mousedown",l);var b=d3.format(".4g");v.select(".domain-input").style("height",this.input_height+"px").each(function(t,e){"value"==t.type?(this.value=u(t),this.disabled=!1):(this.value=t.type+" ("+b(u(t))+")",this.disabled=!0)}).on("change",function(e,i){var r=(s(n+2),parseFloat(this.value));t[i].value=r,c(t)});var x=v.select(".domain-type-picker"),w=["value"].concat(Object.keys(e)).filter(function(t){return"min"!=t&&"max"!=t}),S=x.selectAll("option").data(w);S.enter().append("option"),S.attr("value",function(t){return t}).text(function(t){return t}),S.exit().remove(),x.style("visibility",function(t){return"min"==t.type||"max"==t.type?"hidden":null}).style("left",this.input_width-20+"px").style("width","20px").each(function(t,e){var n=0;d3.select(this).selectAll("option").each(function(e,i){this.value==t.type&&(n=i)}),this.selectedIndex=n}).on("change",function(n,i){"value"==this.value&&(t[i].value=e[n.type]),t[i].type=this.value,c(t)}),v.select(".color-input").style("height",this.input_height+"px").style("top",this.input_height+"px").each(function(t,e){this.value=null===t.color?"":t.color,this.disabled=null===t.color}).on("change",function(e,n){t[n].color=this.value,c(t)}),v.select(".color-picker").style("left",this.input_width-this.input_height+"px").style("top",this.input_height+"px").style("width",this.input_height+"px").style("height",this.input_height+"px").each(function(t,e){this.value=null===t.color?"#dddddd":t.color,this.disabled=null===t.color}).on("change",function(e,n){t[n].color=this.value,c(t)}),v.select(".size-input").style("height",this.input_height+"px").style("top",2*this.input_height+"px").each(function(t,e){this.value=null===t.size?"":t.size,this.disabled=null===t.size}).on("change",function(e,n){t[n].size=parseFloat(this.value),c(t)}),v.exit().remove()}function o(){var t=this.no_data,e=this._data_not_loaded(),n=40,i=this.no_data_container.selectAll(".input-group").data([["color","Color:"],["size","Size:"]]),r=i.enter().append("div").attr("class","input-group");r.append("span"),r.append("input"),r.append("input").attr("type","color").style("visibility",function(t){return"text"==this.type||"color"!=t[0]?"hidden":null}).attr("class","color-picker"),i.select("span").text(function(t){return t[1]}).style("height",this.input_height+"px").style("line-height",this.input_height+"px").style("left",function(t,e){return(n+this.input_width+10)*e+"px"}.bind(this));(function(t){return this.settings.get_option(this.type+"_no_data_"+t)}).bind(this);i.select("input").style("left",function(t,e){return n+(n+this.input_width+10)*e+"px"}.bind(this)).style("height",this.input_height+"px").style("width",this.input_width+"px").each(function(n){this.value=e?"":t[n[0]],this.disabled=e}).on("change",function(t){var e=d3.event.target.value;"size"==t[0]&&(e=parseFloat(e)),this.no_data[t[0]]=e,this.settings.set_conditional(this.type+"_no_data_"+t[0],e),this.update_no_data()}.bind(this)),i.select(".color-picker").style("left",function(t,e){return(n+this.input_width)*(e+1)-this.input_height+"px"}.bind(this)).style("width",this.input_height+"px").style("height",this.input_height+"px").each(function(n,i){this.value=e?"#dddddd":t[n[0]],this.disabled=e}).on("change",function(t,e){var n=d3.event.target.value;this.no_data[t[0]]=n,this.settings.set_conditional(this.type+"_no_data_"+t[0],n),this.update_no_data()}.bind(this)),i.exit().remove()}function a(){var t=this.get_data_statistics()[this.type];return null===t.max||null===t.min}var s=n(195),l=(n(219),s.make_class());l.prototype={init:i,update:r,update_no_data:o,_data_not_loaded:a},t.exports=l},function(t,e,n){function i(t,e,n){var i=t.append("div").attr("id","text-edit-input");this.placed_div=d(i,e),this.placed_div.hide(),this.input=i.append("input"),this.map=e,this.setup_map_callbacks(e),this.zoom_container=n,this.setup_zoom_callbacks(n)}function r(t){t.callback_manager.set("edit_text_label.text_edit_input",function(t,e){this.show(t,e)}.bind(this)),t.callback_manager.set("new_text_label.text_edit_input",function(t){null!==this.active_target&&this._accept_changes(this.active_target.target),this.hide(),this._add_and_edit(t)}.bind(this)),t.callback_manager.set("hide_text_label_editor.text_edit_input",function(){this.hide()}.bind(this))}function o(t){t.callback_manager.set("zoom.text_edit_input",function(){this.active_target&&this._accept_changes(this.active_target.target),this.hide()}.bind(this)),t.callback_manager.set("go_to.text_edit_input",function(){this.active_target&&this._accept_changes(this.active_target.target),this.hide()}.bind(this))}function a(){return this.placed_div.is_visible()}function s(t,e){this.active_target&&this._accept_changes(this.active_target.target),this.active_target={target:t,coords:e},t.each(function(t){this.input.node().value=t.text}.bind(this)),this.placed_div.place(e),this.input.node().focus(),this.clear_escape=this.map.key_manager.add_escape_listener(function(){this._accept_changes(t),this.hide()}.bind(this),!0),this.clear_enter=this.map.key_manager.add_enter_listener(function(t){this._accept_changes(t),this.hide()}.bind(this,t),!0)}function l(){this.placed_div.hide(),this.input.attr("value",""),this.active_target=null,this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.clear_enter&&this.clear_enter(),this.clear_enter=null}function u(t){if(""==this.input.node().value)t.each(function(t){var e={};e[t.text_label_id]=this.map.text_labels[t.text_label_id],this.map.delete_selectable({},e,!0)}.bind(this));else{var e=[];t.each(function(t){this.map.edit_text_label(t.text_label_id,this.input.node().value,!0),e.push(t.text_label_id)}.bind(this))}}function c(t){var e=this.map.new_text_label(t,""),n=this.map.sel.select("#text-labels").selectAll(".text-label").filter(function(t){return t.text_label_id==e});n.select("text").classed("edit-text-cursor",!0),this.show(n,t)}var h=n(195),d=n(202),f=(n(212),h.make_class());f.prototype={init:i,setup_map_callbacks:r,setup_zoom_callbacks:o,is_visible:a,show:s,hide:l,_accept_changes:u,_add_and_edit:c},t.exports=f},function(t,e,n){function i(t,e){var n=t.append("select").attr("id","quick-jump-menu").attr("class","form-control");this.selector=n;var i=a.parse_url_components(window),r="map_name"in i?i.map_name:null,o="quick_jump_path"in i?i.quick_jump_path:null,s="quick_jump"in i?i.quick_jump:[],l="— Jump to map —",u=[l].concat(s);null!==r&&(u=u.filter(function(t){return t!=r})),n.selectAll("option").data(u).enter().append("option").text(function(t){return t.split(".").slice(-1)[0]}),n.style("display",u.length>1?"block":"none");var c=function(t){e(t,o,function(e){e?this.replace_state_for_map_name(t):this.reset_selection()}.bind(this))}.bind(this);n.on("change",function(){var t=this.options[this.selectedIndex].__data__;c(t)})}function r(){this.selector.node().selectedIndex=0}function o(t){var e=window.location.href.replace(/(map_name=)([^&]+)(&|$)/,"$1"+t+"$3");window.history.replaceState("Not implemented","",e)}var a=n(195),s=a.make_class();s.prototype={init:i,reset_selection:r,replace_state_for_map_name:o},t.exports=s},function(t,e,n){var i=n(195);t.exports=function(t){function e(t,e,i,o,a){i.node().addEventListener("change",function(){n(t,this.value,a,o)},!1);var s=e[0];r(e,i),n(t,s,a,o)}function n(t,e,n,r){i.load_the_file(t,e,function(t,e){return t?console.warn(t):(o.data=e,void(r&&r(e)))})}function r(t,e){e.selectAll(".menu-option").data(t).enter().append("option").attr("value",function(t){return t}).text(function(t){return t}),e.node().focus()}var o=i.set_options(t,{selection:null,getdatafiles:null,datafiles:null,update_callback:null,target:null});if(null===o.selection)throw new Error("No selection provided for DataMenu");var a=o.selection.select(".data-menu");a.empty()&&(a=o.selection.append("div").attr("class","data-menu"));var s=a.append("form").append("select").attr("class","dropdown-menu");return o.getdatafiles?(o.datafiles&&console.warn("DataMenu: getdatafiles option overrides datafiles"),d3.json(o.getdatafiles,function(t,n){return t?console.warn(t):(e(o.target,n.data,s,o.update_callback,o.selection),null)})):o.datafiles?e(o.target,o.datafiles,s,o.update_callback,o.selection):console.warn("DataMenu: No datafiles given"),{update:r}}},function(t,e,n){function i(t,e,n,i,a){var s=o.parse_url_components(window,i),l=function(t){t(null)},u=function(t){t(null)};if(s.map_name){var c=r("map",s.map_name,n,t);c&&(l=function(t){d3.json(c,function(e,n){e&&console.warn(e),t(n)})})}if(s.model_name){var h=r("model",s.model_name,n,e);h&&(u=function(t){d3.json(h,function(e,n){e&&console.warn(e),t(n)})})}s.hasOwnProperty("enable_editing")&&(i.enable_editing="true"===s.enable_editing.toLowerCase()),l(function(t){u(function(e){a(t,e,i)})})}function r(t,e,n,i){var r=n[t+"s"].filter(function(n){return n[t+"_name"]==e});if(0==r.length)throw new Error("Bad "+t+" "+e);return i+encodeURIComponent(r[0].organism)+"/"+encodeURIComponent(r[0][t+"_name"])+".json"}var o=n(195);t.exports={load_map_model_from_url:i}},function(t,e,n){var i,r;!function(){function o(t){return t&&(t.ownerDocument||t.document||t).documentElement}function a(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function s(t,e){return e>t?-1:t>e?1:t>=e?0:NaN}function l(t){return null===t?NaN:+t}function u(t){return!isNaN(t)}function c(t){return{left:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);r>i;){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);r>i;){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}}function h(t){return t.length}function d(t){for(var e=1;t*e%1;)e*=10;return e}function f(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function p(){this._=Object.create(null)}function _(t){return(t+="")===Ca||t[0]===Ta?Ta+t:t}function g(t){return(t+="")[0]===Ta?t.slice(1):t}function m(t){return _(t)in this._}function v(t){return(t=_(t))in this._&&delete this._[t]}function y(){var t=[];for(var e in this._)t.push(g(e));return t}function b(){var t=0;for(var e in this._)++t;return t}function x(){for(var t in this._)return!1;return!0}function w(){this._=Object.create(null)}function S(t){return t}function A(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function k(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,i=Ea.length;i>n;++n){var r=Ea[n]+e;if(r in t)return r}}function C(){}function T(){}function E(t){function e(){for(var e,i=n,r=-1,o=i.length;++r<o;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],i=new p;return e.on=function(e,r){var o,a=i.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},e}function M(){fa.event.preventDefault()}function L(){for(var t,e=fa.event;t=e.sourceEvent;)e=t;return e}function R(t){for(var e=new T,n=0,i=arguments.length;++n<i;)e[arguments[n]]=E(e);return e.of=function(n,i){return function(r){try{var o=r.sourceEvent=fa.event;r.target=t,fa.event=r,e[r.type].apply(n,i)}finally{fa.event=o}}},e}function O(t){return La(t,Da),t}function P(t){return"function"==typeof t?t:function(){return Ra(t,this)}}function D(t){return"function"==typeof t?t:function(){return Oa(t,this)}}function I(t,e){function n(){this.removeAttribute(t)}function i(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function a(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=fa.ns.qualify(t),null==e?t.local?i:n:"function"==typeof e?t.local?s:a:t.local?o:r}function N(t){return t.trim().replace(/\s+/g," ")}function F(t){return new RegExp("(?:^|\\s+)"+fa.requote(t)+"(?:\\s+|$)","g")}function B(t){return(t+"").trim().split(/^|\s+/)}function z(t,e){function n(){for(var n=-1;++n<r;)t[n](this,e)}function i(){for(var n=-1,i=e.apply(this,arguments);++n<r;)t[n](this,i)}t=B(t).map(H);var r=t.length;return"function"==typeof e?i:n}function H(t){var e=F(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",N(r+" "+t))):n.setAttribute("class",N(r.replace(e," ")))}}function q(t,e,n){function i(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,n)}function o(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}return null==e?i:"function"==typeof e?o:r}function G(t,e){function n(){delete this[t]}function i(){this[t]=e}function r(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?r:i}function j(t){function e(){var e=this.ownerDocument,n=this.namespaceURI;return n&&n!==e.documentElement.namespaceURI?e.createElementNS(n,t):e.createElement(t)}function n(){return this.ownerDocument.createElementNS(t.space,t.local)}return"function"==typeof t?t:(t=fa.ns.qualify(t)).local?n:e}function U(){var t=this.parentNode;t&&t.removeChild(this)}function V(t){return{__data__:t}}function W(t){return function(){return Pa(this,t)}}function X(t){return arguments.length||(t=s),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function K(t,e){for(var n=0,i=t.length;i>n;n++)for(var r,o=t[n],a=0,s=o.length;s>a;a++)(r=o[a])&&e(r,a,n);return t}function Y(t){return La(t,Na),t}function Z(t){var e,n;return function(i,r,o){var a,s=t[o].update,l=s.length;for(o!=n&&(n=o,e=0),r>=e&&(e=r+1);!(a=s[e])&&++e<l;);return a}}function $(t,e,n){function i(){var e=this[a];e&&(this.removeEventListener(t,e,e.$),delete this[a])}function r(){var r=l(e,_a(arguments));i.call(this),this.addEventListener(t,this[a]=r,r.$=n),r._=e}function o(){var e,n=new RegExp("^__on([^.]+)"+fa.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}var a="__on"+t,s=t.indexOf("."),l=J;s>0&&(t=t.slice(0,s));var u=Fa.get(t);return u&&(t=u,l=Q),s?e?r:i:e?C:o}function J(t,e){return function(n){var i=fa.event;fa.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{fa.event=i}}}function Q(t,e){var n=J(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}function tt(t){var e=".dragsuppress-"+ ++za,n="click"+e,i=fa.select(a(t)).on("touchmove"+e,M).on("dragstart"+e,M).on("selectstart"+e,M);if(null==Ba&&(Ba="onselectstart"in t?!1:k(t.style,"userSelect")),Ba){var r=o(t).style,s=r[Ba];r[Ba]="none"}return function(t){if(i.on(e,null),Ba&&(r[Ba]=s),t){var o=function(){i.on(n,null)};i.on(n,function(){M(),o()},!0),setTimeout(o,0)}}}function et(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(0>Ha){var r=a(t);if(r.scrollX||r.scrollY){n=fa.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=n[0][0].getScreenCTM();Ha=!(o.f||o.e),n.remove()}}return Ha?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}function nt(){return fa.event.changedTouches[0].identifier}function it(t){return t>0?1:0>t?-1:0}function rt(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function ot(t){return t>1?0:-1>t?ja:Math.acos(t)}function at(t){return t>1?Wa:-1>t?-Wa:Math.asin(t)}function st(t){return((t=Math.exp(t))-1/t)/2}function lt(t){return((t=Math.exp(t))+1/t)/2}function ut(t){return((t=Math.exp(2*t))-1)/(t+1)}function ct(t){return(t=Math.sin(t/2))*t}function ht(){}function dt(t,e,n){return this instanceof dt?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof dt?new dt(t.h,t.s,t.l):Ct(""+t,Tt,dt):new dt(t,e,n)}function ft(t,e,n){function i(t){return t>360?t-=360:0>t&&(t+=360),60>t?o+(a-o)*t/60:180>t?a:240>t?o+(a-o)*(240-t)/60:o}function r(t){return Math.round(255*i(t))}var o,a;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,a=.5>=n?n*(1+e):n+e-n*e,o=2*n-a,new wt(r(t+120),r(t),r(t-120))}function pt(t,e,n){return this instanceof pt?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof pt?new pt(t.h,t.c,t.l):t instanceof gt?vt(t.l,t.a,t.b):vt((t=Et((t=fa.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new pt(t,e,n)}function _t(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new gt(n,Math.cos(t*=Xa)*e,Math.sin(t)*e)}function gt(t,e,n){return this instanceof gt?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof gt?new gt(t.l,t.a,t.b):t instanceof pt?_t(t.h,t.c,t.l):Et((t=wt(t)).r,t.g,t.b):new gt(t,e,n)}function mt(t,e,n){var i=(t+16)/116,r=i+e/500,o=i-n/200;return r=yt(r)*rs,i=yt(i)*os,o=yt(o)*as,new wt(xt(3.2404542*r-1.5371385*i-.4985314*o),xt(-.969266*r+1.8760108*i+.041556*o),xt(.0556434*r-.2040259*i+1.0572252*o))}function vt(t,e,n){return t>0?new pt(Math.atan2(n,e)*Ka,Math.sqrt(e*e+n*n),t):new pt(NaN,NaN,t)}function yt(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function bt(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function xt(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function wt(t,e,n){return this instanceof wt?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof wt?new wt(t.r,t.g,t.b):Ct(""+t,wt,ft):new wt(t,e,n)}function St(t){return new wt(t>>16,t>>8&255,255&t)}function At(t){return St(t)+""}function kt(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function Ct(t,e,n){var i,r,o,a=0,s=0,l=0;if(i=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(Lt(r[0]),Lt(r[1]),Lt(r[2]))}return(o=us.get(t))?e(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&o)>>4,a=a>>4|a,s=240&o,s=s>>4|s,l=15&o,l=l<<4|l):7===t.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,l=255&o)),e(a,s,l))}function Tt(t,e,n){var i,r,o=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),s=a-o,l=(a+o)/2;return s?(r=.5>l?s/(a+o):s/(2-a-o),i=t==a?(e-n)/s+(n>e?6:0):e==a?(n-t)/s+2:(t-e)/s+4,i*=60):(i=NaN,r=l>0&&1>l?0:i),new dt(i,r,l)}function Et(t,e,n){t=Mt(t),e=Mt(e),n=Mt(n);var i=bt((.4124564*t+.3575761*e+.1804375*n)/rs),r=bt((.2126729*t+.7151522*e+.072175*n)/os),o=bt((.0193339*t+.119192*e+.9503041*n)/as);return gt(116*r-16,500*(i-r),200*(r-o))}function Mt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Lt(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Rt(t){return"function"==typeof t?t:function(){return t}}function Ot(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),Pt(e,n,t,i)}}function Pt(t,e,n,i){function r(){var t,e=l.status;if(!e&&It(l)||e>=200&&300>e||304===e){try{t=n.call(o,l)}catch(i){return void a.error.call(o,i)}a.load.call(o,t)}else a.error.call(o,l)}var o={},a=fa.dispatch("beforesend","progress","load","error"),s={},l=new XMLHttpRequest,u=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=r:l.onreadystatechange=function(){l.readyState>3&&r()},l.onprogress=function(t){var e=fa.event;fa.event=t;try{a.progress.call(o,l)}finally{fa.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?s[t]:(null==e?delete s[t]:s[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(u=t,o):u},o.response=function(t){return n=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(_a(arguments)))}}),o.send=function(n,i,r){if(2===arguments.length&&"function"==typeof i&&(r=i,i=null),l.open(n,t,!0),null==e||"accept"in s||(s.accept=e+",*/*"),l.setRequestHeader)for(var c in s)l.setRequestHeader(c,s[c]);return null!=e&&l.overrideMimeType&&l.overrideMimeType(e),null!=u&&(l.responseType=u),null!=r&&o.on("error",r).on("load",function(t){r(null,t)}),a.beforesend.call(o,l),l.send(null==i?null:i),o},o.abort=function(){return l.abort(),o},fa.rebind(o,a,"on"),null==i?o:o.get(Dt(i))}function Dt(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function It(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Nt(t,e,n){var i=arguments.length;2>i&&(e=0),3>i&&(n=Date.now());var r=n+e,o={c:t,t:r,n:null};return hs?hs.n=o:cs=o,hs=o,ds||(fs=clearTimeout(fs),ds=1,ps(Ft)),o}function Ft(){var t=Bt(),e=zt()-t;e>24?(isFinite(e)&&(clearTimeout(fs),fs=setTimeout(Ft,e)),ds=0):(ds=1,ps(Ft))}function Bt(){for(var t=Date.now(),e=cs;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function zt(){for(var t,e=cs,n=1/0;e;)e.c?(e.t<n&&(n=e.t),e=(t=e).n):e=t?t.n=e.n:cs=e.n;return hs=t,n}function Ht(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function qt(t,e){var n=Math.pow(10,3*ka(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function Gt(t){var e=t.decimal,n=t.thousands,i=t.grouping,r=t.currency,o=i&&n?function(t,e){for(var r=t.length,o=[],a=0,s=i[0],l=0;r>0&&s>0&&(l+s+1>e&&(s=Math.max(1,e-l)),o.push(t.substring(r-=s,r+s)),!((l+=s+1)>e));)s=i[a=(a+1)%i.length];return o.reverse().join(n)}:S;return function(t){var n=gs.exec(t),i=n[1]||" ",a=n[2]||">",s=n[3]||"-",l=n[4]||"",u=n[5],c=+n[6],h=n[7],d=n[8],f=n[9],p=1,_="",g="",m=!1,v=!0;switch(d&&(d=+d.substring(1)),(u||"0"===i&&"="===a)&&(u=i="0",a="="),f){case"n":h=!0,f="g";break;case"%":p=100,g="%",f="f";break;case"p":p=100,g="%",f="r";break;case"b":case"o":case"x":case"X":"#"===l&&(_="0"+f.toLowerCase());case"c":v=!1;case"d":m=!0,d=0;break;case"s":p=-1,f="r"}"$"===l&&(_=r[0],g=r[1]),"r"!=f||d||(f="g"),null!=d&&("g"==f?d=Math.max(1,Math.min(21,d)):("e"==f||"f"==f)&&(d=Math.max(0,Math.min(20,d)))),f=ms.get(f)||jt;var y=u&&h;return function(t){var n=g;if(m&&t%1)return"";var r=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===s?"":s;if(0>p){var l=fa.formatPrefix(t,d);t=l.scale(t),n=l.symbol+g}else t*=p;t=f(t,d);var b,x,w=t.lastIndexOf(".");if(0>w){var S=v?t.lastIndexOf("e"):-1;0>S?(b=t,x=""):(b=t.substring(0,S),x=t.substring(S))}else b=t.substring(0,w),x=e+t.substring(w+1);!u&&h&&(b=o(b,1/0));var A=_.length+b.length+x.length+(y?0:r.length),k=c>A?new Array(A=c-A+1).join(i):"";return y&&(b=o(k+b,k.length?c-x.length:1/0)),r+=_,t=b+x,("<"===a?r+t+k:">"===a?k+r+t:"^"===a?k.substring(0,A>>=1)+r+t+k.substring(A):r+(y?t:k+t))+n}}}function jt(t){return t+""}function Ut(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Vt(t,e,n){function i(e){var n=t(e),i=o(n,1);return i-e>e-n?n:i}function r(n){return e(n=t(new ys(n-1)),1),n}function o(t,n){return e(t=new ys(+t),n),t}function a(t,i,o){var a=r(t),s=[];if(o>1)for(;i>a;)n(a)%o||s.push(new Date(+a)),e(a,1);else for(;i>a;)s.push(new Date(+a)),e(a,1);return s}function s(t,e,n){try{ys=Ut;var i=new Ut;return i._=t,a(i,e,n)}finally{ys=Date}}t.floor=t,t.round=i,t.ceil=r,t.offset=o,t.range=a;var l=t.utc=Wt(t);return l.floor=l,l.round=Wt(i),l.ceil=Wt(r),l.offset=Wt(o),l.range=s,t}function Wt(t){return function(e,n){try{ys=Ut;var i=new Ut;return i._=e,t(i,n)._}finally{ys=Date}}}function Xt(t){function e(t){function e(e){for(var n,r,o,a=[],s=-1,l=0;++s<i;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),
null!=(r=xs[n=t.charAt(++s)])&&(n=t.charAt(++s)),(o=E[n])&&(n=o(e,null==r?"e"===n?" ":"0":r)),a.push(n),l=s+1);return a.push(t.slice(l,s)),a.join("")}var i=t.length;return e.parse=function(e){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=n(i,t,e,0);if(r!=e.length)return null;"p"in i&&(i.H=i.H%12+12*i.p);var o=null!=i.Z&&ys!==Ut,a=new(o?Ut:ys);return"j"in i?a.setFullYear(i.y,0,i.j):"W"in i||"U"in i?("w"in i||(i.w="W"in i?1:0),a.setFullYear(i.y,0,1),a.setFullYear(i.y,0,"W"in i?(i.w+6)%7+7*i.W-(a.getDay()+5)%7:i.w+7*i.U-(a.getDay()+6)%7)):a.setFullYear(i.y,i.m,i.d),a.setHours(i.H+(i.Z/100|0),i.M+i.Z%100,i.S,i.L),o?a._:a},e.toString=function(){return t},e}function n(t,e,n,i){for(var r,o,a,s=0,l=e.length,u=n.length;l>s;){if(i>=u)return-1;if(r=e.charCodeAt(s++),37===r){if(a=e.charAt(s++),o=M[a in xs?e.charAt(s++):a],!o||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function i(t,e,n){w.lastIndex=0;var i=w.exec(e.slice(n));return i?(t.w=S.get(i[0].toLowerCase()),n+i[0].length):-1}function r(t,e,n){b.lastIndex=0;var i=b.exec(e.slice(n));return i?(t.w=x.get(i[0].toLowerCase()),n+i[0].length):-1}function o(t,e,n){C.lastIndex=0;var i=C.exec(e.slice(n));return i?(t.m=T.get(i[0].toLowerCase()),n+i[0].length):-1}function a(t,e,n){A.lastIndex=0;var i=A.exec(e.slice(n));return i?(t.m=k.get(i[0].toLowerCase()),n+i[0].length):-1}function s(t,e,i){return n(t,E.c.toString(),e,i)}function l(t,e,i){return n(t,E.x.toString(),e,i)}function u(t,e,i){return n(t,E.X.toString(),e,i)}function c(t,e,n){var i=y.get(e.slice(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)}var h=t.dateTime,d=t.date,f=t.time,p=t.periods,_=t.days,g=t.shortDays,m=t.months,v=t.shortMonths;e.utc=function(t){function n(t){try{ys=Ut;var e=new ys;return e._=t,i(e)}finally{ys=Date}}var i=e(t);return n.parse=function(t){try{ys=Ut;var e=i.parse(t);return e&&e._}finally{ys=Date}},n.toString=i.toString,n},e.multi=e.utc.multi=fe;var y=fa.map(),b=Yt(_),x=Zt(_),w=Yt(g),S=Zt(g),A=Yt(m),k=Zt(m),C=Yt(v),T=Zt(v);p.forEach(function(t,e){y.set(t.toLowerCase(),e)});var E={a:function(t){return g[t.getDay()]},A:function(t){return _[t.getDay()]},b:function(t){return v[t.getMonth()]},B:function(t){return m[t.getMonth()]},c:e(h),d:function(t,e){return Kt(t.getDate(),e,2)},e:function(t,e){return Kt(t.getDate(),e,2)},H:function(t,e){return Kt(t.getHours(),e,2)},I:function(t,e){return Kt(t.getHours()%12||12,e,2)},j:function(t,e){return Kt(1+vs.dayOfYear(t),e,3)},L:function(t,e){return Kt(t.getMilliseconds(),e,3)},m:function(t,e){return Kt(t.getMonth()+1,e,2)},M:function(t,e){return Kt(t.getMinutes(),e,2)},p:function(t){return p[+(t.getHours()>=12)]},S:function(t,e){return Kt(t.getSeconds(),e,2)},U:function(t,e){return Kt(vs.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Kt(vs.mondayOfYear(t),e,2)},x:e(d),X:e(f),y:function(t,e){return Kt(t.getFullYear()%100,e,2)},Y:function(t,e){return Kt(t.getFullYear()%1e4,e,4)},Z:he,"%":function(){return"%"}},M={a:i,A:r,b:o,B:a,c:s,d:oe,e:oe,H:se,I:se,j:ae,L:ce,m:re,M:le,p:c,S:ue,U:Jt,w:$t,W:Qt,x:l,X:u,y:ee,Y:te,Z:ne,"%":de};return e}function Kt(t,e,n){var i=0>t?"-":"",r=(i?-t:t)+"",o=r.length;return i+(n>o?new Array(n-o+1).join(e)+r:r)}function Yt(t){return new RegExp("^(?:"+t.map(fa.requote).join("|")+")","i")}function Zt(t){for(var e=new p,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function $t(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Jt(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function Qt(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function te(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function ee(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+2));return i?(t.y=ie(+i[0]),n+i[0].length):-1}function ne(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function ie(t){return t+(t>68?1900:2e3)}function re(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function oe(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function ae(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function se(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function le(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function ue(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function ce(t,e,n){ws.lastIndex=0;var i=ws.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function he(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=ka(e)/60|0,r=ka(e)%60;return n+Kt(i,"0",2)+Kt(r,"0",2)}function de(t,e,n){Ss.lastIndex=0;var i=Ss.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function fe(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,i=t[n];!i[1](e);)i=t[++n];return i[0](e)}}function pe(){}function _e(t,e,n){var i=n.s=t+e,r=i-t,o=i-r;n.t=t-o+(e-r)}function ge(t,e){t&&Ts.hasOwnProperty(t.type)&&Ts[t.type](t,e)}function me(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function ve(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)me(t[n],e,1);e.polygonEnd()}function ye(){function t(t,e){t*=Xa,e=e*Xa/2+ja/4;var n=t-i,a=n>=0?1:-1,s=a*n,l=Math.cos(e),u=Math.sin(e),c=o*u,h=r*l+c*Math.cos(s),d=c*a*Math.sin(s);Ms.add(Math.atan2(d,h)),i=t,r=l,o=u}var e,n,i,r,o;Ls.point=function(a,s){Ls.point=t,i=(e=a)*Xa,r=Math.cos(s=(n=s)*Xa/2+ja/4),o=Math.sin(s)},Ls.lineEnd=function(){t(e,n)}}function be(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function xe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function we(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Se(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ae(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function ke(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Ce(t){return[Math.atan2(t[1],t[0]),at(t[2])]}function Te(t,e){return ka(t[0]-e[0])<qa&&ka(t[1]-e[1])<qa}function Ee(t,e){t*=Xa;var n=Math.cos(e*=Xa);Me(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Me(t,e,n){++Rs,Ps+=(t-Ps)/Rs,Ds+=(e-Ds)/Rs,Is+=(n-Is)/Rs}function Le(){function t(t,r){t*=Xa;var o=Math.cos(r*=Xa),a=o*Math.cos(t),s=o*Math.sin(t),l=Math.sin(r),u=Math.atan2(Math.sqrt((u=n*l-i*s)*u+(u=i*a-e*l)*u+(u=e*s-n*a)*u),e*a+n*s+i*l);Os+=u,Ns+=u*(e+(e=a)),Fs+=u*(n+(n=s)),Bs+=u*(i+(i=l)),Me(e,n,i)}var e,n,i;Gs.point=function(r,o){r*=Xa;var a=Math.cos(o*=Xa);e=a*Math.cos(r),n=a*Math.sin(r),i=Math.sin(o),Gs.point=t,Me(e,n,i)}}function Re(){Gs.point=Ee}function Oe(){function t(t,e){t*=Xa;var n=Math.cos(e*=Xa),a=n*Math.cos(t),s=n*Math.sin(t),l=Math.sin(e),u=r*l-o*s,c=o*a-i*l,h=i*s-r*a,d=Math.sqrt(u*u+c*c+h*h),f=i*a+r*s+o*l,p=d&&-ot(f)/d,_=Math.atan2(d,f);zs+=p*u,Hs+=p*c,qs+=p*h,Os+=_,Ns+=_*(i+(i=a)),Fs+=_*(r+(r=s)),Bs+=_*(o+(o=l)),Me(i,r,o)}var e,n,i,r,o;Gs.point=function(a,s){e=a,n=s,Gs.point=t,a*=Xa;var l=Math.cos(s*=Xa);i=l*Math.cos(a),r=l*Math.sin(a),o=Math.sin(s),Me(i,r,o)},Gs.lineEnd=function(){t(e,n),Gs.lineEnd=Re,Gs.point=Ee}}function Pe(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),n}function De(){return!0}function Ie(t,e,n,i,r){var o=[],a=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if(Te(n,i)){r.lineStart();for(var s=0;e>s;++s)r.point((n=t[s])[0],n[1]);return void r.lineEnd()}var l=new Fe(n,t,null,!0),u=new Fe(n,null,l,!1);l.o=u,o.push(l),a.push(u),l=new Fe(i,t,null,!1),u=new Fe(i,null,l,!0),l.o=u,o.push(l),a.push(u)}}),a.sort(e),Ne(o),Ne(a),o.length){for(var s=0,l=n,u=a.length;u>s;++s)a[s].e=l=!l;for(var c,h,d=o[0];;){for(var f=d,p=!0;f.v;)if((f=f.n)===d)return;c=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(var s=0,u=c.length;u>s;++s)r.point((h=c[s])[0],h[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(p){c=f.p.z;for(var s=c.length-1;s>=0;--s)r.point((h=c[s])[0],h[1])}else i(f.x,f.p.x,-1,r);f=f.p}f=f.o,c=f.z,p=!p}while(!f.v);r.lineEnd()}}}function Ne(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function Fe(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Be(t,e,n,i){return function(r,o){function a(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&o.point(e,n)}function s(t,e){var n=r(t,e);g.point(n[0],n[1])}function l(){v.point=s,g.lineStart()}function u(){v.point=a,g.lineEnd()}function c(t,e){_.push([t,e]);var n=r(t,e);b.point(n[0],n[1])}function h(){b.lineStart(),_=[]}function d(){c(_[0][0],_[0][1]),b.lineEnd();var t,e=b.clean(),n=y.buffer(),i=n.length;if(_.pop(),p.push(_),_=null,i)if(1&e){t=n[0];var r,i=t.length-1,a=-1;if(i>0){for(x||(o.polygonStart(),x=!0),o.lineStart();++a<i;)o.point((r=t[a])[0],r[1]);o.lineEnd()}}else i>1&&2&e&&n.push(n.pop().concat(n.shift())),f.push(n.filter(ze))}var f,p,_,g=e(o),m=r.invert(i[0],i[1]),v={point:a,lineStart:l,lineEnd:u,polygonStart:function(){v.point=c,v.lineStart=h,v.lineEnd=d,f=[],p=[]},polygonEnd:function(){v.point=a,v.lineStart=l,v.lineEnd=u,f=fa.merge(f);var t=Ve(m,p);f.length?(x||(o.polygonStart(),x=!0),Ie(f,qe,t,n,o)):t&&(x||(o.polygonStart(),x=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),x&&(o.polygonEnd(),x=!1),f=p=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}},y=He(),b=e(y),x=!1;return v}}function ze(t){return t.length>1}function He(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:C,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function qe(t,e){return((t=t.x)[0]<0?t[1]-Wa-qa:Wa-t[1])-((e=e.x)[0]<0?e[1]-Wa-qa:Wa-e[1])}function Ge(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?ja:-ja,l=ka(o-n);ka(l-ja)<qa?(t.point(n,i=(i+a)/2>0?Wa:-Wa),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),t.point(o,i),e=0):r!==s&&l>=ja&&(ka(n-r)<qa&&(n-=r*qa),ka(o-s)<qa&&(o-=s*qa),i=je(n,i,o,a),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),e=0),t.point(n=o,i=a),r=s},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}function je(t,e,n,i){var r,o,a=Math.sin(t-n);return ka(a)>qa?Math.atan((Math.sin(e)*(o=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*o*a)):(e+i)/2}function Ue(t,e,n,i){var r;if(null==t)r=n*Wa,i.point(-ja,r),i.point(0,r),i.point(ja,r),i.point(ja,0),i.point(ja,-r),i.point(0,-r),i.point(-ja,-r),i.point(-ja,0),i.point(-ja,r);else if(ka(t[0]-e[0])>qa){var o=t[0]<e[0]?ja:-ja;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}function Ve(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],o=0,a=0;Ms.reset();for(var s=0,l=e.length;l>s;++s){var u=e[s],c=u.length;if(c)for(var h=u[0],d=h[0],f=h[1]/2+ja/4,p=Math.sin(f),_=Math.cos(f),g=1;;){g===c&&(g=0),t=u[g];var m=t[0],v=t[1]/2+ja/4,y=Math.sin(v),b=Math.cos(v),x=m-d,w=x>=0?1:-1,S=w*x,A=S>ja,k=p*y;if(Ms.add(Math.atan2(k*w*Math.sin(S),_*b+k*Math.cos(S))),o+=A?x+w*Ua:x,A^d>=n^m>=n){var C=we(be(h),be(t));ke(C);var T=we(r,C);ke(T);var E=(A^x>=0?-1:1)*at(T[2]);(i>E||i===E&&(C[0]||C[1]))&&(a+=A^x>=0?1:-1)}if(!g++)break;d=m,p=y,_=b,h=t}}return(-qa>o||qa>o&&0>Ms)^1&a}function We(t){function e(t,e){return Math.cos(t)*Math.cos(e)>o}function n(t){var n,o,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var f,p=[h,d],_=e(h,d),g=a?_?0:r(h,d):_?r(h+(0>h?ja:-ja),d):0;if(!n&&(u=l=_)&&t.lineStart(),_!==l&&(f=i(n,p),(Te(n,f)||Te(p,f))&&(p[0]+=qa,p[1]+=qa,_=e(p[0],p[1]))),_!==l)c=0,_?(t.lineStart(),f=i(p,n),t.point(f[0],f[1])):(f=i(n,p),t.point(f[0],f[1]),t.lineEnd()),n=f;else if(s&&n&&a^_){var m;g&o||!(m=i(p,n,!0))||(c=0,a?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!_||n&&Te(n,p)||t.point(p[0],p[1]),n=p,l=_,o=g},lineEnd:function(){l&&t.lineEnd(),n=null},clean:function(){return c|(u&&l)<<1}}}function i(t,e,n){var i=be(t),r=be(e),a=[1,0,0],s=we(i,r),l=xe(s,s),u=s[0],c=l-u*u;if(!c)return!n&&t;var h=o*l/c,d=-o*u/c,f=we(a,s),p=Ae(a,h),_=Ae(s,d);Se(p,_);var g=f,m=xe(p,g),v=xe(g,g),y=m*m-v*(xe(p,p)-1);if(!(0>y)){var b=Math.sqrt(y),x=Ae(g,(-m-b)/v);if(Se(x,p),x=Ce(x),!n)return x;var w,S=t[0],A=e[0],k=t[1],C=e[1];S>A&&(w=S,S=A,A=w);var T=A-S,E=ka(T-ja)<qa,M=E||qa>T;if(!E&&k>C&&(w=k,k=C,C=w),M?E?k+C>0^x[1]<(ka(x[0]-S)<qa?k:C):k<=x[1]&&x[1]<=C:T>ja^(S<=x[0]&&x[0]<=A)){var L=Ae(g,(-m+b)/v);return Se(L,p),[x,Ce(L)]}}}function r(e,n){var i=a?t:ja-t,r=0;return-i>e?r|=1:e>i&&(r|=2),-i>n?r|=4:n>i&&(r|=8),r}var o=Math.cos(t),a=o>0,s=ka(o)>qa,l=bn(t,6*Xa);return Be(e,n,l,a?[0,-t]:[-ja,t-ja])}function Xe(t,e,n,i){return function(r){var o,a=r.a,s=r.b,l=a.x,u=a.y,c=s.x,h=s.y,d=0,f=1,p=c-l,_=h-u;if(o=t-l,p||!(o>0)){if(o/=p,0>p){if(d>o)return;f>o&&(f=o)}else if(p>0){if(o>f)return;o>d&&(d=o)}if(o=n-l,p||!(0>o)){if(o/=p,0>p){if(o>f)return;o>d&&(d=o)}else if(p>0){if(d>o)return;f>o&&(f=o)}if(o=e-u,_||!(o>0)){if(o/=_,0>_){if(d>o)return;f>o&&(f=o)}else if(_>0){if(o>f)return;o>d&&(d=o)}if(o=i-u,_||!(0>o)){if(o/=_,0>_){if(o>f)return;o>d&&(d=o)}else if(_>0){if(d>o)return;f>o&&(f=o)}return d>0&&(r.a={x:l+d*p,y:u+d*_}),1>f&&(r.b={x:l+f*p,y:u+f*_}),r}}}}}}function Ke(t,e,n,i){function r(i,r){return ka(i[0]-t)<qa?r>0?0:3:ka(i[0]-n)<qa?r>0?2:1:ka(i[1]-e)<qa?r>0?1:0:r>0?3:2}function o(t,e){return a(t.x,e.x)}function a(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){function l(t){for(var e=0,n=g.length,i=t[1],r=0;n>r;++r)for(var o,a=1,s=g[r],l=s.length,u=s[0];l>a;++a)o=s[a],u[1]<=i?o[1]>i&&rt(u,o,t)>0&&++e:o[1]<=i&&rt(u,o,t)<0&&--e,u=o;return 0!==e}function u(o,s,l,u){var c=0,h=0;if(null==o||(c=r(o,l))!==(h=r(s,l))||a(o,s)<0^l>0){do u.point(0===c||3===c?t:n,c>1?i:e);while((c=(c+l+4)%4)!==h)}else u.point(s[0],s[1])}function c(r,o){return r>=t&&n>=r&&o>=e&&i>=o}function h(t,e){c(t,e)&&s.point(t,e)}function d(){M.point=p,g&&g.push(m=[]),A=!0,S=!1,x=w=NaN}function f(){_&&(p(v,y),b&&S&&T.rejoin(),_.push(T.buffer())),M.point=h,S&&s.lineEnd()}function p(t,e){t=Math.max(-Us,Math.min(Us,t)),e=Math.max(-Us,Math.min(Us,e));var n=c(t,e);if(g&&m.push([t,e]),A)v=t,y=e,b=n,A=!1,n&&(s.lineStart(),s.point(t,e));else if(n&&S)s.point(t,e);else{var i={a:{x:x,y:w},b:{x:t,y:e}};E(i)?(S||(s.lineStart(),s.point(i.a.x,i.a.y)),s.point(i.b.x,i.b.y),n||s.lineEnd(),k=!1):n&&(s.lineStart(),s.point(t,e),k=!1)}x=t,w=e,S=n}var _,g,m,v,y,b,x,w,S,A,k,C=s,T=He(),E=Xe(t,e,n,i),M={point:h,lineStart:d,lineEnd:f,polygonStart:function(){s=T,_=[],g=[],k=!0},polygonEnd:function(){s=C,_=fa.merge(_);var e=l([t,i]),n=k&&e,r=_.length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),u(null,null,1,s),s.lineEnd()),r&&Ie(_,o,e,u,s),s.polygonEnd()),_=g=m=null}};return M}}function Ye(t){var e=0,n=ja/3,i=dn(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*ja/180,n=t[1]*ja/180):[e/ja*180,n/ja*180]},r}function Ze(t,e){function n(t,e){var n=Math.sqrt(o-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),a-n*Math.cos(t)]}var i=Math.sin(t),r=(i+Math.sin(e))/2,o=1+i*(2*r-i),a=Math.sqrt(o)/r;return n.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/r,at((o-(t*t+n*n)*r*r)/(2*r))]},n}function $e(){function t(t,e){Ws+=r*t-i*e,i=t,r=e}var e,n,i,r;$s.point=function(o,a){$s.point=t,e=i=o,n=r=a},$s.lineEnd=function(){t(e,n)}}function Je(t,e){Xs>t&&(Xs=t),t>Ys&&(Ys=t),Ks>e&&(Ks=e),e>Zs&&(Zs=e)}function Qe(){function t(t,e){a.push("M",t,",",e,o)}function e(t,e){a.push("M",t,",",e),s.point=n}function n(t,e){a.push("L",t,",",e)}function i(){s.point=t}function r(){a.push("Z")}var o=tn(4.5),a=[],s={point:t,lineStart:function(){s.point=e},lineEnd:i,polygonStart:function(){s.lineEnd=r},polygonEnd:function(){s.lineEnd=i,s.point=t},pointRadius:function(t){return o=tn(t),s},result:function(){if(a.length){var t=a.join("");return a=[],t}}};return s}function tn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function en(t,e){Ps+=t,Ds+=e,++Is}function nn(){function t(t,i){var r=t-e,o=i-n,a=Math.sqrt(r*r+o*o);Ns+=a*(e+t)/2,Fs+=a*(n+i)/2,Bs+=a,en(e=t,n=i)}var e,n;Qs.point=function(i,r){Qs.point=t,en(e=i,n=r)}}function rn(){Qs.point=en}function on(){function t(t,e){var n=t-i,o=e-r,a=Math.sqrt(n*n+o*o);Ns+=a*(i+t)/2,Fs+=a*(r+e)/2,Bs+=a,a=r*t-i*e,zs+=a*(i+t),Hs+=a*(r+e),qs+=3*a,en(i=t,r=e)}var e,n,i,r;Qs.point=function(o,a){Qs.point=t,en(e=i=o,n=r=a)},Qs.lineEnd=function(){t(e,n)}}function an(t){function e(e,n){t.moveTo(e+a,n),t.arc(e,n,a,0,Ua)}function n(e,n){t.moveTo(e,n),s.point=i}function i(e,n){t.lineTo(e,n)}function r(){s.point=e}function o(){t.closePath()}var a=4.5,s={point:e,lineStart:function(){s.point=n},lineEnd:r,polygonStart:function(){s.lineEnd=o},polygonEnd:function(){s.lineEnd=r,s.point=e},pointRadius:function(t){return a=t,s},result:C};return s}function sn(t){function e(t){return(s?i:n)(t)}function n(e){return cn(e,function(n,i){n=t(n,i),e.point(n[0],n[1])})}function i(e){function n(n,i){n=t(n,i),e.point(n[0],n[1])}function i(){y=NaN,A.point=o,e.lineStart()}function o(n,i){var o=be([n,i]),a=t(n,i);r(y,b,v,x,w,S,y=a[0],b=a[1],v=n,x=o[0],w=o[1],S=o[2],s,e),e.point(y,b)}function a(){A.point=n,e.lineEnd()}function l(){i(),A.point=u,A.lineEnd=c}function u(t,e){o(h=t,d=e),f=y,p=b,_=x,g=w,m=S,A.point=o}function c(){r(y,b,v,x,w,S,f,p,h,_,g,m,s,e),A.lineEnd=a,a()}var h,d,f,p,_,g,m,v,y,b,x,w,S,A={point:n,lineStart:i,lineEnd:a,polygonStart:function(){e.polygonStart(),A.lineStart=l},polygonEnd:function(){e.polygonEnd(),A.lineStart=i}};return A}function r(e,n,i,s,l,u,c,h,d,f,p,_,g,m){var v=c-e,y=h-n,b=v*v+y*y;if(b>4*o&&g--){var x=s+f,w=l+p,S=u+_,A=Math.sqrt(x*x+w*w+S*S),k=Math.asin(S/=A),C=ka(ka(S)-1)<qa||ka(i-d)<qa?(i+d)/2:Math.atan2(w,x),T=t(C,k),E=T[0],M=T[1],L=E-e,R=M-n,O=y*L-v*R;(O*O/b>o||ka((v*L+y*R)/b-.5)>.3||a>s*f+l*p+u*_)&&(r(e,n,i,s,l,u,E,M,C,x/=A,w/=A,S,g,m),m.point(E,M),r(E,M,C,x,w,S,c,h,d,f,p,_,g,m))}}var o=.5,a=Math.cos(30*Xa),s=16;return e.precision=function(t){return arguments.length?(s=(o=t*t)>0&&16,e):Math.sqrt(o)},e}function ln(t){var e=sn(function(e,n){return t([e*Ka,n*Ka])});return function(t){return fn(e(t))}}function un(t){this.stream=t}function cn(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function hn(t){return dn(function(){return t})()}function dn(t){function e(t){return t=s(t[0]*Xa,t[1]*Xa),[t[0]*d+l,u-t[1]*d]}function n(t){return t=s.invert((t[0]-l)/d,(u-t[1])/d),t&&[t[0]*Ka,t[1]*Ka]}function i(){s=Pe(a=gn(m,v,y),o);var t=o(_,g);return l=f-t[0]*d,u=p+t[1]*d,r()}function r(){return c&&(c.valid=!1,c=null),e}var o,a,s,l,u,c,h=sn(function(t,e){return t=o(t,e),[t[0]*d+l,u-t[1]*d]}),d=150,f=480,p=250,_=0,g=0,m=0,v=0,y=0,b=js,x=S,w=null,A=null;return e.stream=function(t){return c&&(c.valid=!1),c=fn(b(a,h(x(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(b=null==t?(w=t,js):We((w=+t)*Xa),r()):w},e.clipExtent=function(t){return arguments.length?(A=t,x=t?Ke(t[0][0],t[0][1],t[1][0],t[1][1]):S,r()):A},e.scale=function(t){return arguments.length?(d=+t,i()):d},e.translate=function(t){return arguments.length?(f=+t[0],p=+t[1],i()):[f,p]},e.center=function(t){return arguments.length?(_=t[0]%360*Xa,g=t[1]%360*Xa,i()):[_*Ka,g*Ka]},e.rotate=function(t){return arguments.length?(m=t[0]%360*Xa,v=t[1]%360*Xa,y=t.length>2?t[2]%360*Xa:0,i()):[m*Ka,v*Ka,y*Ka]},fa.rebind(e,h,"precision"),function(){return o=t.apply(this,arguments),e.invert=o.invert&&n,i()}}function fn(t){return cn(t,function(e,n){t.point(e*Xa,n*Xa)})}function pn(t,e){return[t,e]}function _n(t,e){return[t>ja?t-Ua:-ja>t?t+Ua:t,e]}function gn(t,e,n){return t?e||n?Pe(vn(t),yn(e,n)):vn(t):e||n?yn(e,n):_n}function mn(t){return function(e,n){return e+=t,[e>ja?e-Ua:-ja>e?e+Ua:e,n]}}function vn(t){var e=mn(t);return e.invert=mn(-t),e}function yn(t,e){function n(t,e){var n=Math.cos(e),s=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*i+s*r;return[Math.atan2(l*o-c*a,s*i-u*r),at(c*o+l*a)]}var i=Math.cos(t),r=Math.sin(t),o=Math.cos(e),a=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),s=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*o-l*a;return[Math.atan2(l*o+u*a,s*i+c*r),at(c*i-s*r)]},n}function bn(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,o,a,s){var l=a*e;null!=r?(r=xn(n,r),o=xn(n,o),(a>0?o>r:r>o)&&(r+=a*Ua)):(r=t+a*Ua,o=t-.5*l);for(var u,c=r;a>0?c>o:o>c;c-=l)s.point((u=Ce([n,-i*Math.cos(c),-i*Math.sin(c)]))[0],u[1])}}function xn(t,e){var n=be(e);n[0]-=t,ke(n);var i=ot(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-qa)%(2*Math.PI)}function wn(t,e,n){var i=fa.range(t,e-qa,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function Sn(t,e,n){var i=fa.range(t,e-qa,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function An(t){return t.source}function kn(t){return t.target}function Cn(t,e,n,i){var r=Math.cos(e),o=Math.sin(e),a=Math.cos(i),s=Math.sin(i),l=r*Math.cos(t),u=r*Math.sin(t),c=a*Math.cos(n),h=a*Math.sin(n),d=2*Math.asin(Math.sqrt(ct(i-e)+r*a*ct(n-t))),f=1/Math.sin(d),p=d?function(t){var e=Math.sin(t*=d)*f,n=Math.sin(d-t)*f,i=n*l+e*c,r=n*u+e*h,a=n*o+e*s;return[Math.atan2(r,i)*Ka,Math.atan2(a,Math.sqrt(i*i+r*r))*Ka]}:function(){return[t*Ka,e*Ka]};return p.distance=d,p}function Tn(){function t(t,r){var o=Math.sin(r*=Xa),a=Math.cos(r),s=ka((t*=Xa)-e),l=Math.cos(s);tl+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=i*o-n*a*l)*s),n*o+i*a*l),e=t,n=o,i=a}var e,n,i;el.point=function(r,o){e=r*Xa,n=Math.sin(o*=Xa),i=Math.cos(o),el.point=t},el.lineEnd=function(){el.point=el.lineEnd=C}}function En(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),o=t(i*r);return[o*r*Math.sin(e),o*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),o=Math.sin(r),a=Math.cos(r);return[Math.atan2(t*o,i*a),Math.asin(i&&n*o/i)]},n}function Mn(t,e){function n(t,e){a>0?-Wa+qa>e&&(e=-Wa+qa):e>Wa-qa&&(e=Wa-qa);var n=a/Math.pow(r(e),o);return[n*Math.sin(o*t),a-n*Math.cos(o*t)]}var i=Math.cos(t),r=function(t){return Math.tan(ja/4+t/2)},o=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(r(e)/r(t)),a=i*Math.pow(r(t),o)/o;return o?(n.invert=function(t,e){var n=a-e,i=it(o)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/o,2*Math.atan(Math.pow(a/i,1/o))-Wa]},n):Rn}function Ln(t,e){function n(t,e){var n=o-e;return[n*Math.sin(r*t),o-n*Math.cos(r*t)]}var i=Math.cos(t),r=t===e?Math.sin(t):(i-Math.cos(e))/(e-t),o=i/r+t;return ka(r)<qa?pn:(n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/r,o-it(r)*Math.sqrt(t*t+n*n)]},n)}function Rn(t,e){return[t,Math.log(Math.tan(ja/4+e/2))]}function On(t){var e,n=hn(t),i=n.scale,r=n.translate,o=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=o.apply(n,arguments);if(a===n){if(e=null==t){var s=ja*i(),l=r();o([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else e&&(a=null);return a},n.clipExtent(null)}function Pn(t,e){return[Math.log(Math.tan(ja/4+e/2)),-t]}function Dn(t){return t[0]}function In(t){return t[1]}function Nn(t){for(var e=t.length,n=[0,1],i=2,r=2;e>r;r++){for(;i>1&&rt(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function Fn(t,e){return t[0]-e[0]||t[1]-e[1]}function Bn(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function zn(t,e,n,i){var r=t[0],o=n[0],a=e[0]-r,s=i[0]-o,l=t[1],u=n[1],c=e[1]-l,h=i[1]-u,d=(s*(l-u)-h*(r-o))/(h*a-s*c);return[r+d*a,l+d*c]}function Hn(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function qn(){li(this),this.edge=this.site=this.circle=null}function Gn(t){var e=fl.pop()||new qn;return e.site=t,e}function jn(t){Qn(t),cl.remove(t),fl.push(t),li(t)}function Un(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},o=t.P,a=t.N,s=[t];jn(t);for(var l=o;l.circle&&ka(n-l.circle.x)<qa&&ka(i-l.circle.cy)<qa;)o=l.P,s.unshift(l),jn(l),l=o;s.unshift(l),Qn(l);for(var u=a;u.circle&&ka(n-u.circle.x)<qa&&ka(i-u.circle.cy)<qa;)a=u.N,s.push(u),jn(u),u=a;s.push(u),Qn(u);var c,h=s.length;for(c=1;h>c;++c)u=s[c],l=s[c-1],oi(u.edge,l.site,u.site,r);l=s[0],u=s[h-1],u.edge=ii(l.site,u.site,null,r),Jn(l),Jn(u)}function Vn(t){for(var e,n,i,r,o=t.x,a=t.y,s=cl._;s;)if(i=Wn(s,a)-o,i>qa)s=s.L;else{if(r=o-Xn(s,a),!(r>qa)){i>-qa?(e=s.P,n=s):r>-qa?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}var l=Gn(t);if(cl.insert(e,l),e||n){if(e===n)return Qn(e),n=Gn(e.site),cl.insert(l,n),l.edge=n.edge=ii(e.site,l.site),Jn(e),void Jn(n);if(!n)return void(l.edge=ii(e.site,l.site));Qn(e),Qn(n);var u=e.site,c=u.x,h=u.y,d=t.x-c,f=t.y-h,p=n.site,_=p.x-c,g=p.y-h,m=2*(d*g-f*_),v=d*d+f*f,y=_*_+g*g,b={x:(g*v-f*y)/m+c,y:(d*y-_*v)/m+h};oi(n.edge,u,p,b),l.edge=ii(u,t,null,b),n.edge=ii(t,p,null,b),Jn(e),Jn(n)}}function Wn(t,e){var n=t.site,i=n.x,r=n.y,o=r-e;if(!o)return i;var a=t.P;if(!a)return-(1/0);n=a.site;var s=n.x,l=n.y,u=l-e;if(!u)return s;var c=s-i,h=1/o-1/u,d=c/u;return h?(-d+Math.sqrt(d*d-2*h*(c*c/(-2*u)-l+u/2+r-o/2)))/h+i:(i+s)/2}function Xn(t,e){var n=t.N;if(n)return Wn(n,e);var i=t.site;return i.y===e?i.x:1/0}function Kn(t){this.site=t,this.edges=[]}function Yn(t){for(var e,n,i,r,o,a,s,l,u,c,h=t[0][0],d=t[1][0],f=t[0][1],p=t[1][1],_=ul,g=_.length;g--;)if(o=_[g],o&&o.prepare())for(s=o.edges,l=s.length,a=0;l>a;)c=s[a].end(),i=c.x,r=c.y,u=s[++a%l].start(),e=u.x,n=u.y,(ka(i-e)>qa||ka(r-n)>qa)&&(s.splice(a,0,new ai(ri(o.site,c,ka(i-h)<qa&&p-r>qa?{x:h,y:ka(e-h)<qa?n:p}:ka(r-p)<qa&&d-i>qa?{x:ka(n-p)<qa?e:d,y:p}:ka(i-d)<qa&&r-f>qa?{x:d,y:ka(e-d)<qa?n:f}:ka(r-f)<qa&&i-h>qa?{x:ka(n-f)<qa?e:h,y:f}:null),o.site,null)),++l)}function Zn(t,e){return e.angle-t.angle}function $n(){li(this),this.x=this.y=this.arc=this.site=this.cy=null}function Jn(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var a=r.x,s=r.y,l=i.x-a,u=i.y-s,c=o.x-a,h=o.y-s,d=2*(l*h-u*c);if(!(d>=-Ga)){var f=l*l+u*u,p=c*c+h*h,_=(h*f-u*p)/d,g=(l*p-c*f)/d,h=g+s,m=pl.pop()||new $n;m.arc=t,m.site=r,m.x=_+a,m.y=h+Math.sqrt(_*_+g*g),m.cy=h,t.circle=m;for(var v=null,y=dl._;y;)if(m.y<y.y||m.y===y.y&&m.x<=y.x){if(!y.L){v=y.P;break}y=y.L}else{if(!y.R){v=y;break}y=y.R}dl.insert(v,m),v||(hl=m)}}}}function Qn(t){var e=t.circle;e&&(e.P||(hl=e.N),dl.remove(e),pl.push(e),li(e),t.circle=null)}function ti(t){for(var e,n=ll,i=Xe(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)e=n[r],(!ei(e,t)||!i(e)||ka(e.a.x-e.b.x)<qa&&ka(e.a.y-e.b.y)<qa)&&(e.a=e.b=null,n.splice(r,1))}function ei(t,e){var n=t.b;if(n)return!0;var i,r,o=t.a,a=e[0][0],s=e[1][0],l=e[0][1],u=e[1][1],c=t.l,h=t.r,d=c.x,f=c.y,p=h.x,_=h.y,g=(d+p)/2,m=(f+_)/2;if(_===f){if(a>g||g>=s)return;if(d>p){if(o){if(o.y>=u)return}else o={x:g,y:l};n={x:g,y:u}}else{if(o){if(o.y<l)return}else o={x:g,y:u};n={x:g,y:l}}}else if(i=(d-p)/(_-f),r=m-i*g,-1>i||i>1)if(d>p){if(o){if(o.y>=u)return}else o={x:(l-r)/i,y:l};n={x:(u-r)/i,y:u}}else{if(o){if(o.y<l)return}else o={x:(u-r)/i,y:u};n={x:(l-r)/i,y:l}}else if(_>f){if(o){if(o.x>=s)return}else o={x:a,y:i*a+r};n={x:s,y:i*s+r}}else{if(o){if(o.x<a)return}else o={x:s,y:i*s+r};n={x:a,y:i*a+r}}return t.a=o,t.b=n,!0}function ni(t,e){this.l=t,this.r=e,this.a=this.b=null}function ii(t,e,n,i){var r=new ni(t,e);return ll.push(r),n&&oi(r,t,e,n),i&&oi(r,e,t,i),ul[t.i].edges.push(new ai(r,t,e)),ul[e.i].edges.push(new ai(r,e,t)),r}function ri(t,e,n){var i=new ni(t,null);return i.a=e,i.b=n,ll.push(i),i}function oi(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function ai(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function si(){this._=null}function li(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ui(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function ci(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function hi(t){for(;t.L;)t=t.L;return t}function di(t,e){var n,i,r,o=t.sort(fi).pop();for(ll=[],ul=new Array(t.length),cl=new si,dl=new si;;)if(r=hl,o&&(!r||o.y<r.y||o.y===r.y&&o.x<r.x))(o.x!==n||o.y!==i)&&(ul[o.i]=new Kn(o),Vn(o),n=o.x,i=o.y),o=t.pop();else{if(!r)break;Un(r.arc)}e&&(ti(e),Yn(e));var a={cells:ul,edges:ll};return cl=dl=ll=ul=null,a}function fi(t,e){return e.y-t.y||e.x-t.x}function pi(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function _i(t){return t.x}function gi(t){return t.y}function mi(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function vi(t,e,n,i,r,o){if(!t(e,n,i,r,o)){var a=.5*(n+r),s=.5*(i+o),l=e.nodes;l[0]&&vi(t,l[0],n,i,a,s),l[1]&&vi(t,l[1],a,i,r,s),l[2]&&vi(t,l[2],n,s,a,o),l[3]&&vi(t,l[3],a,s,r,o)}}function yi(t,e,n,i,r,o,a){var s,l=1/0;return function u(t,c,h,d,f){if(!(c>o||h>a||i>d||r>f)){if(p=t.point){var p,_=e-t.x,g=n-t.y,m=_*_+g*g;if(l>m){var v=Math.sqrt(l=m);i=e-v,r=n-v,o=e+v,a=n+v,s=p}}for(var y=t.nodes,b=.5*(c+d),x=.5*(h+f),w=e>=b,S=n>=x,A=S<<1|w,k=A+4;k>A;++A)if(t=y[3&A])switch(3&A){case 0:u(t,c,h,b,x);break;case 1:u(t,b,h,d,x);break;case 2:u(t,c,x,b,f);break;case 3:u(t,b,x,d,f)}}}(t,i,r,o,a),s}function bi(t,e){t=fa.rgb(t),e=fa.rgb(e);var n=t.r,i=t.g,r=t.b,o=e.r-n,a=e.g-i,s=e.b-r;return function(t){return"#"+kt(Math.round(n+o*t))+kt(Math.round(i+a*t))+kt(Math.round(r+s*t))}}function xi(t,e){var n,i={},r={};for(n in t)n in e?i[n]=Ai(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function wi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Si(t,e){var n,i,r,o=gl.lastIndex=ml.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=gl.exec(t))&&(i=ml.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:wi(n,i)})),o=ml.lastIndex;return o<e.length&&(r=e.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,i=0;e>i;++i)s[(n=l[i]).i]=n.x(t);return s.join("")})}function Ai(t,e){for(var n,i=fa.interpolators.length;--i>=0&&!(n=fa.interpolators[i](t,e)););return n}function ki(t,e){var n,i=[],r=[],o=t.length,a=e.length,s=Math.min(t.length,e.length);for(n=0;s>n;++n)i.push(Ai(t[n],e[n]));for(;o>n;++n)r[n]=t[n];for(;a>n;++n)r[n]=e[n];return function(t){for(n=0;s>n;++n)r[n]=i[n](t);return r}}function Ci(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function Ti(t){return function(e){return 1-t(1-e)}}function Ei(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Mi(t){return t*t}function Li(t){return t*t*t}function Ri(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function Oi(t){return function(e){return Math.pow(e,t)}}function Pi(t){return 1-Math.cos(t*Wa)}function Di(t){return Math.pow(2,10*(t-1))}function Ii(t){return 1-Math.sqrt(1-t*t)}function Ni(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/Ua*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*Ua/e)}}function Fi(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Bi(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function zi(t,e){t=fa.hcl(t),e=fa.hcl(e);var n=t.h,i=t.c,r=t.l,o=e.h-n,a=e.c-i,s=e.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?e.c:i),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return _t(n+o*t,i+a*t,r+s*t)+""}}function Hi(t,e){t=fa.hsl(t),e=fa.hsl(e);var n=t.h,i=t.s,r=t.l,o=e.h-n,a=e.s-i,s=e.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?e.s:i),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return ft(n+o*t,i+a*t,r+s*t)+""}}function qi(t,e){t=fa.lab(t),e=fa.lab(e);var n=t.l,i=t.a,r=t.b,o=e.l-n,a=e.a-i,s=e.b-r;
return function(t){return mt(n+o*t,i+a*t,r+s*t)+""}}function Gi(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function ji(t){var e=[t.a,t.b],n=[t.c,t.d],i=Vi(e),r=Ui(e,n),o=Vi(Wi(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Ka,this.translate=[t.e,t.f],this.scale=[i,o],this.skew=o?Math.atan2(r,o)*Ka:0}function Ui(t,e){return t[0]*e[0]+t[1]*e[1]}function Vi(t){var e=Math.sqrt(Ui(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Wi(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function Xi(t){return t.length?t.pop()+",":""}function Ki(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push("translate(",null,",",null,")");i.push({i:r-4,x:wi(t[0],e[0])},{i:r-2,x:wi(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}function Yi(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(Xi(n)+"rotate(",null,")")-2,x:wi(t,e)})):e&&n.push(Xi(n)+"rotate("+e+")")}function Zi(t,e,n,i){t!==e?i.push({i:n.push(Xi(n)+"skewX(",null,")")-2,x:wi(t,e)}):e&&n.push(Xi(n)+"skewX("+e+")")}function $i(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push(Xi(n)+"scale(",null,",",null,")");i.push({i:r-4,x:wi(t[0],e[0])},{i:r-2,x:wi(t[1],e[1])})}else(1!==e[0]||1!==e[1])&&n.push(Xi(n)+"scale("+e+")")}function Ji(t,e){var n=[],i=[];return t=fa.transform(t),e=fa.transform(e),Ki(t.translate,e.translate,n,i),Yi(t.rotate,e.rotate,n,i),Zi(t.skew,e.skew,n,i),$i(t.scale,e.scale,n,i),t=e=null,function(t){for(var e,r=-1,o=i.length;++r<o;)n[(e=i[r]).i]=e.x(t);return n.join("")}}function Qi(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function tr(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function er(t){for(var e=t.source,n=t.target,i=ir(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var o=r.length;n!==i;)r.splice(o,0,n),n=n.parent;return r}function nr(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function ir(t,e){if(t===e)return t;for(var n=nr(t),i=nr(e),r=n.pop(),o=i.pop(),a=null;r===o;)a=r,r=n.pop(),o=i.pop();return a}function rr(t){t.fixed|=2}function or(t){t.fixed&=-7}function ar(t){t.fixed|=4,t.px=t.x,t.py=t.y}function sr(t){t.fixed&=-5}function lr(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var o,a=t.nodes,s=a.length,l=-1;++l<s;)o=a[l],null!=o&&(lr(o,e,n),t.charge+=o.charge,i+=o.charge*o.cx,r+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=e*n[t.point.index];t.charge+=t.pointCharge=u,i+=u*t.point.x,r+=u*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}function ur(t,e){return fa.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=_r,t}function cr(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(r=t.children)&&(i=r.length))for(var i,r;--i>=0;)n.push(r[i])}function hr(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(o=t.children)&&(r=o.length))for(var r,o,a=-1;++a<r;)n.push(o[a]);for(;null!=(t=i.pop());)e(t)}function dr(t){return t.children}function fr(t){return t.value}function pr(t,e){return e.value-t.value}function _r(t){return fa.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function gr(t){return t.x}function mr(t){return t.y}function vr(t,e,n){t.y0=e,t.y=n}function yr(t){return fa.range(t.length)}function br(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function xr(t){for(var e,n=1,i=0,r=t[0][1],o=t.length;o>n;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function wr(t){return t.reduce(Sr,0)}function Sr(t,e){return t+e[1]}function Ar(t,e){return kr(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function kr(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,o=[];++n<=e;)o[n]=r*n+i;return o}function Cr(t){return[fa.min(t),fa.max(t)]}function Tr(t,e){return t.value-e.value}function Er(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function Mr(t,e){t._pack_next=e,e._pack_prev=t}function Lr(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function Rr(t){function e(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),d=Math.min(t.y-t.r,d),f=Math.max(t.y+t.r,f)}if((n=t.children)&&(u=n.length)){var n,i,r,o,a,s,l,u,c=1/0,h=-(1/0),d=1/0,f=-(1/0);if(n.forEach(Or),i=n[0],i.x=-i.r,i.y=0,e(i),u>1&&(r=n[1],r.x=r.r,r.y=0,e(r),u>2))for(o=n[2],Ir(i,r,o),e(o),Er(i,o),i._pack_prev=o,Er(o,r),r=i._pack_next,a=3;u>a;a++){Ir(i,r,o=n[a]);var p=0,_=1,g=1;for(s=r._pack_next;s!==r;s=s._pack_next,_++)if(Lr(s,o)){p=1;break}if(1==p)for(l=i._pack_prev;l!==s._pack_prev&&!Lr(l,o);l=l._pack_prev,g++);p?(g>_||_==g&&r.r<i.r?Mr(i,r=s):Mr(i=l,r),a--):(Er(i,o),r=o,e(o))}var m=(c+h)/2,v=(d+f)/2,y=0;for(a=0;u>a;a++)o=n[a],o.x-=m,o.y-=v,y=Math.max(y,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=y,n.forEach(Pr)}}function Or(t){t._pack_next=t._pack_prev=t}function Pr(t){delete t._pack_next,delete t._pack_prev}function Dr(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var o=-1,a=r.length;++o<a;)Dr(r[o],e,n,i)}function Ir(t,e,n){var i=t.r+n.r,r=e.x-t.x,o=e.y-t.y;if(i&&(r||o)){var a=e.r+n.r,s=r*r+o*o;a*=a,i*=i;var l=.5+(i-a)/(2*s),u=Math.sqrt(Math.max(0,2*a*(i+s)-(i-=s)*i-a*a))/(2*s);n.x=t.x+l*r+u*o,n.y=t.y+l*o-u*r}else n.x=t.x+i,n.y=t.y}function Nr(t,e){return t.parent==e.parent?1:2}function Fr(t){var e=t.children;return e.length?e[0]:t.t}function Br(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function zr(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function Hr(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)e=r[o],e.z+=n,e.m+=n,n+=e.s+(i+=e.c)}function qr(t,e,n){return t.a.parent===e.parent?t.a:n}function Gr(t){return 1+fa.max(t,function(t){return t.y})}function jr(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Ur(t){var e=t.children;return e&&e.length?Ur(e[0]):t}function Vr(t){var e,n=t.children;return n&&(e=n.length)?Vr(n[e-1]):t}function Wr(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Xr(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return 0>r&&(n+=r/2,r=0),0>o&&(i+=o/2,o=0),{x:n,y:i,dx:r,dy:o}}function Kr(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function Yr(t){return t.rangeExtent?t.rangeExtent():Kr(t.range())}function Zr(t,e,n,i){var r=n(t[0],t[1]),o=i(e[0],e[1]);return function(t){return o(r(t))}}function $r(t,e){var n,i=0,r=t.length-1,o=t[i],a=t[r];return o>a&&(n=i,i=r,r=n,n=o,o=a,a=n),t[i]=e.floor(o),t[r]=e.ceil(a),t}function Jr(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:El}function Qr(t,e,n,i){var r=[],o=[],a=0,s=Math.min(t.length,e.length)-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<=s;)r.push(n(t[a-1],t[a])),o.push(i(e[a-1],e[a]));return function(e){var n=fa.bisect(t,e,1,s)-1;return o[n](r[n](e))}}function to(t,e,n,i){function r(){var r=Math.min(t.length,e.length)>2?Qr:Zr,l=i?tr:Qi;return a=r(t,e,l,n),s=r(e,t,l,Ai),o}function o(t){return a(t)}var a,s;return o.invert=function(t){return s(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},o.range=function(t){return arguments.length?(e=t,r()):e},o.rangeRound=function(t){return o.range(t).interpolate(Gi)},o.clamp=function(t){return arguments.length?(i=t,r()):i},o.interpolate=function(t){return arguments.length?(n=t,r()):n},o.ticks=function(e){return ro(t,e)},o.tickFormat=function(e,n){return oo(t,e,n)},o.nice=function(e){return no(t,e),r()},o.copy=function(){return to(t,e,n,i)},r()}function eo(t,e){return fa.rebind(t,e,"range","rangeRound","interpolate","clamp")}function no(t,e){return $r(t,Jr(io(t,e)[2])),$r(t,Jr(io(t,e)[2])),t}function io(t,e){null==e&&(e=10);var n=Kr(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),o=e/i*r;return.15>=o?r*=10:.35>=o?r*=5:.75>=o&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function ro(t,e){return fa.range.apply(fa,io(t,e))}function oo(t,e,n){var i=io(t,e);if(n){var r=gs.exec(n);if(r.shift(),"s"===r[8]){var o=fa.formatPrefix(Math.max(ka(i[0]),ka(i[1])));return r[7]||(r[7]="."+ao(o.scale(i[2]))),r[8]="f",n=fa.format(r.join("")),function(t){return n(o.scale(t))+o.symbol}}r[7]||(r[7]="."+so(r[8],i)),n=r.join("")}else n=",."+ao(i[2])+"f";return fa.format(n)}function ao(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function so(t,e){var n=ao(e[2]);return t in Ml?Math.abs(n-ao(Math.max(ka(e[0]),ka(e[1]))))+ +("e"!==t):n-2*("%"===t)}function lo(t,e,n,i){function r(t){return(n?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function o(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function a(e){return t(r(e))}return a.invert=function(e){return o(t.invert(e))},a.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((i=e.map(Number)).map(r)),a):i},a.base=function(n){return arguments.length?(e=+n,t.domain(i.map(r)),a):e},a.nice=function(){var e=$r(i.map(r),n?Math:Rl);return t.domain(e),i=e.map(o),a},a.ticks=function(){var t=Kr(i),a=[],s=t[0],l=t[1],u=Math.floor(r(s)),c=Math.ceil(r(l)),h=e%1?2:e;if(isFinite(c-u)){if(n){for(;c>u;u++)for(var d=1;h>d;d++)a.push(o(u)*d);a.push(o(u))}else for(a.push(o(u));u++<c;)for(var d=h-1;d>0;d--)a.push(o(u)*d);for(u=0;a[u]<s;u++);for(c=a.length;a[c-1]>l;c--);a=a.slice(u,c)}return a},a.tickFormat=function(t,n){if(!arguments.length)return Ll;arguments.length<2?n=Ll:"function"!=typeof n&&(n=fa.format(n));var i=Math.max(1,e*t/a.ticks().length);return function(t){var a=t/o(Math.round(r(t)));return e-.5>a*e&&(a*=e),i>=a?n(t):""}},a.copy=function(){return lo(t.copy(),e,n,i)},eo(a,t)}function uo(t,e,n){function i(e){return t(r(e))}var r=co(e),o=co(1/e);return i.invert=function(e){return o(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(r)),i):n},i.ticks=function(t){return ro(n,t)},i.tickFormat=function(t,e){return oo(n,t,e)},i.nice=function(t){return i.domain(no(n,t))},i.exponent=function(a){return arguments.length?(r=co(e=a),o=co(1/e),t.domain(n.map(r)),i):e},i.copy=function(){return uo(t.copy(),e,n)},eo(i,t)}function co(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function ho(t,e){function n(n){return o[((r.get(n)||("range"===e.t?r.set(n,t.push(n)):NaN))-1)%o.length]}function i(e,n){return fa.range(t.length).map(function(t){return e+n*t})}var r,o,a;return n.domain=function(i){if(!arguments.length)return t;t=[],r=new p;for(var o,a=-1,s=i.length;++a<s;)r.has(o=i[a])||r.set(o,t.push(o));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(o=t,a=0,e={t:"range",a:arguments},n):o},n.rangePoints=function(r,s){arguments.length<2&&(s=0);var l=r[0],u=r[1],c=t.length<2?(l=(l+u)/2,0):(u-l)/(t.length-1+s);return o=i(l+c*s/2,c),a=0,e={t:"rangePoints",a:arguments},n},n.rangeRoundPoints=function(r,s){arguments.length<2&&(s=0);var l=r[0],u=r[1],c=t.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(t.length-1+s)|0;return o=i(l+Math.round(c*s/2+(u-l-(t.length-1+s)*c)/2),c),a=0,e={t:"rangeRoundPoints",a:arguments},n},n.rangeBands=function(r,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=r[1]<r[0],c=r[u-0],h=r[1-u],d=(h-c)/(t.length-s+2*l);return o=i(c+d*l,d),u&&o.reverse(),a=d*(1-s),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=r[1]<r[0],c=r[u-0],h=r[1-u],d=Math.floor((h-c)/(t.length-s+2*l));return o=i(c+Math.round((h-c-(t.length-s)*d)/2),d),u&&o.reverse(),a=Math.round(d*(1-s)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return a},n.rangeExtent=function(){return Kr(e.a[0])},n.copy=function(){return ho(t,e)},n.domain(t)}function fo(t,e){function n(){var n=0,o=e.length;for(r=[];++n<o;)r[n-1]=fa.quantile(t,n/o);return i}function i(t){return isNaN(t=+t)?void 0:e[fa.bisect(r,t)]}var r;return i.domain=function(e){return arguments.length?(t=e.map(l).filter(u).sort(s),n()):t},i.range=function(t){return arguments.length?(e=t,n()):e},i.quantiles=function(){return r},i.invertExtent=function(n){return n=e.indexOf(n),0>n?[NaN,NaN]:[n>0?r[n-1]:t[0],n<r.length?r[n]:t[t.length-1]]},i.copy=function(){return fo(t,e)},n()}function po(t,e,n){function i(e){return n[Math.max(0,Math.min(a,Math.floor(o*(e-t))))]}function r(){return o=n.length/(e-t),a=n.length-1,i}var o,a;return i.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],r()):[t,e]},i.range=function(t){return arguments.length?(n=t,r()):n},i.invertExtent=function(e){return e=n.indexOf(e),e=0>e?NaN:e/o+t,[e,e+1/o]},i.copy=function(){return po(t,e,n)},r()}function _o(t,e){function n(n){return n>=n?e[fa.bisect(t,n)]:void 0}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return _o(t,e)},n}function go(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return ro(t,e)},e.tickFormat=function(e,n){return oo(t,e,n)},e.copy=function(){return go(t)},e}function mo(){return 0}function vo(t){return t.innerRadius}function yo(t){return t.outerRadius}function bo(t){return t.startAngle}function xo(t){return t.endAngle}function wo(t){return t&&t.padAngle}function So(t,e,n,i){return(t-n)*e-(e-i)*t>0?0:1}function Ao(t,e,n,i,r){var o=t[0]-e[0],a=t[1]-e[1],s=(r?i:-i)/Math.sqrt(o*o+a*a),l=s*a,u=-s*o,c=t[0]+l,h=t[1]+u,d=e[0]+l,f=e[1]+u,p=(c+d)/2,_=(h+f)/2,g=d-c,m=f-h,v=g*g+m*m,y=n-i,b=c*f-d*h,x=(0>m?-1:1)*Math.sqrt(Math.max(0,y*y*v-b*b)),w=(b*m-g*x)/v,S=(-b*g-m*x)/v,A=(b*m+g*x)/v,k=(-b*g+m*x)/v,C=w-p,T=S-_,E=A-p,M=k-_;return C*C+T*T>E*E+M*M&&(w=A,S=k),[[w-l,S-u],[w*n/y,S*n/y]]}function ko(t){function e(e){function a(){u.push("M",o(t(c),s))}for(var l,u=[],c=[],h=-1,d=e.length,f=Rt(n),p=Rt(i);++h<d;)r.call(this,l=e[h],h)?c.push([+f.call(this,l,h),+p.call(this,l,h)]):c.length&&(a(),c=[]);return c.length&&a(),u.length?u.join(""):null}var n=Dn,i=In,r=De,o=Co,a=o.key,s=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(a="function"==typeof t?o=t:(o=Fl.get(t)||Co).key,e):a},e.tension=function(t){return arguments.length?(s=t,e):s},e}function Co(t){return t.length>1?t.join("L"):t+"Z"}function To(t){return t.join("L")+"Z"}function Eo(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return n>1&&r.push("H",i[0]),r.join("")}function Mo(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function Lo(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function Ro(t,e){return t.length<4?Co(t):t[1]+Do(t.slice(1,-1),Io(t,e))}function Oo(t,e){return t.length<3?To(t):t[0]+Do((t.push(t[0]),t),Io([t[t.length-2]].concat(t,[t[1]]),e))}function Po(t,e){return t.length<3?Co(t):t[0]+Do(t,Io(t,e))}function Do(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return Co(t);var n=t.length!=e.length,i="",r=t[0],o=t[1],a=e[0],s=a,l=1;if(n&&(i+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],r=t[1],l=2),e.length>1){s=e[1],o=t[l],l++,i+="C"+(r[0]+a[0])+","+(r[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var u=2;u<e.length;u++,l++)o=t[l],s=e[u],i+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(n){var c=t[l];i+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return i}function Io(t,e){for(var n,i=[],r=(1-e)/2,o=t[0],a=t[1],s=1,l=t.length;++s<l;)n=o,o=a,a=t[s],i.push([r*(a[0]-n[0]),r*(a[1]-n[1])]);return i}function No(t){if(t.length<3)return Co(t);var e=1,n=t.length,i=t[0],r=i[0],o=i[1],a=[r,r,r,(i=t[1])[0]],s=[o,o,o,i[1]],l=[r,",",o,"L",Ho(Hl,a),",",Ho(Hl,s)];for(t.push(t[n-1]);++e<=n;)i=t[e],a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),qo(l,a,s);return t.pop(),l.push("L",i),l.join("")}function Fo(t){if(t.length<4)return Co(t);for(var e,n=[],i=-1,r=t.length,o=[0],a=[0];++i<3;)e=t[i],o.push(e[0]),a.push(e[1]);for(n.push(Ho(Hl,o)+","+Ho(Hl,a)),--i;++i<r;)e=t[i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),qo(n,o,a);return n.join("")}function Bo(t){for(var e,n,i=-1,r=t.length,o=r+4,a=[],s=[];++i<4;)n=t[i%r],a.push(n[0]),s.push(n[1]);for(e=[Ho(Hl,a),",",Ho(Hl,s)],--i;++i<o;)n=t[i%r],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),qo(e,a,s);return e.join("")}function zo(t,e){var n=t.length-1;if(n)for(var i,r,o=t[0][0],a=t[0][1],s=t[n][0]-o,l=t[n][1]-a,u=-1;++u<=n;)i=t[u],r=u/n,i[0]=e*i[0]+(1-e)*(o+r*s),i[1]=e*i[1]+(1-e)*(a+r*l);return No(t)}function Ho(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function qo(t,e,n){t.push("C",Ho(Bl,e),",",Ho(Bl,n),",",Ho(zl,e),",",Ho(zl,n),",",Ho(Hl,e),",",Ho(Hl,n))}function Go(t,e){return(e[1]-t[1])/(e[0]-t[0])}function jo(t){for(var e=0,n=t.length-1,i=[],r=t[0],o=t[1],a=i[0]=Go(r,o);++e<n;)i[e]=(a+(a=Go(r=o,o=t[e+1])))/2;return i[e]=a,i}function Uo(t){for(var e,n,i,r,o=[],a=jo(t),s=-1,l=t.length-1;++s<l;)e=Go(t[s],t[s+1]),ka(e)<qa?a[s]=a[s+1]=0:(n=a[s]/e,i=a[s+1]/e,r=n*n+i*i,r>9&&(r=3*e/Math.sqrt(r),a[s]=r*n,a[s+1]=r*i));for(s=-1;++s<=l;)r=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([r||0,a[s]*r||0]);return o}function Vo(t){return t.length<3?Co(t):t[0]+Do(t,Uo(t))}function Wo(t){for(var e,n,i,r=-1,o=t.length;++r<o;)e=t[r],n=e[0],i=e[1]-Wa,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function Xo(t){function e(e){function l(){_.push("M",s(t(m),h),c,u(t(g.reverse()),h),"Z")}for(var d,f,p,_=[],g=[],m=[],v=-1,y=e.length,b=Rt(n),x=Rt(r),w=n===i?function(){return f}:Rt(i),S=r===o?function(){return p}:Rt(o);++v<y;)a.call(this,d=e[v],v)?(g.push([f=+b.call(this,d,v),p=+x.call(this,d,v)]),m.push([+w.call(this,d,v),+S.call(this,d,v)])):g.length&&(l(),g=[],m=[]);return g.length&&l(),_.length?_.join(""):null}var n=Dn,i=Dn,r=0,o=In,a=De,s=Co,l=s.key,u=s,c="L",h=.7;return e.x=function(t){return arguments.length?(n=i=t,e):i},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(r=o=t,e):o},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(a=t,e):a},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?s=t:(s=Fl.get(t)||Co).key,u=s.reverse||s,c=s.closed?"M":"L",e):l},e.tension=function(t){return arguments.length?(h=t,e):h},e}function Ko(t){return t.radius}function Yo(t){return[t.x,t.y]}function Zo(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]-Wa;return[n*Math.cos(i),n*Math.sin(i)]}}function $o(){return 64}function Jo(){return"circle"}function Qo(t){var e=Math.sqrt(t/ja);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function ta(t){return function(){var e,n,i;(e=this[t])&&(i=e[n=e.active])&&(i.timer.c=null,i.timer.t=NaN,--e.count?delete e[n]:delete this[t],e.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function ea(t,e,n){return La(t,Xl),t.namespace=e,t.id=n,t}function na(t,e,n,i){var r=t.id,o=t.namespace;return K(t,"function"==typeof n?function(t,a,s){t[o][r].tween.set(e,i(n.call(t,t.__data__,a,s)))}:(n=i(n),function(t){t[o][r].tween.set(e,n)}))}function ia(t){return null==t&&(t=""),function(){this.textContent=t}}function ra(t){return null==t?"__transition__":"__transition_"+t+"__"}function oa(t,e,n,i,r){function o(t){var e=_.delay;return u.t=e+l,t>=e?a(t-e):void(u.c=a)}function a(n){var r=f.active,o=f[r];o&&(o.timer.c=null,o.timer.t=NaN,--f.count,delete f[r],o.event&&o.event.interrupt.call(t,t.__data__,o.index));for(var a in f)if(i>+a){var p=f[a];p.timer.c=null,p.timer.t=NaN,--f.count,delete f[a]}u.c=s,Nt(function(){return u.c&&s(n||1)&&(u.c=null,u.t=NaN),1},0,l),f.active=i,_.event&&_.event.start.call(t,t.__data__,e),d=[],_.tween.forEach(function(n,i){(i=i.call(t,t.__data__,e))&&d.push(i)}),h=_.ease,c=_.duration}function s(r){for(var o=r/c,a=h(o),s=d.length;s>0;)d[--s].call(t,a);return o>=1?(_.event&&_.event.end.call(t,t.__data__,e),--f.count?delete f[i]:delete t[n],1):void 0}var l,u,c,h,d,f=t[n]||(t[n]={active:0,count:0}),_=f[i];_||(l=r.time,u=Nt(o,0,l),_=f[i]={tween:new p,time:l,timer:u,delay:r.delay,duration:r.duration,ease:r.ease,index:e},r=null,++f.count)}function aa(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate("+(isFinite(i)?i:n(t))+",0)"})}function sa(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate(0,"+(isFinite(i)?i:n(t))+")"})}function la(t){return t.toISOString()}function ua(t,e,n){function i(e){return t(e)}function r(t,n){var i=t[1]-t[0],r=i/n,o=fa.bisect(nu,r);return o==nu.length?[e.year,io(t.map(function(t){return t/31536e6}),n)[2]]:o?e[r/nu[o-1]<nu[o]/r?o-1:o]:[ou,io(t,n)[2]]}return i.invert=function(e){return ca(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(ca)},i.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,ca(+n+1),e).length}var o=i.domain(),a=Kr(o),s=null==t?r(a,10):"number"==typeof t&&r(a,t);return s&&(t=s[0],e=s[1]),i.domain($r(o,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=ca(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=ca(+e+1);return e}}:t))},i.ticks=function(t,e){var n=Kr(i.domain()),o=null==t?r(n,10):"number"==typeof t?r(n,t):!t.range&&[{range:t},e];return o&&(t=o[0],e=o[1]),t.range(n[0],ca(+n[1]+1),1>e?1:e)},i.tickFormat=function(){return n},i.copy=function(){return ua(t.copy(),e,n)},eo(i,t)}function ca(t){return new Date(t)}function ha(t){return JSON.parse(t.responseText)}function da(t){var e=ga.createRange();return e.selectNode(ga.body),e.createContextualFragment(t.responseText)}var fa={version:"3.5.14"},pa=[].slice,_a=function(t){return pa.call(t)},ga=this.document;if(ga)try{_a(ga.documentElement.childNodes)[0].nodeType}catch(ma){_a=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),ga)try{ga.createElement("DIV").style.setProperty("opacity",0,"")}catch(va){var ya=this.Element.prototype,ba=ya.setAttribute,xa=ya.setAttributeNS,wa=this.CSSStyleDeclaration.prototype,Sa=wa.setProperty;ya.setAttribute=function(t,e){ba.call(this,t,e+"")},ya.setAttributeNS=function(t,e,n){xa.call(this,t,e,n+"")},wa.setProperty=function(t,e,n){Sa.call(this,t,e+"",n)}}fa.ascending=s,fa.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:NaN},fa.min=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},fa.max=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},fa.extent=function(t,e){var n,i,r,o=-1,a=t.length;if(1===arguments.length){for(;++o<a;)if(null!=(i=t[o])&&i>=i){n=r=i;break}for(;++o<a;)null!=(i=t[o])&&(n>i&&(n=i),i>r&&(r=i))}else{for(;++o<a;)if(null!=(i=e.call(t,t[o],o))&&i>=i){n=r=i;break}for(;++o<a;)null!=(i=e.call(t,t[o],o))&&(n>i&&(n=i),i>r&&(r=i))}return[n,r]},fa.sum=function(t,e){var n,i=0,r=t.length,o=-1;if(1===arguments.length)for(;++o<r;)u(n=+t[o])&&(i+=n);else for(;++o<r;)u(n=+e.call(t,t[o],o))&&(i+=n);return i},fa.mean=function(t,e){var n,i=0,r=t.length,o=-1,a=r;if(1===arguments.length)for(;++o<r;)u(n=l(t[o]))?i+=n:--a;else for(;++o<r;)u(n=l(e.call(t,t[o],o)))?i+=n:--a;return a?i/a:void 0},fa.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],o=n-i;return o?r+o*(t[i]-r):r},fa.median=function(t,e){var n,i=[],r=t.length,o=-1;if(1===arguments.length)for(;++o<r;)u(n=l(t[o]))&&i.push(n);else for(;++o<r;)u(n=l(e.call(t,t[o],o)))&&i.push(n);return i.length?fa.quantile(i.sort(s),.5):void 0},fa.variance=function(t,e){var n,i,r=t.length,o=0,a=0,s=-1,c=0;if(1===arguments.length)for(;++s<r;)u(n=l(t[s]))&&(i=n-o,o+=i/++c,a+=i*(n-o));else for(;++s<r;)u(n=l(e.call(t,t[s],s)))&&(i=n-o,o+=i/++c,a+=i*(n-o));return c>1?a/(c-1):void 0},fa.deviation=function(){var t=fa.variance.apply(this,arguments);return t?Math.sqrt(t):t};var Aa=c(s);fa.bisectLeft=Aa.left,fa.bisect=fa.bisectRight=Aa.right,fa.bisector=function(t){return c(1===t.length?function(e,n){return s(t(e),n)}:t)},fa.shuffle=function(t,e,n){(o=arguments.length)<3&&(n=t.length,2>o&&(e=0));for(var i,r,o=n-e;o;)r=Math.random()*o--|0,i=t[o+e],t[o+e]=t[r+e],t[r+e]=i;return t},fa.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},fa.pairs=function(t){for(var e,n=0,i=t.length-1,r=t[0],o=new Array(0>i?0:i);i>n;)o[n]=[e=r,r=t[++n]];return o},fa.zip=function(){if(!(i=arguments.length))return[];for(var t=-1,e=fa.min(arguments,h),n=new Array(e);++t<e;)for(var i,r=-1,o=n[t]=new Array(i);++r<i;)o[r]=arguments[r][t];return n},fa.transpose=function(t){return fa.zip.apply(fa,t)},fa.keys=function(t){var e=[];for(var n in t)e.push(n);return e},fa.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},fa.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},fa.merge=function(t){for(var e,n,i,r=t.length,o=-1,a=0;++o<r;)a+=t[o].length;for(n=new Array(a);--r>=0;)for(i=t[r],e=i.length;--e>=0;)n[--a]=i[e];return n};var ka=Math.abs;fa.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n===1/0)throw new Error("infinite range");var i,r=[],o=d(ka(n)),a=-1;if(t*=o,e*=o,n*=o,0>n)for(;(i=t+n*++a)>e;)r.push(i/o);else for(;(i=t+n*++a)<e;)r.push(i/o);return r},fa.map=function(t,e){var n=new p;if(t instanceof p)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var i,r=-1,o=t.length;if(1===arguments.length)for(;++r<o;)n.set(r,t[r]);else for(;++r<o;)n.set(e.call(t,i=t[r],r),i)}else for(var a in t)n.set(a,t[a]);return n};var Ca="__proto__",Ta="\x00";f(p,{has:m,get:function(t){return this._[_(t)]},set:function(t,e){return this._[_(t)]=e},remove:v,keys:y,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:g(e),value:this._[e]});return t},size:b,empty:x,forEach:function(t){for(var e in this._)t.call(this,g(e),this._[e])}}),fa.nest=function(){function t(e,a,s){if(s>=o.length)return i?i.call(r,a):n?a.sort(n):a;for(var l,u,c,h,d=-1,f=a.length,_=o[s++],g=new p;++d<f;)(h=g.get(l=_(u=a[d])))?h.push(u):g.set(l,[u]);return e?(u=e(),c=function(n,i){u.set(n,t(e,i,s))}):(u={},c=function(n,i){u[n]=t(e,i,s)}),g.forEach(c),u}function e(t,n){if(n>=o.length)return t;var i=[],r=a[n++];return t.forEach(function(t,r){i.push({key:t,values:e(r,n)})}),r?i.sort(function(t,e){return r(t.key,e.key)}):i}var n,i,r={},o=[],a=[];return r.map=function(e,n){return t(n,e,0)},r.entries=function(n){return e(t(fa.map,n,0),0)},r.key=function(t){return o.push(t),r},r.sortKeys=function(t){return a[o.length-1]=t,r},r.sortValues=function(t){return n=t,r},r.rollup=function(t){return i=t,r},r},fa.set=function(t){var e=new w;if(t)for(var n=0,i=t.length;i>n;++n)e.add(t[n]);return e},f(w,{has:m,add:function(t){return this._[_(t+="")]=!0,t},remove:v,values:y,size:b,empty:x,forEach:function(t){for(var e in this._)t.call(this,g(e))}}),fa.behavior={},fa.rebind=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=A(t,e,e[n]);return t};var Ea=["webkit","ms","moz","Moz","o","O"];fa.dispatch=function(){for(var t=new T,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=E(t);return t},T.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},fa.event=null,fa.requote=function(t){return t.replace(Ma,"\\$&")};var Ma=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,La={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},Ra=function(t,e){return e.querySelector(t)},Oa=function(t,e){return e.querySelectorAll(t)},Pa=function(t,e){var n=t.matches||t[k(t,"matchesSelector")];return(Pa=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(Ra=function(t,e){return Sizzle(t,e)[0]||null},Oa=Sizzle,Pa=Sizzle.matchesSelector),fa.selection=function(){return fa.select(ga.documentElement)};var Da=fa.selection.prototype=[];Da.select=function(t){var e,n,i,r,o=[];t=P(t);for(var a=-1,s=this.length;++a<s;){o.push(e=[]),e.parentNode=(i=this[a]).parentNode;for(var l=-1,u=i.length;++l<u;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l,a)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return O(o)},Da.selectAll=function(t){var e,n,i=[];t=D(t);for(var r=-1,o=this.length;++r<o;)for(var a=this[r],s=-1,l=a.length;++s<l;)(n=a[s])&&(i.push(e=_a(t.call(n,n.__data__,s,r))),e.parentNode=n);return O(i)};var Ia={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};fa.ns={prefix:Ia,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),Ia.hasOwnProperty(n)?{space:Ia[n],local:t}:t}},Da.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=fa.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(I(e,t[e]));return this}return this.each(I(t,e))},Da.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=B(t)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!F(t[r]).test(e))return!1;return!0}for(e in t)this.each(z(e,t[e]));return this}return this.each(z(t,e))},Da.style=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e="");for(n in t)this.each(q(n,t[n],e));return this}if(2>i){var r=this.node();return a(r).getComputedStyle(r,null).getPropertyValue(t)}n=""}return this.each(q(t,e,n))},Da.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(G(e,t[e]));return this}return this.each(G(t,e))},Da.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},Da.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},Da.append=function(t){return t=j(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},Da.insert=function(t,e){return t=j(t),e=P(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},Da.remove=function(){return this.each(U)},Da.data=function(t,e){function n(t,n){var i,r,o,a=t.length,c=n.length,h=Math.min(a,c),d=new Array(c),f=new Array(c),_=new Array(a);if(e){var g,m=new p,v=new Array(a);for(i=-1;++i<a;)(r=t[i])&&(m.has(g=e.call(r,r.__data__,i))?_[i]=r:m.set(g,r),v[i]=g);for(i=-1;++i<c;)(r=m.get(g=e.call(n,o=n[i],i)))?r!==!0&&(d[i]=r,r.__data__=o):f[i]=V(o),m.set(g,!0);for(i=-1;++i<a;)i in v&&m.get(v[i])!==!0&&(_[i]=t[i])}else{for(i=-1;++i<h;)r=t[i],o=n[i],r?(r.__data__=o,d[i]=r):f[i]=V(o);for(;c>i;++i)f[i]=V(n[i]);for(;a>i;++i)_[i]=t[i]}f.update=d,f.parentNode=d.parentNode=_.parentNode=t.parentNode,s.push(f),l.push(d),u.push(_)}var i,r,o=-1,a=this.length;if(!arguments.length){for(t=new Array(a=(i=this[0]).length);++o<a;)(r=i[o])&&(t[o]=r.__data__);return t}var s=Y([]),l=O([]),u=O([]);if("function"==typeof t)for(;++o<a;)n(i=this[o],t.call(i,i.parentNode.__data__,o));else for(;++o<a;)n(i=this[o],t);return l.enter=function(){return s},l.exit=function(){return u},l},Da.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__");
},Da.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=W(t));for(var o=0,a=this.length;a>o;o++){r.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var s=0,l=n.length;l>s;s++)(i=n[s])&&t.call(i,i.__data__,s,o)&&e.push(i)}return O(r)},Da.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],r=i.length-1,o=i[r];--r>=0;)(n=i[r])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},Da.sort=function(t){t=X.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},Da.each=function(t){return K(this,function(e,n,i){t.call(e,e.__data__,n,i)})},Da.call=function(t){var e=_a(arguments);return t.apply(e[0]=this,e),this},Da.empty=function(){return!this.node()},Da.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],i=0,r=n.length;r>i;i++){var o=n[i];if(o)return o}return null},Da.size=function(){var t=0;return K(this,function(){++t}),t};var Na=[];fa.selection.enter=Y,fa.selection.enter.prototype=Na,Na.append=Da.append,Na.empty=Da.empty,Na.node=Da.node,Na.call=Da.call,Na.size=Da.size,Na.select=function(t){for(var e,n,i,r,o,a=[],s=-1,l=this.length;++s<l;){i=(r=this[s]).update,a.push(e=[]),e.parentNode=r.parentNode;for(var u=-1,c=r.length;++u<c;)(o=r[u])?(e.push(i[u]=n=t.call(r.parentNode,o.__data__,u,s)),n.__data__=o.__data__):e.push(null)}return O(a)},Na.insert=function(t,e){return arguments.length<2&&(e=Z(this)),Da.insert.call(this,t,e)},fa.select=function(t){var e;return"string"==typeof t?(e=[Ra(t,ga)],e.parentNode=ga.documentElement):(e=[t],e.parentNode=o(t)),O([e])},fa.selectAll=function(t){var e;return"string"==typeof t?(e=_a(Oa(t,ga)),e.parentNode=ga.documentElement):(e=_a(t),e.parentNode=null),O([e])},Da.on=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e=!1);for(n in t)this.each($(n,t[n],e));return this}if(2>i)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each($(t,e,n))};var Fa=fa.map({mouseenter:"mouseover",mouseleave:"mouseout"});ga&&Fa.forEach(function(t){"on"+t in ga&&Fa.remove(t)});var Ba,za=0;fa.mouse=function(t){return et(t,L())};var Ha=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;fa.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=L().changedTouches),e)for(var i,r=0,o=e.length;o>r;++r)if((i=e[r]).identifier===n)return et(t,i)},fa.behavior.drag=function(){function t(){this.on("mousedown.drag",r).on("touchstart.drag",o)}function e(t,e,r,o,a){return function(){function s(){var t,n,i=e(d,_);i&&(t=i[0]-y[0],n=i[1]-y[1],p|=t|n,y=i,f({type:"drag",x:i[0]+u[0],y:i[1]+u[1],dx:t,dy:n}))}function l(){e(d,_)&&(m.on(o+g,null).on(a+g,null),v(p),f({type:"dragend"}))}var u,c=this,h=fa.event.target,d=c.parentNode,f=n.of(c,arguments),p=0,_=t(),g=".drag"+(null==_?"":"-"+_),m=fa.select(r(h)).on(o+g,s).on(a+g,l),v=tt(h),y=e(d,_);i?(u=i.apply(c,arguments),u=[u.x-y[0],u.y-y[1]]):u=[0,0],f({type:"dragstart"})}}var n=R(t,"drag","dragstart","dragend"),i=null,r=e(C,fa.mouse,a,"mousemove","mouseup"),o=e(nt,fa.touch,S,"touchmove","touchend");return t.origin=function(e){return arguments.length?(i=e,t):i},fa.rebind(t,n,"on")},fa.touches=function(t,e){return arguments.length<2&&(e=L().touches),e?_a(e).map(function(e){var n=et(t,e);return n.identifier=e.identifier,n}):[]};var qa=1e-6,Ga=qa*qa,ja=Math.PI,Ua=2*ja,Va=Ua-qa,Wa=ja/2,Xa=ja/180,Ka=180/ja,Ya=Math.SQRT2,Za=2,$a=4;fa.interpolateZoom=function(t,e){var n,i,r=t[0],o=t[1],a=t[2],s=e[0],l=e[1],u=e[2],c=s-r,h=l-o,d=c*c+h*h;if(Ga>d)i=Math.log(u/a)/Ya,n=function(t){return[r+t*c,o+t*h,a*Math.exp(Ya*t*i)]};else{var f=Math.sqrt(d),p=(u*u-a*a+$a*d)/(2*a*Za*f),_=(u*u-a*a-$a*d)/(2*u*Za*f),g=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(_*_+1)-_);i=(m-g)/Ya,n=function(t){var e=t*i,n=lt(g),s=a/(Za*f)*(n*ut(Ya*e+g)-st(g));return[r+s*c,o+s*h,a*n/lt(Ya*e+g)]}}return n.duration=1e3*i,n},fa.behavior.zoom=function(){function t(t){t.on(L,h).on(Qa+".zoom",f).on("dblclick.zoom",p).on(D,d)}function e(t){return[(t[0]-A.x)/A.k,(t[1]-A.y)/A.k]}function n(t){return[t[0]*A.k+A.x,t[1]*A.k+A.y]}function i(t){A.k=Math.max(C[0],Math.min(C[1],t))}function r(t,e){e=n(e),A.x+=t[0]-e[0],A.y+=t[1]-e[1]}function o(e,n,o,a){e.__chart__={x:A.x,y:A.y,k:A.k},i(Math.pow(2,a)),r(g=n,o),e=fa.select(e),T>0&&(e=e.transition().duration(T)),e.call(t.event)}function s(){x&&x.domain(b.range().map(function(t){return(t-A.x)/A.k}).map(b.invert)),S&&S.domain(w.range().map(function(t){return(t-A.y)/A.k}).map(w.invert))}function l(t){E++||t({type:"zoomstart"})}function u(t){s(),t({type:"zoom",scale:A.k,translate:[A.x,A.y]})}function c(t){--E||(t({type:"zoomend"}),g=null)}function h(){function t(){s=1,r(fa.mouse(i),d),u(o)}function n(){h.on(O,null).on(P,null),f(s),c(o)}var i=this,o=I.of(i,arguments),s=0,h=fa.select(a(i)).on(O,t).on(P,n),d=e(fa.mouse(i)),f=tt(i);Wl.call(i),l(o)}function d(){function t(){var t=fa.touches(p);return f=A.k,t.forEach(function(t){t.identifier in g&&(g[t.identifier]=e(t))}),t}function n(){var e=fa.event.target;fa.select(e).on(b,a).on(x,s),w.push(e);for(var n=fa.event.changedTouches,i=0,r=n.length;r>i;++i)g[n[i].identifier]=null;var l=t(),u=Date.now();if(1===l.length){if(500>u-y){var c=l[0];o(p,c,g[c.identifier],Math.floor(Math.log(A.k)/Math.LN2)+1),M()}y=u}else if(l.length>1){var c=l[0],h=l[1],d=c[0]-h[0],f=c[1]-h[1];m=d*d+f*f}}function a(){var t,e,n,o,a=fa.touches(p);Wl.call(p);for(var s=0,l=a.length;l>s;++s,o=null)if(n=a[s],o=g[n.identifier]){if(e)break;t=n,e=o}if(o){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,h=m&&Math.sqrt(c/m);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+o[0])/2,(e[1]+o[1])/2],i(h*f)}y=null,r(t,e),u(_)}function s(){if(fa.event.touches.length){for(var e=fa.event.changedTouches,n=0,i=e.length;i>n;++n)delete g[e[n].identifier];for(var r in g)return void t()}fa.selectAll(w).on(v,null),S.on(L,h).on(D,d),k(),c(_)}var f,p=this,_=I.of(p,arguments),g={},m=0,v=".zoom-"+fa.event.changedTouches[0].identifier,b="touchmove"+v,x="touchend"+v,w=[],S=fa.select(p),k=tt(p);n(),l(_),S.on(L,null).on(D,n)}function f(){var t=I.of(this,arguments);v?clearTimeout(v):(Wl.call(this),_=e(g=m||fa.mouse(this)),l(t)),v=setTimeout(function(){v=null,c(t)},50),M(),i(Math.pow(2,.002*Ja())*A.k),r(g,_),u(t)}function p(){var t=fa.mouse(this),n=Math.log(A.k)/Math.LN2;o(this,t,e(t),fa.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}var _,g,m,v,y,b,x,w,S,A={x:0,y:0,k:1},k=[960,500],C=ts,T=250,E=0,L="mousedown.zoom",O="mousemove.zoom",P="mouseup.zoom",D="touchstart.zoom",I=R(t,"zoomstart","zoom","zoomend");return Qa||(Qa="onwheel"in ga?(Ja=function(){return-fa.event.deltaY*(fa.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ga?(Ja=function(){return fa.event.wheelDelta},"mousewheel"):(Ja=function(){return-fa.event.detail},"MozMousePixelScroll")),t.event=function(t){t.each(function(){var t=I.of(this,arguments),e=A;Ul?fa.select(this).transition().each("start.zoom",function(){A=this.__chart__||{x:0,y:0,k:1},l(t)}).tween("zoom:zoom",function(){var n=k[0],i=k[1],r=g?g[0]:n/2,o=g?g[1]:i/2,a=fa.interpolateZoom([(r-A.x)/A.k,(o-A.y)/A.k,n/A.k],[(r-e.x)/e.k,(o-e.y)/e.k,n/e.k]);return function(e){var i=a(e),s=n/i[2];this.__chart__=A={x:r-i[0]*s,y:o-i[1]*s,k:s},u(t)}}).each("interrupt.zoom",function(){c(t)}).each("end.zoom",function(){c(t)}):(this.__chart__=A,l(t),u(t),c(t))})},t.translate=function(e){return arguments.length?(A={x:+e[0],y:+e[1],k:A.k},s(),t):[A.x,A.y]},t.scale=function(e){return arguments.length?(A={x:A.x,y:A.y,k:null},i(+e),s(),t):A.k},t.scaleExtent=function(e){return arguments.length?(C=null==e?ts:[+e[0],+e[1]],t):C},t.center=function(e){return arguments.length?(m=e&&[+e[0],+e[1]],t):m},t.size=function(e){return arguments.length?(k=e&&[+e[0],+e[1]],t):k},t.duration=function(e){return arguments.length?(T=+e,t):T},t.x=function(e){return arguments.length?(x=e,b=e.copy(),A={x:0,y:0,k:1},t):x},t.y=function(e){return arguments.length?(S=e,w=e.copy(),A={x:0,y:0,k:1},t):S},fa.rebind(t,I,"on")};var Ja,Qa,ts=[0,1/0];fa.color=ht,ht.prototype.toString=function(){return this.rgb()+""},fa.hsl=dt;var es=dt.prototype=new ht;es.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new dt(this.h,this.s,this.l/t)},es.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new dt(this.h,this.s,t*this.l)},es.rgb=function(){return ft(this.h,this.s,this.l)},fa.hcl=pt;var ns=pt.prototype=new ht;ns.brighter=function(t){return new pt(this.h,this.c,Math.min(100,this.l+is*(arguments.length?t:1)))},ns.darker=function(t){return new pt(this.h,this.c,Math.max(0,this.l-is*(arguments.length?t:1)))},ns.rgb=function(){return _t(this.h,this.c,this.l).rgb()},fa.lab=gt;var is=18,rs=.95047,os=1,as=1.08883,ss=gt.prototype=new ht;ss.brighter=function(t){return new gt(Math.min(100,this.l+is*(arguments.length?t:1)),this.a,this.b)},ss.darker=function(t){return new gt(Math.max(0,this.l-is*(arguments.length?t:1)),this.a,this.b)},ss.rgb=function(){return mt(this.l,this.a,this.b)},fa.rgb=wt;var ls=wt.prototype=new ht;ls.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&r>e&&(e=r),n&&r>n&&(n=r),i&&r>i&&(i=r),new wt(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,i/t))):new wt(r,r,r)},ls.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new wt(t*this.r,t*this.g,t*this.b)},ls.hsl=function(){return Tt(this.r,this.g,this.b)},ls.toString=function(){return"#"+kt(this.r)+kt(this.g)+kt(this.b)};var us=fa.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});us.forEach(function(t,e){us.set(t,St(e))}),fa.functor=Rt,fa.xhr=Ot(S),fa.dsv=function(t,e){function n(t,n,o){arguments.length<3&&(o=n,n=null);var a=Pt(t,e,null==n?i:r(n),o);return a.row=function(t){return arguments.length?a.response(null==(n=t)?i:r(t)):n},a}function i(t){return n.parse(t.responseText)}function r(t){return function(e){return n.parse(e.responseText,t)}}function o(e){return e.map(a).join(t)}function a(t){return s.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var s=new RegExp('["'+t+"\n]"),l=t.charCodeAt(0);return n.parse=function(t,e){var i;return n.parseRows(t,function(t,n){if(i)return i(t,n-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");i=e?function(t,n){return e(r(t),n)}:r})},n.parseRows=function(t,e){function n(){if(c>=u)return a;if(r)return r=!1,o;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<u;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var i=t.charCodeAt(n+1);return 13===i?(r=!0,10===t.charCodeAt(n+2)&&++c):10===i&&(r=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;u>c;){var i=t.charCodeAt(c++),s=1;if(10===i)r=!0;else if(13===i)r=!0,10===t.charCodeAt(c)&&(++c,++s);else if(i!==l)continue;return t.slice(e,c-s)}return t.slice(e)}for(var i,r,o={},a={},s=[],u=t.length,c=0,h=0;(i=n())!==a;){for(var d=[];i!==o&&i!==a;)d.push(i),i=n();e&&null==(d=e(d,h++))||s.push(d)}return s},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var i=new w,r=[];return e.forEach(function(t){for(var e in t)i.has(e)||r.push(i.add(e))}),[r.map(a).join(t)].concat(e.map(function(e){return r.map(function(t){return a(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(o).join("\n")},n},fa.csv=fa.dsv(",","text/csv"),fa.tsv=fa.dsv("	","text/tab-separated-values");var cs,hs,ds,fs,ps=this[k(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};fa.timer=function(){Nt.apply(this,arguments)},fa.timer.flush=function(){Bt(),zt()},fa.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var _s=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(qt);fa.formatPrefix=function(t,e){var n=0;return(t=+t)&&(0>t&&(t*=-1),e&&(t=fa.round(t,Ht(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),_s[8+n/3]};var gs=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ms=fa.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=fa.round(t,Ht(t,e))).toFixed(Math.max(0,Math.min(20,Ht(t*(1+1e-15),e))))}}),vs=fa.time={},ys=Date;Ut.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){bs.setUTCDate.apply(this._,arguments)},setDay:function(){bs.setUTCDay.apply(this._,arguments)},setFullYear:function(){bs.setUTCFullYear.apply(this._,arguments)},setHours:function(){bs.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){bs.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){bs.setUTCMinutes.apply(this._,arguments)},setMonth:function(){bs.setUTCMonth.apply(this._,arguments)},setSeconds:function(){bs.setUTCSeconds.apply(this._,arguments)},setTime:function(){bs.setTime.apply(this._,arguments)}};var bs=Date.prototype;vs.year=Vt(function(t){return t=vs.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),vs.years=vs.year.range,vs.years.utc=vs.year.utc.range,vs.day=Vt(function(t){var e=new ys(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),vs.days=vs.day.range,vs.days.utc=vs.day.utc.range,vs.dayOfYear=function(t){var e=vs.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=vs[t]=Vt(function(t){return(t=vs.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=vs.year(t).getDay();return Math.floor((vs.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});vs[t+"s"]=n.range,vs[t+"s"].utc=n.utc.range,vs[t+"OfYear"]=function(t){var n=vs.year(t).getDay();return Math.floor((vs.dayOfYear(t)+(n+e)%7)/7)}}),vs.week=vs.sunday,vs.weeks=vs.sunday.range,vs.weeks.utc=vs.sunday.utc.range,vs.weekOfYear=vs.sundayOfYear;var xs={"-":"",_:" ",0:"0"},ws=/^\s*\d+/,Ss=/^%/;fa.locale=function(t){return{numberFormat:Gt(t),timeFormat:Xt(t)}};var As=fa.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});fa.format=As.numberFormat,fa.geo={},pe.prototype={s:0,t:0,add:function(t){_e(t,this.t,ks),_e(ks.s,this.s,this),this.s?this.t+=ks.t:this.s=ks.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ks=new pe;fa.geo.stream=function(t,e){t&&Cs.hasOwnProperty(t.type)?Cs[t.type](t,e):ge(t,e)};var Cs={Feature:function(t,e){ge(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)ge(n[i].geometry,e)}},Ts={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){me(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)me(n[i],e,0)},Polygon:function(t,e){ve(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)ve(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)ge(n[i],e)}};fa.geo.area=function(t){return Es=0,fa.geo.stream(t,Ls),Es};var Es,Ms=new pe,Ls={sphere:function(){Es+=4*ja},point:C,lineStart:C,lineEnd:C,polygonStart:function(){Ms.reset(),Ls.lineStart=ye},polygonEnd:function(){var t=2*Ms;Es+=0>t?4*ja+t:t,Ls.lineStart=Ls.lineEnd=Ls.point=C}};fa.geo.bounds=function(){function t(t,e){y.push(b=[c=t,d=t]),h>e&&(h=e),e>f&&(f=e)}function e(e,n){var i=be([e*Xa,n*Xa]);if(m){var r=we(m,i),o=[r[1],-r[0],0],a=we(o,r);ke(a),a=Ce(a);var l=e-p,u=l>0?1:-1,_=a[0]*Ka*u,g=ka(l)>180;if(g^(_>u*p&&u*e>_)){var v=a[1]*Ka;v>f&&(f=v)}else if(_=(_+360)%360-180,g^(_>u*p&&u*e>_)){var v=-a[1]*Ka;h>v&&(h=v)}else h>n&&(h=n),n>f&&(f=n);g?p>e?s(c,e)>s(c,d)&&(d=e):s(e,d)>s(c,d)&&(c=e):d>=c?(c>e&&(c=e),e>d&&(d=e)):e>p?s(c,e)>s(c,d)&&(d=e):s(e,d)>s(c,d)&&(c=e)}else t(e,n);m=i,p=e}function n(){x.point=e}function i(){b[0]=c,b[1]=d,x.point=t,m=null}function r(t,n){if(m){var i=t-p;v+=ka(i)>180?i+(i>0?360:-360):i}else _=t,g=n;Ls.point(t,n),e(t,n)}function o(){Ls.lineStart()}function a(){r(_,g),Ls.lineEnd(),ka(v)>qa&&(c=-(d=180)),b[0]=c,b[1]=d,m=null}function s(t,e){return(e-=t)<0?e+360:e}function l(t,e){return t[0]-e[0]}function u(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,h,d,f,p,_,g,m,v,y,b,x={point:t,lineStart:n,lineEnd:i,polygonStart:function(){x.point=r,x.lineStart=o,x.lineEnd=a,v=0,Ls.polygonStart()},polygonEnd:function(){Ls.polygonEnd(),x.point=t,x.lineStart=n,x.lineEnd=i,0>Ms?(c=-(d=180),h=-(f=90)):v>qa?f=90:-qa>v&&(h=-90),b[0]=c,b[1]=d}};return function(t){f=d=-(c=h=1/0),y=[],fa.geo.stream(t,x);var e=y.length;if(e){y.sort(l);for(var n,i=1,r=y[0],o=[r];e>i;++i)n=y[i],u(n[0],r)||u(n[1],r)?(s(r[0],n[1])>s(r[0],r[1])&&(r[1]=n[1]),s(n[0],r[1])>s(r[0],r[1])&&(r[0]=n[0])):o.push(r=n);for(var a,n,p=-(1/0),e=o.length-1,i=0,r=o[e];e>=i;r=n,++i)n=o[i],(a=s(r[1],n[0]))>p&&(p=a,c=n[0],d=r[1])}return y=b=null,c===1/0||h===1/0?[[NaN,NaN],[NaN,NaN]]:[[c,h],[d,f]]}}(),fa.geo.centroid=function(t){Rs=Os=Ps=Ds=Is=Ns=Fs=Bs=zs=Hs=qs=0,fa.geo.stream(t,Gs);var e=zs,n=Hs,i=qs,r=e*e+n*n+i*i;return Ga>r&&(e=Ns,n=Fs,i=Bs,qa>Os&&(e=Ps,n=Ds,i=Is),r=e*e+n*n+i*i,Ga>r)?[NaN,NaN]:[Math.atan2(n,e)*Ka,at(i/Math.sqrt(r))*Ka]};var Rs,Os,Ps,Ds,Is,Ns,Fs,Bs,zs,Hs,qs,Gs={sphere:C,point:Ee,lineStart:Le,lineEnd:Re,polygonStart:function(){Gs.lineStart=Oe},polygonEnd:function(){Gs.lineStart=Le}},js=Be(De,Ge,Ue,[-ja,-ja/2]),Us=1e9;fa.geo.clipExtent=function(){var t,e,n,i,r,o,a={stream:function(t){return r&&(r.valid=!1),r=o(t),r.valid=!0,r},extent:function(s){return arguments.length?(o=Ke(t=+s[0][0],e=+s[0][1],n=+s[1][0],i=+s[1][1]),r&&(r.valid=!1,r=null),a):[[t,e],[n,i]]}};return a.extent([[0,0],[960,500]])},(fa.geo.conicEqualArea=function(){return Ye(Ze)}).raw=Ze,fa.geo.albers=function(){return fa.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},fa.geo.albersUsa=function(){function t(t){var o=t[0],a=t[1];return e=null,n(o,a),e||(i(o,a),e)||r(o,a),e}var e,n,i,r,o=fa.geo.albers(),a=fa.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=fa.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=o.scale(),n=o.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&.234>r&&i>=-.425&&-.214>i?a:r>=.166&&.234>r&&i>=-.214&&-.115>i?s:o).invert(t)},t.stream=function(t){var e=o.stream(t),n=a.stream(t),i=s.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},t.precision=function(e){return arguments.length?(o.precision(e),a.precision(e),s.precision(e),t):o.precision()},t.scale=function(e){return arguments.length?(o.scale(e),a.scale(.35*e),s.scale(e),t.translate(o.translate())):o.scale()},t.translate=function(e){if(!arguments.length)return o.translate();var u=o.scale(),c=+e[0],h=+e[1];return n=o.translate(e).clipExtent([[c-.455*u,h-.238*u],[c+.455*u,h+.238*u]]).stream(l).point,i=a.translate([c-.307*u,h+.201*u]).clipExtent([[c-.425*u+qa,h+.12*u+qa],[c-.214*u-qa,h+.234*u-qa]]).stream(l).point,r=s.translate([c-.205*u,h+.212*u]).clipExtent([[c-.214*u+qa,h+.166*u+qa],[c-.115*u-qa,h+.234*u-qa]]).stream(l).point,t},t.scale(1070)};var Vs,Ws,Xs,Ks,Ys,Zs,$s={point:C,lineStart:C,lineEnd:C,polygonStart:function(){Ws=0,$s.lineStart=$e},polygonEnd:function(){$s.lineStart=$s.lineEnd=$s.point=C,Vs+=ka(Ws/2)}},Js={point:Je,lineStart:C,lineEnd:C,polygonStart:C,polygonEnd:C},Qs={point:en,lineStart:nn,lineEnd:rn,polygonStart:function(){Qs.lineStart=on},polygonEnd:function(){Qs.point=en,Qs.lineStart=nn,Qs.lineEnd=rn}};fa.geo.path=function(){function t(t){return t&&("function"==typeof s&&o.pointRadius(+s.apply(this,arguments)),a&&a.valid||(a=r(o)),fa.geo.stream(t,a)),o.result()}function e(){return a=null,t}var n,i,r,o,a,s=4.5;return t.area=function(t){return Vs=0,fa.geo.stream(t,r($s)),Vs},t.centroid=function(t){return Ps=Ds=Is=Ns=Fs=Bs=zs=Hs=qs=0,fa.geo.stream(t,r(Qs)),qs?[zs/qs,Hs/qs]:Bs?[Ns/Bs,Fs/Bs]:Is?[Ps/Is,Ds/Is]:[NaN,NaN]},t.bounds=function(t){return Ys=Zs=-(Xs=Ks=1/0),fa.geo.stream(t,r(Js)),[[Xs,Ks],[Ys,Zs]]},t.projection=function(t){return arguments.length?(r=(n=t)?t.stream||ln(t):S,e()):n},t.context=function(t){return arguments.length?(o=null==(i=t)?new Qe:new an(t),"function"!=typeof s&&o.pointRadius(s),e()):i},t.pointRadius=function(e){return arguments.length?(s="function"==typeof e?e:(o.pointRadius(+e),+e),t):s},t.projection(fa.geo.albersUsa()).context(null)},fa.geo.transform=function(t){return{stream:function(e){var n=new un(e);for(var i in t)n[i]=t[i];return n}}},un.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},fa.geo.projection=hn,fa.geo.projectionMutator=dn,(fa.geo.equirectangular=function(){return hn(pn)}).raw=pn.invert=pn,fa.geo.rotation=function(t){function e(e){return e=t(e[0]*Xa,e[1]*Xa),e[0]*=Ka,e[1]*=Ka,e}return t=gn(t[0]%360*Xa,t[1]*Xa,t.length>2?t[2]*Xa:0),e.invert=function(e){return e=t.invert(e[0]*Xa,e[1]*Xa),e[0]*=Ka,e[1]*=Ka,e},e},_n.invert=pn,fa.geo.circle=function(){function t(){var t="function"==typeof i?i.apply(this,arguments):i,e=gn(-t[0]*Xa,-t[1]*Xa,0).invert,r=[];return n(null,null,1,{point:function(t,n){r.push(t=e(t,n)),t[0]*=Ka,t[1]*=Ka}}),{type:"Polygon",coordinates:[r]}}var e,n,i=[0,0],r=6;return t.origin=function(e){return arguments.length?(i=e,t):i},t.angle=function(i){return arguments.length?(n=bn((e=+i)*Xa,r*Xa),t):e},t.precision=function(i){return arguments.length?(n=bn(e*Xa,(r=+i)*Xa),t):r},t.angle(90)},fa.geo.distance=function(t,e){var n,i=(e[0]-t[0])*Xa,r=t[1]*Xa,o=e[1]*Xa,a=Math.sin(i),s=Math.cos(i),l=Math.sin(r),u=Math.cos(r),c=Math.sin(o),h=Math.cos(o);return Math.atan2(Math.sqrt((n=h*a)*n+(n=u*c-l*h*s)*n),l*c+u*h*s)},fa.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return fa.range(Math.ceil(o/g)*g,r,g).map(d).concat(fa.range(Math.ceil(u/m)*m,l,m).map(f)).concat(fa.range(Math.ceil(i/p)*p,n,p).filter(function(t){return ka(t%g)>qa}).map(c)).concat(fa.range(Math.ceil(s/_)*_,a,_).filter(function(t){return ka(t%m)>qa}).map(h))}var n,i,r,o,a,s,l,u,c,h,d,f,p=10,_=p,g=90,m=360,v=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[d(o).concat(f(l).slice(1),d(r).reverse().slice(1),f(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(o=+e[0][0],r=+e[1][0],u=+e[0][1],l=+e[1][1],o>r&&(e=o,o=r,r=e),u>l&&(e=u,u=l,l=e),t.precision(v)):[[o,u],[r,l]]},t.minorExtent=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],i>n&&(e=i,i=n,n=e),s>a&&(e=s,s=a,a=e),t.precision(v)):[[i,s],[n,a]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(g=+e[0],m=+e[1],t):[g,m]},t.minorStep=function(e){return arguments.length?(p=+e[0],_=+e[1],t):[p,_]},t.precision=function(e){return arguments.length?(v=+e,c=wn(s,a,90),h=Sn(i,n,v),d=wn(u,l,90),f=Sn(o,r,v),t):v},t.majorExtent([[-180,-90+qa],[180,90-qa]]).minorExtent([[-180,-80-qa],[180,80+qa]])},fa.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),n||r.apply(this,arguments)]}}var e,n,i=An,r=kn;return t.distance=function(){return fa.geo.distance(e||i.apply(this,arguments),n||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,e="function"==typeof n?null:n,t):i},t.target=function(e){return arguments.length?(r=e,n="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},fa.geo.interpolate=function(t,e){return Cn(t[0]*Xa,t[1]*Xa,e[0]*Xa,e[1]*Xa)},fa.geo.length=function(t){return tl=0,fa.geo.stream(t,el),tl};var tl,el={sphere:C,point:C,lineStart:Tn,lineEnd:C,polygonStart:C,polygonEnd:C},nl=En(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(fa.geo.azimuthalEqualArea=function(){return hn(nl)}).raw=nl;var il=En(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},S);(fa.geo.azimuthalEquidistant=function(){return hn(il)}).raw=il,(fa.geo.conicConformal=function(){return Ye(Mn)}).raw=Mn,(fa.geo.conicEquidistant=function(){return Ye(Ln)}).raw=Ln;var rl=En(function(t){return 1/t},Math.atan);(fa.geo.gnomonic=function(){return hn(rl)}).raw=rl,Rn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Wa]},(fa.geo.mercator=function(){return On(Rn)}).raw=Rn;var ol=En(function(){return 1},Math.asin);(fa.geo.orthographic=function(){return hn(ol)}).raw=ol;var al=En(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(fa.geo.stereographic=function(){return hn(al)}).raw=al,Pn.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Wa]},(fa.geo.transverseMercator=function(){var t=On(Pn),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90])}).raw=Pn,fa.geom={},fa.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,r=Rt(n),o=Rt(i),a=t.length,s=[],l=[];for(e=0;a>e;e++)s.push([+r.call(this,t[e],e),+o.call(this,t[e],e),e]);for(s.sort(Fn),e=0;a>e;e++)l.push([s[e][0],-s[e][1]]);var u=Nn(s),c=Nn(l),h=c[0]===u[0],d=c[c.length-1]===u[u.length-1],f=[];for(e=u.length-1;e>=0;--e)f.push(t[s[u[e]][2]]);for(e=+h;e<c.length-d;++e)f.push(t[s[c[e]][2]]);return f}var n=Dn,i=In;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e)},fa.geom.polygon=function(t){return La(t,sl),t};var sl=fa.geom.polygon.prototype=[];sl.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;++e<n;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},sl.centroid=function(t){var e,n,i=-1,r=this.length,o=0,a=0,s=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++i<r;)e=s,s=this[i],n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[o*t,a*t]},sl.clip=function(t){for(var e,n,i,r,o,a,s=Hn(t),l=-1,u=this.length-Hn(this),c=this[u-1];++l<u;){for(e=t.slice(),t.length=0,r=this[l],o=e[(i=e.length-s)-1],n=-1;++n<i;)a=e[n],Bn(a,c,r)?(Bn(o,c,r)||t.push(zn(o,a,c,r)),t.push(a)):Bn(o,c,r)&&t.push(zn(o,a,c,r)),o=a;s&&t.push(t[0]),c=r}return t};var ll,ul,cl,hl,dl,fl=[],pl=[];Kn.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort(Zn),e.length},ai.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},si.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=hi(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(ui(this,n),t=n,n=t.U),n.C=!1,i.C=!0,ci(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(ci(this,n),t=n,n=t.U),n.C=!1,i.C=!0,ui(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,a=t.R;if(n=o?a?hi(a):o:a,r?r.L===t?r.L=n:r.R=n:this._=n,o&&a?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=a,a.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,ui(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,ci(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,ui(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,ci(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){
e.L&&e.L.C||(e.R.C=!1,e.C=!0,ui(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,ci(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},fa.geom.voronoi=function(t){function e(t){var e=new Array(t.length),i=s[0][0],r=s[0][1],o=s[1][0],a=s[1][1];return di(n(t),s).cells.forEach(function(n,s){var l=n.edges,u=n.site,c=e[s]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=i&&u.x<=o&&u.y>=r&&u.y<=a?[[i,a],[o,a],[o,r],[i,r]]:[];c.point=t[s]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(o(t,e)/qa)*qa,y:Math.round(a(t,e)/qa)*qa,i:e}})}var i=Dn,r=In,o=i,a=r,s=_l;return t?e(t):(e.links=function(t){return di(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return di(n(t)).cells.forEach(function(n,i){for(var r,o,a=n.site,s=n.edges.sort(Zn),l=-1,u=s.length,c=s[u-1].edge,h=c.l===a?c.r:c.l;++l<u;)r=c,o=h,c=s[l].edge,h=c.l===a?c.r:c.l,i<o.i&&i<h.i&&pi(a,o,h)<0&&e.push([t[i],t[o.i],t[h.i]])}),e},e.x=function(t){return arguments.length?(o=Rt(i=t),e):i},e.y=function(t){return arguments.length?(a=Rt(r=t),e):r},e.clipExtent=function(t){return arguments.length?(s=null==t?_l:t,e):s===_l?null:s},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):s===_l?null:s&&s[1]},e)};var _l=[[-1e6,-1e6],[1e6,1e6]];fa.geom.delaunay=function(t){return fa.geom.voronoi().triangles(t)},fa.geom.quadtree=function(t,e,n,i,r){function o(t){function o(t,e,n,i,r,o,a,s){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,c=t.y;if(null!=l)if(ka(l-n)+ka(c-i)<.01)u(t,e,n,i,r,o,a,s);else{var h=t.point;t.x=t.y=t.point=null,u(t,h,l,c,r,o,a,s),u(t,e,n,i,r,o,a,s)}else t.x=n,t.y=i,t.point=e}else u(t,e,n,i,r,o,a,s)}function u(t,e,n,i,r,a,s,l){var u=.5*(r+s),c=.5*(a+l),h=n>=u,d=i>=c,f=d<<1|h;t.leaf=!1,t=t.nodes[f]||(t.nodes[f]=mi()),h?r=u:s=u,d?a=c:l=c,o(t,e,n,i,r,a,s,l)}var c,h,d,f,p,_,g,m,v,y=Rt(s),b=Rt(l);if(null!=e)_=e,g=n,m=i,v=r;else if(m=v=-(_=g=1/0),h=[],d=[],p=t.length,a)for(f=0;p>f;++f)c=t[f],c.x<_&&(_=c.x),c.y<g&&(g=c.y),c.x>m&&(m=c.x),c.y>v&&(v=c.y),h.push(c.x),d.push(c.y);else for(f=0;p>f;++f){var x=+y(c=t[f],f),w=+b(c,f);_>x&&(_=x),g>w&&(g=w),x>m&&(m=x),w>v&&(v=w),h.push(x),d.push(w)}var S=m-_,A=v-g;S>A?v=g+S:m=_+A;var k=mi();if(k.add=function(t){o(k,t,+y(t,++f),+b(t,f),_,g,m,v)},k.visit=function(t){vi(t,k,_,g,m,v)},k.find=function(t){return yi(k,t[0],t[1],_,g,m,v)},f=-1,null==e){for(;++f<p;)o(k,t[f],h[f],d[f],_,g,m,v);--f}else t.forEach(k.add);return h=d=t=c=null,k}var a,s=Dn,l=In;return(a=arguments.length)?(s=_i,l=gi,3===a&&(r=n,i=e,n=e=0),o(t)):(o.x=function(t){return arguments.length?(s=t,o):s},o.y=function(t){return arguments.length?(l=t,o):l},o.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),o):null==e?null:[[e,n],[i,r]]},o.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),o):null==e?null:[i-e,r-n]},o)},fa.interpolateRgb=bi,fa.interpolateObject=xi,fa.interpolateNumber=wi,fa.interpolateString=Si;var gl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ml=new RegExp(gl.source,"g");fa.interpolate=Ai,fa.interpolators=[function(t,e){var n=typeof e;return("string"===n?us.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?bi:Si:e instanceof ht?bi:Array.isArray(e)?ki:"object"===n&&isNaN(e)?xi:wi)(t,e)}],fa.interpolateArray=ki;var vl=function(){return S},yl=fa.map({linear:vl,poly:Oi,quad:function(){return Mi},cubic:function(){return Li},sin:function(){return Pi},exp:function(){return Di},circle:function(){return Ii},elastic:Ni,back:Fi,bounce:function(){return Bi}}),bl=fa.map({"in":S,out:Ti,"in-out":Ei,"out-in":function(t){return Ei(Ti(t))}});fa.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,i=e>=0?t.slice(e+1):"in";return n=yl.get(n)||vl,i=bl.get(i)||S,Ci(i(n.apply(null,pa.call(arguments,1))))},fa.interpolateHcl=zi,fa.interpolateHsl=Hi,fa.interpolateLab=qi,fa.interpolateRound=Gi,fa.transform=function(t){var e=ga.createElementNS(fa.ns.prefix.svg,"g");return(fa.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new ji(n?n.matrix:xl)})(t)},ji.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var xl={a:1,b:0,c:0,d:1,e:0,f:0};fa.interpolateTransform=Ji,fa.layout={},fa.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(er(t[n]));return e}},fa.layout.chord=function(){function t(){var t,u,h,d,f,p={},_=[],g=fa.range(o),m=[];for(n=[],i=[],t=0,d=-1;++d<o;){for(u=0,f=-1;++f<o;)u+=r[d][f];_.push(u),m.push(fa.range(o)),t+=u}for(a&&g.sort(function(t,e){return a(_[t],_[e])}),s&&m.forEach(function(t,e){t.sort(function(t,n){return s(r[e][t],r[e][n])})}),t=(Ua-c*o)/t,u=0,d=-1;++d<o;){for(h=u,f=-1;++f<o;){var v=g[d],y=m[v][f],b=r[v][y],x=u,w=u+=b*t;p[v+"-"+y]={index:v,subindex:y,startAngle:x,endAngle:w,value:b}}i[v]={index:v,startAngle:h,endAngle:u,value:_[v]},u+=c}for(d=-1;++d<o;)for(f=d-1;++f<o;){var S=p[d+"-"+f],A=p[f+"-"+d];(S.value||A.value)&&n.push(S.value<A.value?{source:A,target:S}:{source:S,target:A})}l&&e()}function e(){n.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,i,r,o,a,s,l,u={},c=0;return u.matrix=function(t){return arguments.length?(o=(r=t)&&r.length,n=i=null,u):r},u.padding=function(t){return arguments.length?(c=t,n=i=null,u):c},u.sortGroups=function(t){return arguments.length?(a=t,n=i=null,u):a},u.sortSubgroups=function(t){return arguments.length?(s=t,n=null,u):s},u.sortChords=function(t){return arguments.length?(l=t,n&&e(),u):l},u.chords=function(){return n||t(),n},u.groups=function(){return i||t(),i},u},fa.layout.force=function(){function t(t){return function(e,n,i,r){if(e.point!==t){var o=e.cx-t.x,a=e.cy-t.y,s=r-n,l=o*o+a*a;if(l>s*s/m){if(_>l){var u=e.charge/l;t.px-=o*u,t.py-=a*u}return!0}if(e.point&&l&&_>l){var u=e.pointCharge/l;t.px-=o*u,t.py-=a*u}}return!e.charge}}function e(t){t.px=fa.event.x,t.py=fa.event.y,l.resume()}var n,i,r,o,a,s,l={},u=fa.dispatch("start","tick","end"),c=[1,1],h=.9,d=wl,f=Sl,p=-30,_=Al,g=.1,m=.64,v=[],y=[];return l.tick=function(){if((r*=.99)<.005)return n=null,u.end({type:"end",alpha:r=0}),!0;var e,i,l,d,f,_,m,b,x,w=v.length,S=y.length;for(i=0;S>i;++i)l=y[i],d=l.source,f=l.target,b=f.x-d.x,x=f.y-d.y,(_=b*b+x*x)&&(_=r*a[i]*((_=Math.sqrt(_))-o[i])/_,b*=_,x*=_,f.x-=b*(m=d.weight+f.weight?d.weight/(d.weight+f.weight):.5),f.y-=x*m,d.x+=b*(m=1-m),d.y+=x*m);if((m=r*g)&&(b=c[0]/2,x=c[1]/2,i=-1,m))for(;++i<w;)l=v[i],l.x+=(b-l.x)*m,l.y+=(x-l.y)*m;if(p)for(lr(e=fa.geom.quadtree(v),r,s),i=-1;++i<w;)(l=v[i]).fixed||e.visit(t(l));for(i=-1;++i<w;)l=v[i],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*h,l.y-=(l.py-(l.py=l.y))*h);u.tick({type:"tick",alpha:r})},l.nodes=function(t){return arguments.length?(v=t,l):v},l.links=function(t){return arguments.length?(y=t,l):y},l.size=function(t){return arguments.length?(c=t,l):c},l.linkDistance=function(t){return arguments.length?(d="function"==typeof t?t:+t,l):d},l.distance=l.linkDistance,l.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,l):f},l.friction=function(t){return arguments.length?(h=+t,l):h},l.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,l):p},l.chargeDistance=function(t){return arguments.length?(_=t*t,l):Math.sqrt(_)},l.gravity=function(t){return arguments.length?(g=+t,l):g},l.theta=function(t){return arguments.length?(m=t*t,l):Math.sqrt(m)},l.alpha=function(t){return arguments.length?(t=+t,r?t>0?r=t:(n.c=null,n.t=NaN,n=null,u.end({type:"end",alpha:r=0})):t>0&&(u.start({type:"start",alpha:r=t}),n=Nt(l.tick)),l):r},l.start=function(){function t(t,i){if(!n){for(n=new Array(r),l=0;r>l;++l)n[l]=[];for(l=0;u>l;++l){var o=y[l];n[o.source.index].push(o.target),n[o.target.index].push(o.source)}}for(var a,s=n[e],l=-1,c=s.length;++l<c;)if(!isNaN(a=s[l][t]))return a;return Math.random()*i}var e,n,i,r=v.length,u=y.length,h=c[0],_=c[1];for(e=0;r>e;++e)(i=v[e]).index=e,i.weight=0;for(e=0;u>e;++e)i=y[e],"number"==typeof i.source&&(i.source=v[i.source]),"number"==typeof i.target&&(i.target=v[i.target]),++i.source.weight,++i.target.weight;for(e=0;r>e;++e)i=v[e],isNaN(i.x)&&(i.x=t("x",h)),isNaN(i.y)&&(i.y=t("y",_)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(o=[],"function"==typeof d)for(e=0;u>e;++e)o[e]=+d.call(this,y[e],e);else for(e=0;u>e;++e)o[e]=d;if(a=[],"function"==typeof f)for(e=0;u>e;++e)a[e]=+f.call(this,y[e],e);else for(e=0;u>e;++e)a[e]=f;if(s=[],"function"==typeof p)for(e=0;r>e;++e)s[e]=+p.call(this,v[e],e);else for(e=0;r>e;++e)s[e]=p;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return i||(i=fa.behavior.drag().origin(S).on("dragstart.force",rr).on("drag.force",e).on("dragend.force",or)),arguments.length?void this.on("mouseover.force",ar).on("mouseout.force",sr).call(i):i},fa.rebind(l,u,"on")};var wl=20,Sl=1,Al=1/0;fa.layout.hierarchy=function(){function t(r){var o,a=[r],s=[];for(r.depth=0;null!=(o=a.pop());)if(s.push(o),(u=n.call(t,o,o.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)a.push(c=u[l]),c.parent=o,c.depth=o.depth+1;i&&(o.value=0),o.children=u}else i&&(o.value=+i.call(t,o,o.depth)||0),delete o.children;return hr(r,function(t){var n,r;e&&(n=t.children)&&n.sort(e),i&&(r=t.parent)&&(r.value+=t.value)}),s}var e=pr,n=dr,i=fr;return t.sort=function(n){return arguments.length?(e=n,t):e},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(i=e,t):i},t.revalue=function(e){return i&&(cr(e,function(t){t.children&&(t.value=0)}),hr(e,function(e){var n;e.children||(e.value=+i.call(t,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value)})),e},t},fa.layout.partition=function(){function t(e,n,i,r){var o=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,o&&(a=o.length)){var a,s,l,u=-1;for(i=e.value?i/e.value:0;++u<a;)t(s=o[u],n,l=s.value*i,r),n+=l}}function e(t){var n=t.children,i=0;if(n&&(r=n.length))for(var r,o=-1;++o<r;)i=Math.max(i,e(n[o]));return 1+i}function n(n,o){var a=i.call(this,n,o);return t(a[0],0,r[0],r[1]/e(a[0])),a}var i=fa.layout.hierarchy(),r=[1,1];return n.size=function(t){return arguments.length?(r=t,n):r},ur(n,i)},fa.layout.pie=function(){function t(a){var s,l=a.length,u=a.map(function(n,i){return+e.call(t,n,i)}),c=+("function"==typeof i?i.apply(this,arguments):i),h=("function"==typeof r?r.apply(this,arguments):r)-c,d=Math.min(Math.abs(h)/l,+("function"==typeof o?o.apply(this,arguments):o)),f=d*(0>h?-1:1),p=fa.sum(u),_=p?(h-l*f)/p:0,g=fa.range(l),m=[];return null!=n&&g.sort(n===kl?function(t,e){return u[e]-u[t]}:function(t,e){return n(a[t],a[e])}),g.forEach(function(t){m[t]={data:a[t],value:s=u[t],startAngle:c,endAngle:c+=s*_+f,padAngle:d}}),m}var e=Number,n=kl,i=0,r=Ua,o=0;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(i=e,t):i},t.endAngle=function(e){return arguments.length?(r=e,t):r},t.padAngle=function(e){return arguments.length?(o=e,t):o},t};var kl={};fa.layout.stack=function(){function t(s,l){if(!(d=s.length))return s;var u=s.map(function(n,i){return e.call(t,n,i)}),c=u.map(function(e){return e.map(function(e,n){return[o.call(t,e,n),a.call(t,e,n)]})}),h=n.call(t,c,l);u=fa.permute(u,h),c=fa.permute(c,h);var d,f,p,_,g=i.call(t,c,l),m=u[0].length;for(p=0;m>p;++p)for(r.call(t,u[0][p],_=g[p],c[0][p][1]),f=1;d>f;++f)r.call(t,u[f][p],_+=c[f-1][p][1],c[f][p][1]);return s}var e=S,n=yr,i=br,r=vr,o=gr,a=mr;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:Cl.get(e)||yr,t):n},t.offset=function(e){return arguments.length?(i="function"==typeof e?e:Tl.get(e)||br,t):i},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(a=e,t):a},t.out=function(e){return arguments.length?(r=e,t):r},t};var Cl=fa.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(xr),o=t.map(wr),a=fa.range(i).sort(function(t,e){return r[t]-r[e]}),s=0,l=0,u=[],c=[];for(e=0;i>e;++e)n=a[e],l>s?(s+=o[n],u.push(n)):(l+=o[n],c.push(n));return c.reverse().concat(u)},reverse:function(t){return fa.range(t.length).reverse()},"default":yr}),Tl=fa.map({silhouette:function(t){var e,n,i,r=t.length,o=t[0].length,a=[],s=0,l=[];for(n=0;o>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];i>s&&(s=i),a.push(i)}for(n=0;o>n;++n)l[n]=(s-a[n])/2;return l},wiggle:function(t){var e,n,i,r,o,a,s,l,u,c=t.length,h=t[0],d=h.length,f=[];for(f[0]=l=u=0,n=1;d>n;++n){for(e=0,r=0;c>e;++e)r+=t[e][n][1];for(e=0,o=0,s=h[n][0]-h[n-1][0];c>e;++e){for(i=0,a=(t[e][n][1]-t[e][n-1][1])/(2*s);e>i;++i)a+=(t[i][n][1]-t[i][n-1][1])/s;o+=a*t[e][n][1]}f[n]=l-=r?o/r*s:0,u>l&&(u=l)}for(n=0;d>n;++n)f[n]-=u;return f},expand:function(t){var e,n,i,r=t.length,o=t[0].length,a=1/r,s=[];for(n=0;o>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];if(i)for(e=0;r>e;e++)t[e][n][1]/=i;else for(e=0;r>e;e++)t[e][n][1]=a}for(n=0;o>n;++n)s[n]=0;return s},zero:br});fa.layout.histogram=function(){function t(t,o){for(var a,s,l=[],u=t.map(n,this),c=i.call(this,u,o),h=r.call(this,c,u,o),o=-1,d=u.length,f=h.length-1,p=e?1:1/d;++o<f;)a=l[o]=[],a.dx=h[o+1]-(a.x=h[o]),a.y=0;if(f>0)for(o=-1;++o<d;)s=u[o],s>=c[0]&&s<=c[1]&&(a=l[fa.bisect(h,s,1,f)-1],a.y+=p,a.push(t[o]));return l}var e=!0,n=Number,i=Cr,r=Ar;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(i=Rt(e),t):i},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return kr(t,e)}:Rt(e),t):r},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},fa.layout.pack=function(){function t(t,o){var a=n.call(this,t,o),s=a[0],l=r[0],u=r[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(s.x=s.y=0,hr(s,function(t){t.r=+c(t.value)}),hr(s,Rr),i){var h=i*(e?1:Math.max(2*s.r/l,2*s.r/u))/2;hr(s,function(t){t.r+=h}),hr(s,Rr),hr(s,function(t){t.r-=h})}return Dr(s,l/2,u/2,e?1:1/Math.max(2*s.r/l,2*s.r/u)),a}var e,n=fa.layout.hierarchy().sort(Tr),i=0,r=[1,1];return t.size=function(e){return arguments.length?(r=e,t):r},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(i=+e,t):i},ur(t,n)},fa.layout.tree=function(){function t(t,r){var c=a.call(this,t,r),h=c[0],d=e(h);if(hr(d,n),d.parent.m=-d.z,cr(d,i),u)cr(h,o);else{var f=h,p=h,_=h;cr(h,function(t){t.x<f.x&&(f=t),t.x>p.x&&(p=t),t.depth>_.depth&&(_=t)});var g=s(f,p)/2-f.x,m=l[0]/(p.x+s(p,f)/2+g),v=l[1]/(_.depth||1);cr(h,function(t){t.x=(t.x+g)*m,t.y=t.depth*v})}return c}function e(t){for(var e,n={A:null,children:[t]},i=[n];null!=(e=i.pop());)for(var r,o=e.children,a=0,s=o.length;s>a;++a)i.push((o[a]=r={_:o[a],parent:e,children:(r=o[a].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=r);return n.children[0]}function n(t){var e=t.children,n=t.parent.children,i=t.i?n[t.i-1]:null;if(e.length){Hr(t);var o=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+s(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+s(t._,i._));t.parent.A=r(t,i,t.parent.A||n[0])}function i(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function r(t,e,n){if(e){for(var i,r=t,o=t,a=e,l=r.parent.children[0],u=r.m,c=o.m,h=a.m,d=l.m;a=Br(a),r=Fr(r),a&&r;)l=Fr(l),o=Br(o),o.a=t,i=a.z+h-r.z-u+s(a._,r._),i>0&&(zr(qr(a,t,n),t,i),u+=i,c+=i),h+=a.m,u+=r.m,d+=l.m,c+=o.m;a&&!Br(o)&&(o.t=a,o.m+=h-c),r&&!Fr(l)&&(l.t=r,l.m+=u-d,n=t)}return n}function o(t){t.x*=l[0],t.y=t.depth*l[1]}var a=fa.layout.hierarchy().sort(null).value(null),s=Nr,l=[1,1],u=null;return t.separation=function(e){return arguments.length?(s=e,t):s},t.size=function(e){return arguments.length?(u=null==(l=e)?o:null,t):u?null:l},t.nodeSize=function(e){return arguments.length?(u=null==(l=e)?null:o,t):u?l:null},ur(t,a)},fa.layout.cluster=function(){function t(t,o){var a,s=e.call(this,t,o),l=s[0],u=0;hr(l,function(t){var e=t.children;e&&e.length?(t.x=jr(e),t.y=Gr(e)):(t.x=a?u+=n(t,a):0,t.y=0,a=t)});var c=Ur(l),h=Vr(l),d=c.x-n(c,h)/2,f=h.x+n(h,c)/2;return hr(l,r?function(t){t.x=(t.x-l.x)*i[0],t.y=(l.y-t.y)*i[1]}:function(t){t.x=(t.x-d)/(f-d)*i[0],t.y=(1-(l.y?t.y/l.y:1))*i[1]}),s}var e=fa.layout.hierarchy().sort(null).value(null),n=Nr,i=[1,1],r=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(r=null==(i=e),t):r?null:i},t.nodeSize=function(e){return arguments.length?(r=null!=(i=e),t):r?i:null},ur(t,e)},fa.layout.treemap=function(){function t(t,e){for(var n,i,r=-1,o=t.length;++r<o;)i=(n=t[r]).value*(0>e?0:e),n.area=isNaN(i)||0>=i?0:i}function e(n){var o=n.children;if(o&&o.length){var a,s,l,u=h(n),c=[],d=o.slice(),p=1/0,_="slice"===f?u.dx:"dice"===f?u.dy:"slice-dice"===f?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(t(d,u.dx*u.dy/n.value),c.area=0;(l=d.length)>0;)c.push(a=d[l-1]),c.area+=a.area,"squarify"!==f||(s=i(c,_))<=p?(d.pop(),p=s):(c.area-=c.pop().area,r(c,_,u,!1),_=Math.min(u.dx,u.dy),c.length=c.area=0,p=1/0);c.length&&(r(c,_,u,!0),c.length=c.area=0),o.forEach(e)}}function n(e){var i=e.children;if(i&&i.length){var o,a=h(e),s=i.slice(),l=[];for(t(s,a.dx*a.dy/e.value),l.area=0;o=s.pop();)l.push(o),l.area+=o.area,null!=o.z&&(r(l,o.z?a.dx:a.dy,a,!s.length),l.length=l.area=0);i.forEach(n)}}function i(t,e){for(var n,i=t.area,r=0,o=1/0,a=-1,s=t.length;++a<s;)(n=t[a].area)&&(o>n&&(o=n),n>r&&(r=n));return i*=i,e*=e,i?Math.max(e*r*p/i,i/(e*o*p)):1/0}function r(t,e,n,i){var r,o=-1,a=t.length,s=n.x,u=n.y,c=e?l(t.area/e):0;if(e==n.dx){for((i||c>n.dy)&&(c=n.dy);++o<a;)r=t[o],r.x=s,r.y=u,r.dy=c,s+=r.dx=Math.min(n.x+n.dx-s,c?l(r.area/c):0);r.z=!0,r.dx+=n.x+n.dx-s,n.y+=c,n.dy-=c}else{for((i||c>n.dx)&&(c=n.dx);++o<a;)r=t[o],r.x=s,r.y=u,r.dx=c,u+=r.dy=Math.min(n.y+n.dy-u,c?l(r.area/c):0);r.z=!1,r.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function o(i){var r=a||s(i),o=r[0];return o.x=o.y=0,o.value?(o.dx=u[0],o.dy=u[1]):o.dx=o.dy=0,a&&s.revalue(o),t([o],o.dx*o.dy/o.value),(a?n:e)(o),d&&(a=r),r}var a,s=fa.layout.hierarchy(),l=Math.round,u=[1,1],c=null,h=Wr,d=!1,f="squarify",p=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(u=t,o):u},o.padding=function(t){function e(e){var n=t.call(o,e,e.depth);return null==n?Wr(e):Xr(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Xr(e,t)}if(!arguments.length)return c;var i;return h=null==(c=t)?Wr:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],n):n,o},o.round=function(t){return arguments.length?(l=t?Math.round:Number,o):l!=Number},o.sticky=function(t){return arguments.length?(d=t,a=null,o):d},o.ratio=function(t){return arguments.length?(p=t,o):p},o.mode=function(t){return arguments.length?(f=t+"",o):f},ur(o,s)},fa.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,i,r;do n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i;while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=fa.random.normal.apply(fa,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=fa.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e}}},fa.scale={};var El={floor:S,ceil:S};fa.scale.linear=function(){return to([0,1],[0,1],Ai,!1)};var Ml={s:1,g:1,p:1,r:1,e:1};fa.scale.log=function(){return lo(fa.scale.linear().domain([0,1]),10,!0,[1,10])};var Ll=fa.format(".0e"),Rl={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};fa.scale.pow=function(){return uo(fa.scale.linear(),1,[0,1])},fa.scale.sqrt=function(){return fa.scale.pow().exponent(.5)},fa.scale.ordinal=function(){return ho([],{t:"range",a:[[]]})},fa.scale.category10=function(){return fa.scale.ordinal().range(Ol)},fa.scale.category20=function(){return fa.scale.ordinal().range(Pl)},fa.scale.category20b=function(){return fa.scale.ordinal().range(Dl)},fa.scale.category20c=function(){return fa.scale.ordinal().range(Il)};var Ol=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(At),Pl=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(At),Dl=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(At),Il=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(At);fa.scale.quantile=function(){return fo([],[])},fa.scale.quantize=function(){return po(0,1,[0,1])},fa.scale.threshold=function(){return _o([.5],[0,1])},fa.scale.identity=function(){return go([0,1])},fa.svg={},fa.svg.arc=function(){function t(){var t=Math.max(0,+n.apply(this,arguments)),u=Math.max(0,+i.apply(this,arguments)),c=a.apply(this,arguments)-Wa,h=s.apply(this,arguments)-Wa,d=Math.abs(h-c),f=c>h?0:1;if(t>u&&(p=u,u=t,t=p),d>=Va)return e(u,f)+(t?e(t,1-f):"")+"Z";var p,_,g,m,v,y,b,x,w,S,A,k,C=0,T=0,E=[];if((m=(+l.apply(this,arguments)||0)/2)&&(g=o===Nl?Math.sqrt(t*t+u*u):+o.apply(this,arguments),f||(T*=-1),u&&(T=at(g/u*Math.sin(m))),t&&(C=at(g/t*Math.sin(m)))),u){v=u*Math.cos(c+T),y=u*Math.sin(c+T),b=u*Math.cos(h-T),x=u*Math.sin(h-T);var M=Math.abs(h-c-2*T)<=ja?0:1;if(T&&So(v,y,b,x)===f^M){var L=(c+h)/2;v=u*Math.cos(L),y=u*Math.sin(L),b=x=null}}else v=y=0;if(t){w=t*Math.cos(h-C),S=t*Math.sin(h-C),A=t*Math.cos(c+C),k=t*Math.sin(c+C);var R=Math.abs(c-h+2*C)<=ja?0:1;if(C&&So(w,S,A,k)===1-f^R){var O=(c+h)/2;w=t*Math.cos(O),S=t*Math.sin(O),A=k=null}}else w=S=0;if(d>qa&&(p=Math.min(Math.abs(u-t)/2,+r.apply(this,arguments)))>.001){_=u>t^f?0:1;var P=p,D=p;if(ja>d){var I=null==A?[w,S]:null==b?[v,y]:zn([v,y],[A,k],[b,x],[w,S]),N=v-I[0],F=y-I[1],B=b-I[0],z=x-I[1],H=1/Math.sin(Math.acos((N*B+F*z)/(Math.sqrt(N*N+F*F)*Math.sqrt(B*B+z*z)))/2),q=Math.sqrt(I[0]*I[0]+I[1]*I[1]);D=Math.min(p,(t-q)/(H-1)),P=Math.min(p,(u-q)/(H+1))}if(null!=b){var G=Ao(null==A?[w,S]:[A,k],[v,y],u,P,f),j=Ao([b,x],[w,S],u,P,f);p===P?E.push("M",G[0],"A",P,",",P," 0 0,",_," ",G[1],"A",u,",",u," 0 ",1-f^So(G[1][0],G[1][1],j[1][0],j[1][1]),",",f," ",j[1],"A",P,",",P," 0 0,",_," ",j[0]):E.push("M",G[0],"A",P,",",P," 0 1,",_," ",j[0])}else E.push("M",v,",",y);if(null!=A){var U=Ao([v,y],[A,k],t,-D,f),V=Ao([w,S],null==b?[v,y]:[b,x],t,-D,f);p===D?E.push("L",V[0],"A",D,",",D," 0 0,",_," ",V[1],"A",t,",",t," 0 ",f^So(V[1][0],V[1][1],U[1][0],U[1][1]),",",1-f," ",U[1],"A",D,",",D," 0 0,",_," ",U[0]):E.push("L",V[0],"A",D,",",D," 0 0,",_," ",U[0])}else E.push("L",w,",",S)}else E.push("M",v,",",y),null!=b&&E.push("A",u,",",u," 0 ",M,",",f," ",b,",",x),E.push("L",w,",",S),null!=A&&E.push("A",t,",",t," 0 ",R,",",1-f," ",A,",",k);return E.push("Z"),E.join("")}function e(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}var n=vo,i=yo,r=mo,o=Nl,a=bo,s=xo,l=wo;return t.innerRadius=function(e){return arguments.length?(n=Rt(e),t):n},t.outerRadius=function(e){return arguments.length?(i=Rt(e),t):i},t.cornerRadius=function(e){return arguments.length?(r=Rt(e),t):r},t.padRadius=function(e){return arguments.length?(o=e==Nl?Nl:Rt(e),t):o},t.startAngle=function(e){return arguments.length?(a=Rt(e),t):a},t.endAngle=function(e){return arguments.length?(s=Rt(e),t):s},t.padAngle=function(e){return arguments.length?(l=Rt(e),t):l},t.centroid=function(){var t=(+n.apply(this,arguments)+ +i.apply(this,arguments))/2,e=(+a.apply(this,arguments)+ +s.apply(this,arguments))/2-Wa;return[Math.cos(e)*t,Math.sin(e)*t]},t};var Nl="auto";fa.svg.line=function(){return ko(S)};var Fl=fa.map({linear:Co,"linear-closed":To,step:Eo,"step-before":Mo,"step-after":Lo,basis:No,"basis-open":Fo,"basis-closed":Bo,bundle:zo,cardinal:Po,"cardinal-open":Ro,"cardinal-closed":Oo,monotone:Vo});Fl.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Bl=[0,2/3,1/3,0],zl=[0,1/3,2/3,0],Hl=[0,1/6,2/3,1/6];fa.svg.line.radial=function(){var t=ko(Wo);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Mo.reverse=Lo,Lo.reverse=Mo,fa.svg.area=function(){return Xo(S)},fa.svg.area.radial=function(){var t=Xo(Wo);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},fa.svg.chord=function(){function t(t,s){var l=e(this,o,t,s),u=e(this,a,t,s);return"M"+l.p0+i(l.r,l.p1,l.a1-l.a0)+(n(l,u)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,u.r,u.p0)+i(u.r,u.p1,u.a1-u.a0)+r(u.r,u.p1,l.r,l.p0))+"Z"}function e(t,e,n,i){var r=e.call(t,n,i),o=s.call(t,r,i),a=l.call(t,r,i)-Wa,c=u.call(t,r,i)-Wa;return{r:o,a0:a,a1:c,p0:[o*Math.cos(a),o*Math.sin(a)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function i(t,e,n){return"A"+t+","+t+" 0 "+ +(n>ja)+",1 "+e}function r(t,e,n,i){return"Q 0,0 "+i}var o=An,a=kn,s=Ko,l=bo,u=xo;return t.radius=function(e){return arguments.length?(s=Rt(e),t):s},t.source=function(e){return arguments.length?(o=Rt(e),t):o},t.target=function(e){return arguments.length?(a=Rt(e),t):a},t.startAngle=function(e){return arguments.length?(l=Rt(e),t):l},t.endAngle=function(e){return arguments.length?(u=Rt(e),t):u},t},fa.svg.diagonal=function(){function t(t,r){var o=e.call(this,t,r),a=n.call(this,t,r),s=(o.y+a.y)/2,l=[o,{x:o.x,y:s},{x:a.x,y:s},a];return l=l.map(i),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=An,n=kn,i=Yo;return t.source=function(n){return arguments.length?(e=Rt(n),t):e},t.target=function(e){return arguments.length?(n=Rt(e),t):n},t.projection=function(e){return arguments.length?(i=e,t):i},t},fa.svg.diagonal.radial=function(){var t=fa.svg.diagonal(),e=Yo,n=t.projection;return t.projection=function(t){return arguments.length?n(Zo(e=t)):e},t},fa.svg.symbol=function(){function t(t,i){return(ql.get(e.call(this,t,i))||Qo)(n.call(this,t,i))}var e=Jo,n=$o;return t.type=function(n){return arguments.length?(e=Rt(n),t):e},t.size=function(e){return arguments.length?(n=Rt(e),t):n},t};var ql=fa.map({circle:Qo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*jl)),n=e*jl;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Gl),n=e*Gl/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Gl),n=e*Gl/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});fa.svg.symbolTypes=ql.keys();var Gl=Math.sqrt(3),jl=Math.tan(30*Xa);Da.transition=function(t){for(var e,n,i=Ul||++Kl,r=ra(t),o=[],a=Vl||{time:Date.now(),ease:Ri,delay:0,duration:250},s=-1,l=this.length;++s<l;){o.push(e=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(n=u[c])&&oa(n,c,r,i,a),e.push(n)}return ea(o,r,i)},Da.interrupt=function(t){return this.each(null==t?Wl:ta(ra(t)))};var Ul,Vl,Wl=ta(ra()),Xl=[],Kl=0;Xl.call=Da.call,Xl.empty=Da.empty,Xl.node=Da.node,Xl.size=Da.size,fa.transition=function(t,e){return t&&t.transition?Ul?t.transition(e):t:fa.selection().transition(t)},fa.transition.prototype=Xl,Xl.select=function(t){var e,n,i,r=this.id,o=this.namespace,a=[];t=P(t);for(var s=-1,l=this.length;++s<l;){a.push(e=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(i=u[c])&&(n=t.call(i,i.__data__,c,s))?("__data__"in i&&(n.__data__=i.__data__),oa(n,c,o,r,i[o][r]),e.push(n)):e.push(null)}return ea(a,o,r)},Xl.selectAll=function(t){var e,n,i,r,o,a=this.id,s=this.namespace,l=[];t=D(t);for(var u=-1,c=this.length;++u<c;)for(var h=this[u],d=-1,f=h.length;++d<f;)if(i=h[d]){o=i[s][a],n=t.call(i,i.__data__,d,u),l.push(e=[]);for(var p=-1,_=n.length;++p<_;)(r=n[p])&&oa(r,p,s,a,o),e.push(r)}return ea(l,s,a)},Xl.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=W(t));for(var o=0,a=this.length;a>o;o++){r.push(e=[]);for(var n=this[o],s=0,l=n.length;l>s;s++)(i=n[s])&&t.call(i,i.__data__,s,o)&&e.push(i)}return ea(r,this.namespace,this.id)},Xl.tween=function(t,e){var n=this.id,i=this.namespace;return arguments.length<2?this.node()[i][n].tween.get(t):K(this,null==e?function(e){e[i][n].tween.remove(t)}:function(r){r[i][n].tween.set(t,e)})},Xl.attr=function(t,e){function n(){this.removeAttribute(s)}function i(){this.removeAttributeNS(s.space,s.local)}function r(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(s);return n!==t&&(e=a(n,t),function(t){this.setAttribute(s,e(t))})})}function o(t){return null==t?i:(t+="",function(){var e,n=this.getAttributeNS(s.space,s.local);return n!==t&&(e=a(n,t),function(t){this.setAttributeNS(s.space,s.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var a="transform"==t?Ji:Ai,s=fa.ns.qualify(t);return na(this,"attr."+t,e,s.local?o:r)},Xl.attrTween=function(t,e){function n(t,n){var i=e.call(this,t,n,this.getAttribute(r));return i&&function(t){this.setAttribute(r,i(t))}}function i(t,n){var i=e.call(this,t,n,this.getAttributeNS(r.space,r.local));return i&&function(t){this.setAttributeNS(r.space,r.local,i(t))}}var r=fa.ns.qualify(t);return this.tween("attr."+t,r.local?i:n)},Xl.style=function(t,e,n){function i(){this.style.removeProperty(t)}function r(e){return null==e?i:(e+="",function(){var i,r=a(this).getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(i=Ai(r,e),function(e){this.style.setProperty(t,i(e),n)})})}var o=arguments.length;if(3>o){if("string"!=typeof t){2>o&&(e="");for(n in t)this.style(n,t[n],e);return this}n=""}return na(this,"style."+t,e,r)},Xl.styleTween=function(t,e,n){function i(i,r){var o=e.call(this,i,r,a(this).getComputedStyle(this,null).getPropertyValue(t));return o&&function(e){this.style.setProperty(t,o(e),n)}}return arguments.length<3&&(n=""),this.tween("style."+t,i)},Xl.text=function(t){return na(this,"text",t,ia)},Xl.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},Xl.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=fa.ease.apply(fa,arguments)),K(this,function(i){i[n][e].ease=t}))},Xl.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:K(this,"function"==typeof t?function(i,r,o){i[n][e].delay=+t.call(i,i.__data__,r,o)}:(t=+t,function(i){i[n][e].delay=t}))},Xl.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:K(this,"function"==typeof t?function(i,r,o){i[n][e].duration=Math.max(1,t.call(i,i.__data__,r,o))}:(t=Math.max(1,t),function(i){i[n][e].duration=t}))},Xl.each=function(t,e){var n=this.id,i=this.namespace;if(arguments.length<2){var r=Vl,o=Ul;try{Ul=n,K(this,function(e,r,o){Vl=e[i][n],t.call(e,e.__data__,r,o)})}finally{Vl=r,Ul=o}}else K(this,function(r){var o=r[i][n];(o.event||(o.event=fa.dispatch("start","end","interrupt"))).on(t,e)});return this},Xl.transition=function(){for(var t,e,n,i,r=this.id,o=++Kl,a=this.namespace,s=[],l=0,u=this.length;u>l;l++){s.push(t=[]);for(var e=this[l],c=0,h=e.length;h>c;c++)(n=e[c])&&(i=n[a][r],oa(n,c,a,o,{time:i.time,ease:i.ease,delay:i.delay+i.duration,duration:i.duration})),t.push(n)}return ea(s,a,o)},fa.svg.axis=function(){function t(t){t.each(function(){var t,u=fa.select(this),c=this.__chart__||n,h=this.__chart__=n.copy(),d=null==l?h.ticks?h.ticks.apply(h,s):h.domain():l,f=null==e?h.tickFormat?h.tickFormat.apply(h,s):S:e,p=u.selectAll(".tick").data(d,h),_=p.enter().insert("g",".domain").attr("class","tick").style("opacity",qa),g=fa.transition(p.exit()).style("opacity",qa).remove(),m=fa.transition(p.order()).style("opacity",1),v=Math.max(r,0)+a,y=Yr(h),b=u.selectAll(".domain").data([0]),x=(b.enter().append("path").attr("class","domain"),fa.transition(b));_.append("line"),_.append("text");var w,A,k,C,T=_.select("line"),E=m.select("line"),M=p.select("text").text(f),L=_.select("text"),R=m.select("text"),O="top"===i||"left"===i?-1:1;
if("bottom"===i||"top"===i?(t=aa,w="x",k="y",A="x2",C="y2",M.attr("dy",0>O?"0em":".71em").style("text-anchor","middle"),x.attr("d","M"+y[0]+","+O*o+"V0H"+y[1]+"V"+O*o)):(t=sa,w="y",k="x",A="y2",C="x2",M.attr("dy",".32em").style("text-anchor",0>O?"end":"start"),x.attr("d","M"+O*o+","+y[0]+"H0V"+y[1]+"H"+O*o)),T.attr(C,O*r),L.attr(k,O*v),E.attr(A,0).attr(C,O*r),R.attr(w,0).attr(k,O*v),h.rangeBand){var P=h,D=P.rangeBand()/2;c=h=function(t){return P(t)+D}}else c.rangeBand?c=h:g.call(t,h,c);_.call(t,c,h),m.call(t,h,h)})}var e,n=fa.scale.linear(),i=Yl,r=6,o=6,a=3,s=[10],l=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(i=e in Zl?e+"":Yl,t):i},t.ticks=function(){return arguments.length?(s=_a(arguments),t):s},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(r=+e,o=+arguments[n-1],t):r},t.innerTickSize=function(e){return arguments.length?(r=+e,t):r},t.outerTickSize=function(e){return arguments.length?(o=+e,t):o},t.tickPadding=function(e){return arguments.length?(a=+e,t):a},t.tickSubdivide=function(){return arguments.length&&t},t};var Yl="bottom",Zl={top:1,right:1,bottom:1,left:1};fa.svg.brush=function(){function t(o){o.each(function(){var o=fa.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",r).on("touchstart.brush",r),a=o.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),o.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=o.selectAll(".resize").data(_,S);s.exit().remove(),s.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return $l[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",t.empty()?"none":null);var l,h=fa.transition(o),d=fa.transition(a);u&&(l=Yr(u),d.attr("x",l[0]).attr("width",l[1]-l[0]),n(h)),c&&(l=Yr(c),d.attr("y",l[0]).attr("height",l[1]-l[0]),i(h)),e(h)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+h[+/e$/.test(t)]+","+d[+/^s/.test(t)]+")"})}function n(t){t.select(".extent").attr("x",h[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1]-h[0])}function i(t){t.select(".extent").attr("y",d[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function r(){function r(){32==fa.event.keyCode&&(E||(y=null,R[0]-=h[1],R[1]-=d[1],E=2),M())}function _(){32==fa.event.keyCode&&2==E&&(R[0]+=h[1],R[1]+=d[1],E=0,M())}function g(){var t=fa.mouse(x),r=!1;b&&(t[0]+=b[0],t[1]+=b[1]),E||(fa.event.altKey?(y||(y=[(h[0]+h[1])/2,(d[0]+d[1])/2]),R[0]=h[+(t[0]<y[0])],R[1]=d[+(t[1]<y[1])]):y=null),C&&m(t,u,0)&&(n(A),r=!0),T&&m(t,c,1)&&(i(A),r=!0),r&&(e(A),S({type:"brush",mode:E?"move":"resize"}))}function m(t,e,n){var i,r,a=Yr(e),l=a[0],u=a[1],c=R[n],_=n?d:h,g=_[1]-_[0];return E&&(l-=c,u-=g+c),i=(n?p:f)?Math.max(l,Math.min(u,t[n])):t[n],E?r=(i+=c)+g:(y&&(c=Math.max(l,Math.min(u,2*y[n]-i))),i>c?(r=i,i=c):r=c),_[0]!=i||_[1]!=r?(n?s=null:o=null,_[0]=i,_[1]=r,!0):void 0}function v(){g(),A.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),fa.select("body").style("cursor",null),O.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),L(),S({type:"brushend"})}var y,b,x=this,w=fa.select(fa.event.target),S=l.of(x,arguments),A=fa.select(x),k=w.datum(),C=!/^(n|s)$/.test(k)&&u,T=!/^(e|w)$/.test(k)&&c,E=w.classed("extent"),L=tt(x),R=fa.mouse(x),O=fa.select(a(x)).on("keydown.brush",r).on("keyup.brush",_);if(fa.event.changedTouches?O.on("touchmove.brush",g).on("touchend.brush",v):O.on("mousemove.brush",g).on("mouseup.brush",v),A.interrupt().selectAll("*").interrupt(),E)R[0]=h[0]-R[0],R[1]=d[0]-R[1];else if(k){var P=+/w$/.test(k),D=+/^n/.test(k);b=[h[1-P]-R[0],d[1-D]-R[1]],R[0]=h[P],R[1]=d[D]}else fa.event.altKey&&(y=R.slice());A.style("pointer-events","none").selectAll(".resize").style("display",null),fa.select("body").style("cursor",w.style("cursor")),S({type:"brushstart"}),g()}var o,s,l=R(t,"brushstart","brush","brushend"),u=null,c=null,h=[0,0],d=[0,0],f=!0,p=!0,_=Jl[0];return t.event=function(t){t.each(function(){var t=l.of(this,arguments),e={x:h,y:d,i:o,j:s},n=this.__chart__||e;this.__chart__=e,Ul?fa.select(this).transition().each("start.brush",function(){o=n.i,s=n.j,h=n.x,d=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=ki(h,e.x),i=ki(d,e.y);return o=s=null,function(r){h=e.x=n(r),d=e.y=i(r),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=e.i,s=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(u=e,_=Jl[!u<<1|!c],t):u},t.y=function(e){return arguments.length?(c=e,_=Jl[!u<<1|!c],t):c},t.clamp=function(e){return arguments.length?(u&&c?(f=!!e[0],p=!!e[1]):u?f=!!e:c&&(p=!!e),t):u&&c?[f,p]:u?f:c?p:null},t.extent=function(e){var n,i,r,a,l;return arguments.length?(u&&(n=e[0],i=e[1],c&&(n=n[0],i=i[0]),o=[n,i],u.invert&&(n=u(n),i=u(i)),n>i&&(l=n,n=i,i=l),(n!=h[0]||i!=h[1])&&(h=[n,i])),c&&(r=e[0],a=e[1],u&&(r=r[1],a=a[1]),s=[r,a],c.invert&&(r=c(r),a=c(a)),r>a&&(l=r,r=a,a=l),(r!=d[0]||a!=d[1])&&(d=[r,a])),t):(u&&(o?(n=o[0],i=o[1]):(n=h[0],i=h[1],u.invert&&(n=u.invert(n),i=u.invert(i)),n>i&&(l=n,n=i,i=l))),c&&(s?(r=s[0],a=s[1]):(r=d[0],a=d[1],c.invert&&(r=c.invert(r),a=c.invert(a)),r>a&&(l=r,r=a,a=l))),u&&c?[[n,r],[i,a]]:u?[n,i]:c&&[r,a])},t.clear=function(){return t.empty()||(h=[0,0],d=[0,0],o=s=null),t},t.empty=function(){return!!u&&h[0]==h[1]||!!c&&d[0]==d[1]},fa.rebind(t,l,"on")};var $l={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Jl=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ql=vs.format=As.timeFormat,tu=Ql.utc,eu=tu("%Y-%m-%dT%H:%M:%S.%LZ");Ql.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?la:eu,la.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},la.toString=eu.toString,vs.second=Vt(function(t){return new ys(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),vs.seconds=vs.second.range,vs.seconds.utc=vs.second.utc.range,vs.minute=Vt(function(t){return new ys(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),vs.minutes=vs.minute.range,vs.minutes.utc=vs.minute.utc.range,vs.hour=Vt(function(t){var e=t.getTimezoneOffset()/60;return new ys(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),vs.hours=vs.hour.range,vs.hours.utc=vs.hour.utc.range,vs.month=Vt(function(t){return t=vs.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),vs.months=vs.month.range,vs.months.utc=vs.month.utc.range;var nu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],iu=[[vs.second,1],[vs.second,5],[vs.second,15],[vs.second,30],[vs.minute,1],[vs.minute,5],[vs.minute,15],[vs.minute,30],[vs.hour,1],[vs.hour,3],[vs.hour,6],[vs.hour,12],[vs.day,1],[vs.day,2],[vs.week,1],[vs.month,1],[vs.month,3],[vs.year,1]],ru=Ql.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",De]]),ou={range:function(t,e,n){return fa.range(Math.ceil(t/n)*n,+e,n).map(ca)},floor:S,ceil:S};iu.year=vs.year,vs.scale=function(){return ua(fa.scale.linear(),iu,ru)};var au=iu.map(function(t){return[t[0].utc,t[1]]}),su=tu.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",De]]);au.year=vs.year.utc,vs.scale.utc=function(){return ua(fa.scale.linear(),au,su)},fa.text=Ot(function(t){return t.responseText}),fa.json=function(t,e){return Pt(t,"application/json",ha,e)},fa.html=function(t,e){return Pt(t,"text/html",da,e)},fa.xml=Ot(function(t){return t.responseXML}),this.d3=fa,i=fa,r="function"==typeof i?i.call(e,n,e,t):i,!(void 0!==r&&(t.exports=r))}()},function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){return Object.assign({},t,{type:e})}function a(t){return o({view:t},Y)}function s(t){return o({view:t},K)}function l(t,e,n){return st(t)?e[Y](t,t.view):lt(t)?e[K](t,t.view):ut(t)?e[Z](t,t):ht(t)?e[J](t):(0,V.isPlainObject)(t)?e[$](t):n(t)}function u(t){throw Error("Unrecognized node type in model: "+t)}function c(t,e){return e.reduce(function(t,e){if(null===t)return null;switch(e[0]){case tt:return e[1]===t[t.length-1]?t.slice(0,-1):null;case et:return[].concat(r(t),[e[1]]);default:throw Error("Unrecognized relative address key: "+e)}},t)}function h(t,e){return[].concat(r(t),[e])}function d(t,e){return o({action:t,relativeAddress:e},Q)}function f(t){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return(0,V.reverse)(t.map(function(t){return[tt,t]})).concat(e)}function p(t){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return e.concat(t.map(function(t){return[et,t]}))}function _(t,e,n,i,r){var o=(0,V.reduce)(i(t,function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];var o=e.apply(void 0,[t].concat(i));return[o,o===t]}),function(t,e,n){var i=U(t,2),o=i[0],a=i[1],s=U(e,2),l=s[0],u=s[1];return[r(o,l,n),a&&u]},[n,!0]),a=U(o,2),s=a[0],l=a[1];return l?t:s}function g(t,e){return _(t,e,[],V.map,function(t,e,n){return[].concat(r(t),[e])})}function m(t,e){return _(t,e,{},V.mapValues,function(t,e,n){return Object.assign(t,i({},n,e))})}function v(t,e,n,r){if(ht(t)){var o;return l(e,(o={},i(o,Y,dt(t)),i(o,K,function(e,i){return g(t,function(t,e){var o=h(n,e),a=r(i,t,o);return v(a,i.model,o,r)})}),i(o,Z,function(e,i){var o=r(i,t,n);return v(o,i.model,n,r)}),i(o,$,dt(t)),i(o,J,function(e){return g(t,function(t,i){var o=(0,V.get)(e,i,null);return v(t,o,h(n,i),r)})}),o),(0,V.constant)(t))}if((0,V.isPlainObject)(t)){var a;return l(e,(a={},i(a,Y,function(e,i){return m(t,function(t,e){var o=h(n,e),a=r(i,t,o);return v(a,i.model,o,r)})}),i(a,K,dt(t)),i(a,Z,function(e,i){var o=r(i,t,n);return v(o,i.model,n,r)}),i(a,$,function(e){return m(t,function(t,i){return v(t,(0,V.get)(e,i,null),h(n,i),r)})}),i(a,J,dt(t)),a),(0,V.constant)(t))}return t}function y(t){return function(e,n){return v(e,t,[],function(t,e,i){if(n[W]||(0,V.isEqual)(n.address,i)){var r=t.reducer(e,n);return r}return e})}}function b(t,e,n){var i=(0,V.mapValues)(t.actionCreators,function(t){return[e,t]});return(0,V.mergeWith)(n,i,function(t,e){return t?[].concat(r(t),[e]):[e]})}function x(t){var e,n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return l(t,(e={},i(e,Y,function(t,e){var i=h(n,":"),o=b(e,i,r);return x(e.model,i,o)}),i(e,K,function(t,e){var i=h(n,":"),o=b(e,i,r);return x(e.model,i,o)}),i(e,Z,function(t,e){var i=b(e,n,r);return x(e.model,n,i)}),i(e,$,function(t){return Object.keys(t).reduce(function(e,i){return x(t[i],h(n,i),e)},r)}),i(e,J,function(t){return t.reduce(function(t,e,i){return x(e,h(n,i),t)},r)}),e),u)}function w(t,e){return(0,V.isEqualWith)(t,e,function(t,e){return":"===t?!0:void 0})}function S(t,e){return function(){var n=e.apply(void 0,arguments);return(0,V.isPlainObject)(n)?Object.assign({},n,{address:t}):n}}function A(t,e){return(0,V.mapValues)(e,(0,V.curry)(S)(t))}function k(t,e,n){var i=c(e,n.relativeAddress),r=(0,V.get)(t,n.action,[]).filter(function(t){return w(t[0],i)}).map(function(t){return t[1]});return(0,V.get)(r,0,null)}function C(t,e){var n=x(t),i=(0,V.curry)(k)(n);return function(t){return function(n){return O(e,S(c(t,n.relativeAddress),i(t,n)))}}}function T(t,e){var n=(0,V.mapValues)(t,function(t){var n=t.filter(function(t){return w(t[0],e)}).map(function(t){return t[1]});return(0,V.get)(n,0,null)});return(0,V.omitBy)(n,function(t){return null===t})}function E(t,e){var n=x(t),i=(0,V.curry)(T)(n);return function(t){return P(e,A(t,i(t)))}}function M(t,e,n,r){var o;return l(t,(o={},i(o,Y,function(t,i){var o=function(t,e){return(0,V.isPlainObject)(t)&&e in t&&null!==t[e]},a=Object.assign({},e||{},n||{});return(0,V.mapValues)(a,function(t,a){var s=M(i.model,(0,V.get)(e,a,null),(0,V.get)(n,a,null),h(r,a));return s[nt]=o(e,a)&&!o(n,a),s[it]=o(e,a)&&(!o(n,a)||e[a]!==n[a]),s[rt]=!o(e,a)&&o(n,a),s})}),i(o,K,function(t,i){var o=function(t,e){return ht(t)&&e<t.length&&null!==t[e]},a=Math.max(ht(e)?e.length:0,ht(n)?n.length:0),s=Array.apply(null,{length:a});return s.map(function(t,a){var s=M(i.model,(0,V.get)(e,a,null),(0,V.get)(n,a,null),h(r,a));return s[nt]=o(e,a)&&!o(n,a),s[it]=o(e,a)&&(!o(n,a)||e[a]!==n[a]),s[rt]=!o(e,a)&&o(n,a),(0,V.isEqual)(h(r,a),["cells",0]),s})}),i(o,Z,function(t,i){var o=function(t){return null!==t},a=M(i.model,e||null,n||null,r);return a[nt]=o(e)&&!o(n),a[it]=o(e)&&(!o(n)||e!==n),a[rt]=!o(e)&&o(n),a}),i(o,J,function(i){return t.map(function(t,i){return M(t,(0,V.get)(e,i,null),(0,V.get)(n,i,null),h(r,i))})}),i(o,$,function(i){return(0,V.mapValues)(t,function(t,i){return M(t,(0,V.get)(e,i,null),(0,V.get)(n,i,null),h(r,i))})}),o),u)}function L(t,e,n,i,r,o,a,s,l,u){var c=P(u,A(r,t.actionCreators)),h=l(r);return s?(t.destroy(n,i,e,c,h),null):(o&&t.create(n,i,e,c,h),a?t.update(n,i,e,c,h):null)}function R(t,e,n,r,o,a,s){var c,d=arguments.length<=7||void 0===arguments[7]?[]:arguments[7];return l(t,(c={},i(c,Y,function(t,i){(0,V.mapValues)(n,function(t,n){var l=h(d,n),u=e[n],c=L(i,o[n],u,r,l,t[nt],t[it],t[rt],a,s);c&&R(i.model,u,t,r,c,a,s,l)})}),i(c,K,function(t,i){n.map(function(t,n){var l=h(d,n),u=e[n],c=L(i,o[n],u,r,l,t[nt],t[it],t[rt],a,s);c&&R(i.model,u,t,r,c,a,s,l)})}),i(c,Z,function(t,i){var l=e,u=n,c=L(i,o,e,r,d,u[nt],u[it],u[rt],a,s);c&&R(i.model,l,u,r,c,a,s,d)}),i(c,J,function(t){t.map(function(t,i){R(t,e[i],n[i],r,o[i],a,s,h(d,i))})}),i(c,$,function(t){(0,V.mapValues)(t,function(t,i){R(t,e[i],n[i],r,o[i],a,s,h(d,i))})}),c),u)}function O(t,e){return(0,V.flowRight)(t,e)}function P(t,e){return(0,V.mapValues)(e,(0,V.curry)(O)(t))}function D(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.name,n=void 0===e?"":e,i=t.model,r=void 0===i?{}:i,a=t.init,s=void 0===a?(0,V.constant)({}):a,l=t.getReducer,u=void 0===l?(0,V.constant)((0,V.nthArg)(0)):l,c=t.actionCreators,h=void 0===c?(0,V.constant)({}):c,d=t.create,f=void 0===d?V.noop:d,p=t.update,_=void 0===p?(0,V.constant)({}):p,g=t.destroy,m=void 0===g?V.noop:g,v=t.getAPI,y=void 0===v?(0,V.constant)({}):v;return(0,V.mapValues)(t,function(t,e){(0,V.includes)(["name","model","init","getReducer","actionCreators","create","update","destroy","getAPI"],e)||console.error("Unexpected argument "+e)}),o({name:n,model:r,init:s,reducer:u(r),actionCreators:h,create:f,update:_,destroy:m,getAPI:y},Z)}function I(t,e,n){var i=arguments.length<=3||void 0===arguments[3]?null:arguments[3],r=t,o=y(r),a=function(t,e){var n=(0,V.get)(t,"userState",null),i=e.type===X?e.state:o(n,e),a=M(r,i,n,[]);return{tinierState:a,userState:i}},s=n(a),l=C(r,s.dispatch),u=function(){var t=s.getState(),n=t.tinierState,i=t.userState;R(r,i,n,i,e,l,s.dispatch)};s.subscribe(u);var c=i||t.init(),h=function(t){return{type:X,state:t}};s.dispatch(h(c));var d=[],f=P(s.dispatch,A(d,t.actionCreators));return t.getAPI(f,l(d))}function N(t,e,n){return ht(e)&&0===e.length?t:(0,V.get)(t,e,n)}function F(t,e){var n=e().userState,i=N(n,t,null);return null===i&&console.warn("Could not find local state at address "+t),[i,n]}function B(t){return function(e){var n=e.dispatch,i=e.getState,o=E(t,n);return function(t){return function(e){return ct(e)?e.exec.apply(e,[o(e.address)].concat(r(F(e.address,i)))):t(e)}}}}function z(t){return function(e,n){return t.hasOwnProperty(n.type)?t[n.type](e,n):e}}function H(t,e){return function(n){var i=t(n);return o({type:e,exec:i},ot)}}function q(t){return(0,V.mapValues)(t,H)}function G(t){return function(e){return{type:t,payload:e}}}function j(t){return(0,V.zipObject)(t,t.map(G))}var U=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(l){r=!0,o=l}finally{try{!i&&s["return"]&&s["return"]()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(e,"__esModule",{value:!0}),e.GLOBAL_ACTION=void 0,e.objectOf=a,e.arrayOf=s,e.addressAction=d,e.addressRelFrom=f,e.addressRelTo=p,e.mapOrIdentity=g,e.mapValuesOrIdentity=m,e.mapState=v,e.createView=D,e.run=I,e.createMiddleware=B,e.createReducer=z,e.createAsyncActionCreator=H,e.createAsyncActionCreators=q,e.createActionCreator=G,e.createActionCreators=j;var V=n(233),W=e.GLOBAL_ACTION="@TINIER_GLOBAL_ACTION",X="@TINIER_UPDATE_STATE",K="@TINIER_ARRAY_OF",Y="@TINIER_OBJECT_OF",Z="@TINIER_VIEW",$="@TINIER_PLAIN_OBJECT",J="@TINIER_PLAIN_ARRAY",Q="@TINIER_ADDRESSED_ACTION",tt="@TINIER_ADDRESS_UP",et="@TINIER_ADDRESS_DOWN",nt="@TINIER_NEEDS_CREATE",it="@TINIER_NEEDS_UPDATE",rt="@TINIER_NEEDS_DESTROY",ot="@TINIER_ACTION",at=(0,V.curry)(function(t,e){return(0,V.get)(e,"type",null)===t}),st=at(Y),lt=at(K),ut=at(Z),ct=at(ot),ht=Array.isArray,dt=(0,V.curry)(function(t,e){throw Error("Content shape does not match state shape: "+e+" <-> Array "+t)})},function(t,e,n){var i;(function(t,r){(function(){function o(t,e){return t.set(e[0],e[1]),t}function a(t,e){return t.add(e),t}function s(t,e,n){var i=n.length;switch(i){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function l(t,e,n,i){for(var r=-1,o=t.length;++r<o;){var a=t[r];e(i,a,n(a),t)}return i}function u(t,e){for(var n=-1,i=t.length,r=-1,o=e.length,a=Array(i+o);++n<i;)a[n]=t[n];for(;++r<o;)a[n++]=e[r];return a}function c(t,e){for(var n=-1,i=t.length;++n<i&&e(t[n],n,t)!==!1;);return t}function h(t,e){for(var n=t.length;n--&&e(t[n],n,t)!==!1;);return t}function d(t,e){for(var n=-1,i=t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function f(t,e){for(var n=-1,i=t.length,r=-1,o=[];++n<i;){var a=t[n];e(a,n,t)&&(o[++r]=a)}return o}function p(t,e){return!!t.length&&A(t,e,0)>-1}function _(t,e,n){for(var i=-1,r=t.length;++i<r;)if(n(e,t[i]))return!0;return!1}function g(t,e){for(var n=-1,i=t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}function m(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function v(t,e,n,i){var r=-1,o=t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function y(t,e,n,i){var r=t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}function b(t,e){for(var n=-1,i=t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function x(t,e,n){for(var i=-1,r=t.length;++i<r;){var o=t[i],a=e(o);if(null!=a&&(s===$?a===a:n(a,s)))var s=a,l=o}return l}function w(t,e,n,i){var r;return n(t,function(t,n,o){return e(t,n,o)?(r=i?n:t,!1):void 0}),r}function S(t,e,n){for(var i=t.length,r=n?i:-1;n?r--:++r<i;)if(e(t[r],r,t))return r;return-1}function A(t,e,n){if(e!==e)return H(t,n);for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}function k(t,e,n,i,r){return r(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)}),n}function C(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function T(t,e){for(var n,i=-1,r=t.length;++i<r;){var o=e(t[i]);o!==$&&(n=n===$?o:n+o)}return n}function E(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function M(t,e){return g(e,function(e){return[e,t[e]]})}function L(t){return function(e){return t(e)}}function R(t,e){return g(e,function(e){return t[e]})}function O(t,e){for(var n=-1,i=t.length;++n<i&&A(e,t[n],0)>-1;);return n}function P(t,e){for(var n=t.length;n--&&A(e,t[n],0)>-1;);return n}function D(t){return t&&t.Object===Object?t:null}function I(t,e){if(t!==e){var n=null===t,i=t===$,r=t===t,o=null===e,a=e===$,s=e===e;if(t>e&&!o||!r||n&&!a&&s||i&&s)return 1;if(e>t&&!n||!s||o&&!i&&r||a&&r)return-1}return 0}function N(t,e,n){for(var i=-1,r=t.criteria,o=e.criteria,a=r.length,s=n.length;++i<a;){var l=I(r[i],o[i]);if(l){if(i>=s)return l;var u=n[i];return l*("desc"==u?-1:1)}}return t.index-e.index}function F(t){return wn[t]}function B(t){return Sn[t]}function z(t){return"\\"+Cn[t]}function H(t,e,n){for(var i=t.length,r=e+(n?0:-1);n?r--:++r<i;){var o=t[r];if(o!==o)return r}return-1}function q(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(n){}return e}function G(t,e){return t="number"==typeof t||Te.test(t)?+t:-1,e=null==e?wt:e,t>-1&&t%1==0&&e>t}function j(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function U(t){var e=-1,n=Array(t.size);return t.forEach(function(t,i){n[++e]=[i,t]}),n}function V(t,e){for(var n=-1,i=t.length,r=-1,o=[];++n<i;)t[n]===e&&(t[n]=Et,o[++r]=n);return o}function W(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function X(t){if(!t||!pn.test(t))return t.length;for(var e=fn.lastIndex=0;fn.test(t);)e++;return e}function K(t){return t.match(fn)}function Y(t){return An[t]}function Z(t){function e(t){if(Da(t)&&!gc(t)&&!(t instanceof r)){if(t instanceof i)return t;if(zl.call(t,"__wrapped__"))return Lr(t)}return new i(t)}function n(){}function i(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=$}function r(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=kt,this.__views__=[]}function D(){var t=new r(this.__wrapped__);return t.__actions__=Di(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Di(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Di(this.__views__),t}function Te(){if(this.__filtered__){var t=new r(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Re(){var t=this.__wrapped__.value(),e=this.__dir__,n=gc(t),i=0>e,r=n?t.length:0,o=hr(0,r,this.__views__),a=o.start,s=o.end,l=s-a,u=i?s:a-1,c=this.__iteratees__,h=c.length,d=0,f=uu(l,this.__takeCount__);if(!n||_t>r||r==l&&f==l)return wi(t,this.__actions__);var p=[];t:for(;l--&&f>d;){u+=e;for(var _=-1,g=t[u];++_<h;){var m=c[_],v=m.iteratee,y=m.type,b=v(g);if(y==mt)g=b;else if(!b){if(y==gt)continue t;break t}}p[d++]=g}return p}function Oe(){}function Pe(t,e){return Ie(t,e)&&delete t[e]}function De(t,e){if(gu){var n=t[e];return n===bt?$:n}return zl.call(t,e)?t[e]:$}function Ie(t,e){return gu?t[e]!==$:zl.call(t,e)}function Ne(t,e,n){t[e]=gu&&n===$?bt:n}function Fe(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Be(){this.__data__={hash:new Oe,map:fu?new fu:[],string:new Oe}}function ze(t){var e=this.__data__;return yr(t)?Pe("string"==typeof t?e.string:e.hash,t):fu?e.map["delete"](t):Je(e.map,t)}function He(t){var e=this.__data__;return yr(t)?De("string"==typeof t?e.string:e.hash,t):fu?e.map.get(t):Qe(e.map,t)}function qe(t){var e=this.__data__;return yr(t)?Ie("string"==typeof t?e.string:e.hash,t):fu?e.map.has(t):tn(e.map,t)}function Ge(t,e){var n=this.__data__;return yr(t)?Ne("string"==typeof t?n.string:n.hash,t,e):fu?n.map.set(t,e):nn(n.map,t,e),this}function je(t){var e=-1,n=t?t.length:0;for(this.__data__=new Fe;++e<n;)this.push(t[e])}function Ue(t,e){var n=t.__data__;if(yr(e)){var i=n.__data__,r="string"==typeof e?i.string:i.hash;return r[e]===bt}return n.has(e)}function Ve(t){var e=this.__data__;if(yr(t)){var n=e.__data__,i="string"==typeof t?n.string:n.hash;i[t]=bt}else e.set(t,bt)}function We(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Xe(){this.__data__={array:[],map:null}}function Ke(t){var e=this.__data__,n=e.array;return n?Je(n,t):e.map["delete"](t)}function Ye(t){var e=this.__data__,n=e.array;return n?Qe(n,t):e.map.get(t)}function Ze(t){var e=this.__data__,n=e.array;return n?tn(n,t):e.map.has(t)}function $e(t,e){var n=this.__data__,i=n.array;i&&(i.length<_t-1?nn(i,t,e):(n.array=null,n.map=new Fe(i)));var r=n.map;return r&&r.set(t,e),this}function Je(t,e){var n=en(t,e);if(0>n)return!1;var i=t.length-1;return n==i?t.pop():nu.call(t,n,1),!0}function Qe(t,e){var n=en(t,e);return 0>n?$:t[n][1]}function tn(t,e){return en(t,e)>-1}function en(t,e){for(var n=t.length;n--;)if(_a(t[n][0],e))return n;return-1}function nn(t,e,n){var i=en(t,e);0>i?t.push([e,n]):t[i][1]=n}function rn(t,e,n,i){return t===$||_a(t,Fl[n])&&!zl.call(i,n)?e:t}function on(t,e,n){(n!==$&&!_a(t[e],n)||"number"==typeof e&&n===$&&!(e in t))&&(t[e]=n)}function an(t,e,n){var i=t[e];(!_a(i,n)||_a(i,Fl[e])&&!zl.call(t,e)||n===$&&!(e in t))&&(t[e]=n)}function sn(t,e,n,i){return Cu(t,function(t,r,o){e(i,t,n(t),o)}),i}function ln(t,e){return t&&Ii(e,bs(e),t)}function un(t,e){for(var n=-1,i=null==t,r=e.length,o=Array(r);++n<r;)o[n]=i?$:ms(t,e[n]);return o}function cn(t,e,n){return t===t&&(n!==$&&(t=n>=t?t:n),e!==$&&(t=t>=e?t:e)),t}function hn(t,e,n,i,r,o){var a;if(n&&(a=r?n(t,i,r,o):n(t)),a!==$)return a;if(!Pa(t))return t;var s=gc(t);if(s){if(a=fr(t),!e)return Di(t,a)}else{var l=cr(t),u=l==Dt||l==It;if(mc(t))return ki(t,e);if(l!=Bt&&l!=Mt&&(!u||r))return xn[l]?_r(t,l,e):r?t:{};if(q(t))return r?t:{};if(a=pr(u?{}:t),!e)return Fi(t,ln(a,t))}o||(o=new We);var h=o.get(t);return h?h:(o.set(t,a),(s?c:Rn)(t,function(i,r){an(a,r,hn(i,e,n,r,t,o))}),s?a:Fi(t,a))}function fn(t){var e=bs(t),n=e.length;return function(i){if(null==i)return!n;for(var r=n;r--;){var o=e[r],a=t[o],s=i[o];if(s===$&&!(o in Object(i))||!a(s))return!1}return!0}}function wn(t,e,n){if("function"!=typeof t)throw new Il(yt);return eu(function(){t.apply($,n)},e)}function Sn(t,e,n,i){var r=-1,o=p,a=!0,s=t.length,l=[],u=e.length;if(!s)return l;n&&(e=g(e,L(n))),i?(o=_,a=!1):e.length>=_t&&(o=Ue,a=!1,e=new je(e));t:for(;++r<s;){var c=t[r],h=n?n(c):c;if(a&&h===h){for(var d=u;d--;)if(e[d]===h)continue t;l.push(c)}else o(e,h,i)||l.push(c)}return l}function An(t,e){var n=!0;return Cu(t,function(t,i,r){return n=!!e(t,i,r)}),n}function kn(t,e,n,i){var r=t.length;for(n=ns(n),0>n&&(n=-n>r?0:r+n),i=i===$||i>r?r:ns(i),0>i&&(i+=r),i=n>i?0:is(i);i>n;)t[n++]=e;return t}function Cn(t,e){var n=[];return Cu(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n}function Mn(t,e,n,i){i||(i=[]);for(var r=-1,o=t.length;++r<o;){var a=t[r];xa(a)&&(n||gc(a)||va(a))?e?Mn(a,e,n,i):m(i,a):n||(i[i.length]=a)}return i}function Ln(t,e){return null==t?t:Eu(t,e,xs)}function Rn(t,e){return t&&Eu(t,e,bs)}function On(t,e){return t&&Mu(t,e,bs)}function Pn(t,e){return f(e,function(e){return La(t[e])})}function In(t,e){e=vr(e,t)?[e+""]:vi(e);for(var n=0,i=e.length;null!=t&&i>n;)t=t[e[n++]];return n&&n==i?t:$}function Bn(t,e){return zl.call(t,e)||"object"==typeof t&&e in t&&null===$l(t)}function zn(t,e){return e in Object(t)}function Hn(t,e,n){return t>=uu(e,n)&&t<lu(e,n)}function qn(t,e,n){for(var i=n?_:p,r=t.length,o=r,a=Array(r),s=[];o--;){var l=t[o];o&&e&&(l=g(l,L(e))),a[o]=!n&&(e||l.length>=120)?new je(o&&l):$}l=t[0];var u=-1,c=l.length,h=a[0];t:for(;++u<c;){var d=l[u],f=e?e(d):d;if(!(h?Ue(h,f):i(s,f,n))){for(var o=r;--o;){var m=a[o];if(!(m?Ue(m,f):i(t[o],f,n)))continue t}h&&h.push(f),s.push(d)}}return s}function Gn(t,e,n,i){return Rn(t,function(t,r,o){e(i,n(t),r,o)}),i}function jn(t,e,n){vr(e,t)||(e=vi(e),t=kr(t,e),e=Xr(e));var i=null==t?t:t[e];return null==i?$:s(i,t,n)}function Un(t,e,n,i,r){return t===e?!0:null==t||null==e||!Pa(t)&&!Da(e)?t!==t&&e!==e:Vn(t,e,Un,n,i,r)}function Vn(t,e,n,i,r,o){var a=gc(t),s=gc(e),l=Lt,u=Lt;a||(l=cr(t),l==Mt?l=Bt:l!=Bt&&(a=Ya(t))),s||(u=cr(e),u==Mt?u=Bt:u!=Bt&&(s=Ya(e)));var c=l==Bt&&!q(t),h=u==Bt&&!q(e),d=l==u;if(d&&!a&&!c)return rr(t,e,l,n,i,r);var f=r&ct;if(!f){var p=c&&zl.call(t,"__wrapped__"),_=h&&zl.call(e,"__wrapped__");if(p||_)return n(p?t.value():t,_?e.value():e,i,r,o)}return d?(o||(o=new We),(a?ir:or)(t,e,n,i,r,o)):!1}function Wn(t,e,n,i){var r=n.length,o=r,a=!i;if(null==t)return!o;for(t=Object(t);r--;){var s=n[r];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++r<o;){s=n[r];var l=s[0],u=t[l],c=s[1];if(a&&s[2]){if(u===$&&!(l in t))return!1}else{var h=new We,d=i?i(u,c,l,t,e,h):$;if(!(d===$?Un(c,u,i,ut|ct,h):d))return!1}}return!0}function Xn(t){var e=typeof t;return"function"==e?t:null==t?ul:"object"==e?gc(t)?Jn(t[0],t[1]):$n(t):ml(t)}function Kn(t){return su(Object(t))}function Yn(t){t=null==t?t:Object(t);var e=[];for(var n in t)e.push(n);return e}function Zn(t,e){var n=-1,i=ba(t)?Array(t.length):[];return Cu(t,function(t,r,o){i[++n]=e(t,r,o)}),i}function $n(t){var e=lr(t);if(1==e.length&&e[0][2]){var n=e[0][0],i=e[0][1];return function(t){return null==t?!1:t[n]===i&&(i!==$||n in Object(t))}}return function(n){return n===t||Wn(n,t,e)}}function Jn(t,e){return function(n){var i=ms(n,t);return i===$&&i===e?ys(n,t):Un(e,i,$,ut|ct)}}function Qn(t,e,n,i,r){if(t!==e){var o=gc(e)||Ya(e)?$:xs(e);c(o||e,function(a,s){if(o&&(s=a,a=e[s]),Pa(a))r||(r=new We),ti(t,e,s,n,Qn,i,r);else{var l=i?i(t[s],a,s+"",t,e,r):$;l===$&&(l=a),on(t,s,l)}})}}function ti(t,e,n,i,r,o,a){var s=t[n],l=e[n],u=a.get(l);if(u)return void on(t,n,u);var c=o?o(s,l,n+"",t,e,a):$,h=c===$;h&&(c=l,gc(l)||Ya(l)?gc(s)?c=i?Di(s):s:xa(s)?c=Di(s):(h=!1,c=hn(l)):ja(l)||va(l)?va(s)?c=os(s):!Pa(s)||i&&La(s)?(h=!1,c=hn(l)):c=i?hn(s):s:h=!1),a.set(l,c),h&&r(c,l,i,o,a),on(t,n,c)}function ei(t,e,n){var i=-1,r=sr();e=g(e.length?e:Array(1),function(t){return r(t)});var o=Zn(t,function(t,n,r){var o=g(e,function(e){return e(t)});return{criteria:o,index:++i,value:t}});return C(o,function(t,e){return N(t,e,n)})}function ni(t,e){return t=Object(t),v(e,function(e,n){return n in t&&(e[n]=t[n]),e},{})}function ii(t,e){var n={};return Ln(t,function(t,i){e(t,i)&&(n[i]=t)}),n}function ri(t){return function(e){return null==e?$:e[t]}}function oi(t){return function(e){return In(e,t)}}function ai(t,e){return si(t,e)}function si(t,e,n){var i=-1,r=e.length,o=t;for(n&&(o=g(t,function(t){return n(t)}));++i<r;)for(var a=0,s=e[i],l=n?n(s):s;(a=A(o,l,a))>-1;)o!==t&&nu.call(o,a,1),nu.call(t,a,1);return t}function li(t,e){for(var n=t?e.length:0,i=n-1;n--;){var r=e[n];if(i==n||r!=o){var o=r;if(G(r))nu.call(t,r,1);else if(vr(r,t))delete t[r];else{var a=vi(r),s=kr(t,a);null!=s&&delete s[Xr(a)]}}}return t}function ui(t,e){return t+ru(hu()*(e-t+1))}function ci(t,e,n,i){for(var r=-1,o=lu(iu((e-t)/(n||1)),0),a=Array(o);o--;)a[i?o:++r]=t,t+=n;return a}function hi(t,e,n,i){e=vr(e,t)?[e+""]:vi(e);for(var r=-1,o=e.length,a=o-1,s=t;null!=s&&++r<o;){var l=e[r];if(Pa(s)){var u=n;if(r!=a){var c=s[l];u=i?i(c,l,s):$,u===$&&(u=null==c?G(e[r+1])?[]:{}:c)}an(s,l,u)}s=s[l]}return t}function di(t,e,n){var i=-1,r=t.length;0>e&&(e=-e>r?0:r+e),n=n>r?r:n,0>n&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(r);++i<r;)o[i]=t[i+e];return o}function fi(t,e){var n;return Cu(t,function(t,i,r){return n=e(t,i,r),!n}),!!n}function pi(t,e,n){var i=0,r=t?t.length:i;if("number"==typeof e&&e===e&&Tt>=r){for(;r>i;){var o=i+r>>>1,a=t[o];(n?e>=a:e>a)&&null!==a?i=o+1:r=o}return r}return _i(t,e,ul,n);
}function _i(t,e,n,i){e=n(e);for(var r=0,o=t?t.length:0,a=e!==e,s=null===e,l=e===$;o>r;){var u=ru((r+o)/2),c=n(t[u]),h=c!==$,d=c===c;if(a)var f=d||i;else f=s?d&&h&&(i||null!=c):l?d&&(i||h):null==c?!1:i?e>=c:e>c;f?r=u+1:o=u}return uu(o,Ct)}function gi(t){return mi(t)}function mi(t,e){for(var n=0,i=t.length,r=t[0],o=e?e(r):r,a=o,s=0,l=[r];++n<i;)r=t[n],o=e?e(r):r,_a(o,a)||(a=o,l[++s]=r);return l}function vi(t){return gc(t)?t:Tr(t)}function yi(t,e,n){var i=-1,r=p,o=t.length,a=!0,s=[],l=s;if(n)a=!1,r=_;else if(o>=_t){var u=e?null:Ru(t);if(u)return W(u);a=!1,r=Ue,l=new je}else l=e?[]:s;t:for(;++i<o;){var c=t[i],h=e?e(c):c;if(a&&h===h){for(var d=l.length;d--;)if(l[d]===h)continue t;e&&l.push(h),s.push(c)}else r(l,h,n)||(l!==s&&l.push(h),s.push(c))}return s}function bi(t,e){e=vr(e,t)?[e+""]:vi(e),t=kr(t,e);var n=Xr(e);return null!=t&&vs(t,n)?delete t[n]:!0}function xi(t,e,n,i){for(var r=t.length,o=i?r:-1;(i?o--:++o<r)&&e(t[o],o,t););return n?di(t,i?0:o,i?o+1:r):di(t,i?o+1:0,i?r:o)}function wi(t,e){var n=t;return n instanceof r&&(n=n.value()),v(e,function(t,e){return e.func.apply(e.thisArg,m([t],e.args))},n)}function Si(t,e,n){for(var i=-1,r=t.length;++i<r;)var o=o?m(Sn(o,t[i],e,n),Sn(t[i],o,e,n)):t[i];return o&&o.length?yi(o,e,n):[]}function Ai(t,e,n){for(var i=-1,r=t.length,o=e.length,a={};++i<r;)n(a,t[i],o>i?e[i]:$);return a}function ki(t,e){if(e)return t.slice();var n=t.constructor,i=new n(t.length);return t.copy(i),i}function Ci(t){var e=t.constructor,n=new e(t.byteLength),i=new Kl(n);return i.set(new Kl(t)),n}function Ti(t){var e=t.constructor;return v(U(t),o,new e)}function Ei(t){var e=t.constructor,n=new e(t.source,xe.exec(t));return n.lastIndex=t.lastIndex,n}function Mi(t){var e=t.constructor;return v(W(t),a,new e)}function Li(t){return Xl?Object(wu.call(t)):{}}function Ri(t,e){var n=t.buffer,i=t.constructor;return new i(e?Ci(n):n,t.byteOffset,t.length)}function Oi(t,e,n){for(var i=n.length,r=-1,o=lu(t.length-i,0),a=-1,s=e.length,l=Array(s+o);++a<s;)l[a]=e[a];for(;++r<i;)l[n[r]]=t[r];for(;o--;)l[a++]=t[r++];return l}function Pi(t,e,n){for(var i=-1,r=n.length,o=-1,a=lu(t.length-r,0),s=-1,l=e.length,u=Array(a+l);++o<a;)u[o]=t[o];for(var c=o;++s<l;)u[c+s]=e[s];for(;++i<r;)u[c+n[i]]=t[o++];return u}function Di(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}function Ii(t,e,n){return Ni(t,e,n)}function Ni(t,e,n,i){n||(n={});for(var r=-1,o=e.length;++r<o;){var a=e[r],s=i?i(n[a],t[a],a,n,t):t[a];an(n,a,s)}return n}function Fi(t,e){return Ii(t,Du(t),e)}function Bi(t,e){return function(n,i){var r=gc(n)?l:sn,o=e?e():{};return r(n,t,sr(i),o)}}function zi(t){return aa(function(e,n){var i=-1,r=n.length,o=r>1?n[r-1]:$,a=r>2?n[2]:$;for(o="function"==typeof o?(r--,o):$,a&&mr(n[0],n[1],a)&&(o=3>r?$:o,r=1),e=Object(e);++i<r;){var s=n[i];s&&t(e,s,i,o)}return e})}function Hi(t,e){return function(n,i){if(null==n)return n;if(!ba(n))return t(n,i);for(var r=n.length,o=e?r:-1,a=Object(n);(e?o--:++o<r)&&i(a[o],o,a)!==!1;);return n}}function qi(t){return function(e,n,i){for(var r=-1,o=Object(e),a=i(e),s=a.length;s--;){var l=a[t?s:++r];if(n(o[l],l,o)===!1)break}return e}}function Gi(t,e,n){function i(){var e=this&&this!==Nn&&this instanceof i?o:t;return e.apply(r?n:this,arguments)}var r=e&Q,o=Vi(t);return i}function ji(t){return function(e){e=ss(e);var n=pn.test(e)?K(e):$,i=n?n[0]:e.charAt(0),r=n?n.slice(1).join(""):e.slice(1);return i[t]()+r}}function Ui(t){return function(e){return v(ol(zs(e)),t,"")}}function Vi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=ku(t.prototype),i=t.apply(n,e);return Pa(i)?i:n}}function Wi(t,n,i){function r(){for(var a=arguments.length,l=a,u=Array(a),c=this&&this!==Nn&&this instanceof r?o:t,h=e.placeholder||r.placeholder;l--;)u[l]=arguments[l];var d=3>a&&u[0]!==h&&u[a-1]!==h?[]:V(u,h);return a-=d.length,i>a?tr(t,n,Ki,h,$,u,d,$,$,i-a):s(c,this,u)}var o=Vi(t);return r}function Xi(t){return aa(function(e){e=Mn(e);var n=e.length,r=n,o=i.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new Il(yt);if(o&&!s&&"wrapper"==ar(a))var s=new i([],!0)}for(r=s?r:n;++r<n;){a=e[r];var l=ar(a),u="wrapper"==l?Ou(a):$;s=u&&br(u[0])&&u[1]==(at|nt|rt|st)&&!u[4].length&&1==u[9]?s[ar(u[0])].apply(s,u[3]):1==a.length&&br(a)?s[l]():s.thru(a)}return function(){var t=arguments,i=t[0];if(s&&1==t.length&&gc(i)&&i.length>=_t)return s.plant(i).value();for(var r=0,o=n?e[r].apply(this,t):i;++r<n;)o=e[r].call(this,o);return o}})}function Ki(t,n,i,r,o,a,s,l,u,c){function h(){for(var y=arguments.length,b=y,x=Array(y);b--;)x[b]=arguments[b];if(r&&(x=Oi(x,r,o)),a&&(x=Pi(x,a,s)),_||g){var w=e.placeholder||h.placeholder,S=V(x,w);if(y-=S.length,c>y)return tr(t,n,Ki,w,i,x,S,l,u,c-y)}var A=f?i:this,k=p?A[t]:t;return l?x=Cr(x,l):m&&x.length>1&&x.reverse(),d&&u<x.length&&(x.length=u),this&&this!==Nn&&this instanceof h&&(k=v||Vi(k)),k.apply(A,x)}var d=n&at,f=n&Q,p=n&tt,_=n&nt,g=n&it,m=n&lt,v=p?$:Vi(t);return h}function Yi(t,e){return function(n,i){return Gn(n,t,e(i),{})}}function Zi(t){return aa(function(e){return e=g(Mn(e),sr()),aa(function(n){var i=this;return t(e,function(t){return s(t,i,n)})})})}function $i(t,e,n){e=ns(e);var i=X(t);if(!e||i>=e)return"";var r=e-i;n=n===$?" ":n+"";var o=Xs(n,iu(r/X(n)));return pn.test(n)?K(o).slice(0,r).join(""):o.slice(0,r)}function Ji(t,e,n,i){function r(){for(var e=-1,l=arguments.length,u=-1,c=i.length,h=Array(c+l),d=this&&this!==Nn&&this instanceof r?a:t;++u<c;)h[u]=i[u];for(;l--;)h[u++]=arguments[++e];return s(d,o?n:this,h)}var o=e&Q,a=Vi(t);return r}function Qi(t){return function(e,n,i){return i&&"number"!=typeof i&&mr(e,n,i)&&(n=i=$),e=rs(e),e=e===e?e:0,n===$?(n=e,e=0):n=rs(n)||0,i=i===$?n>e?1:-1:rs(i)||0,ci(e,n,i,t)}}function tr(t,e,n,i,r,o,a,s,l,u){var c=e&nt,h=s?Di(s):$,d=c?a:$,f=c?$:a,p=c?o:$,_=c?$:o;e|=c?rt:ot,e&=~(c?ot:rt),e&et||(e&=~(Q|tt));var g=[t,e,r,p,d,_,f,h,l,u],m=n.apply($,g);return br(t)&&Iu(m,g),m.placeholder=i,m}function er(t){var e=Pl[t];return function(t,n){if(t=rs(t),n=ns(n)){var i=(ss(t)+"e").split("e"),r=e(i[0]+"e"+(+i[1]+n));return i=(ss(r)+"e").split("e"),+(i[0]+"e"+(+i[1]-n))}return e(t)}}function nr(t,e,n,i,r,o,a,s){var l=e&tt;if(!l&&"function"!=typeof t)throw new Il(yt);var u=i?i.length:0;if(u||(e&=~(rt|ot),i=r=$),a=a===$?a:lu(ns(a),0),s=s===$?s:ns(s),u-=r?r.length:0,e&ot){var c=i,h=r;i=r=$}var d=l?$:Ou(t),f=[t,e,n,i,r,c,h,o,a,s];if(d&&Sr(f,d),t=f[0],e=f[1],n=f[2],i=f[3],r=f[4],s=f[9]=null==f[9]?l?0:t.length:lu(f[9]-u,0),!s&&e&(nt|it)&&(e&=~(nt|it)),e&&e!=Q)p=e==nt||e==it?Wi(t,e,s):e!=rt&&e!=(Q|rt)||r.length?Ki.apply($,f):Ji(t,e,n,i);else var p=Gi(t,e,n);var _=d?Lu:Iu;return _(p,f)}function ir(t,e,n,i,r,o){var a=-1,s=r&ct,l=r&ut,u=t.length,c=e.length;if(u!=c&&!(s&&c>u))return!1;var h=o.get(t);if(h)return h==e;var d=!0;for(o.set(t,e);++a<u;){var f=t[a],p=e[a];if(i)var _=s?i(p,f,a,e,t,o):i(f,p,a,t,e,o);if(_!==$){if(_)continue;d=!1;break}if(l){if(!b(e,function(t){return f===t||n(f,t,i,r,o)})){d=!1;break}}else if(f!==p&&!n(f,p,i,r,o)){d=!1;break}}return o["delete"](t),d}function rr(t,e,n,i,r,o){switch(n){case Vt:return t.byteLength==e.byteLength&&i(new Kl(t),new Kl(e))?!0:!1;case Rt:case Ot:return+t==+e;case Pt:return t.name==e.name&&t.message==e.message;case Ft:return t!=+t?e!=+e:t==+e;case zt:case qt:return t==e+"";case Nt:var a=U;case Ht:var s=o&ct;return a||(a=W),(s||t.size==e.size)&&i(a(t),a(e),r,o|ut);case Gt:return!!Xl&&wu.call(t)==wu.call(e)}return!1}function or(t,e,n,i,r,o){var a=r&ct,s=bs(t),l=s.length,u=bs(e),c=u.length;if(l!=c&&!a)return!1;for(var h=l;h--;){var d=s[h];if(!(a?d in e:Bn(e,d)))return!1}var f=o.get(t);if(f)return f==e;var p=!0;o.set(t,e);for(var _=a;++h<l;){d=s[h];var g=t[d],m=e[d];if(i)var v=a?i(m,g,d,e,t,o):i(g,m,d,t,e,o);if(!(v===$?g===m||n(g,m,i,r,o):v)){p=!1;break}_||(_="constructor"==d)}if(p&&!_){var y=t.constructor,b=e.constructor;y!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return o["delete"](t),p}function ar(t){for(var e=t.name+"",n=Au[e],i=zl.call(Au,e)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==t)return r.name}return e}function sr(){var t=e.iteratee||cl;return t=t===cl?Xn:t,arguments.length?t(arguments[0],arguments[1]):t}function lr(t){for(var e=Ms(t),n=e.length;n--;)e[n][2]=wr(e[n][1]);return e}function ur(t,e){var n=null==t?$:t[e];return za(n)?n:$}function cr(t){return Gl.call(t)}function hr(t,e,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=uu(e,t+a);break;case"takeRight":t=lu(t,e-a)}}return{start:t,end:e}}function dr(t,e,n){if(null==t)return!1;var i=n(t,e);i||vr(e)||(e=vi(e),t=kr(t,e),null!=t&&(e=Xr(e),i=n(t,e)));var r=t?t.length:$;return i||!!r&&Oa(r)&&G(e,r)&&(gc(t)||Xa(t)||va(t))}function fr(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&zl.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function pr(t){if(xr(t))return{};var e=t.constructor;return ku(La(e)?e.prototype:$)}function _r(t,e,n){var i=t.constructor;switch(e){case Vt:return Ci(t);case Rt:case Ot:return new i(+t);case Wt:case Xt:case Kt:case Yt:case Zt:case $t:case Jt:case Qt:case te:return Ri(t,n);case Nt:return Ti(t);case Ft:case qt:return new i(t);case zt:return Ei(t);case Ht:return Mi(t);case Gt:return Li(t)}}function gr(t){var e=t?t.length:$;return Oa(e)&&(gc(t)||Xa(t)||va(t))?E(e,String):null}function mr(t,e,n){if(!Pa(n))return!1;var i=typeof e;return("number"==i?ba(n)&&G(e,n.length):"string"==i&&e in n)?_a(n[e],t):!1}function vr(t,e){return"number"==typeof t?!0:!gc(t)&&(de.test(t)||!he.test(t)||null!=e&&t in Object(e))}function yr(t){var e=typeof t;return"number"==e||"boolean"==e||"string"==e&&"__proto__"!==t||null==t}function br(t){var n=ar(t),i=e[n];if("function"!=typeof i||!(n in r.prototype))return!1;if(t===i)return!0;var o=Ou(i);return!!o&&t===o[0]}function xr(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||Fl;return t===n}function wr(t){return t===t&&!Pa(t)}function Sr(t,e){var n=t[1],i=e[1],r=n|i,o=(Q|tt|at)>r,a=i==at&&n==nt||i==at&&n==st&&t[7].length<=e[8]||i==(at|st)&&e[7].length<=e[8]&&n==nt;if(!o&&!a)return t;i&Q&&(t[2]=e[2],r|=n&Q?0:et);var s=e[3];if(s){var l=t[3];t[3]=l?Oi(l,s,e[4]):Di(s),t[4]=l?V(t[3],Et):Di(e[4])}return s=e[5],s&&(l=t[5],t[5]=l?Pi(l,s,e[6]):Di(s),t[6]=l?V(t[5],Et):Di(e[6])),s=e[7],s&&(t[7]=Di(s)),i&at&&(t[8]=null==t[8]?e[8]:uu(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r,t}function Ar(t,e,n,i,r,o){return Pa(t)&&Pa(e)&&(o.set(e,t),Qn(t,e,$,Ar,o)),t}function kr(t,e){return 1==e.length?t:ms(t,di(e,0,-1))}function Cr(t,e){for(var n=t.length,i=uu(e.length,n),r=Di(t);i--;){var o=e[i];t[i]=G(o,n)?r[o]:$}return t}function Tr(t){var e=[];return ss(t).replace(fe,function(t,n,i,r){e.push(i?r.replace(ye,"$1"):n||t)}),e}function Er(t){return xa(t)?t:[]}function Mr(t){return"function"==typeof t?t:ul}function Lr(t){if(t instanceof r)return t.clone();var e=new i(t.__wrapped__,t.__chain__);return e.__actions__=Di(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function Rr(t,e){e=lu(ns(e),0);var n=t?t.length:0;if(!n||1>e)return[];for(var i=0,r=-1,o=Array(iu(n/e));n>i;)o[++r]=di(t,i,i+=e);return o}function Or(t){for(var e=-1,n=t?t.length:0,i=-1,r=[];++e<n;){var o=t[e];o&&(r[++i]=o)}return r}function Pr(t,e,n){var i=t?t.length:0;return i?(e=n||e===$?1:ns(e),di(t,0>e?0:e,i)):[]}function Dr(t,e,n){var i=t?t.length:0;return i?(e=n||e===$?1:ns(e),e=i-e,di(t,0,0>e?0:e)):[]}function Ir(t,e){return t&&t.length?xi(t,sr(e,3),!0,!0):[]}function Nr(t,e){return t&&t.length?xi(t,sr(e,3),!0):[]}function Fr(t,e,n,i){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&mr(t,e,n)&&(n=0,i=r),kn(t,e,n,i)):[]}function Br(t,e){return t&&t.length?S(t,sr(e,3)):-1}function zr(t,e){return t&&t.length?S(t,sr(e,3),!0):-1}function Hr(t){var e=t?t.length:0;return e?Mn(t):[]}function qr(t){var e=t?t.length:0;return e?Mn(t,!0):[]}function Gr(t){for(var e=-1,n=t?t.length:0,i={};++e<n;){var r=t[e];i[r[0]]=r[1]}return i}function jr(t){return t?t[0]:$}function Ur(t,e,n){var i=t?t.length:0;return i?(n=ns(n),0>n&&(n=lu(i+n,0)),A(t,e,n)):-1}function Vr(t){return Dr(t,1)}function Wr(t,e){return t?au.call(t,e):""}function Xr(t){var e=t?t.length:0;return e?t[e-1]:$}function Kr(t,e,n){var i=t?t.length:0;if(!i)return-1;var r=i;if(n!==$&&(r=ns(n),r=(0>r?lu(i+r,0):uu(r,i-1))+1),e!==e)return H(t,r,!0);for(;r--;)if(t[r]===e)return r;return-1}function Yr(t,e){return t&&t.length&&e&&e.length?ai(t,e):t}function Zr(t,e,n){return t&&t.length&&e&&e.length?si(t,e,sr(n)):t}function $r(t,e){var n=[];if(!t||!t.length)return n;var i=-1,r=[],o=t.length;for(e=sr(e,3);++i<o;){var a=t[i];e(a,i,t)&&(n.push(a),r.push(i))}return li(t,r),n}function Jr(t){return t?du.call(t):t}function Qr(t,e,n){var i=t?t.length:0;return i?(n&&"number"!=typeof n&&mr(t,e,n)?(e=0,n=i):(e=null==e?0:ns(e),n=n===$?i:ns(n)),di(t,e,n)):[]}function to(t,e){return pi(t,e)}function eo(t,e,n){return _i(t,e,sr(n))}function no(t,e){var n=t?t.length:0;if(n){var i=pi(t,e);if(n>i&&_a(t[i],e))return i}return-1}function io(t,e){return pi(t,e,!0)}function ro(t,e,n){return _i(t,e,sr(n),!0)}function oo(t,e){var n=t?t.length:0;if(n){var i=pi(t,e,!0)-1;if(_a(t[i],e))return i}return-1}function ao(t){return t&&t.length?gi(t):[]}function so(t,e){return t&&t.length?mi(t,sr(e)):[]}function lo(t){return Pr(t,1)}function uo(t,e,n){return t&&t.length?(e=n||e===$?1:ns(e),di(t,0,0>e?0:e)):[]}function co(t,e,n){var i=t?t.length:0;return i?(e=n||e===$?1:ns(e),e=i-e,di(t,0>e?0:e,i)):[]}function ho(t,e){return t&&t.length?xi(t,sr(e,3),!1,!0):[]}function fo(t,e){return t&&t.length?xi(t,sr(e,3)):[]}function po(t){return t&&t.length?yi(t):[]}function _o(t,e){return t&&t.length?yi(t,sr(e)):[]}function go(t,e){return t&&t.length?yi(t,$,e):[]}function mo(t){if(!t||!t.length)return[];var e=0;return t=f(t,function(t){return xa(t)?(e=lu(t.length,e),!0):void 0}),E(e,function(e){return g(t,ri(e))})}function vo(t,e){if(!t||!t.length)return[];var n=mo(t);return null==e?n:g(n,function(t){return s(e,$,t)})}function yo(t,e){return Ai(t||[],e||[],an)}function bo(t,e){return Ai(t||[],e||[],hi)}function xo(t){var n=e(t);return n.__chain__=!0,n}function wo(t,e){return e(t),t}function So(t,e){return e(t)}function Ao(){return xo(this)}function ko(){return new i(this.value(),this.__chain__)}function Co(t){return this.map(t).flatten()}function To(){this.__values__===$&&(this.__values__=es(this.value()));var t=this.__index__>=this.__values__.length,e=t?$:this.__values__[this.__index__++];return{done:t,value:e}}function Eo(){return this}function Mo(t){for(var e,i=this;i instanceof n;){var r=Lr(i);r.__index__=0,r.__values__=$,e?o.__wrapped__=r:e=r;var o=r;i=i.__wrapped__}return o.__wrapped__=t,e}function Lo(){var t=this.__wrapped__;if(t instanceof r){var e=t;return this.__actions__.length&&(e=new r(this)),e=e.reverse(),e.__actions__.push({func:So,args:[Jr],thisArg:$}),new i(e,this.__chain__)}return this.thru(Jr)}function Ro(){return wi(this.__wrapped__,this.__actions__)}function Oo(t,e,n){var i=gc(t)?d:An;return n&&mr(t,e,n)&&(e=$),i(t,sr(e,3))}function Po(t,e){var n=gc(t)?f:Cn;return n(t,sr(e,3))}function Do(t,e){if(e=sr(e,3),gc(t)){var n=S(t,e);return n>-1?t[n]:$}return w(t,e,Cu)}function Io(t,e){if(e=sr(e,3),gc(t)){var n=S(t,e,!0);return n>-1?t[n]:$}return w(t,e,Tu)}function No(t,e){return Mn(Ho(t,e))}function Fo(t,e){return"function"==typeof e&&gc(t)?c(t,e):Cu(t,Mr(e))}function Bo(t,e){return"function"==typeof e&&gc(t)?h(t,e):Tu(t,Mr(e))}function zo(t,e,n,i){t=ba(t)?t:Ps(t),n=n&&!i?ns(n):0;var r=t.length;return 0>n&&(n=lu(r+n,0)),Xa(t)?r>=n&&t.indexOf(e,n)>-1:!!r&&A(t,e,n)>-1}function Ho(t,e){var n=gc(t)?g:Zn;return n(t,sr(e,3))}function qo(t,e,n,i){return null==t?[]:(gc(e)||(e=null==e?[]:[e]),n=i?$:n,gc(n)||(n=null==n?[]:[n]),ei(t,e,n))}function Go(t,e,n){var i=gc(t)?v:k,r=arguments.length<3;return i(t,sr(e,4),n,r,Cu)}function jo(t,e,n){var i=gc(t)?y:k,r=arguments.length<3;return i(t,sr(e,4),n,r,Tu)}function Uo(t,e){var n=gc(t)?f:Cn;return e=sr(e,3),n(t,function(t,n,i){return!e(t,n,i)})}function Vo(t){var e=ba(t)?t:Ps(t),n=e.length;return n>0?e[ui(0,n-1)]:$}function Wo(t,e){var n=-1,i=es(t),r=i.length,o=r-1;for(e=cn(ns(e),0,r);++n<e;){var a=ui(n,o),s=i[a];i[a]=i[n],i[n]=s}return i.length=e,i}function Xo(t){return Wo(t,kt)}function Ko(t){if(null==t)return 0;if(ba(t)){var e=t.length;return e&&Xa(t)?X(t):e}return bs(t).length}function Yo(t,e,n){var i=gc(t)?b:fi;return n&&mr(t,e,n)&&(e=$),i(t,sr(e,3))}function Zo(t,e){if("function"!=typeof e)throw new Il(yt);return t=ns(t),function(){return--t<1?e.apply(this,arguments):void 0}}function $o(t,e,n){return e=n?$:e,e=t&&null==e?t.length:e,nr(t,at,$,$,$,$,e)}function Jo(t,e){var n;if("function"!=typeof e)throw new Il(yt);return t=ns(t),function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=$),n}}function Qo(t,n,i){n=i?$:n;var r=nr(t,nt,$,$,$,$,$,n);return r.placeholder=e.placeholder||Qo.placeholder,r}function ta(t,n,i){n=i?$:n;var r=nr(t,it,$,$,$,$,$,n);return r.placeholder=e.placeholder||ta.placeholder,r}function ea(t,e,n){function i(){p&&Yl(p),c&&Yl(c),g=0,u=c=f=p=_=$}function r(e,n){n&&Yl(n),c=p=_=$,e&&(g=sc(),h=t.apply(f,u),p||c||(u=f=$))}function o(){var t=e-(sc()-d);0>=t||t>e?r(_,c):p=eu(o,t)}function a(){return(p&&_||c&&y)&&(h=t.apply(f,u)),i(),h}function s(){r(y,p)}function l(){if(u=arguments,d=sc(),f=this,_=y&&(p||!m),v===!1)var n=m&&!p;else{g||c||m||(g=d);var i=v-(d-g),r=0>=i||i>v;r?(c&&(c=Yl(c)),g=d,h=t.apply(f,u)):c||(c=eu(s,i))}return r&&p?p=Yl(p):p||e===v||(p=eu(o,e)),n&&(r=!0,h=t.apply(f,u)),!r||p||c||(u=f=$),h}var u,c,h,d,f,p,_,g=0,m=!1,v=!1,y=!0;if("function"!=typeof t)throw new Il(yt);return e=rs(e)||0,Pa(n)&&(m=!!n.leading,v="maxWait"in n&&lu(rs(n.maxWait)||0,e),y="trailing"in n?!!n.trailing:y),l.cancel=i,l.flush=a,l}function na(t){return nr(t,lt)}function ia(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new Il(yt);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var a=t.apply(this,i);return n.cache=o.set(r,a),a};return n.cache=new ia.Cache,n}function ra(t){if("function"!=typeof t)throw new Il(yt);return function(){return!t.apply(this,arguments)}}function oa(t){return Jo(2,t)}function aa(t,e){if("function"!=typeof t)throw new Il(yt);return e=lu(e===$?t.length-1:ns(e),0),function(){for(var n=arguments,i=-1,r=lu(n.length-e,0),o=Array(r);++i<r;)o[i]=n[e+i];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,n[0],o);case 2:return t.call(this,n[0],n[1],o)}var a=Array(e+1);for(i=-1;++i<e;)a[i]=n[i];return a[e]=o,s(t,this,a)}}function sa(t,e){if("function"!=typeof t)throw new Il(yt);return e=e===$?0:lu(ns(e),0),aa(function(n){var i=n[e],r=n.slice(0,e);return i&&m(r,i),s(t,this,r)})}function la(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new Il(yt);return Pa(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),ea(t,e,{leading:i,maxWait:e,trailing:r})}function ua(t){return $o(t,1)}function ca(t,e){return e=null==e?ul:e,fc(e,t)}function ha(t){return hn(t)}function da(t,e){return hn(t,!1,e)}function fa(t){return hn(t,!0)}function pa(t,e){return hn(t,!0,e)}function _a(t,e){return t===e||t!==t&&e!==e}function ga(t,e){return t>e}function ma(t,e){return t>=e}function va(t){return xa(t)&&zl.call(t,"callee")&&(!tu.call(t,"callee")||Gl.call(t)==Mt)}function ya(t){return Da(t)&&Gl.call(t)==Vt}function ba(t){return null!=t&&!("function"==typeof t&&La(t))&&Oa(Pu(t))}function xa(t){return Da(t)&&ba(t)}function wa(t){return t===!0||t===!1||Da(t)&&Gl.call(t)==Rt}function Sa(t){return Da(t)&&Gl.call(t)==Ot}function Aa(t){return!!t&&1===t.nodeType&&Da(t)&&!ja(t)}function ka(t){if(ba(t)&&(gc(t)||Xa(t)||La(t.splice)||va(t)))return!t.length;for(var e in t)if(zl.call(t,e))return!1;return!0}function Ca(t,e){return Un(t,e)}function Ta(t,e,n){n="function"==typeof n?n:$;var i=n?n(t,e):$;return i===$?Un(t,e,n):!!i}function Ea(t){return Da(t)&&"string"==typeof t.message&&Gl.call(t)==Pt}function Ma(t){return"number"==typeof t&&ou(t)}function La(t){var e=Pa(t)?Gl.call(t):"";return e==Dt||e==It}function Ra(t){return"number"==typeof t&&t==ns(t)}function Oa(t){return"number"==typeof t&&t>-1&&t%1==0&&wt>=t}function Pa(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Da(t){return!!t&&"object"==typeof t}function Ia(t){return Da(t)&&cr(t)==Nt}function Na(t,e){return t===e||Wn(t,e,lr(e))}function Fa(t,e,n){return n="function"==typeof n?n:$,Wn(t,e,lr(e),n)}function Ba(t){return Ga(t)&&t!=+t}function za(t){return null==t?!1:La(t)?Ul.test(Bl.call(t)):Da(t)&&(q(t)?Ul:ke).test(t)}function Ha(t){return null===t}function qa(t){return null==t}function Ga(t){return"number"==typeof t||Da(t)&&Gl.call(t)==Ft}function ja(t){if(!Da(t)||Gl.call(t)!=Bt||q(t))return!1;var e=Fl;if("function"==typeof t.constructor&&(e=$l(t)),null===e)return!0;var n=e.constructor;return"function"==typeof n&&n instanceof n&&Bl.call(n)==ql}function Ua(t){return Pa(t)&&Gl.call(t)==zt}function Va(t){return Ra(t)&&t>=-wt&&wt>=t}function Wa(t){return Da(t)&&cr(t)==Ht}function Xa(t){return"string"==typeof t||!gc(t)&&Da(t)&&Gl.call(t)==qt}function Ka(t){return"symbol"==typeof t||Da(t)&&Gl.call(t)==Gt}function Ya(t){return Da(t)&&Oa(t.length)&&!!bn[Gl.call(t)]}function Za(t){return t===$}function $a(t){return Da(t)&&cr(t)==jt}function Ja(t){return Da(t)&&Gl.call(t)==Ut}function Qa(t,e){return e>t}function ts(t,e){return e>=t}function es(t){if(!t)return[];if(ba(t))return Xa(t)?K(t):Di(t);if(Ql&&t[Ql])return j(t[Ql]());var e=cr(t),n=e==Nt?U:e==Ht?W:Ps;return n(t)}function ns(t){if(!t)return 0===t?t:0;if(t=rs(t),t===xt||t===-xt){var e=0>t?-1:1;return e*St}var n=t%1;return t===t?n?t-n:t:0}function is(t){return t?cn(ns(t),0,kt):0}function rs(t){if(Pa(t)){var e=La(t.valueOf)?t.valueOf():t;t=Pa(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ge,"");var n=Ae.test(t);return n||Ce.test(t)?En(t.slice(2),n?2:8):Se.test(t)?At:+t}function os(t){return Ii(t,xs(t))}function as(t){return cn(ns(t),-wt,wt)}function ss(t){if("string"==typeof t)return t;if(null==t)return"";if(Ka(t))return Xl?Su.call(t):"";var e=t+"";return"0"==e&&1/t==-xt?"-0":e}function ls(t,e){var n=ku(t);return e?ln(n,e):n}function us(t,e){return w(t,sr(e,3),Rn,!0)}function cs(t,e){return w(t,sr(e,3),On,!0)}function hs(t,e){return null==t?t:Eu(t,Mr(e),xs)}function ds(t,e){return null==t?t:Mu(t,Mr(e),xs)}function fs(t,e){return t&&Rn(t,Mr(e))}function ps(t,e){return t&&On(t,Mr(e))}function _s(t){return null==t?[]:Pn(t,bs(t))}function gs(t){return null==t?[]:Pn(t,xs(t))}function ms(t,e,n){var i=null==t?$:In(t,e);return i===$?n:i}function vs(t,e){return dr(t,e,Bn)}function ys(t,e){return dr(t,e,zn)}function bs(t){var e=xr(t);if(!e&&!ba(t))return Kn(t);var n=gr(t),i=!!n,r=n||[],o=r.length;for(var a in t)!Bn(t,a)||i&&("length"==a||G(a,o))||e&&"constructor"==a||r.push(a);return r}function xs(t){for(var e=-1,n=xr(t),i=Yn(t),r=i.length,o=gr(t),a=!!o,s=o||[],l=s.length;++e<r;){var u=i[e];a&&("length"==u||G(u,l))||"constructor"==u&&(n||!zl.call(t,u))||s.push(u)}return s}function ws(t,e){var n={};return e=sr(e,3),Rn(t,function(t,i,r){n[e(t,i,r)]=t}),n}function Ss(t,e){var n={};return e=sr(e,3),Rn(t,function(t,i,r){n[i]=e(t,i,r)}),n}function As(t,e){return e=sr(e,2),ii(t,function(t,n){return!e(t,n)})}function ks(t,e){return null==t?{}:ii(t,sr(e,2))}function Cs(t,e,n){if(vr(e,t))i=null==t?$:t[e];else{e=vi(e);var i=ms(t,e);t=kr(t,e)}return i===$&&(i=n),La(i)?i.call(t):i}function Ts(t,e,n){return null==t?t:hi(t,e,n)}function Es(t,e,n,i){return i="function"==typeof i?i:$,null==t?t:hi(t,e,n,i)}function Ms(t){return M(t,bs(t))}function Ls(t){return M(t,xs(t))}function Rs(t,e,n){var i=gc(t)||Ya(t);if(e=sr(e,4),null==n)if(i||Pa(t)){var r=t.constructor;n=i?gc(t)?new r:[]:ku(La(r)?r.prototype:$)}else n={};return(i?c:Rn)(t,function(t,i,r){return e(n,t,i,r)}),n}function Os(t,e){return null==t?!0:bi(t,e)}function Ps(t){return t?R(t,bs(t)):[]}function Ds(t){return null==t?R(t,xs(t)):[]}function Is(t,e,n){return n===$&&(n=e,e=$),n!==$&&(n=rs(n),n=n===n?n:0),e!==$&&(e=rs(e),e=e===e?e:0),cn(rs(t),e,n)}function Ns(t,e,n){return e=rs(e)||0,n===$?(n=e,e=0):n=rs(n)||0,t=rs(t),Hn(t,e,n)}function Fs(t,e,n){if(n&&"boolean"!=typeof n&&mr(t,e,n)&&(e=n=$),n===$&&("boolean"==typeof e?(n=e,e=$):"boolean"==typeof t&&(n=t,t=$)),t===$&&e===$?(t=0,e=1):(t=rs(t)||0,e===$?(e=t,t=0):e=rs(e)||0),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var r=hu();return uu(t+r*(e-t+Tn("1e-"+((r+"").length-1))),e)}return ui(t,e)}function Bs(t){return Nc(ss(t).toLowerCase())}function zs(t){return t=ss(t),t&&t.replace(Ee,F).replace(dn,"")}function Hs(t,e,n){t=ss(t),e="string"==typeof e?e:e+"";var i=t.length;return n=n===$?i:cn(ns(n),0,i),n-=e.length,n>=0&&t.indexOf(e,n)==n}function qs(t){return t=ss(t),t&&se.test(t)?t.replace(oe,B):t}function Gs(t){return t=ss(t),t&&_e.test(t)?t.replace(pe,"\\$&"):t}function js(t,e,n){t=ss(t),e=ns(e);var i=X(t);if(!e||i>=e)return t;var r=(e-i)/2,o=ru(r),a=iu(r);return $i("",o,n)+t+$i("",a,n)}function Us(t,e,n){return t=ss(t),t+$i(t,e,n)}function Vs(t,e,n){return t=ss(t),$i(t,e,n)+t}function Ws(t,e,n){return n||null==e?e=0:e&&(e=+e),t=ss(t).replace(ge,""),cu(t,e||(we.test(t)?16:10))}function Xs(t,e){t=ss(t),e=ns(e);var n="";if(!t||1>e||e>wt)return n;do e%2&&(n+=t),e=ru(e/2),t+=t;while(e);return n}function Ks(){var t=arguments,e=ss(t[0]);return t.length<3?e:e.replace(t[1],t[2])}function Ys(t,e,n){return ss(t).split(e,n)}function Zs(t,e,n){return t=ss(t),n=cn(ns(n),0,t.length),t.lastIndexOf(e,n)==n}function $s(t,n,i){var r=e.templateSettings;i&&mr(t,n,i)&&(n=$),t=ss(t),n=bc({},n,r,rn);var o,a,s=bc({},n.imports,r.imports,rn),l=bs(s),u=R(s,l),c=0,h=n.interpolate||Me,d="__p += '",f=Dl((n.escape||Me).source+"|"+h.source+"|"+(h===ce?be:Me).source+"|"+(n.evaluate||Me).source+"|$","g"),p="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++yn+"]")+"\n";t.replace(f,function(e,n,i,r,s,l){return i||(i=r),d+=t.slice(c,l).replace(Le,z),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=l+e.length,e}),d+="';\n";var _=n.variable;_||(d="with (obj) {\n"+d+"\n}\n"),d=(a?d.replace(ee,""):d).replace(ne,"$1").replace(ie,"$1;"),d="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Hc(function(){return Function(l,p+"return "+d).apply($,u)});if(g.source=d,Ea(g))throw g;return g}function Js(t){return ss(t).toLowerCase()}function Qs(t){return ss(t).toUpperCase()}function tl(t,e,n){if(t=ss(t),!t)return t;if(n||e===$)return t.replace(ge,"");if(e+="",!e)return t;var i=K(t),r=K(e);return i.slice(O(i,r),P(i,r)+1).join("")}function el(t,e,n){if(t=ss(t),!t)return t;if(n||e===$)return t.replace(ve,"");if(e+="",!e)return t;var i=K(t);return i.slice(0,P(i,K(e))+1).join("")}function nl(t,e,n){if(t=ss(t),!t)return t;if(n||e===$)return t.replace(me,"");if(e+="",!e)return t;var i=K(t);return i.slice(O(i,K(e))).join("")}function il(t,e){var n=ht,i=dt;if(Pa(e)){var r="separator"in e?e.separator:r;n="length"in e?ns(e.length):n,i="omission"in e?ss(e.omission):i}t=ss(t);var o=t.length;if(pn.test(t)){var a=K(t);o=a.length}if(n>=o)return t;var s=n-X(i);if(1>s)return i;var l=a?a.slice(0,s).join(""):t.slice(0,s);if(r===$)return l+i;if(a&&(s+=l.length-s),Ua(r)){if(t.slice(s).search(r)){var u,c=l;for(r.global||(r=Dl(r.source,ss(xe.exec(r))+"g")),r.lastIndex=0;u=r.exec(c);)var h=u.index;l=l.slice(0,h===$?s:h)}}else if(t.indexOf(r,s)!=s){var d=l.lastIndexOf(r);d>-1&&(l=l.slice(0,d))}return l+i}function rl(t){return t=ss(t),t&&ae.test(t)?t.replace(re,Y):t}function ol(t,e,n){return t=ss(t),e=n?$:e,e===$&&(e=mn.test(t)?gn:_n),t.match(e)||[]}function al(t){var e=t?t.length:0,n=sr();return t=e?g(t,function(t){if("function"!=typeof t[1])throw new Il(yt);return[n(t[0]),t[1]]}):[],aa(function(n){for(var i=-1;++i<e;){var r=t[i];if(s(r[0],this,n))return s(r[1],this,n)}})}function sl(t){return fn(hn(t,!0))}function ll(t){return function(){return t}}function ul(t){return t}function cl(t){return Xn("function"==typeof t?t:hn(t,!0))}function hl(t){return $n(hn(t,!0))}function dl(t,e){return Jn(t,hn(e,!0))}function fl(t,e,n){var i=bs(e),r=Pn(e,i);null!=n||Pa(e)&&(r.length||!i.length)||(n=e,e=t,t=this,r=Pn(e,bs(e)));var o=Pa(n)&&"chain"in n?n.chain:!0,a=La(t);return c(r,function(n){var i=e[n];t[n]=i,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),r=n.__actions__=Di(this.__actions__);return r.push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,m([this.value()],arguments))})}),t}function pl(){return Nn._===this&&(Nn._=jl),this}function _l(){}function gl(t){return t=ns(t),function(){return arguments[t]}}function ml(t){return vr(t)?ri(t):oi(t)}function vl(t){return function(e){return null==t?$:In(t,e)}}function yl(t,e){if(t=ns(t),1>t||t>wt)return[];var n=kt,i=uu(t,kt);e=Mr(e),t-=kt;for(var r=E(i,e);++n<t;)e(n);return r}function bl(t){return gc(t)?g(t,String):Tr(t)}function xl(t){var e=++Hl;return ss(t)+e}function wl(t,e){var n;return t===$&&e===$?0:(t!==$&&(n=t),e!==$&&(n=n===$?e:n+e),n)}function Sl(t){return t&&t.length?x(t,ul,ga):$}function Al(t,e){return t&&t.length?x(t,sr(e),ga):$}function kl(t){return Ml(t)/(t?t.length:0)}function Cl(t){return t&&t.length?x(t,ul,Qa):$}function Tl(t,e){return t&&t.length?x(t,sr(e),Qa):$}function El(t,e){var n;return t===$&&e===$?0:(t!==$&&(n=t),e!==$&&(n=n===$?e:n-e),n)}function Ml(t){return t&&t.length?T(t,ul):0}function Ll(t,e){return t&&t.length?T(t,sr(e)):0}t=t?Fn.defaults({},t,Fn.pick(Nn,vn)):Nn;var Rl=t.Date,Ol=t.Error,Pl=t.Math,Dl=t.RegExp,Il=t.TypeError,Nl=t.Array.prototype,Fl=t.Object.prototype,Bl=t.Function.prototype.toString,zl=Fl.hasOwnProperty,Hl=0,ql=Bl.call(Object),Gl=Fl.toString,jl=Nn._,Ul=Dl("^"+Bl.call(zl).replace(pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vl=Dn?t.Buffer:$,Wl=t.Reflect,Xl=t.Symbol,Kl=t.Uint8Array,Yl=t.clearTimeout,Zl=Wl?Wl.enumerate:$,$l=Object.getPrototypeOf,Jl=Object.getOwnPropertySymbols,Ql="symbol"==typeof(Ql=Xl&&Xl.iterator)?Ql:$,tu=Fl.propertyIsEnumerable,eu=t.setTimeout,nu=Nl.splice,iu=Pl.ceil,ru=Pl.floor,ou=t.isFinite,au=Nl.join,su=Object.keys,lu=Pl.max,uu=Pl.min,cu=t.parseInt,hu=Pl.random,du=Nl.reverse,fu=ur(t,"Map"),pu=ur(t,"Set"),_u=ur(t,"WeakMap"),gu=ur(Object,"create"),mu=_u&&new _u,vu=fu?Bl.call(fu):"",yu=pu?Bl.call(pu):"",bu=_u?Bl.call(_u):"",xu=Xl?Xl.prototype:$,wu=Xl?xu.valueOf:$,Su=Xl?xu.toString:$,Au={};e.templateSettings={escape:le,evaluate:ue,interpolate:ce,variable:"",imports:{_:e}};var ku=function(){function t(){}return function(e){if(Pa(e)){t.prototype=e;var n=new t;t.prototype=$}return n||{}}}(),Cu=Hi(Rn),Tu=Hi(On,!0),Eu=qi(),Mu=qi(!0);Zl&&!tu.call({valueOf:1},"valueOf")&&(Yn=function(t){return j(Zl(t))});var Lu=mu?function(t,e){return mu.set(t,e),t}:ul,Ru=pu&&2===new pu([1,2]).size?function(t){return new pu(t)}:_l,Ou=mu?function(t){return mu.get(t)}:_l,Pu=ri("length"),Du=Jl||function(){return[]};(fu&&cr(new fu)!=Nt||pu&&cr(new pu)!=Ht||_u&&cr(new _u)!=jt)&&(cr=function(t){var e=Gl.call(t),n=e==Bt?t.constructor:null,i="function"==typeof n?Bl.call(n):"";if(i)switch(i){case vu:return Nt;case yu:return Ht;case bu:return jt}return e});var Iu=function(){var t=0,e=0;return function(n,i){var r=sc(),o=pt-(r-e);if(e=r,o>0){if(++t>=ft)return n}else t=0;return Lu(n,i)}}(),Nu=aa(function(t,e){return gc(t)||(t=null==t?[]:[Object(t)]),e=Mn(e),u(t,e)}),Fu=aa(function(t,e){return xa(t)?Sn(t,Mn(e,!1,!0)):[]}),Bu=aa(function(t,e){var n=Xr(e);return xa(n)&&(n=$),xa(t)?Sn(t,Mn(e,!1,!0),sr(n)):[]}),zu=aa(function(t,e){var n=Xr(e);return xa(n)&&(n=$),xa(t)?Sn(t,Mn(e,!1,!0),$,n):[];
}),Hu=aa(function(t){var e=g(t,Er);return e.length&&e[0]===t[0]?qn(e):[]}),qu=aa(function(t){var e=Xr(t),n=g(t,Er);return e===Xr(n)?e=$:n.pop(),n.length&&n[0]===t[0]?qn(n,sr(e)):[]}),Gu=aa(function(t){var e=Xr(t),n=g(t,Er);return e===Xr(n)?e=$:n.pop(),n.length&&n[0]===t[0]?qn(n,$,e):[]}),ju=aa(Yr),Uu=aa(function(t,e){e=g(Mn(e),String);var n=un(t,e);return li(t,e.sort(I)),n}),Vu=aa(function(t){return yi(Mn(t,!1,!0))}),Wu=aa(function(t){var e=Xr(t);return xa(e)&&(e=$),yi(Mn(t,!1,!0),sr(e))}),Xu=aa(function(t){var e=Xr(t);return xa(e)&&(e=$),yi(Mn(t,!1,!0),$,e)}),Ku=aa(function(t,e){return xa(t)?Sn(t,e):[]}),Yu=aa(function(t){return Si(f(t,xa))}),Zu=aa(function(t){var e=Xr(t);return xa(e)&&(e=$),Si(f(t,xa),sr(e))}),$u=aa(function(t){var e=Xr(t);return xa(e)&&(e=$),Si(f(t,xa),$,e)}),Ju=aa(mo),Qu=aa(function(t){var e=t.length,n=e>1?t[e-1]:$;return n="function"==typeof n?(t.pop(),n):$,vo(t,n)}),tc=aa(function(t){t=Mn(t);var e=t.length,n=e?t[0]:0,o=this.__wrapped__,a=function(e){return un(e,t)};return!(e>1||this.__actions__.length)&&o instanceof r&&G(n)?(o=o.slice(n,+n+(e?1:0)),o.__actions__.push({func:So,args:[a],thisArg:$}),new i(o,this.__chain__).thru(function(t){return e&&!t.length&&t.push($),t})):this.thru(a)}),ec=Bi(function(t,e,n){zl.call(t,n)?++t[n]:t[n]=1}),nc=Bi(function(t,e,n){zl.call(t,n)?t[n].push(e):t[n]=[e]}),ic=aa(function(t,e,n){var i=-1,r="function"==typeof e,o=vr(e),a=ba(t)?Array(t.length):[];return Cu(t,function(t){var l=r?e:o&&null!=t?t[e]:$;a[++i]=l?s(l,t,n):jn(t,e,n)}),a}),rc=Bi(function(t,e,n){t[n]=e}),oc=Bi(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),ac=aa(function(t,e){if(null==t)return[];var n=e.length;return n>1&&mr(t,e[0],e[1])?e=[]:n>2&&mr(e[0],e[1],e[2])&&(e.length=1),ei(t,Mn(e),[])}),sc=Rl.now,lc=aa(function(t,n,i){var r=Q;if(i.length){var o=e.placeholder||lc.placeholder,a=V(i,o);r|=rt}return nr(t,r,n,i,a)}),uc=aa(function(t,n,i){var r=Q|tt;if(i.length){var o=e.placeholder||uc.placeholder,a=V(i,o);r|=rt}return nr(n,r,t,i,a)}),cc=aa(function(t,e){return wn(t,1,e)}),hc=aa(function(t,e,n){return wn(t,rs(e)||0,n)}),dc=aa(function(t,e){e=g(Mn(e),sr());var n=e.length;return aa(function(i){for(var r=-1,o=uu(i.length,n);++r<o;)i[r]=e[r].call(this,i[r]);return s(t,this,i)})}),fc=aa(function(t,n){var i=e.placeholder||fc.placeholder,r=V(n,i);return nr(t,rt,$,n,r)}),pc=aa(function(t,n){var i=e.placeholder||pc.placeholder,r=V(n,i);return nr(t,ot,$,n,r)}),_c=aa(function(t,e){return nr(t,st,$,$,$,Mn(e))}),gc=Array.isArray,mc=Vl?function(t){return t instanceof Vl}:ll(!1),vc=zi(function(t,e){Ii(e,bs(e),t)}),yc=zi(function(t,e){Ii(e,xs(e),t)}),bc=zi(function(t,e,n,i){Ni(e,xs(e),t,i)}),xc=zi(function(t,e,n,i){Ni(e,bs(e),t,i)}),wc=aa(function(t,e){return un(t,Mn(e))}),Sc=aa(function(t){return t.push($,rn),s(bc,$,t)}),Ac=aa(function(t){return t.push($,Ar),s(Mc,$,t)}),kc=Yi(function(t,e,n){t[e]=n},ll(ul)),Cc=Yi(function(t,e,n){zl.call(t,e)?t[e].push(n):t[e]=[n]},sr),Tc=aa(jn),Ec=zi(function(t,e,n){Qn(t,e,n)}),Mc=zi(function(t,e,n,i){Qn(t,e,n,i)}),Lc=aa(function(t,e){return null==t?{}:(e=g(Mn(e),String),ni(t,Sn(xs(t),e)))}),Rc=aa(function(t,e){return null==t?{}:ni(t,Mn(e))}),Oc=Ui(function(t,e,n){return e=e.toLowerCase(),t+(n?Bs(e):e)}),Pc=Ui(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Dc=Ui(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),Ic=ji("toLowerCase"),Nc=ji("toUpperCase"),Fc=Ui(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Bc=Ui(function(t,e,n){return t+(n?" ":"")+Bs(e)}),zc=Ui(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Hc=aa(function(t,e){try{return s(t,$,e)}catch(n){return Pa(n)?n:new Ol(n)}}),qc=aa(function(t,e){return c(Mn(e),function(e){t[e]=lc(t[e],t)}),t}),Gc=Xi(),jc=Xi(!0),Uc=aa(function(t,e){return function(n){return jn(n,t,e)}}),Vc=aa(function(t,e){return function(n){return jn(t,n,e)}}),Wc=Zi(g),Xc=Zi(d),Kc=Zi(b),Yc=Qi(),Zc=Qi(!0),$c=er("ceil"),Jc=er("floor"),Qc=er("round");return e.prototype=n.prototype,i.prototype=ku(n.prototype),i.prototype.constructor=i,r.prototype=ku(n.prototype),r.prototype.constructor=r,Oe.prototype=gu?gu(null):Fl,Fe.prototype.clear=Be,Fe.prototype["delete"]=ze,Fe.prototype.get=He,Fe.prototype.has=qe,Fe.prototype.set=Ge,je.prototype.push=Ve,We.prototype.clear=Xe,We.prototype["delete"]=Ke,We.prototype.get=Ye,We.prototype.has=Ze,We.prototype.set=$e,ia.Cache=Fe,e.after=Zo,e.ary=$o,e.assign=vc,e.assignIn=yc,e.assignInWith=bc,e.assignWith=xc,e.at=wc,e.before=Jo,e.bind=lc,e.bindAll=qc,e.bindKey=uc,e.chain=xo,e.chunk=Rr,e.compact=Or,e.concat=Nu,e.cond=al,e.conforms=sl,e.constant=ll,e.countBy=ec,e.create=ls,e.curry=Qo,e.curryRight=ta,e.debounce=ea,e.defaults=Sc,e.defaultsDeep=Ac,e.defer=cc,e.delay=hc,e.difference=Fu,e.differenceBy=Bu,e.differenceWith=zu,e.drop=Pr,e.dropRight=Dr,e.dropRightWhile=Ir,e.dropWhile=Nr,e.fill=Fr,e.filter=Po,e.flatMap=No,e.flatten=Hr,e.flattenDeep=qr,e.flip=na,e.flow=Gc,e.flowRight=jc,e.fromPairs=Gr,e.functions=_s,e.functionsIn=gs,e.groupBy=nc,e.initial=Vr,e.intersection=Hu,e.intersectionBy=qu,e.intersectionWith=Gu,e.invert=kc,e.invertBy=Cc,e.invokeMap=ic,e.iteratee=cl,e.keyBy=rc,e.keys=bs,e.keysIn=xs,e.map=Ho,e.mapKeys=ws,e.mapValues=Ss,e.matches=hl,e.matchesProperty=dl,e.memoize=ia,e.merge=Ec,e.mergeWith=Mc,e.method=Uc,e.methodOf=Vc,e.mixin=fl,e.negate=ra,e.nthArg=gl,e.omit=Lc,e.omitBy=As,e.once=oa,e.orderBy=qo,e.over=Wc,e.overArgs=dc,e.overEvery=Xc,e.overSome=Kc,e.partial=fc,e.partialRight=pc,e.partition=oc,e.pick=Rc,e.pickBy=ks,e.property=ml,e.propertyOf=vl,e.pull=ju,e.pullAll=Yr,e.pullAllBy=Zr,e.pullAt=Uu,e.range=Yc,e.rangeRight=Zc,e.rearg=_c,e.reject=Uo,e.remove=$r,e.rest=aa,e.reverse=Jr,e.sampleSize=Wo,e.set=Ts,e.setWith=Es,e.shuffle=Xo,e.slice=Qr,e.sortBy=ac,e.sortedUniq=ao,e.sortedUniqBy=so,e.split=Ys,e.spread=sa,e.tail=lo,e.take=uo,e.takeRight=co,e.takeRightWhile=ho,e.takeWhile=fo,e.tap=wo,e.throttle=la,e.thru=So,e.toArray=es,e.toPairs=Ms,e.toPairsIn=Ls,e.toPath=bl,e.toPlainObject=os,e.transform=Rs,e.unary=ua,e.union=Vu,e.unionBy=Wu,e.unionWith=Xu,e.uniq=po,e.uniqBy=_o,e.uniqWith=go,e.unset=Os,e.unzip=mo,e.unzipWith=vo,e.values=Ps,e.valuesIn=Ds,e.without=Ku,e.words=ol,e.wrap=ca,e.xor=Yu,e.xorBy=Zu,e.xorWith=$u,e.zip=Ju,e.zipObject=yo,e.zipObjectDeep=bo,e.zipWith=Qu,e.extend=yc,e.extendWith=bc,fl(e,e),e.add=wl,e.attempt=Hc,e.camelCase=Oc,e.capitalize=Bs,e.ceil=$c,e.clamp=Is,e.clone=ha,e.cloneDeep=fa,e.cloneDeepWith=pa,e.cloneWith=da,e.deburr=zs,e.endsWith=Hs,e.eq=_a,e.escape=qs,e.escapeRegExp=Gs,e.every=Oo,e.find=Do,e.findIndex=Br,e.findKey=us,e.findLast=Io,e.findLastIndex=zr,e.findLastKey=cs,e.floor=Jc,e.forEach=Fo,e.forEachRight=Bo,e.forIn=hs,e.forInRight=ds,e.forOwn=fs,e.forOwnRight=ps,e.get=ms,e.gt=ga,e.gte=ma,e.has=vs,e.hasIn=ys,e.head=jr,e.identity=ul,e.includes=zo,e.indexOf=Ur,e.inRange=Ns,e.invoke=Tc,e.isArguments=va,e.isArray=gc,e.isArrayBuffer=ya,e.isArrayLike=ba,e.isArrayLikeObject=xa,e.isBoolean=wa,e.isBuffer=mc,e.isDate=Sa,e.isElement=Aa,e.isEmpty=ka,e.isEqual=Ca,e.isEqualWith=Ta,e.isError=Ea,e.isFinite=Ma,e.isFunction=La,e.isInteger=Ra,e.isLength=Oa,e.isMap=Ia,e.isMatch=Na,e.isMatchWith=Fa,e.isNaN=Ba,e.isNative=za,e.isNil=qa,e.isNull=Ha,e.isNumber=Ga,e.isObject=Pa,e.isObjectLike=Da,e.isPlainObject=ja,e.isRegExp=Ua,e.isSafeInteger=Va,e.isSet=Wa,e.isString=Xa,e.isSymbol=Ka,e.isTypedArray=Ya,e.isUndefined=Za,e.isWeakMap=$a,e.isWeakSet=Ja,e.join=Wr,e.kebabCase=Pc,e.last=Xr,e.lastIndexOf=Kr,e.lowerCase=Dc,e.lowerFirst=Ic,e.lt=Qa,e.lte=ts,e.max=Sl,e.maxBy=Al,e.mean=kl,e.min=Cl,e.minBy=Tl,e.noConflict=pl,e.noop=_l,e.now=sc,e.pad=js,e.padEnd=Us,e.padStart=Vs,e.parseInt=Ws,e.random=Fs,e.reduce=Go,e.reduceRight=jo,e.repeat=Xs,e.replace=Ks,e.result=Cs,e.round=Qc,e.runInContext=Z,e.sample=Vo,e.size=Ko,e.snakeCase=Fc,e.some=Yo,e.sortedIndex=to,e.sortedIndexBy=eo,e.sortedIndexOf=no,e.sortedLastIndex=io,e.sortedLastIndexBy=ro,e.sortedLastIndexOf=oo,e.startCase=Bc,e.startsWith=Zs,e.subtract=El,e.sum=Ml,e.sumBy=Ll,e.template=$s,e.times=yl,e.toInteger=ns,e.toLength=is,e.toLower=Js,e.toNumber=rs,e.toSafeInteger=as,e.toString=ss,e.toUpper=Qs,e.trim=tl,e.trimEnd=el,e.trimStart=nl,e.truncate=il,e.unescape=rl,e.uniqueId=xl,e.upperCase=zc,e.upperFirst=Nc,e.each=Fo,e.eachRight=Bo,e.first=jr,fl(e,function(){var t={};return Rn(e,function(n,i){zl.call(e.prototype,i)||(t[i]=n)}),t}(),{chain:!1}),e.VERSION=J,c(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){e[t].placeholder=e}),c(["drop","take"],function(t,e){r.prototype[t]=function(n){var i=this.__filtered__;if(i&&!e)return new r(this);n=n===$?1:lu(ns(n),0);var o=this.clone();return i?o.__takeCount__=uu(n,o.__takeCount__):o.__views__.push({size:uu(n,kt),type:t+(o.__dir__<0?"Right":"")}),o},r.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),c(["filter","map","takeWhile"],function(t,e){var n=e+1,i=n==gt||n==vt;r.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:sr(t,3),type:n}),e.__filtered__=e.__filtered__||i,e}}),c(["head","last"],function(t,e){var n="take"+(e?"Right":"");r.prototype[t]=function(){return this[n](1).value()[0]}}),c(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");r.prototype[t]=function(){return this.__filtered__?new r(this):this[n](1)}}),r.prototype.compact=function(){return this.filter(ul)},r.prototype.find=function(t){return this.filter(t).head()},r.prototype.findLast=function(t){return this.reverse().find(t)},r.prototype.invokeMap=aa(function(t,e){return"function"==typeof t?new r(this):this.map(function(n){return jn(n,t,e)})}),r.prototype.reject=function(t){return t=sr(t,3),this.filter(function(e){return!t(e)})},r.prototype.slice=function(t,e){t=ns(t);var n=this;return n.__filtered__&&(t>0||0>e)?new r(n):(0>t?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==$&&(e=ns(e),n=0>e?n.dropRight(-e):n.take(e-t)),n)},r.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},r.prototype.toArray=function(){return this.take(kt)},Rn(r.prototype,function(t,n){var o=/^(?:filter|find|map|reject)|While$/.test(n),a=/^(?:head|last)$/.test(n),s=e[a?"take"+("last"==n?"Right":""):n],l=a||/^find/.test(n);s&&(e.prototype[n]=function(){var n=this.__wrapped__,u=a?[1]:arguments,c=n instanceof r,h=u[0],d=c||gc(n),f=function(t){var n=s.apply(e,m([t],u));return a&&p?n[0]:n};d&&o&&"function"==typeof h&&1!=h.length&&(c=d=!1);var p=this.__chain__,_=!!this.__actions__.length,g=l&&!p,v=c&&!_;if(!l&&d){n=v?n:new r(this);var y=t.apply(n,u);return y.__actions__.push({func:So,args:[f],thisArg:$}),new i(y,p)}return g&&v?t.apply(this,u):(y=this.thru(f),g?a?y.value()[0]:y.value():y)})}),c(["pop","push","shift","sort","splice","unshift"],function(t){var n=Nl[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);e.prototype[t]=function(){var t=arguments;return r&&!this.__chain__?n.apply(this.value(),t):this[i](function(e){return n.apply(e,t)})}}),Rn(r.prototype,function(t,n){var i=e[n];if(i){var r=i.name+"",o=Au[r]||(Au[r]=[]);o.push({name:n,func:i})}}),Au[Ki($,tt).name]=[{name:"wrapper",func:$}],r.prototype.clone=D,r.prototype.reverse=Te,r.prototype.value=Re,e.prototype.at=tc,e.prototype.chain=Ao,e.prototype.commit=ko,e.prototype.flatMap=Co,e.prototype.next=To,e.prototype.plant=Mo,e.prototype.reverse=Lo,e.prototype.toJSON=e.prototype.valueOf=e.prototype.value=Ro,Ql&&(e.prototype[Ql]=Eo),e}var $,J="4.3.0",Q=1,tt=2,et=4,nt=8,it=16,rt=32,ot=64,at=128,st=256,lt=512,ut=1,ct=2,ht=30,dt="...",ft=150,pt=16,_t=200,gt=1,mt=2,vt=3,yt="Expected a function",bt="__lodash_hash_undefined__",xt=1/0,wt=9007199254740991,St=1.7976931348623157e308,At=NaN,kt=4294967295,Ct=kt-1,Tt=kt>>>1,Et="__lodash_placeholder__",Mt="[object Arguments]",Lt="[object Array]",Rt="[object Boolean]",Ot="[object Date]",Pt="[object Error]",Dt="[object Function]",It="[object GeneratorFunction]",Nt="[object Map]",Ft="[object Number]",Bt="[object Object]",zt="[object RegExp]",Ht="[object Set]",qt="[object String]",Gt="[object Symbol]",jt="[object WeakMap]",Ut="[object WeakSet]",Vt="[object ArrayBuffer]",Wt="[object Float32Array]",Xt="[object Float64Array]",Kt="[object Int8Array]",Yt="[object Int16Array]",Zt="[object Int32Array]",$t="[object Uint8Array]",Jt="[object Uint8ClampedArray]",Qt="[object Uint16Array]",te="[object Uint32Array]",ee=/\b__p \+= '';/g,ne=/\b(__p \+=) '' \+/g,ie=/(__e\(.*?\)|\b__t\)) \+\n'';/g,re=/&(?:amp|lt|gt|quot|#39|#96);/g,oe=/[&<>"'`]/g,ae=RegExp(re.source),se=RegExp(oe.source),le=/<%-([\s\S]+?)%>/g,ue=/<%([\s\S]+?)%>/g,ce=/<%=([\s\S]+?)%>/g,he=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,de=/^\w*$/,fe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,pe=/[\\^$.*+?()[\]{}|]/g,_e=RegExp(pe.source),ge=/^\s+|\s+$/g,me=/^\s+/,ve=/\s+$/,ye=/\\(\\)?/g,be=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xe=/\w*$/,we=/^0x/i,Se=/^[-+]0x[0-9a-f]+$/i,Ae=/^0b[01]+$/i,ke=/^\[object .+?Constructor\]$/,Ce=/^0o[0-7]+$/i,Te=/^(?:0|[1-9]\d*)$/,Ee=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Me=/($^)/,Le=/['\n\r\u2028\u2029\\]/g,Re="\\ud800-\\udfff",Oe="\\u0300-\\u036f\\ufe20-\\ufe23",Pe="\\u20d0-\\u20f0",De="\\u2700-\\u27bf",Ie="a-z\\xdf-\\xf6\\xf8-\\xff",Ne="\\xac\\xb1\\xd7\\xf7",Fe="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Be="\\u2018\\u2019\\u201c\\u201d",ze=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",He="A-Z\\xc0-\\xd6\\xd8-\\xde",qe="\\ufe0e\\ufe0f",Ge=Ne+Fe+Be+ze,je="["+Re+"]",Ue="["+Ge+"]",Ve="["+Oe+Pe+"]",We="\\d+",Xe="["+De+"]",Ke="["+Ie+"]",Ye="[^"+Re+Ge+We+De+Ie+He+"]",Ze="\\ud83c[\\udffb-\\udfff]",$e="(?:"+Ve+"|"+Ze+")",Je="[^"+Re+"]",Qe="(?:\\ud83c[\\udde6-\\uddff]){2}",tn="[\\ud800-\\udbff][\\udc00-\\udfff]",en="["+He+"]",nn="\\u200d",rn="(?:"+Ke+"|"+Ye+")",on="(?:"+en+"|"+Ye+")",an=$e+"?",sn="["+qe+"]?",ln="(?:"+nn+"(?:"+[Je,Qe,tn].join("|")+")"+sn+an+")*",un=sn+an+ln,cn="(?:"+[Xe,Qe,tn].join("|")+")"+un,hn="(?:"+[Je+Ve+"?",Ve,Qe,tn,je].join("|")+")",dn=RegExp(Ve,"g"),fn=RegExp(Ze+"(?="+Ze+")|"+hn+un,"g"),pn=RegExp("["+nn+Re+Oe+Pe+qe+"]"),_n=/[a-zA-Z0-9]+/g,gn=RegExp([en+"?"+Ke+"+(?="+[Ue,en,"$"].join("|")+")",on+"+(?="+[Ue,en+rn,"$"].join("|")+")",en+"?"+rn+"+",en+"+",We,cn].join("|"),"g"),mn=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,vn=["Array","Buffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yn=-1,bn={};bn[Wt]=bn[Xt]=bn[Kt]=bn[Yt]=bn[Zt]=bn[$t]=bn[Jt]=bn[Qt]=bn[te]=!0,bn[Mt]=bn[Lt]=bn[Vt]=bn[Rt]=bn[Ot]=bn[Pt]=bn[Dt]=bn[Nt]=bn[Ft]=bn[Bt]=bn[zt]=bn[Ht]=bn[qt]=bn[jt]=!1;var xn={};xn[Mt]=xn[Lt]=xn[Vt]=xn[Rt]=xn[Ot]=xn[Wt]=xn[Xt]=xn[Kt]=xn[Yt]=xn[Zt]=xn[Nt]=xn[Ft]=xn[Bt]=xn[zt]=xn[Ht]=xn[qt]=xn[Gt]=xn[$t]=xn[Jt]=xn[Qt]=xn[te]=!0,xn[Pt]=xn[Dt]=xn[jt]=!1;var wn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Sn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},An={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},kn={"function":!0,object:!0},Cn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Tn=parseFloat,En=parseInt,Mn=kn[typeof e]&&e&&!e.nodeType?e:null,Ln=kn[typeof t]&&t&&!t.nodeType?t:null,Rn=D(Mn&&Ln&&"object"==typeof r&&r),On=D(kn[typeof self]&&self),Pn=D(kn[typeof window]&&window),Dn=Ln&&Ln.exports===Mn?Mn:null,In=D(kn[typeof this]&&this),Nn=Rn||Pn!==(In&&In.window)&&Pn||On||In||Function("return this")(),Fn=Z();(Pn||On||{})._=Fn,i=function(){return Fn}.call(e,n,e,t),!(i!==$&&(t.exports=i))}).call(this)}).call(e,n(220)(t),function(){return this}())},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(){}e.__esModule=!0,e.compose=e.applyMiddleware=e.bindActionCreators=e.combineReducers=e.createStore=void 0;var o=n(235),a=i(o),s=n(239),l=i(s),u=n(241),c=i(u),h=n(242),d=i(h),f=n(243),p=i(f),_=n(240),g=i(_);"string"==typeof r.name&&"isCrushed"!==r.name&&(0,g["default"])("You are currently using minified code outside of NODE_ENV === 'production'. This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) to ensure you have the correct code for your production build."),e.createStore=a["default"],e.combineReducers=l["default"],e.bindActionCreators=c["default"],e.applyMiddleware=d["default"],e.compose=p["default"]},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e,n){function i(){p===f&&(p=f.slice())}function o(){return d}function l(t){if("function"!=typeof t)throw new Error("Expected listener to be a function.");var e=!0;return i(),p.push(t),function(){if(e){e=!1,i();var n=p.indexOf(t);p.splice(n,1)}}}function u(t){if(!(0,a["default"])(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"==typeof t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(_)throw new Error("Reducers may not dispatch actions.");try{_=!0,d=h(d,t)}finally{_=!1}for(var e=f=p,n=0;n<e.length;n++)e[n]();return t}function c(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");h=t,u({type:s.INIT})}if("function"==typeof e&&"undefined"==typeof n&&(n=e,e=void 0),"undefined"!=typeof n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(r)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var h=t,d=e,f=[],p=f,_=!1;return u({type:s.INIT}),{dispatch:u,subscribe:l,getState:o,replaceReducer:c}}e.__esModule=!0,e.ActionTypes=void 0,e["default"]=r;var o=n(236),a=i(o),s=e.ActionTypes={INIT:"@@redux/INIT"}},function(t,e,n){function i(t){if(!o(t)||c.call(t)!=a||r(t))return!1;var e=s;if("function"==typeof t.constructor&&(e=h(t)),null===e)return!0;var n=e.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==u}var r=n(237),o=n(238),a="[object Object]",s=Object.prototype,l=Function.prototype.toString,u=l.call(Object),c=s.toString,h=Object.getPrototypeOf;t.exports=i},function(t,e){function n(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(n){}return e}t.exports=n},function(t,e){function n(t){return!!t&&"object"==typeof t}t.exports=n},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){var n=e&&e.type,i=n&&'"'+n.toString()+'"'||"an action";return'Reducer "'+t+'" returned undefined handling '+i+". To ignore an action, you must explicitly return the previous state."}function o(t,e,n){var i=Object.keys(e),r=n&&n.type===l.ActionTypes.INIT?"initialState argument passed to createStore":"previous state received by the reducer";if(0===i.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!(0,c["default"])(t))return"The "+r+' has unexpected type of "'+{}.toString.call(t).match(/\s([a-z|A-Z]+)/)[1]+'". Expected argument to be an object with the following '+('keys: "'+i.join('", "')+'"');var o=Object.keys(t).filter(function(t){return!e.hasOwnProperty(t)});return o.length>0?"Unexpected "+(o.length>1?"keys":"key")+" "+('"'+o.join('", "')+'" found in '+r+". ")+"Expected to find one of the known reducer keys instead: "+('"'+i.join('", "')+'". Unexpected keys will be ignored.'):void 0}function a(t){Object.keys(t).forEach(function(e){var n=t[e],i=n(void 0,{type:l.ActionTypes.INIT});if("undefined"==typeof i)throw new Error('Reducer "'+e+'" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined.');var r="@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".");if("undefined"==typeof n(void 0,{type:r}))throw new Error('Reducer "'+e+'" returned undefined when probed with a random type. '+("Don't try to handle "+l.ActionTypes.INIT+' or other actions in "redux/*" ')+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined.")})}function s(t){for(var e=Object.keys(t),n={},i=0;i<e.length;i++){var s=e[i];"function"==typeof t[s]&&(n[s]=t[s])}var l,u=Object.keys(n);try{a(n)}catch(c){l=c}return function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=arguments[1];if(l)throw l;var i=o(t,n,e);i&&(0,d["default"])(i);for(var a=!1,s={},c=0;c<u.length;c++){var h=u[c],f=n[h],p=t[h],_=f(p,e);if("undefined"==typeof _){var g=r(h,e);throw new Error(g)}s[h]=_,a=a||_!==p}return a?s:t}}e.__esModule=!0,e["default"]=s;var l=n(235),u=n(236),c=i(u),h=n(240),d=i(h)},function(t,e){"use strict";function n(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t);try{throw new Error(t)}catch(e){}}e.__esModule=!0,e["default"]=n},function(t,e){"use strict";function n(t,e){return function(){return e(t.apply(void 0,arguments))}}function i(t,e){if("function"==typeof t)return n(t,e);if("object"!=typeof t||null===t)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===t?"null":typeof t)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var i=Object.keys(t),r={},o=0;o<i.length;o++){var a=i[o],s=t[a];"function"==typeof s&&(r[a]=n(s,e))}return r}e.__esModule=!0,e["default"]=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return function(t){return function(n,i,r){var a=t(n,i,r),l=a.dispatch,u=[],c={getState:a.getState,dispatch:function(t){return l(t)}};return u=e.map(function(t){return t(c)}),l=s["default"].apply(void 0,u)(a.dispatch),o({},a,{dispatch:l})}}}var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};e.__esModule=!0,e["default"]=r;var a=n(243),s=i(a)},function(t,e){"use strict";function n(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return function(){if(0===e.length)return arguments.length<=0?void 0:arguments[0];var t=e[e.length-1],n=e.slice(0,-1);return n.reduceRight(function(t,e){return e(t)},t.apply(void 0,arguments))}}e.__esModule=!0,e["default"]=n},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e,n){var i=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],r=u["default"].select(t),o=r.select("#"+n);return o.empty()?r.append(e).attr("id",n).call(function(t){for(var e in i)t.attr(e,i[e])}).node():o.node()}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=e.App=void 0;var s,l=n(231),u=r(l),c=n(232),h=n(245),d=n(310),f=i(d),p=n(317),_=r(p),g="@INC",m="@DEC",v=e.App=(0,c.createView)({name:"App",model:{pages:[h.Title,h.Cell,h.Pathway,h.Protein,h.Genome,h.Questions],navButtons:_["default"]},init:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=(0,c.addressAction)(g,(0,c.addressRelFrom)(["navButtons"])),n=(0,c.addressAction)(m,(0,c.addressRelFrom)(["navButtons"]));return{pages:[h.Title,h.Cell,h.Pathway,h.Protein,h.Genome,h.Questions].map(function(e,n){return e.init(n,t)}),navButtons:_["default"].init(e,n,t),currentIndex:t,lastCurrentIndex:null}},actionCreators:Object.assign((0,c.createAsyncActionCreators)((s={},o(s,g,function(){return function(t,e){var n=Math.min(e.currentIndex+1,e.pages.length-1);t[f.CHANGE](n)}}),o(s,m,function(){return function(t,e){var n=Math.max(e.currentIndex-1,0);t[f.CHANGE](n)}}),s)),f.actionCreators),getReducer:f.getReducer,create:function(t,e,n){u["default"].select(n).attr("id","app")},update:function(t,e,n){return{pages:[a(n,"div","title",{"class":"page"}),a(n,"div","cell",{"class":"page"}),a(n,"div","pathway",{"class":"page"}),a(n,"div","protein",{"class":"page"}),a(n,"div","genome",{"class":"page"}),a(n,"div","questions",{"class":"page"})],navButtons:a(n,"div","nav-buttons")}},getAPI:function(t){return{change:t[f.CHANGE],goIn:t[g],goOut:t[m]}}});e["default"]=v},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Questions=e.Genome=e.Protein=e.Pathway=e.Cell=e.Title=void 0;var o=n(231),a=r(o),s=n(192),l=i(s),u=n(246),c=i(u),h=n(247),d=n(232),f=n(310),p=i(f);n(311);var _=n(315),g=r(_),m=n(316),v=r(m);e.Title=(0,d.createView)({name:"Title",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(t,e,n){var i=a["default"].select(n);i.append("img").attr("src","logo.svg").attr("class","title-img"),i.append("img").attr("src","start-here.svg").attr("class","start-img")},update:p.update}),e.Cell=(0,d.createView)({name:"Cell",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(t,e,n){var i=a["default"].select(n);i.append("img").attr("src","cell.svg").attr("class","cell-img"),i.append("div").attr("class","overlay bottom left").text("This demo provides a glimpse of the multi-scale visualizations that will be possible with Escher Cell.")},update:p.update}),e.Pathway=(0,d.createView)({name:"Pathway",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(t,e,n){var i=a["default"].select(n),r=i.append("div").attr("class","escher-container");l.Builder(g["default"],null,null,r,{reaction_data:v["default"],reaction_styles:["abs","color","size","text"],menu:"zoom",never_ask_before_quit:!0,fill_screen:!0,enable_keys:!1,zoom_to_element:{type:"reaction",id:"1576769"}}),i.append("div").attr("class","overlay bottom right").text("Visualize omics data on biochemical pathways. Try panning and zooming to see more of central metabolism.")},update:p.update}),e.Protein=(0,d.createView)({name:"Protein",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(t,e,n,i){var r=a["default"].select(n);if(!c.isWebGLSupported()){var o=r.append("div").attr("class","webgl-message");return o.append("h3").text("Cannot display the interactive protein viewer"),o.append("p").text("WebGL not supported by this browser. ").append("a").attr("href","https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API").attr("target","_blank").text("Learn more about WebGL"),void o.append("img").attr("class","protein-screen").attr("src","protein_screen.png")}r.style("display","block");var s={width:"auto",height:"auto",antialias:!0,quality:"high",fog:!1},l=c.Viewer(n,s);c.io.fetchPdb("http://www.rcsb.org/pdb/files/4WNC.pdb",function(t){if(!t)throw Error("Could not load structure");l.cartoon("protein",t,{color:c.color.ssSuccession()});l.setCenter(t.center()),l.setRotation([.17,.14,.97,.09,.98,-.16,-.97,.12,.15]),l.autoZoom()}),r.append("div").attr("class","overlay bottom left").text("Stepping into the visualization reveals interactive protein structures. Try rotating the structure for the glyceraldehye-3-phosphate dehydrogenase enzyme.")},update:p.update}),e.Genome=(0,d.createView)({name:"Genome",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(t,e,n,i){var r=a["default"].select(n);r.style("display","block"),r.append("div").attr("id","svgHolder").attr("class","genome-center"),new h.Browser({chr:"chr",viewStart:1859699,viewEnd:1863062,noPersist:!0,disablePoweredBy:!0,noTitle:!0,coordSystem:{speciesName:"Escherichia coli",ucscName:"eschColi_K12"},browserLinks:{Ensembl:"http://www.ensembl.org/Escherichia_coli/Location/View?r=${chr}:${start}-${end}"},sources:[{name:"Genome",uri:"http://microbes.ucsc.edu/cgi-bin/das/eschColi_K12/",tier_type:"sequence",provides_entrypoints:!0},{name:"Genes",desc:"Genes",uri:"http://microbes.ucsc.edu/cgi-bin/das/eschColi_K12/",stylesheet_uri:"gencode.xml",tier_type:"refSeq",collapseSuperGroups:!0,provides_karyotype:!0}]}),r.append("div").attr("class","overlay bottom right").text("Stepping down another level reveals the gene in the context of the genome. A fully featured genome browser will be available for visualizing omics data. Try zooming out to see nearby genes.")},update:p.update}),e.Questions=(0,d.createView)({name:"Questions",init:p.init,actionCreators:p.actionCreators,getReducer:p.getReducer,create:function(t,e,n){var i=a["default"].select(n);i.append("img").attr("src","logo.svg").attr("class","title-questions-img");var r=i.append("div").attr("class","overlay top center");r.append("span").text("Right now, Escher Cell is just a demo. When we get started, you will be able to follow our progress on "),r.append("a").attr("href","https://github.com/escher/escher-cell").text("GitHub"),r.append("span").text(". If you have questions, you can contact Zachary King at zaking [at] ucsd [dot] edu. Source code for this demo is available "),r.append("a").attr("href","https://github.com/zakandrewking/osp").text("here"),r.append("span").text(".")},update:p.update})},function(t,e,n){var i,r,o;!function(n,a){r=[],i=a,o="function"==typeof i?i.apply(e,r):i,!(void 0!==o&&(t.exports=o))}(this,function(){var t,e,n,i,r,o,a,s,l,u,c,h,d,f,p,_,g,m,v,y,b,x,w,S,A,k,C,T,E,M,L,R,O,P,D,I,N,F,B,z,H,q,G,j,U,V,W;return t=function(){var t={};if(!e)var e=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;if(!i)var i=Math.random;var r={};r.setMatrixArrayType=function(t){n=t},t.glMatrix=r;var o={};o.create=function(){var t=new n(3);return t[0]=0,t[1]=0,t[2]=0,t},o.clone=function(t){var e=new n(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},o.fromValues=function(t,e,i){var r=new n(3);return r[0]=t,r[1]=e,r[2]=i,r},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.set=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},o.sub=o.subtract,o.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},o.mul=o.multiply,o.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},o.div=o.divide,o.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},o.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},o.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},o.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},o.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+i*i+r*r)},o.dist=o.distance,o.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)},o.len=o.length,o.squaredLength=function(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i;
},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.normalize=function(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},o.cross=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],l=n[2];return t[0]=r*l-o*s,t[1]=o*a-i*l,t[2]=i*s-r*a,t},o.lerp=function(t,e,n,i){var r=e[0],o=e[1],a=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t},o.random=function(t,e){e=e||1;var n=2*i()*Math.PI,r=2*i()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t},o.transformMat4=function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12],t[1]=n[1]*i+n[5]*r+n[9]*o+n[13],t[2]=n[2]*i+n[6]*r+n[10]*o+n[14],t},o.transformMat3=function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t},o.transformQuat=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],l=n[2],u=n[3],c=u*i+s*o-l*r,h=u*r+l*i-a*o,d=u*o+a*r-s*i,f=-a*i-s*r-l*o;return t[0]=c*u+f*-a+h*-l-d*-s,t[1]=h*u+f*-s+d*-a-c*-l,t[2]=d*u+f*-l+c*-s-h*-a,t},o.forEach=function(){var t=o.create();return function(e,n,i,r,o,a){var s,l;for(n||(n=3),i||(i=0),l=r?Math.min(r*n+i,e.length):e.length,s=i;l>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),o.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},t.vec3=o;var a={};a.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},a.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.fromValues=function(t,e,i,r){var o=new n(4);return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.set=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},a.div=a.divide,a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},a.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},a.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+i*i+r*r+o*o)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return n*n+i*i+r*r+o*o},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.sqrt(e*e+n*n+i*i+r*r)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.normalize=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*n+i*i+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},a.lerp=function(t,e,n,i){var r=e[0],o=e[1],a=e[2],s=e[3];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t[3]=s+i*(n[3]-s),t},a.random=function(t,e){return e=e||1,t[0]=i(),t[1]=i(),t[2]=i(),t[3]=i(),a.normalize(t,t),a.scale(t,t,e),t},a.transformMat4=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t},a.transformQuat=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],l=n[2],u=n[3],c=u*i+s*o-l*r,h=u*r+l*i-a*o,d=u*o+a*r-s*i,f=-a*i-s*r-l*o;return t[0]=c*u+f*-a+h*-l-d*-s,t[1]=h*u+f*-s+d*-a-c*-l,t[2]=d*u+f*-l+c*-s-h*-a,t},a.forEach=function(){var t=a.create();return function(e,n,i,r,o,a){var s,l;for(n||(n=4),i||(i=0),l=r?Math.min(r*n+i,e.length):e.length,s=i;l>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),a.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.vec4=a;var s={};s.create=function(){var t=new n(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},s.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},s.clone=function(t){var e=new n(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},s.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},s.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},s.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},s.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=c*a-s*u,d=-c*o+s*l,f=u*o-a*l,p=n*h+i*d+r*f;return p?(p=1/p,t[0]=h*p,t[1]=(-c*i+r*u)*p,t[2]=(s*i-r*a)*p,t[3]=d*p,t[4]=(c*n-r*l)*p,t[5]=(-s*n+r*o)*p,t[6]=f*p,t[7]=(-u*n+i*l)*p,t[8]=(a*n-i*o)*p,t):null},s.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return t[0]=a*c-s*u,t[1]=r*u-i*c,t[2]=i*s-r*a,t[3]=s*l-o*c,t[4]=n*c-r*l,t[5]=r*o-n*s,t[6]=o*u-a*l,t[7]=i*l-n*u,t[8]=n*a-i*o,t},s.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=t[8];return e*(u*o-a*l)+n*(-u*r+a*s)+i*(l*r-o*s)},s.multiply=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=n[0],f=n[1],p=n[2],_=n[3],g=n[4],m=n[5],v=n[6],y=n[7],b=n[8];return t[0]=d*i+f*a+p*u,t[1]=d*r+f*s+p*c,t[2]=d*o+f*l+p*h,t[3]=_*i+g*a+m*u,t[4]=_*r+g*s+m*c,t[5]=_*o+g*l+m*h,t[6]=v*i+y*a+b*u,t[7]=v*r+y*s+b*c,t[8]=v*o+y*l+b*h,t},s.mul=s.multiply,s.translate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=n[0],f=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=d*i+f*a+u,t[7]=d*r+f*s+c,t[8]=d*o+f*l+h,t},s.rotate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(n),f=Math.cos(n);return t[0]=f*i+d*a,t[1]=f*r+d*s,t[2]=f*o+d*l,t[3]=f*a-d*i,t[4]=f*s-d*r,t[5]=f*l-d*o,t[6]=u,t[7]=c,t[8]=h,t},s.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n+n,s=i+i,l=r+r,u=n*a,c=n*s,h=n*l,d=i*s,f=i*l,p=r*l,_=o*a,g=o*s,m=o*l;return t[0]=1-(d+p),t[3]=c+m,t[6]=h-g,t[1]=c-m,t[4]=1-(u+p),t[7]=f+_,t[2]=h+g,t[5]=f-_,t[8]=1-(u+d),t},s.normalFromMat4=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],_=e[13],g=e[14],m=e[15],v=n*s-i*a,y=n*l-r*a,b=n*u-o*a,x=i*l-r*s,w=i*u-o*s,S=r*u-o*l,A=c*_-h*p,k=c*g-d*p,C=c*m-f*p,T=h*g-d*_,E=h*m-f*_,M=d*m-f*g,L=v*M-y*E+b*T+x*C-w*k+S*A;return L?(L=1/L,t[0]=(s*M-l*E+u*T)*L,t[1]=(l*C-a*M-u*k)*L,t[2]=(a*E-s*C+u*A)*L,t[3]=(r*E-i*M-o*T)*L,t[4]=(n*M-r*C+o*k)*L,t[5]=(i*C-n*E-o*A)*L,t[6]=(_*S-g*w+m*x)*L,t[7]=(g*b-p*S-m*y)*L,t[8]=(p*w-_*b+m*v)*L,t):null},s.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},t.mat3=s;var l={};l.create=function(){var t=new n(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},l.fromValues=function(t,e,i,r,o,a,s,l,u,c,h,d,f,p,_,g){var m=new n(16);return m[0]=t,m[1]=e,m[2]=i,m[3]=r,m[4]=o,m[5]=a,m[6]=s,m[7]=l,m[8]=u,m[9]=c,m[10]=h,m[11]=d,m[12]=f,m[13]=p,m[14]=_,m[15]=g,m},l.clone=function(t){var e=new n(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},l.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},l.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],_=e[13],g=e[14],m=e[15],v=n*s-i*a,y=n*l-r*a,b=n*u-o*a,x=i*l-r*s,w=i*u-o*s,S=r*u-o*l,A=c*_-h*p,k=c*g-d*p,C=c*m-f*p,T=h*g-d*_,E=h*m-f*_,M=d*m-f*g,L=v*M-y*E+b*T+x*C-w*k+S*A;return L?(L=1/L,t[0]=(s*M-l*E+u*T)*L,t[1]=(r*E-i*M-o*T)*L,t[2]=(_*S-g*w+m*x)*L,t[3]=(d*w-h*S-f*x)*L,t[4]=(l*C-a*M-u*k)*L,t[5]=(n*M-r*C+o*k)*L,t[6]=(g*b-p*S-m*y)*L,t[7]=(c*S-d*b+f*y)*L,t[8]=(a*E-s*C+u*A)*L,t[9]=(i*C-n*E-o*A)*L,t[10]=(p*w-_*b+m*v)*L,t[11]=(h*b-c*w-f*v)*L,t[12]=(s*k-a*T-l*A)*L,t[13]=(n*T-i*k+r*A)*L,t[14]=(_*y-p*x-g*v)*L,t[15]=(c*x-h*y+d*v)*L,t):null},l.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],_=e[13],g=e[14],m=e[15];return t[0]=s*(d*m-f*g)-h*(l*m-u*g)+_*(l*f-u*d),t[1]=-(i*(d*m-f*g)-h*(r*m-o*g)+_*(r*f-o*d)),t[2]=i*(l*m-u*g)-s*(r*m-o*g)+_*(r*u-o*l),t[3]=-(i*(l*f-u*d)-s*(r*f-o*d)+h*(r*u-o*l)),t[4]=-(a*(d*m-f*g)-c*(l*m-u*g)+p*(l*f-u*d)),t[5]=n*(d*m-f*g)-c*(r*m-o*g)+p*(r*f-o*d),t[6]=-(n*(l*m-u*g)-a*(r*m-o*g)+p*(r*u-o*l)),t[7]=n*(l*f-u*d)-a*(r*f-o*d)+c*(r*u-o*l),t[8]=a*(h*m-f*_)-c*(s*m-u*_)+p*(s*f-u*h),t[9]=-(n*(h*m-f*_)-c*(i*m-o*_)+p*(i*f-o*h)),t[10]=n*(s*m-u*_)-a*(i*m-o*_)+p*(i*u-o*s),t[11]=-(n*(s*f-u*h)-a*(i*f-o*h)+c*(i*u-o*s)),t[12]=-(a*(h*g-d*_)-c*(s*g-l*_)+p*(s*d-l*h)),t[13]=n*(h*g-d*_)-c*(i*g-r*_)+p*(i*d-r*h),t[14]=-(n*(s*g-l*_)-a*(i*g-r*_)+p*(i*l-r*s)),t[15]=n*(s*d-l*h)-a*(i*d-r*h)+c*(i*l-r*s),t},l.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],_=t[14],g=t[15],m=e*a-n*o,v=e*s-i*o,y=e*l-r*o,b=n*s-i*a,x=n*l-r*a,w=i*l-r*s,S=u*p-c*f,A=u*_-h*f,k=u*g-d*f,C=c*_-h*p,T=c*g-d*p,E=h*g-d*_;return m*E-v*T+y*C+b*k-x*A+w*S},l.multiply=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],_=e[12],g=e[13],m=e[14],v=e[15],y=n[0],b=n[1],x=n[2],w=n[3];return t[0]=y*i+b*s+x*h+w*_,t[1]=y*r+b*l+x*d+w*g,t[2]=y*o+b*u+x*f+w*m,t[3]=y*a+b*c+x*p+w*v,y=n[4],b=n[5],x=n[6],w=n[7],t[4]=y*i+b*s+x*h+w*_,t[5]=y*r+b*l+x*d+w*g,t[6]=y*o+b*u+x*f+w*m,t[7]=y*a+b*c+x*p+w*v,y=n[8],b=n[9],x=n[10],w=n[11],t[8]=y*i+b*s+x*h+w*_,t[9]=y*r+b*l+x*d+w*g,t[10]=y*o+b*u+x*f+w*m,t[11]=y*a+b*c+x*p+w*v,y=n[12],b=n[13],x=n[14],w=n[15],t[12]=y*i+b*s+x*h+w*_,t[13]=y*r+b*l+x*d+w*g,t[14]=y*o+b*u+x*f+w*m,t[15]=y*a+b*c+x*p+w*v,t},l.fromMat3=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},l.mul=l.multiply,l.translate=function(t,e,n){var i,r,o,a,s,l,u,c,h,d,f,p,_=n[0],g=n[1],m=n[2];return e===t?(t[12]=e[0]*_+e[4]*g+e[8]*m+e[12],t[13]=e[1]*_+e[5]*g+e[9]*m+e[13],t[14]=e[2]*_+e[6]*g+e[10]*m+e[14],t[15]=e[3]*_+e[7]*g+e[11]*m+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=i*_+s*g+h*m+e[12],t[13]=r*_+l*g+d*m+e[13],t[14]=o*_+u*g+f*m+e[14],t[15]=a*_+c*g+p*m+e[15]),t},l.scale=function(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.rotate=function(t,n,i,r){var o,a,s,l,u,c,h,d,f,p,_,g,m,v,y,b,x,w,S,A,k,C,T,E,M=r[0],L=r[1],R=r[2],O=Math.sqrt(M*M+L*L+R*R);return Math.abs(O)<e?null:(O=1/O,M*=O,L*=O,R*=O,o=Math.sin(i),a=Math.cos(i),s=1-a,l=n[0],u=n[1],c=n[2],h=n[3],d=n[4],f=n[5],p=n[6],_=n[7],g=n[8],m=n[9],v=n[10],y=n[11],b=M*M*s+a,x=L*M*s+R*o,w=R*M*s-L*o,S=M*L*s-R*o,A=L*L*s+a,k=R*L*s+M*o,C=M*R*s+L*o,T=L*R*s-M*o,E=R*R*s+a,t[0]=l*b+d*x+g*w,t[1]=u*b+f*x+m*w,t[2]=c*b+p*x+v*w,t[3]=h*b+_*x+y*w,t[4]=l*S+d*A+g*k,t[5]=u*S+f*A+m*k,t[6]=c*S+p*A+v*k,t[7]=h*S+_*A+y*k,t[8]=l*C+d*T+g*E,t[9]=u*C+f*T+m*E,t[10]=c*C+p*T+v*E,t[11]=h*C+_*T+y*E,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},l.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*i,t[5]=a*r+c*i,t[6]=s*r+h*i,t[7]=l*r+d*i,t[8]=u*r-o*i,t[9]=c*r-a*i,t[10]=h*r-s*i,t[11]=d*r-l*i,t},l.rotateY=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-u*i,t[1]=a*r-c*i,t[2]=s*r-h*i,t[3]=l*r-d*i,t[8]=o*i+u*r,t[9]=a*i+c*r,t[10]=s*i+h*r,t[11]=l*i+d*r,t},l.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*i,t[1]=a*r+c*i,t[2]=s*r+h*i,t[3]=l*r+d*i,t[4]=u*r-o*i,t[5]=c*r-a*i,t[6]=h*r-s*i,t[7]=d*r-l*i,t},l.fromRotationTranslation=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=i+i,l=r+r,u=o+o,c=i*s,h=i*l,d=i*u,f=r*l,p=r*u,_=o*u,g=a*s,m=a*l,v=a*u;return t[0]=1-(f+_),t[1]=h+v,t[2]=d-m,t[3]=0,t[4]=h-v,t[5]=1-(c+_),t[6]=p+g,t[7]=0,t[8]=d+m,t[9]=p-g,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},l.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n+n,s=i+i,l=r+r,u=n*a,c=n*s,h=n*l,d=i*s,f=i*l,p=r*l,_=o*a,g=o*s,m=o*l;return t[0]=1-(d+p),t[1]=c+m,t[2]=h-g,t[3]=0,t[4]=c-m,t[5]=1-(u+p),t[6]=f+_,t[7]=0,t[8]=h+g,t[9]=f-_,t[10]=1-(u+d),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},l.frustum=function(t,e,n,i,r,o,a){var s=1/(n-e),l=1/(r-i),u=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(r+i)*l,t[10]=(a+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*u,t[15]=0,t},l.perspective=function(t,e,n,i,r){var o=1/Math.tan(e/2),a=1/(i-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*a,t[15]=0,t},l.ortho=function(t,e,n,i,r,o,a){var s=1/(e-n),l=1/(i-r),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(a+o)*u,t[15]=1,t},l.lookAt=function(t,n,i,r){var o,a,s,u,c,h,d,f,p,_,g=n[0],m=n[1],v=n[2],y=r[0],b=r[1],x=r[2],w=i[0],S=i[1],A=i[2];return Math.abs(g-w)<e&&Math.abs(m-S)<e&&Math.abs(v-A)<e?l.identity(t):(d=g-w,f=m-S,p=v-A,_=1/Math.sqrt(d*d+f*f+p*p),d*=_,f*=_,p*=_,o=b*p-x*f,a=x*d-y*p,s=y*f-b*d,_=Math.sqrt(o*o+a*a+s*s),_?(_=1/_,o*=_,a*=_,s*=_):(o=0,a=0,s=0),u=f*s-p*a,c=p*o-d*s,h=d*a-f*o,_=Math.sqrt(u*u+c*c+h*h),_?(_=1/_,u*=_,c*=_,h*=_):(u=0,c=0,h=0),t[0]=o,t[1]=u,t[2]=d,t[3]=0,t[4]=a,t[5]=c,t[6]=f,t[7]=0,t[8]=s,t[9]=h,t[10]=p,t[11]=0,t[12]=-(o*g+a*m+s*v),t[13]=-(u*g+c*m+h*v),t[14]=-(d*g+f*m+p*v),t[15]=1,t)},l.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},t.mat4=l;var u={};return u.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(i,r,a){var s=o.dot(r,a);return-.999999>s?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,n,r),o.normalize(t,t),u.setAxisAngle(i,t,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(o.cross(t,r,a),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+s,u.normalize(i,i))}}(),u.setAxes=function(){var t=s.create();return function(e,n,i,r){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=n[0],t[5]=n[1],t[8]=n[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=a.clone,u.fromValues=a.fromValues,u.copy=a.copy,u.set=a.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,n){n=.5*n;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t},u.add=a.add,u.multiply=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=n[0],l=n[1],u=n[2],c=n[3];return t[0]=i*c+a*s+r*u-o*l,t[1]=r*c+a*l+o*s-i*u,t[2]=o*c+a*u+i*l-r*s,t[3]=a*c-i*s-r*l-o*u,t},u.mul=u.multiply,u.scale=a.scale,u.rotateX=function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+a*s,t[1]=r*l+o*s,t[2]=o*l-r*s,t[3]=a*l-i*s,t},u.rotateY=function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l-o*s,t[1]=r*l+a*s,t[2]=o*l+i*s,t[3]=a*l-r*s,t},u.rotateZ=function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+r*s,t[1]=r*l-i*s,t[2]=o*l+a*s,t[3]=a*l-o*s,t},u.calculateW=function(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=-Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t},u.dot=a.dot,u.lerp=a.lerp,u.slerp=function(t,e,n,i){var r,o,a,s,l,u=e[0],c=e[1],h=e[2],d=e[3],f=n[0],p=n[1],_=n[2],g=n[3];return o=u*f+c*p+h*_+d*g,0>o&&(o=-o,f=-f,p=-p,_=-_,g=-g),1-o>1e-6?(r=Math.acos(o),a=Math.sin(r),s=Math.sin((1-i)*r)/a,l=Math.sin(i*r)/a):(s=1-i,l=i),t[0]=s*u+l*f,t[1]=s*c+l*p,t[2]=s*h+l*_,t[3]=s*d+l*g,t},u.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*n+i*i+r*r+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-i*s,t[2]=-r*s,t[3]=o*s,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=a.length,u.len=u.length,u.squaredLength=a.squaredLength,u.sqrLen=u.squaredLength,u.normalize=a.normalize,u.fromMat3=function(){var t="undefined"!=typeof Int8Array?new Int8Array([1,2,0]):[1,2,0];return function(e,n){var i,r=n[0]+n[4]+n[8];if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,i=.5/i,e[0]=(n[7]-n[5])*i,e[1]=(n[2]-n[6])*i,e[2]=(n[3]-n[1])*i;else{var o=0;n[4]>n[0]&&(o=1),n[8]>n[3*o+o]&&(o=2);var a=t[o],s=t[a];i=Math.sqrt(n[3*o+o]-n[3*a+a]-n[3*s+s]+1),e[o]=.5*i,i=.5/i,e[3]=(n[3*s+a]-n[3*a+s])*i,e[a]=(n[3*a+o]+n[3*o+a])*i,e[s]=(n[3*s+o]+n[3*o+s])*i}return e}}(),u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.quat=u,t}(),e=function(){function e(t,e){this._colors=t;for(var n=0;n<this._colors.length;++n)this._colors[n]=a.forceRGB(this._colors[n]);this._stops=e}function n(t,e,n){this.colorFor=t,this._beginFunc=e,this._endFunc=n}function i(t,e,n){var i=null,r=null;return t[e](function(t){var e=t.prop(n);return null===i&&null===r?void(i=r=e):(i=Math.min(i,e),void(r=Math.max(r,e)))}),{min:i,max:r}}function r(t,e,r,o,a){return e||(e=c("rainbow")),new n(function(n,i,r){var o=0;this._min!==this._max&&(o=(a(n).prop(t)-this._min)/(this._max-this._min)),d(i,r,e,o)},function(e){return void 0!==r?(this._min=r[0],void(this._max=r[1])):(r=i(e,o,t),this._min=r.min,void(this._max=r.max))},function(){})}var o=t.vec4,a={};a.rgb={};var s=a.rgb;a.rgb.create=o.create,a.rgb.scale=o.scale,a.rgb.copy=o.copy,a.rgb.fromValues=o.fromValues,a.rgb.mix=function(t,e,n,i){var r=1-i;return t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t};var l={white:s.fromValues(1,1,1,1),black:s.fromValues(0,0,0,1),grey:s.fromValues(.5,.5,.5,1),lightgrey:s.fromValues(.8,.8,.8,1),darkgrey:s.fromValues(.3,.3,.3,1),red:s.fromValues(1,0,0,1),darkred:s.fromValues(.5,0,0,1),lightred:s.fromValues(1,.5,.5,1),green:s.fromValues(0,1,0,1),darkgreen:s.fromValues(0,.5,0,1),lightgreen:s.fromValues(.5,1,.5,1),blue:s.fromValues(0,0,1,1),darkblue:s.fromValues(0,0,.5,1),lightblue:s.fromValues(.5,.5,1,1),yellow:s.fromValues(1,1,0,1),darkyellow:s.fromValues(.5,.5,0,1),lightyellow:s.fromValues(1,1,.5,1),cyan:s.fromValues(0,1,1,1),darkcyan:s.fromValues(0,.5,.5,1),lightcyan:s.fromValues(.5,1,1,1),magenta:s.fromValues(1,0,1,1),darkmagenta:s.fromValues(.5,0,.5,1),lightmagenta:s.fromValues(1,.5,1,1),orange:s.fromValues(1,.5,0,1),darkorange:s.fromValues(.5,.25,0,1),lightorange:s.fromValues(1,.75,.5,1)};a.hex2rgb=function(t){var e,n,i,r;if(4===t.length||5===t.length){e=parseInt(t[1],16),n=parseInt(t[2],16),i=parseInt(t[3],16),r=15,5===t.length&&(r=parseInt(t[4],16));var o=1/15;return s.fromValues(o*e,o*n,o*i,o*r)}if(7===t.length||9===t.length){e=parseInt(t.substr(1,2),16),n=parseInt(t.substr(3,2),16),i=parseInt(t.substr(5,2),16),r=255,9===t.length&&(r=parseInt(t.substr(7,2),16));var a=1/255;return s.fromValues(a*e,a*n,a*i,a*r)}},a.setColorPalette=function(t){console.log("setting colors"),l=t,a.initGradients()},a.forceRGB=function(t){if("string"==typeof t){var e=l[t];if(void 0!==e)return e;if(t.length>0&&"#"===t[0])return a.hex2rgb(t)}return 3===t.length?[t[0],t[1],t[2],1]:t},e.prototype={colorAt:function(t,e){if(e<=this._stops[0])return o.copy(t,this._colors[0]);if(e>=this._stops[this._stops.length-1])return o.copy(t,this._colors[this._stops.length-1]);for(var n=0,i=1;i<this._stops.length&&!(this._stops[i]>e);++i)n=i;var r=n+1,a=this._stops[n],l=this._stops[r],u=(e-a)/(l-a);return s.mix(t,this._colors[r],this._colors[n],u)}};var u={};a.gradient=function(t,n){if("string"==typeof t)return u[t];if(n=n||"equal","equal"===n){n=[];for(var i=0;i<t.length;++i)n.push(1*i/(t.length-1))}return new e(t,n)};var c=a.gradient;a.initGradients=function(){u.rainbow=c(["red","yellow","green","blue"]),u.reds=c(["lightred","darkred"]),u.greens=c(["lightgreen","darkgreen"]),u.blues=c(["lightblue","darkblue"]),u.trafficlight=c(["green","yellow","red"]),u.heatmap=c(["red","white","blue"])},n.prototype={begin:function(t){this._beginFunc&&this._beginFunc(t)},end:function(t){this._endFunc&&this._endFunc(t)}},a.ColorOp=n,a.uniform=function(t){return t=a.forceRGB(t||"white"),new n(function(e,n,i){n[i+0]=t[0],n[i+1]=t[1],n[i+2]=t[2],n[i+3]=t[3]},null,null)};var h={H:[1,1,1],C:[.83,.83,.83],N:[.13,.2,1],O:[1,.13,0],F:[.12,.94,.12],CL:[.12,.94,.12],BR:[.6,.13,0],I:[.4,0,.73],HE:[0,1,1],NE:[0,1,1],AR:[0,1,1],XE:[0,1,1],KR:[0,1,1],P:[1,.6,0],S:[.87,.87,0],B:[1,.67,.47],LI:[.47,0,1],NA:[.47,0,1],K:[.47,0,1],RB:[.47,0,1],CS:[.47,0,1],FR:[.47,0,1],BE:[0,.47,0],MG:[0,.47,0],SR:[0,.47,0],BA:[0,.47,0],RA:[0,.47,0],TI:[.6,.6,.6],FE:[.87,.47,0]};a.byElement=function(){return new n(function(t,e,n){var i=t.element(),r=h[i];return void 0!==r?(e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=1,e):(e[n]=1,e[n+1]=0,e[n+2]=1,e[n+3]=1,e)},null,null)},a.bySS=function(){return new n(function(t,e,n){switch(t.residue().ss()){case"C":return e[n]=.8,e[n+1]=.8,e[n+2]=.8,void(e[n+3]=1);case"H":return e[n]=.6,e[n+1]=.6,e[n+2]=.9,void(e[n+3]=1);case"E":return e[n]=.2,e[n+1]=.8,e[n+2]=.2,void(e[n+3]=1)}},null,null)},a.rainbow=function(t){t||(t=c("rainbow"));var e=new n(function(e,n,i){var r=0,o=this.chainLimits[e.residue().chain().name()];if(void 0!==o){var a=e.residue().index();r=(a-o[0])/(o[1]-o[0])}var s=[1,1,1,1];t.colorAt(s,r),n[i]=s[0],n[i+1]=s[1],n[i+2]=s[2],n[i+3]=s[3]},function(t){var e=t.chains();this.chainLimits={};for(var n=0;n<e.length;++n){var i=e[n].backboneTraces();if(0!==i.length){for(var r=i[0].residueAt(0).index(),o=i[0].residueAt(i[0].length()-1).index(),a=1;a<i.length;++a){var s=i[a];r=Math.min(r,s.residueAt(0).index()),o=Math.max(o,s.residueAt(s.length()-1).index())}r!==o&&(this.chainLimits[e[n].name()]=[r,o])}}},function(){this.chainLimits=null});return e},a.ssSuccession=function(t,e){t||(t=c("rainbow")),e||(e=a.forceRGB("lightgrey"));var i=new n(function(n,i,r){var o=n.residue().index(),a=this.chainLimits[n.residue().chain().name()],s=a.indices[o];if(-1===s)return i[r]=e[0],i[r+1]=e[1],i[r+2]=e[2],void(i[r+3]=e[3]);var l=0;null===a.max,null!==a.max&&(l=s/(a.max>0?a.max:1));var u=[0,0,0,0];t.colorAt(u,l),i[r]=u[0],i[r+1]=u[1],i[r+2]=u[2],i[r+3]=u[3]},function(t){var e=t.chains();this.chainLimits={};for(var n=0;n<e.length;++n){for(var i=e[n].residues(),r=null,o={},a=0,s="C",l=0;l<i.length;++l){var u=i[l].ss();"C"===u?("C"!==s&&a++,o[i[l].index()]=-1):(r=a,o[i[l].index()]=a),s=u}this.chainLimits[e[n].name()]={indices:o,max:r}}},function(){this.chainLimits=null});return i},a.byChain=function(t){t||(t=c("rainbow"));var e=new n(function(e,n,i){var r=this.chainIndices[e.residue().chain().name()],o=r*this.scale,a=[0,0,0,0];t.colorAt(a,o),n[i+0]=a[0],n[i+1]=a[1],n[i+2]=a[2],n[i+3]=a[3]},function(t){var e=t.chains();this.chainIndices={};for(var n=0;n<e.length;++n)this.chainIndices[e[n].name()]=n;this.scale=e.length>1?1/(e.length-1):1},function(){this.chainIndices=null});return e};var d=function(){var t=o.create();return function(e,n,i,r){i.colorAt(t,r),e[n+0]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3]}}();return a.byAtomProp=function(t,e,n){return r(t,e,n,"eachAtom",function(t){return t})},a.byResidueProp=function(t,e,n){return r(t,e,n,"eachResidue",function(t){return t.residue()})},a.interpolateColor=function(t,e){for(var n=new Float32Array(4*(e*(t.length/4-1)+1)),i=0,r=o.create(),a=o.create(),s=1/e,l=0;l<t.length/4-1;++l){o.set(r,t[4*l+0],t[4*l+1],t[4*l+2],t[4*l+3]),o.set(a,t[4*l+4],t[4*l+5],t[4*l+6],t[4*l+7]);for(var u=0;e>u;++u){var c=s*u;n[i+0]=r[0]*(1-c)+a[0]*c,n[i+1]=r[1]*(1-c)+a[1]*c,n[i+2]=r[2]*(1-c)+a[2]*c,n[i+3]=r[3]*(1-c)+a[3]*c,i+=4}}return n[i+0]=a[0],n[i+1]=a[1],n[i+2]=a[2],n[i+3]=a[3],n},a.initGradients(),a}(),n=function(){function t(t,e,n){this._pool=t,this._start=e,this._next=e,this._end=n}function e(){this.clear()}return t.prototype={nextId:function(t){var e=this._next;return console.assert(this._next<this._end),this._next++,this._pool._objects[e]=t,e},hasLeft:function(){return this._next<this._end},recycle:function(){this._pool.recycle(this)},length:function(){return this._end-this._start}},e.prototype={MAX_ID:16777216,getContinuousRange:function(e){for(var n=-1,i=null,r=0;r<this._free.length;++r){var o=this._free[r],a=o.length();a>=e&&(null===i||i>a)&&(i=a,n=r)}if(-1!==n){var s=this._free[n];return this._free.splice(n,1),this._usedCount++,s}var l=this._unusedRangeStart,u=l+e;if(u>this.MAX_ID)return console.error("not enough free object ids."),null;this._unusedRangeStart=u;var c=new t(this,l,u);return this._usedCount++,c},clear:function(){this._objects={},this._unusedRangeStart=1,this._free=[],this._usedCount=0},recycle:function(t){for(var e=t._start;e<t._next;++e)delete this._objects[e];t._next=t._start,this._free.push(t),this._usedCount--,console.assert(this._usedCount>=0),this._free.length>0&&0===this._usedCount&&this.clear()},objectForId:function(t){return this._objects[t]}},e}(),i=function(){function t(t,e){return e>t}function e(t,e){void 0===t||void 0===e?(this._empty=!0,this._min=this._max=null):(this._empty=!1,this._min=t,this._max=e)}var n={};return n.derive=function(t,e,n){for(var i in e.prototype)t.prototype[i]=e.prototype[i];if(void 0!==n)for(var r in n)t.prototype[r]=n[r]},n.bind=function(t,e){return function(){return e.apply(t,arguments)}},n.copy=function(t){t=t||{};var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},n.binarySearch=function(e,n,i){if(0===e.length)return-1;i=i||t;for(var r=0,o=e.length,a=r+o>>1;;){var s=e[a];if(i(n,s))o=a;else{if(!i(s,n))return a;r=a}var l=r+o>>1;if(l===a)return-1;a=l}return-1},n.indexFirstLargerEqualThan=function(e,n,i){if(i=i||t,0===e.length||i(e[e.length-1],n))return-1;for(var r=0,o=e.length,a=r+o>>1;;){var s=e[a];i(n,s)?o=a:i(s,n)?r=a+1:o=a;var l=r+o>>1;if(l===a)return a;a=l}},n.indexLastSmallerThan=function(e,n,i){if(i=i||t,0===e.length||i(e[e.length-1],n))return e.length-1;if(i(n,e[0])||!i(e[0],n))return-1;for(var r=0,o=e.length,a=r+o>>1;;){var s=e[a];i(n,s)||!i(s,n)?o=a:r=a;var l=r+o>>1;if(l===a)return a;a=l}},n.indexLastSmallerEqualThan=function(e,n,i){if(i=i||t,0===e.length||i(e[e.length-1],n))return e.length-1;if(i(n,e[0]))return-1;for(var r=0,o=e.length,a=r+o>>1;;){var s=e[a];i(n,s)?o=a:r=a;var l=r+o>>1;if(l===a)return a;a=l}},e.prototype={min:function(){return this._min},max:function(){return this._max},length:function(){return this._max-this._min},empty:function(){return this._empty},center:function(){return.5*(this._max+this._min)},extend:function(t){this._min-=t,this._max+=t},update:function(t){return this._empty?(this._min=this._max=t,void(this._empty=!1)):void(t<this._min?this._min=t:t>this._max&&(this._max=t))}},n.Range=e,n}(),r=function(){function t(t){if("complete"!==document.readyState&&"loaded"!==document.readyState&&"interactive"!==document.readyState)return console.error("isWebGLSupported only works after DOMContentLoaded"),!1;if(void 0===t)try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("experimental-webgl"))}catch(n){return!1}return!!t}function e(t,e){this._width=e.width,this._antialias=e.antialias,this._height=e.height,this._resize=!1,this._lastTimestamp=null,this._domElement=t,this._initCanvas(),this._backgroundColor=e.backgroundColor,this._forceManualAntialiasing=e.forceManualAntialiasing}return e.prototype={_ensureSize:function(){if(this._resize){this._resize=!1;var t=this._width*this._samples,e=this._height*this._samples;this._realWidth=t,this._realHeight=e,this._gl.viewport(0,0,t,e),this._canvas.width=t,this._canvas.height=e,this._samples>1&&this._initManualAntialiasing(this._samples)}},resize:function(t,e){(t!==this._width||e!==this._height)&&(this._resize=!0,this._width=t,this._height=e)},fitParent:function(){var t=this._domElement.getBoundingClientRect();this.resize(t.width,t.height)},gl:function(){return this._gl},imageData:function(){return this._canvas.toDataURL()},_initContext:function(){try{var t={antialias:this._antialias&&!this._forceManualAntialiasing,preserveDrawingBuffer:!0};this._gl=this._canvas.getContext("experimental-webgl",t)}catch(e){return console.error("WebGL not supported",e),!1}return this._gl?!0:(console.error("WebGL not supported"),!1)},_initManualAntialiasing:function(t){var e=1/t,n=.5*-(1-e)*this._realWidth,i=.5*-(1-e)*this._realHeight,r="translate("+n+"px, "+i+"px)",o="scale("+e+", "+e+")",a=r+" "+o;this._canvas.style.webkitTransform=a,this._canvas.style.transform=a,this._canvas.style.ieTransform=a,this._canvas.width=this._realWidth,this._canvas.height=this._realHeight},initGL:function(){var t=1;if(!this._initContext())return!1;var e=this._gl;return e.getContextAttributes().antialias&&!this._forceManualAntialiasing||!this._antialias||(t=2),this._realWidth=this._width*t,this._realHeight=this._height*t,this._samples=t,t>1&&this._initManualAntialiasing(t),e.viewportWidth=this._realWidth,e.viewportHeight=this._realHeight,e.clearColor(this._backgroundColor[0],this._backgroundColor[1],this._backgroundColor[2],1),e.lineWidth(2),e.cullFace(e.FRONT),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST),!0},_shaderFromString:function(t,e,n){var i,r=this._gl;if("fragment"===e)i=r.createShader(r.FRAGMENT_SHADER);else{if("vertex"!==e)return console.error("could not determine type for shader"),null;i=r.createShader(r.VERTEX_SHADER)}var o=t.replace("${PRECISION}",n);return r.shaderSource(i,o),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS)?i:(console.log(o),console.error(r.getShaderInfoLog(i)),null)},initShader:function(t,e,n){var r=this._gl,o=this._shaderFromString(e,"fragment",n),a=this._shaderFromString(t,"vertex",n),s=r.createProgram();if(r.attachShader(s,a),r.attachShader(s,o),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))return console.error("could not initialise shaders"),console.error(r.getShaderInfoLog(s)),
null;var l=i.bind(r,r.getAttribLocation),u=i.bind(r,r.getUniformLocation);return s.posAttrib=l(s,"attrPos"),s.colorAttrib=l(s,"attrColor"),s.normalAttrib=l(s,"attrNormal"),s.objIdAttrib=l(s,"attrObjId"),s.selectAttrib=l(s,"attrSelect"),s.symId=u(s,"symId"),s.projection=u(s,"projectionMat"),s.modelview=u(s,"modelviewMat"),s.rotation=u(s,"rotationMat"),s.fog=u(s,"fog"),s.fogFar=u(s,"fogFar"),s.fogNear=u(s,"fogNear"),s.fogColor=u(s,"fogColor"),s.outlineColor=u(s,"outlineColor"),s.outlineWidth=u(s,"outlineWidth"),s.relativePixelSize=u(s,"relativePixelSize"),s.screenDoorTransparency=u(s,"screenDoorTransparency"),s.selectionColor=u(s,"selectionColor"),s.pointSize=u(s,"pointSize"),s.zoom=u(s,"zoom"),s},on:function(t,e){this._canvas.addEventListener(t,e,!1)},removeEventListener:function(t,e){this._canvas.removeEventListener(t,e,!1)},onWheel:function(t,e){"onwheel"in this._canvas?this.on("wheel",t):this.on("mousewheel",e)},domElement:function(){return this._canvas},bind:function(){this._ensureSize(),this._gl.viewport(0,0,this._realWidth,this._realHeight)},superSamplingFactor:function(){return this._samples},viewportWidth:function(){return this._realWidth},viewportHeight:function(){return this._realHeight},width:function(){return this._width},height:function(){return this._height},_initCanvas:function(){this._canvas=document.createElement("canvas"),this._canvas.width=this._width,this._canvas.height=this._height,this._domElement.appendChild(this._canvas)},isWebGLSupported:function(){return t(this._gl)},destroy:function(){this._canvas.width=1,this._canvas.height=1,this._canvas.parentElement.removeChild(this._canvas),this._canvas=null}},{Canvas:e,isWebGLSupported:t}}(),o=function(){function t(t,e){this._width=e.width,this._height=e.height,this._colorBufferWidth=this._width,this._colorBufferHeight=this._height,this._gl=t,this._colorHandle=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._colorHandle),this._depthHandle=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this._depthHandle),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this._width,this._height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this._depthHandle),this._colorTexture=t.createTexture(),this._initColorBuffer()}return t.prototype={width:function(){return this._width},height:function(){return this._height},bind:function(){var t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._colorHandle),t.bindRenderbuffer(t.RENDERBUFFER,this._depthHandle),(this._colorBufferWidth!==this._width||this._colorBufferHeight!==this._height)&&this._resizeBuffers(),t.viewport(0,0,this._width,this._height)},colorTexture:function(){return this._colorTexture},_initColorBuffer:function(){this.bind();var t=this._gl;t.bindTexture(t.TEXTURE_2D,this._colorTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this._width,this._height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._colorTexture,0),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null),this.release()},_resizeBuffers:function(){var t=this._gl;t.bindRenderbuffer(t.RENDERBUFFER,this._depthHandle),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this._width,this._height),t.bindTexture(t.TEXTURE_2D,this._colorTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this._width,this._height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._colorTexture,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this._depthHandle),t.bindTexture(t.TEXTURE_2D,null),this._colorBufferWidth=this._width,this._colorBufferHeight=this._height},resize:function(t,e){this._width=t,this._height=e},release:function(){var t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null)}},t}(),a=function(){function t(t){this._freeArrays=[],this._bufferType=t}return t.prototype.request=function(t){for(var e=-1,n=null,i=0;i<this._freeArrays.length;++i){var r=this._freeArrays[i],o=r.length;o>=t&&(null===n||n>o)&&(n=o,e=i)}if(-1!==e){var a=this._freeArrays[e];return this._freeArrays.splice(e,1),a}return new this._bufferType(t)},t.prototype.release=function(t){this._freeArrays.push(t)},t}(),s=function(){function e(t){this._projection=i.create(),this._camModelView=i.create(),this._modelView=i.create(),this._rotation=i.create(),this._translation=i.create(),this._near=.1,this._far=4e3,this._fogNear=-5,this._fogFar=50,this._fog=!0,this._fovY=45*Math.PI/180,this._fogColor=n.fromValues(1,1,1),this._outlineColor=n.fromValues(.1,.1,.1),this._outlineWidth=1,this._selectionColor=n.fromValues(.1,1,.1),this._center=n.create(),this._zoom=50,this._screenDoorTransparency=!1,this._updateProjectionMat=!0,this._updateModelViewMat=!0,this._upsamplingFactor=1,this._gl=t,this._currentShader=null,this._stateId=0,this.setViewportSize(t.viewportWidth,t.viewportHeight)}var n=t.vec3,i=t.mat4;return e.prototype={_incrementStateId:function(){this._stateId+=1,this._stateId>68719476735&&(this._stateId=0)},setScreenDoorTransparency:function(t){this._screenDoorTransparency=t,this._incrementStateId()},setOutlineWidth:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,this._incrementStateId())},setRotation:function(t){16===t.length?i.copy(this._rotation,t):i.fromMat3(this._rotation,t),this._updateModelViewMat=!0},upsamplingFactor:function(){return this._upsamplingFactor},setUpsamplingFactor:function(t){if(this._upsamplingFactor!==t){this._incrementStateId(),this._upsamplingFactor=t;var e=this._upsamplingFactor/this._width,n=this._upsamplingFactor/this._height;this._relativePixelSize=new Float32Array([e,n])}},mainAxes:function(){return[n.fromValues(this._rotation[0],this._rotation[4],this._rotation[8]),n.fromValues(this._rotation[1],this._rotation[5],this._rotation[9]),n.fromValues(this._rotation[2],this._rotation[6],this._rotation[10])]},fieldOfViewY:function(){return this._fovY},setFieldOfViewY:function(t){this._fovY=t,this._updateProjectionMat=!0},aspectRatio:function(){return this._width/this._height},rotation:function(){return this._rotation},_updateIfRequired:function(){var t=!1;return this._updateModelViewMat&&(i.identity(this._camModelView),i.translate(this._camModelView,this._camModelView,[-this._center[0],-this._center[1],-this._center[2]]),i.mul(this._camModelView,this._rotation,this._camModelView),i.identity(this._translation),i.translate(this._translation,this._translation,[0,0,-this._zoom]),i.mul(this._camModelView,this._translation,this._camModelView),t=!0),this._updateProjectionMat&&(i.identity(this._projection),i.perspective(this._projection,this._fovY,this._width/this._height,this._near,this._far),t=!0),this._updateProjectionMat=!1,this._updateModelViewMat=!1,t&&this._incrementStateId(),t},setViewportSize:function(t,e){this._updateProjectionMat=!0,this._width=t,this._height=e,this._relativePixelSize=new Float32Array([this._upsamplingFactor/t,this._upsamplingFactor/e])},viewportWidth:function(){return this._width},viewportHeight:function(){return this._height},setCenter:function(t){this._updateModelViewMat=!0,n.copy(this._center,t)},fog:function(t){return void 0!==t&&t!==this._fog&&(this._fog=t,this._incrementStateId()),this._fog},rotateZ:function(){var t=i.create();return function(e){i.identity(t),this._updateModelViewMat=!0,i.rotate(t,t,e,[0,0,1]),i.mul(this._rotation,t,this._rotation)}}(),rotateX:function(){var t=i.create();return function(e){i.identity(t),this._updateModelViewMat=!0,i.rotate(t,t,e,[1,0,0]),i.mul(this._rotation,t,this._rotation)}}(),rotateY:function(){var t=i.create();return function(e){i.identity(t),this._updateModelViewMat=!0,i.rotate(t,t,e,[0,1,0]),i.mul(this._rotation,t,this._rotation)}}(),panX:function(t){return this.panXY(t,0)},panY:function(t){return this.panXY(0,t)},panXY:function(){var t=i.create(),e=n.create();return function(r,o){i.transpose(t,this._rotation),this._updateModelViewMat=!0,n.set(e,-r,o,0),n.transformMat4(e,e,t),n.add(e,e,this._center),this.setCenter(e)}}(),nearOffset:function(){return this._near},farOffset:function(){return this._far},setNearFar:function(t,e){(t!==this._near||e!==this._far)&&(this._near=t,this._far=e,this._updateProjectionMat=!0)},setFogNearFar:function(t,e){this._fogNear=t,this._fogFar=e,this._updateProjectionMat=!0},setZoom:function(t){return this._updateModelViewMat=!0,this._zoom=t,this._zoom},zoom:function(t){if(void 0===t)return this._zoom;this._updateModelViewMat=!0;var e=1+.1*t;return this._zoom=Math.min(1e3,Math.max(2,e*this._zoom)),this._zoom},center:function(){return this._center},setFogColor:function(t){this._fogColor=n.clone(t)},currentShader:function(){return this._currentShader},invalidateCurrentShader:function(){this._currentShader=null},setOutlineColor:function(t){this._outlineColor=n.clone(t)},setSelectionColor:function(t){this._selectionColor=n.clone(t)},bind:function(t,e){var n=!1,r=this._gl;if(this._currentShader!==t&&(this._currentShader=t,r.useProgram(t),n=!0),n=this._updateIfRequired()||n,e?(i.mul(this._modelView,this._camModelView,e),r.uniformMatrix4fv(t.modelview,!1,this._modelView)):r.uniformMatrix4fv(t.modelview,!1,this._camModelView),this._stateId!==t.stateId){t.stateId=this._stateId,r.uniformMatrix4fv(t.projection,!1,this._projection),t.rotation&&r.uniformMatrix4fv(t.rotation,!1,this._rotation),r.uniform1i(t.fog,this._fog);var o=this._zoom;r.uniform1f(t.fogFar,this._fogFar+o),r.uniform1f(t.zoom,this._zoom),r.uniform1f(t.fogNear,this._fogNear+o),r.uniform3fv(t.fogColor,this._fogColor),r.uniform3fv(t.outlineColor,this._outlineColor),r.uniform3fv(t.selectionColor,this._selectionColor),r.uniform2fv(t.relativePixelSize,this._relativePixelSize),r.uniform1f(t.outlineWidth,this._outlineWidth),r.uniform1i(t.screenDoorTransparency,this._screenDoorTransparency)}}},e}(),l={PRELUDE_FS:"\nprecision ${PRECISION} float;\nuniform bool screenDoorTransparency;\nvec4 handleAlpha(vec4 inColor) {\n  if (screenDoorTransparency) {\n    ivec2 pxCoord = ivec2(gl_FragCoord.xy);\n    ivec2 mod = pxCoord - (pxCoord/2) * 2;\n    if (inColor.a < 0.99 &&\n        (inColor.a < 0.01 || mod.x != 0 || mod.y != 0)) { discard; }\n    return vec4(inColor.rgb, 1.0);\n  } else {\n    if (inColor.a == 0.0) { discard; }\n    return inColor;\n  } \n} \nuniform vec3 selectionColor;\n\nvec3 handleSelect(vec3 inColor, float vertSelect) { \n  return mix(inColor, selectionColor, step(0.5, vertSelect) * 0.7); \n} \n\nuniform bool fog;\nuniform float fogNear;\nuniform float fogFar;\nuniform vec3 fogColor;\nvec3 handleFog(vec3 inColor) {\n  if (fog) {\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = smoothstep(fogNear, fogFar, depth);\n    return mix(inColor, fogColor, fogFactor);\n  } else {\n    return inColor;\n  }\n}",LINES_FS:"\nvarying vec4 vertColor;\nvarying vec3 vertNormal;\n\nvoid main(void) {\n  gl_FragColor = handleAlpha(vertColor);\n  gl_FragColor.rgb = handleFog(gl_FragColor.rgb);\n}",SELECT_LINES_FS:"\nprecision ${PRECISION} float;\n\nvarying float vertSelect;\nvarying vec3 vertNormal;\nuniform float fogNear;\nuniform float fogFar;\nuniform vec3 fogColor;\nuniform bool fog;\nuniform vec3 selectionColor;\n\nvoid main(void) {\n  gl_FragColor = mix(vec4(0.0, 0.0, 0.0, 0.0), vec4(selectionColor, 1.0), \n                     vertSelect);\n  gl_FragColor.a = step(0.5, vertSelect);\n  if (gl_FragColor.a == 0.0) { discard; }\n  float depth = gl_FragCoord.z / gl_FragCoord.w;\n  if (fog) {\n    float fog_factor = smoothstep(fogNear, fogFar, depth);\n    gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w),\n                        fog_factor);\n  }\n}",SELECT_LINES_VS:"\nattribute vec3 attrPos;\nattribute float attrSelect;\n\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nuniform float pointSize;\nvarying float vertSelect;\nvoid main(void) {\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  gl_Position.z += gl_Position.w * 0.000001; \n  float distToCamera = vec4(modelviewMat * vec4(attrPos, 1.0)).z;\n  gl_PointSize = pointSize * 200.0 / abs(distToCamera); \n  vertSelect = attrSelect;\n}",SELECT_VS:"\nprecision ${PRECISION} float;\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nuniform float pointSize;\nattribute vec3 attrPos;\nattribute float attrObjId;\n\nvarying float objId;\n\nvoid main(void) {\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  float distToCamera = vec4(modelviewMat * vec4(attrPos, 1.0)).z;\n  gl_PointSize = pointSize * 200.0 / abs(distToCamera); \n  objId = attrObjId;\n}",SELECT_FS:"\nprecision ${PRECISION} float;\n\nvarying float objId;\nuniform int symId;\n\nint intMod(int x, int y) { \n  int z = x/y;\n  return x-y*z;\n}\nvoid main(void) {\n  // ints are only required to be 7bit...\n  int integralObjId = int(objId+0.5);\n  int red = intMod(integralObjId, 256);\n  integralObjId/=256;\n  int green = intMod(integralObjId, 256);\n  integralObjId/=256;\n  int blue = intMod(integralObjId, 256);\n  int alpha = symId;\n  gl_FragColor = vec4(float(red), float(green), \n                      float(blue), float(alpha))/255.0;\n}",LINES_VS:"\nattribute vec3 attrPos;\nattribute vec4 attrColor;\n\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nvarying vec4 vertColor;\nuniform float pointSize;\nvoid main(void) {\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  float distToCamera = vec4(modelviewMat * vec4(attrPos, 1.0)).z;\n  gl_PointSize = pointSize * 200.0 / abs(distToCamera); \n  vertColor = attrColor;\n}",HEMILIGHT_FS:"\nvarying vec4 vertColor;\nvarying vec3 vertNormal;\nvarying float vertSelect;\n\nvoid main(void) {\n  float dp = dot(vertNormal, vec3(0.0, 0.0, 1.0));\n  float hemi = min(1.0, max(0.0, dp)*0.6+0.5);\n  gl_FragColor = vec4(vertColor.rgb*hemi, vertColor.a);\n  gl_FragColor.rgb = handleFog(handleSelect(gl_FragColor.rgb, vertSelect));\n  gl_FragColor = handleAlpha(gl_FragColor);\n}",PHONG_FS:"\nvarying vec4 vertColor;\nvarying vec3 vertNormal;\nvarying vec3 vertPos;\nuniform float zoom;\nvarying float vertSelect;\n\nvoid main(void) {\n  vec3 eyePos = vec3(0.0, 0.0, zoom);\n  float dp = dot(vertNormal, normalize(eyePos - vertPos));\n  float hemi = min(1.0, max(0.3, dp)+0.2);\n  //hemi *= vertColor.a;\n  vec3 rgbColor = vertColor.rgb * hemi; \n  rgbColor += min(vertColor.rgb, 0.8) * pow(max(0.0, dp), 18.0);\n  rgbColor = handleSelect(rgbColor, vertSelect);\n  gl_FragColor = vec4(clamp(rgbColor, 0.0, 1.0), vertColor.a);\n  gl_FragColor.rgb = handleFog(gl_FragColor.rgb);\n  gl_FragColor = handleAlpha(gl_FragColor);\n}",HEMILIGHT_VS:"\nattribute vec3 attrPos;\nattribute vec4 attrColor;\nattribute vec3 attrNormal;\nattribute float attrSelect;\n\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nvarying vec4 vertColor;\nvarying vec3 vertNormal;\nvarying vec3 vertPos;\nvarying float vertSelect;\nvoid main(void) {\n  vertPos = (modelviewMat * vec4(attrPos, 1.0)).xyz;\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  vec4 n = (modelviewMat * vec4(attrNormal, 0.0));\n  vertNormal = n.xyz;\n  vertColor = attrColor;\n  vertSelect = attrSelect;\n}",OUTLINE_FS:"\nvarying float vertAlpha;\nvarying float vertSelect;\n\nuniform vec3 outlineColor;\n\nvoid main() {\n  gl_FragColor = vec4(mix(outlineColor, selectionColor, \n                          step(0.5, vertSelect)), \n                      vertAlpha);\n  gl_FragColor.rgb = handleFog(gl_FragColor.rgb);\n  gl_FragColor = handleAlpha(gl_FragColor);\n}",OUTLINE_VS:"\nprecision ${PRECISION} float;\n\nattribute vec3 attrPos;\nattribute vec3 attrNormal;\nattribute vec4 attrColor;\nattribute float attrSelect;\n\nuniform vec3 outlineColor;\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nvarying float vertAlpha;\nvarying float vertSelect;\nuniform vec2 relativePixelSize;\nuniform float outlineWidth;\n\nvoid main(void) {\n  gl_Position = projectionMat * modelviewMat * vec4(attrPos, 1.0);\n  vec4 normal = modelviewMat * vec4(attrNormal, 0.0);\n  vertAlpha = attrColor.a;\n  vertSelect = attrSelect;\n  vec2 expansion = relativePixelSize * \n       (outlineWidth + 2.0 * step(0.5, attrSelect));\n  vec2 offset = normal.xy * expansion;\n  gl_Position.xy += gl_Position.w * offset;\n}",TEXT_VS:"\nprecision ${PRECISION} float;\n\nattribute vec3 attrCenter;\nattribute vec2 attrCorner;\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nuniform mat4 rotationMat;\nvarying vec2 vertTex;\nuniform float width;\nuniform float height;\nvoid main() { \n  vec4 pos = modelviewMat* vec4(attrCenter, 1.0);\n  pos.z += 4.0;\n  gl_Position = projectionMat * pos;\n  gl_Position.xy += vec2(width,height)*attrCorner*gl_Position.w; \n  vertTex = (attrCorner+abs(attrCorner))/(2.0*abs(attrCorner)); \n}",TEXT_FS:"\nprecision ${PRECISION} float;\n\nuniform mat4 projectionMat;\nuniform mat4 modelviewMat;\nuniform sampler2D sampler;\nuniform float xScale;\nuniform float yScale;\nvarying vec2 vertTex;\nvoid main() { \n  vec2 texCoord = vec2(vertTex.x*xScale, vertTex.y*yScale);\n  gl_FragColor = texture2D(sampler, texCoord);\n  if (gl_FragColor.a == 0.0) { discard; }\n}"},u=function(){function t(t,e,n){this._element=t,this._element.addEventListener("touchmove",i.bind(this,this._touchMove)),this._element.addEventListener("touchstart",i.bind(this,this._touchStart)),this._element.addEventListener("touchend",i.bind(this,this._touchEnd)),this._element.addEventListener("touchcancel",i.bind(this,this._touchEnd)),this._touchState={scale:1,rotation:0,center:null},this._lastSingleTap=null,this._viewer=e,this._cam=n}function e(t){for(var e=0,n=0,i=0;i<t.length;++i)e+=t[i].clientX,n+=t[i].clientY;return e/=t.length,n/=t.length,{x:e,y:n}}function n(t,e){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)}function r(t,e){var i=n(t[0],t[1]),r=n(e[0],e[1]);return r/(0===i?1:i)}function o(t,e){var n=e.x-t.x,i=e.y-t.y;return Math.atan2(i,n)}function a(t,e){return o(e[1],e[0])-o(t[1],t[0])}return t.prototype={_extractEventAttributes:function(t,n){var i={};i.center=e(n.targetTouches),i.pointers=[];for(var o=0;o<n.targetTouches.length;++o){var s=n.targetTouches[o];i.pointers.push({x:s.clientX,y:s.clientY})}return i.numTouches=n.targetTouches.length,i.rotation=0,i.scale=1,i.deltaScale=0,i.deltaRotation=0,t.center&&(i.deltaCenter={x:i.center.x-t.center.x,y:i.center.y-t.center.y}),2!==t.numTouches||2!==i.numTouches?i:(t.initialPointers?i.initialPointers=t.initialPointers:i.initialPointers=t.pointers,i.scale=r(i.initialPointers,i.pointers),i.deltaScale=i.scale-t.scale,i.rotation=a(i.initialPointers,i.pointers),i.deltaRotation=i.rotation-t.rotation,i)},_touchMove:function(t){t.preventDefault();var e=this._extractEventAttributes(this._touchState,t),n=4*-e.deltaScale;if(0!==n&&this._cam.zoom(n),2===e.numTouches&&2===this._touchState.numTouches){var i=.002*Math.tan(.5*this._cam.fieldOfViewY())*this._cam.zoom();this._cam.panXY(e.deltaCenter.x*i,e.deltaCenter.y*i)}var r=-e.deltaRotation;this._cam.rotateZ(r),1===e.numTouches&&1===this._touchState.numTouches&&(this._cam.rotateX(.005*e.deltaCenter.y),this._cam.rotateY(.005*e.deltaCenter.x)),this._viewer.requestRedraw(),this._touchState=e},_touchStart:function(t){if(t.preventDefault(),1===t.targetTouches.length){var e=(new Date).getTime();if(null!==this._lastSingleTap){var n=e-this._lastSingleTap;500>n&&this._viewer._mouseDoubleClick({clientX:t.targetTouches[0].clientX,clientY:t.targetTouches[0].clientY})}this._lastSingleTap=e}else this._lastSingleTap=null;this._touchState=this._extractEventAttributes(this._touchState,t)},_touchEnd:function(t){t.preventDefault()}},t}(),c=function(){function t(t,e,n,i){this._viewer=e,this._canvas=t,this._cam=n,this._canvas=t,this._animationTime=i,this._lastMouseUpTime=null,this._init()}return t.prototype={_centerOnClicked:function(t){null!==t&&this._viewer.setCenter(t.pos(),this._animationTime)},_mouseUp:function(t){var e=this._canvas,n=(new Date).getTime();if((null===this._lastMouseUpTime||n-this._lastMouseUpTime>300)&n-this._lastMouseDownTime<300){var i=this._canvas.domElement().getBoundingClientRect(),r=this._viewer.pick({x:t.clientX-i.left,y:t.clientY-i.top});this._viewer._dispatchEvent(t,"click",r)}this._lastMouseUpTime=n,e.removeEventListener("mousemove",this._mouseRotateListener),e.removeEventListener("mousemove",this._mousePanListener),e.removeEventListener("mouseup",this._mouseUpListener),document.removeEventListener("mouseup",this._mouseUpListener),document.removeEventListener("mousemove",this._mouseRotateListener),document.removeEventListener("mousemove",this._mousePanListener)},setCam:function(t){this._cam=t},_init:function(){return this._mousePanListener=i.bind(this,this._mousePan),this._mouseRotateListener=i.bind(this,this._mouseRotate),this._mouseUpListener=i.bind(this,this._mouseUp),this._canvas.onWheel(i.bind(this,this._mouseWheelFF),i.bind(this,this._mouseWheel)),this._canvas.on("dblclick",i.bind(this,this._mouseDoubleClick)),this._canvas.on("mousedown",i.bind(this,this._mouseDown)),!0},_mouseWheel:function(t){this._cam.zoom(t.wheelDelta<0?-1:1),t.preventDefault(),this._viewer.requestRedraw()},_mouseWheelFF:function(t){this._cam.zoom(t.deltaY<0?1:-1),t.preventDefault(),this._viewer.requestRedraw()},_mouseDoubleClick:function(){return function(t){var e=this._canvas.domElement().getBoundingClientRect(),n=this._viewer.pick({x:t.clientX-e.left,y:t.clientY-e.top});this._viewer._dispatchEvent(t,"doubleClick",n),this._viewer.requestRedraw()}}(),_mouseDown:function(t){0===t.button&&(this._lastMouseDownTime=(new Date).getTime(),t.preventDefault(),t.shiftKey===!0?(this._canvas.on("mousemove",this._mousePanListener),document.addEventListener("mousemove",this._mousePanListener,!1)):(this._canvas.on("mousemove",this._mouseRotateListener),document.addEventListener("mousemove",this._mouseRotateListener,!1)),this._canvas.on("mouseup",this._mouseUpListener),document.addEventListener("mouseup",this._mouseUpListener,!1),this._lastMousePos={x:t.pageX,y:t.pageY})},_mouseRotate:function(t){var e={x:t.pageX,y:t.pageY},n={x:e.x-this._lastMousePos.x,y:e.y-this._lastMousePos.y},i=.005;this._cam.rotateX(i*n.y),this._cam.rotateY(i*n.x),this._lastMousePos=e,this._viewer.requestRedraw()},_mousePan:function(t){var e={x:t.pageX,y:t.pageY},n={x:e.x-this._lastMousePos.x,y:e.y-this._lastMousePos.y},i=.002*Math.tan(.5*this._cam.fieldOfViewY())*this._cam.zoom();this._cam.panXY(i*n.x,i*n.y),this._lastMousePos=e,this._viewer.requestRedraw()}},t}(),h=function(){function e(t,e,n){return n?t*e:e*(t-1)+1}function n(t,n,i,r,a,s){a=a||!1,r=r||.5;var l=null,u=3*e(n,i,a);l=s?s.request(u):new Float32Array(u);var c,h,f,p=0,_=1/i,g=o.create(),m=o.create(),v=o.create(),y=o.create(),b=o.create(),x=o.create();for(o.set(y,t[0],t[1],t[2]),o.set(b,t[3],t[4],t[5]),a?(o.set(v,t[t.length-3],t[t.length-2],t[t.length-1]),o.sub(g,b,v),o.scale(g,g,r)):(o.set(v,t[0],t[1],t[2]),o.set(g,0,0,0)),c=1,f=n-1;f>c;++c){for(o.set(x,t[3*(c+1)],t[3*(c+1)+1],t[3*(c+1)+2]),o.sub(m,x,y),o.scale(m,m,r),h=0;i>h;++h)d(l,y,g,b,m,_*h,p),p+=3;o.copy(v,y),o.copy(y,b),o.copy(b,x),o.copy(g,m)}for(a?(o.set(x,t[0],t[1],t[3]),o.sub(m,x,y),o.scale(m,m,r)):o.set(m,0,0,0),h=0;i>h;++h)d(l,y,g,b,m,_*h,p),p+=3;if(!a)return l[p]=t[3*(n-1)+0],l[p+1]=t[3*(n-1)+1],l[p+2]=t[3*(n-1)+2],l;for(o.copy(v,y),o.copy(y,b),o.copy(b,x),o.copy(g,m),o.set(x,t[3],t[4],t[5]),o.sub(m,x,y),o.scale(m,m,r),h=0;i>h;++h)d(l,y,g,b,m,_*h,p),p+=3;return l}function i(t,e){this._center=t||o.create(),this._radius=e||1}function r(t,e){for(var n=new Float32Array(e*(t.length-1)+1),i=0,r=0,o=0,a=1/e,s=0;s<t.length-1;++s){r=t[s],o=t[s+1];for(var l=0;e>l;++l){var u=a*l;n[i+0]=r*(1-u)+o*u,i+=1}}return n[i+0]=o,n}var o=t.vec3,a=t.vec4,s=t.mat3,l=t.quat,u=function(){var t=o.create();return function(e,n,i){return o.cross(t,e,n),Math.atan2(o.dot(t,i),o.dot(e,n))}}(),c=function(){var t=o.create();return function(e,n){return o.copy(t,n),Math.abs(n[0])<Math.abs(n[1])?Math.abs(n[0])<Math.abs(n[2])?t[0]+=1:t[2]+=1:Math.abs(n[1])<Math.abs(n[2])?t[1]+=1:t[2]+=1,o.cross(e,n,t)}}(),h=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],l=o*o,u=o*a,c=o*s,h=a*a,d=a*s,f=s*s;return t[0]=l+r-l*r,t[1]=u-r*u-i*s,t[2]=c-r*c+i*a,t[3]=u-r*u+i*s,t[4]=h+r-r*h,t[5]=d-r*d-i*o,t[6]=c-r*c-i*a,t[7]=d-r*d+i*o,t[8]=f+r-r*f,t},d=function(){var t=o.create();return function(e,n,i,r,a,s,l){var u=s*s,c=3-2*s,h=u*c,d=1-h,f=u*(s-2)+s,p=u*(s-1);o.copy(t,n),o.scale(t,t,d),o.scaleAndAdd(t,t,i,f),o.scaleAndAdd(t,t,r,h),o.scaleAndAdd(t,t,a,p),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2]}}(),f=function(){var t=s.create(),e=s.create(),n=s.create(),i=s.create(),r=l.create(),u=o.create(),c=o.create();return function(h){for(var d=24,f=l.fromValues(0,0,0,1),p=0;d>p;++p){s.fromQuat(t,f);var _=s.transpose(n,t);s.mul(e,t,s.mul(i,h,_)),o.set(u,e[5],e[2],e[1]),o.set(c,Math.abs(u[0]),Math.abs(u[1]),Math.abs(u[2]));var g=c[0]>c[1]&&c[0]>c[2]?0:c[1]>c[2]?1:2,m=(g+1)%3,v=(g+2)%3;if(0===u[g])break;var y=(e[3*v+v]-e[3*m+m])/(2*u[g]),b=y>0?1:-1;y*=b;var x=y+(1e6>y?Math.sqrt(y*y+1):y),w=b/x,S=1/Math.sqrt(w*w+1);if(1===S)break;if(a.set(r,0,0,0,0),r[g]=b*Math.sqrt((1-S)/2),r[g]*=-1,r[3]=Math.sqrt(1-r[g]*r[g]),1===r[3])break;f=l.mul(f,f,r),l.normalize(f,f)}return f}}();i.prototype.center=function(){return this._center},i.prototype.radius=function(){return this._radius};var p=function(){return function(t,e,n,i,r){r?o.cross(i,e,n):c(i,e),o.cross(n,i,e),o.normalize(i,i),o.normalize(n,n),t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=i[0],t[4]=i[1],t[5]=i[2],t[6]=e[0],t[7]=e[1],t[8]=e[2]}}();return{signedAngle:u,axisRotation:h,ortho:c,diagonalizer:f,catmullRomSpline:n,cubicHermiteInterpolate:d,interpolateScalars:r,catmullRomSplineNumPoints:e,Sphere:i,buildRotation:p}}(),d=function(){function e(t,e){this._arcs=e,this._stacks=t,this._indices=new Uint16Array(3*e*t*2),this._verts=new Float32Array(3*e*t);var n,i,r=Math.PI/(t-1),o=2*Math.PI/e;for(n=0;n<this._stacks;++n){var a=Math.sin(n*r),s=Math.cos(n*r);for(i=0;i<this._arcs;++i){var l=a*Math.cos(i*o),u=a*Math.sin(i*o);this._verts[3*(i+n*this._arcs)]=l,this._verts[3*(i+n*this._arcs)+1]=u,this._verts[3*(i+n*this._arcs)+2]=s}}var c=0;for(n=0;n<this._stacks-1;++n)for(i=0;i<this._arcs;++i)this._indices[c]=n*this._arcs+i,this._indices[c+1]=n*this._arcs+(i+1)%this._arcs,this._indices[c+2]=(n+1)*this._arcs+i,c+=3,this._indices[c]=n*this._arcs+(i+1)%this._arcs,this._indices[c+1]=(n+1)*this._arcs+(i+1)%this._arcs,this._indices[c+2]=(n+1)*this._arcs+i,c+=3}function n(t,e,n){var i=h.catmullRomSpline(t,t.length/3,e,n,!0);this._indices=new Uint16Array(2*i.length),this._verts=i,this._normals=new Float32Array(i.length),this._arcs=i.length/3;for(var o=r.create(),a=0;a<this._arcs;++a){var s=0===a?this._arcs-1:a-1,l=a===this._arcs-1?0:a+1;o[0]=this._verts[3*l+1]-this._verts[3*s+1],o[1]=this._verts[3*s]-this._verts[3*l],r.normalize(o,o),this._normals[3*a]=o[0],this._normals[3*a+1]=o[1],this._normals[3*a+2]=o[2]}for(a=0;a<this._arcs;++a)this._indices[6*a]=a,this._indices[6*a+1]=a+this._arcs,this._indices[6*a+2]=(a+1)%this._arcs+this._arcs,this._indices[6*a+3]=a,this._indices[6*a+4]=(a+1)%this._arcs+this._arcs,this._indices[6*a+5]=(a+1)%this._arcs}function i(t){this._arcs=t,this._indices=new Uint16Array(3*t*2),this._verts=new Float32Array(3*t*2),this._normals=new Float32Array(3*t*2);for(var e=2*Math.PI/this._arcs,n=0;n<this._arcs;++n){var i=Math.cos(e*n),r=Math.sin(e*n);this._verts[3*n]=i,this._verts[3*n+1]=r,this._verts[3*n+2]=-.5,this._verts[3*t+3*n]=i,this._verts[3*t+3*n+1]=r,this._verts[3*t+3*n+2]=.5,this._normals[3*n]=i,this._normals[3*n+1]=r,this._normals[3*t+3*n]=i,this._normals[3*t+3*n+1]=r}for(n=0;n<this._arcs;++n)this._indices[6*n]=n%this._arcs,this._indices[6*n+1]=t+(n+1)%this._arcs,this._indices[6*n+2]=(n+1)%this._arcs,this._indices[6*n+3]=n%this._arcs,this._indices[6*n+4]=t+n%this._arcs,this._indices[6*n+5]=t+(n+1)%this._arcs}var r=t.vec3;return e.prototype={addTransformed:function(){var t=r.create(),e=r.create();return function(n,i,o,a,s){for(var l=n.numVerts(),u=0;u<this._stacks*this._arcs;++u)r.set(e,this._verts[3*u],this._verts[3*u+1],this._verts[3*u+2]),r.copy(t,e),r.scale(t,t,o),r.add(t,t,i),n.addVertex(t,e,a,s);for(u=0;u<this._indices.length/3;++u)n.addTriangle(l+this._indices[3*u],l+this._indices[3*u+1],l+this._indices[3*u+2])}}(),numIndices:function(){return this._indices.length},numVerts:function(){return this._verts.length/3}},n.prototype={addTransformed:function(){var t=r.create(),e=r.create();return function(n,i,o,a,s,l,u,c){for(var h=this._arcs,d=this._normals,f=this._verts,p=n.numVerts()-h,_=0;h>_;++_)r.set(t,o*f[3*_],o*f[3*_+1],0),r.transformMat3(t,t,a),r.add(t,t,i),r.set(e,d[3*_],d[3*_+1],0),r.transformMat3(e,e,a),n.addVertex(t,e,s,c);if(!l)if(0!==u)for(_=0;h>_;++_)n.addTriangle(p+(_+u)%h,p+_+h,p+(_+1)%h+h),n.addTriangle(p+(_+u)%h,p+(_+1)%h+h,p+(_+1+u)%h);else for(_=0;_<this._indices.length/3;++_)n.addTriangle(p+this._indices[3*_],p+this._indices[3*_+1],p+this._indices[3*_+2])}}()},i.prototype={numVerts:function(){return this._verts.length/3},numIndices:function(){return this._indices.length},addTransformed:function(){var t=r.create(),e=r.create();return function(n,i,o,a,s,l,u,c,h){for(var d=n.numVerts(),f=this._verts,p=this._normals,_=this._arcs,g=0;2*_>g;++g){r.set(t,a*f[3*g],a*f[3*g+1],o*f[3*g+2]),r.transformMat3(t,t,s),r.add(t,t,i),r.set(e,p[3*g],p[3*g+1],p[3*g+2]),r.transformMat3(e,e,s);var m=_>g?c:h;n.addVertex(t,e,_>g?l:u,m)}var v=this._indices;for(g=0;g<v.length/3;++g)n.addTriangle(d+v[3*g],d+v[3*g+1],d+v[3*g+2])}}()},{TubeProfile:n,ProtoCylinder:i,ProtoSphere:e}}(),f=G=function(){function t(t){this._children=[],this._visible=!0,this._name=name||"",this._gl=t,this._order=1}return t.prototype={order:function(t){return void 0!==t&&(this._order=t),this._order},add:function(t){this._children.push(t)},draw:function(t,e,n,i){for(var r=0,o=this._children.length;r!==o;++r)this._children[r].draw(t,e,n,i)},show:function(){this._visible=!0},hide:function(){this._visible=!1},name:function(t){return void 0!==t&&(this._name=t),this._name},destroy:function(){for(var t=0;t<this._children.length;++t)this._children[t].destroy()},visible:function(){return this._visible}},t}(),p=V=function(){function e(t,e){t.eachResidue(function(t){var n=t.centralAtom();null!==n&&e(n,n.pos())})}function n(t){G.call(this,t),this._idRanges=[],this._vertAssocs=[],this._showRelated=null,this._selection=null}var r=t.vec3,o=function(){var t=r.create();return function(e,n,i){for(var o=0;o<n.length;++o)for(var a=n[o],s=e.chainsByName(a.chains()),l=0;l<a.matrices().length;++l)for(var u=a.matrix(l),c=0;c<s.length;++c)for(var h=s[c],d=0;d<h.residues().length;++d){var f=h.residues()[d].centralAtom();null!==f&&(r.transformMat4(t,f.pos(),u),i(f,t))}}}();return i.derive(n,G,{setShowRelated:function(t){return t&&"asym"!==t&&null===this.structure().assembly(t)?void console.error("no assembly with name",t,". Falling back to asymmetric unit"):(this._showRelated=t,t)},symWithIndex:function(t){if("asym"===this.showRelated())return null;var e=this.structure().assembly(this.showRelated());if(!e)return null;for(var n=e.generators(),i=0;i<n.length;++i){if(n[i].matrices().length>t)return n[i].matrix(t);t-=n[i].matrices().length}return null},showRelated:function(){return this._showRelated},select:function(t){return this.structure().select(t)},structure:function(){return this._vertAssocs[0]._structure},getColorForAtom:function(t,e){return this._vertAssocs[0].getColorForAtom(t,e)},addIdRange:function(t){this._idRanges.push(t)},destroy:function(){G.prototype.destroy.call(this);for(var t=0;t<this._idRanges.length;++t)this._idRanges[t].recycle()},eachCentralAtom:function(t){var n=this,i=n.structure(),r=i.assembly(n.showRelated());return null===r?e(i,t):o(i,r.generators(),t)},addVertAssoc:function(t){this._vertAssocs.push(t)},_vertArraysInvolving:function(t){for(var e=this.vertArrays(),n=[],i={},r=0;r<t.length;++r)i[t[r]]=!0;for(var o=0;o<e.length;++o)i[e[o].chain()]===!0&&n.push(e[o]);
return n},_drawSymmetryRelated:function(t,e,n){for(var i=n.generators(),r=0;r<i.length;++r){var o=i[r],a=this._vertArraysInvolving(o.chains());this._drawVertArrays(t,e,a,o.matrices())}},_updateProjectionIntervalsAsym:function(t,e,n,i,r,o){for(var a=this.vertArrays(),s=0;s<a.length;++s)a[s].updateProjectionIntervals(t,e,n,i,r,o)},updateProjectionIntervals:function(t,e,n,i,r,o){if(this._visible){var a=this.showRelated();if("asym"===a)return this._updateProjectionIntervalsAsym(t,e,n,i,r,o);for(var s=this.structure().assembly(a),l=s.generators(),u=0;u<l.length;++u)for(var c=l[u],h=this._vertArraysInvolving(c.chains()),d=0;d<c.matrices().length;++d)for(var f=0;f<h.length;++f){var p=c.matrix(d);h[f].updateProjectionIntervals(t,e,n,i,r,o,p)}}},_updateSquaredSphereRadiusAsym:function(t,e){for(var n=this.vertArrays(),i=0;i<n.length;++i)e=n[i].updateSquaredSphereRadius(t,e);return e},updateSquaredSphereRadius:function(t,e){if(!this._visible)return e;var n=this.showRelated();if("asym"===n)return this._updateSquaredSphereRadiusAsym(t,e);for(var i=this.structure().assembly(n),r=i.generators(),o=0;o<r.length;++o)for(var a=r[o],s=this._vertArraysInvolving(a.chains()),l=0;l<a.matrices().length;++l)for(var u=0;u<s.length;++u)e=s[u].updateSquaredSphereRadius(t,e);return e},draw:function(t,e,n,i){if(this._visible){var r=this.shaderForStyleAndPass(e,n,i);if(r){var o=this.showRelated();if("asym"===o)return this._drawVertArrays(t,r,this.vertArrays(),null);var a=this.structure().assembly(o);return this._drawSymmetryRelated(t,r,a)}}},colorBy:function(t,e){console.time("BaseGeom.colorBy"),this._ready=!1,e=e||this.structure();for(var n=0;n<this._vertAssocs.length;++n)this._vertAssocs[n].recolor(t,e);console.timeEnd("BaseGeom.colorBy")},setOpacity:function(t,e){console.time("BaseGeom.setOpacity"),this._ready=!1,e=e||this.structure();for(var n=0;n<this._vertAssocs.length;++n)this._vertAssocs[n].setOpacity(t,e);console.timeEnd("BaseGeom.setOpacity")},setSelection:function(t){console.time("BaseGeom.setSelection"),this._selection=t,this._ready=!1;for(var e=0;e<this._vertAssocs.length;++e)this._vertAssocs[e].setSelection(t);console.timeEnd("BaseGeom.setSelection")},selection:function(){return null===this._selection&&(this._selection=this.structure().createEmptyView()),this._selection}}),n}(),_=j=function(){function e(t,e,n){this._gl=t,this._vertBuffer=t.createBuffer(),this._float32Allocator=n||null,this._ready=!1,this._boundingSphere=null;var i=this._FLOATS_PER_VERT*e;this._vertData=n.request(i)}var n=t.vec3;return e.prototype={setColor:function(t,e,n,i,r){var o=t*this._FLOATS_PER_VERT+this._COLOR_OFFSET;this._vertData[o+0]=e,this._vertData[o+1]=n,this._vertData[o+2]=i,this._vertData[o+3]=r,this._ready=!1},getColor:function(t,e){var n=t*this._FLOATS_PER_VERT+this._COLOR_OFFSET;return e[0]=this._vertData[n+0],e[1]=this._vertData[n+1],e[2]=this._vertData[n+2],e[3]=this._vertData[n+3],e},setOpacity:function(t,e){var n=t*this._FLOATS_PER_VERT+this._COLOR_OFFSET;this._vertData[n+3]=e,this._ready=!1},setSelected:function(t,e){var n=t*this._FLOATS_PER_VERT+this._SELECT_OFFSET;this._vertData[n]=e,this._ready=!1},boundingSphere:function(){return this._boundingSphere||(this._boundingSphere=this._calculateBoundingSphere()),this._boundingSphere},_calculateBoundingSphere:function(){var t=this.numVerts();if(0===t)return null;var e,i,r=n.create();for(i=0;t>i;++i)e=i*this._FLOATS_PER_VERT,r[0]+=this._vertData[e+0],r[1]+=this._vertData[e+1],r[2]+=this._vertData[e+2];n.scale(r,r,1/t);var o=0;for(i=0;t>i;++i){e=i*this._FLOATS_PER_VERT;var a=r[0]-this._vertData[e+0],s=r[1]-this._vertData[e+1],l=r[2]-this._vertData[e+2];o=Math.max(o,a*a+s*s+l*l)}return new h.Sphere(r,Math.sqrt(o))},destroy:function(){this._gl.deleteBuffer(this._vertBuffer),this._float32Allocator.release(this._vertData)},bindBuffers:function(){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._vertBuffer),this._ready||(this._gl.bufferData(this._gl.ARRAY_BUFFER,this._vertData,this._gl.STATIC_DRAW),this._ready=!0)},updateSquaredSphereRadius:function(){var t=n.create();return function(e,i,r){var o=this.boundingSphere();if(!o)return i;if(r)return n.transformMat4(t,o.center(),r),Math.max(n.sqrDist(t,e),i);var a=o.radius()*o.radius();return Math.max(n.sqrDist(o.center(),e)+a,i)}}(),updateProjectionIntervals:function(){var t=n.create();return function(e,i,r,o,a,s,l){var u=this.boundingSphere();if(u){l?n.transformMat4(t,u.center(),l):n.copy(t,u.center());var c=n.dot(e,t),h=n.dot(i,t),d=n.dot(r,t);o.update(c-u.radius()),o.update(c+u.radius()),a.update(h-u.radius()),a.update(h+u.radius()),s.update(d-u.radius()),s.update(d+u.radius())}}}()},e}(),g=function(){function t(t,e,n){j.call(this,t,e,n),this._numVerts=0,this._primitiveType=this._gl.LINES}return i.derive(t,j,{_FLOATS_PER_VERT:9,_POS_OFFSET:0,_COLOR_OFFSET:3,_ID_OFFSET:7,_SELECT_OFFSET:8,numVerts:function(){return this._numVerts},setDrawAsPoints:function(t){t?this._primitiveType=this._gl.POINTS:this._primitiveType=this._gl.LINES},addPoint:function(t,e,n){var i=this._FLOATS_PER_VERT*this._numVerts;this._vertData[i++]=t[0],this._vertData[i++]=t[1],this._vertData[i++]=t[2],this._vertData[i++]=e[0],this._vertData[i++]=e[1],this._vertData[i++]=e[2],this._vertData[i++]=e[3],this._vertData[i++]=n,this._vertData[i++]=0,this._numVerts+=1,this._ready=!1,this._boundingSphere=null},addLine:function(t,e,n,i,r,o){this.addPoint(t,e,r),this.addPoint(n,i,o)},bindAttribs:function(t){this._gl.vertexAttribPointer(t.posAttrib,3,this._gl.FLOAT,!1,4*this._FLOATS_PER_VERT,4*this._POS_OFFSET),-1!==t.colorAttrib&&(this._gl.vertexAttribPointer(t.colorAttrib,4,this._gl.FLOAT,!1,4*this._FLOATS_PER_VERT,4*this._COLOR_OFFSET),this._gl.enableVertexAttribArray(t.colorAttrib)),this._gl.enableVertexAttribArray(t.posAttrib),-1!==t.objIdAttrib&&(this._gl.vertexAttribPointer(t.objIdAttrib,1,this._gl.FLOAT,!1,4*this._FLOATS_PER_VERT,4*this._ID_OFFSET),this._gl.enableVertexAttribArray(t.objIdAttrib)),-1!==t.selectAttrib&&(this._gl.vertexAttribPointer(t.selectAttrib,1,this._gl.FLOAT,!1,4*this._FLOATS_PER_VERT,4*this._SELECT_OFFSET),this._gl.enableVertexAttribArray(t.selectAttrib))},releaseAttribs:function(t){this._gl.disableVertexAttribArray(t.posAttrib),-1!==t.colorAttrib&&this._gl.disableVertexAttribArray(t.colorAttrib),-1!==t.objIdAttrib&&this._gl.disableVertexAttribArray(t.objIdAttrib),-1!==t.selectAttrib&&this._gl.disableVertexAttribArray(t.selectAttrib)},bind:function(t){this.bindBuffers(),this.bindAttribs(t)},draw:function(){this._gl.drawArrays(this._primitiveType,0,this._numVerts)}}),t}(),m=U=function(){function t(t,e,n,i,r){j.call(this,t,e,i),this._indexBuffer=t.createBuffer(),this._uint16Allocator=r,this._numVerts=0,this._maxVerts=e,this._numTriangles=0,this._indexData=r.request(n)}return i.derive(t,j,{destroy:function(){j.prototype.destroy.call(this),this._gl.deleteBuffer(this._indexBuffer),this._uint16Allocator.release(this._indexData)},setIndexData:function(t){this._ready=!1,this._numTriangles=t.length/3;for(var e=0;e<t.length;++e)this._indexData[e]=t[e]},setVertData:function(t){this._ready=!1,this._numVerts=t.length/this._FLOATS_PER_VERT;for(var e=0;e<t.length;++e)this._vertData[e]=t[e]},numVerts:function(){return this._numVerts},maxVerts:function(){return this._maxVerts},numIndices:function(){return 3*this._numTriangles},addVertex:function(t,e,n,i){if(this._numVerts===this._maxVerts)return void console.error("maximum number of vertices reached");var r=this._numVerts*this._FLOATS_PER_VERT;this._vertData[r++]=t[0],this._vertData[r++]=t[1],this._vertData[r++]=t[2],this._vertData[r++]=e[0],this._vertData[r++]=e[1],this._vertData[r++]=e[2],this._vertData[r++]=n[0],this._vertData[r++]=n[1],this._vertData[r++]=n[2],this._vertData[r++]=n[3],this._vertData[r++]=i,this._vertData[r++]=0,this._numVerts+=1,this._ready=!1},_FLOATS_PER_VERT:12,_BYTES_PER_VERT:48,_OBJID_OFFSET:10,_OBJID_BYTE_OFFSET:40,_SELECT_OFFSET:11,_SELECT_BYTE_OFFSET:44,_COLOR_OFFSET:6,_COLOR_BYTE_OFFSET:24,_NORMAL_OFFSET:3,_NORMAL_BYTE_OFFSET:12,_POS_OFFSET:0,_POS_BYTE_OFFSET:0,addTriangle:function(t,e,n){var i=3*this._numTriangles;i+2>=this._indexData.length||(this._indexData[i++]=t,this._indexData[i++]=e,this._indexData[i++]=n,this._numTriangles+=1,this._ready=!1)},bindBuffers:function(){var t=this._ready,e=this._gl;j.prototype.bindBuffers.call(this),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t||e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indexData,e.STATIC_DRAW)},bindAttribs:function(t){var e=this._gl,n=this._BYTES_PER_VERT;e.enableVertexAttribArray(t.posAttrib),e.vertexAttribPointer(t.posAttrib,3,e.FLOAT,!1,n,this._POS_BYTE_OFFSET),-1!==t.normalAttrib&&(e.enableVertexAttribArray(t.normalAttrib),e.vertexAttribPointer(t.normalAttrib,3,e.FLOAT,!1,n,this._NORMAL_BYTE_OFFSET)),-1!==t.colorAttrib&&(e.vertexAttribPointer(t.colorAttrib,4,e.FLOAT,!1,n,this._COLOR_BYTE_OFFSET),e.enableVertexAttribArray(t.colorAttrib)),-1!==t.objIdAttrib&&(e.vertexAttribPointer(t.objIdAttrib,1,e.FLOAT,!1,n,this._OBJID_BYTE_OFFSET),e.enableVertexAttribArray(t.objIdAttrib)),-1!==t.selectAttrib&&(e.vertexAttribPointer(t.selectAttrib,1,e.FLOAT,!1,n,this._SELECT_BYTE_OFFSET),e.enableVertexAttribArray(t.selectAttrib))},releaseAttribs:function(t){var e=this._gl;e.disableVertexAttribArray(t.posAttrib),-1!==t.colorAttrib&&e.disableVertexAttribArray(t.colorAttrib),-1!==t.normalAttrib&&e.disableVertexAttribArray(t.normalAttrib),-1!==t.objIdAttrib&&e.disableVertexAttribArray(t.objIdAttrib),-1!==t.selectAttrib&&e.disableVertexAttribArray(t.selectAttrib)},bind:function(t){this.bindBuffers(),this.bindAttribs(t)},draw:function(){var t=this._gl;t.drawElements(t.TRIANGLES,3*this._numTriangles,t.UNSIGNED_SHORT,0)}}),t}(),v=function(t){function e(e,n,i,r){t.call(this,n,i,r),this._chain=e}function n(t,e,n,i,r,o){U.call(this,e,n,i,r,o),this._chain=t}return i.derive(e,t,{chain:function(){return this._chain},drawSymmetryRelated:function(t,e,n){this.bind(e);for(var i=0;i<n.length;++i)t.bind(e,n[i]),this._gl.uniform1i(e.symId,i),this.draw();this.releaseAttribs(e)}}),i.derive(n,U,{chain:function(){return this._chain}}),n.prototype.drawSymmetryRelated=e.prototype.drawSymmetryRelated,{LineChainData:e,MeshChainData:n}}(g),y=function(t,e){function n(t,e,n){V.call(this,t),this._indexedVAs=[],this._float32Allocator=e,this._uint16Allocator=n,this._remainingVerts=null,this._remainingIndices=null}var r=t.MeshChainData;return i.derive(n,V,{_boundedVertArraySize:function(t){return Math.min(65536,t)},addChainVertArray:function(t,e,n){this._remainingVerts=e,this._remainingIndices=n;var i=new r(t.name(),this._gl,this._boundedVertArraySize(e),n,this._float32Allocator,this._uint16Allocator);return this._indexedVAs.push(i),i},addVertArray:function(t,n){this._remainingVerts=t,this._remainingIndices=n;var i=new e(this._gl,this._boundedVertArraySize(t),n,this._float32Allocator,this._uint16Allocator);return this._indexedVAs.push(i),i},vertArrayWithSpaceFor:function(t){var n=this._indexedVAs[this._indexedVAs.length-1],i=n.maxVerts()-n.numVerts();if(i>=t)return n;this._remainingVerts-=n.numVerts(),this._remainingIndices-=n.numIndices(),t=this._boundedVertArraySize(this._remainingVerts);var o=null;return o=n instanceof r?new r(n.chain(),this._gl,t,this._remainingIndices,this._float32Allocator,this._uint16Allocator):new e(this._gl,t,this._remainingIndices,this._float32Allocator,this._uint16Allocator),this._indexedVAs.push(o),o},vertArray:function(t){return this._indexedVAs[t]},destroy:function(){V.prototype.destroy.call(this);for(var t=0;t<this._indexedVAs.length;++t)this._indexedVAs[t].destroy();this._indexedVAs=[]},numVerts:function(){return this._indexedVAs[0].numVerts()},shaderForStyleAndPass:function(t,e,n){if("normal"===n)return"hemilight"===e?t.hemilight:t.phong;if("select"===n)return t.select;if("outline"===n)return t.outline;var i=t[n];return void 0!==i?i:null},_drawVertArrays:function(t,e,n,i){var r;if(i)for(r=0;r<n.length;++r)n[r].drawSymmetryRelated(t,e,i);else for(t.bind(e),this._gl.uniform1i(e.symId,255),r=0;r<n.length;++r)n[r].bind(e),n[r].draw(),n[r].releaseAttribs(e)},vertArrays:function(){return this._indexedVAs},addVertex:function(t,e,n,i){var r=this._indexedVAs[0];r.addVertex(t,e,n,i)},addTriangle:function(t,e,n){var i=this._indexedVAs[0];i.addTriangle(t,e,n)}}),n}(v,m),b=function(t){function e(t,e){V.call(this,t),this._vertArrays=[],this._float32Allocator=e,this._lineWidth=.5,this._pointSize=1}var n=t.LineChainData;return i.derive(e,V,{addChainVertArray:function(t,e){var i=new n(t.name(),this._gl,e,this._float32Allocator);return this._vertArrays.push(i),i},setLineWidth:function(t){this._lineWidth=t},setPointSize:function(t){this._pointSize=t},vertArrays:function(){return this._vertArrays},shaderForStyleAndPass:function(t,e,n){return"outline"===n?t.selectLines:"select"===n?t.select:t.lines},destroy:function(){V.prototype.destroy.call(this);for(var t=0;t<this._vertArrays.length;++t)this._vertArrays[t].destroy();this._vertArrays=[]},_drawVertArrays:function(t,e,n,i){var r=t.upsamplingFactor();-1!==e.selectAttrib&&(r=4*t.upsamplingFactor());var o;if(i)for(t.bind(e),this._gl.lineWidth(r*this._lineWidth),e.pointSize&&this._gl.uniform1f(e.pointSize,r*this._pointSize),o=0;o<n.length;++o)n[o].drawSymmetryRelated(t,e,i);else for(t.bind(e),this._gl.lineWidth(r*this._lineWidth),this._gl.uniform1i(e.symId,255),e.pointSize&&this._gl.uniform1f(e.pointSize,r*this._pointSize),o=0;o<n.length;++o)n[o].bind(e),n[o].draw(),n[o].releaseAttribs(e)},vertArray:function(){return this._va}}),e}(v),x=function(){function t(t,e){this._structure=t,this._assocs=[],this._callBeginEnd=e}function n(t,e,n){this._structure=t,this._assocs=[],this._callBeginEnd=n,this._interpolation=e||1,this._perResidueColors={}}return t.prototype={addAssoc:function(t,e,n,i){this._assocs.push({atom:t,vertexArray:e,vertStart:n,vertEnd:i})},recolor:function(t,e){var n=new Float32Array(4*e.atomCount());this._callBeginEnd&&t.begin(this._structure);var i={};e.eachAtom(function(e,r){i[e.index()]=r,t.colorFor(e,n,4*r)}),this._callBeginEnd&&t.end(this._structure);for(var r=0;r<this._assocs.length;++r){var o=this._assocs[r],a=i[o.atom.index()];if(void 0!==a)for(var s=n[4*a+0],l=n[4*a+1],u=n[4*a+2],c=n[4*a+3],h=o.vertexArray,d=o.vertStart;d<o.vertEnd;++d)h.setColor(d,s,l,u,c)}},getColorForAtom:function(t,e){for(var n=0;n<this._assocs.length;++n){var i=this._assocs[n];if(i.atom.full()===t.full())return i.vertexArray.getColor(i.vertStart,e)}return null},setSelection:function(t){var e={};t.eachAtom(function(t){e[t.index()]=!0});for(var n=0;n<this._assocs.length;++n)for(var i=this._assocs[n],r=e[i.atom.index()],o=r!==!0?0:1,a=i.vertexArray,s=i.vertStart;s<i.vertEnd;++s)a.setSelected(s,o)},setOpacity:function(t,e){var n={};e.eachAtom(function(t){n[t.index()]=!0});for(var i=0;i<this._assocs.length;++i){var r=this._assocs[i],o=n[r.atom.index()];if(o===!0)for(var a=r.vertexArray,s=r.vertStart;s<r.vertEnd;++s)a.setOpacity(s,t)}}},n.prototype={setPerResidueColors:function(t,e){this._perResidueColors[t]=e},addAssoc:function(t,e,n,i,r){this._assocs.push({traceIndex:t,slice:n,vertStart:i,vertEnd:r,vertexArray:e})},recolor:function(t,n){this._callBeginEnd&&t.begin(this._structure);var i,r,o=[],a=this._structure.backboneTraces();for(console.assert(this._perResidueColors,"per-residue colors must be set for recoloring to work"),i=0;i<a.length;++i){var s=this._perResidueColors[i];console.assert(s,"no per-residue colors. Seriously, man?");var l=0,u=a[i];for(r=0;r<u.length();++r)n.containsResidue(u.residueAt(r))?(t.colorFor(u.centralAtomAt(r),s,l),l+=4):l+=4;this._interpolation>1?o.push(e.interpolateColor(s,this._interpolation)):o.push(s)}for(i=0;i<this._assocs.length;++i){var c=this._assocs[i],h=c.slice,d=o[c.traceIndex],f=d[4*h],p=d[4*h+1],_=d[4*h+2],g=d[4*h+3],m=c.vertexArray;for(r=c.vertStart;r<c.vertEnd;++r)m.setColor(r,f,p,_,g)}this._callBeginEnd&&t.end(this._structure)},getColorForAtom:function(t,e){var n,i,r=this._structure.backboneTraces(),o=t.full().residue();for(n=0;n<r.length;++n){var a=this._perResidueColors[n],s=0,l=r[n];for(i=0;i<l.length();++i){if(o===l.residueAt(i).full())return e[0]=a[s+0],e[1]=a[s+1],e[2]=a[s+2],e[3]=a[s+3],e;s+=4}}return null},setSelection:function(t){var e,n,i=[],r=this._structure.backboneTraces();for(e=0;e<r.length;++e){var o=new Float32Array(this._perResidueColors[e].length),a=0,s=r[e];for(n=0;n<s.length();++n){var l=t.containsResidue(s.residueAt(n))?1:0;o[a]=l,a+=1}this._interpolation>1?i.push(h.interpolateScalars(o,this._interpolation)):i.push(o)}for(e=0;e<this._assocs.length;++e){var u=this._assocs[e],c=u.slice,d=i[u.traceIndex],f=d[c],p=u.vertexArray;for(n=u.vertStart;n<u.vertEnd;++n)p.setSelected(n,f)}},setOpacity:function(t,n){var i,r,o=[],a=this._structure.backboneTraces();for(i=0;i<a.length;++i){var s=this._perResidueColors[i],l=0,u=a[i];for(r=0;r<u.length();++r)n.containsResidue(u.residueAt(r))?(s[l+3]=t,l+=4):l+=4;this._interpolation>1?o.push(e.interpolateColor(s,this._interpolation)):o.push(s)}for(i=0;i<this._assocs.length;++i){var c=this._assocs[i],h=c.slice,d=o[c.traceIndex],f=d[4*h+3],p=c.vertexArray;for(r=c.vertStart;r<c.vertEnd;++r)p.setOpacity(r,f)}}},{TraceVertexAssoc:n,AtomVertexAssoc:t}}(),w=function(n,i,r,o){function a(t,e,n){for(var i=0;n-1>i;++i)t.addTriangle(e,e+1+i,e+2+i);t.addTriangle(e,e+n,e+1)}function s(t,e,n){for(var i=e+n,r=0;n-1>r;++r)t.addTriangle(i,e+r+1,e+r);t.addTriangle(i,e,e+n-1)}var l=t.vec3,u=t.vec4,c=t.mat3,d=n.TubeProfile,f=n.ProtoSphere,p=n.ProtoCylinder,_=o.TraceVertexAssoc,g=o.AtomVertexAssoc,m=e.interpolateColor,v={},y=.7071,b=[-y,-y,0,y,-y,0,y,y,0,-y,y,0],x=[-6*y,-.9*y,0,-5.8*y,-1*y,0,5.8*y,-1*y,0,6*y,-.9*y,0,6*y,.9*y,0,5.8*y,1*y,0,-5.8*y,1*y,0,-6*y,.9*y,0],w=[-10*y,-.9*y,0,-9.8*y,-1*y,0,9.8*y,-1*y,0,10*y,-.9*y,0,10*y,.9*y,0,9.8*y,1*y,0,-9.8*y,1*y,0,-10*y,.9*y,0],S=function(){var t=l.create(),e=l.create(),n=l.create();return function(i,r,o,a){r=Math.max(r,1),o=Math.min(a-1,o);var s=3*(r-1);l.set(t,i[s],i[s+1],i[s+2]),l.set(n,i[3*r],i[3*r+1],i[3*r+2]);for(var u=r;o>u;++u)s=3*(u+1),l.set(e,i[s],i[s+1],i[s+2]),i[3*u+0]=.25*e[0]+.5*n[0]+.25*t[0],i[3*u+1]=.25*e[1]+.5*n[1]+.25*t[1],i[3*u+2]=.25*e[2]+.5*n[2]+.25*t[2],l.copy(t,n),l.copy(n,e)}}(),A=function(){var t=u.fromValues(0,0,0,1);return function(e,n,i,r){var o=r.atomCount(),a=i.idPool.getContinuousRange(o);e.addIdRange(a);var s=i.protoSphere.numVerts(),l=i.protoSphere.numIndices(),u=1.5*i.radiusMultiplier;e.addChainVertArray(r,s*o,l*o),r.eachAtom(function(r){var o=e.vertArrayWithSpaceFor(s);i.color.colorFor(r,t,0);var l=o.numVerts(),c=a.nextId({geom:e,atom:r});i.protoSphere.addTransformed(o,r.pos(),u,t,c);var h=o.numVerts();n.addAssoc(r,o,l,h)})}}();v.spheres=function(t,e,n){console.time("spheres");var r=new f(n.sphereDetail,n.sphereDetail);n.protoSphere=r;var o=new i(e,n.float32Allocator,n.uint16Allocator),a=new g(t,!0);return o.addVertAssoc(a),o.setShowRelated(n.showRelated),n.color.begin(t),t.eachChain(function(t){A(o,a,n,t)}),n.color.end(t),console.timeEnd("spheres"),o};var k=function(){var t=l.create(),e=l.create(),n=u.fromValues(0,0,0,1),i=l.create(),r=l.create(),o=c.create();return function(a,s,u,c){var d=c.atomCount(),f=0;c.eachAtom(function(t){f+=t.bonds().length});var p=d*u.protoSphere.numVerts()+f*u.protoCyl.numVerts(),_=d*u.protoSphere.numIndices()+f*u.protoCyl.numIndices();a.addChainVertArray(c,p,_);var g=u.idPool.getContinuousRange(d);a.addIdRange(g),c.eachAtom(function(c){var d=u.protoSphere.numVerts()+c.bondCount()*u.protoCyl.numVerts(),f=a.vertArrayWithSpaceFor(d),p=f.numVerts(),_=g.nextId({geom:a,atom:c});u.color.colorFor(c,n,0),u.protoSphere.addTransformed(f,c.pos(),u.radius,n,_),c.eachBond(function(a){a.mid_point(t),l.sub(e,c.pos(),t);var s=l.length(e);l.scale(e,e,1/s),h.buildRotation(o,e,i,r,!1),l.add(t,t,c.pos()),l.scale(t,t,.5),u.protoCyl.addTransformed(f,t,s,u.radius,o,n,n,_,_)});var m=f.numVerts();s.addAssoc(c,f,p,m)})}}();v.ballsAndSticks=function(t,e,n){console.time("ballsAndSticks");var r=new g(t,!0),o=new f(n.sphereDetail,n.sphereDetail),a=new p(n.arcDetail);n.protoSphere=o,n.protoCyl=a;var s=new i(e,n.float32Allocator,n.uint16Allocator);return s.addVertAssoc(r),s.setShowRelated(n.showRelated),n.color.begin(t),t.eachChain(function(t){k(s,r,n,t)}),n.color.end(t),console.timeEnd("ballsAndSticks"),s};var C=function(){var t=u.fromValues(0,0,0,1);return function(e,n,i,r){var o=i.atomCount(),a=r.idPool.getContinuousRange(o);e.addIdRange(a);var s=e.addChainVertArray(i,o);s.setDrawAsPoints(!0),i.eachAtom(function(i){var o=s.numVerts();r.color.colorFor(i,t,0);var l=a.nextId({geom:e,atom:i});s.addPoint(i.pos(),t,l);var u=s.numVerts();n.addAssoc(i,s,o,u)})}}();v.points=function(t,e,n){console.time("points");var i=new g(t,!0);n.color.begin(t);var o=new r(e,n.float32Allocator);return o.setPointSize(n.pointSize),o.addVertAssoc(i),o.setShowRelated(n.showRelated),t.eachChain(function(t){C(o,i,t,n)}),n.color.end(t),console.timeEnd("points"),o};var T=function(){var t=l.create(),e=u.fromValues(0,0,0,1);return function(n,i,r,o){var a=0,s=r.atomCount(),l=o.idPool.getContinuousRange(s);n.addIdRange(l),r.eachAtom(function(t){var e=t.bonds().length;a+=e?e:3});var u=n.addChainVertArray(r,2*a);r.eachAtom(function(r){var a=u.numVerts(),s=l.nextId({geom:n,atom:r});if(r.bonds().length)r.eachBond(function(n){n.mid_point(t),o.color.colorFor(r,e,0),u.addLine(r.pos(),e,t,e,s,s)});else{var c=.2,h=r.pos();o.color.colorFor(r,e,0),u.addLine([h[0]-c,h[1],h[2]],e,[h[0]+c,h[1],h[2]],e,s,s),u.addLine([h[0],h[1]-c,h[2]],e,[h[0],h[1]+c,h[2]],e,s,s),u.addLine([h[0],h[1],h[2]-c],e,[h[0],h[1],h[2]+c],e,s,s)}var d=u.numVerts();i.addAssoc(r,u,a,d)})}}();v.lines=function(t,e,n){console.time("lines");var i=new g(t,!0);n.color.begin(t);var o=new r(e,n.float32Allocator);return o.setLineWidth(n.lineWidth),o.addVertAssoc(i),o.setShowRelated(n.showRelated),t.eachChain(function(t){T(o,i,t,n)}),n.color.end(t),console.timeEnd("lines"),o};var E=function(t){for(var e=0,n=0;n<t.length;++n)e+=2*(t[n].length()-1);return e},M=function(){var t=u.fromValues(0,0,0,1),e=u.fromValues(0,0,0,1),n=l.create(),i=l.create();return function(r,o,a,s,l,u){o.addAssoc(s,a,0,a.numVerts(),a.numVerts()+1);var c=u.float32Allocator.request(4*l.length()),h=u.idPool.getContinuousRange(l.length());r.addIdRange(h);for(var d,f=h.nextId({geom:r,atom:l.centralAtomAt(0)}),p=1;p<l.length();++p){u.color.colorFor(l.centralAtomAt(p-1),t,0),c[4*(p-1)+0]=t[0],c[4*(p-1)+1]=t[1],c[4*(p-1)+2]=t[2],c[4*(p-1)+3]=t[3],u.color.colorFor(l.centralAtomAt(p),e,0),l.posAt(n,p-1),l.posAt(i,p),d=h.nextId({geom:r,atom:l.centralAtomAt(p)}),a.addLine(n,t,i,e,f,d),f=d,d=null;var _=a.numVerts();o.addAssoc(s,a,p,_-1,_+(p===l.length()-1?0:1))}return c[4*l.length()-4]=e[0],c[4*l.length()-3]=e[1],c[4*l.length()-2]=e[2],c[4*l.length()-1]=e[3],o.setPerResidueColors(s,c),s+1}}(),L=function(t,e,n,i,r){for(var o=r.backboneTraces(),a=E(o),s=t.addChainVertArray(r,a),l=0;l<o.length;++l)i=M(t,e,s,i,o[l],n);return i};v.lineTrace=function(t,e,n){console.time("lineTrace");var i=new _(t,1,!0);n.color.begin(t);var o=new r(e,n.float32Allocator);o.setLineWidth(n.lineWidth);var a=0;return t.eachChain(function(t){a=L(o,i,n,a,t)}),o.addVertAssoc(i),o.setShowRelated(n.showRelated),n.color.end(t),console.timeEnd("lineTrace"),o};var R=function(t,e){for(var n=0,i=0;i<t.length;++i)n+=2*(e*(t[i].length()-1)+1);return n},O=function(){var t=l.create(),e=l.create(),n=u.fromValues(0,0,0,1),i=u.fromValues(0,0,0,1);return function(r,o,a,s,l,u){var c,d=u.fullTraceIndex(0),f=s.float32Allocator.request(3*u.length()),p=s.float32Allocator.request(4*u.length()),_=[],g=s.idPool.getContinuousRange(u.length());for(r.addIdRange(g),c=0;c<u.length();++c){var v=u.centralAtomAt(c);u.smoothPosAt(t,c,s.strength),s.color.colorFor(v,p,4*c),f[3*c]=t[0],f[3*c+1]=t[1],f[3*c+2]=t[2],_.push(g.nextId({geom:r,atom:v}))}var y=_[0],b=0,x=h.catmullRomSpline(f,u.length(),s.splineDetail,s.strength,!1,s.float32Allocator),w=m(p,s.splineDetail),S=a.numVerts();o.addAssoc(l,a,d,S,S+1);var A=Math.floor(s.splineDetail/2),k=h.catmullRomSplineNumPoints(u.length(),s.splineDetail,!1);for(c=1;k>c;++c){t[0]=x[3*(c-1)],t[1]=x[3*(c-1)+1],t[2]=x[3*(c-1)+2],e[0]=x[3*(c-0)],e[1]=x[3*(c-0)+1],e[2]=x[3*(c-0)+2],n[0]=w[4*(c-1)+0],n[1]=w[4*(c-1)+1],n[2]=w[4*(c-1)+2],n[3]=w[4*(c-1)+3],i[0]=w[4*(c-0)+0],i[1]=w[4*(c-0)+1],i[2]=w[4*(c-0)+2],i[3]=w[4*(c-0)+3];var C=Math.floor((c+A)/s.splineDetail);b=_[Math.min(_.length-1,C)],a.addLine(t,n,e,i,y,b),y=b;var T=a.numVerts();o.addAssoc(l,a,d+c,T-1,T+(c===u.length-1?0:1))}return o.setPerResidueColors(l,p),s.float32Allocator.release(f),s.float32Allocator.release(x),l+1}}(),P=function(t,e,n,i,r){for(var o=i.backboneTraces(),a=R(o,n.splineDetail),s=t.addChainVertArray(i,a),l=0;l<o.length;++l)r=O(t,e,s,n,r,o[l]);return r};v.sline=function(t,e,n){console.time("sline"),n.color.begin(t);var i=new _(t,n.splineDetail,1,!0),o=new r(e,n.float32Allocator);o.addVertAssoc(i),o.setLineWidth(n.lineWidth),o.setShowRelated(n.showRelated);var a=0;return t.eachChain(function(t){a=P(o,i,n,t,a)}),n.color.end(t),console.timeEnd("sline"),o};var D=function(t,e,n){for(var i=0,r=0;r<t.length;++r)i+=t[r].length()*e,i+=(t[r].length()-1)*n;return i},I=function(t,e,n){for(var i=0,r=0;r<t.length;++r)i+=t[r].length()*e,i+=(t[r].length()-1)*n;return i},N=function(t,e,n,i,r){var o=r.backboneTraces(),a=D(o,n.protoSphere.numVerts(),n.protoCyl.numVerts()),s=I(o,n.protoSphere.numIndices(),n.protoCyl.numIndices());t.addChainVertArray(r,a,s);for(var l=0;l<o.length;++l)U(t,e,o[l],i,n),i++;return i};v.trace=function(t,e,n){console.time("trace"),n.protoCyl=new p(n.arcDetail),n.protoSphere=new f(n.sphereDetail,n.sphereDetail);var r=new i(e,n.float32Allocator,n.uint16Allocator),o=new _(t,1,!0);r.addVertAssoc(o),r.setShowRelated(n.showRelated),n.color.begin(t);var a=0;return t.eachChain(function(t){a=N(r,o,n,a,t)}),n.color.end(t),console.timeEnd("trace"),r};var F=function(t,e,n){for(var i=0,r=0;r<t.length;++r){var o=((t[r].length()-1)*n+1)*e,a=Math.ceil((o+2)/65536);i+=o+(a-1)*e,i+=2}return i},B=function(t,e,n){for(var i=0,r=0;r<t.length;++r)i+=(t[r].length()*n-1)*e*6,i+=6*e;return i},z=function(){var t=c.create(),e=l.create(),n=l.create(),i=l.create(),r=l.create(),o=u.create();return function(a,s,u,c){for(var d=1.8*c.radius,f=c.protoCyl.numVerts()+2*c.protoSphere.numVerts(),p=0;p<u.length;++p){var _=u[p],g=c.idPool.getContinuousRange(_.length());a.addIdRange(g);for(var m=0;m<_.length();++m){var v=a.vertArrayWithSpaceFor(f),y=v.numVerts(),b=_.residueAt(m),x=b.name(),w=b.atom("C3'"),S=null;if(S="A"===x||"G"===x||"DA"===x||"DG"===x?b.atom("N1"):b.atom("N3"),null!==S&&null!==w){var A=g.nextId({geom:a,atom:S});l.add(r,w.pos(),S.pos()),l.scale(r,r,.5),c.color.colorFor(S,o,0),l.sub(i,S.pos(),w.pos());var k=l.length(i);l.scale(i,i,1/k),h.buildRotation(t,i,n,e,!1),c.protoCyl.addTransformed(v,r,k,d,t,o,o,A,A),c.protoSphere.addTransformed(v,S.pos(),d,o,A),c.protoSphere.addTransformed(v,w.pos(),d,o,A);var C=v.numVerts();console.assert(65536>=C,"too many vertices"),s.addAssoc(S,v,y,C)}}}}}(),H=function(t,e,n,i,r,o){for(var a=o.backboneTraces(),s=F(a,4*i.arcDetail,i.splineDetail),l=B(a,4*i.arcDetail,i.splineDetail),u=[],c=i.protoCyl.numVerts()+2*i.protoSphere.numVerts(),h=i.protoCyl.numIndices()+2*i.protoSphere.numIndices(),d=0;d<a.length;++d){var f=a[d];f.residueAt(0).isNucleotide()&&(u.push(f),s+=f.length()*c,l+=f.length()*h)}t.addChainVertArray(o,s,l);for(var p=0;p<a.length;++p)r=j(t,e,a[p],r,i);return z(t,n,u,i),r};v.cartoon=function(t,e,n){console.time("cartoon"),n.arrowSkip=Math.floor(3*n.splineDetail/4),n.coilProfile=new d(b,n.arcDetail,1),n.arrowProfile=new d(w,n.arcDetail/2,.1),n.helixProfile=new d(x,n.arcDetail/2,.1),n.strandProfile=new d(x,n.arcDetail/2,.1),n.protoCyl=new p(4*n.arcDetail),n.protoSphere=new f(4*n.arcDetail,4*n.arcDetail);var r=new i(e,n.float32Allocator,n.uint16Allocator),o=new _(t,n.splineDetail,!0);r.addVertAssoc(o),r.setShowRelated(n.showRelated),n.color.begin(t);var a=0,s=t.select({anames:["N1","N3"]}),l=new g(s,!0);return r.addVertAssoc(l),t.eachChain(function(t){a=H(r,o,l,n,a,t)}),n.color.end(t),console.timeEnd("cartoon"),r},v.surface=function(){var t=l.create(),e=l.create(),n=u.fromValues(.8,.8,.8,1);return function(r,o,a){var s=0;r.getUint32(0),s+=4;var u=r.getUint32(s);s+=4;var c=24,h=c*u+s,d=r.getUint32(h),f=new i(o,a.float32Allocator,a.uint16Allocator);f.setShowRelated("asym");var p,_=f.addVertArray(u,3*d);for(p=0;u>p;++p)l.set(t,r.getFloat32(s+0),r.getFloat32(s+4),r.getFloat32(s+8)),s+=12,l.set(e,r.getFloat32(s+0),r.getFloat32(s+4),r.getFloat32(s+8)),s+=12,_.addVertex(t,e,n,0);for(s=h+4,p=0;d>p;++p){var g=r.getUint32(s+0),m=r.getUint32(s+4),v=r.getUint32(s+8);s+=12,_.addTriangle(g-1,v-1,m-1)}return f}}();var q=function(){var t=c.create(),e=l.create();return function(n,i,r,o,a,s,u,c,d,f,p){var _=d.coilProfile;"C"===o||d.forceTube?c?h.ortho(r,a):l.cross(r,e,a):"H"===o?_=d.helixProfile:"E"===o?_=d.strandProfile:"A"===o&&(_=d.arrowProfile),h.buildRotation(t,a,r,e,!0),_.addTransformed(n,i,u,t,s,c,f,p)}}(),G=function(){var t=l.create(),e=l.create(),n=l.create();return function(i,r,o,a,s,u,c,h){var d=null,f=null,p=r.length();l.set(n,0,0,0);for(var _=0;p>_;++_){u.push(c.nextId({geom:i,atom:r.centralAtomAt(_)})),r.smoothPosAt(t,_,h.strength),a[3*_]=t[0],a[3*_+1]=t[1],a[3*_+2]=t[2],r.smoothNormalAt(e,_,h.strength);var g=r.centralAtomAt(_);h.color.colorFor(g,o,4*_),l.dot(e,n)<0&&l.scale(e,e,-1),"E"!==r.residueAt(_).ss()||h.forceTube||(null===d&&(d=_),f=_),"C"===r.residueAt(_).ss()&&null!==d&&(S(a,d,f,p),S(s,d,f,p),d=null,f=null),s[3*_]=a[3*_]+e[0]+n[0],s[3*_+1]=a[3*_+1]+e[1]+n[1],s[3*_+2]=a[3*_+2]+e[2]+n[2],l.copy(n,e)}}}(),j=function(){var t=l.create(),e=l.create(),n=u.fromValues(0,0,0,1),i=l.create(),r=l.create();return function(o,c,d,f,p){var _=F([d],4*p.arcDetail,p.splineDetail),g=p.float32Allocator.request(3*d.length()),v=p.float32Allocator.request(4*d.length()),y=p.float32Allocator.request(3*d.length()),b=[],x=p.idPool.getContinuousRange(d.length());o.addIdRange(x),G(o,d,v,g,y,b,x,p);var w=o.vertArrayWithSpaceFor(_),S=h.catmullRomSpline(g,d.length(),p.splineDetail,p.strength,!1,p.float32Allocator),A=h.catmullRomSpline(y,d.length(),p.splineDetail,p.strength,!1,p.float32Allocator);c.setPerResidueColors(f,v);var k=p.radius*(d.residueAt(0).isAminoacid()?1:1.8),C=m(v,p.splineDetail);l.set(t,S[3]-S[0],S[4]-S[1],S[5]-S[2]),l.set(e,S[0],S[1],S[2]),l.set(i,A[0]-S[0],A[1]-S[0],A[2]-S[2]),l.normalize(t,t),l.normalize(i,i),u.set(n,C[0],C[1],C[2],C[3]);var T=w.numVerts();w.addVertex(e,[-t[0],-t[1],-t[2]],n,b[0]),q(w,e,i,d.residueAt(0).ss(),t,n,k,!0,p,0,b[0]),a(w,T,4*p.arcDetail);var E=w.numVerts(),M=0;c.addAssoc(f,w,M,T,E),M+=1;for(var L=Math.floor(p.splineDetail/2),R=h.catmullRomSplineNumPoints(d.length(),p.splineDetail,!1),O=4*p.arcDetail,P=1,D=R;D>P;++P){var I=3*P,N=4*P,B=3*(P+1),z=3*(P-1);l.set(e,S[I],S[I+1],S[I+2]),P===D-1?l.set(t,S[I]-S[z],S[I+1]-S[z+1],S[I+2]-S[z+2]):l.set(t,S[B]-S[z],S[B+1]-S[z+1],S[B+2]-S[z+2]),l.normalize(t,t),u.set(n,C[N],C[N+1],C[N+2],C[N+3]);var H=0,j=Math.floor(P/p.splineDetail),U=Math.floor((P-1)/p.splineDetail),V=Math.floor((P+p.arrowSkip)/p.splineDetail),W=!1,X=d.residueAt(j).ss();if(!p.forceTube){if(j!==U){var K=d.residueAt(U).ss();if("C"===K&&("H"===X||"E"===X)){l.set(r,A[z]-S[z],A[z+1]-S[z+1],A[z+2]-S[z+2]),l.normalize(r,r);var Y=2*Math.PI/(4*p.arcDetail),Z=h.signedAngle(i,r,t);H=Math.round(Z/Y),H=(H+4*p.arcDetail)%(4*p.arcDetail)}}if(V!==j&&V<d.length()){var $=d.residueAt(V).ss();"C"===$&&"E"===X&&(W=!0)}}l.set(i,A[3*P]-S[I],A[I+1]-S[I+1],A[I+2]-S[I+2]),l.normalize(i,i),T=w.numVerts();var J=Math.floor((P+L)/p.splineDetail),Q=b[Math.min(b.length-1,J)];q(w,e,i,X,t,n,k,!1,p,H,Q);var tt=P===D-1?1:O;w.numVerts()+tt>w.maxVerts()&&(E=w.numVerts(),c.addAssoc(f,w,M,T,E),w=o.vertArrayWithSpaceFor(tt),T=0,q(w,e,i,X,t,n,k,!0,p,0,Q)),W&&(c.addAssoc(f,w,M,T,E),q(w,e,i,"A",t,n,k,!1,p,0,Q),P+=p.arrowSkip),E=w.numVerts(),P===D-1&&(E+=1),c.addAssoc(f,w,M,T,E),M+=1,W&&(M+=p.arrowSkip)}return w.addVertex(e,t,n,b[b.length-1]),s(w,T,4*p.arcDetail),p.float32Allocator.release(y),p.float32Allocator.release(g),f+1}}(),U=function(){var t=c.create(),e=l.create(),n=l.create(),i=l.create(),r=l.create(),o=l.create(),a=l.create(),s=u.fromValues(0,0,0,1),d=u.fromValues(0,0,0,1);
return function(u,c,f,p,_){if(0!==f.length()){var g=_.idPool.getContinuousRange(f.length());u.addIdRange(g),_.color.colorFor(f.centralAtomAt(0),s,0);var m=D([f],_.protoSphere.numVerts(),_.protoCyl.numVerts()),v=m,y=u.vertArrayWithSpaceFor(m),b=y.maxVerts(),x=y.numVerts();f.posAt(o,0);var w=g.nextId({geom:u,atom:f.centralAtomAt(0)}),S=0;_.protoSphere.addTransformed(y,o,_.radius,s,w);var A=null;c.addAssoc(p,y,0,x,A);var k=_.float32Allocator.request(4*f.length());k[0]=s[0],k[1]=s[1],k[2]=s[2],k[3]=s[3];for(var C=_.protoCyl.numVerts()+_.protoSphere.numVerts(),T=1;T<f.length();++T){S=g.nextId({geom:u,atom:f.centralAtomAt(T)}),f.posAt(o,T-1),f.posAt(a,T),_.color.colorFor(f.centralAtomAt(T),d,0),k[4*T+0]=d[0],k[4*T+1]=d[1],k[4*T+2]=d[2],k[4*T+3]=d[3],l.sub(e,a,o);var E=l.length(e);l.scale(e,e,1/E),h.buildRotation(t,e,n,i,!1),l.copy(r,o),l.add(r,r,a),l.scale(r,r,.5),C>b-y.numVerts()&&(y=u.vertArrayWithSpaceFor(v)),v-=C;var M=y.numVerts();_.protoCyl.addTransformed(y,r,E,_.radius,t,s,d,w,S),A=y.numVerts(),A-=(A-M)/2,_.protoSphere.addTransformed(y,a,_.radius,d,S),w=S,c.addAssoc(p,y,T,x,A),x=A,l.copy(s,d)}c.setPerResidueColors(p,k),c.addAssoc(p,y,f.length()-1,x,y.numVerts())}}}();return v}(d,y,b,x),S=function(){function t(t,e,n,i,r,o){G.call(this,t);var a=o||{};this._options={},this._options.fillStyle=a.fillStyle||"#000",this._options.backgroundAlpha=a.backgroundAlpha||0,this._options.fontSize=a.fontSize||24,this._options.font=a.font||"Verdana",this._options.fontStyle=a.fontStyle||"normal",this._options.fontColor=a.fontColor||"#000",this._order=100,this._pos=i,this._interleavedBuffer=this._gl.createBuffer(),this._interleavedData=new Float32Array(30),this._prepareText(e,n,r);var s=.5,l=.5;this._interleavedData[0]=i[0],this._interleavedData[1]=i[1],this._interleavedData[2]=i[2],this._interleavedData[3]=-s,this._interleavedData[4]=-l,this._interleavedData[5]=i[0],this._interleavedData[6]=i[1],this._interleavedData[7]=i[2],this._interleavedData[8]=s,this._interleavedData[9]=l,this._interleavedData[10]=i[0],this._interleavedData[11]=i[1],this._interleavedData[12]=i[2],this._interleavedData[13]=s,this._interleavedData[14]=-l,this._interleavedData[15]=i[0],this._interleavedData[16]=i[1],this._interleavedData[17]=i[2],this._interleavedData[18]=-s,this._interleavedData[19]=-l,this._interleavedData[20]=i[0],this._interleavedData[21]=i[1],this._interleavedData[22]=i[2],this._interleavedData[23]=-s,this._interleavedData[24]=l,this._interleavedData[25]=i[0],this._interleavedData[26]=i[1],this._interleavedData[27]=i[2],this._interleavedData[28]=s,this._interleavedData[29]=l}function e(t){for(var e=1;t>e;)e*=2;return e}return i.derive(t,G,{updateProjectionIntervals:function(){},updateSquaredSphereRadius:function(t,e){return e},_setupTextParameters:function(t){t.fillStyle=this._options.fontColor,t.textAlign="left",t.textBaseline="bottom",t.font=this._options.fontStyle+" "+this._options.fontSize+"px "+this._options.font},_prepareText:function(t,n,i){this._setupTextParameters(n);var r=n.measureText(i).width,o=24;t.width=e(r),t.height=e(o),n.fillStyle=this._options.fillStyle,n.globalAlpha=this._options.backgroundAlpha,n.fillRect(0,0,t.width,t.height),this._setupTextParameters(n),n.globalAlpha=1,n.lineWidth=.5,n.lineStyle="none",n.fillText(i,0,t.height),n.strokeText(i,0,t.height),this._texture=this._gl.createTexture(),this._textureFromCanvas(this._texture,t),this._xScale=r/t.width,this._yScale=o/t.height,this._width=r,this._height=o},_textureFromCanvas:function(t,e){var n=this._gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.generateMipmap(n.TEXTURE_2D),n.bindTexture(n.TEXTURE_2D,null)},bind:function(){var t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this._interleavedBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._texture),this._ready||(t.bufferData(t.ARRAY_BUFFER,this._interleavedData,t.STATIC_DRAW),this._ready=!0)},draw:function(t,e,n,i){if(this._visible&&"normal"===i){var r=e.text;t.bind(r),this.bind();var o=this._gl,a=t.upsamplingFactor();o.uniform1f(o.getUniformLocation(r,"xScale"),this._xScale),o.uniform1f(o.getUniformLocation(r,"yScale"),this._yScale),o.uniform1f(o.getUniformLocation(r,"width"),2*a*this._width/t.viewportWidth()),o.uniform1f(o.getUniformLocation(r,"height"),2*a*this._height/t.viewportHeight()),o.uniform1i(o.getUniformLocation(r,"sampler"),0);var s=o.getAttribLocation(r,"attrCenter");o.enableVertexAttribArray(s),o.vertexAttribPointer(s,3,o.FLOAT,!1,20,0);var l=o.getAttribLocation(r,"attrCorner");o.vertexAttribPointer(l,2,o.FLOAT,!1,20,12),o.enableVertexAttribArray(l),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.drawArrays(o.TRIANGLES,0,6),o.disableVertexAttribArray(s),o.disableVertexAttribArray(l),o.disable(o.BLEND)}}}),t}(),A=function(n){function r(){this._vertData=[],this._indexData=[],this._numVerts=0}function o(t,e,i,o,a){G.call(this,e),this._float32Allocator=i,this._uint16Allocator=o,this._data=new r,this._protoSphere=new n.ProtoSphere(8,8),this._protoCyl=new n.ProtoCylinder(8),this._va=null,this._idRanges=[],this._idPool=a,this._ready=!1,this._currentRange=null}function a(t,e,n){for(var i=0;n-1>i;++i)t.addTriangle(e,e+1+i,e+2+i);t.addTriangle(e,e+n,e+1)}function s(t,e,n){for(var i=e+n,r=0;n-1>r;++r)t.addTriangle(i,e+r+1,e+r);t.addTriangle(i,e,e+n-1)}var l=t.vec3,u=t.mat3,c=e.forceRGB,d=100;return r.prototype={numVerts:function(){return this._numVerts},addVertex:function(t,e,n,i){this._numVerts+=1,this._vertData.push(t[0],t[1],t[2],e[0],e[1],e[2],n[0],n[1],n[2],n[3],i,0)},addTriangle:function(t,e,n){this._indexData.push(t,e,n)},numIndices:function(){return this._indexData.length},indexData:function(){return this._indexData},vertData:function(){return this._vertData}},i.derive(o,G,{updateProjectionIntervals:function(){},updateSquaredSphereRadius:function(t,e){return e},addTube:function(){var t=l.create(),e=l.create(),n=l.create(),i=l.create(),r=u.create();return function(o,u,d,f){f=f||{};var p=c(f.color||"white"),_=!0;void 0!==f.cap&&(_=f.cap),l.sub(i,u,o);var g=l.length(i);if(l.normalize(i,i),l.add(t,o,u),l.scale(t,t,.5),h.buildRotation(r,i,e,n,!1),_){var m=this._data.numVerts();this._data.addVertex(o,[-i[0],-i[1],-i[2]],p,0),a(this._data,m,8)}var v=void 0!==f.userData?f.userData:null;console.log(v);var y=this._nextObjectId({center:t,userData:v,geom:this});if(this._protoCyl.addTransformed(this._data,t,g,d,r,p,p,y,y),_){var b=this._data.numVerts();this._data.addVertex(u,i,p,0),s(this._data,b-8,8)}this._ready=!1}}(),_nextObjectId:function(t){return this._currentRange&&this._currentRange.hasLeft()||(this._currentRange=this._idPool.getContinuousRange(d),this._idRanges.push(this._currentRange)),this._currentRange.nextId(t)},destroy:function(){G.prototype.destroy.call(this);for(var t=0;t<this._idRanges.length;++t)this._idRanges[t].recycle()},addSphere:function(t,e,n){n=n||{};var i=c(n.color||"white"),r=void 0!==n.userData?n.userData:null,o=this._nextObjectId({center:t,userData:r,geom:this});this._protoSphere.addTransformed(this._data,t,e,i,o),this._ready=!1},_prepareVertexArray:function(){this._ready=!0,null!==this._va&&this._va.destroy(),this._va=new U(this._gl,this._data.numVerts(),this._data.numIndices(),this._float32Allocator,this._uint16Allocator),this._va.setIndexData(this._data.indexData()),this._va.setVertData(this._data.vertData())},draw:function(t,e,n,i){if(this._visible){this._ready||this._prepareVertexArray();var r=this.shaderForStyleAndPass(e,n,i);if(r){t.bind(r),this._gl.uniform1i(r.symId,255);var o=this._va;o.bind(r),o.draw(),o.releaseAttribs(r)}}},shaderForStyleAndPass:function(t,e,n){if("normal"===n)return"hemilight"===e?t.hemilight:t.phong;if("select"===n)return t.select;if("outline"===n)return t.outline;var i=t[n];return void 0!==i?i:null}}),o}(d),k=function(){function e(t,e,n){this._from=t,this._to=e,this._duration=n,this._left=n,this._start=Date.now(),this._looping=!1,this._finished=!1}function n(t,n,i){e.call(this,p.clone(t),p.clone(n),i),this._current=p.clone(t)}function r(t,n,i){var r=g.create(),o=g.create();g.fromMat4(r,t),g.fromMat4(o,n);var a=_.create(),s=_.create();_.fromMat3(a,r),_.fromMat3(s,o),this._current=g.create(),e.call(this,a,s,i)}function o(t,n){e.call(this,null,null,n),this._axis=p.clone(t),this.setLooping(!0),this._previousAngle=0}function a(t,n){var i=1e3*(2*Math.PI/n);e.call(this,null,null,i),this._axis=p.clone(t),this.setLooping(!0),this._speed=n,this._previousT=0}function s(){this._animations=[]}function l(t,e,i){return new n(t,e,i)}function u(t,e,n){return new r(t,e,n)}function c(t,n,i){return new e(t,n,i)}function d(t,e){return new a(t,e)}function f(){return new o([0,1,0],2e3)}var p=t.vec3,_=t.quat,g=t.mat3;return e.prototype={setLooping:function(t){this._looping=t},step:function(t){var e,n=Date.now(),i=n-this._start;if(0===this._duration)e=1;else if(this._looping){var r=Math.floor(i/this._duration);e=(i-r*this._duration)/this._duration}else i=Math.min(this._duration,i),e=i/this._duration,this._finished=1===e;return this.apply(t,e),this._finished},apply:function(t,e){var n=(1-Math.cos(e*Math.PI))/2;this._current=this._from*(1-n)+this._to*n,t.setZoom(this._current)},finished:function(){return this._finished}},i.derive(n,e,{apply:function(t,e){var n=(1-Math.cos(e*Math.PI))/2;p.lerp(this._current,this._from,this._to,n),t.setCenter(this._current)}}),i.derive(r,e,{apply:function(){var t=_.create();return function(e,n){_.slerp(t,this._from,this._to,n),g.fromQuat(this._current,t),e.setRotation(this._current)}}()}),i.derive(o,e,{apply:function(){var t=g.create(),e=g.create();return function(n,i){g.fromMat4(e,n.rotation());var r=.2*Math.sin(2*i*Math.PI),o=r-this._previousAngle;this._previousAngle=r,h.axisRotation(t,this._axis,o),g.mul(e,t,e),n.setRotation(e)}}()}),i.derive(a,e,{apply:function(){var t=g.create(),e=g.create();return function(n,i){g.fromMat4(e,n.rotation());var r=2*Math.PI*(i-this._previousT);this._previousT=i,h.axisRotation(t,this._axis,r),g.mul(e,t,e),n.setRotation(e)}}(),setSpeed:function(t){this._speed=t},setAxis:function(t){this._axis=t}}),s.prototype={run:function(t){var e=Date.now();return this._animations=this._animations.filter(function(n){return!n.step(t,e)}),this._animations.length>0},add:function(t){this._animations.push(t)},remove:function(t){this._animations=this._animations.filter(function(e){return e!==t})}},{AnimationControl:s,move:l,rotate:u,zoom:c,rockAndRoll:f,spin:d}}(),C=function(){function t(t,e){this.near=t,this.far=e}function e(t){t=t||{},this._near=t.near||.1,this._far=t.far||400}function n(){this._far=100}return e.prototype.update=function(){return new t(this._near,this._far)},n.prototype.update=function(e,n){for(var i=n.center(),r=null,o=0;o<e.length;++o){var a=e[o];a.visible()&&(r=a.updateSquaredSphereRadius(i,r))}if(null===r)return null;r=Math.sqrt(r);var s=n.zoom(),l=1.05*(r+s),u=.1;return new t(u,l)},{FixedSlab:e,AutoSlab:n,Slab:t}}(),T=function(n,r,o,a,s,l,u,c,h,d,f,p){function _(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)}function g(t,e){return t=t||"auto","fixed"===t?new C.FixedSlab(e):"auto"===t?new C.AutoSlab(e):null}function m(t,e,n,i,r,o){this._pos=i,this._target=t,this._node=e,this._symIndex=n,this._legacyObject=r,this._legacyTransform=o}function v(t,e){this._options=this._initOptions(e,t),this._initialized=!1,this._objects=[],this._domElement=t,this._redrawRequested=!1,this._resize=!1,this._lastTimestamp=null,this._objectIdManager=new n,this._spin=null,this._rockAndRoll=null,this.listenerMap={},this._animControl=new p.AnimationControl,this._initKeyboardInput(),this._initCanvas(),this.quality(this._options.quality),null!==this._options.click&&this.on("click",this._options.click),null!==this._options.doubleClicked&&this.on("doubleClick",this._options.doubleClick),"complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState?this._initViewer():document.addEventListener("DOMContentLoaded",i.bind(this,this._initViewer))}function y(t,e,n){return e in t?t[e]:n}function b(t){return t.atomDoubleClick?(console.warn("use of atomDoubleClick is deprecated. ","use doubleClick instead"),t.atomDoubleClick):t.atomDoubleClicked?(console.warn("use of atomDoubleClicked is deprecated. ","use doubleClick instead"),t.atomDoubleClicked):t.doubleClick?t.doubleClick:"center"}function x(t){return t.atomClick?(console.warn("use of atomClick is deprecated. ","use click instead"),t.atomClick):t.atomClicked?(console.warn("use of atomClicked is deprecated. ","use click instead"),t.atomClicked):t.click?t.click:null}var w='<div style="vertical-align:middle; text-align:center;"><h1>WebGL not supported</h1><p>Your browser does not support WebGL. You might want to try Chrome, Firefox, IE 11, or newer versions of Safari</p><p>If you are using a recent version of one of the above browsers, your graphic card might be blocked. Check the browser documentation for details on how to unblock it.</p></div>',S=t.vec3,A=t.mat4,k=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();return m.prototype={symIndex:function(){return this._symIndex},target:function(){return this._target},pos:function(){return this._pos},node:function(){return this._node},transform:function(){return this._legacyTransform},object:function(){return this._legacyObject}},v.prototype={_initOptions:function(t,n){t=t||{};var i={width:t.width||500,height:t.height||500,animateTime:t.animateTime||0,antialias:t.antialias,quality:y(t,"quality","low"),style:y(t,"style","hemilight"),background:e.forceRGB(t.background||"white"),slabMode:g(t.slabMode),outline:y(t,"outline",!0),outlineColor:e.forceRGB(y(t,"outlineColor","black")),outlineWidth:y(t,"outlineWidth",1.5),selectionColor:e.forceRGB(y(t,"selectionColor","#3f3")),fov:y(t,"fov",45),doubleClick:b(t),click:x(t),fog:y(t,"fog",!0),transparency:y(t,"transparency","alpha")},r=n.getBoundingClientRect();return"auto"===i.width&&(i.width=r.width),"auto"===i.height&&(i.height=r.height),i},_ensureSize:function(){this._resize&&(this._resize=!1,this._cam.setViewportSize(this._canvas.viewportWidth(),this._canvas.viewportHeight()),this._pickBuffer.resize(this._options.width,this._options.height))},resize:function(t,e){(t!==this._options.width||e!==this._options.height)&&(this._canvas.resize(t,e),this._resize=!0,this._options.width=t,this._options.height=e,this.requestRedraw())},fitParent:function(){var t=this._domElement.getBoundingClientRect();this.resize(t.width,t.height)},gl:function(){return this._canvas.gl()},ok:function(){return this._initialized},options:function(t,n){if(void 0!==n)if(this._options[t]=n,"fog"===t)this._cam.fog(n),this.requestRedraw();else if("fov"===t)this._cam.setFieldOfViewY(n*Math.PI/180);else if("selectionColor"===t)this._cam.setSelectionColor(e.forceRGB(n));else if("outlineColor"===t)this._cam.setOutlineColorColor(e.forceRGB(n));else if("outlineWidth"===t)this._cam.setOutlineWidth(n+0);else if("transparency"===t){var i="screendoor"===n;this._cam.setScreenDoorTransparency(i)}return this._options[t]},quality:function(t){return this._options.quality=t,"high"===t?(this._options.arcDetail=4,this._options.sphereDetail=16,void(this._options.splineDetail=8)):"medium"===t?(this._options.arcDetail=2,this._options.sphereDetail=10,void(this._options.splineDetail=5)):"low"===t?(this._options.arcDetail=2,this._options.sphereDetail=8,void(this._options.splineDetail=3)):void console.error("invalid quality argument",t)},imageData:function(){return this._canvas.imageData()},_initPickBuffer:function(){var t={width:this._options.width,height:this._options.height};this._pickBuffer=new o(this._canvas.gl(),t)},_initViewer:function(){if(!this._canvas.initGL())return this._domElement.removeChild(this._canvas.domElement()),this._domElement.innerHTML=w,this._domElement.style.width=this._options.width+"px",this._domElement.style.height=this._options.height+"px",!1;this._initPickBuffer(),this._2dcontext=this._textureCanvas.getContext("2d"),this._float32Allocator=new a(Float32Array),this._uint16Allocator=new a(Uint16Array),this._cam=new s(this._canvas.gl()),this._cam.setUpsamplingFactor(this._canvas.superSamplingFactor()),this._cam.setOutlineWidth(this._options.outlineWidth);var t="screendoor"===this._options.transparency;this._cam.setScreenDoorTransparency(t),this._cam.fog(this._options.fog),this._cam.setFogColor(this._options.background),this._cam.setOutlineColor(this._options.outlineColor),this._cam.setSelectionColor(this._options.selectionColor),this._cam.setFieldOfViewY(this._options.fov*Math.PI/180),this._mouseHandler.setCam(this._cam);var e=this._canvas,n=_()?"highp":"mediump";return this._shaderCatalog={hemilight:e.initShader(l.HEMILIGHT_VS,l.PRELUDE_FS+l.HEMILIGHT_FS,n),phong:e.initShader(l.HEMILIGHT_VS,l.PRELUDE_FS+l.PHONG_FS,n),outline:e.initShader(l.OUTLINE_VS,l.PRELUDE_FS+l.OUTLINE_FS,n),lines:e.initShader(l.LINES_VS,l.PRELUDE_FS+l.LINES_FS,n),text:e.initShader(l.TEXT_VS,l.TEXT_FS,n),selectLines:e.initShader(l.SELECT_LINES_VS,l.SELECT_LINES_FS,n),select:e.initShader(l.SELECT_VS,l.SELECT_FS,n)},this._boundDraw=i.bind(this,this._draw),this._touchHandler=new u(this._canvas.domElement(),this,this._cam),this._initialized||(this._initialized=!0,this._dispatchEvent({name:"viewerReadyEvent"},"viewerReady",this)),!0},requestRedraw:function(){this._redrawRequested||(this._redrawRequested=!0,k(this._boundDraw))},boundingClientRect:function(){return this._canvas.domElement().getBoundingClientRect()},_drawWithPass:function(t){for(var e=0,n=this._objects.length;e!==n;++e)this._objects[e].draw(this._cam,this._shaderCatalog,this._options.style,t)},_initKeyboardInput:function(){var t=document.createElement("div");t.setAttribute("style","overflow:hidden;width:0;height:0"),this._keyInput=document.createElement("textarea"),this._domElement.appendChild(t),t.appendChild(this._keyInput),this._keyInput.focus()},focus:function(){this._keyInput.focus()},_initCanvas:function(){var t={antialias:this._options.antialias,height:this._options.height,width:this._options.width,backgroundColor:this._options.background};this._canvas=new r.Canvas(this._domElement,t),this._textureCanvas=document.createElement("canvas"),this._textureCanvas.style.display="none",this._domElement.appendChild(this._textureCanvas),this._mouseHandler=new c(this._canvas,this,this._cam,this._options.animateTime),this._canvas.domElement().addEventListener("mousedown",i.bind(this,this._gainFocus))},_gainFocus:function(){this._keyInput.focus()},setRotation:function(t,e){if(e|=0,0===e)return this._cam.setRotation(t),void this.requestRedraw();var n;9===t.length?(n=A.create(),A.fromMat3(n,t)):n=A.clone(t),this._animControl.add(p.rotate(this._cam.rotation(),n,e)),this.requestRedraw()},setCamera:function(t,e,n,i){i|=0,this.setCenter(e,i),this.setRotation(t,i),this.setZoom(n,i)},_animateCam:function(){var t=this._animControl.run(this._cam);t&&this.requestRedraw()},_draw:function(){if(null!==this._canvas){this._redrawRequested=!1,this._animateCam(),this._canvas.bind(),this._ensureSize();var t=this._canvas.gl();t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);var e=this._options.slabMode.update(this._objects,this._cam);null!==e&&this._cam.setNearFar(e.near,e.far),t.enable(t.CULL_FACE),this._options.outline&&(t.cullFace(t.BACK),t.enable(t.CULL_FACE),this._drawWithPass("outline")),t.cullFace(t.FRONT),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this._drawWithPass("normal")}},setCenter:function(t,e){return e|=0,0===e?void this._cam.setCenter(t):(this._animControl.add(p.move(this._cam.center(),S.clone(t),e)),void this.requestRedraw())},setZoom:function(t,e){return e|=0,0===e?void this._cam.setZoom(t):(this._animControl.add(p.zoom(this._cam.zoom(),t,e)),void this.requestRedraw())},centerOn:function(t,e){this.setCenter(t.center(),e)},clear:function(){for(var t=0;t<this._objects.length;++t)this._objects[t].destroy();this._objects=[]},addListener:function(t,e){if("keypress"===t||"keydown"===t||"keyup"===t)console.log("keypress"),this._keyInput.addEventListener(t,e,!1);else{var n=this.listenerMap[t];if("undefined"==typeof n&&(n=[],this.listenerMap[t]=n),"center"===e){var r=i.bind(this._mouseHandler,this._mouseHandler._centerOnClicked);n.push(r)}else n.push(e);this._initialized&&"viewerReady"===t&&e(this,null)}},_dispatchEvent:function(t,e,n){var i=this.listenerMap[e];i&&i.forEach(function(e){e(n,t)})},RENDER_MODES:["sline","lines","trace","lineTrace","cartoon","tube","spheres","ballsAndSticks","points"],renderAs:function(t,e,n,i){for(var r=!1,o=0;o<this.RENDER_MODES.length;++o)if(this.RENDER_MODES[o]===n){r=!0;break}return r?this[n](t,e,i):void console.error("render mode",n,"not supported")},_handleStandardMolOptions:function(t,e){return t=this._handleStandardOptions(t),t.showRelated=t.showRelated||"asym",t.showRelated&&"asym"!==t.showRelated&&null===e.assembly(t.showRelated)&&(console.error("no assembly with name",t.showRelated,". Falling back to asymmetric unit"),t.showRelated="asym"),t},_handleStandardOptions:function(t){return t=i.copy(t),t.float32Allocator=this._float32Allocator,t.uint16Allocator=this._uint16Allocator,t.idPool=this._objectIdManager,t},lineTrace:function(t,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||e.uniform([1,0,1]),r.lineWidth=r.lineWidth||4;var o=h.lineTrace(n,this._canvas.gl(),r);return this.add(t,o)},spheres:function(t,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||e.byElement(),r.sphereDetail=this.options("sphereDetail"),r.radiusMultiplier=r.radiusMultiplier||1;var o=h.spheres(n,this._canvas.gl(),r);return this.add(t,o)},sline:function(t,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||e.uniform([1,0,1]),r.splineDetail=r.splineDetail||this.options("splineDetail"),r.strength=r.strength||1,r.lineWidth=r.lineWidth||4;var o=h.sline(n,this._canvas.gl(),r);return this.add(t,o)},cartoon:function(t,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||e.bySS(),r.strength=r.strength||1,r.splineDetail=r.splineDetail||this.options("splineDetail"),r.arcDetail=r.arcDetail||this.options("arcDetail"),r.radius=r.radius||.3,r.forceTube=r.forceTube||!1;var o=h.cartoon(n,this._canvas.gl(),r),a=this.add(t,o);return a},surface:function(t,e,n){var i=this._handleStandardOptions(n),r=h.surface(e,this._canvas.gl(),i);return this.add(t,r)},tube:function(t,e,n){return n=n||{},n.forceTube=!0,this.cartoon(t,e,n)},ballsAndSticks:function(t,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||e.byElement(),r.radius=r.radius||.3,r.arcDetail=2*(r.arcDetail||this.options("arcDetail")),r.sphereDetail=r.sphereDetail||this.options("sphereDetail");var o=h.ballsAndSticks(n,this._canvas.gl(),r);return this.add(t,o)},lines:function(t,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||e.byElement(),r.lineWidth=r.lineWidth||4;var o=h.lines(n,this._canvas.gl(),r);return this.add(t,o)},points:function(t,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||e.byElement(),r.pointSize=r.pointSize||1;var o=h.points(n,this._canvas.gl(),r);return this.add(t,o)},trace:function(t,n,i){var r=this._handleStandardMolOptions(i,n);r.color=r.color||e.uniform([1,0,0]),r.radius=r.radius||.3,r.arcDetail=2*(r.arcDetail||this.options("arcDetail")),r.sphereDetail=r.sphereDetail||this.options("sphereDetail");var o=h.trace(n,this._canvas.gl(),r);return this.add(t,o)},_updateProjectionIntervals:function(t,e,n){n.eachAtom(function(n){for(var i=n.pos(),r=0;3>r;++r)e[r].update(S.dot(i,t[r]))});for(var i=0;3>i;++i)e[i].extend(1.5)},fitTo:function(t){var e=this._cam.mainAxes(),n=[new i.Range,new i.Range,new i.Range];if(t instanceof G)t.updateProjectionIntervals(e[0],e[1],e[2],n[0],n[1],n[2]);else if(void 0!==t.eachAtom)this._updateProjectionIntervals(e,n,t);else if(void 0!==t.length)for(var r=0;r<t.length;++r)this._updateProjectionIntervals(e,n,t[r]);this._fitToIntervals(e,n)},_fitToIntervals:function(t,e){if(e[0].empty()||e[1].empty()||e[2].empty())return void console.error("could not determine interval. No objects shown?");var n=e[0].center(),i=e[1].center(),r=e[2].center(),o=[n*t[0][0]+i*t[1][0]+r*t[2][0],n*t[0][1]+i*t[1][1]+r*t[2][1],n*t[0][2]+i*t[1][2]+r*t[2][2]],a=this._cam.fieldOfViewY(),s=this._cam.aspectRatio(),l=e[0].length()/s,u=e[1].length(),c=.5*Math.max(l,u),h=c/Math.tan(.5*a),d=h+.5*e[2].length(),f=.5,p=Math.max(h-f,.1),_=2*f+h+e[2].length();this._cam.setNearFar(p,_),this.setCamera(this._cam.rotation(),o,d,this._options.animateTime),this.requestRedraw()},autoZoom:function(){var t=this._cam.mainAxes(),e=[new i.Range,new i.Range,new i.Range];this.forEach(function(n){n.visible()&&n.updateProjectionIntervals(t[0],t[1],t[2],e[0],e[1],e[2])}),this._fitToIntervals(t,e)},slabInterval:function(){},autoSlab:function(){var t=this._options._slabMode.update(this._objects,this._cam);null!==t&&this._cam.setNearFar(t.near,t.far),this.requestRedraw()},rockAndRoll:function(t){return void 0===t?null!==this._rockAndRoll:t?(null===this._rockAndRoll&&(this._rockAndRoll=p.rockAndRoll(),this._animControl.add(this._rockAndRoll),this.requestRedraw()),!0):(this._animControl.remove(this._rockAndRoll),this._rockAndRoll=null,this.requestRedraw(),!1)},spin:function(t,e){return void 0===t?null!==this._spin:t===!1?(this._animControl.remove(this._spin),this._spin=null,this.requestRedraw(),!1):(t===!0&&(t=Math.PI/8),e=e||[0,1,0],null===this._spin?(this._spin=p.spin(e,t),this._animControl.add(this._spin)):(this._spin.setSpeed(t),this._spin.setAxis(e)),this.requestRedraw(),!0)},slabMode:function(t,e){e=e||{};var n=g(t,e),i=n.update(this._objects,this._cam);null!==i&&this._cam.setNearFar(i.near,i.far),this._options.slabMode=n,this.requestRedraw()},label:function(t,e,n,i){var r=new d(this._canvas.gl(),this._textureCanvas,this._2dcontext,n,e,i);return this.add(t,r),r},customMesh:function(t,e){var n=this._handleStandardOptions(e),i=new f(t,this._canvas.gl(),n.float32Allocator,n.uint16Allocator,n.idPool);return this.add(t,i),i},_drawPickingScene:function(){var t=this._canvas.gl();t.clearColor(0,0,0,0),t.disable(t.BLEND),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.clearColor(this._options.background[0],this._options.background[1],this._options.background[2],1),t.cullFace(t.FRONT),t.enable(t.CULL_FACE),this._drawWithPass("select")},pick:function(){return function(t){this._pickBuffer.bind(),this._drawPickingScene();var e=new Uint8Array(4),n=this._canvas.gl();n.readPixels(t.x,this._options.height-t.y,1,1,n.RGBA,n.UNSIGNED_BYTE,e),this._pickBuffer.release(),e.data&&(e=e.data);var i=e[0]|e[1]<<8|e[2]<<16,r=e[3],o=this._objectIdManager.objectForId(i);if(void 0===o)return null;var a=S.create(),s=null,l=null;return 255!==r?(s=o.atom,l=o.geom.symWithIndex(r),S.transformMat4(a,o.atom.pos(),l)):void 0!==o.atom?(s=o.atom,a=o.atom.pos()):(s=o.userData,a=o.center),new m(s,o.geom,255>r?r:null,a,o,l)}}(),add:function(t,e){return e.name(t),this._objects.push(e),this._objects.sort(function(t,e){return t.order()-e.order()}),this.requestRedraw(),e},_globToRegex:function(t){var e=t.replace(".","\\.").replace("*",".*");return new RegExp("^"+e+"$")},forEach:function(){var t,e="*";2===arguments.length?(t=arguments[1],e=arguments[0]):t=arguments[0];for(var n=this._globToRegex(e),i=0;i<this._objects.length;++i){var r=this._objects[i];n.test(r.name())&&t(r,i)}},get:function(t){for(var e=0;e<this._objects.length;++e)if(this._objects[e].name()===t)return this._objects[e];return console.error("could not find object with name",t),null},hide:function(t){this.forEach(t,function(t){t.hide()})},show:function(t){this.forEach(t,function(t){t.show()})},rm:function(t){for(var e=[],n=this._globToRegex(t),i=0;i<this._objects.length;++i){var r=this._objects[i];n.test(r.name())?r.destroy():e.push(r)}this._objects=e},all:function(){return this._objects},isWebGLSupported:function(){return this._canvas.isWebGLSupported()},destroy:function(){this.clear(),this._canvas.destroy(),this._canvas=null}},v.prototype.on=v.prototype.addListener,{Viewer:function(t,e){return new v(t,e)},isWebGLSupported:r.isWebGLSupported}}(n,r,o,a,s,l,u,c,w,S,A,k),E=function(){function t(t,e){this._chains=t||[],this._matrices=e||[]}function e(t){this._name=t,this._generators=[]}return t.prototype={addChain:function(t){this._chains.push(t)},chains:function(){return this._chains},addMatrix:function(t){this._matrices.push(t)},matrices:function(){return this._matrices},matrix:function(t){return this._matrices[t]}},e.prototype={name:function(){return this._name},generators:function(){return this._generators},generator:function(t){return this._generators[t]},addGenerator:function(t){this._generators.push(t)}},{SymGenerator:t,Assembly:e}}(),M=function(){function e(){}function n(t,n,i,r,o,a,s,l){e.call(this),this._residue=t,this._bonds=[],this._isHetatm=!!a,this._name=n,this._pos=i,this._index=o,this._element=r,this._occupancy=void 0!==s?s:null,this._tempFactor=void 0!==l?l:null}function r(t,n){e.call(this),this._resView=t,this._atom=n,this._bonds=[]}var o=t.vec3;return e.prototype={bondCount:function(){return this.bonds().length},eachBond:function(t){for(var e=this.bonds(),n=0,i=e.length;i>n;++n)t(e[n])},isConnectedTo:function(t){if(null===t)return!1;for(var e=t.full(),n=this.full(),i=this.bonds(),r=0,o=i.length;o>r;++r){var a=i[r];if(a.atom_one()===n&&a.atom_two()===e||a.atom_one()===e&&a.atom_two()===n)return!0}return!1}},i.derive(n,e,{addBond:function(t){this._bonds.push(t)},name:function(){return this._name},bonds:function(){return this._bonds},residue:function(){return this._residue},structure:function(){return this._residue.structure()},full:function(){return this},qualifiedName:function(){return this.residue().qualifiedName()+"."+this.name()},pos:function(){return this._pos},setPos:function(t){o.copy(this._pos,t)},element:function(){return this._element},index:function(){return this._index},prop:function(t){return this[t]()},occupancy:function(){return this._occupancy},tempFactor:function(){return this._tempFactor},isHetatm:function(){return this._isHetatm}}),i.derive(r,e,{full:function(){return this._atom},name:function(){return this._atom.name()},pos:function(){return this._atom.pos()},element:function(){return this._atom.element()},residue:function(){return this._resView},bonds:function(){return this._atom.bonds()},index:function(){return this._atom.index()},occupancy:function(){return this._atom.occupancy()},tempFactor:function(){return this._atom.tempFactor()},qualifiedName:function(){return this._atom.qualifiedName()},isHetatm:function(){return this._atom.isHetatm()}}),{Atom:n,AtomView:r}}(),L=function(e){function n(){}function r(t,e,i,r){n.call(this),this._name=e,this._num=i,this._insCode=r,this._atoms=[],this._ss="C",this._chain=t,this._isAminoacid=!1,this._isNucleotide=!1,this._index=t.residues().length}function o(t,e){n.call(this),this._chainView=t,this._atoms=[],this._residue=e}var a=t.vec3,s=e.Atom,l=e.AtomView;return n.prototype={prop:function(t){return this[t]()},isWater:function(){return"HOH"===this.name()||"DOD"===this.name()},eachAtom:function(t,e){e|=0;for(var n=0;n<this._atoms.length;n+=1){if(t(this._atoms[n],e)===!1)return!1;e+=1}return e},qualifiedName:function(){var t=this.chain().name()+"."+this.name()+this.num();return"\x00"===this.insCode()?t:t+this.insCode()},atom:function(t){if("string"==typeof t){for(var e=0;e<this._atoms.length;++e)if(this._atoms[e].name()===t)return this._atoms[e];return null}return t>=this._atoms.length&&0>t?null:this._atoms[t]},centralAtom:function(){return this.isAminoacid()?this.atom("CA"):this.isNucleotide()?this.atom("C3'"):null},center:function(){var t=0,e=a.create();return this.eachAtom(function(n){a.add(e,e,n.pos()),t+=1}),t>0&&a.scale(e,e,1/t),e},isAminoacid:function(){return this._isAminoacid},isNucleotide:function(){return this._isNucleotide}},i.derive(r,n,{_deduceType:function(){this._isNucleotide=null!==this.atom("P")&&null!==this.atom("C3'"),
this._isAminoacid=null!==this.atom("N")&&null!==this.atom("CA")&&null!==this.atom("C")&&null!==this.atom("O")},name:function(){return this._name},insCode:function(){return this._insCode},num:function(){return this._num},full:function(){return this},addAtom:function(t,e,n,i,r,o){var a=new s(this,t,e,n,this.structure().nextAtomIndex(),i,r,o);return this._atoms.push(a),a},ss:function(){return this._ss},setSS:function(t){this._ss=t},index:function(){return this._index},atoms:function(){return this._atoms},chain:function(){return this._chain},structure:function(){return this._chain.structure()}}),i.derive(o,n,{addAtom:function(t,e){if(e)for(var n=0;n<this._atoms.length;++n){var i=this._atoms[n];if(i.index()===t.index())return i}var r=new l(this,t.full());return this._atoms.push(r),r},removeAtom:function(t){var e=this._atoms.length;return this._atoms=this._atoms.filter(function(e){return e.index()!==t.index()}),e!==this._atoms.length},full:function(){return this._residue},num:function(){return this._residue.num()},insCode:function(){return this._residue.insCode()},ss:function(){return this._residue.ss()},index:function(){return this._residue.index()},chain:function(){return this._chainView},name:function(){return this._residue.name()},atoms:function(){return this._atoms},qualifiedName:function(){return this._residue.qualifiedName()},containsResidue:function(t){return this._residue.full()===t.full()},isAminoacid:function(){return this._residue.isAminoacid()},isNucleotide:function(){return this._residue.isNucleotide()},isWater:function(){return this._residue.isWater()}}),{ResidueView:o,Residue:r}}(M),R=function(){function e(){this._trace=[]}function n(t,e,n){this._fullTrace=t,this._fullTraceBegin=e,this._fullTraceEnd=n,this._isNTerminal=0===this._fullTraceBegin,this._isCTerminal=this._fullTrace.length()===this._fullTraceEnd;var i=this._fullTraceEnd-this._fullTraceBegin;this._isCTerminal||++i,this._isNTerminal||(++i,this._fullTraceBegin-=1),this._length=i}var i=t.vec3;return e.prototype={push:function(t){this._trace.push(t)},length:function(){return this._trace.length},residueAt:function(t){return this._trace[t]},posAt:function(t,e){return i.copy(t,this._trace[e].centralAtom().pos()),t},normalAt:function(t,e){var n=this._trace[e];return n.isAminoacid()&&i.sub(t,n.atom("O").pos(),n.atom("C").pos()),i.normalize(t,t),t},centralAtomAt:function(t){return this._trace[t].centralAtom()},tangentAt:function(){var t=i.create(),e=i.create();return function(n,r){r>0?this.posAt(t,r-1):this.posAt(t,r),r<this._trace.length-1?this.posAt(e,r+1):this.posAt(e,r),i.sub(n,e,t)}}(),fullTraceIndex:function(t){return t},subsets:function(t){for(var e=0,i=0,r=[];i<t.length&&e<this._trace.length;){for(var o=t[i].full().index();this._trace.length>e&&this._trace[e].index()<o;)++e;if(e>=this._trace.length)break;for(var a=this._trace[e].index();t.length>i&&t[i].full().index()<a;)++i;if(i>=t.length)break;for(var s=e;t.length>i&&this._trace.length>e&&t[i].full().index()===this._trace[e].index();)++i,++e;var l=e;r.push(new n(this,s,l))}return r}},e.prototype.smoothPosAt=e.prototype.posAt,e.prototype.smoothNormalAt=e.prototype.normalAt,n.prototype={length:function(){return this._length},residueAt:function(t){return this._fullTrace.residueAt(this._fullTraceBegin+t)},_interpolate:function(){var t=i.create(),e=i.create();return function(n,r,o,a){return this.tangentAt(t,r),this.tangentAt(e,o),i.scale(t,t,a),i.scale(e,e,a),h.cubicHermiteInterpolate(n,this.centralAtomAt(r).pos(),t,this.centralAtomAt(o).pos(),e,.5,0),n}}(),smoothPosAt:function(){return function(t,e,n){if(0===e&&!this._isNTerminal)return this._interpolate(t,e,e+1,n);if(e===this._length-1&&!this._isCTerminal)return this._interpolate(t,e-1,e,n);var r=this.centralAtomAt(e);return i.copy(t,r.pos()),t}}(),smoothNormalAt:function(){return function(t,e){return this._fullTrace.normalAt(t,e+this._fullTraceBegin),t}}(),posAt:function(t,e){var n=this.centralAtomAt(e),r=null;return i.copy(t,n.pos()),0!==e||this._isNTerminal||(r=this.centralAtomAt(e+1),i.add(t,t,r.pos()),i.scale(t,t,.5)),e!==this._length-1||this._isCTerminal||(r=this.centralAtomAt(e-1),i.add(t,t,r.pos()),i.scale(t,t,.5)),t},centralAtomAt:function(t){return this.residueAt(t).centralAtom()},fullTraceIndex:function(t){return this._fullTraceBegin+t},tangentAt:function(t,e){return this._fullTrace.tangentAt(t,e+this._fullTraceBegin)}},{TraceSubset:n,BackboneTrace:e}}(),O=function(e,n){function r(t,e){return t<<8|e.charCodeAt(0)}function o(t,e){return t.num()<e.num()}function a(t){return{num:function(){return t}}}function s(){}function l(t,e){s.call(this),this._structure=t,this._name=e,this._cachedTraces=[],this._residues=[],this._rnumsOrdered=!0}function u(t,e,n){var i,r;if(t?(i=e.atom("C"),r=n.atom("N")):(i=e.atom("O3'"),r=n.atom("P")),i.isConnectedTo(r))return!1;var o=f.sqrDist(i.pos(),r.pos());return Math.abs(o-2.25)>1}function c(t,e){e.length()<2||t.push(e)}function h(t,e,n){if(0===t.length)return!0;if(!e)return!1;var i=r(n.num(),n.insCode()),o=t[t.length-1],a=r(o.num(),o.insCode());return i>a}function d(t,e){s.call(this),this._chain=e,this._residues=[],this._molView=t,this._residueMap={},this._rnumsOrdered=!0}var f=t.vec3,p=e.Residue,_=e.ResidueView;return s.prototype={eachAtom:function(t,e){e|=0;for(var n=0;n<this._residues.length;n+=1)if(e=this._residues[n].eachAtom(t,e),e===!1)return!1;return e},atomCount:function(){for(var t=0,e=this.residues(),n=0;n<e.length;++n)t+=e[n].atoms().length;return t},eachResidue:function(t){for(var e=0;e<this._residues.length;e+=1)if(t(this._residues[e])===!1)return!1},residues:function(){return this._residues},structure:function(){return this._structure},asView:function(){var t=this.structure().createEmptyView();return t.addChain(this,!0),t},residueByRnum:function(t){var e=this.residues();if(this._rnumsOrdered){var n=i.binarySearch(e,a(t),o);return-1===n?null:e[n]}for(var r=0;r<e.length;++r)if(e[r].num()===t)return e[r];return null},residuesInRnumRange:function(t,e){var n,r,s=[],l=this.residues();if(this._rnumsOrdered===!0){var u=i.indexFirstLargerEqualThan(l,a(t),o);if(-1===u)return s;var c=i.indexLastSmallerEqualThan(l,a(e),o);if(-1===c)return s;for(n=u;c>=n;++n)s.push(this._residues[n])}else for(n=0,r=l.length;n!==r;++n){var h=l[n];h.num()>=t&&h.num()<=e&&s.push(h)}return s},prop:function(t){return this[t]()}},i.derive(l,s,{name:function(){return this._name},full:function(){return this},addResidue:function(t,e,n){n=n||"\x00";var i=new p(this,t,e,n);return this._rnumsOrdered=h(this._residues,this._rnumsOrdered,i),this._residues.push(i),i},assignSS:function(t,e,n){for(var i=r(t[0],t[1]),o=r(e[0],e[1]),a=1;a<this._residues.length-1;++a){var s=this._residues[a],l=r(s.num(),s.insCode());i>=l||l>=o||s.setSS(n)}},eachBackboneTrace:function(t){this._cacheBackboneTraces();for(var e=0;e<this._cachedTraces.length;++e)t(this._cachedTraces[e])},_cacheBackboneTraces:function(){if(!(this._cachedTraces.length>0)){for(var t=new n.BackboneTrace,e=null,i=0;i<this._residues.length;i+=1){var r=this._residues[i],o=r.isAminoacid(),a=r.isNucleotide();if(e===!0&&!o||e===!1&&!a||null===e&&!a&&!o)c(this._cachedTraces,t),e=null,t=new n.BackboneTrace;else if(0!==t.length()){var s=this._residues[i-1];u(e,s,r)&&(c(this._cachedTraces,t),t=new n.BackboneTrace),t.push(r)}else t.push(r),e=r.isAminoacid()}c(this._cachedTraces,t)}},backboneTraces:function(){var t=[];return this.eachBackboneTrace(function(e){t.push(e)}),t}}),i.derive(d,s,{addResidue:function(t,e){var n=new _(this,t.full());if(this._rnumsOrdered=h(this._residues,this._rnumsOrdered,t),this._residues.push(n),this._residueMap[t.full().index()]=n,e)for(var i=t.atoms(),r=0;r<i.length;++r)n.addAtom(i[r].full(),!1);return n},addAtom:function(t){var e=this._residueMap[t.residue().full().index()];return void 0===e&&(e=this.addResidue(t.residue())),e.addAtom(t,!0)},removeAtom:function(t,e){var n=this._residueMap[t.residue().full().index()];if(void 0===n)return!1;var i=n.removeAtom(t);return i&&0===n.atoms().length&&e&&(delete this._residueMap[t.residue().full().index()],this._residues=this._residues.filter(function(t){return t!==n})),i},containsResidue:function(t){var e=this._residueMap[t.full().index()];return void 0===e?!1:e.full()===t.full()},eachBackboneTrace:function(t){for(var e=this._chain.backboneTraces(),n=0;n<e.length;++n)for(var i=e[n].subsets(this._residues),r=0;r<i.length;++r)t(i[r])},backboneTraces:function(){var t=[];return this.eachBackboneTrace(function(e){t.push(e)}),t},full:function(){return this._chain},name:function(){return this._chain.name()},structure:function(){return this._molView}}),{Chain:l,ChainView:d}}(L,R),P=function(){var e=t.vec3,n=function(t,n){var i={atom_one:t,atom_two:n};return{atom_one:function(){return i.atom_one},atom_two:function(){return i.atom_two},mid_point:function(t){return t||(t=e.create()),e.add(t,i.atom_one.pos(),i.atom_two.pos()),e.scale(t,t,.5),t}}};return{Bond:n}}(),D=function(){function t(t,e){for(var n=0;n<e.length;++n)if(!e[n](t))return!1;return!0}function e(t){var e=[];return void 0!==t.aname&&e.push(function(e){return e.name()===t.aname}),void 0!==t.hetatm&&e.push(function(e){return e.isHetatm()===t.hetatm}),void 0!==t.anames&&e.push(function(e){for(var n=e.name(),i=0;i<t.anames.length;++i)if(n===t.anames[i])return!0;return!1}),e}function n(t){var e=[];if(void 0!==t.rname&&e.push(function(e){return e.name()===t.rname}),void 0!==t.rnames&&e.push(function(e){for(var n=e.name(),i=0;i<t.rnames.length;++i)if(n===t.rnames[i])return!0;return!1}),void 0!==t.rnums){for(var n={},i=0;i<t.rnums.length;++i)n[t.rnums[i]]=!0;e.push(function(t){var e=t.num();return n[e]===!0})}return void 0!==t.rnum&&e.push(function(e){return e.num()===t.rnum}),e}function i(t){var e=[];return void 0!==t.cname&&(t.chain=t.cname),void 0!==t.cnames&&(t.chains=t.cnames),void 0!==t.chain&&e.push(function(e){return e.name()===t.chain}),void 0!==t.chains&&e.push(function(e){for(var n=e.name(),i=0;i<t.chains.length;++i)if(n===t.chains[i])return!0;return!1}),e}function r(t,e){var n=t.residues();e.rnumRange&&(n=t.residuesInRnumRange(e.rnumRange[0],e.rnumRange[1]));var i,r,o=[];if(void 0!==e.rindexRange){for(i=e.rindexRange[0],r=Math.min(n.length-1,e.rindexRange[1]);r>=i;++i)o.push(n[i]);return o}if(e.rindices&&void 0!==e.rindices.length){for(o=[],i=0;i<e.rindices.length;++i)o.push(n[e.rindices[i]]);return o}return n}function o(o,a,s){var l=n(s),u=e(s),c=i(s);s.rindex&&(s.rindices=[s.rindex]);for(var h=0;h<o._chains.length;++h){var d=o._chains[h];if(t(d,c))for(var f=r(d,s),p=null,_=0;_<f.length;++_)if(t(f[_],l)){p||(p=a.addChain(d,!1));for(var g=null,m=f[_].atoms(),v=0;v<m.length;++v)t(m[v],u)&&(g||(g=p.addResidue(f[_],!1)),g.addAtom(m[v]))}}return a}return{dict:o}}(),I=W=function(e,n,r){function o(t){var e=g[t.toUpperCase()];return void 0!==e?e:1.5}function a(t,e,n){var i=e.atom("C"),r=n.atom("N");if(i&&r){var o=d.sqrDist(i.pos(),r.pos());1.6*1.6>o&&t.connect(r,i)}}function s(t,e,n){var i=e.atom("O3'"),r=n.atom("P");if(i&&r){var o=d.sqrDist(i.pos(),r.pos());1.7*1.7>o&&t.connect(i,r)}}function l(){}function u(){l.call(this),this._chains=[],this._assemblies=[],this._nextAtomIndex=0}function c(t){l.call(this),this._mol=t,this._chains=[]}var d=t.vec3,f=e.Chain,p=e.ChainView,_=n.Bond,g={H:.31,HE:.28,LI:1.28,BE:.96,B:.84,C:.76,N:.71,O:.66,F:.57,NE:.58,NA:1.66,MG:1.41,AL:1.21,SI:1.11,P:1.07,S:1.05,CL:1.02,AR:1.06,K:2.03,CA:1.76,SC:1.7,TI:1.6,V:1.53,CR:1.39,MN:1.39,FE:1.32,CO:1.26,NI:1.24,CU:1.32,ZN:1.22,GA:1.22,GE:1.2,AS:1.19,SE:1.2,BR:1.2,KR:1.16,RB:2.2,SR:1.95,Y:1.9,ZR:1.75,NB:1.64,MO:1.54,TC:1.47,RU:1.46,RH:1.42,PD:1.39,AG:1.45,CD:1.44,IN:1.42,SN:1.39,SB:1.39,TE:1.38,I:1.39,XE:1.4,CS:2.44,BA:2.15,LA:2.07,CE:2.04,PR:2.03,ND:2.01,PM:1.99,SM:1.98,EU:1.98,GD:1.96,TB:1.94,DY:1.92,HO:1.92,ER:1.89,TM:1.9,YB:1.87,LU:1.87,HF:1.75,TA:1.7,W:1.62,RE:1.51,OS:1.44,IR:1.41,PT:1.36,AU:1.36,HG:1.32,TL:1.45,PB:1.46,BI:1.48,PO:1.4,AT:1.5,RN:1.5,FR:2.6,RA:2.21,AC:2.15,TH:2.06,PA:2,U:1.96,NP:1.9,PU:1.87,AM:1.8,CM:1.69};return l.prototype={eachResidue:function(t){for(var e=0;e<this._chains.length;e+=1)if(this._chains[e].eachResidue(t)===!1)return!1},eachAtom:function(t,e){e|=0;for(var n=0;n<this._chains.length;n+=1)if(e=this._chains[n].eachAtom(t,e),e===!1)return!1},residueCount:function(){for(var t=this.chains(),e=0,n=0;n<t.length;++n)e+=t[n].residues().length;return e},eachChain:function(t){for(var e=this.chains(),n=0;n<e.length;++n)if(t(e[n])===!1)return},atomCount:function(){for(var t=this.chains(),e=0,n=0;n<t.length;++n)e+=t[n].atomCount();return e},atoms:function(){var t=[];return this.eachAtom(function(e){t.push(e)}),t},atom:function(t){var e=t.split("."),n=this.chain(e[0]);if(null===n)return null;var i=n.residueByRnum(parseInt(e[1],10));return null===i?null:i.atom(e[2])},center:function(){var t=d.create(),e=0;return this.eachAtom(function(n){d.add(t,t,n.pos()),e+=1}),e&&d.scale(t,t,1/e),t},boundingSphere:function(){var t=this.center(),e=0;return this.eachAtom(function(n){e=Math.max(e,d.sqrDist(t,n.pos()))}),new h.Sphere(t,Math.sqrt(e))},backboneTraces:function(){for(var t=this.chains(),e=[],n=0;n<t.length;++n)Array.prototype.push.apply(e,t[n].backboneTraces());return e},select:function(t){return"protein"===t?this.residueSelect(function(t){return t.isAminoacid()}):"water"===t?this.residueSelect(function(t){return t.isWater()}):"ligand"===t?this.residueSelect(function(t){return!t.isAminoacid()&&!t.isWater()}):r.dict(this,new c(this),t||{})},residueSelect:function(t){console.time("Mol.residueSelect");for(var e=new c(this.full()),n=0;n<this._chains.length;++n)for(var i=this._chains[n],r=null,o=i.residues(),a=0;a<o.length;++a)t(o[a])&&(r||(r=e.addChain(i,!1)),r.addResidue(o[a],!0));return console.timeEnd("Mol.residueSelect"),e},atomSelect:function(t){console.time("Mol.atomSelect");for(var e=new c(this.full()),n=0;n<this._chains.length;++n)for(var i=this._chains[n],r=null,o=i.residues(),a=0;a<o.length;++a)for(var s=null,l=o[a],u=l.atoms(),h=0;h<u.length;++h)t(u[h])&&(r||(r=e.addChain(i,!1)),s||(s=r.addResidue(l,!1)),s.addAtom(u[h]));return console.timeEnd("Mol.atomSelect"),e},assembly:function(t){for(var e=this.assemblies(),n=0;n<e.length;++n)if(e[n].name()===t)return e[n];return null},chainsByName:function(t){for(var e={},n=this.chains(),i=0;i<n.length;++i)e[n[i].name()]=n[i];for(var r=[],o=0;o<t.length;++o){var a=e[t[o]];void 0!==a&&r.push(a)}return r},selectWithin:function(){var t=d.create();return function(e,n){console.time("Mol.selectWithin"),n=n||{};var i=n.radius||4,r=i*i,o=!!n.matchResidues,a=[];e.eachAtom(function(t){a.push(t)});for(var s=new c(this.full()),l=null,u=null,h=this.chains(),f=!1,p=0;p<h.length;++p){var _=h[p].residues();u=null;for(var g=0;g<_.length;++g){l=null,f=!1;for(var m=_[g].atoms(),v=0;v<m.length&&!f;++v)for(var y=0;y<a.length;++y)if(d.sub(t,m[v].pos(),a[y].pos()),!(d.sqrLen(t)>r)){if(u||(u=s.addChain(h[p].full(),!1)),l||(l=u.addResidue(_[g].full(),o)),o){f=!0;break}l.addAtom(m[v].full());break}}}return console.timeEnd("Mol.selectWithin"),s}}(),createEmptyView:function(){return new c(this.full())}},i.derive(u,l,{addAssembly:function(t){this._assemblies.push(t)},setAssemblies:function(t){this._assemblies=t},assemblies:function(){return this._assemblies},chains:function(){return this._chains},full:function(){return this},containsResidue:function(t){return t.full().structure()===this},chainByName:function(t){for(var e=0;e<this._chains.length;++e)if(this._chains[e].name()===t)return this._chains[e];return null},chain:function(t){return this.chainByName(t)},nextAtomIndex:function(){var t=this._nextAtomIndex;return this._nextAtomIndex+=1,t},addChain:function(t){var e=new f(this,t);return this._chains.push(e),e},connect:function(t,e){var n=new _(t,e);return t.addBond(n),e.addBond(n),n},deriveConnectivity:function(){console.time("Mol.deriveConnectivity");var t=this,e=null;this.eachResidue(function(n){for(var i,r=n.atoms(),l=r.length,u=0;l>u;u+=1)for(var c=r[u],h=c.pos(),f=o(c.element()),p=0;u>p;p+=1){var _=r[p],g=o(_.element());i=d.sqrDist(h,_.pos());var m=f+g-.3,v=f+g+.3;v*v>i&&i>m*m&&t.connect(c,_)}n._deduceType(),null!==e&&(n.isAminoacid()&&e.isAminoacid()&&a(t,e,n),n.isNucleotide()&&e.isNucleotide()&&s(t,e,n)),e=n}),console.timeEnd("Mol.deriveConnectivity")}}),i.derive(c,l,{full:function(){return this._mol},assemblies:function(){return this._mol.assemblies()},addChain:function(t,e){var n=new p(this,t.full());if(this._chains.push(n),e)for(var i=t.residues(),r=0;r<i.length;++r)n.addResidue(i[r],!0);return n},addAtom:function(t){var e=this.chain(t.residue().chain().name());return null===e&&(e=this.addChain(t.residue().chain())),e.addAtom(t)},removeAtom:function(t,e){if(null===t)return!1;var n=this.chain(t.residue().chain().name());if(null===n)return!1;var i=n.removeAtom(t,e);return i&&0===n.residues().length&&(this._chains=this._chains.filter(function(t){return t!==n})),i},containsResidue:function(t){if(!t)return!1;var e=this.chain(t.chain().name());return e?e.containsResidue(t):!1},addResidues:function(t,e){var n=this,i={};return t.forEach(function(t){var r=t.chain().name();"undefined"==typeof i[r]&&(i[r]=n.addChain(t.chain(),!1)),i[r].addResidue(t,e)}),i},chains:function(){return this._chains},chain:function(t){for(var e=0;e<this._chains.length;++e)if(this._chains[e].name()===t)return this._chains[e];return null}}),{MolView:c,Mol:u}}(O,P,D),N=function(){function t(t){function e(t,e){return t=Math.abs(t),e=Math.abs(e),t>e?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}var n,i=Math.pow(2,-52),r=1e-64/i,o=50,a=0,s=0,l=0,u=0,c=0,h=t,d=h.length,f=h[0].length;if(f>d)throw"Need more rows than columns";var p=new Array(f),_=new Array(f);for(s=0;f>s;s++)p[s]=_[s]=0;for(var g=[],s=0;f>s;++s){var m=[];g.push([]);for(var l=0;f>l;++l)m.push(0);g.push(m)}var v=0,y=0,b=0,x=0,w=0,S=0,A=0;for(s=0;f>s;s++){for(p[s]=y,A=0,c=s+1,l=s;d>l;l++)A+=h[l][s]*h[l][s];if(r>=A)y=0;else for(v=h[s][s],y=Math.sqrt(A),v>=0&&(y=-y),b=v*y-A,h[s][s]=v-y,l=c;f>l;l++){for(A=0,u=s;d>u;u++)A+=h[u][s]*h[u][l];for(v=A/b,u=s;d>u;u++)h[u][l]+=v*h[u][s]}for(_[s]=y,A=0,l=c;f>l;l++)A+=h[s][l]*h[s][l];if(r>=A)y=0;else{for(v=h[s][s+1],y=Math.sqrt(A),v>=0&&(y=-y),b=v*y-A,h[s][s+1]=v-y,l=c;f>l;l++)p[l]=h[s][l]/b;for(l=c;d>l;l++){for(A=0,u=c;f>u;u++)A+=h[l][u]*h[s][u];for(u=c;f>u;u++)h[l][u]+=A*p[u]}}w=Math.abs(_[s])+Math.abs(p[s]),w>x&&(x=w)}for(s=f-1;-1!=s;s+=-1){if(0!=y){for(b=y*h[s][s+1],l=c;f>l;l++)g[l][s]=h[s][l]/b;for(l=c;f>l;l++){for(A=0,u=c;f>u;u++)A+=h[s][u]*g[u][l];for(u=c;f>u;u++)g[u][l]+=A*g[u][s]}}for(l=c;f>l;l++)g[s][l]=0,g[l][s]=0;g[s][s]=1,y=p[s],c=s}for(s=f-1;-1!=s;s+=-1){for(c=s+1,y=_[s],l=c;f>l;l++)h[s][l]=0;if(0!=y){for(b=h[s][s]*y,l=c;f>l;l++){for(A=0,u=c;d>u;u++)A+=h[u][s]*h[u][l];for(v=A/b,u=s;d>u;u++)h[u][l]+=v*h[u][s]}for(l=s;d>l;l++)h[l][s]=h[l][s]/y}else for(l=s;d>l;l++)h[l][s]=0;h[s][s]+=1}for(i*=x,u=f-1;-1!=u;u+=-1)for(var k=0;o>k;k++){var C=!1;for(c=u;-1!=c;c+=-1){if(Math.abs(p[c])<=i){C=!0;break}if(Math.abs(_[c-1])<=i)break}if(!C){a=0,A=1;var T=c-1;for(s=c;u+1>s&&(v=A*p[s],p[s]=a*p[s],!(Math.abs(v)<=i));s++)for(y=_[s],b=e(v,y),_[s]=b,a=y/b,A=-v/b,l=0;d>l;l++)w=h[l][T],S=h[l][s],h[l][T]=w*a+S*A,h[l][s]=-w*A+S*a}if(S=_[u],c==u){if(0>S)for(_[u]=-S,l=0;f>l;l++)g[l][u]=-g[l][u];break}if(k>=o-1)throw"Error: no convergence.";for(x=_[c],w=_[u-1],y=p[u-1],b=p[u],v=((w-S)*(w+S)+(y-b)*(y+b))/(2*b*w),y=e(v,1),v=0>v?((x-S)*(x+S)+b*(w/(v-y)-b))/x:((x-S)*(x+S)+b*(w/(v+y)-b))/x,a=1,A=1,s=c+1;u+1>s;s++){for(y=p[s],w=_[s],b=A*y,y=a*y,S=e(v,b),p[s-1]=S,a=v/S,A=b/S,v=x*a+y*A,y=-x*A+y*a,b=w*A,w*=a,l=0;f>l;l++)x=g[l][s-1],S=g[l][s],g[l][s-1]=x*a+S*A,g[l][s]=-x*A+S*a;for(S=e(v,b),_[s-1]=S,a=v/S,A=b/S,v=a*y+A*w,x=-A*y+a*w,l=0;d>l;l++)w=h[l][s-1],S=h[l][s],h[l][s-1]=w*a+S*A,h[l][s]=-w*A+S*a}p[c]=0,p[u]=v,_[u]=x}for(s=0;s<_.length;s++)_[s]<i&&(_[s]=0);for(s=0;f>s;s++)for(l=s-1;l>=0;l--)if(_[l]<_[s]){for(a=_[l],_[l]=_[s],_[s]=a,u=0;u<h.length;u++)n=h[u][s],h[u][s]=h[u][l],h[u][l]=n;for(u=0;u<g.length;u++)n=g[u][s],g[u][s]=g[u][l],g[u][l]=n;s=l}return{U:h,S:_,V:g}}return t}(),F=function(){function e(t){if(void 0===t||null===t||"all"===t)return null;if("backbone"===t)return{CA:!0,C:!0,O:!0,N:!0};if(void 0!==t.substr){for(var e={},n=t.split(","),i=0;i<n.length;++i)e[n[i].trim()]=!0;return e}for(var e={},i=0;i<t.length;++i)e[t[i]]=!0;return e}function n(t,e,n,i,r){for(var o=t.atoms(),a=e.atoms(),s=0;s<o.length;++s){var l=o[s];if(null===r||r[l.name()]===!0)for(var u=0;u<a.length;++u){var c=a[u];if(c.name()===l.name()){n.push(l),i.push(c);break}}}}function i(t,i,r,o){for(var a=t.full().createEmptyView(),s=i.full().createEmptyView(),l=Math.min(t.chains().length,i.chains().length),u=e(r),c=0;l>c;++c){var h=t.chains()[c],d=i.chains()[c],f=o(h,d),p=f[0],_=f[1];if(p.length!==_.length)return console.error("chains",h.name()," and",d.name()," do not contain the same number of residues."),null;for(var g=a.addChain(h),m=s.addChain(d),v=0;v<p.length;++v){var y=p[v],b=_[v],x=[],w=[];if(n(y,b,x,w,u),0!==x.length)for(var S=g.addResidue(y),A=m.addResidue(b),k=0;k<x.length;++k)S.addAtom(x[k]),A.addAtom(w[k])}}return[a,s]}function r(t,e,n){return i(t,e,n,function(t,e){return[t.residues(),e.residues()]})}function o(t,e,n){return i(t,e,n,function(t,e){for(var n=[],i=[],r=t.residues(),o=0;o<r.length;++o){var a=e.residueByRnum(r[o].num());null!==a&&(n.push(r[o]),i.push(a))}return[n,i]})}var a=t.vec3,s=t.mat3,l=(t.quat,function(t,e){if(a.set(e,0,0,0),0!==t.length){for(var n=0;n<t.length;++n){var i=t[n];a.add(e,e,i.pos())}a.scale(e,e,1/t.length)}}),u=function(){var t=a.create(),e=a.create();return function(n,i,r,o,s){s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=0,s[6]=0,s[7]=0,s[8]=0;for(var l=0;l<i.length;++l){a.sub(t,n[l].pos(),r),a.sub(e,i[l].pos(),o);var u=t,c=e;s[0]+=u[0]*c[0],s[1]+=u[0]*c[1],s[2]+=u[0]*c[2],s[3]+=u[1]*c[0],s[4]+=u[1]*c[1],s[5]+=u[1]*c[2],s[6]+=u[2]*c[0],s[7]+=u[2]*c[1],s[8]+=u[2]*c[2]}}}(),c=function(){var t=a.create(),e=a.create(),n=a.create(),i=s.create(),r=s.create(),o=s.create(),c=s.create(),h=s.create();return function(d,f){var p=d.atoms(),_=f.atoms();if(l(_,t),l(p,e),p.length!==_.length)return console.error("atom counts do not match ("+p.length+"in structure vs "+_.length+" in reference)"),!1;if(p.length<3)return console.error("at least 3 atoms are required for superposition"),!1;u(p,_,e,t,r);var g=[[r[0],r[1],r[2]],[r[3],r[4],r[5]],[r[6],r[7],r[8]]],m=N(g);c[0]=m.U[0][0],c[1]=m.U[0][1],c[2]=m.U[0][2],c[3]=m.U[1][0],c[4]=m.U[1][1],c[5]=m.U[1][2],c[6]=m.U[2][0],c[7]=m.U[2][1],c[8]=m.U[2][2];var v=s.determinant(c);h[0]=m.V[0][0],h[1]=m.V[0][1],h[2]=m.V[0][2],h[3]=m.V[1][0],h[4]=m.V[1][1],h[5]=m.V[1][2],h[6]=m.V[2][0],h[7]=m.V[2][1],h[8]=m.V[2][2];var y=s.determinant(h);s.identity(o),0>v*y&&(console.log("determinants smaller than zero!"),o[8]=-1,s.mul(c,c,o)),console.log(s.str(c)),s.mul(i,s.transpose(h,h),c);for(var b=d.full().atoms(),x=0;x<b.length;++x){var w=b[x];a.sub(n,w.pos(),e),a.transformMat3(n,n,i),a.add(n,t,n),w.setPos(n)}return!0}}();return{superpose:c,matchResiduesByNum:o,matchResiduesByIndex:r,parseAtomNames:e,addAtomsPresentInBoth:n}}(),B=W=function(e){function n(t){for(var e=0;e<t.length();++e)a(t,e)?t.residueAt(e).setSS("H"):s(t,e)?t.residueAt(e).setSS("E"):t.residueAt(e).setSS("C")}function i(t){console.time("mol.assignHelixSheet");for(var e=t.chains(),i=0;i<e.length;++i){var r=e[i];r.eachBackboneTrace(n)}console.timeEnd("mol.assignHelixSheet")}var r=t.vec3,o=function(){var t=r.create(),e=r.create();return function(n,i,o,a){for(var s=Math.max(0,i-2);i>=s;++s)for(var l=2;5>l;++l)if(!(s+l>=n.length())){var u=r.dist(n.posAt(t,s),n.posAt(e,s+l));if(Math.abs(u-o[l-2])>a)return!1}return!0}}(),a=function(t,e){var n=[5.45,5.18,6.37],i=2.1;return o(t,e,n,i)},s=function(t,e){var n=[6.1,10.4,13],i=1.42;return o(t,e,n,i)};return{Mol:W.Mol,MolView:W.MolView,assignHelixSheet:i,superpose:e.superpose,matchResiduesByIndex:e.matchResiduesByIndex,matchResiduesByNum:e.matchResiduesByNum}}(F),z=function(e){function n(){this._assemblies={},this._current=null}function i(t){if(" "!==t[0]){var e=t.trim();if(4===e.length){for(var n=0,i=e.charCodeAt(n);4>n&&(65>i||i>122||i>90&&97>i);)++n,i=e.charCodeAt(n);return e[n]}var r=e.charCodeAt(0);return r>=48&&57>=r?e[1]:e.substr(0,2)}return t[1]}function r(t){this._helices=[],this._sheets=[],this._conect=[],this._serialToAtomMap={},this._structure=new W.Mol,this._remark350Reader=new n,this._currChain=null,this._currRes=null,this._currAtom=null,this._options={},this._options.conectRecords=!!t.conectRecords}function o(t){return t.split(/\r\n|\r|\n/g)}function a(t,e){console.time("pdb");for(var n=e||{},i=o(t),a=new r(n),s=[],l=0;l<i.length;l++){var u=a.processLine(i[l]);if(u===a.ERROR)return console.timeEnd("pdb"),null;if(u!==a.CONTINUE){var c=a.finish();if(null!==c&&s.push(c),u!==a.MODEL_COMPLETE||!n.loadAllModels)break}}var h=a.finish();return null!==h&&s.push(h),console.timeEnd("pdb"),n.loadAllModels?s:s[0]}function s(){this._structure=new W.Mol,this._reset(),this._sawEnd=!1}function l(t){console.time("sdf");for(var e=new s,n=o(t),i=0;i<n.length&&e.processLine(n[i]);i++);var r=e.finish();return console.timeEnd("sdf"),r}function u(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.onload=function(){n.response&&e(n.response)},n.send(null)}function c(t,e,n){u(t,function(t){var i=a(t,n);e(i)})}function h(t,e){u(t,function(t){var n=l(t);e(n)})}var d=t.vec3,f=t.mat4;return n.prototype={assemblies:function(){var t=[];for(var e in this._assemblies)this._assemblies.hasOwnProperty(e)&&t.push(this._assemblies[e]);return t},assembly:function(t){return this._assemblies[t]},nextLine:function(t){if(t=t.substr(11),"B"===t[0]&&"BIOMOLECULE:"===t.substr(0,12)){var n=t.substr(13).trim();return this._currentAssembly=new e.Assembly(n),void(this._assemblies[n]=this._currentAssembly)}if("APPLY THE FOLLOWING TO CHAINS:"!==t.substr(0,30)&&"                   AND CHAINS:"!==t.substr(0,30)){if("  BIOMT"===t.substr(0,7)){for(var i=parseInt(t[7],10)-1,r=0;" "!==t[12+r];)r+=1;var o=parseFloat(t.substr(13+r,9)),a=parseFloat(t.substr(23+r,9)),s=parseFloat(t.substr(33+r,9)),l=parseFloat(t.substr(43+r,14));return this._currentMatrix[0+i]=o,this._currentMatrix[4+i]=a,this._currentMatrix[8+i]=s,this._currentMatrix[12+i]=l,void(2===i&&(this._currentSymGen.addMatrix(this._currentMatrix),this._currentMatrix=f.create()))}}else{var u=t.substr(30).split(",");"A"===t[0]&&(this._currentSymGen=new e.SymGenerator,this._currentAssembly.addGenerator(this._currentSymGen)),this._currentMatrix=f.create();for(var c=0;c<u.length;++c){var h=u[c].trim();h.length&&this._currentSymGen.addChain(h)}}}},r.prototype={CONTINUE:1,MODEL_COMPLETE:2,FILE_END:3,ERROR:4,parseHelixRecord:function(t){var e=parseInt(t.substr(21,4),10),n=" "===t[25]?"\x00":t[25],i=parseInt(t.substr(33,4),10),r=" "===t[37]?"\x00":t[37],o=t[19];return this._helices.push({first:[e,n],last:[i,r],chainName:o}),!0},parseSheetRecord:function(t){var e=parseInt(t.substr(22,4),10),n=" "===t[26]?"\x00":t[26],i=parseInt(t.substr(33,4),10),r=" "===t[37]?"\x00":t[37],o=t[21];return this._sheets.push({first:[e,n],last:[i,r],chainName:o}),!0},parseAndAddAtom:function(t){var e=t[16];if(" "!==e&&"A"!==e)return!0;var n="H"===t[0],r=t[21],o=t.substr(17,3).trim(),a=t.substr(12,4),s=a.trim(),l=parseInt(t.substr(22,4),10);l!==l&&(l=1);var u=" "===t[26]?"\x00":t[26],c=!1,h=!1;this._currChain&&this._currChain.name()===r||(h=!0,c=!0),this._currRes&&this._currRes.num()===l&&this._currRes.insCode()===u||(c=!0),h&&(this._currChain=this._structure.chain(r)||this._structure.addChain(r)),c&&(this._currRes=this._currChain.addResidue(o,l,u));for(var f=d.create(),p=0;3>p;++p)f[p]=parseFloat(t.substr(30+8*p,8));var _=t.substr(76,2).trim();""===_&&(_=i(a));var g=parseFloat(t.substr(54,6).trim()),m=parseFloat(t.substr(60,6).trim()),v=this._currRes.addAtom(s,f,_,n,isNaN(g)?null:g,isNaN(m)?null:m);if(this._options.conectRecords){var y=parseInt(t.substr(6,5).trim(),10);this._serialToAtomMap[y]=v}return!0},parseConectRecord:function(t){for(var e=parseInt(t.substr(6,5).trim(),10),n=[],i=0;4>i;++i){var r=parseInt(t.substr(11+5*i,6).trim(),10);isNaN(r)||r>e||n.push(r)}return this._conect.push({from:e,to:n}),!0},processLine:function(t){var e=t.substr(0,6);if("ATOM  "===e||"HETATM"===e)return this.parseAndAddAtom(t)?this.CONTINUE:this.ERROR;if("REMARK"===e){var n=t.substr(7,3);return"350"===n&&this._remark350Reader.nextLine(t),this.CONTINUE}return"HELIX "===e?this.parseHelixRecord(t)?this.CONTINUE:this.ERROR:"SHEET "===e?this.parseSheetRecord(t)?this.CONTINUE:this.ERROR:this._options.conectRecords&&"CONECT"===e?this.parseConectRecord(t)?this.CONTINUE:this.ERROR:"END   "===e?this.FILE_END:"ENDMDL"===e?this.MODEL_COMPLETE:this.CONTINUE},finish:function(){if(null===this._currChain)return null;var t,e=null;for(t=0;t<this._sheets.length;++t){var n=this._sheets[t];e=this._structure.chain(n.chainName),e&&e.assignSS(n.first,n.last,"E")}for(t=0;t<this._helices.length;++t){var i=this._helices[t];e=this._structure.chain(i.chainName),e&&e.assignSS(i.first,i.last,"H")}this._structure.setAssemblies(this._remark350Reader.assemblies()),this._options.conectRecords&&this._assignBondsFromConectRecords(this._structure),this._structure.deriveConnectivity(),console.log("imported",this._structure.chains().length,"chain(s),",this._structure.residueCount(),"residue(s)");var r=this._structure;return this._structure=new W.Mol,this._currChain=null,this._currRes=null,this._currAtom=null,r},_assignBondsFromConectRecords:function(t){for(var e=0;e<this._conect.length;++e)for(var n=this._conect[e],i=this._serialToAtomMap[n.from],r=0;r<n.to.length;++r){var o=this._serialToAtomMap[n.to[r]];t.connect(i,o)}}},s.prototype={processLine:function(t){var e=this._state;if(3>e){if(0===e){var n=t.trim();if(0===n.length)return!1;this._title=n}return this._sawEnd=!1,this._state++,!0}if(3===e){if(this._expectedAtomCount=parseInt(t.substr(0,3).trim(),10),this._expectedBondCount=parseInt(t.substr(3,3).trim(),10),isNaN(this._expectedAtomCount)||isNaN(this._expectedBondCount))return console.error("invalid bond definition"),!1;this._state++;var i=""+(this._structure.chains().length+1);this._currentChain=this._structure.addChain(i),this._currentResidue=this._currentChain.addResidue(this._title,1)}if(4===e){for(var r=[0,0,0],o=0;3>o;++o)if(r[o]=parseFloat(t.substr(10*o,10).trim()),isNaN(r[o]))return console.error("invalid atom position"),!1;var a=t.substr(31,3).trim();this._currentResidue.addAtom(a,r,a,!1),this._atomCount++,this._atomCount===this._expectedAtomCount&&this._state++}if(5===e){var s=parseInt(t.substr(0,3).trim(),10)-1,l=parseInt(t.substr(3,3).trim(),10)-1;if(isNaN(s)||isNaN(l))return console.error("invalid bond definition"),!1;var u=this._currentResidue.atoms();this._structure.connect(u[s],u[l]),this._bondCount++,this._bondCount===this._expectedBondCount&&this._state++}return"M  END"===t.substr(0,6)&&(this._sawEnd=!0,this._state++),"$$$$"===t.substr(0,4)&&this._reset(),!0},_reset:function(){this._state=0,this._currentResidue=null,this._currentChain=null,this._expectedAtomCount=null,this._expectedBondount=null,this._atomCount=0,this._bondCount=0,this._title=""},finish:function(){return this._sawEnd?this._structure:(console.error("truncated SDF file"),null)}},{pdb:a,sdf:l,Remark350Reader:n,fetchPdb:c,fetchSdf:h,guessAtomElementFromName:i}}(E),H=function(){var e=t.vec3,n=t.mat3,i=function(){var t=e.create(),n=e.create();return function(i,r){e.set(t,0,0,0);var o=0;i.eachCentralAtom(function(n,i){e.add(t,t,i),o+=1}),0!==o&&(e.scale(t,t,1/o),r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r[8]=0,i.eachCentralAtom(function(i,o){e.sub(n,o,t);var a=n[0],s=n[1],l=n[2];r[0]+=s*s+l*l,r[1]-=a*s,r[2]-=a*l,r[5]-=s*l,r[4]+=a*a+l*l,r[8]+=a*a+s*s}),r[3]=r[1],r[6]=r[2],r[7]=r[5])}}(),r=function(){var t=n.create(),r=n.create(),o=e.create(),a=e.create(),s=e.create(),l=e.create(),u=e.create(),c=e.create(),d=e.create();return function(f){i(f,t);var p=h.diagonalizer(t);n.fromQuat(r,p);var _=!0;f.eachCentralAtom(function(t,n){e.transformMat3(s,n,r),_?(e.copy(o,s),e.copy(a,s),_=!1):(e.min(o,o,s),e.max(a,a,s))}),e.sub(l,a,o);var g=[[l[0],0],[l[1],1],[l[2],2]];
g.sort(function(t,e){return e[0]-t[0]});var m=g[0][1],v=g[1][1];e.set(u,r[m+0],r[m+3],r[m+6]),e.set(c,r[v+0],r[v+3],r[v+6]),e.cross(d,u,c);var y=n.create();return y[0]=u[0],y[1]=c[0],y[2]=d[0],y[3]=u[1],y[4]=c[1],y[5]=d[1],y[6]=u[2],y[7]=c[2],y[8]=d[2],y}}();return{principalAxes:r}}(),q=function(){return{Viewer:T.Viewer,isWebGLSupported:T.isWebGLSupported,io:z,color:e,mol:W,rgb:{setColorPalette:e.setColorPalette,hex2rgb:e.hex2rgb},vec3:t.vec3,vec4:t.vec4,mat3:t.mat3,mat4:t.mat4,quat:t.quat,viewpoint:H}}()})},function(t,e,n){"use strict";function i(t,e,n){this.min=e,this.max=n,this.chr=t}function r(t){if(t||(t={}),this.prefix="//www.biodalliance.org/release-0.13/",this.sources=[],this.tiers=[],this.tierGroups={},this.featureListeners=[],this.featureHoverListeners=[],this.viewListeners=[],this.regionSelectListeners=[],this.tierListeners=[],this.tierSelectionListeners=[],this.tierSelectionWrapListeners=[],this.cookieKey="browser",this.chains={},this.pageName="svgHolder",this.maxExtra=2.5,this.minExtra=.5,this.zoomFactor=1,this.maxPixelsPerBase=10,this.origin=0,this.targetQuantRes=1,this.featurePanelWidth=750,this.zoomBase=100,this.zoomExpt=30,this.zoomSliderValue=100,this.entryPoints=null,this.currentSeqMax=-1,this.highlights=[],this.selectedTiers=[1],this.maxViewWidth=5e5,this.defaultSubtierMax=100,this.reverseScrolling=!1,this.rulerLocation="center",this.defaultHighlightFill="red",this.defaultHighlightAlpha=.3,this.exportHighlights=!0,this.exportRuler=!0,this.singleBaseHighlight=!0,this.tierBackgroundColors=["rgb(245,245,245)","white"],this.minTierHeight=20,this.noDefaultLabels=!1,this.availableSources=new h,this.defaultSources=[],this.mappableSources={},this.registry=null,this.noRegistryTabs=!0,this.hubs=[],this.hubObjects=[],this.sourceCache=new u,this.retina=!0,this.useFetchWorkers=!0,this.maxWorkers=2,this.workerPath="$$worker-all.js",this.assemblyNamePrimary=!0,this.assemblyNameUcsc=!0,this.httpCanaryURL="http://www.biodalliance.org/http-canary.txt",this.httpWarningURL="//www.biodalliance.org/https.html",this.initListeners=[],t.baseColors?this.baseColors=t.baseColors:this.baseColors={A:"green",C:"blue",G:"orange",T:"red","-":"hotpink",I:"red"},void 0!==t.viewStart&&"number"!=typeof t.viewStart)throw Error("viewStart must be an integer");if(void 0!==t.viewEnd&&"number"!=typeof t.viewEnd)throw Error("viewEnd must be an integer");if(void 0!==t.offscreenInitWidth&&"number"!=typeof t.offscreenInitWidth)throw Error("offscreenInitWidth must be an integer");for(var e in t)this[e]=t[e];if("string"==typeof t.uiPrefix&&"string"!=typeof t.prefix&&(this.prefix=t.uiPrefix),this.prefix.indexOf("//")<0&&0===this.prefix.indexOf("/")){var n=window.location.hostname;window.location.port&&(n+=":"+window.location.port),this.prefix="//"+n+this.prefix}if(0===this.prefix.indexOf("//")){var i=window.location.protocol;"http:"==i||"https:"==i||(console.log(window.location.protocol),console.log("WARNING: prefix is set to a protocol-relative URL ("+this.prefix+" when loading from a non-HTTP source"),this.prefix="http:"+this.prefix)}if(!this.coordSystem)throw Error("Coordinate system must be configured");if(void 0===this.chr||void 0===this.viewStart||void 0===this.viewEnd)throw Error("Viewed region (chr:start..end) must be defined");var r=this;if("complete"===document.readyState)r.realInit();else{var o=function(t){window.removeEventListener("load",o,!1),r.realInit()};window.addEventListener("load",o,!1)}}function o(t,e,n){if(n)for(var i=0;i<e.length;++i)e[i].mapping=n;t.set(e)}function a(t,e,n,i){i=i||[];for(var r=t.length-1;r>=0;--r){var o=t[r];if(!o.notSelectable&&o.min()<=e&&o.max()>=e){if(o.minY&&(n<o.minY()||n>o.maxY()))continue;return o.feature?i.push(o.feature):o.group&&i.push(o.group),o.glyphs?a(o.glyphs,e,n,i):o.glyph?a([o.glyph],e,n,i):i}}return i}function s(t,e){var n=this;this.tagSeed=0,this.callbacks={},this.browser=t,this.worker=e,this.worker.onmessage=function(t){var e=n.callbacks[t.data.tag];e&&(e(t.data.result,t.data.error),delete n.callbacks[t.data.tag])}}function l(t){var e=t.resolveURL(t.workerPath);if(0==e.indexOf("//")){var n=window.location.protocol;e="https:"==n?"https:"+e:"http:"+e}var i='importScripts("'+e+"?version="+S+'");',r=new Blob([i],{type:"application/javascript"});return new E(function(e,n){var i=new Worker(URL.createObjectURL(r));i.onmessage=function(n){"init"===n.data.tag&&(console.log("Worker initialized"),e(new s(t,i)))},i.onerror=function(t){n(t.message)}})}function u(){this.sourcesByURI={}}var c=n(248),h=c.Observed,d=(c.Awaited,c.makeElement),f=c.removeChildren,p=c.miniJSONify,_=c.shallowCopy,g=c.textXHR,m=n(250),v=m.DasTier,y=n(249),b=y.hex_sha1,x=n(274),w=x.connectTrackHub,S=n(275),A=n(272),k=A.formatQuantLabel,C=A.formatLongInt,T=n(276).Chainset,E=n(255).Promise,M=n(254),L=M.sourcesAreEqual,R=M.sourcesAreEqualModuloStyle,O=M.sourceDataURI;M.sourceStyleURI;r.prototype.resolveURL=function(t){return t.replace("$$",this.prefix)},r.prototype.destroy=function(){window.removeEventListener("resize",this.resizeListener,!1)},r.prototype.realInit=function(){var t=this;if(this.wasInitialized)return void console.log("Attemping to call realInit on an already-initialized Dalliance instance");this.wasInitialized=!0;var e=navigator.userAgent||"dummy";e.indexOf("Trident")>=0&&e.indexOf("rv:11")>=0&&(this.disablePinning=!0),this.defaultChr=this.chr,this.defaultStart=this.viewStart,this.defaultEnd=this.viewEnd,this.defaultSources=[];for(var n=0;n<this.sources.length;++n){var i=this.sources[n];i&&this.defaultSources.push(i)}this.restoreStatus&&(this.statusRestored=this.restoreStatus());var r=this;this.browserHolderHolder=document.getElementById(this.pageName),this.browserHolderHolder.classList.add("dalliance-injection-point"),this.browserHolder=d("div",null,{className:"dalliance dalliance-root",tabIndex:-1}),this.maxHeight?this.browserHolder.style.maxHeight=this.maxHeight+"px":void 0!=this.maxHeight&&(this.browserHolder.style.maxHeight=null),f(this.browserHolderHolder),this.browserHolderHolder.appendChild(this.browserHolder),this.svgHolder=d("div",null,{className:"main-holder"}),this.initUI(this.browserHolder,this.svgHolder),this.pinnedTierHolder=d("div",null,{className:"tier-holder tier-holder-pinned"}),this.tierHolder=d("div",this.makeLoader(24),{className:"tier-holder tier-holder-rest"}),this.locSingleBase=d("span","",{className:"loc-single-base"});var o=d("div",this.locSingleBase,{className:"loc-single-base-holder"});this.addViewListener(function(e,n,i,r,o,a,s){var l=Math.round((s+a)/2);t.locSingleBase.appendChild(document.createTextNode(e+":"+C(l))),t.locSingleBase.removeChild(t.locSingleBase.firstChild)}),this.disablePinning?this.tierHolderHolder=this.tierHolder:(this.tierHolderHolder=d("div",[o,this.pinnedTierHolder,this.tierHolder],{className:"tier-holder-holder"}),this.svgHolder.appendChild(this.tierHolderHolder)),this.svgHolder.appendChild(this.tierHolderHolder),this.bhtmlRoot=d("div"),this.disablePoweredBy||this.bhtmlRoot.appendChild(d("span",["Powered by ",d("a","Biodalliance",{href:"http://www.biodalliance.org/"})," "+S],{className:"powered-by"})),this.browserHolder.appendChild(this.bhtmlRoot),this.resizeListener=function(t){r.resizeViewer()},window.addEventListener("resize",this.resizeListener,!1),this.ruler=d("div",null,{className:"guideline"}),this.ruler2=d("div",null,{className:"single-base-guideline"}),this.tierHolderHolder.appendChild(this.ruler),this.tierHolderHolder.appendChild(this.ruler2),this.chainConfigs=this.chains||{},this.chains={};for(var a in this.chainConfigs){var s=this.chainConfigs[a];s instanceof T&&console.log('WARNING: Should no longer use "new Chainset" in Biodalliance configurations.'),this.chains[a]=new T(s)}var u;if(this.maxWorkers>0){for(var c=[],h=0;h<this.maxWorkers;++h)c.push(l(this));u=E.all(c)}else u=E.resolve([]);this.fetchWorkers=null,this.nextWorker=0,u.then(function(t){console.log("Booted "+t.length+" workers"),r.fetchWorkers=t},function(t){console.log("Failed to boot workers",t)}).then(function(){if(t.offscreenInitWidth||"none"!=window.getComputedStyle(r.browserHolderHolder).display&&r.tierHolder.getBoundingClientRect().width>0)setTimeout(function(){r.realInit2()},1);else var e=setInterval(function(){"none"!=window.getComputedStyle(r.browserHolderHolder).display&&r.tierHolder.getBoundingClientRect().width>0&&(clearInterval(e),r.realInit2())},300)})},r.prototype.realInit2=function(){var t=this;f(this.tierHolder),f(this.pinnedTierHolder),this.featurePanelWidth=this.tierHolder.getBoundingClientRect().width|t.offscreenInitWidth|0,this.scale=this.featurePanelWidth/(this.viewEnd-this.viewStart),this.zoomMax||(this.zoomMax=this.zoomExpt*Math.log(this.maxViewWidth/this.zoomBase),this.zoomMin=this.zoomExpt*Math.log(this.featurePanelWidth/this.maxPixelsPerBase/this.zoomBase)),this.zoomSliderValue=this.zoomExpt*Math.log((this.viewEnd-this.viewStart+1)/this.zoomBase),this.tierHolderHolder.addEventListener("mousewheel",function(e){if(e.stopPropagation(),e.preventDefault(),e.wheelDeltaX){var n=e.wheelDeltaX/5;t.reverseScrolling||(n=-n),t.move(n)}if(e.wheelDeltaY){var n=e.wheelDeltaY;t.reverseScrolling&&(n=-n),t.tierHolder.scrollTop+=n}},!1),this.tierHolderHolder.addEventListener("MozMousePixelScroll",function(e){if(e.stopPropagation(),e.preventDefault(),1==e.axis){if(0!=e.detail){var n=e.detail/4;t.reverseScrolling&&(n=-n),t.move(n)}}else{var n=e.detail;t.reverseScrolling||(n=-n),t.tierHolder.scrollTop+=n}},!1),this.tierHolderHolder.addEventListener("touchstart",function(e){return t.touchStartHandler(e)},!1),this.tierHolderHolder.addEventListener("touchmove",function(e){return t.touchMoveHandler(e)},!1),this.tierHolderHolder.addEventListener("touchend",function(e){return t.touchEndHandler(e)},!1),this.tierHolderHolder.addEventListener("touchcancel",function(e){return t.touchCancelHandler(e)},!1);var e=function(e){if(13==e.keyCode){for(var n=!1,i=0;i<t.tiers.length;++i){var r=t.tiers[i];r.wantedLayoutHeight&&r.wantedLayoutHeight!=r.layoutHeight&&(r.layoutHeight=r.wantedLayoutHeight,r.clipTier(),n=!0)}n&&t.arrangeTiers()}else if(32==e.keyCode||32==e.charCode){if(t.isSnapZooming){t.isSnapZooming=!1;var o=(t.savedZoom||20)+t.zoomMin;t.savedZoom=t.zoomSliderValue-t.zoomMin,t.zoomSliderValue=o,t.zoom(Math.exp(1*o/t.zoomExpt))}else{t.isSnapZooming=!0;var o=(t.savedZoom||0)+t.zoomMin;t.savedZoom=t.zoomSliderValue-t.zoomMin,t.zoomSliderValue=o,t.zoom(Math.exp(1*o/t.zoomExpt))}e.stopPropagation(),e.preventDefault()}else if(85==e.keyCode){if("opts"===t.uiMode){var a=document.getElementById("singleBaseHightlightButton").checked;document.getElementById("singleBaseHightlightButton").checked=!a}t.singleBaseHighlight=!t.singleBaseHighlight,t.positionRuler(),e.stopPropagation(),e.preventDefault()}else if(39==e.keyCode)e.stopPropagation(),e.preventDefault(),t.scrollArrowKey(e,-1);else if(37==e.keyCode)e.stopPropagation(),e.preventDefault(),t.scrollArrowKey(e,1);else if(38==e.keyCode||87==e.keyCode)if(e.stopPropagation(),e.preventDefault(),e.shiftKey){var s=t.getSelectedTier();if(0>s)return;var l=t.tiers[s],u=l.forceHeight||l.subtiers[0].height;u>=40&&l.mergeConfig({height:u-10})}else if(e.ctrlKey||e.metaKey){var s=t.getSelectedTier();if(0>s)return;var l=t.tiers[s];if(l.quantLeapThreshold){var c=l.subtiers[0].height,h=l.subtiers[0].quant;if(!h)return;var d=1*h.min,f=1*h.max,p=(f-d)/c;l.mergeConfig({quantLeapThreshold:d+((0|Math.round((l.quantLeapThreshold-d)/p))+1)*p}),l.notify("Threshold: "+k(l.quantLeapThreshold))}}else if(e.altKey){var _=t.selectedTiers.length;if(0==_)return;for(var s=t.selectedTiers[0],g=!0,m=[],v=0;v<t.selectedTiers.length;++v)m.push(t.tiers[t.selectedTiers[v]]),v>0&&t.selectedTiers[v]-t.selectedTiers[v-1]!=1&&(g=!1);if(g&&0>=s)return;for(var v=t.selectedTiers.length-1;v>=0;--v)t.tiers.splice(t.selectedTiers[v],1);t.selectedTiers.splice(0,_);for(var y=g?s-1:s,v=0;v<m.length;++v)t.tiers.splice(y+v,0,m[v]),t.selectedTiers.push(y+v);t.withPreservedSelection(t._ensureTiersGrouped),t.markSelectedTiers(),t.notifyTierSelection(),t.reorderTiers(),t.notifyTier("selected",s)}else{var s=t.getSelectedTier();if(s>0){t.setSelectedTier(s-1);var b=t.tiers[t.getSelectedTier()],x=b.row.offsetTop,w=x+b.row.offsetHeight;(x<t.tierHolder.scrollTop||w>t.tierHolder.scrollTop+t.tierHolder.offsetHeight)&&(t.tierHolder.scrollTop=x)}else t.notifyTierSelectionWrap(-1)}else if(40==e.keyCode||83==e.keyCode)if(e.stopPropagation(),e.preventDefault(),e.shiftKey){var s=t.getSelectedTier();if(0>s)return;var l=t.tiers[s],u=l.forceHeight||l.subtiers[0].height;l.mergeConfig({height:u+10})}else if(e.ctrlKey||e.metaKey){var s=t.getSelectedTier();if(0>s)return;var l=t.tiers[s];if(l.quantLeapThreshold){var c=l.subtiers[0].height,h=l.subtiers[0].quant;if(!h)return;var d=1*h.min,f=1*h.max,p=(f-d)/c,S=0|Math.round((l.quantLeapThreshold-d)/p);S>1&&(l.mergeConfig({quantLeapThreshold:d+(S-1)*p}),l.notify("Threshold: "+k(l.quantLeapThreshold)))}}else if(e.altKey){var _=t.selectedTiers.length;if(0==_)return;for(var s=t.selectedTiers[0],A=0,m=[],v=0;v<t.selectedTiers.length;++v)m.push(t.tiers[t.selectedTiers[v]]),v>0&&(A+=t.selectedTiers[v]-t.selectedTiers[v-1]-1);var g=0==A;if(g&&s+_>=t.tiers.length)return;for(var v=t.selectedTiers.length-1;v>=0;--v)t.tiers.splice(t.selectedTiers[v],1);t.selectedTiers.splice(0,_);for(var y=g?s+1:s+A,v=0;v<m.length;++v)t.tiers.splice(y+v,0,m[v]),t.selectedTiers.push(y+v);t.withPreservedSelection(function(){t._ensureTiersGrouped(!0)}),t.markSelectedTiers(),t.notifyTierSelection(),t.reorderTiers(),t.notifyTier("selected",s)}else{var s=t.getSelectedTier();if(s<t.tiers.length-1){t.setSelectedTier(s+1);var b=t.tiers[t.getSelectedTier()],x=b.row.offsetTop,w=x+b.row.offsetHeight;(x<t.tierHolder.scrollTop||w>t.tierHolder.scrollTop+t.tierHolder.offsetHeight)&&(t.tierHolder.scrollTop=Math.min(x,w-t.tierHolder.offsetHeight))}}else if(187==e.keyCode||61==e.keyCode)e.stopPropagation(),e.preventDefault(),t.zoomStep(-10);else if(189==e.keyCode||173==e.keyCode)e.stopPropagation(),e.preventDefault(),t.zoomStep(10);else if(73==e.keyCode||105==e.keyCode){e.stopPropagation(),e.preventDefault();var s=t.getSelectedTier();if(0>s)return;var r=t.tiers[s];r.infoVisible?(r.infoElement.style.display="none",r.updateHeight(),r.infoVisible=!1):(r.infoElement.style.display="block",r.updateHeight(),r.infoVisible=!0)}else if(84==e.keyCode||116==e.keyCode){var C;if(e.shiftKey){e.stopPropagation(),e.preventDefault();for(var i=0;i<t.tiers.length;++i){var r=t.tiers[i];r.dasSource.collapseSuperGroups&&(void 0===C&&(C=!r.bumped),r.mergeConfig({bumped:C}))}}else if(!e.ctrlKey&&!e.metaKey){e.stopPropagation(),e.preventDefault();var s=t.getSelectedTier();if(0>s)return;var r=t.tiers[s];r.dasSource.collapseSuperGroups&&(void 0===C&&(C=!r.bumped),r.mergeConfig({bumped:C}))}}else if(77==e.keyCode||109==e.keyCode)e.stopPropagation(),e.preventDefault(),(e.ctrlKey||e.metaKey)&&t.selectedTiers.length>1&&t.mergeSelectedTiers();else if(68==e.keyCode||100==e.keyCode){if(e.stopPropagation(),e.preventDefault(),e.ctrlKey||e.metaKey){var s=t.getSelectedTier();if(0>s)return;t.addTier(t.tiers[s].dasSource)}}else if((80==e.keyCode||112==e.keyCode)&&(e.ctrlKey||e.metaKey)){for(var l=[],s=0;s<t.selectedTiers.length;++s)l.push(t.tiers[t.selectedTiers[s]]);for(var i=0;i<l.length;++i)l[i].mergeConfig({pinned:!l[i].pinned})}};this.browserHolder.addEventListener("focus",function(n){t.browserHolder.addEventListener("keydown",e,!1)},!1),this.browserHolder.addEventListener("blur",function(n){t.browserHolder.removeEventListener("keydown",e,!1)},!1),this.hPopupHolder=d("div"),this.hPopupHolder.style["font-family"]="helvetica",this.hPopupHolder.style["font-size"]="12pt",this.hPopupHolder.classList.add("dalliance"),document.body.appendChild(this.hPopupHolder);for(var n=0;n<this.sources.length;++n){var i=this.sources[n];if(i){var r={};this.restoredConfigs&&(r=this.restoredConfigs[n]),i.disabled||this.makeTier(i,r).then(function(e){t.refreshTier(e)})}}t._ensureTiersGrouped(),t.arrangeTiers(),t.reorderTiers();var o=this.getSequenceSource();o&&o.getSeqInfo(this.chr,function(e){e?t.currentSeqMax=e.length:t.currentSeqMax=-1}),this.queryRegistry();for(var a in this.chains)this.queryRegistry(a,!0);if(this.hubs)for(var s=0;s<this.hubs.length;++s){var l=this.hubs[s];"string"==typeof l&&(l={url:l}),function(e){w(e.url,function(n,i){if(i)console.log(i);else{var r;r=e.genome?n.genomes[e.genome]:n.genomes[t.coordSystem.ucscName],r&&(e.mapping&&(r.mapping=e.mapping),t.hubObjects.push(r))}},e)}(l)}this.fullScreen&&this.setFullScreenHeight(),!this.statusRestored&&this.storeStatus&&this.storeStatus(),t.setLocation(this.chr,this.viewStart,this.viewEnd,function(){t.setSelectedTier(1);for(var e=0;e<t.initListeners.length;++e)try{t.initListeners[e].call(t)}catch(n){console.log(n)}})},r.prototype.touchStartHandler=function(t){if(this.touchOriginX=t.touches[0].pageX,this.touchOriginY=t.touches[0].pageY,2==t.touches.length){var e=Math.abs(t.touches[0].pageX-t.touches[1].pageX);this.zooming=!0,this.zoomLastSep=this.zoomInitialSep=e,this.zoomInitialScale=this.scale}},r.prototype.touchMoveHandler=function(t){if(t.stopPropagation(),t.preventDefault(),1==t.touches.length){var e=t.touches[0].pageX,n=t.touches[0].pageY;this.touchOriginX&&e!=this.touchOriginX&&this.move(e-this.touchOriginX),this.touchOriginY&&n!=this.touchOriginY&&(this.tierHolder.scrollTop-=n-this.touchOriginY),this.touchOriginX=e,this.touchOriginY=n}else if(this.zooming&&2==t.touches.length){var i=Math.abs(t.touches[0].pageX-t.touches[1].pageX);if(i!=this.zoomLastSep){var r=(t.touches[0].pageX+t.touches[1].pageX)/2,o=this.viewStart+r/this.scale|0;this.scale=this.zoomInitialScale*(i/this.zoomInitialSep),this.viewStart=o-r/this.scale|0;for(var a=0;a<this.tiers.length;++a)this.tiers[a].draw()}this.zoomLastSep=i}},r.prototype.touchEndHandler=function(t){},r.prototype.touchCancelHandler=function(t){},r.prototype.makeTier=function(t,e){try{return this.realMakeTier(t,e)}catch(n){console.log("Error initializing",t),console.log(n.stack||n)}},r.prototype.realMakeTier=function(t,e){var n=this,i=null;this.tierBackgroundColors&&(i=this.tierBackgroundColors[this.tiers.length%this.tierBackgroundColors.length]);var r=new v(this,t,e,i);r.oorigin=this.viewStart;var o,s,l,u=!1,c=function(t,e){var i=r.subtiers;if(i){var o=0;for(e-=r.padding;o<i.length&&e>i[o].height&&o<i.length-1;)e=e-i[o].height-r.padding,++o;if(!(o>=i.length)){var s=i[o].glyphs,l=((n.viewStart+n.viewEnd)/2,(r.glyphCacheOrigin-n.viewStart)*n.scale);return t-=l,a(s,t,e)}}},h=function(t){t.preventDefault(),t.stopPropagation();var e=t.clientX;e!=s&&(n.move(e-s,!0),s=e),n.isDragging=!0},d=function(t){window.removeEventListener("mousemove",h,!0),window.removeEventListener("mouseup",d,!0),n.move(t.clientX-s)};r.viewport.addEventListener("mousedown",function(t){n.browserHolder.focus(),t.preventDefault();var e=(r.row.getBoundingClientRect(),t.clientX);t.clientY;window.addEventListener("mousemove",h,!0),window.addEventListener("mouseup",d,!0),o=s=e,n.isDragging=!1},!1),r.viewport.addEventListener("mousemove",function(t){var e=r.row.getBoundingClientRect(),i=t.clientX-e.left,o=t.clientY-e.top,a=c(i,o);a&&a.length>0?r.row.style.cursor="pointer":r.row.style.cursor="default",l&&clearTimeout(l),u||(l=setTimeout(function(){var e=c(i,o);e&&e.length>0&&n.notifyFeatureHover(t,e[e.length-1],e,r)},1e3))});var f=null;r.viewport.addEventListener("mouseup",function(t){var e=r.row.getBoundingClientRect(),i=t.clientX-e.left,a=t.clientY-e.top,s=c(i,a);if(s&&s.length>0&&!n.isDragging&&(f?(clearTimeout(f),f=null,n.featureDoubleClick(s,i,a)):f=setTimeout(function(){f=null,n.notifyFeature(t,s[s.length-1],s,r)},500)),n.isDragging&&i!=o&&r.sequenceSource){var l,u,h=n.viewStart+i/n.scale,d=n.viewStart+o/n.scale;d>h?(l=0|h,u=0|d):(l=0|d,u=0|h),n.notifyRegionSelect(n.chr,l,u)}n.isDragging=!1},!1),r.viewport.addEventListener("mouseout",function(t){u=!1}),r.removeButton.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault();for(var e=0;e<n.tiers.length;++e)if(n.tiers[e]===r){n.removeTier({index:e});break}},!1),r.nameButton.addEventListener("click",function(t){if(t.stopPropagation(),t.preventDefault(),t.shiftKey){for(var e=-1,i=0;i<n.tiers.length;++i)if(n.tiers[i]===r){e=i;break}if(e>=0){var o=n.selectedTiers.indexOf(e);o>=0?n.selectedTiers.splice(o,1):(n.selectedTiers.push(e),n.selectedTiers.sort()),n.markSelectedTiers(),n.notifyTierSelection(),n.selectedTiers.length>0?n.browserHolder.focus():n.notifyTierSelectionWrap(-1)}}else{for(var i=0;i<n.tiers.length;++i)if(n.tiers[i]===r&&(n.browserHolder.focus(),1!=n.selectedTiers.length||n.selectedTiers[0]!=i))return void n.setSelectedTier(i);r.infoVisible?(r.infoElement.style.display="none",r.updateHeight(),r.infoVisible=!1):(r.infoElement.style.display="block",r.updateHeight(),r.infoVisible=!0)}},!1),r.bumpButton.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault();var e,n=r;n.dasSource.collapseSuperGroups&&(void 0===e&&(e=!n.bumped),n.mergeConfig({bumped:e}))},!1);var p,_,g,m,y,b=!1,x=function(t){var e=r.label;if(t.stopPropagation(),t.preventDefault(),!p){_=r.pinned?n.pinnedTierHolder:n.tierHolder,g=_.scrollHeight-_.offsetHeight,p=e.cloneNode(!0),p.style.cursor="pointer",_.appendChild(p),e.style.visibility="hidden";for(var i=0;i<n.tiers.length;++i)if(n.tiers[i]===r){m=i;break}y=t.clientY}var o=_.getBoundingClientRect();p.style.left=e.getBoundingClientRect().left-o.left+"px",p.style.top=t.clientY-o.top+_.scrollTop-10+"px";for(var a=t.clientY-o.top+_.scrollTop,i=0;i<n.tiers.length;++i){var s=n.tiers[i];if(!(s.pinned^r.pinned)){var l=s.row.getBoundingClientRect();if(a-=l.bottom-l.top,0>a){if(m>i&&t.clientY<y||i>m&&t.clientY>y){n.withPreservedSelection(function(){n.tiers.splice(m,1),n.tiers.splice(i,0,r),n._ensureTiersGrouped(i>m)});for(var u=0;u<n.tiers.length;++u)n.tiers[u]==r&&(m=u);y=t.clientY,n.reorderTiers(),_.appendChild(p),b=!0}break}}}p.offsetTop<_.scrollTop?_.scrollTop-=_.scrollTop-p.offsetTop:p.offsetTop+p.offsetHeight>_.scrollTop+_.offsetHeight&&(_.scrollTop=Math.min(_.scrollTop+(p.offsetTop+p.offsetHeight)-(_.scrollTop+_.offsetHeight),g))},w=function(t){var e=r.label;if(t.stopPropagation(),t.preventDefault(),p&&(p.style.cursor="auto",_.removeChild(p),p=null,e.style.visibility="visible"),document.removeEventListener("mousemove",x,!1),document.removeEventListener("mouseup",w,!1),b){for(var i=0;i<n.tiers.length;++i)if(n.tiers[i]==r){n.setSelectedTier(i);break}n.notifyTier("reordered",r)}};return r.label.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),b=!1,document.addEventListener("mousemove",x,!1),document.addEventListener("mouseup",w,!1)},!1),this.tiers.push(r),r.init().then(function(t){return t.currentlyHeight=50,n.updateHeight(),t.updateLabel(),n.withPreservedSelection(n._ensureTiersGrouped),t._updateFromConfig(),n.reorderTiers(),t})},r.prototype.reorderTiers=function(){f(this.tierHolder),f(this.pinnedTierHolder),this.disablePinning&&(this.tierHolder.appendChild(this.ruler),this.tierHolder.appendChild(this.ruler2));for(var t=!1,e=[],n=[],i=0;i<this.tiers.length;++i){var r=this.tiers[i];r.pinned&&!this.disablePinning?(e.push(r),this.pinnedTierHolder.appendChild(this.tiers[i].row),t=!0):(n.push(r),this.tierHolder.appendChild(this.tiers[i].row))}this.withPreservedSelection(function(){this.tiers.splice(0,this.tiers.length);for(var t=0;t<e.length;++t)this.tiers.push(e[t]);for(var t=0;t<n.length;++t)this.tiers.push(n[t])}),t?this.pinnedTierHolder.classList.add("tier-holder-pinned-full"):this.pinnedTierHolder.classList.remove("tier-holder-pinned-full"),this.arrangeTiers()},r.prototype.withPreservedSelection=function(t){for(var e=[],n=0;n<this.selectedTiers.length;++n)e.push(this.tiers[this.selectedTiers[n]]);t.call(this),this.selectedTiers=[];for(var i=0;i<this.tiers.length;++i)e.indexOf(this.tiers[i])>=0&&this.selectedTiers.push(i)},r.prototype.refreshTier=function(t,e){e=e||P,this.knownSpace&&this.knownSpace.invalidate(t,e)},r.prototype._ensureTiersGrouped=function(t){for(var e={},n=0;n<this.tiers.length;++n){var i=this.tiers[n];i.dasSource.tierGroup&&pusho(e,i.dasSource.tierGroup,i)}var r=[];t&&this.tiers.reverse();for(var n=0;n<this.tiers.length;++n){var i=this.tiers[n];if(i.dasSource.tierGroup){var o=e[i.dasSource.tierGroup];if(o){t&&o.reverse();for(var a=0;a<o.length;++a)r.push(o[a]);e[i.dasSource.tierGroup]=null}}else r.push(i)}t&&r.reverse(),this.tiers.splice(0,this.tiers.length);for(var a=0;a<r.length;++a)this.tiers.push(r[a])},r.prototype.arrangeTiers=function(){for(var t=[],e={},n=0;n<this.tiers.length;++n){var i=this.tiers[n];i.pinned&&(t.push(i),i.dasSource.tierGroup&&pusho(e,i.dasSource.tierGroup,i))}for(var n=0;n<this.tiers.length;++n){var i=this.tiers[n];i.pinned||(t.push(i),i.dasSource.tierGroup&&pusho(e,i.dasSource.tierGroup,i))}for(var r in e){var o=e[r],a=this.tierGroups[r];a||(a={element:d("div",d("span",r,{className:"tier-group-label"}),{className:"tier-group"})},this.tierGroups[r]=a),a.element.parentNode&&a.element.parentNode.removeChild(a.element);for(var s=o[0].pinned?this.pinnedTierHolder:this.tierHolder,l=1e7,u=0,n=0;n<o.length;++n){var c=o[n].row;l=Math.min(l,c.offsetTop),u=Math.max(u,c.offsetTop+c.offsetHeight)}a.element.style.top=l+"px",a.element.style.left="0px",a.element.style.height=u-l+"px",s.appendChild(a.element)}if(this.tierBackgroundColors)for(var n=0;n<t.length;++n){var i=t[n];i.setBackground(this.tierBackgroundColors[n%this.tierBackgroundColors.length]),i.dasSource.tierGroup?i.label.style.left="18px":i.label.style.left="2px",i.background=this.tierBackgroundColors[n%this.tierBackgroundColors.length]}},r.prototype.refresh=function(){this.retrieveTierData(this.tiers,P),this.drawOverlays(),this.positionRuler()};var P=function(t,e){e.draw(),e.updateStatus(t)};r.prototype.retrieveTierData=function(t,e){this.notifyLocation();var n=(this.viewEnd-this.viewStart+1,100/this.scale|0),i=1e3/this.scale|0,r=(this.viewStart+this.viewEnd)/2,o=r-this.origin;this.origin=r,this.scaleAtLastRedraw=this.scale;for(var a=0;a<t.length;++a){var s=o;t[a].originHaxx&&(s+=t[a].originHaxx),t[a].originHaxx=s}var l=this.targetQuantRes/this.scale,u=Math.max(1,(0|this.viewStart)-n),c=Math.min((0|this.viewEnd)+n,(0|this.currentSeqMax)>0?0|this.currentSeqMax:1e9),h=Math.max(1,(0|this.viewStart)-i),d=Math.min((0|this.viewEnd)+i,(0|this.currentSeqMax)>0?0|this.currentSeqMax:1e9);if(!this.knownSpace||this.knownSpace.chr!==this.chr){var f=this.getSequenceSource();this.knownSpace&&this.knownSpace.cancel(),this.knownSpace=new F(this.tiers,this.chr,h,d,l,f)}var p=this.knownSpace.bestCacheOverlapping(this.chr,u,c);p&&p.min<=u&&p.max>=c?(this.drawnStart=Math.max(p.min,h),this.drawnEnd=Math.min(p.max,d)):(this.drawnStart=h,this.drawnEnd=d),this.knownSpace.retrieveFeatures(t,this.chr,this.drawnStart,this.drawnEnd,l,e)},r.prototype.queryRegistry=function(t,e){if(this.registry){var n,i,r=this;t?(n=this.chains[t].coords,r.mappableSources[t]||(r.mappableSources[t]=new h),i=r.mappableSources[t]):(n=this.coordSystem,i=this.availableSources);var a=b(p(n));if(e){var s=localStorage["dalliance.registry."+a+".last_queried"];if(s)try{o(i,JSON.parse(localStorage["dalliance.registry."+a+".sources"]),t);var l=(0|Date.now())-(0|s);if(432e5>l)return}catch(u){console.log("Bad registry cache: "+u)}}var c=this.registry;if(0==c.indexOf("//")){var d=window.location.protocol;"https:"!=d&&"http:"!=d&&(c="http:"+c)}new B(c).sources(function(e){for(var r=[],s=0;s<e.length;++s){var l=e[s];if(l.coords&&0!=l.coords.length){var u=l.coords[0];u.taxon==n.taxon&&u.auth==n.auth&&u.version==n.version&&r.push(l)}}localStorage["dalliance.registry."+a+".sources"]=JSON.stringify(r),localStorage["dalliance.registry."+a+".last_queried"]=""+Date.now(),o(i,r,t)},function(t){},n)}},r.prototype.move=function(t,e){var n=this.viewEnd-this.viewStart,i=this.viewStart-1*t/this.scale,r=i+n;e||(this.currentSeqMax>0&&r>this.currentSeqMax&&(r=this.currentSeqMax,i=this.viewEnd-n),1>i&&(i=1,r=i+n)),this.setLocation(null,i,r,null,e)},r.prototype.zoomStep=function(t){var e=1*this.zoomSliderValue,n=e+t;n<this.zoomMin&&(n=this.zoomMin),n>this.zoomMax&&(n=this.zoomMax),n!=e&&(this.zoomSliderValue=n,this.zoom(Math.exp(1*n/this.zoomExpt)))},r.prototype.zoom=function(t){this.zoomFactor=t;var e=0|Math.round((this.viewStart+this.viewEnd)/2);if(this.viewStart=e-this.zoomBase*this.zoomFactor/2,this.viewEnd=e+this.zoomBase*this.zoomFactor/2,this.currentSeqMax>0&&this.viewEnd>this.currentSeqMax+5){var n=this.viewEnd-this.viewStart+1;this.viewEnd=this.currentSeqMax,this.viewStart=this.viewEnd-n+1}if(this.viewStart<1){var n=this.viewEnd-this.viewStart+1;this.viewStart=1,this.viewEnd=this.viewStart+n-1}this.scale=this.featurePanelWidth/(this.viewEnd-this.viewStart);this.viewEnd-this.viewStart+1,this.scale/this.scaleAtLastRedraw;this.notifyLocation(),this.refresh()},r.prototype.spaceCheck=function(t){if(!this.knownSpace||this.knownSpace.chr!==this.chr)return void this.refresh();var e=((this.viewEnd-this.viewStart|0)+1,100/this.scale|0);1e3/this.scale|0;((0|this.drawnStart)>Math.max(1,(0|this.viewStart)-e|0)||(0|this.drawnEnd)<Math.min((0|this.viewEnd)+e,(0|this.currentSeqMax)>0?0|this.currentSeqMax:1e9))&&this.refresh()},r.prototype.resizeViewer=function(t){var e=0|this.tierHolder.getBoundingClientRect().width;if(0!=e){var n=Math.max(this.featurePanelWidth,300);if(this.featurePanelWidth=0|e,n!=this.featurePanelWidth){this.zoomMax=this.zoomExpt*Math.log(this.maxViewWidth/this.zoomBase),this.zoomMin=this.zoomExpt*Math.log(this.featurePanelWidth/this.maxPixelsPerBase/this.zoomBase),this.zoomSliderValue=this.zoomExpt*Math.log((this.viewEnd-this.viewStart+1)/this.zoomBase);var i=this.viewEnd-this.viewStart,r=this.viewStart+i*this.featurePanelWidth/n;this.viewEnd=r;var o=this.viewEnd-this.viewStart+1;this.currentSeqMax>0&&this.viewEnd>this.currentSeqMax&&(this.viewEnd=this.currentSeqMax,this.viewStart=this.viewEnd-o+1),this.viewStart<1&&(this.viewStart=1,this.viewEnd=this.viewStart+o-1),this.positionRuler(),t||this.spaceCheck(),this.notifyLocation()}this.fullScreen&&this.setFullScreenHeight()}},r.prototype.setFullScreenHeight=function(){var t=document.body.offsetHeight-this.browserHolder.offsetHeight;this.browserHolder.style.maxHeight=Math.max(300,window.innerHeight-t-20)+"px"},r.prototype.addTier=function(t){var e=this;return t=_(t),t.disabled=!1,this.makeTier(t).then(function(t){return e.refreshTier(t),e.markSelectedTiers(),e.positionRuler(),e.notifyTier("added",t),t})},r.prototype.removeTier=function(t,e){var n=-1;if("undefined"!=typeof t.index&&t.index>=0&&t.index<this.tiers.length)n=t.index;else for(var i=0;i<this.tiers.length;++i){var r=this.tiers[i].dasSource;if(L(t,r)){n=i;break}}if(0>n)throw"Couldn't find requested tier";var o=this.tiers[n];this.tiers.splice(n,1);for(var a=[],s=0;s<this.selectedTiers.length;++s){var l=this.selectedTiers[s];n>l?a.push(l):l>n&&a.push(l-1)}this.selectedTiers=a,this.markSelectedTiers(),o.destroy(),this.knownSpace&&(this.knownSpace.featureCache[o]=null),this.reorderTiers(),this.notifyTier("removed",o)},r.prototype.removeAllTiers=function(){var t=this;this.selectedTiers=[],this.markSelectedTiers(),this.tiers.forEach(function(e){e.destroy(),t.knownSpace&&(t.knownSpace.featureCache[e]=null)}),this.tiers.length=0,this.reorderTiers(),this.notifyTier("removedAll",null)},r.prototype.getSequenceSource=function(){return void 0===this._sequenceSource&&(this._sequenceSource=this._getSequenceSource()),this._sequenceSource},r.prototype._getSequenceSource=function(){for(var t=0;t<this.tiers.length;++t)if(this.tiers[t].sequenceSource)return this.tiers[t].sequenceSource;for(var e=0;e<this.defaultSources.length;++e){var n=this.defaultSources[e];if(n.provides_entrypoints||"sequence"==n.tier_type||n.twoBitURI||n.twoBitBlob)return n.twoBitURI||n.twoBitBlob?new I(n):new N(n)}},r.prototype.setLocation=function(t,e,n,i,r){if("number"!=typeof e)throw Error("minimum must be a number (got "+JSON.stringify(e)+")");if("number"!=typeof n)throw Error("maximum must be a number (got "+JSON.stringify(n)+")");if(e>n){var o=e;e=n,n=o}else e===n&&(n+=1);
i||(i=function(t){if(t)throw t});var a=this;if((!t||t==this.chr)&&this.currentSeqMax>0)return this._setLocation(null,e,n,null,i,r);var s=this.getSequenceSource();if(!s)return i("Need a sequence source");var l=t||this.chr;s.getSeqInfo(l,function(o){if(o)return a._setLocation(t,e,n,o,i,r);var u;u=0==l.indexOf("chr")?l.substr(3):"chr"+l,s.getSeqInfo(u,function(o){return!o&&t?i("Couldn't find sequence '"+t+"'"):o?a._setLocation(u,e,n,o,i,r):a._setLocation(null,e,n,null,i,r)})})},r.prototype._setLocation=function(t,e,n,i,r,o){var a=!1;t&&(0==t.indexOf("chr")&&(t=t.substring(3)),this.chr!=t&&(a=!0),this.chr=t,this.currentSeqMax=i.length),e=parseFloat(e),n=parseFloat(n);var s=Math.max(10,n-e+1);if(!o){var l=this.currentSeqMax;0>=l&&(l=1e12),1>e&&(e=1,n=e+s-1),n>l&&(n=l,e=Math.max(1,n-s+1))}this.viewStart=e,this.viewEnd=n;var u=Math.max(this.featurePanelWidth||this.offscreenInitWidth,50)/(this.viewEnd-this.viewStart),c=this.scale,h=Math.abs(u-c)>1e-6;this.scale=u;var d,f;if(f=this.zoomSliderValue,this.zoomSliderValue=d=this.zoomExpt*Math.log((this.viewEnd-this.viewStart+1)/this.zoomBase),h||a){for(var p=0;p<this.tiers.length;++p)this.tiers[p].viewportHolder.style.left="5000px",this.tiers[p].overlay.style.left="5000px";if(this.refresh(),this.savedZoom){d-=this.zoomMin,f-=this.zoomMin;var _=d-f,g=d-this.savedZoom;Math.abs(_)>Math.abs(g)&&(this.isSnapZooming=!this.isSnapZooming,this.savedZoom=f)}else this.isSnapZooming=!1,this.savedZoom=null}else for(var p=((this.viewStart+this.viewEnd)/2,0);p<this.tiers.length;++p){var m=(this.viewStart-this.tiers[p].norigin)*this.scale;this.tiers[p].viewportHolder.style.left=""+((0|-m)-1e3)+"px",this.tiers[p].drawOverlay()}return this.notifyLocation(),this.spaceCheck(),this.instrumentActivity&&(this.activityStartTime=0|Date.now()),r()},r.prototype.setCenterLocation=function(t,e){var n=(this.viewEnd-this.viewStart)/2,i=e-n,r=e+n;this.setLocation(t,i,r)},r.prototype.pingActivity=function(){if(this.instrumentActivity&&this.activityStartTime){for(var t=0,e=0;e<this.tiers.length;++e)"none"!==this.tiers[e].loaderButton.style.display&&++t;if(0==t){var n=0|Date.now();console.log("Loading took "+(n-this.activityStartTime)+"ms"),this.activityStartTime=null}}},r.prototype.addInitListener=function(t){this.initListeners.push(t)},r.prototype.addFeatureListener=function(t,e){e=e||{},this.featureListeners.push(t)},r.prototype.removeFeatureListener=function(t,e){var n=arrayIndexOf(this.featureListeners,t);n>=0&&this.featureListeners.splice(n,1)},r.prototype.notifyFeature=function(t,e,n,i){for(var r=0;r<this.featureListeners.length;++r)try{if(this.featureListeners[r](t,e,n,i))return}catch(o){console.log(o.stack)}},r.prototype.addFeatureHoverListener=function(t,e){e=e||{},this.featureHoverListeners.push(t)},r.prototype.removeFeatureHoverListener=function(t,e){var n=arrayIndexOf(this.featureHoverListeners,t);n>=0&&this.featureHoverListeners.splice(n,1)},r.prototype.notifyFeatureHover=function(t,e,n,i){for(var r=0;r<this.featureHoverListeners.length;++r)try{this.featureHoverListeners[r](t,e,n,i)}catch(o){console.log(o.stack)}},r.prototype.addViewListener=function(t,e){e=e||{},this.viewListeners.push(t)},r.prototype.removeViewListener=function(t,e){var n=arrayIndexOf(this.viewListeners,t);n>=0&&this.viewListeners.splice(n,1)},r.prototype.notifyLocation=function(){var t=Math.max(1,0|this.viewStart),e=0|this.viewEnd;this.currentSeqMax>0&&e>this.currentSeqMax&&(e=this.currentSeqMax);for(var n=0;n<this.viewListeners.length;++n)try{this.viewListeners[n](this.chr,t,e,this.zoomSliderValue,{current:this.zoomSliderValue,alternate:this.savedZoom+this.zoomMin||this.zoomMin,isSnapZooming:this.isSnapZooming,min:this.zoomMin,max:this.zoomMax},this.viewStart,this.viewEnd)}catch(i){console.log(i.stack)}},r.prototype.addTierListener=function(t){this.tierListeners.push(t)},r.prototype.removeTierListener=function(t){var e=arrayIndexOf(this.tierListeners,t);e>=0&&this.tierListeners.splice(e,1)},r.prototype.notifyTier=function(t,e){for(var n=0;n<this.tierListeners.length;++n)try{this.tierListeners[n](t,e)}catch(i){console.log(i.stack)}},r.prototype.addRegionSelectListener=function(t){this.regionSelectListeners.push(t)},r.prototype.removeRegionSelectListener=function(t){var e=arrayIndexOf(this.regionSelectListeners,t);e>=0&&this.regionSelectListeners.splice(e,1)},r.prototype.notifyRegionSelect=function(t,e,n){for(var i=0;i<this.regionSelectListeners.length;++i)try{this.regionSelectListeners[i](t,e,n)}catch(r){console.log(r.stack)}},r.prototype.highlightRegion=function(t,e,n){var i=this;if(t==this.chr)return this._highlightRegion(t,e,n);var r=this.getSequenceSource();if(!r)throw"Need a sequence source";r.getSeqInfo(t,function(o){if(o)return i._highlightRegion(t,e,n);var a;a=0==t.indexOf("chr")?t.substr(3):"chr"+t,r.getSeqInfo(a,function(t){return t?i._highlightRegion(a,e,n):void 0})})},r.prototype._highlightRegion=function(t,e,n){for(var r=0;r<this.highlights.length;++r){var o=this.highlights[r];if(o.chr==t&&o.min==e&&o.max==n)return}this.highlights.push(new i(t,e,n));var a=this.viewStart-1e3/this.scale,s=this.viewEnd+1e3/this.scale;(t==this.chr||t=="chr"+this.chr)&&s>e&&n>a&&this.drawOverlays(),this.notifyLocation()},r.prototype.clearHighlights=function(){this.highlights=[],this.drawOverlays(),this.notifyLocation()},r.prototype.drawOverlays=function(){for(var t=0;t<this.tiers.length;++t)this.tiers[t].drawOverlay()},r.prototype.featuresInRegion=function(t,e,n){var i=[];if(t!==this.chr)return[];for(var r=0;r<this.tiers.length;++r)for(var o=this.tiers[r].currentFeatures||[],a=0;a<o.length;++a){var s=o[a];s.min<=n&&s.max>=e&&i.push(s)}return i},r.prototype.getSelectedTier=function(){return this.selectedTiers.length>0?this.selectedTiers[0]:-1},r.prototype.setSelectedTier=function(t){null==t?this.selectedTiers=[]:this.selectedTiers=[t],this.markSelectedTiers(),this.notifyTierSelection()},r.prototype.markSelectedTiers=function(){for(var t=0;t<this.tiers.length;++t){var e=this.tiers[t].nameButton;this.selectedTiers.indexOf(t)>=0?e.classList.add("active"):e.classList.remove("active")}if(this.selectedTiers.length>0){var n=this.browserHolder.offsetTop+this.browserHolder.offsetHeight/2;n>document.body.scrollTop&&n+100<document.body.scrollTop+window.innerHeight&&this.browserHolder.focus()}},r.prototype.addTierSelectionListener=function(t){this.tierSelectionListeners.push(t)},r.prototype.removeTierSelectionListener=function(t){var e=arrayIndexOf(this.tierSelectionListeners,t);e>=0&&this.tierSelectionListeners.splice(e,1)},r.prototype.notifyTierSelection=function(){for(var t=0;t<this.tierSelectionListeners.length;++t)try{this.tierSelectionListeners[t](this.selectedTiers)}catch(e){console.log(e.stack)}},r.prototype.addTierSelectionWrapListener=function(t){this.tierSelectionWrapListeners.push(t)},r.prototype.removeTierSelectionWrapListener=function(t){var e=arrayIndexOf(this.tierSelectionWrapListeners,t);e>=0&&this.tierSelectionWrapListeners.splice(e,1)},r.prototype.notifyTierSelectionWrap=function(t){for(var e=0;e<this.tierSelectionWrapListeners.length;++e)try{this.tierSelectionWrapListeners[e](t)}catch(n){console.log(n.stack)}},r.prototype.positionRuler=function(){var t="none",e="",n="";if("center"==this.rulerLocation?(t="block",e=""+(this.featurePanelWidth/2|0)+"px"):"left"==this.rulerLocation?(t="block",e="0px"):"right"==this.rulerLocation?(t="block",n="0px"):t="none",this.ruler.style.display=t,this.ruler.style.left=e,this.ruler.style.right=n,this.singleBaseHighlight){this.ruler2.style.display="block",this.ruler2.style.borderWidth="1px",this.scale<1?(this.ruler2.style.width="0px",this.ruler2.style.borderRightWidth="0px"):(this.ruler2.style.width=this.scale+"px",this.ruler2.style.borderRightWidth="1px"),this.locSingleBase.style.visibility="visible";var i=this.featurePanelWidth/2-this.locSingleBase.offsetWidth/2+this.ruler2.offsetWidth/2;this.locSingleBase.style.left=""+(0|i)+"px"}else this.locSingleBase.style.visibility="hidden",this.ruler2.style.width="1px",this.ruler2.style.borderWidth="0px",this.ruler2.style.display="center"==this.rulerLocation?"none":"block";this.ruler2.style.left=""+(this.featurePanelWidth/2|0)+"px";for(var r=0;r<this.tiers.length;++r){var o,a=this.tiers[r],s=a.quantOverlay;a.subtiers&&a.subtiers.length>0&&(o=a.subtiers[0].quant),s&&(s.style.display=o?t:"none",s.style.left=e,s.style.right=n)}},r.prototype.featureDoubleClick=function(t,e,n){if(t&&0!=t.length){var i=t[t.length-1];if(i.min&&i.max){var r=((0|i.min)-(0|this.viewStart))*this.scale,o=(i.max-i.min+1)*this.scale,a=((0|i.min)+(0|i.max))/2;if(o>10){var s=1*(e-r)/o;.3>s?a=0|i.min:s>.7&&(a=(0|i.max)+1)}var l=this.viewEnd-this.viewStart;this.setLocation(null,a-l/2,a+l/2)}}},r.prototype.zoomForScale=function(t){var e;return e=t>.2?"high":t>.01?"medium":"low"},r.prototype.zoomForCurrentScale=function(){return this.zoomForScale(this.scale)},r.prototype.updateHeight=function(){for(var t=0,e=0;e<this.tiers.length;++e)t+=this.tiers[e].currentHeight||30;this.ruler.style.height=""+t+"px",this.ruler2.style.height=""+t+"px",this.browserHolder.style.display="block",this.browserHolder.style.display="flex"},r.prototype.scrollArrowKey=function(t,e){if(this.reverseKeyScrolling&&(e=-e),t.ctrlKey||t.metaKey){var n=!1;t.shiftKey&&(n=!0),this.leap(e,n)}else if(this.scale>1){var i=(this.viewStart+this.viewEnd)/2,r=i-Math.round(i),o=1;t.shiftKey&&(o*=10),e>0?(o=-o,o-=r,r>0&&(o+=1)):(o-=r,0>r&&(o-=1)),this.setLocation(null,this.viewStart+o,this.viewEnd+o)}else this.move(t.shiftKey?100*e:25*e)},r.prototype.leap=function(t,e){var n=this,i=(n.viewStart+n.viewEnd+1)/2|0;t>0&&n.viewStart<=1?i-=1e8:0>t&&n.viewEnd>=n.currentSeqMax&&(i+=1e8);var r=n.getSelectedTier();if(!(0>r)){var o=n.tiers[r];o&&(o.featureSource&&this.sourceAdapterIsCapable(o.featureSource,"quantLeap")&&"number"==typeof o.quantLeapThreshold||o.featureSource&&this.sourceAdapterIsCapable(o.featureSource,"leap"))?o.findNextFeature(n.chr,i,-t,e,function(r){if(r){var o=r.min,a=r.max;e&&(t>0?o>i+1?a=o:(a++,o=a):i-1>a?(a++,o=a):a=o);var s=n.viewEnd-n.viewStart+1;parseFloat(s/2)==parseInt(s/2)&&s--;var l=(o+a-s)/2+1,u=l+s-1;n.setLocation(r.segment,l,u)}else alert("no next feature")}):this.move(100*t)}},r.prototype.nameForCoordSystem=function(t){var e=null,n=null;return this.assemblyNamePrimary&&(e=""+t.auth,"undefined"!=typeof t.version&&(e+=t.version)),this.assemblyNameUcsc&&(n=t.ucscName),null!=e&&null!=n?e+"/"+n:e||n||"unknown"},r.prototype.makeLoader=function(t){t=t||16;var e=window.devicePixelRatio>1;return 20>t?d("img",null,{src:this.resolveURL("$$img/spinner_"+(e?16:32)+".gif"),width:"16",height:"16"}):d("img",null,{src:this.resolveURL("$$img/spinner_"+(e?24:48)+".gif"),width:"24",height:"24"})},r.prototype.canFetchPlainHTTP=function(){var t=this;if(!this._plainHTTPPromise){var e=this.getWorker();e?this._plainHTTPPromise=new E(function(n,i){e.postCommand({command:"textxhr",uri:t.httpCanaryURL},function(t,e){n(t?!0:!1)})}):this._plainHTTPPromise=new E(function(e,n){g(t.httpCanaryURL,function(t,n){e(t?!0:!1)},{timeout:2e3})})}return this._plainHTTPPromise},r.prototype.getWorker=function(){return this.useFetchWorkers&&this.fetchWorkers&&0!=this.fetchWorkers.length?(this.nextWorker>=this.fetchWorkers.length&&(this.nextWorker=0),this.fetchWorkers[this.nextWorker++]):null},s.prototype.postCommand=function(t,e,n){var i="x"+ ++this.tagSeed;t.tag=i,this.callbacks[i]=e,this.worker.postMessage(t,n)},t.exports={Browser:r},n(280),n(288),n(295),n(296),n(289),n(297);var D=n(299),I=D.TwoBitSequenceSource,N=D.DASSequenceSource,F=n(308).KnownSpace,B=n(251).DASRegistry;u.prototype.get=function(t){var e=this.sourcesByURI[O(t)];if(e)for(var n=0;n<e.configs.length;++n)if(R(e.configs[n],t))return e.sources[n]},u.prototype.put=function(t,e){var n=O(t),i=this.sourcesByURI[n];i||(i={configs:[],sources:[]},this.sourcesByURI[n]=i),i.configs.push(t),i.sources.push(e)}},function(t,e,n){"use strict";function i(t,e){for(var n=0;n<t.length;++n)if(t[n]==e)return;t.push(e)}function r(t,e,n){t[e]?t[e].push(n):t[e]=[n]}function o(t,e,n){var i=t[e];if(i){for(var r=0;r<i.length;++r)if(i[r]==n)return;i.push(n)}else t[e]=[n]}function a(t,e,n,i){return t?t:e?e:n?n:i?i:void 0}function i(t,e){for(var n=0;n<t.length;++n)if(t[n]==e)return;t.push(e)}function s(t,e){if(!t)return-1;for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}function l(t,e){var n=s(t,e);return n>=0?(t.splice(n,1),!0):!1}function u(t,e,n,i){var r=document.createElement(t);if(e){e instanceof Array||(e=[e]);for(var o=0;o<e.length;++o){var a=e[o];a&&("string"==typeof a?a=document.createTextNode(a):"number"==typeof a&&(a=document.createTextNode(""+a)),r.appendChild(a))}}if(n)for(var s in n)try{r[s]=n[s]}catch(l){throw console.log("error setting "+s),l}if(i)for(var s in i)r.style[s]=i[s];return r}function c(t,e,n,i){var r=document.createElementNS(t,e);if(n){n instanceof Array||(n=[n]);for(var o=0;o<n.length;++o){var a=n[o];"string"==typeof a&&(a=document.createTextNode(a)),r.appendChild(a)}}return d(r,i),r}function h(t,e,n){var i=A[e];if(!i){for(var r="",o=0;o<e.length;++o){var a=e.substring(o,o+1),s=a.toLowerCase();s!=a?r=r+"-"+s:r+=a}A[e]=r,i=r}t.setAttribute(i,n)}function d(t,e){if(e)for(var n in e)h(t,n,e[n])}function f(t){if(t&&t.childNodes)for(;t.childNodes.length>0;)t.removeChild(t.firstChild)}function p(t,e){if("undefined"==typeof t)return"undefined";if(null==t)return"null";if("string"==typeof t)return"'"+t+"'";if("number"==typeof t)return""+t;if("boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array){for(var n=null,i=0;i<t.length;++i)n=(null==n?"":n+", ")+p(t[i],e);return"["+(n?n:"")+"]"}e=e||{};var n=null;for(var r in t)e[r]||void 0!=r&&"function"!=typeof t[r]&&(n=(null==n?"":n+", ")+r+": "+p(t[r],e));return"{"+(n?n:"")+"}"}return typeof t}function _(t){var e={};for(var n in t)e[n]=t[n];return e}function g(t){this.value=t,this.listeners=[]}function m(){this.queue=[]}function v(t){return t+"?salt="+S(""+Date.now()+","+ ++k)}function y(t,e,n){n&&n.salt&&(t=v(t));try{var i;n.timeout&&(i=setTimeout(function(){return console.log("timing out "+t),r.abort(),e(null,"Timeout")},n.timeout));var r=new XMLHttpRequest;r.onreadystatechange=function(){4==r.readyState&&(i&&clearTimeout(i),r.status<200||r.status>=300?e(null,"Error code "+r.status):e(r.responseText))},r.open("GET",t,!0),r.responseType="text",n&&n.credentials&&(r.withCredentials=!0),r.send("")}catch(o){e(null,"Exception "+o)}}function b(t,e){if(0==e.indexOf("http:")||0==e.indexOf("https:"))return e;var n=t.lastIndexOf("/");return n>=0?t.substr(0,n+1)+e:e}function x(t){return u("a",null,{href:t}).href}var w=n(249),S=w.b64_sha1,A=(new RegExp("[0-9]+"),new RegExp("^[0-9]+$"),{});g.prototype.addListener=function(t){this.listeners.push(t)},g.prototype.addListenerAndFire=function(t){this.listeners.push(t),t(this.value)},g.prototype.removeListener=function(t){l(this.listeners,t)},g.prototype.get=function(){return this.value},g.prototype.set=function(t){this.value=t;for(var e=0;e<this.listeners.length;++e)this.listeners[e](t)},m.prototype.provide=function(t){if(void 0!==this.res)throw"Resource has already been provided.";this.res=t;for(var e=0;e<this.queue.length;++e)this.queue[e](t);this.queue=null},m.prototype.await=function(t){return void 0!==this.res?(t(this.res),this.res):void this.queue.push(t)};var k=0,C={TTT:"F",TTC:"F",TTA:"L",TTG:"L",CTT:"L",CTC:"L",CTA:"L",CTG:"L",ATT:"I",ATC:"I",ATA:"I",ATG:"M",GTT:"V",GTC:"V",GTA:"V",GTG:"V",TCT:"S",TCC:"S",TCA:"S",TCG:"S",CCT:"P",CCC:"P",CCA:"P",CCG:"P",ACT:"T",ACC:"T",ACA:"T",ACG:"T",GCT:"A",GCC:"A",GCA:"A",GCG:"A",TAT:"Y",TAC:"Y",TAA:"*",TAG:"*",CAT:"H",CAC:"H",CAA:"Q",CAG:"Q",AAT:"N",AAC:"N",AAA:"K",AAG:"K",GAT:"D",GAC:"D",GAA:"E",GAG:"E",TGT:"C",TGC:"C",TGA:"*",TGG:"W",CGT:"R",CGC:"R",CGA:"R",CGG:"R",AGT:"S",AGC:"S",AGA:"R",AGG:"R",GGT:"G",GGC:"G",GGA:"G",GGG:"G"};"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),t.exports={textXHR:y,relativeURL:b,resolveUrlToPage:x,shallowCopy:_,pusho:r,pushnew:i,pushnewo:o,arrayIndexOf:s,pick:a,makeElement:u,makeElementNS:c,removeChildren:f,miniJSONify:p,Observed:g,Awaited:m,AMINO_ACID_TRANSLATION:C}},function(t,e,n){"use strict";function i(t){return a(o(l(t)))}function r(t){return s(o(l(t)))}function o(t){return c(h(u(t),8*t.length))}function a(t){for(var e,n=g?"0123456789ABCDEF":"0123456789abcdef",i="",r=0;r<t.length;r++)e=t.charCodeAt(r),i+=n.charAt(e>>>4&15)+n.charAt(15&e);return i}function s(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",i=t.length,r=0;i>r;r+=3)for(var o=t.charCodeAt(r)<<16|(i>r+1?t.charCodeAt(r+1)<<8:0)|(i>r+2?t.charCodeAt(r+2):0),a=0;4>a;a++)n+=8*r+6*a>8*t.length?m:e.charAt(o>>>6*(3-a)&63);return n}function l(t){for(var e,n,i="",r=-1;++r<t.length;)e=t.charCodeAt(r),n=r+1<t.length?t.charCodeAt(r+1):0,e>=55296&&56319>=e&&n>=56320&&57343>=n&&(e=65536+((1023&e)<<10)+(1023&n),r++),127>=e?i+=String.fromCharCode(e):2047>=e?i+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i}function u(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(var n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}function c(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>24-n%32&255);return e}function h(t,e){t[e>>5]|=128<<24-e%32,t[(e+64>>9<<4)+15]=e;for(var n=Array(80),i=1732584193,r=-271733879,o=-1732584194,a=271733878,s=-1009589776,l=0;l<t.length;l+=16){for(var u=i,c=r,h=o,g=a,m=s,v=0;80>v;v++){16>v?n[v]=t[l+v]:n[v]=_(n[v-3]^n[v-8]^n[v-14]^n[v-16],1);var y=p(p(_(i,5),d(v,r,o,a)),p(p(s,n[v]),f(v)));s=a,a=o,o=_(r,30),r=i,i=y}i=p(i,u),r=p(r,c),o=p(o,h),a=p(a,g),s=p(s,m)}return Array(i,r,o,a,s)}function d(t,e,n,i){return 20>t?e&n|~e&i:40>t?e^n^i:60>t?e&n|e&i|n&i:e^n^i}function f(t){return 20>t?1518500249:40>t?1859775393:60>t?-1894007588:-899497514}function p(t,e){var n=(65535&t)+(65535&e),i=(t>>16)+(e>>16)+(n>>16);return i<<16|65535&n}function _(t,e){return t<<e|t>>>32-e}var g=0,m="";t.exports={b64_sha1:r,hex_sha1:i}},function(t,e,n){"use strict";function i(t,e,n,i){if(this.config=n||{},this.id="tier"+ ++w,this.browser=t,this.dasSource=s(e),this.background=i,this.viewport=o("canvas",null,{width:""+((0|this.browser.featurePanelWidth)+2e3),height:"30",className:"viewport_12_5"},{position:"inline-block",margin:"0px",border:"0px"}),this.viewportHolder=o("div",this.viewport,{className:"viewport-holder_12_5"},{background:i,position:"absolute",padding:"0px",margin:"0px",border:"0px",left:"-1000px",minHeight:"200px"}),this.overlay=o("canvas",null,{width:+(0|this.browser.featurePanelWidth),height:"30",className:"viewport-overlay"}),this.notifier=o("div","",{className:"notifier"}),this.notifierHolder=o("div",this.notifier,{className:"notifier-holder"}),this.quantOverlay=o("canvas",null,{width:"50",height:"56",className:"quant-overlay"}),this.removeButton=o("i",null,{className:"fa fa-times"}),this.bumpButton=o("i",null,{className:"fa fa-plus-circle"}),this.loaderButton=t.makeLoader(16),this.loaderButton.style.display="none",this.infoElement=o("div",this.dasSource.desc,{className:"track-label-info"}),this.nameButton=o("div",[],{className:"tier-tab"}),this.nameButton.appendChild(this.removeButton),e.pennant)this.nameButton.appendChild(o("img",null,{src:e.pennant,width:"16",height:"16"}));else if(e.mapping){var r=null;this.browser.chains[e.mapping]&&(r=this.browser.chains[e.mapping].coords.version),r&&this.nameButton.appendChild(o("span",""+r,null,{fontSize:"8pt",background:"black",color:"white",paddingLeft:"3px",paddingRight:"3px",paddingTop:"1px",paddingBottom:"1px",marginLeft:"2px",borderRadius:"10px"}))}this.nameElement=o("span",e.name),this.nameButton.appendChild(o("span",[this.nameElement,this.infoElement],{className:"track-name-holder"})),this.nameButton.appendChild(this.bumpButton),this.nameButton.appendChild(this.loaderButton),this.label=o("span",[this.nameButton],{className:"btn-group track-label"});var a="tier"+(e.className?" "+e.className:"");this.row=o("div",[this.viewportHolder,this.overlay,this.quantOverlay],{className:a}),i||(this.row.style.background="none"),t.noDefaultLabels||this.row.appendChild(this.label),this.row.appendChild(this.notifierHolder),this.layoutHeight=25,this.bumped=!0,this.styleIdSeed=0,e.quantLeapThreshold&&(this.quantLeapThreshold=e.quantLeapThreshold),this.dasSource.collapseSuperGroups&&(this.bumped=!1),this.layoutWasDone=!1,e.featureInfoPlugin&&this.addFeatureInfoPlugin(e.featureInfoPlugin),this.initSources();var l=this;this.featureSource&&this.featureSource.getDefaultFIPs&&!e.noSourceFeatureInfo&&this.featureSource.getDefaultFIPs(function(t){t&&l.addFeatureInfoPlugin(t)}),this.featureSource&&this.featureSource.addReadinessListener&&(this.readinessListener=function(t){l.notify(t,-1)},this.featureSource.addReadinessListener(this.readinessListener)),this.featureSource&&this.featureSource.addActivityListener&&(this.activityListener=function(t){t>0?l.loaderButton.style.display="inline-block":l.loaderButton.style.display="none",l.browser.pingActivity()},this.featureSource.addActivityListener(this.activityListener)),this.listeners=[],this.featuresLoadedListeners=[]}var r=n(248),o=r.makeElement,a=r.removeChildren,s=r.shallowCopy,l=(r.pushnew,r.miniJSONify),u=r.arrayIndexOf,c=n(251),h=c.DASStylesheet,d=c.DASStyle,f=n(249),p=f.b64_sha1,_=n(253),g=_.StyleFilter,m=_.StyleFilterSet,v=n(254),y=v.sourceDataURI,b=n(255).Promise,x=n(266).sortFeatures,w=0;i.prototype.destroy=function(){this.featureSource.removeReadinessListener&&this.featureSource.removeReadinessListener(this.readinessListener),this.featureSource.removeActivityListener&&this.featureSource.removeActivityListener(this.activityListener)},i.prototype.setBackground=function(t){this.background=t,this.viewportHolder.style.background=t},i.prototype.toString=function(){return this.id},i.prototype.addFeatureInfoPlugin=function(t){this.featureInfoPlugins||(this.featureInfoPlugins=[]),this.featureInfoPlugins.push(t)},i.prototype.init=function(){var t=this;return new b(function(e,n){t.dasSource.style?(t.setStylesheet({styles:t.dasSource.style}),e(t)):(t.status="Fetching stylesheet",t.fetchStylesheet(function(n,i){if(i||!n){t.error="No stylesheet";var n=new h,r=new d;r.glyph="BOX",r.BGCOLOR="blue",r.FGCOLOR="black",n.pushStyle({type:"default"},null,r),t.setStylesheet(n)}else t.setStylesheet(n),n.geneHint&&(t.dasSource.collapseSuperGroups=!0,t.bumped=!1,t.updateLabel()),t._updateFromConfig();e(t)}))})},i.prototype.setStylesheet=function(t){this.baseStylesheet=s(t);for(var e=0;e<this.baseStylesheet.styles.length;++e){var n=this.baseStylesheet.styles[e]=s(this.baseStylesheet.styles[e]);n._methodRE=n._labelRE=n._typeRE=null,n.style=s(n.style),n.style.id="style"+ ++this.styleIdSeed}this.baseStylesheetValidity=p(l(this.baseStylesheet)),this._updateFromConfig()},i.prototype.getSource=function(){return this.featureSource},i.prototype.getDesiredTypes=function(t){var e=this.getActiveStyleFilters(t);return e?e.typeList():void 0},i.prototype.getActiveStyleFilters=function(t){var e=this.browser.zoomForCurrentScale();if(this.stylesheet){for(var n=new m,i=this.stylesheet.styles,r=0;r<i.length;++r){var o=i[r];o.zoom&&o.zoom!=e||n.add(new g(o.type,o.method,o.label))}return n}},i.prototype.needsSequence=function(t){return this.sequenceSource&&5>t?!0:(this.dasSource.bamURI||this.dasSource.bamBlob||this.dasSource.bwgURI||this.dasSource.bwgBlob)&&20>t?!0:!1},i.prototype.setFeatures=function(t,e,n,i,r){this.currentFeatures=i,this.currentSequence=r,this.knownChr=t,this.knownCoverage=e,i&&(x(this),this.notifyFeaturesLoaded())},i.prototype.draw=function(){var t=(this.currentFeatures,this.currentSequence);this.sequenceSource?C(this,t):A(this),this.paint(),this.originHaxx=0,this.browser.arrangeTiers()},i.prototype.findNextFeature=function(t,e,n,i,r){if(this.quantLeapThreshold){var o=this.browser.viewEnd-this.browser.viewStart+1;e=e+o*n/2|0,this.featureSource.quantFindNextFeature(t,e,n,this.quantLeapThreshold,r)}else{if(this.knownCoverage&&e>=this.knownCoverage.min()&&e<=this.knownCoverage.max()&&this.currentFeatures){for(var a=null,s=0;s<this.currentFeatures.length;++s){var l=this.currentFeatures[s];l.min&&l.max&&(l.parents&&l.parents.length>0||(0>n?1==i&&l.max>=e&&l.min<e?(!a||l.min>a.min||l.min==a.min&&l.max<a.max)&&(a=l):l.max<e&&(!a||l.max>a.max||l.max==a.max&&l.min<a.min||l.min==a.mmin&&a.max>=e)&&(a=l):1==i&&l.min<=e&&l.max>e?(!a||l.max<a.max||l.max==a.max&&l.min>a.min)&&(a=l):l.min>e&&(!a||l.min<a.min||l.min==a.min&&l.max>a.max||l.max==a.max&&a.min<=e)&&(a=l)))}if(a)return r(a);e=0>n?this.browser.knownSpace.min:this.browser.knownSpace.max}this.trySourceFNF(t,e,n,r)}},i.prototype.trySourceFNF=function(t,e,n,i){var r=this;this.featureSource.findNextFeature(t,e,n,function(t){t||i(t);var e=r.browser.getSequenceSource();e||i(t),e.getSeqInfo(t.segment,function(e){e?i(t):r.trySourceFNF(t.segment,n>0?1e10:0,n,i)})})},i.prototype.updateLabel=function(){this.bumpButton.className=this.bumped?"fa fa-minus-circle":"fa fa-plus-circle",this.dasSource.collapseSuperGroups?this.bumpButton.style.display="inline-block":this.bumpButton.style.display="none"},i.prototype.updateHeight=function(){this.currentHeight=Math.max(Math.max(this.layoutHeight,this.label.clientHeight+2),this.browser.minTierHeight),this.row.style.height=""+this.currentHeight+"px",this.browser.updateHeight()},i.prototype.drawOverlay=function(){var t=this,e=this.browser,n=e.retina&&window.devicePixelRatio>1;t.overlay.height=t.viewport.height,t.overlay.width=n?2*e.featurePanelWidth:e.featurePanelWidth;var i=t.overlay.getContext("2d");n&&i.scale(2,2);var r=e.viewStart,o=e.viewStart,a=e.viewEnd;if(this.overlayLabelCanvas){var s=(this.glyphCacheOrigin-this.browser.viewStart)*this.browser.scale;i.save(),i.translate(s,0);var l=-s+2;this.dasSource.tierGroup&&(l+=15),this.overlayLabelCanvas.draw(i,l,e.featurePanelWidth-s),i.restore()}for(var u=0;u<e.highlights.length;++u){var c=e.highlights[u];(c.chr===e.chr||c.chr==="chr"+e.chr)&&c.min<a&&c.max>o&&(i.globalAlpha=e.defaultHighlightAlpha,i.fillStyle=e.defaultHighlightFill,i.fillRect((c.min-r)*e.scale,0,(c.max-c.min)*e.scale,t.overlay.height))}t.overlay.style.width=e.featurePanelWidth,t.overlay.style.height=t.viewport.style.height,t.overlay.style.left="0px"},i.prototype.updateStatus=function(t){var e=this;if(t){this.status=t,this._notifierToStatus();y(this.dasSource);"https:"!==window.location.protocol||0!=y(this.dasSource).indexOf("http:")||this.checkedHTTP||(this.checkedHTTP=!0,this.browser.canFetchPlainHTTP().then(function(t){t||(e.warnHTTP=!0,e._notifierToStatus())}))}else this.status&&(this.status=null,this._notifierToStatus())},i.prototype.notify=function(t,e){if("number"!=typeof e&&(e=2e3),this.notifierFadeTimeout&&(clearTimeout(this.notifierFadeTimeout),this.notifierFadeTimeout=null),t){if(this._notifierOn(t),e>0){var n=this;this.notifierFadeTimeout=setTimeout(function(){n._notifierToStatus()},e)}}else this._notifierToStatus()},i.prototype._notifierOn=function(t,e){a(this.notifier),e?this.notifier.appendChild(o("span",[o("a","[HTTP Warning] ",{href:this.browser.httpWarningURL,target:"_blank"}),t])):this.notifier.textContent=t,this.notifier.style.opacity=.8},i.prototype._notifierOff=function(){this.notifier.style.opacity=0},i.prototype._notifierToStatus=function(){this.status?this._notifierOn(this.status,this.warnHTTP):this._notifierOff()},i.prototype.setConfig=function(t){this.config=t||{},this._updateFromConfig(),this.notifyTierListeners()},i.prototype.mergeStylesheet=function(t){this.mergeConfig({stylesheet:t,stylesheetValidity:this.baseStylesheetValidity})},i.prototype.mergeConfig=function(t){for(var e in t)this.config[e]=t[e];this._updateFromConfig(),this.notifyTierListeners()},i.prototype._updateFromConfig=function(){var t=!1,e=!1;"string"==typeof this.config.name?this.nameElement.textContent=this.config.name:this.nameElement.textContent=this.dasSource.name;var n=this.config.height||this.dasSource.forceHeight;n!=this.forceHeight&&(this.forceHeight=n,t=!0),this.forceMinDynamic!=this.config.forceMinDynamic&&(this.forceMinDynamic=this.config.forceMinDynamic,t=!0);var i=void 0!=this.config.forceMin?this.config.forceMin:this.dasSource.forceMin;this.forceMin!=i&&(this.forceMin=i,t=!0),this.forceMaxDynamic!=this.config.forceMaxDynamic&&(this.forceMaxDynamic=this.config.forceMaxDynamic,t=!0);var r=void 0!=this.config.forceMax?this.config.forceMax:this.dasSource.forceMax;this.forceMax!=r&&(this.forceMax=r,t=!0);var o=null;void 0!==this.config.quantLeapThreshold?o=this.config.quantLeapThreshold:void 0!==this.dasSource.quantLeapThreshold&&(o=this.dasSource.quantLeapThreshold),o!=this.quantLeapThreshold&&(this.quantLeapThreshold=o,t=!0);var a=null;this.config.stylesheetValidity==this.baseStylesheetValidity&&(a=this.config.stylesheet),a=a||this.baseStylesheet,this.stylesheet!==a&&(this.stylesheet=a,t=!0);var s=void 0!==this.config.pinned?this.config.pinned:this.dasSource.pinned;s!==this.pinned&&(this.pinned=s,e=!0);var l=this.config.subtierMax;l!=this.subtierMax&&(this.subtierMax=l,t=!0);var u;u=void 0!==this.config.bumped?this.config.bumped:void 0!==this.dasSource.bumped?this.dasSource.bumped:this.dasSource.collapseSuperGroups?!1:!0,u!==this.bumped&&(this.bumped=u,t=!0,this.updateLabel()),t&&this.scheduleRedraw(),e&&this.browser.reorderTiers()},i.prototype.scheduleRedraw=function(){if(this.currentFeatures){var t=this;this.redrawTimeout||(this.redrawTimeout=setTimeout(function(){t.draw(),t.redrawTimeout=null},10))}},i.prototype.clearTierListeners=function(){this.listeners=[]},i.prototype.addTierListener=function(t){this.listeners.push(t)},i.prototype.removeTierListener=function(t){var e=u(this.listeners,t);e>=0&&this.listeners.splice(e,1)},i.prototype.notifyTierListeners=function(t){for(var e=0;e<this.listeners.length;++e)try{this.listeners[e](t)}catch(n){console.log(n)}this.browser.notifyTier()},i.prototype.clearFeaturesLoadedListeners=function(){this.featuresLoadedListeners=[]},i.prototype.addFeaturesLoadedListener=function(t){this.featuresLoadedListeners.push(t)},i.prototype.removeFeaturesLoadedListener=function(t){var e=u(this.featuresLoadedListeners,t);e>=0&&this.featuresLoadedListeners.splice(e,1)},i.prototype.notifyFeaturesLoaded=function(){for(var t=0;t<this.featuresLoadedListeners.length;++t)try{this.featuresLoadedListeners[t].call(this)}catch(e){console.log(e)}},t.exports={DasTier:i};var S=n(267),A=S.drawFeatureTier,k=n(273),C=k.drawSeqTier},function(t,e,n){"use strict";function i(t,e,n,i){this.name=t,this.start=e,this.end=n,this.description=i}function r(t,e){var n;"string"==typeof t?(this.uri=t,n=e||{}):n=t||{};for(var i in n)"function"!=typeof n[i]&&(this[i]=n[i]);this.coords||(this.coords=[]),this.props||(this.props={}),this.dasBaseURI=this.uri,this.dasBaseURI&&"/"!=this.dasBaseURI.substr(this.uri.length-1)&&(this.dasBaseURI=this.dasBaseURI+"/")}function o(){}function a(t,e){return t.taxon==e.taxon&&t.auth==e.auth&&t.version==e.version}function s(t,e,n,i,r){this.name=t,this.start=e,this.end=n,this.alphabet=i,this.seq=r}function l(){}function u(t){t&&(this.id=t)}function c(t,e){this.desc=t,this.uri=e}function h(t){this.type=t,this.objects={},this.blocks=[]}function d(){this.styles=[]}function f(){}function p(t){var e=t.getAttribute("steps");e=e?0|e:50;for(var n=[],i=[],r=t.getElementsByTagName("STOP"),o=0;o<r.length;++o){var a=r[o];n.push(1*a.getAttribute("score")),i.push(a.firstChild.nodeValue)}return E(e,n,i)}function _(t,e){e=e||{},this.uri=t,this.opts=e}function g(t,e){var n=t.getElementsByTagName(e);if(n.length>0&&n[0].firstChild){var i=n[0];if(1==i.childNodes.length)return i.firstChild.nodeValue;for(var r="",o=0;o<i.childNodes.length;++o)r+=i.childNodes[o].nodeValue;return r}return null}function m(t){if(t.hasChildNodes()){var e=t.firstChild;do{if(e.nodeType==Node.ELEMENT_NODE)return e;e=e.nextSibling}while(null!=e)}return null}function v(t){for(var e=new Array,n=t.getElementsByTagName("LINK"),i=0;i<n.length;++i){
var r=n[i];r.parentNode==t&&e.push(new c(r.firstChild?r.firstChild.nodeValue:"Unknown",r.getAttribute("href")))}return e}function y(t){for(var e=[],n=t.getElementsByTagName("NOTE"),i=0;i<n.length;++i)n[i].firstChild&&e.push(n[i].firstChild.nodeValue);return e}function b(t,e,n,i){if(window.XDomainRequest){var r=new XDomainRequest;r.onload=function(){var t=new ActiveXObject("Microsoft.XMLDOM");t.async=!1,t.loadXML(r.responseText),e(t)},r.open("get",t),r.send("")}else try{var r=new XMLHttpRequest,o=setTimeout(function(){console.log("timing out "+t),r.abort(),e(null,r)},5e3);r.timeout=5e3,r.ontimeout=function(){console.log("timeout on "+t)},r.onreadystatechange=function(){4==r.readyState&&(clearTimeout(o),(r.status>=200||0==r.status)&&e(r.responseXML,r))},r.open("get",t,!0),n&&(r.withCredentials=!0),i&&r.setRequestHeader("X-DAS-Authorisation",i),r.overrideMimeType("text/xml"),r.setRequestHeader("Accept","application/xml,*/*"),r.send("")}catch(a){e(null,r,a)}}function x(t){return t=(""+t).toLowerCase(),"yes"===t||"true"===t}function w(t){return t?(t=(""+t).toLowerCase(),"no"!==t||"false"!==t):!1}function S(t){var e=k(t);e.styles=[];for(var n=0;n<t.styles.length;++n){var i=e.styles[n]=k(t.styles[n]);i._methodRE=i._labelRE=i._typeRE=void 0,i.style=k(i.style),i.style.id=void 0,i.style._gradient=void 0}return e}var A=n(248),k=A.shallowCopy,C=A.pusho,T=n(252),E=T.makeColourSteps;new Array;i.prototype.toString=function(){return this.name+":"+this.start+".."+this.end},i.prototype.isBounded=function(){return this.start&&this.end},i.prototype.toDASQuery=function(){var t="segment="+this.name;return this.start&&this.end&&(t+=":"+this.start+","+this.end),t},r.prototype.entryPoints=function(t){var e=this.dasBaseURI+"entry_points";this.doCrossDomainRequest(e,function(e){if(!e)return t([]);for(var n=new Array,r=e.getElementsByTagName("SEGMENT"),o=0;o<r.length;++o){var a,s,l=r[o],u=l.getAttribute("id"),c=l.getAttribute("size");c?(a=1,s=0|c):(a=l.getAttribute("start"),a&&(a|=0),s=l.getAttribute("stop"),s&&(s|=0));var h=null;l.firstChild&&(h=l.firstChild.nodeValue),n.push(new i(u,a,s,h))}t(n)})},r.prototype.sequence=function(t,e){var n=this.dasBaseURI+"sequence?"+t.toDASQuery();this.doCrossDomainRequest(n,function(t){if(!t)return void e([]);for(var n=new Array,i=t.getElementsByTagName("SEQUENCE"),r=0;r<i.length;++r){var o=i[r],a=o.getAttribute("id"),l=o.getAttribute("start"),u=o.getAttribute("stop"),c="DNA",h=null;if(o.firstChild){var d=o.firstChild.nodeValue;h="";for(var f=0;;){var p=d.indexOf("\n",f);if(!(p>=0)){h+=d.substring(f).toUpperCase();break}h+=d.substring(f,p).toUpperCase(),f=p+1}}n.push(new s(a,l,u,c,h))}e(n)})},r.prototype.features=function(t,e,n){e=e||{};var i;if(this.features_uri)i=this.features_uri;else{var r=[];if(t)r.push(t.toDASQuery());else if(e.group){var o=e.group;if("string"==typeof o)r.push("group_id="+o);else for(var a=0;a<o.length;++a)r.push("group_id="+o[a])}if(e.adjacent){var s=e.adjacent;"string"==typeof s&&(s=[s]);for(var c=0;c<s.length;++c)r.push("adjacent="+s[c])}if(e.type)if("string"==typeof e.type)r.push("type="+e.type);else for(var h=0;h<e.type.length;++h)r.push("type="+e.type[h]);e.maxbins&&r.push("maxbins="+e.maxbins),r.length>0?i=this.dasBaseURI+"features?"+r.join(";"):n([],"No filters specified")}this.doCrossDomainRequest(i,function(t,e){if(!t){var i;return i=0==e.status?"server may not support CORS":"status="+e.status,void n([],"Failed request: "+i)}for(var r=new Array,o={},a=t.getElementsByTagName("SEGMENT"),s=0;s<a.length;++s){var c=a[s],h=c.getAttribute("id");o[h]={min:c.getAttribute("start"),max:c.getAttribute("stop")};for(var d=c.getElementsByTagName("FEATURE"),f=0;f<d.length;++f){var p=d[f],_=new l;_.segment=h,_.id=p.getAttribute("id"),_.label=p.getAttribute("label");var m=g(p,"START"),b=g(p,"END");(0|m)>(0|b)?(_.min=0|b,_.max=0|m):(_.min=0|m,_.max=0|b);var x=p.getElementsByTagName("TYPE");if(x.length>0){var w=x[0];w.firstChild&&(_.type=w.firstChild.nodeValue),_.typeId=w.getAttribute("id"),_.typeCv=w.getAttribute("cvId")}_.type=g(p,"TYPE"),!_.type&&_.typeId&&(_.type=_.typeId),_.method=g(p,"METHOD");var S=g(p,"ORIENTATION");S||(S="0"),_.orientation=S,_.score=g(p,"SCORE"),_.links=v(p),_.notes=y(p);for(var A=p.getElementsByTagName("GROUP"),k=0;k<A.length;++k){var C=A[k],T=new u;T.type=C.getAttribute("type"),T.id=C.getAttribute("id"),T.links=v(C),T.notes=y(C),_.groups?_.groups.push(T):_.groups=new Array(T)}if(_.notes)for(var E=0;E<_.notes.length;++E){var M=_.notes[E];if(0==M.indexOf("Genename=")){var L=new u;L.type="gene",L.id=M.substring(9),_.groups?_.groups.push(L):_.groups=new Array(L)}}var R=p.getElementsByTagName("PART");if(R.length>0){for(var O=[],P=0;P<R.length;++P)O.push(R[P].getAttribute("id"));_.parts=O}var R=p.getElementsByTagName("PARENT");if(R.length>0){for(var D=[],P=0;P<R.length;++P)D.push(R[P].getAttribute("id"));_.parents=D}r.push(_)}}n(r,void 0,o)},function(t){n([],t)})},r.prototype.alignments=function(t,e,n){var i=this.dasBaseURI+"alignment?query="+t;this.doCrossDomainRequest(i,function(t){if(!t)return void n([],"Failed request "+i);for(var e=[],r=t.getElementsByTagName("alignment"),o=0;o<r.length;++o){for(var a=r[o],s=new h(a.getAttribute("alignType")),l=a.getElementsByTagName("alignObject"),u=0;u<l.length;++u){var c=l[u],d={id:c.getAttribute("intObjectId"),accession:c.getAttribute("dbAccessionId"),version:c.getAttribute("objectVersion"),dbSource:c.getAttribute("dbSource"),dbVersion:c.getAttribute("dbVersion")};s.objects[d.id]=d}for(var f=a.getElementsByTagName("block"),p=0;p<f.length;++p){for(var _=f[p],m={order:_.getAttribute("blockOrder"),segments:[]},v=_.getElementsByTagName("segment"),y=0;y<v.length;++y){var b=v[y],x={object:b.getAttribute("intObjectId"),min:b.getAttribute("start"),max:b.getAttribute("end"),strand:b.getAttribute("strand"),cigar:g(b,"cigar")};m.segments.push(x)}s.blocks.push(m)}e.push(s)}n(e)})},d.prototype.pushStyle=function(t,e,n){t||(t={type:"default"});var i=k(t);e&&(i.zoom=e),i.style=n,this.styles.push(i)},r.prototype.stylesheet=function(t,e){var n,i=this.credentials;this.stylesheet_uri?(n=this.stylesheet_uri,i=!1):n=this.dasBaseURI+"stylesheet",b(n,function(n){if(!n)return void(e&&e());for(var i=new d,r=n.getElementsByTagName("TYPE"),o=0;o<r.length;++o){var a=r[o],s={};s.type=a.getAttribute("id"),s.label=a.getAttribute("label"),s.method=a.getAttribute("method");for(var l=a.getElementsByTagName("GLYPH"),u=0;u<l.length;++u){var c=l[u],h=c.getAttribute("zoom"),_=m(c),g=new f;g.glyph=_.localName;for(var v=_.firstChild;v;)v.nodeType==Node.ELEMENT_NODE&&("BGGRAD"==v.localName?g[v.localName]=p(v):g[v.localName]=v.firstChild.nodeValue),v=v.nextSibling;i.pushStyle(s,h,g)}}t(i)},i)},_.prototype.sources=function(t,e,n){n||(n={});var i=[];n.taxon&&i.push("organism="+n.taxon),n.auth&&i.push("authority="+n.auth),n.version&&i.push("version="+n.version);var a=this.uri;i.length>0&&(a=a+"?"+i.join("&")),b(a,function(n){if(!n&&e)return void e();for(var i=[],a=n.getElementsByTagName("SOURCE"),s=0;s<a.length;++s){var l=a[s],u=l.getElementsByTagName("VERSION");if(!(u.length<1)){for(var c=u[0],h=c.getElementsByTagName("COORDINATES"),d=[],f=0;f<h.length;++f){var p=h[f],_=new o;_.auth=p.getAttribute("authority"),_.taxon=p.getAttribute("taxid"),_.version=p.getAttribute("version"),d.push(_)}for(var g,m=[],v=c.getElementsByTagName("CAPABILITY"),f=0;f<v.length;++f){var y=v[f];if(m.push(y.getAttribute("type")),"das1:features"==y.getAttribute("type")){var b=y.getAttribute("query_uri");g=b.substring(0,b.length-"features".length)}}for(var x={},w=c.getElementsByTagName("PROP"),S=0;S<w.length;++S)C(x,w[S].getAttribute("name"),w[S].getAttribute("value"));if(g){var A=new r(g,{source_uri:l.getAttribute("uri"),name:l.getAttribute("title"),desc:l.getAttribute("description"),coords:d,props:x,capabilities:m});i.push(A)}}}t(i)})},r.prototype.doCrossDomainRequest=function(t,e,n){var i;this.xUser&&(i="Basic "+btoa(this.xUser+":"+this.xPass));try{return b(t,e,this.credentials,i)}catch(r){if(!n)throw r;n(r)}},t.exports={DASGroup:u,DASFeature:l,DASStylesheet:d,DASStyle:f,DASSource:r,DASSegment:i,DASRegistry:_,DASSequence:s,DASLink:c,isDasBooleanTrue:x,isDasBooleanNotFalse:w,copyStylesheet:S,coordsMatch:a}},function(t,e,n){"use strict";function i(t,e,n,i){this.red=0|t,this.green=0|e,this.blue=0|n,i&&(this.name=i)}function r(t){var e="00"+t.toString(16);return e.substring(e.length-2)}function o(t){var e=l[t];if(!e){var n=u.exec(t);n?(e=new i("0x"+n[1]|0,"0x"+n[2]|0,"0x"+n[3]|0,t),l[t]=e):(n=c.exec(t),n?(e=new i(0|n[1],0|n[2],0|n[3],t),l[t]=e):(console.log("couldn't handle color: "+t),e=l.black,l[t]=e))}return e}function a(t,e,n){for(var r=[],a=0;a<n.length;++a)r.push(o(n[a]));var s=[];t:for(var l=0;t>l;++l){for(var u=1*l/(t-1),c=e[0]+(e[e.length-1]-e[0])*u,h=0;h<e.length-1;++h)if(c>=e[h]&&c<=e[h+1]){var d=(c-e[h])/(e[h+1]-e[h]),f=r[h],p=r[h+1],_=new i(f.red*(1-d)+p.red*d|0,f.green*(1-d)+p.green*d|0,f.blue*(1-d)+p.blue*d|0).toSvgString();s.push(_);continue t}throw"Bad step"}return s}function s(t,e,n,i){return i?a(t,[0,.5,1],[e,n,i]):a(t,[0,1],[e,n])}i.prototype.toSvgString=function(){return this.name||(this.name="rgb("+this.red+","+this.green+","+this.blue+")"),this.name},i.prototype.toHexString=function(){return"#"+r(this.red)+r(this.green)+r(this.blue)};var l={red:new i(255,0,0,"red"),green:new i(0,255,0,"green"),blue:new i(0,0,255,"blue"),yellow:new i(255,255,0,"yellow"),white:new i(255,255,255,"white"),black:new i(0,0,0,"black"),gray:new i(180,180,180,"gray"),grey:new i(180,180,180,"grey"),lightskyblue:new i(135,206,250,"lightskyblue"),lightsalmon:new i(255,160,122,"lightsalmon"),hotpink:new i(255,105,180,"hotpink")},u=new RegExp("^#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$"),c=/rgb\(([0-9]+),([0-9]+),([0-9]+)\)/;t.exports={makeColourSteps:a,makeGradient:s,dasColourForName:o}},function(t,e,n){"use strict";function i(t,e,n){this.type=t,this.method=e,this.label=n}function r(t){if(this._filters={},t)for(var e=0;e<t.length;++e)this.add(t[e])}i.prototype.equals=function(t){return this.type==t.type&&this.method==t.method&&this.label==t.label},i.prototype.toString=function(){var t=[];return this.type&&t.push("type="+this.type),this.method&&t.push("method="+this.method),this.label&&t.push("label="+this.label),"StyleFilter<"+t.join(";")+">"},r.prototype.add=function(t){var e=t.toString();this._filters[e]||(this._filters[e]=t,this._list=null)},r.prototype.addAll=function(t){for(var e=t.list(),n=0;n<e.length;++n)this.add(e[n])},r.prototype.doesNotContain=function(t){for(var e=t.list(),n=0;n<e.length;++n)if(!this._filters[n.toString()])return!0;return!1},r.prototype.list=function(){if(!this._list){this._list=[];for(var t in this._filters)this._filters.hasOwnProperty(t)&&this._list.push(this._filters[t])}return this._list},r.prototype.typeList=function(){for(var t=[],e=this.list(),n=0;n<e.length;++n){var i=e[n],r=i.type;if(!r||"default"==r)return null;t.indexOf(r)<0&&t.push(r)}return t},t.exports={StyleFilter:i,StyleFilterSet:r}},function(t,e,n){function i(t){return t.uri?t.uri:t.blob?"file:"+t.blob.name:t.bwgBlob?"file:"+t.bwgBlob.name:t.bamBlob?"file:"+t.bamBlob.name:t.twoBitBlob?"file:"+t.twoBitBlob.name:t.bwgURI||t.bamURI||t.jbURI||t.twoBitURI||"https://www.biodalliance.org/magic/no_uri"}function r(t){return t.stylesheet_uri?t.stylesheet_uri:"sequence"==t.tier_type||t.twoBitURI||t.twoBitBlob?"https://www.biodalliance.org/magic/sequence":i(t)}function o(t,e){if(i(t)!=i(e))return!1;if(t.mapping!=e.mapping)return!1;if(t.tier_type!=e.tier_type)return!1;if(t.overlay){if(!e.overlay||e.overlay.length!=t.overlay.length)return!1;for(var n=0;n<t.overlay.length;++n)if(!o(t.overlay[n],e.overlay[n]))return!1}else if(e.overlay)return!1;return!0}function a(t,e){if(i(t)!=i(e)||r(t)!=r(e))return!1;if(t.mapping!=e.mapping)return!1;if(t.tier_type!=e.tier_type)return!1;if(t.overlay){if(!e.overlay||e.overlay.length!=t.overlay.length)return!1;for(var n=0;n<t.overlay.length;++n)if(!a(t.overlay[n],e.overlay[n]))return!1}else if(e.overlay)return!1;return!0}t.exports={sourcesAreEqual:a,sourcesAreEqualModuloStyle:o,sourceDataURI:i,sourceStyleURI:r}},function(t,e,n){"use strict";var i=n(256).Promise,r=n(265).polyfill;e.Promise=i,e.polyfill=r},function(t,e,n){"use strict";function i(t){if(!g(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof i))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],r(t,this)}function r(t,e){function n(t){u(e,t)}function i(t){h(e,t)}try{t(n,i)}catch(r){i(r)}}function o(t,e,n,i){var r,o,a,s,c=g(n);if(c)try{r=n(i),a=!0}catch(d){s=!0,o=d}else r=i,a=!0;l(e,r)||(c&&a?u(e,r):s?h(e,o):t===k?u(e,r):t===C&&h(e,r))}function a(t,e,n,i){var r=t._subscribers,o=r.length;r[o]=e,r[o+k]=n,r[o+C]=i}function s(t,e){for(var n,i,r=t._subscribers,a=t._detail,s=0;s<r.length;s+=3)n=r[s],i=r[s+e],o(e,n,i,a);t._subscribers=null}function l(t,e){var n,i=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(_(e)&&(i=e.then,g(i)))return i.call(e,function(i){return n?!0:(n=!0,void(e!==i?u(t,i):c(t,i)))},function(e){return n?!0:(n=!0,void h(t,e))}),!0}catch(r){return n?!0:(h(t,r),!0)}return!1}function u(t,e){t===e?c(t,e):l(t,e)||c(t,e)}function c(t,e){t._state===S&&(t._state=A,t._detail=e,p.async(d,t))}function h(t,e){t._state===S&&(t._state=A,t._detail=e,p.async(f,t))}function d(t){s(t,t._state=k)}function f(t){s(t,t._state=C)}var p=n(257).config,_=(n(257).configure,n(258).objectOrFunction),g=n(258).isFunction,m=(n(258).now,n(259).cast),v=n(260).all,y=n(261).race,b=n(262).resolve,x=n(263).reject,w=n(264).asap;p.async=w;var S=void 0,A=0,k=1,C=2;i.prototype={constructor:i,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(t,e){var n=this,i=new this.constructor(function(){});if(this._state){var r=arguments;p.async(function(){o(n._state,i,r[n._state-1],n._detail)})}else a(this,i,t,e);return i},"catch":function(t){return this.then(null,t)}},i.all=v,i.cast=m,i.race=y,i.resolve=b,i.reject=x,e.Promise=i},function(t,e){"use strict";function n(t,e){return 2!==arguments.length?i[t]:void(i[t]=e)}var i={instrument:!1};e.config=i,e.configure=n},function(t,e){"use strict";function n(t){return i(t)||"object"==typeof t&&null!==t}function i(t){return"function"==typeof t}function r(t){return"[object Array]"===Object.prototype.toString.call(t)}var o=Date.now||function(){return(new Date).getTime()};e.objectOrFunction=n,e.isFunction=i,e.isArray=r,e.now=o},function(t,e){"use strict";function n(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=this;return new e(function(e){e(t)})}e.cast=n},function(t,e,n){"use strict";function i(t){var e=this;if(!r(t))throw new TypeError("You must pass an array to all.");return new e(function(e,n){function i(t){return function(e){r(t,e)}}function r(t,n){s[t]=n,0===--l&&e(s)}var a,s=[],l=t.length;0===l&&e([]);for(var u=0;u<t.length;u++)a=t[u],a&&o(a.then)?a.then(i(u),n):r(u,a)})}var r=n(258).isArray,o=n(258).isFunction;e.all=i},function(t,e,n){"use strict";function i(t){var e=this;if(!r(t))throw new TypeError("You must pass an array to race.");return new e(function(e,n){for(var i,r=0;r<t.length;r++)i=t[r],i&&"function"==typeof i.then?i.then(e,n):e(i)})}var r=n(258).isArray;e.race=i},function(t,e){"use strict";function n(t){var e=this;return new e(function(e,n){e(t)})}e.resolve=n},function(t,e){"use strict";function n(t){var e=this;return new e(function(e,n){n(t)})}e.reject=n},function(t,e,n){(function(t,n){"use strict";function i(){return function(){n.nextTick(a)}}function r(){var t=0,e=new c(a),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function o(){return function(){h.setTimeout(a,1)}}function a(){for(var t=0;t<d.length;t++){var e=d[t],n=e[0],i=e[1];n(i)}d=[]}function s(t,e){var n=d.push([t,e]);1===n&&l()}var l,u="undefined"!=typeof window?window:{},c=u.MutationObserver||u.WebKitMutationObserver,h="undefined"!=typeof t?t:void 0===this?window:this,d=[];l="undefined"!=typeof n&&"[object process]"==={}.toString.call(n)?i():c?r():o(),e.asap=s}).call(e,function(){return this}(),n(190))},function(t,e,n){(function(t){"use strict";function i(){var e;e="undefined"!=typeof t?t:"undefined"!=typeof window&&window.document?window:self;var n="Promise"in e&&"cast"in e.Promise&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),o(t)}();n||(e.Promise=r)}var r=n(256).Promise,o=n(258).isFunction;e.polyfill=i}).call(e,function(){return this}())},function(t,e,n){"use strict";function i(t){for(var e,n,i,r=t.browser.drawnStart,s=t.browser.drawnEnd,l={},u={},c={},h={},d={},f={},p={},_={},g=[],m=function(){i={};for(var e=0;e<t.currentFeatures.length;++e){var n=t.currentFeatures[e];n.id&&(i[n.id]=n)}},v=function(t){var e=[];if(t.parents)for(var n=0;n<t.parents.length;++n){var r=t.parents[n],o=i[r];o&&"SO:0000704"==o.typeCv&&pushnew(e,r)}return e},y=0;y<t.currentFeatures.length;++y){var b=t.currentFeatures[y];if(!b.parts){var x=b.min<=s&&b.max>=r;if(b.min&&b.max){if(b.score&&"."!=b.score&&"-"!=b.score){var w=1*b.score;(!e||e>w)&&(e=w),(!n||w>n)&&(n=w)}var S=[],A=null;if(b.groups)for(var k=0;k<b.groups.length;++k){var C=b.groups[k],T=C.id;if("gene"==C.type)A=T,f[T]=C;else if("translation"==C.type);else{o(u,T,b),f[T]=C,S.push(T);var E=h[T];(!E||b.min<E)&&(h[T]=b.min),E=d[T],(!E||b.max>E)&&(d[T]=b.max)}}if(b.parents){i||m();for(var M=0;M<b.parents.length;++M){var L=b.parents[M],R=i[L];if(R){R.parts||(R.parts=[b]),a(u,L,R),o(u,L,b),f[L]||(f[L]={type:R.type,id:R.id,label:R.label||R.id}),S.push(L);var E=h[L];(!E||b.min<E)&&(h[L]=b.min),E=d[L],(!E||b.max>E)&&(d[L]=b.max);var O=v(R);if(O.length>0){A=O[0];var P=i[O[0]];f[O[0]]={type:P.type,id:P.id,label:P.label||P.id},t.dasSource.collapseSuperGroups||(t.dasSource.collapseSuperGroups=!0)}}}}if(0==S.length)x&&o(l,b.type,b);else if(A)for(var C=0;C<S.length;++C){var T=S[C];a(p,A,T),_[T]=A}}else g.push(b)}}for(var T in u){var D=f[T];"number"!=typeof D.min&&(D.min=h[T]),"number"!=typeof D.max&&(D.max=d[T]),d[T]>=r&&h[T]<=s&&(c[T]=u[T])}t.ungroupedFeatures=l,t.groupedFeatures=c,t.groups=f,t.superGroups=p,t.groupsToSupers=_,e&&(e>0?e=0:0>n&&(n=0),t.currentFeaturesMinScore=e,t.currentFeaturesMaxScore=n)}var r=n(248),o=r.pusho,a=r.pushnewo;t.exports={sortFeatures:i}},function(t,e,n){"use strict";function i(){this.glyphs=[],this.height=0,this.quant=null}function r(t){0|Date.now();$=t.viewport.getContext("2d"),"number"==typeof t.dasSource.padding?t.padding=t.dasSource.padding:t.padding=Z;var e=[],n=!1,r={},l={};for(var h in t.ungroupedFeatures)for(var d=t.ungroupedFeatures[h],f=0;f<d.length;++f){var p=d[f];if(!p.parts){var _=t.styleForFeature(p);if(_)if("LINEPLOT"==_.glyph)c(r,_.id,p),l[_.id]=_;else{var g=a(p,0,_,t);g&&e.push(g)}}}for(var m in r){var v=r[m],_=l[m];"LINEPLOT"==_.glyph&&(e.push(s(v,_,t)),n=!0)}if(t.dasSource.collapseSuperGroups&&!t.bumped)for(var y in t.superGroups){var b=t.superGroups[y];t.groups[y]=u(t.groups[y]),t.groups[y].isSuperGroup=!0;for(var x={},S=1e10,A=-1e10,k=null,g=0;g<b.length;++g){var v=t.groupedFeatures[b[g]];if(v){for(var C=0;C<v.length;++C){var p=v[C];c(x,p.type,p),S=Math.min(p.min,S),A=Math.max(p.max,A),p.segment&&!k&&(k=p.segment)}(t.groups[y]&&!t.groups[y].links||0==t.groups[y].links.length)&&(t.groups[y].links=t.groups[b[0]].links),delete t.groupedFeatures[b[g]]}}t.groups[y].max=A,t.groups[y].min=S,t.groups[y].segment=k;for(var T in x){for(var E=x[T],M=E[0],L=null,C=0;C<E.length;++C){var p=E[C],R=new q(p.min,p.max);L=L?G(L,R):R}for(var O=L.ranges(),P=0;P<O.length;++P){for(var I=O[P],N=((0|I.max())-(0|I.min())+1)*b.length,F=0,C=0;C<E.length;++C){var p=E[C];if((0|p.min)<=I.max()&&(0|p.max)>=I.min()){var B=Math.max(0|p.min,I.min()),z=Math.min(0|p.max,I.max());F+=z-B+1}}var H=new U;for(var j in M)H[j]=M[j];H.min=I.min(),H.max=I.max(),H.label&&b.length>1&&(H.label+=" ("+b.length+" vars)"),H.visualWeight=1*F/N,c(t.groupedFeatures,y,H)}}delete t.superGroups[y]}var V=new Array;for(var W in t.groupedFeatures)V.push(W);V.sort(function(e,n){var i=t.groupedFeatures[e][0].score-t.groupedFeatures[n][0].score;return i>0?-1:0==i?0:1});for(var X={},K=0;K<V.length;++K){var W=V[K],g=o(t.groupedFeatures[W],0,t.groups[W],t,t.dasSource.collapseSuperGroups&&!t.bumped?"collapsed_gene":"tent");g&&(g.group=t.groups[W],X[W]=g)}for(var y in t.superGroups){for(var b=t.superGroups[y],Y=[],S=1e10,A=-1e10,J=0;J<b.length;++J){var Q=X[b[J]];X[b[J]]=null,Q&&(Y.push(Q),S=Math.min(S,Q.min()),A=Math.max(A,Q.max()))}for(var J=0;J<Y.length;++J){var Q=Y[J];e.push(new w(Q,S,A))}}for(var g in X){var Q=X[g];Q&&e.push(Q)}var tt=new i,et=[],nt=!1,it=t.subtierMax||t.dasSource.subtierMax||t.browser.defaultSubtierMax,rt=!1;t:for(var ot=0;ot<e.length;++ot){var g=e[ot];if(g.bump&&(nt=!0),g.bump&&(t.bumped||t.dasSource.collapseSuperGroups)){for(var at=0;at<et.length;++at){var st=et[at];if(st.hasSpaceFor(g)){st.add(g);continue t}}if(et.length>=it)rt=!0;else{var st=new i;st.add(g),et.push(st)}}else tt.add(g)}tt.glyphs.length>0&&(et=[tt].concat(et));for(var at=0;at<et.length;++at){var st=et[at];st.quant&&st.glyphs.unshift(new D(st.height))}for(var at=0;at<et.length;++at){var st=et[at];st.glyphs.sort(function(t,e){var n=t.zindex||0,i=e.zindex||0;return n-i})}t.subtiers=et,t.glyphCacheOrigin=t.browser.viewStart,rt?t.updateStatus("Bumping limit exceeded, use the track editor to see more features"):t.updateStatus()}function o(t,e,n,i,r){for(var o,s=i.styleForFeature(n),l=!1,u=[],c=null,h=0;h<t.length;++h){var d=t[h];d.orientation&&null==c&&(c=d.orientation),!o&&d.label&&(o=d.label);var f=i.styleForFeature(d);if(f&&!d.parts){V(f.LABEL)&&(l=!0);var p=a(d,0,f,i,null,!0);p&&u.push(p)}}if(0==u.length)return null;var g="flat";s&&"LINE"===s.glyph||(i.dasSource.collapseSuperGroups&&!i.bumped?"+"===c?g="collapsed+":"-"===c&&(g="collapsed-"):"+"===c?g="hat+":"-"===c&&(g="hat-"));var v=null;(o&&l||s&&(V(s.LABEL)||V(s.LABELS)))&&(v=n.label||o);var y=new _(u,g);return v&&("+"===c?v=">"+v:"-"===c&&(v="<"+v),y=new m($,y,v,!1)),y.bump=!0,y}function a(t,e,n,i,r,o){function a(t,e,n){var i=null;if(t.currentSequence){var r=0|t.currentSequence.start,o=0|t.currentSequence.end;if(n>=r&&o>=e){var a=Math.max(e,r),s=Math.min(n,o);for(i=t.currentSequence.seq.substr(a-r,s-a+1);a>e;)i="N"+i,a--;for(;n>s;)i+="N",s++}}return i}var s,l,u=i.browser.scale,c=i.browser.viewStart,h=n.glyph||"BOX",d=t.min,f=t.max,g=(t.type,t.orientation),D=t.score,F=t.label||t.id,B=(d-c)*u,H=(f-c+1)*u,q=Math.max(H,B+1),G=i.forceHeight||n.HEIGHT||r||12,j=G=1*G,U=n.BUMP&&V(n.BUMP);if("CROSS"===h||"EX"===h||"TRIANGLE"===h||"DOT"===h||"SQUARE"===h||"STAR"===h||"PLIMSOLL"===h){var K=n.FGCOLOR||"black",Y=n.BGCOLOR||"none",Z=n.STROKECOLOR;if(n.BGITEM&&t.itemRgb)K=t.itemRgb;else if(V(n.COLOR_BY_SCORE2)){var J=n.BGGRAD||n._gradient;J||(J=z(50,n.COLOR1,n.COLOR2,n.COLOR3),n._gradient=J);var Q=t.score2;if(void 0!=Q||!K){Q=Q||0;var tt=n.MIN2?1*n.MIN2:0,et=n.MAX2?1*n.MAX2:1,nt=(1*Q-tt)/(et-tt),it=nt*J.length|0;0>it&&(it=0),it>=J.length&&(it=J.length-1),K=J[it]}}var G=i.forceHeight||n.HEIGHT||r||12;j=G=1*G;var rt=n.SIZE||G;n.RSIZE&&(rt=1*n.RSIZE*G),n.STROKETHRESHOLD&&rt<1*n.STROKETHRESHOLD&&(Z=null),rt=1*rt;var ot=(B+q)/2,at=rt/2;if("EX"===h)s=new y(ot,rt,K);else if("TRIANGLE"===h){var st=n.DIRECTION||"N",lt=n.LINEWIDTH||rt;s=new b(ot,rt,st,lt,K,Z)}else if("DOT"===h)s=new x(ot,rt,K,Z);else if("PLIMSOLL"===h)s=new N(ot,rt,.2*rt,K,Z);else if("SQUARE"===h)s=new p(ot-at,0,rt,rt,K,Z);else if("STAR"===h){var ut=5;n.POINTS&&(ut=0|n.POINTS),s=new I(ot,at,ut,K,Z)}else s=new v(ot,rt,K);if(Y&&"none"!=Y&&q-B>5){var ct=new p(B,0,q-B,rt,Y);s=new _([ct,s])}if(V(n.SCATTER)){var ht=i.quantMin(n),dt=i.quantMax(n);dt||(dt=0>ht?0:10),ht||(ht=0);var ft=(1*D-ht)/(dt-ht),pt=-1*ht/(dt-ht);if(0>ft||ft>1)return null;ft>=pt?(G=Math.max(1,(ft-pt)*j),e=e+(1-pt)*j-G):(G=Math.max(1,(ft-pt)*j),e+=(1-pt)*j),l={min:ht,max:dt};var _t,gt=0;_t="undefined"!=typeof t.forceLabel?t.forceLabel:n.LABEL,W(_t)&&F&&!o&&(s=new m($,s,F,!0,null,"above"==_t?"above":"below"),"above"==_t&&(gt=s.textHeight+2),o=!0),s=new O(s,0,e-at-gt,j)}}else if("HISTOGRAM"===h||"GRADIENT"===h&&"undefined"!==D){var ht=i.quantMin(n),dt=i.quantMax(n);dt||(dt=0>ht?0:10),ht||(ht=0),1*ht>1*D&&(D=ht),1*D>1*dt&&(D=dt);var ft=(1*D-ht)/(dt-ht),pt=-1*ht/(dt-ht);"HISTOGRAM"===h&&(ft>=pt?(G=(ft-Math.max(0,pt))*j,e=e+(1-Math.max(0,pt))*j-G):(G=(Math.max(0,pt)-ft)*j,e+=(1-Math.max(0,pt))*j),l={min:ht,max:dt});var K=n.FGCOLOR||null,Y=n.BGCOLOR||n.COLOR1||"green";n.BGITEM&&t.itemRgb&&(Y=t.itemRgb);var mt=n.ALPHA?1*n.ALPHA:null;if(n.BGGRAD){var J=n.BGGRAD,it=ft*J.length|0;0>it&&(it=0),it>=J.length&&(it=J.length-1),Y=J[it]}if(n.COLOR2){var J=n._gradient;J||(J=z(50,n.COLOR1,n.COLOR2,n.COLOR3),n._gradient=J);var it=ft*J.length|0;0>it&&(it=0),it>=J.length&&(it=J.length-1),Y=J[it]}s=new p(B,e,q-B,G,Y,K,mt),s=new O(s,0,0,j)}else if("HIDDEN"===h)s=new w(null,B,q),o=!0;else if("ARROW"===h){var vt=n.FGCOLOR||"purple",yt=V(n.PARALLEL),bt=V(n.SOUTHWEST),xt=V(n.NORTHEAST);s=new T(B,q,G,vt,yt,bt,xt)}else if("ANCHORED_ARROW"===h){var K=n.FGCOLOR||"none",Y=n.BGCOLOR||"green";s=new S(B,q,G,Y,K,g),s.bump=!0}else if("SPAN"===h){var K=n.FGCOLOR||"black";s=new A(B,q,G,K)}else if("LINE"===h){var K=n.FGCOLOR||"black",wt=n.STYLE||"solid";s=new k(B,q,G,wt,g,K)}else if("PRIMERS"===h){var K=n.FGCOLOR||"black",Y=n.BGCOLOR||"red";s=new C(B,q,G,Y,K)}else if("TEXT"===h){var St=n.STRING||"text",Y=n.FGCOLOR||"black";s=new M($,B,q,G,Y,St)}else if("TOOMANY"===h){var K=n.FGCOLOR||"gray",Y=n.BGCOLOR||"orange";s=new E(B,q,G,Y,K)}else if("POINT"===h){var G=i.forceHeight||n.HEIGHT||30,ht=i.quantMin(n),dt=i.quantMax(n),At=1*G/(dt-ht),ft=(1*D-ht)/(dt-ht),kt=(D-1*ht)*At|0;l={min:ht,max:dt};var Y=n.FGCOLOR||n.COLOR1||"black";if(n.COLOR2){var J=n._gradient;J||(J=z(50,n.COLOR1,n.COLOR2,n.COLOR3),n._gradient=J);var it=ft*J.length|0;0>it&&(it=0),it>=J.length&&(it=J.length-1),Y=J[it]}s=new P((B+q)/2,G-kt,G,Y)}else if("__SEQUENCE"===h){var Ct=t.seq,Tt=Ct,Et=t.quals,Mt=Et,Lt=V(n.__INSERTIONS),Rt=[];if(t.cigar){var Ot=X(t.cigar);Tt="",Mt="";for(var Pt=0,Dt=0;Dt<Ot.length;++Dt){var It=Ot[Dt];if("M"==It.op)Tt+=Ct.substr(Pt,It.cnt),Mt+=Et.substr(Pt,It.cnt),Pt+=It.cnt;else if("D"==It.op)for(var Nt=0;Nt<It.cnt;++Nt)Tt+="-",Mt+="Z";else if("I"==It.op){var Ft=Ct.substr(Pt,It.cnt),Bt=new b(B+Tt.length*u,5,"S",5,i.browser.baseColors.I);Lt&&(Bt=new m($,Bt,Ft,!1,"center","above","7px sans-serif")),Bt.feature={label:"Insertion: "+Ft,type:"insertion",method:"insertion"},Rt.push(Bt),Pt+=It.cnt}else"S"==It.op?Pt+=It.cnt:console.log("unknown cigop"+It.op)}}var zt=a(i,d,f);if(Tt&&zt&&("mismatch"===n.__SEQCOLOR||"mismatch-all"===n.__SEQCOLOR)){for(var Ht=[],qt="-"===t.orientation?",":".",Gt=0;Gt<Tt.length;++Gt)Ht.push(Tt[Gt]==zt[Gt]?qt:Tt[Gt]);Tt=Ht.join("")}var jt;jt="-"===t.orientation?n._minusColor||"lightskyblue":n._plusColor||"lightsalmon",n.__disableQuals&&(Mt=!1),s=new L(i.browser.baseColors,jt,B,q,G,Tt,zt,n.__SEQCOLOR,Mt,!V(n.__CLEARBG)),Lt&&(s=new O(s,0,7)),Rt.length>0&&(Rt.splice(0,0,s),s=new _(Rt))}else if("__INSERTION"===h){var Bt=new b(B,5,"S",5,i.browser.baseColors.I);if(s=new m($,Bt,t.insertion||t.altAlleles[0],!1,"center","above","7px sans-serif"),q-B>1){var Y=n.BGCOLOR||n.COLOR1||"green",Ut=new p(B,5,q-B,G,Y,K);s=new _([Ut,s])}}else{if("__NONE"===h)return null;var K=n.FGCOLOR||null,Y=n.BGCOLOR||n.COLOR1||"green";n.BGITEM&&t.itemRgb&&(Y=t.itemRgb);var u=(q-B)/(f-d);if("translation"==t.type&&("protein_coding"==t.method||t.readframeExplicit)&&(!t.tags||t.tags.indexOf("cds_start_NF")<0||t.readframeExplicit)&&(!i.dasSource.collapseSuperGroups||i.bumped)&&u>=.5){var zt=a(i,d,f);s=new R(B,q,G,Y,zt,t.orientation,t.readframe)}else s=new p(B,0,q-B,G,Y,K)}return(V(n.LABEL)||t.forceLabel)&&F&&!o&&(s=new m($,s,F,!1)),U&&(s.bump=!0),s.feature=t,l&&(s.quant=l),n.ZINDEX&&(s.zindex=0|n.ZINDEX),s}function s(t,e,n){for(var i=n.browser.viewStart,r=n.browser.scale,o=n.forceHeight||e.HEIGHT||30,a=n.quantMin(e),s=n.quantMax(e),l=1*o/(s-a),u=(e.LINEWIDTH||1,e.FGCOLOR||e.COLOR1||"black"),c=[],h=0;h<t.length;++h){var d=t[h],f=(((0|d.min)+(0|d.max))/2-i)*r,p=(d.score-1*a)*l|0,_=o-p;c.push(f),c.push(_)}var m=new g(c,u,o);return m.quant={min:a,max:s},e.ZINDEX&&(m.zindex=0|e.ZINDEX),m}var l=n(248),u=l.shallowCopy,c=l.pusho,h=n(250),d=h.DasTier,f=n(268),p=f.BoxGlyph,_=f.GroupGlyph,g=f.LineGraphGlyph,m=f.LabelledGlyph,v=f.CrossGlyph,y=f.ExGlyph,b=f.TriangleGlyph,x=f.DotGlyph,w=f.PaddedGlyph,S=f.AArrowGlyph,A=f.SpanGlyph,k=f.LineGlyph,C=f.PrimersGlyph,T=f.ArrowGlyph,E=f.TooManyGlyph,M=f.TextGlyph,L=f.SequenceGlyph,R=f.AminoAcidGlyph,O=f.TranslatedGlyph,P=f.PointGlyph,D=f.GridGlyph,I=f.StarGlyph,N=f.PlimsollGlyph,F=f.OverlayLabelCanvas,B=n(252),z=B.makeGradient,H=n(269),q=H.Range,G=H.union,j=n(251),U=j.DASFeature,V=j.isDasBooleanTrue,W=j.isDasBooleanNotFalse,X=n(271).parseCigar,K=n(272),Y=K.formatQuantLabel,Z=3;i.prototype.indexFor=function(t){for(var e=t.min(),n=0,i=this.glyphs.length;i>n;){var r=(n+i)/2|0;if(r>=this.glyphs.length)return this.glyphs.length;var o=this.glyphs[r];e<o.min()?i=r:n=r+1}return i},i.prototype.add=function(t){var e=this.indexFor(t);this.glyphs.splice(e,0,t),this.height=Math.max(this.height,t.height()),t.quant&&null==this.quant&&(this.quant=t.quant)},i.prototype.hasSpaceFor=function(t){var e=this.indexFor(t);return e>0&&this.glyphs[e-1].max()>=t.min()?!1:e<this.glyphs.length&&this.glyphs[e].min()<=t.max()?!1:!0};var $;d.prototype.paint=function(){var t=this.browser.retina&&window.devicePixelRatio>1,e=this.subtiers;if(e){var n=this.browser.featurePanelWidth+2e3;t&&(n*=2);var i=0|this.viewport.width;n-50>i&&(this.viewport.width=i=n);for(var r=this.padding,o=0;o<e.length;++o)r=r+e[o].height+this.padding;r+=6,r=Math.max(r,this.browser.minTierHeight);var a=r;t&&(a*=2),a!=this.viewport.height&&(this.viewport.height=a);Math.max(r,this.browser.minTierHeight);this.viewportHolder.style.left="-1000px",this.viewport.style.width=t?""+i/2+"px":""+i+"px",this.viewport.style.height=""+r+"px",this.layoutHeight=Math.max(r,this.browser.minTierHeight),this.updateHeight(),this.norigin=this.browser.viewStart;var s=this.viewport.getContext("2d");s.clearRect(0,0,i,a),s.save(),t&&s.scale(2,2);var l=this.browser.viewStart-1e3/this.browser.scale,u=this.browser.viewEnd+1e3/this.browser.scale,c=[];if(this.knownCoverage)for(var h=this.knownCoverage.ranges(),d=0;d<h.length;++d){var f=h[d];0==d?f.min()>l&&c.push({min:l,max:f.min()-1}):c.push({min:h[d-1].max()+1,max:f.min()-1}),d==h.length-1&&f.max()<u&&c.push({min:f.max()+1,max:u})}if(c.length>0){s.fillStyle="gray";for(var p=0;p<c.length;++p){var _=c[p],g=(_.min-this.browser.viewStart)*this.browser.scale+1e3,m=(_.max-this.browser.viewStart)*this.browser.scale+1e3;s.fillRect(g,0,m-g,r)}}var v=new F,y=(this.glyphCacheOrigin-this.browser.viewStart)*this.browser.scale+1e3;s.translate(y,this.padding),v.translate(0,this.padding),this.paintToContext(s,v,y),v.glyphs.length>0?this.overlayLabelCanvas=v:this.overlayLabelCanvas=null,s.restore(),this.drawOverlay(),this.paintQuant()}},d.prototype.paintToContext=function(t,e,n){var i=this.subtiers,r=0|this.viewport.width;t.save();for(var o=0;o<i.length;++o){for(var a=null,s=i[o].glyphs,l=0;l<s.length;++l){var u=s[l];if(u.min()<r-n&&u.max()>-n){var u=s[l];u.draw(t,e),u.quant&&(a=u.quant)}}t.translate(0,i[o].height+this.padding),e.translate(0,i[o].height+this.padding)}if(t.restore(),a&&this.quantLeapThreshold&&this.featureSource&&this.browser.sourceAdapterIsCapable(this.featureSource,"quantLeap")){var c=i[0].height*(1-(this.quantLeapThreshold-a.min)/(a.max-a.min));t.save(),t.strokeStyle="red",t.lineWidth=.3,t.beginPath(),t.moveTo(-1e3,c),t.lineTo(r+1e3,c),t.stroke(),t.restore()}},d.prototype.paintQuant=function(){if(this.quantOverlay){var t,e=this.browser.retina&&window.devicePixelRatio>1;if(this.subtiers&&this.subtiers.length>0&&(t=this.subtiers[0].quant),t){var n=this.subtiers[0].height,i=50;this.quantOverlay.height=this.viewport.height,this.quantOverlay.width=e?2*i:i,
this.quantOverlay.style.height=""+(e?this.quantOverlay.height/2:this.quantOverlay.height)+"px",this.quantOverlay.style.width=""+i+"px",this.quantOverlay.style.display="block";var r=this.quantOverlay.getContext("2d");e&&r.scale(2,2);var o=2;n>40&&(o=1+(n/20|0));var a=(n+2*this.padding)/(o-1),s=(t.max-t.min)/(o-1);if(r.fillStyle="white",r.globalAlpha=.6,"right"==this.browser.rulerLocation?r.fillRect(i-30,0,30,n+2*this.padding):r.fillRect(0,0,30,n+2*this.padding),r.globalAlpha=1,r.strokeStyle="black",r.lineWidth=1,r.beginPath(),"right"==this.browser.rulerLocation){r.moveTo(i-8,this.padding),r.lineTo(i,this.padding),r.lineTo(i,n+this.padding),r.lineTo(i-8,n+this.padding);for(var l=1;o-1>l;++l){var u=l*a;r.moveTo(i,u),r.lineTo(i-5,u)}}else{r.moveTo(8,this.padding),r.lineTo(0,this.padding),r.lineTo(0,n+this.padding),r.lineTo(8,n+this.padding);for(var l=1;o-1>l;++l){var u=l*a;r.moveTo(0,u),r.lineTo(5,u)}}if(r.stroke(),r.fillStyle="black","right"==this.browser.rulerLocation){r.textAlign="right",r.fillText(Y(t.max),i-9,8),r.fillText(Y(t.min),i-9,n+this.padding);for(var l=1;o-1>l;++l){var u=l*a;r.fillText(Y(1*t.max-l*s),i-9,u+3)}}else{r.textAlign="left",r.fillText(Y(t.max),9,8),r.fillText(Y(t.min),9,n+this.padding);for(var l=1;o-1>l;++l){var u=l*a;r.fillText(Y(1*t.max-l*s),9,u+3)}}}else this.quantOverlay.style.display="none"}},d.prototype.styleForFeature=function(t){var e=this.browser.zoomForCurrentScale();if(!this.stylesheet)return null;for(var n=null,i=this.stylesheet.styles,r=0;r<i.length;++r){var o=i[r];if(!(o.zoom&&o.zoom!=e||o.orientation&&o.orientation!=t.orientation)){var a=o._labelRE;if(a&&a.test||(a=new RegExp("^"+o.label+"$"),o._labelRE=a),!o.label||a.test(t.label)){var s=o._methodRE;if(s&&s.test||(s=new RegExp("^"+o.method+"$"),o._methodRE=s),!o.method||s.test(t.method)){if(o.type){if("default"==o.type){n||(n=o.style);continue}var l=o._typeRE;if(l&&l.test||(l=new RegExp("^"+o.type+"$"),o._typeRE=l),!l.test(t.type))continue}return o.style}}}}return n},d.prototype.quantMin=function(t){return this.forceMinDynamic?this.currentFeaturesMinScore||0:"number"==typeof this.forceMin?this.forceMin:t.MIN||this.currentFeaturesMinScore||0},d.prototype.quantMax=function(t){return this.forceMaxDynamic?this.currentFeaturesMaxScore||0:"number"==typeof this.forceMax?this.forceMax:t.MAX||this.currentFeaturesMaxScore||0},t.exports={drawFeatureTier:r}},function(t,e,n){"use strict";function i(t,e){this._stroke=t,this._fill=e}function r(t,e,n,i,r,o,a,s){this.x=t,this.y=e,this._width=n,this._height=i,this.fill=r,this.stroke=o,this._alpha=a,this._radius=s||0}function o(t,e){this.glyphs=t,this.connector=e,this.h=t[0].height();for(var n=[],i=0;i<t.length;++i){var r=t[i];n.push(new R(r.min(),r.max())),this.h=Math.max(this.h,r.height())}this.coverage=L(n)}function a(t,e,n){this.points=t,this.color=e,this._height=n||50}function s(t,e,n,i,r,o,a){this.glyph=e,this.text=n,this.anchor=r||"left",this.align=o||"below",a&&(this.font=a),this.font&&(t.save(),t.font=this.font);var s=t.measureText(n);this.font&&t.restore(),this.textLen=s.width,this.textHeight=5,this.bump=e.bump,this.measured=!i}function l(t,e,n){this._x=t,this._height=e,this._stroke=n}function u(t,e,n){this._x=t,this._height=e,this._stroke=n}function c(t,e,n,r,o,a){i.call(this,a,o),this._x=t,this._height=e,this._dir=n,this._width=r}function h(t,e,n,i){this._x=t,this._height=e,this._fill=n,this._stroke=i}function d(t,e,n){this.glyph=t,this._min=e,this._max=n,t&&(this.bump=t.bump)}function f(t,e,n,r,o,a){i.call(this,o,r),this._min=t,this._max=e,this._height=n,this._ori=a}function p(t,e,n,r){i.call(this,r,null),this._min=t,this._max=e,this._height=n}function _(t,e,n,i,r,o){this._min=t,this._max=e,this._height=n,this._style=i,this._strand=r,this._stroke=o}function g(t,e,n,i,r){this._min=t,this._max=e,this._height=n,this._fill=i,this._stroke=r}function m(t,e,n,r,o,a,s){i.call(this,null,r),this._min=t,this._max=e,this._height=n,this._color=r,this._parallel=o,this._sw=a,this._ne=s}function v(t,e,n,i,r){this._min=t,this._max=e,this._height=n,this._fill=i,this._stroke=r}function y(t,e,n,i,r,o){this._min=e,this._max=n,this._height=i,this._fill=r,this._string=o,this._textLen=t.measureText(o).width}function b(t,e,n){var i,r={red:"darkred",purple:"mediumpurple",blue:"darkblue",green:"darkgreen"},o=r[n.toLowerCase()];return i=o?[n,o]:["rgb(73, 68, 149)","rgb(9, 0, 103)"],"?"==t?"black":"M"==t?"greenyellow":"*"==t?"crimson":i[e%2]}function x(t){for(var e={A:"T",T:"A",G:"C",C:"G"},n=t.split("").reverse().join(""),i=[],r=0;r<n.length;++r){var o=n.substr(r,1).toUpperCase();i.push(o in e?e[o]:"N")}return i.join("")}function w(t,e,n,i,r,o,a){this._min=t,this._max=e,this._height=n,this._fill=i,this._seq=r,this._orientation=o,this._readframe=a}function S(t,e,n,i){this.glyph=t,this._height=i,this._x=e,this._y=n}function A(t,e,n,i){this._x=t,this._y=e,this._height=n,this._fill=i}function k(t){this._height=t||50}function C(t,e,n,r,o){i.call(this,o,r),this._x=t,this._r=e,this._points=n}function T(t,e,n,i,r){this._x=t,this._height=e,this._overhang=n,this._fill=i,this._stroke=r,this._hh=e/2}function E(){this.ox=0,this.oy=0,this.glyphs=[]}var M=n(269),L=M.union,R=M.Range,O=n(248),P=O.makeElementNS,D=O.AMINO_ACID_TRANSLATION,I=n(270),N=I.NS_SVG,F=(I.NS_XLINK,I.SVGPath);i.prototype.draw=function(t){t.beginPath(),this.drawPath(t),this._fill&&(t.fillStyle=this._fill,t.fill()),this._stroke&&(t.strokeStyle=this._stroke,t.stroke())},i.prototype.toSVG=function(){var t=new F;return this.drawPath(t),P(N,"path",null,{d:t.toPathData(),fill:this._fill||"none",stroke:this._stroke||"none"})},i.prototype.drawPath=function(t){throw"drawPath method on PathGlyphBase must be overridden"},r.prototype.draw=function(t){var e=this._radius;e>0?(t.beginPath(),t.moveTo(this.x+e,this.y),t.lineTo(this.x+this._width-e,this.y),t.arcTo(this.x+this._width,this.y,this.x+this._width,this.y+e,e),t.lineTo(this.x+this._width,this.y+this._height-e),t.arcTo(this.x+this._width,this.y+this._height,this.x+this._width-e,this.y+this._height,e),t.lineTo(this.x+e,this.y+this._height),t.arcTo(this.x,this.y+this._height,this.x,this.y+this._height-e,e),t.lineTo(this.x,this.y+e),t.arcTo(this.x,this.y,this.x+e,this.y,e),t.closePath(),null!=this._alpha&&(t.save(),t.globalAlpha=this._alpha),this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=.5,t.stroke()),null!=this._alpha&&t.restore()):(null!=this._alpha&&(t.save(),t.globalAlpha=this._alpha),this.fill&&(t.fillStyle=this.fill,t.fillRect(this.x,this.y,this._width,this._height)),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=.5,t.strokeRect(this.x,this.y,this._width,this._height)),null!=this._alpha&&t.restore())},r.prototype.toSVG=function(){var t=P(N,"rect",null,{x:this.x,y:this.y,width:this._width,height:this._height,stroke:this.stroke||"none",strokeWidth:.5,fill:this.fill||"none"});return null!=this._alpha&&t.setAttribute("opacity",this._alpha),t},r.prototype.min=function(){return this.x},r.prototype.max=function(){return this.x+this._width},r.prototype.height=function(){return this.y+this._height},o.prototype.drawConnectors=function(t){for(var e=this.coverage.ranges(),n=1;n<e.length;++n){var i=e[n],r=e[n-1];if(r&&i.min()>r.max()){var o=r.max(),a=i.min(),s=(o+a)/2;"hat+"===this.connector?(t.moveTo(o,this.h/2),t.lineTo(s,0),t.lineTo(a,this.h/2)):"hat-"===this.connector?(t.moveTo(o,this.h/2),t.lineTo(s,this.h),t.lineTo(a,this.h/2)):"collapsed+"===this.connector?(t.moveTo(o,this.h/2),t.lineTo(a,this.h/2),a-o>4&&(t.moveTo(s-2,this.h/2-3),t.lineTo(s+2,this.h/2),t.lineTo(s-2,this.h/2+3))):"collapsed-"===this.connector?(t.moveTo(o,this.h/2),t.lineTo(a,this.h/2),a-o>4&&(t.moveTo(s+2,this.h/2-3),t.lineTo(s-2,this.h/2),t.lineTo(s+2,this.h/2+3))):(t.moveTo(o,this.h/2),t.lineTo(a,this.h/2))}r=i}},o.prototype.draw=function(t,e){for(var n=0;n<this.glyphs.length;++n){var i=this.glyphs[n];i.draw(t,e)}t.strokeStyle="black",t.beginPath(),this.drawConnectors(t),t.stroke()},o.prototype.toSVG=function(){for(var t=P(N,"g"),e=0;e<this.glyphs.length;++e)t.appendChild(this.glyphs[e].toSVG());var n=new F;this.drawConnectors(n);var i=n.toPathData();if(i.length>0){var r=P(N,"path",null,{d:n.toPathData(),fill:"none",stroke:"black",strokeWidth:.5});t.appendChild(r)}return t},o.prototype.min=function(){return this.coverage.min()},o.prototype.max=function(){return this.coverage.max()},o.prototype.height=function(){return this.h},a.prototype.min=function(){return this.points[0]},a.prototype.max=function(){return this.points[this.points.length-2]},a.prototype.height=function(){return this._height},a.prototype.draw=function(t){t.save(),t.strokeStyle=this.color,t.lineWidth=2,t.beginPath();for(var e=0;e<this.points.length;e+=2){var n=this.points[e],i=this.points[e+1];0==e?t.moveTo(n,i):t.lineTo(n,i)}t.stroke(),t.restore()},a.prototype.toSVG=function(){for(var t=new F,e=0;e<this.points.length;e+=2){var n=this.points[e],i=this.points[e+1];0==e?t.moveTo(n,i):t.lineTo(n,i)}return P(N,"path",null,{d:t.toPathData(),fill:"none",stroke:this.color,strokeWidth:"2px"})},s.prototype.toSVG=function(){var t=this.glyph.toSVG(),e={};return"above"==this.align?(t=P(N,"g",t,{transform:"translate(0, "+(2|this.textHeight)+")"}),e.y=this.textHeight):e.y=this.glyph.height()+15,this.font&&(e.fontSize=7),"center"==this.anchor?e.x=(this.glyph.min()+this.glyph.max()-this.textLen)/2:e.x=this.glyph.min(),P(N,"g",[t,P(N,"text",this.text,e)])},s.prototype.min=function(){return this.glyph.min()},s.prototype.max=function(){return this.measured?Math.max(this.glyph.max(),1*this.glyph.min()+this.textLen+10):this.glyph.max()},s.prototype.height=function(){var t=this.glyph.height();return this.measured&&(t+="above"==this.align?this.textHeight+2:20),t},s.prototype.draw=function(t,e){"above"==this.align&&(t.save(),t.translate(0,this.textHeight+2)),this.glyph.draw(t),"above"==this.align&&t.restore(),e.registerGlyph(this)},s.prototype.drawOverlay=function(t,e,n){t.fillStyle="black",this.font&&(t.save(),t.font=this.font);var i;"center"==this.anchor?i=(this.glyph.min()+this.glyph.max()-this.textLen)/2:(i=this.glyph.min(),e>i&&(i=Math.min(e,this.glyph.max()-this.textLen))),t.fillText(this.text,i,"above"==this.align?this.textHeight:this.glyph.height()+15),this.font&&t.restore()},l.prototype.draw=function(t){var e=this._height/2;t.beginPath(),t.moveTo(this._x,0),t.lineTo(this._x,this._height),t.moveTo(this._x-e,e),t.lineTo(this._x+e,e),t.strokeStyle=this._stroke,t.lineWidth=1,t.stroke()},l.prototype.toSVG=function(){var t=this._height/2,e=new F;return e.moveTo(this._x,0),e.lineTo(this._x,this._height),e.moveTo(this._x-t,t),e.lineTo(this._x+t,t),P(N,"path",null,{d:e.toPathData(),fill:"none",stroke:this._stroke,strokeWidth:"1px"})},l.prototype.min=function(){return this._x-this._height/2},l.prototype.max=function(){return this._x+this._height/2},l.prototype.height=function(){return this._height},u.prototype.draw=function(t){var e=this._height/2;t.beginPath(),t.moveTo(this._x-e,0),t.lineTo(this._x+e,this._height),t.moveTo(this._x-e,this._height),t.lineTo(this._x+e,0),t.strokeStyle=this._stroke,t.lineWidth=1,t.stroke()},u.prototype.toSVG=function(){var t=this._height/2,e=new F;return e.moveTo(this._x-t,0),e.lineTo(this._x+t,this._height),e.moveTo(this._x-t,this._height),e.lineTo(this._x+t,0),P(N,"path",null,{d:e.toPathData(),fill:"none",stroke:this._stroke,strokeWidth:"1px"})},u.prototype.min=function(){return this._x-this._height/2},u.prototype.max=function(){return this._x+this._height/2},u.prototype.height=function(){return this._height},c.prototype=Object.create(i.prototype),c.prototype.drawPath=function(t){var e=this._height/2,n=this._width/2;"S"===this._dir?(t.moveTo(this._x,this._height),t.lineTo(this._x-n,0),t.lineTo(this._x+n,0)):"W"===this._dir?(t.moveTo(this._x+n,e),t.lineTo(this._x-n,0),t.lineTo(this._x-n,this._height)):"E"===this._dir?(t.moveTo(this._x-n,e),t.lineTo(this._x+n,0),t.lineTo(this._x+n,this._height)):(t.moveTo(this._x,0),t.lineTo(this._x+n,this._height),t.lineTo(this._x-n,this._height)),t.closePath()},c.prototype.min=function(){return this._x-this._height/2},c.prototype.max=function(){return this._x+this._height/2},c.prototype.height=function(){return this._height},h.prototype.draw=function(t){var e=this._height/2;t.fillStyle=this._stroke,t.beginPath(),t.arc(this._x,e,e,0,6.29),this._fill&&(t.fillStyle=this._fill,t.fill()),this._stroke&&(t.strokeStyle=this._stroke,t.stroke())},h.prototype.toSVG=function(){var t=this._height/2;return P(N,"circle",null,{cx:this._x,cy:t,r:t,fill:this._fill||"none",stroke:this._stroke||"none",strokeWidth:"1px"})},h.prototype.min=function(){return this._x-this._height/2},h.prototype.max=function(){return this._x+this._height/2},h.prototype.height=function(){return this._height},d.prototype.draw=function(t,e){this.glyph&&this.glyph.draw(t,e)},d.prototype.toSVG=function(){return this.glyph?this.glyph.toSVG():P(N,"g")},d.prototype.min=function(){return this._min},d.prototype.max=function(){return this._max},d.prototype.height=function(){return this.glyph?this.glyph.height():1},f.prototype=Object.create(i.prototype),f.prototype.min=function(){return this._min},f.prototype.max=function(){return this._max},f.prototype.height=function(){return this._height},f.prototype.drawPath=function(t){var e=this._max,n=this._min,i=this._height,r=0,o=0,a=this._height+2,s=.333333*this._height,l=0;this._ori&&("+"===this._ori?o=.5*this._height:"-"===this._ori&&(r=.5*this._height)),a>e-n&&(n=(e+n-a)/2,e=n+a),t.moveTo(n+r,l+s),t.lineTo(e-o,l+s),t.lineTo(e-o,l),t.lineTo(e,l+this._height/2),t.lineTo(e-o,l+i),t.lineTo(e-o,l+s+s),t.lineTo(n+r,l+s+s),t.lineTo(n+r,l+i),t.lineTo(n,l+i/2),t.lineTo(n+r,l),t.lineTo(n+r,l+s)},p.prototype=Object.create(i.prototype),p.prototype.min=function(){return this._min},p.prototype.max=function(){return this._max},p.prototype.height=function(){return this._height},p.prototype.drawPath=function(t){var e=this._min,n=this._max,i=this._height,r=i/2;t.moveTo(e,r),t.lineTo(n,r),t.moveTo(e,0),t.lineTo(e,i),t.moveTo(n,0),t.lineTo(n,i)},_.prototype.min=function(){return this._min},_.prototype.max=function(){return this._max},_.prototype.height=function(){return this._height},_.prototype.drawPath=function(t){var e=this._min,n=this._max,i=this._height,r=i/2;"hat"===this._style?(t.moveTo(e,r),t.lineTo((e+n)/2,"-"===this._strand?i:0),t.lineTo(n,r)):(t.moveTo(e,r),t.lineTo(n,r))},_.prototype.draw=function(t){t.beginPath(),this.drawPath(t),t.strokeStyle=this._stroke,"dashed"===this._style&&t.setLineDash?(t.save(),t.setLineDash([3]),t.stroke(),t.restore()):t.stroke()},_.prototype.toSVG=function(){var t=new F;this.drawPath(t);var e={d:t.toPathData(),stroke:this._stroke||"none"};return"dashed"===this._style&&(e.strokeDasharray="3"),P(N,"path",null,e)},g.prototype.min=function(){return this._min},g.prototype.max=function(){return this._max},g.prototype.height=function(){return this._height},g.prototype.drawStemPath=function(t){var e=this._min,n=this._max,i=this._height,r=i/2;t.moveTo(e,r),t.lineTo(n,r)},g.prototype.drawTrigsPath=function(t){var e=this._min,n=this._max,i=this._height,r=i/2;t.moveTo(e,0),t.lineTo(e+i,r),t.lineTo(e,i),t.lineTo(e,0),t.moveTo(n,0),t.lineTo(n-i,r),t.lineTo(n,i),t.lineTo(n,0)},g.prototype.draw=function(t){t.beginPath(),this.drawStemPath(t),t.strokeStyle=this._stroke,t.stroke(),t.beginPath(),this.drawTrigsPath(t),t.fillStyle=this._fill,t.fill()},g.prototype.toSVG=function(){var t=new F;this.drawStemPath(t);var e=new F;return this.drawTrigsPath(e),P(N,"g",[P(N,"path",null,{d:t.toPathData(),stroke:this._stroke||"none"}),P(N,"path",null,{d:e.toPathData(),fill:this._fill||"none"})])},m.prototype=Object.create(i.prototype),m.prototype.min=function(){return this._min},m.prototype.max=function(){return this._max},m.prototype.height=function(){return this._height},m.prototype.drawPath=function(t){var e=this._min,n=this._max,i=this._height;if(this._parallel){var r=i/2,o=.4*i;this._sw?(t.moveTo(e+r,i-o),t.lineTo(e+r,i),t.lineTo(e,r),t.lineTo(e+r,0),t.lineTo(e+r,o)):(t.moveTo(e,i-o),t.lineTo(e,o)),this._ne?(t.lineTo(n-r,o),t.lineTo(n-r,0),t.lineTo(n,r),t.lineTo(n-r,i),t.lineTo(n-r,i-o)):(t.lineTo(n,o),t.lineTo(n,i-o)),t.closePath()}else{var a=(e+n)/2,o=.4*(n-e),s=i/3;this._ne?(t.moveTo(e+o,s),t.lineTo(e,s),t.lineTo(a,0),t.lineTo(n,s),t.lineTo(n-o,s)):(t.moveTo(e+o,0),t.lineTo(n-o,0)),this._sw?(t.lineTo(n-o,i-s),t.lineTo(n,i-s),t.lineTo(a,i),t.lineTo(e,i-s),t.lineTo(e+o,i-s)):(t.lineTo(n-o,i),t.lineTo(e+o,i)),t.closePath()}},v.prototype.min=function(){return this._min},v.prototype.max=function(){return this._max},v.prototype.height=function(){return this._height},v.prototype.toSVG=function(){return P(N,"rect",null,{x:this._min,y:0,width:this._max-this._min,height:this._height,stroke:this._stroke||"none",fill:this._fill||"none"})},v.prototype.draw=function(t){if(this._fill&&(t.fillStyle=this._fill,t.fillRect(this._min,0,this._max-this._min,this._height)),this._stroke){t.strokeStyle=this._stroke,t.strokeRect(this._min,0,this._max-this._min,this._height),t.beginPath();for(var e=2;e<this._height;e+=3)t.moveTo(this._min,e),t.lineTo(this._max,e);t.stroke()}},y.prototype.min=function(){return this._min},y.prototype.max=function(){return Math.max(this._max,this._min+this._textLen)},y.prototype.height=function(){return this._height},y.prototype.draw=function(t){t.fillStyle=this._fill,t.fillText(this._string,this._min,this._height-4)},y.prototype.toSVG=function(){return P(N,"text",this._string,{x:this._min,y:this._height-4})},w.prototype.min=function(){return this._min},w.prototype.max=function(){return this._max},w.prototype.height=function(){return this._height},w.prototype.draw=function(t){var e=this._seq,n=this._fill;if(e){var i=(this._max-this._min+1)/e.length,r=(3-this._readframe)%3,o=(e.length-r)%3,a="+"==this._orientation?r:o;a>0&&(t.fillStyle=n,t.fillRect(this._min,0,i*a,this._height));for(var s=a;s<e.length;s+=3){var l=e.substr(s,3).toUpperCase();"-"==this._orientation&&(l=x(l));var u=l in D?D[l]:"?";n=3==l.length?b(u,s,this._fill):this._fill,t.fillStyle=n,t.fillRect(this._min+s*i,0,i*l.length,this._height),i>=8&&3==l.length&&(t.fillStyle="white",t.fillText(u,this._min+(s+1)*i,this._height))}}},w.prototype.toSVG=function(){var t=P(N,"g"),e=this._seq,n=this._fill;if(!e)return t;var i=(this._max-this._min+1)/e.length,r=(3-this._readframe)%3,o=(e.length-r)%3,a="+"==this._orientation?r:o;a>0&&t.appendChild(P(N,"rect",null,{x:this._min,y:0,width:i*a,height:this._height,fill:n}));for(var s=a;s<e.length;s+=3){var l=e.substr(s,3).toUpperCase();"-"==this._orientation&&(l=x(l));var u=l in D?D[l]:"?";n=3==l.length?b(u,s,this._fill):this._fill,t.appendChild(P(N,"rect",null,{x:this._min+s*i,y:0,width:i*l.length,height:this._height,fill:n})),i>=8&&3==l.length&&t.appendChild(P(N,"text",u,{x:this._min+(s+1)*i,y:this._height,fill:"white"}))}return t},function(t){function e(t,e,n,i,r,o,a,s,l,u){this.baseColors=t,this._strandColor=e,this._min=n,this._max=i,this._height=r,this._seq=o,this._ref=a,this._scheme=s,this._quals=l,this._fillbg=u}var n=window.devicePixelRatio>1,i={},r=new RegExp("^[ACGT-]$"),o=function(t){return t>=8};e.prototype.min=function(){return this._min},e.prototype.max=function(){return this._max},e.prototype.height=function(){return this._height},e.prototype.alphaForQual=function(t){return.1+.9*Math.max(0,Math.min(1*t/30,1))},e.prototype.draw=function(t){var e=this._seq,a=this._ref,s="mismatch"===this._scheme||"mismatch-all"===this._scheme,l="mismatch-all"===this._scheme,u=e?e.length:this._max-this._min+1,c=(this._max-this._min+1)/u;s&&!o(c)&&(t.fillStyle=this._strandColor,t.fillRect(this._min,this._height/4,this._max-this._min,this._height/2));for(var h=0;u>h;++h){var d=e?e.substr(h,1).toUpperCase():"N";if(r.test(d)||o(c)){var f=this.baseColors[d];if(this._quals){var p=this._quals.charCodeAt(h)-33,_=t.globalAlpha;t.globalAlpha=this.alphaForQual(p)}if(!f){var g=a?a.substr(h,1).toUpperCase():"N";f="N"==d||"N"==g?"gray":this._strandColor,l&&(d=g)}t.fillStyle=f;var m=r.test(d);if(!this._fillbg&&o(c)&&m||t.fillRect(this._min+h*c,0,c,this._height),o(c)&&m){var v=f+"_"+d,y=i[v];if(!y){y=document.createElement("canvas"),n?(y.width=16,y.height=20):(y.width=8,y.height=10);var b=y.getContext("2d");n&&b.scale(2,2),b.fillStyle=this._fillbg?"black":f;var x=b.measureText(d).width;b.fillText(d,.5*(8-x),8),i[v]=y}n?t.drawImage(y,this._min+h*c+.5*(c-8),0,8,10):t.drawImage(y,this._min+h*c+.5*(c-8),0)}this._quals&&(t.globalAlpha=_)}}},e.prototype.toSVG=function(){for(var t=this._seq,e=this._ref,n=("mismatch"===this._scheme||"mismatch-all"===this._scheme,"mismatch-all"===this._scheme),i=(this._max-this._min+1)/this._seq.length,a=P(N,"g"),s=0;s<t.length;++s){var l=t?t.substr(s,1).toUpperCase():"N",u=this.baseColors[l];if(!u){var c=e?e.substr(s,1).toUpperCase():"N";u="N"==l||"N"==c?"gray":this._strandColor,n&&(l=c)}var h=1;if(this._quals){var d=this._quals.charCodeAt(s)-33;h=this.alphaForQual(d)}var f=r.test(l);!this._fillbg&&o(i)&&f||a.appendChild(P(N,"rect",null,{x:this._min+s*i,y:0,width:i,height:this._height,fill:u,fillOpacity:h})),o(i)&&f&&a.appendChild(P(N,"text",l,{x:this._min+(.5+s)*i,y:8,textAnchor:"middle",fill:this._fillbg?"black":u,fillOpacity:h}))}return a},t.SequenceGlyph=e}(this),S.prototype.height=function(){return this._height?this._height:this.glyph.height()+this._y},S.prototype.min=function(){return this.glyph.min()+this._x},S.prototype.max=function(){return this.glyph.max()+this._x},S.prototype.minY=function(){return this._y},S.prototype.maxY=function(){return this._y+this.glyph.height()},S.prototype.draw=function(t,e){t.save(),t.translate(this._x,this._y),this.glyph.draw(t,e),t.restore()},S.prototype.toSVG=function(){var t=this.glyph.toSVG();return t.setAttribute("transform","translate("+this._x+","+this._y+")"),t},A.prototype.min=function(){return this._x-2},A.prototype.max=function(){return this._x+2},A.prototype.height=function(){return this._height},A.prototype.draw=function(t){t.save(),t.globalAlpha=.3,t.fillStyle=this._fill,t.beginPath(),t.arc(this._x,this._y,1.5,0,6.29),t.fill(),t.restore()},A.prototype.toSVG=function(){return P(N,"circle",null,{cx:this._x,cy:this._y,r:2,fill:this._fill,stroke:"none"})},k.prototype.notSelectable=!0,k.prototype.min=function(){return-1e5},k.prototype.max=function(){return 1e5},k.prototype.height=function(){return this._height},k.prototype.draw=function(t){t.save(),t.strokeStyle="black",t.lineWidth=.1,t.beginPath();for(var e=0;e<=this._height;e+=10)t.moveTo(-5e3,e),t.lineTo(5e3,e);t.stroke(),t.restore()},k.prototype.toSVG=function(){for(var t=new F,e=0;e<=this._height;e+=10)t.moveTo(-5e3,e),t.lineTo(5e3,e);return P(N,"path",null,{d:t.toPathData(),fill:"none",stroke:"black",strokeWidth:"0.1px"})},C.prototype=Object.create(i.prototype),C.prototype.min=function(){return this._x-this._r},C.prototype.max=function(){return this._x+this._r},C.prototype.height=function(){return 2*this._r},C.prototype.drawPath=function(t){for(var e=this._x,n=this._r,i=this._r,r=0;r<this._points;++r){var o=6.28*r/this._points,a=e+i*Math.sin(o),s=n-i*Math.cos(o);0==r?t.moveTo(a,s):t.lineTo(a,s),o=6.28*(r+.5)/this._points,a=e+.4*i*Math.sin(o),s=n-.4*i*Math.cos(o),t.lineTo(a,s)}t.closePath()},T.prototype.draw=function(t){var e=this._height/2;t.fillStyle=this._stroke,t.beginPath(),t.arc(this._x,e,e-this._overhang,0,6.29),t.moveTo(this._x,0),t.lineTo(this._x,this._height),this._fill&&(t.fillStyle=this._fill,t.fill()),this._stroke&&(t.strokeStyle=this._stroke,t.stroke())},T.prototype.toSVG=function(){var t=this._hh;return P(N,"g",[P(N,"circle",null,{cx:this._x,cy:t,r:t-this._overhang}),P(N,"line",null,{x1:this._x,y1:0,x2:this._x,y2:this._height})],{fill:this._fill||"none",stroke:this._stroke||"none",strokeWidth:"1px"})},T.prototype.min=function(){return this._x-this._hh},T.prototype.max=function(){return this._x+this._hh},T.prototype.height=function(){return this._height},E.prototype.translate=function(t,e){this.ox+=t,this.oy+=e},E.prototype.registerGlyph=function(t){this.glyphs.push({x:this.ox,y:this.oy,glyph:t})},E.prototype.draw=function(t,e,n){for(var i=0;i<this.glyphs.length;++i){var r=this.glyphs[i];t.save(),t.translate(r.x,r.y),r.glyph.drawOverlay(t,e,n),t.restore()}},t.exports={BoxGlyph:r,GroupGlyph:o,LineGraphGlyph:a,LabelledGlyph:s,CrossGlyph:l,ExGlyph:u,TriangleGlyph:c,DotGlyph:h,PaddedGlyph:d,AArrowGlyph:f,SpanGlyph:p,LineGlyph:_,PrimersGlyph:g,ArrowGlyph:m,TooManyGlyph:v,TextGlyph:y,SequenceGlyph:this.SequenceGlyph,AminoAcidGlyph:w,TranslatedGlyph:S,GridGlyph:k,StarGlyph:C,PointGlyph:A,PlimsollGlyph:T,OverlayLabelCanvas:E}},function(t,e,n){"use strict";function i(t,e){if("number"!=typeof t||"number"!=typeof e)throw"Bad range "+t+","+e;this._min=t,this._max=e}function r(t){this._ranges=t}function o(t,e){if(t instanceof Array||(t=[t],e&&t.push(e)),0==t.length)return null;if(1==t.length)return t[0];for(var n=[],o=0;o<t.length;++o)t[o]._pushRanges(n);n=n.sort(u);var a=[],s=n[0];s=new i(s._min,s._max);for(var l=1;l<n.length;++l){var c=n[l];c._min>s._max+1?(a.push(s),s=new i(c._min,c._max)):c._max>s._max&&(s._max=c._max)}return a.push(s),1==a.length?a[0]:new r(a)}function a(t,e){for(var n=t.ranges(),o=e.ranges(),a=n.length,s=o.length,l=0,u=0,c=[];a>l&&s>u;){var t=n[l],e=o[u],h=Math.max(t.min(),e.min()),d=Math.min(t.max(),e.max());d>=h&&c.push(new i(h,d)),t.max()>e.max()?++u:++l}return 0==c.length?null:1==c.length?c[0]:new r(c)}function s(t){for(var e=0,n=t.ranges(),i=0;i<n.length;++i){var r=n[i];e+=r.max()-r.min()+1}return e}function l(t,e){return t.min()<e.min()?-1:t.min()>e.min()?1:t.max()<e.max()?-1:e.max()>t.max()?1:0}function u(t,e){return t._min<e._min?-1:t._min>e._min?1:t._max<e._max?-1:e._max>t._max?1:0}i.prototype.min=function(){return this._min},i.prototype.max=function(){return this._max},i.prototype.contains=function(t){return t>=this._min&&t<=this._max},i.prototype.isContiguous=function(){return!0},i.prototype.ranges=function(){return[this]},i.prototype._pushRanges=function(t){t.push(this)},i.prototype.toString=function(){return"["+this._min+"-"+this._max+"]"},r.prototype.min=function(){return this._ranges[0].min()},r.prototype.max=function(){return this._ranges[this._ranges.length-1].max()},r.prototype.contains=function(t){for(var e=0;e<this._ranges.length;++e)if(this._ranges[e].contains(t))return!0;return!1},r.prototype.isContiguous=function(){return this._ranges.length>1},r.prototype.ranges=function(){return this._ranges},r.prototype._pushRanges=function(t){for(var e=0;e<this._ranges.length;++e)t.push(this._ranges[e])},r.prototype.toString=function(){for(var t="",e=0;e<this._ranges.length;++e)e>0&&(t+=","),t+=this._ranges[e].toString();return t},t.exports={Range:i,union:o,intersection:a,coverage:s,rangeOver:l,_rangeOrder:u}},function(t,e,n){function i(){this.ops=[]}var r="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xlink";i.prototype.moveTo=function(t,e){this.ops.push("M "+t+" "+e)},i.prototype.lineTo=function(t,e){this.ops.push("L "+t+" "+e)},i.prototype.closePath=function(){this.ops.push("Z")},i.prototype.toPathData=function(){return this.ops.join(" ")},t.exports={NS_SVG:r,NS_XLINK:o,SVGPath:i}},function(t,e,n){function i(t){for(var e,n=[];null!=(e=r.exec(t));){var i=e[1];0==i.length&&(i=1),n.push({cnt:0|i,op:e[2]})}return n}var r=new RegExp("([0-9]*)([MIDS])","g");t.exports={parseCigar:i}},function(t,e,n){function i(t){return(0|t).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function r(t){var e=""+t,n=e.indexOf(".");if(0>n)return e;var i=2;return"-"==e.substring(0,1)&&++i,n>=i?e.substring(0,n):e.substring(0,n+2)}t.exports={formatLongInt:i,formatQuantLabel:r}},function(t,e,n){"use strict";function i(t,e){function n(t){return p[t%p.length]*Math.pow(10,t/p.length|0)}e||(e=f);for(var i=p.length;t*n(i)<e;)++i;return n(i)}function r(t,e){var n=t.viewport.getContext("2d"),i=t.browser.retina&&window.devicePixelRatio>1,r=t.browser.featurePanelWidth+2e3;i&&(r*=2);var a=0|t.viewport.width;r-50>a&&(t.viewport.width=a=r);var s=50;e&&e.seq&&(s+=25);var l=s;i&&(l*=2),t.viewport.height=l,t.viewport.style.height=""+s+"px",t.viewport.style.width=i?""+a/2+"px":""+a+"px",t.layoutHeight=s,t.updateHeight(),t.background&&(n.fillStyle=t.background,n.fillRect(0,0,a,t.viewport.height)),i&&n.scale(2,2),n.translate(1e3,0),o(t,e,n),t.norigin=t.browser.viewStart,t.viewportHolder.style.left="-1000px"}function o(t,e,n){var r=t.browser.scale,o=t.browser.viewStart-1e3/r|0,a=t.browser.viewEnd+2e3/r,s=t.browser.currentSeqMax,u=a;s>0&&a>s&&(u=s);for(var c=i(r),h=Math.max(0,(o/c|0)*c),d=t.browser.viewStart;u>=h;)n.fillStyle=h/c%2==0?"white":"black",n.strokeStyle="black",n.fillRect((h-d)*r,8,c*r,3),n.strokeRect((h-d)*r,8,c*r,3),n.fillStyle="black",n.fillText(l(h),(h-d)*r,22),h+=c;if(e&&e.seq)for(var f=o;a>=f;++f)if(f>=e.start&&f<=e.end){var p=e.seq.substr(f-e.start,1).toUpperCase(),_=t.browser.baseColors[p];if(_||(_="gray"),n.fillStyle=_,r>=8){var g=n.measureText(p).width;n.fillText(p,(f-d)*r+.5*(r-g),52)}else n.fillRect((f-d)*r,42,r,12)}}function a(t,e){var n=t.browser.scale,r=t.browser.viewStart-1e3/n|0,o=t.browser.viewEnd+2e3/n,a=t.browser.currentSeqMax,s=(0|t.viewport.width,o);a>0&&o>a&&(s=a);for(var c=i(n),d=Math.max(0,(r/c|0)*c),f=t.browser.viewStart,p=u(h,"g",[],{fontSize:"8pt"});s>=d;)p.appendChild(u(h,"rect",null,{x:(d-f)*n,y:8,width:c*n,height:3,fill:d/c%2==0?"white":"black",stroke:"black"})),p.appendChild(u(h,"text",l(d),{x:(d-f)*n,y:28,fill:"black",stroke:"none"})),d+=c;if(e&&e.seq)for(var _=r;o>=_;++_)if(_>=e.start&&_<=e.end){var g=e.seq.substr(_-e.start,1).toUpperCase(),m=t.browser.baseColors[g];m||(m="gray"),n>=8?p.appendChild(u(h,"text",g,{x:(.5+_-f)*n,y:52,textAnchor:"middle",fill:m})):p.appendChild(u(h,"rect",null,{x:(_-f)*n,y:42,width:n,height:12,fill:m}))}return p}var s=n(248),l=s.formatLongInt,u=s.makeElementNS,c=n(270),h=c.NS_SVG,d=(c.NS_XLINK,c.SVGPath,n(272)),l=d.formatLongInt,f=100,p=[1,2,5],h="http://www.w3.org/2000/svg";t.exports={drawSeqTier:r,drawSeqTierGC:o,svgSeqTier:a}},function(t,e,n){"use strict";function i(t){this.genomes={},this.url=t}function r(){}function o(t){this.hub=t}function a(t,e,n){n=n||{},n.salt=!0,u(t,function(r,a){if(a)return e(null,a);var s=r.split(g),l=new i(t);n.credentials&&(l.credentials=n.credentials);for(var h=0;h<s.length-2;h+=3)l[s[h+1]]=s[h+2];if(l.genomesFile){var d=c(t,l.genomesFile);u(d,function(t,i){if(i)return e(null,i);for(var r=t.split(_),a=0;a<r.length;++a){var s=r[a].split(g),u=new o(l);n.credentials&&(u.credentials=n.credentials);for(var h=0;h<s.length-2;h+=3)u[s[h+1]]=s[h+2];u.twoBitPath&&(u.twoBitPath=c(d,u.twoBitPath)),u.genome&&u.trackDb&&(u.absURL=c(d,u.trackDb),l.genomes[u.genome]=u)}e(l)},n)}else e(null,"No genomesFile")},n)}function s(t,e){return t.priority&&e.priority?1*t.priority-1*e.priority:t.priority?1:e.priority?-1:t.shortLabel.localeCompare(e.shortLabel)}var l=n(248),u=l.textXHR,c=l.relativeURL,h=l.shallowCopy,d=n(251),f=d.DASStylesheet,p=d.DASStyle,_=/\n\s*\n/,g=/(\w+) +(.+)\n?/,m=/subGroup[1-9]/,v="http://genome.ucsc.edu/images/";r.prototype.get=function(t){return this[t]?this[t]:this._parent?this._parent.get(t):void 0},o.prototype.getTracks=function(t){var e=this;return this._tracks?t(this._tracks):void u(this.absURL,function(n,i){if(i)return t(null,i);n=n.replace("\\\n"," ");for(var o=[],a={},s=n.split(_),l=0;l<s.length;++l){var u=s[l].replace(/\#.*/g,"").split(g),c=new r;c._db=e;for(var h=0;h<u.length-2;h+=3){var d=u[h+1],f=u[h+2];if(d.match(m)){c.subgroups||(c.subgroups={});for(var p=f.split(/\s/),v=p[0],y={name:p[1],tags:[],titles:[]},b=2;b<p.length;++b){var x=p[b].split(/=/);y.tags.push(x[0]),y.titles.push(x[1])}c.subgroups[v]=y}else if("subGroups"===d){var p=f.split(/(\w+)=(\w+)/);c.sgm={};for(var b=0;b<p.length-2;b+=3)c.sgm[p[b+1]]=p[b+2]}else c[u[h+1]]=u[h+2]}c.track&&(c.type||c.container||c.view||c.bigDataUrl)&&(o.push(c),a[c.track]=c)}for(var w=[],S=[],A=0;A<o.length;++A){var c=o[A],k=!0;if(c.parent){var C=c.parent.split(/\s+/),T=a[C[0]];T?(c._parent=T,T.children||(T.children=[]),T.children.push(c),T&&(k=!1)):console.log("Couldn't find parent "+C[0]+"("+c.parent+")")}c.compositeTrack?S.push(c):k&&w.push(c);
}for(var E=0;E<S.length;++E){var M=S[E];if(M.children){for(var L=!1,R=0;R<M.children.length;++R){var d=M.children[R];d.view&&(d.shortLabel=M.shortLabel+": "+d.shortLabel,w.push(d),L=!0)}L||w.push(M)}}return e._tracks=w,t(e._tracks,null)},{credentials:this.credentials,salt:!0})},r.prototype.toDallianceSource=function(){var t={name:this.shortLabel,desc:this.longLabel};this._db.mapping&&(t.mapping=this._db.mapping);var e=this.get("pennantIcon");if(e){var n=e.split(/\s+/);t.pennant=v+n[0]}var i=this.get("searchTrix");if(i&&(t.trixURI=c(this._db.absURL,i)),"multiWig"==this.container){t.merge="concat",t.overlay=[];var r=this.children||[];t.style=[],t.noDownsample=!0;for(var o=0;o<r.length;++o){var a=r[o],s=a.toDallianceSource();if(t.overlay.push(s),s.style)for(var l=0;l<s.style.length;++l){var u=s.style[l];u.method=a.shortLabel,"transparentOverlay"==this.aggregate&&(u.style.ALPHA=.5),t.style.push(u)}}return t}var h=this.type;if(!h){for(var d=this;d._parent&&!d.type;)d=d._parent;h=d.type}if(h){var f=h.split(/\s+/);if("bigBed"==f[0]&&this.bigDataUrl){var p=0|f[1],_="+"==f[2];return t.bwgURI=c(this._db.absURL,this.bigDataUrl),t.style=this.bigbedStyles(),this._db.credentials&&(t.credentials=!0),p>=12&&_&&(t.collapseSuperGroups=!0),t}return"bigWig"==f[0]&&this.bigDataUrl?(t.bwgURI=c(this._db.absURL,this.bigDataUrl),t.style=this.bigwigStyles(),t.noDownsample=!0,this.yLineOnOff&&"on"==this.yLineOnOff&&(t.quantLeapThreshold=void 0!==this.yLineMark?1*this.yLineMark:0),this._db.credentials&&(t.credentials=!0),t):"bam"==f[0]&&this.bigDataUrl?(t.bamURI=c(this._db.absURL,this.bigDataUrl),this._db.credentials&&(t.credentials=!0),t):"vcfTabix"==f[0]&&this.bigDataUrl?(t.uri=c(this._db.absURL,this.bigDataUrl),t.tier_type="tabix",t.payload="vcf",this._db.credentials&&(t.credentials=!0),t):void console.log("Unsupported "+this.type)}},r.prototype.bigwigStyles=function(){var t=this.type;if(!t){for(var e=this;e._parent&&!e.type;)e=e._parent;t=e.type}if(t){var n,i,r=t.split(/\s+/);r.length>=3&&(n=1*r[1],i=1*r[2]);var o;if(this.maxHeightPixels){var a=this.maxHeightPixels.split(/:/);3==a.length?o=0|a[1]:console.log("maxHeightPixels should be of the form max:default:min")}var s="bars";this.graphTypeDefault&&(s=this.graphTypeDefault);var l="black",u=null;this.color&&(l="rgb("+this.color+")"),this.altColor&&(u="rgb("+this.altColor+")");var c=new f,h=new p;return"points"==s?h.glyph="POINT":h.glyph="HISTOGRAM",u?(h.COLOR1=l,h.COLOR2=u):h.BGCOLOR=l,h.HEIGHT=o||30,(n||i)&&(h.MIN=n,h.MAX=i),c.pushStyle({type:"default"},null,h),c.styles}},r.prototype.bigbedStyles=function(){var t="on"==(""+this.get("itemRgb")).toLowerCase(),e=this.get("visibility")||"full",n=this.get("color");n=n?"rgb("+n+")":"blue";var i=new f,r=new p;r.glyph="BOX",r.FGCOLOR="black",r.BGCOLOR=n,r.HEIGHT="full"==e||"pack"==e?12:8,r.BUMP="full"==e||"pack"==e,r.LABEL="full"==e||"pack"==e,r.ZINDEX=20,t&&(r.BGITEM=!0);var o=this.get("colorByStrand");if(o){var a=o.split(/\s+/),s=h(r);s.BGCOLOR="rgb("+a[0]+")",i.pushStyle({type:"bigwig",orientation:"+"},null,s);var l=h(r);l.BGCOLOR="rgb("+a[1]+")",i.pushStyle({type:"bigwig",orientation:"-"},null,l)}else i.pushStyle({type:"bigwig"},null,r);var u=new p;u.glyph="BOX",u.FGCOLOR="black",t&&(u.BGITEM=!0),u.BGCOLOR="red",u.HEIGHT=10,u.BUMP=!0,u.ZINDEX=20,i.pushStyle({type:"translation"},null,u);var c=new p;return c.glyph="BOX",c.FGCOLOR="black",c.BGCOLOR="white",c.HEIGHT=10,c.ZINDEX=10,c.BUMP=!0,c.LABEL=!0,i.pushStyle({type:"transcript"},null,c),i.styles},t.exports={connectTrackHub:a,THUB_COMPARE:s}},function(t,e,n){"use strict";var i={CONFIG:5,MAJOR:0,MINOR:13,MICRO:5,PATCH:"",BRANCH:"dev"};i.toString=function(){var t=""+this.MAJOR+"."+this.MINOR+"."+this.MICRO;return this.PATCH&&(t+=this.PATCH),this.BRANCH&&""!=this.BRANCH&&(t=t+"-"+this.BRANCH),t},t.exports=i},function(t,e,n){"use strict";function i(t,e,n,i){"string"==typeof t?(this.uri=t,this.srcTag=e,this.destTag=n,this.coords=i):(this.uri=t.uri,this.srcTag=t.srcTag,this.destTag=t.destTag,this.coords=_(t.coords),this.type=t.type,this.credentials=t.credentials),this.chainsBySrc={},this.chainsByDest={},this.postFetchQueues={},this.fetchedTiles={},this.granularity=1e6,"bigbed"==this.type?this.chainFetcher=new o(this.uri,this.credentials):"alias"==this.type?this.chainFetcher=new u(t):this.chainFetcher=new r(this.uri,this.srcTag,this.destTag)}function r(t,e,n){this.source=new h(t),this.srcTag=e,this.destTag=n}function o(t,e){var n=this;this.uri=t,this.credentials=e,this.bwg=new x(function(t,e){b(new v(n.uri,{credentials:n.credentials}),function(n,i){n?t(n):e(i)})}),this.bwg.then(function(t,e){e&&console.log(e)})}function a(t){return parseInt(t)}function s(t){return 0==t.indexOf("chr")?t.substr(3):t}function l(t){for(var e={srcChr:s(t.srcChrom),srcMin:parseInt(t.srcStart),srcMax:parseInt(t.srcEnd),srcOri:t.srcOri,destChr:s(t.segment),destMin:t.min-1,destMax:t.max,destOri:t.ori,blocks:[]},n=t.srcStarts.split(",").map(a),i=t.destStarts.split(",").map(a),r=t.blockLens.split(",").map(a),o=0;o<n.length;++o)e.blocks.push([n[o],i[o],r[o]]);return e}function u(t){this.conf=t,this.forwardAliases={};for(var e=t.sequenceAliases||[],n=0;n<e.length;++n){var i=e[n];if(!(i.length<2)){for(var r=[],o=0;o<i.length-1;++o)r.push(i[o]);this.forwardAliases[i[i.length-1]]=r}}}var c=n(251),h=c.DASSource,d=c.DASSegment,f=n(248),p=f.pusho,_=f.shallowCopy,g=n(271).parseCigar,m=n(277),v=m.URLFetchable,y=n(278),b=y.makeBwg,x=n(255).Promise;i.prototype.exportConfig=function(){return{uri:this.uri,srcTag:this.srcTag,destTag:this.destTag,coords:this.coords,type:this.type,credentials:this.credentials}},i.prototype.mapPoint=function(t,e){for(var n=this.chainsBySrc[t]||[],i=0;i<n.length;++i){var r=n[i];if(e>=r.srcMin&&e<=r.srcMax){var o;o="-"==r.srcOri?r.srcMax-e:e-r.srcMin;for(var a=r.blocks,s=0;s<a.length;++s){var l=a[s],u=l[0],c=l[1],h=l[2];if(o>=u&&u+h>=o){var d,f=o-u;return d="-"==r.destOri?r.destMax-c-f:f+c+r.destMin,{seq:r.destChr,pos:d,flipped:r.srcOri!=r.destOri}}}}}return null},i.prototype.mapSegment=function(t,e,n){for(var i=this.chainsBySrc[t]||[],r=[],o=0;o<i.length;++o){var a=i[o];if(n>=a.srcMin&&e<=a.srcMax){var s,l;"-"==a.srcOri?(s=a.srcMax-n,l=a.srcMax-e):(s=e-a.srcMin,l=n-a.srcMin);for(var u=a.blocks,c=0;c<u.length;++c){var h=u[c],d=h[0],f=h[1],p=h[2];if(l>=d&&d+p>=s){var _={segment:a.destChr,flipped:"-"==a.srcOri^"-"==a.destOri};"-"==a.destOri?(s>=d?_.max=a.destMax-f-s+d:(_.max=a.destMax-f,_.partialMax=d-s),d+p>=l?_.min=a.destMax-f-l+d:(_.min=a.destMax-f-p,_.partialMin=l-d-p)):(s>=d?_.min=a.destMin+f+s-d:(_.min=a.destMin+f,_.partialMin=d-s),d+p>=l?_.max=a.destMin+f+l-d:(_.max=a.destMin+f+p,_.partialMax=l-d-p)),r.push(_)}}}}return r},i.prototype.unmapPoint=function(t,e){for(var n=this.chainsByDest[t]||[],i=0;i<n.length;++i){var r=n[i];if(e>=r.destMin&&e<=r.destMax){var o;o="-"==r.srcOri?r.destMax-e:e-r.destMin;for(var a=r.blocks,s=0;s<a.length;++s){var l=a[s],u=l[0],c=l[1],h=l[2];if(o>=c&&c+h>=o){var d,f=o-c,d=f+u+r.srcMin;return d="-"==r.destOri?r.srcMax-u-f:f+u+r.srcMin,{seq:r.srcChr,pos:d,flipped:r.srcOri!=r.destOri}}}}}return null},i.prototype.sourceBlocksForRange=function(t,e,n,i){for(var r=1,o=2,a=this,s=e/this.granularity|0,l=n/this.granularity|0,u=!1,c=!1,h=s;l>=h;++h){var f=t+"_"+h;this.fetchedTiles[f]!=o&&(u=!0,this.fetchedTiles[f]!=r&&(this.fetchedTiles[f]=r,c=!0))}if(u)this.postFetchQueues[t]||this.chainFetcher.fetchChains(t,s*this.granularity,(l+1)*this.granularity-1).then(function(e){a.chainsByDest||(a.chainsByDest[t]=[]);for(var n=0;n<e.length;++n){var i=e[n],r=a.chainsBySrc[i.srcChr];if(r){for(var u=!1,c=0;c<r.length;++c){var h=r[c];if(h.srcMin==i.srcMin&&h.srcMax==i.srcMax){u=!0;break}}u||r.push(i)}else a.chainsBySrc[i.srcChr]=[i];var d=a.chainsByDest[i.destChr];if(d){for(var u=!1,c=0;c<d.length;++c){var h=d[c];if(h.destMin==i.destMin&&h.destMax==i.destMax){u=!0;break}}u||d.push(i)}else a.chainsByDest[i.destChr]=[i]}for(var f=s;l>=f;++f){var p=t+"_"+f;a.fetchedTiles[p]=o}if(a.postFetchQueues[t]){for(var _=a.postFetchQueues[t],g=0;g<_.length;++g)_[g]();a.postFetchQueues[t]=null}})["catch"](function(t){console.log(t)}),p(this.postFetchQueues,t,function(){a.sourceBlocksForRange(t,e,n,i)});else{for(var _=[],g=this.chainsByDest[t]||[],m=0;m<g.length;++m){var v=g[m];if(e<=v.destMax&&n>=v.destMin){var y,b;"-"==v.srcOri?(y=v.destMax-n,b=v.destMax-e):(y=e-v.destMin,b=n-v.destMin);for(var x=v.blocks,w=0;w<x.length;++w){var S=x[w],A=S[0],k=S[1],C=S[2];if(b>=k&&k+C>=y){var T=Math.max(y,k)-k,E=Math.min(b,k+C)-k;"-"==v.destOri?_.push(new d(v.srcChr,v.srcMax-A-E,v.srcMax-A-T)):_.push(new d(v.srcChr,v.srcMin+T+A,v.srcMin+E+A))}}}}i(_)}},r.prototype.fetchChains=function(t,e,n){var i=this;return new x(function(e,n){i.source.alignments(t,{},function(t){for(var n=[],r=0;r<t.length;++r)for(var o=t[r],a=0;a<o.blocks.length;++a){for(var s,l,u=o.blocks[a],c=0;c<u.segments.length;++c){var h=u.segments[c],d=o.objects[h.object];d.dbSource===i.srcTag?s=h:d.dbSource===i.destTag&&(l=h)}if(s&&l){for(var f={srcChr:o.objects[s.object].accession,srcMin:0|s.min,srcMax:0|s.max,srcOri:s.strand,destChr:o.objects[l.object].accession,destMin:0|l.min,destMax:0|l.max,destOri:l.strand,blocks:[]},p=g(s.cigar),_=g(l.cigar),m=0,v=0,y=0,b=0;y<p.length&&b<_.length;)if("M"==p[y].op&&"M"==_[b].op){var x=Math.min(p[y].cnt,_[b].cnt);f.blocks.push([m,v,x]),p[y].cnt==x?++y:p[y].cnt-=x,_[b].cnt==x?++b:_[b]-=x,m+=x,v+=x}else"I"==p[y].op?v+=p[y++].cnt:"I"==_[b].op&&(m+=_[b++].cnt);n.push(f)}}e(n)})})},o.prototype.fetchChains=function(t,e,n){return this.bwg.then(function(i,r){if(!i)throw Error("No BWG");return new x(function(r,o){i.getUnzoomedView().readWigData(t,e,n,function(t){r(t.map(l))})})})},u.prototype.fetchChains=function(t,e,n){for(var i=[],r=this.forwardAliases[t]||[],o=0;o<r.length;++o)i.push({srcChr:r[o],srcMin:1,srcMax:1e9,srcOri:"+",destChr:t,destMin:1,destMax:1e9,destOri:"+",blocks:[[1,1,1e9]]});return x.resolve(i)},t.exports={Chainset:i}},function(t,e,n){"use strict";function i(t){this.blob=t}function r(t,e,n,i){i||("object"==typeof e?(i=e,e=void 0):i={}),this.url=t,this.start=e||0,n&&(this.end=n),this.opts=i}function o(t){if(!t)return null;for(var e=new Uint8Array(t.length),n=0;n<e.length;++n)e[n]=t.charCodeAt(n);return e.buffer}function a(t,e){return t[e+7]<<24|t[e+6]<<16|t[e+5]<<8|t[e+4]}function s(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function l(t,e){return t[e+1]<<8|t[e]}function u(t,e){return t[e]}function c(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}var h=n(248),d=h.shallowCopy,f=n(249),p=f.b64_sha1;i.prototype.slice=function(t,e){var n;return n=this.blob.slice?e?this.blob.slice(t,t+e):this.blob.slice(t):e?this.blob.webkitSlice(t,t+e):this.blob.webkitSlice(t),new i(n)},i.prototype.salted=function(){return this},"undefined"!=typeof FileReader?i.prototype.fetch=function(t){var e=new FileReader;e.onloadend=function(n){t(o(e.result))},e.readAsBinaryString(this.blob)}:i.prototype.fetch=function(t){var e=new FileReaderSync;try{var n=e.readAsArrayBuffer(this.blob);t(n)}catch(i){t(null,i)}},r.prototype.slice=function(t,e){if(0>t)throw"Bad slice "+t;var n=this.start,i=this.end;return n&&t?n+=t:n=t||n,i=e&&n?n+e-1:i||e-1,new r(this.url,n,i,this.opts)};var _=0,g=navigator.userAgent.indexOf("Safari")>=0&&navigator.userAgent.indexOf("Chrome")<0;r.prototype.fetchAsText=function(t){try{var e,n=new XMLHttpRequest,i=this.url;if((g||this.opts.salt)&&i.indexOf("?")<0&&(i=i+"?salt="+p(""+Date.now()+","+ ++_)),n.open("GET",i,!0),this.end){if(this.end-this.start>1e8)throw"Monster fetch!";n.setRequestHeader("Range","bytes="+this.start+"-"+this.end),e=this.end-this.start+1}n.onreadystatechange=function(){return 4==n.readyState?t(200==n.status||206==n.status?n.responseText:null):void 0},this.opts.credentials&&(n.withCredentials=!0),n.send("")}catch(r){return t(null)}},r.prototype.salted=function(){var t=d(this.opts);return t.salt=!0,new r(this.url,this.start,this.end,t)},r.prototype.fetch=function(t,e){var n=this;e=e||{};var i=e.attempt||1,r=e.truncatedLength;if(i>3)return t(null);try{var a;e.timeout&&!this.opts.credentials&&(a=setTimeout(function(){return console.log("timing out "+u),l.abort(),t(null,"Timeout")},e.timeout));var s,l=new XMLHttpRequest,u=this.url;if((g||this.opts.salt)&&u.indexOf("?")<0&&(u=u+"?salt="+p(""+Date.now()+","+ ++_)),l.open("GET",u,!0),l.overrideMimeType("text/plain; charset=x-user-defined"),this.end){if(this.end-this.start>1e8)throw"Monster fetch!";l.setRequestHeader("Range","bytes="+this.start+"-"+this.end),s=this.end-this.start+1}l.responseType="arraybuffer",l.onreadystatechange=function(){if(4==l.readyState){if(a&&clearTimeout(a),200==l.status||206==l.status){if(l.response){var e=l.response.byteLength;return!s||s==e||r&&e==r?t(l.response):n.fetch(t,{attempt:i+1,truncatedLength:e})}if(l.mozResponseArrayBuffer)return t(l.mozResponseArrayBuffer);var u=l.responseText;return!s||s==u.length||r&&u.length==r?t(o(l.responseText)):n.fetch(t,{attempt:i+1,truncatedLength:u.length})}return n.fetch(t,{attempt:i+1})}},this.opts.credentials&&(l.withCredentials=!0),l.send("")}catch(c){return t(null)}},function(t){var e=new ArrayBuffer(8),n=new Uint8Array(e),i=new Float32Array(e);t.readFloat=function(t,e){return n[0]=t[e],n[1]=t[e+1],n[2]=t[e+2],n[3]=t[e+3],i[0]}}(this),t.exports={BlobFetchable:i,URLFetchable:r,readInt:s,readIntBE:c,readInt64:a,readShort:l,readByte:u,readFloat:this.readFloat}},function(t,e,n){"use strict";function i(t,e){var n=t[e]+t[e+1]*M+t[e+2]*L+t[e+3]*R+t[e+4]*O;return n}function r(){}function o(t,e,n,i){this.bwg=t,this.cirTreeOffset=e,this.cirTreeLength=n,this.isSummary=i}function a(t,e,n){var o=new r;o.data=t,o.name=n,o.data.slice(0,512).salted().fetch(function(t){if(!t)return e(null,"Couldn't fetch file");var n=t,r=new Uint8Array(n),a=new Int16Array(n),s=new Int32Array(n),l=r[0]+M*r[1]+L*r[2]+R*r[3];if(l==w)o.type="bigwig";else{if(l!=A)return l==S||l==k?e(null,"Currently don't support big-endian BBI files"):e(null,"Not a supported format, magic=0x"+l.toString(16));o.type="bigbed"}o.version=a[2],o.numZoomLevels=a[3],o.chromTreeOffset=i(r,8),o.unzoomedDataOffset=i(r,16),o.unzoomedIndexOffset=i(r,24),o.fieldCount=a[16],o.definedFieldCount=a[17],o.asOffset=i(r,36),o.totalSummaryOffset=i(r,44),o.uncompressBufSize=s[13],o.extHeaderOffset=i(r,56),o.zoomLevels=[];for(var u=0;u<o.numZoomLevels;++u){var c=s[6*u+16],h=i(r,24*u+72),d=i(r,24*u+80);o.zoomLevels.push({reduction:c,dataOffset:h,indexOffset:d})}o.readChromTree(function(){o.getAutoSQL(function(t){return o.schema=t,e(o)})})},{timeout:5e3})}function s(t,e,n,i,r){this.bbi=t,this.type=e,this.fieldCount=n,this.offset=i,this.field=r}var l=n(269),u=l.Range,c=l.union,h=l.intersection,d=n(251),f=d.DASFeature,p=d.DASGroup,_=n(248),g=_.shallowCopy,m=n(277),v=m.readInt,y=n(279),b=y.inflateBuffer,x=y.arrayCopy,w=2291137574,S=654086024,A=2273964779,k=3958540679,C=1,T=2,E=3,M=256,L=65536,R=16777216,O=4294967296,P=new RegExp("^[0-9]+,[0-9]+,[0-9]+");r.prototype.readChromTree=function(t){var e=this;this.chromsToIDs={},this.idsToChroms={},this.maxID=0;var n=this.unzoomedDataOffset,r=n-this.chromTreeOffset&3;n=n+4-r,this.data.slice(this.chromTreeOffset,n-this.chromTreeOffset).fetch(function(n){var r=new Uint8Array(n),o=new Int16Array(n),a=new Int32Array(n),s=(a[0],a[1],a[2]),l=(a[3],i(r,16),32),u=function(t){var n=r[t],a=o[t/2+1];t+=4;for(var l=0;a>l;++l)if(0==n){t+=s;var c=i(r,t);t+=8,c-=e.chromTreeOffset,u(c)}else{for(var h="",d=0;s>d;++d){var f=r[t++];0!=f&&(h+=String.fromCharCode(f))}var p=r[t+3]<<24|r[t+2]<<16|r[t+1]<<8|r[t+0];r[t+7]<<24|r[t+6]<<16|r[t+5]<<8|r[t+4];t+=8,e.chromsToIDs[h]=p,0==h.indexOf("chr")&&(e.chromsToIDs[h.substr(3)]=p),e.idsToChroms[p]=h,e.maxID=Math.max(e.maxID,p)}};u(l),t(e)})},o.prototype.readWigData=function(t,e,n,i){var r=this.bwg.chromsToIDs[t];return void 0===r?i([]):void this.readWigDataById(r,e,n,i)},o.prototype.readWigDataById=function(t,e,n,r){var o=this;if(!this.cirHeader)return void this.bwg.data.slice(this.cirTreeOffset,48).fetch(function(i){o.cirHeader=i;var a=new Int32Array(o.cirHeader);o.cirBlockSize=a[1],o.readWigDataById(t,e,n,r)});var a=[],s=0,l=(Date.now(),function(i,r,o,a){return(0>t||i==t)&&n>=r&&o>=e}),h=function(t,e){if(o.bwg.instrument&&console.log("level="+e+"; offset="+t+"; time="+(0|Date.now())),s+=t.length,1==t.length&&t[0]-o.cirTreeOffset==48&&o.cachedCirRoot)return f(o.cachedCirRoot,0,e),--s,void(0==s&&o.fetchFeatures(l,a,r));for(var n,i=4+32*o.cirBlockSize,h=0;h<t.length;++h){var p=new u(t[h],t[h]+i);n=n?c(n,p):p}for(var _=n.ranges(),g=0;g<_.length;++g){var m=_[g];d(t,m,e)}},d=function(t,e,n,i){e.max()-e.min();o.bwg.data.slice(e.min(),e.max()-e.min()).fetch(function(i){for(var u=0;u<t.length;++u)e.contains(t[u])&&(f(i,t[u]-e.min(),n),t[u]-o.cirTreeOffset==48&&t[u]-e.min()==0&&(o.cachedCirRoot=i),--s,0==s&&o.fetchFeatures(l,a,r))})},f=function(r,o,s){var l=new Uint8Array(r),u=new Int16Array(r),c=new Int32Array(r),d=l[o],f=u[o/2+1];if(o+=4,0!=d)for(var p=0;f>p;++p){var _=o/4,g=c[_],m=c[_+1],v=c[_+2],y=c[_+3],b=i(l,o+16),x=i(l,o+24);(0>t||t>g||g==t&&n>=m)&&(0>t||v>t||v==t&&y>=e)&&a.push({offset:b,size:x}),o+=32}else{for(var w=[],p=0;f>p;++p){var _=o/4,g=c[_],m=c[_+1],v=c[_+2],y=c[_+3],b=i(l,o+16);(0>t||t>g||g==t&&n>=m)&&(0>t||v>t||v==t&&y>=e)&&w.push(b),o+=24}w.length>0&&h(w,s+1)}};h([o.cirTreeOffset+48],1)},o.prototype.fetchFeatures=function(t,e,n){var i=this;if(e.sort(function(t,e){return(0|t.offset)-(0|e.offset)}),0==e.length)n([]);else{var r=[],o=function(t,e,n,o){o||(o={});var a=new f;a._chromId=t,a.segment=i.bwg.idsToChroms[t],a.min=e,a.max=n,a.type="bigwig";for(var s in o)a[s]=o[s];r.push(a)},a=function(){if(0==e.length){Date.now();return void n(r)}var s=e[0];if(s.data)i.parseFeatures(s.data,o,t),e.splice(0,1),a();else{for(var l=s.offset,u=s.size,c=1;c<e.length&&e[c].offset==l+u;)u+=e[c].size,++c;i.bwg.data.slice(l,u).fetch(function(t){for(var n=0,r=0;u>n;){var o,s=e[r];if(i.bwg.uncompressBufSize>0)o=b(t,n+2,s.size-2);else{var l=new Uint8Array(s.size);x(new Uint8Array(t,n,s.size),0,l,0,s.size),o=l.buffer}s.data=o,n+=s.size,++r}a()})}};a()}},o.prototype.parseFeatures=function(t,e,n){var i=new Uint8Array(t);if(this.isSummary)for(var r=new Int16Array(t),o=new Int32Array(t),a=new Float32Array(t),s=t.byteLength/32,l=0;s>l;++l){var d=o[8*l],f=o[8*l+1],_=o[8*l+2],m=o[8*l+3],v=(a[8*l+4],a[8*l+5]),y=a[8*l+6];a[8*l+7];if(n(d,f+1,_)){var b={type:"bigwig",score:y/m,maxScore:v};"bigbed"==this.bwg.type&&(b.type="density"),e(d,f+1,_,b)}}else if("bigwig"==this.bwg.type){var r=new Int16Array(t),o=new Int32Array(t),a=new Float32Array(t),d=o[0],x=o[1],w=(o[2],o[3]),S=o[4],A=i[20],s=r[11];if(A==E)for(var l=0;s>l;++l){var k=a[l+6],M=x+l*w+1,L=x+l*w+S;n(d,M,L)&&e(d,M,L,{score:k})}else if(A==T)for(var l=0;s>l;++l){var f=o[2*l+6]+1,_=f+S-1,k=a[2*l+7];n(d,f,_)&&e(d,f,_,{score:k})}else if(A==C)for(var l=0;s>l;++l){var f=o[3*l+6]+1,_=o[3*l+7],k=a[3*l+8];f>_&&(f=_),n(d,f,_)&&e(d,f,_,{score:k})}else console.log("Currently not handling bwgType="+A)}else{if("bigbed"!=this.bwg.type)throw Error("Don't know what to do with "+this.bwg.type);for(var R=0,O=this.bwg.definedFieldCount,D=this.bwg.schema;R<i.length;){var d=i[R+3]<<24|i[R+2]<<16|i[R+1]<<8|i[R+0],f=i[R+7]<<24|i[R+6]<<16|i[R+5]<<8|i[R+4],_=i[R+11]<<24|i[R+10]<<16|i[R+9]<<8|i[R+8];R+=12;for(var I="";;){var N=i[R++];if(0==N)break;I+=String.fromCharCode(N)}var F,B={};if(F=I.length>0?I.split("	"):[],F.length>0&&O>3&&(B.label=F[0]),F.length>1&&O>4){var k=parseInt(F[1]);isNaN(k)||(B.score=k)}if(F.length>2&&O>5&&(B.orientation=F[2]),F.length>5&&O>8){var z=F[5];P.test(z)&&(B.itemRgb="rgb("+z+")")}if(F.length>O-3&&D)for(var H=O-3;H<F.length;++H)B[D.fields[H+3].name]=F[H];if(n(d,f+1,_,F))if(12>O)e(d,f+1,_,B);else{var q=0|F[3],G=0|F[4],j=0|F[6],U=F[7].split(","),V=F[8].split(",");if(B.exonFrames){var W=B.exonFrames.split(",");B.exonFrames=void 0}B.type="transcript";var X=new p;for(var K in B)X[K]=B[K];if(X.id=F[0],X.segment=this.bwg.idsToChroms[d],X.min=f+1,X.max=_,X.notes=[],B.groups=[X],F.length>9){var Y=B.geneName||F[9],Z=Y;F.length>10&&(Z=F[10]),B.geneName2&&(Z=B.geneName2);var $=g(X);$.id=Y,$.label=Z,$.type="gene",B.groups.push($)}for(var J=[],Q=0;j>Q;++Q){var tt=(0|V[Q])+f,et=tt+(0|U[Q]),nt=new u(tt,et);J.push(nt)}for(var it=c(J),rt=it.ranges(),ot=0;ot<rt.length;++ot){var at=rt[ot];e(d,at.min()+1,at.max(),B)}if(G>q){var st="+"==B.orientation?new u(q,G+3):new u(q-3,G),lt=h(it,st);if(lt){B.type="translation";for(var ut=lt.ranges(),ct=0,ht=0;ut[0].min()>rt[ht].max();)ht++;for(var ot=0;ot<ut.length;++ot){var dt=ot;"-"==B.orientation&&(dt=ut.length-ot-1);var at=ut[dt];if(B.readframe=ct,W){var ft=parseInt(W[dt+ht]);"number"==typeof ft&&ft>=0&&2>=ft&&(B.readframe=ft,B.readframeExplicit=!0)}var pt=at.max()-at.min();ct=(ct+pt)%3,e(d,at.min()+1,at.max(),B)}}}}}}},o.prototype.getFirstAdjacent=function(t,e,n,i){var r=this.bwg.chromsToIDs[t];return void 0===r?i([]):void this.getFirstAdjacentById(r,e,n,i)},o.prototype.getFirstAdjacentById=function(t,e,n,r){var o=this;if(!this.cirHeader)return void this.bwg.data.slice(this.cirTreeOffset,48).fetch(function(i){o.cirHeader=i;var a=new Int32Array(o.cirHeader);o.cirBlockSize=a[1],o.getFirstAdjacentById(t,e,n,r)});var a=null,s=-1,l=-1,h=0,d=(Date.now(),function(t,e){h+=t.length;for(var n,i=4+32*o.cirBlockSize,r=0;r<t.length;++r){var a=new u(t[r],t[r]+i);n=n?c(n,a):a}for(var s=n.ranges(),l=0;l<s.length;++l){var d=s[l];f(t,d,e)}}),f=function(i,s,l,u){s.max()-s.min();o.bwg.data.slice(s.min(),s.max()-s.min()).fetch(function(u){for(var c=0;c<i.length;++c)if(s.contains(i[c])&&(p(u,i[c]-s.min(),l),--h,0==h)){if(!a)return n>0&&(0!=t||e>0)?o.getFirstAdjacentById(0,0,n,r):0>n&&(t!=o.bwg.maxID||1e9>e)?o.getFirstAdjacentById(o.bwg.maxID,1e9,n,r):r([]);o.fetchFeatures(function(i,r,o,a){return 0>n&&(t>i||e>o)||n>0&&(i>t||r>e)},[a],function(t){for(var e=null,i=-1,o=-1,a=0;a<t.length;++a){var s=t[a],l=s._chromId,u=s.min,c=s.max;(null==e||0>n&&(l>i||c>o)||n>0&&(i>l||o>u))&&(e=s,o=0>n?c:u,i=l)}return r(null!=e?[e]:[])})}})},p=function(r,u,c){var h=new Uint8Array(r),f=new Int16Array(r),p=new Int32Array(r),_=h[u],g=f[u/2+1];if(u+=4,0!=_)for(var m=0;g>m;++m){var v=u/4,y=p[v],b=p[v+1],x=p[v+2],w=p[v+3],S=i(h,u+16),A=i(h,u+24);(0>n&&(t>y||y==t&&e>=b)||n>0&&(x>t||x==t&&w>=e))&&(/_random/.exec(o.bwg.idsToChroms[y])||(null==a||0>n&&(x>s||x==s&&w>l)||n>0&&(s>y||y==s&&l>b))&&(a={offset:S,size:A},l=0>n?w:b,s=0>n?x:y)),u+=32}else{for(var k=-1,C=-1,T=-1,m=0;g>m;++m){var v=u/4,y=p[v],b=p[v+1],x=p[v+2],w=p[v+3],S=p[v+4]<<32|p[v+5];(0>n&&(t>y||y==t&&e>=b)&&x>=t||n>0&&(x>t||x==t&&w>=e)&&t>=y)&&(0>k||w>C)&&(k=S,C=0>n?w:b,T=0>n?x:y),u+=24}k>=0&&d([k],c+1)}};d([o.cirTreeOffset+48],1)},r.prototype.readWigData=function(t,e,n,i){this.getUnzoomedView().readWigData(t,e,n,i)},r.prototype.getUnzoomedView=function(){if(!this.unzoomedView){var t=4e3,e=this.zoomLevels[0];e&&(t=this.zoomLevels[0].dataOffset-this.unzoomedIndexOffset),this.unzoomedView=new o(this,this.unzoomedIndexOffset,t,!1)}return this.unzoomedView},r.prototype.getZoomedView=function(t){var e=this.zoomLevels[t];return e.view||(e.view=new o(this,e.indexOffset,4e3,!0)),e.view},r.prototype._tsFetch=function(t,e,n,i,r){var o=this;if(!(t>=this.zoomLevels.length-1)){var a;return a=0>t?this.getUnzoomedView():this.getZoomedView(t),a.readWigDataById(e,n,i,r)}if(this.topLevelReductionCache){for(var s=[],l=this.topLevelReductionCache,u=0;u<l.length;++u)l[u]._chromId==e&&s.push(l[u]);return r(s)}this.getZoomedView(this.zoomLevels.length-1).readWigDataById(-1,0,3e8,function(a){return o.topLevelReductionCache=a,o._tsFetch(t,e,n,i,r)})},r.prototype.thresholdSearch=function(t,e,n,i,r){function o(){if(0==l.length)return r(null);l.sort(function(t,e){var i=t.zoom-e.zoom;return 0!=i?i:(i=t.chrOrd-e.chrOrd,0!=i?i:t.min-e.min*n)});var t=l.splice(0,1)[0];a._tsFetch(t.zoom,t.chr,t.min,t.max,function(a){var s=n>0?0:3e8;t.fromRef&&(s=e);for(var u=0;u<a.length;++u){var c,h=a[u];if(c=void 0!=h.maxScore?h.maxScore:h.score,n>0){if(c>i)if(t.zoom<0){if(h.min>s)return r(h)}else h.max>s&&l.push({chr:t.chr,chrOrd:t.chrOrd,zoom:t.zoom-2,min:h.min,max:h.max,fromRef:t.fromRef})}else if(c>i)if(t.zoom<0){if(h.max<s)return r(h)}else h.min<s&&l.push({chr:t.chr,chrOrd:t.chrOrd,zoom:t.zoom-2,min:h.min,max:h.max,fromRef:t.fromRef})}o()})}n=0>n?-1:1;for(var a=this,s=this.chromsToIDs[t],l=[{chrOrd:0,chr:s,zoom:a.zoomLevels.length-4,min:0,max:3e8,fromRef:!0}],u=1;u<=this.maxID+1;++u){var c=(s+n*u)%(this.maxID+1);0>c&&(c+=this.maxID+1),l.push({chrOrd:u,chr:c,zoom:a.zoomLevels.length-1,min:0,max:3e8})}o()},r.prototype.getAutoSQL=function(t){return this.asOffset?void this.data.slice(this.asOffset,2048).fetch(function(e){for(var n=new Uint8Array(e),i="",r=0;r<n.length&&0!=n[r];++r)i+=String.fromCharCode(n[r]);var o=/(\w+)\s+(\w+)\s+("([^"]+)")?\s+\(\s*/,a=/([\w\[\]]+)\s+(\w+)\s*;\s*("([^"]+)")?\s*/g,s=o.exec(i);if(s){var l={declType:s[1],name:s[2],comment:s[4],fields:[]};i=i.substring(s[0]);for(var u=a.exec(i);null!=u;u=a.exec(i))l.fields.push({type:u[1],name:u[2],comment:u[4]});return t(l)}}):t(null)},r.prototype.getExtraIndices=function(t){var e=this;return this.version<4||0==this.extHeaderOffset||"bigbed"!=this.type?t(null):void this.data.slice(this.extHeaderOffset,64).fetch(function(n){if(!n)return t(null,"Couldn't fetch extension header");var r=new Uint8Array(n),o=new Int16Array(n),a=(new Int32Array(n),o[0],o[1]),l=i(r,4);return 0==a?t(null):void e.data.slice(l,20*a).fetch(function(n){if(!n)return t(null,"Couldn't fetch index info");for(var r=new Uint8Array(n),o=new Int16Array(n),l=(new Int32Array(n),[]),u=0;a>u;++u){var c=o[10*u],h=o[10*u+1],d=i(r,20*u+4),f=o[10*u+8],p=new s(e,c,h,d,f);l.push(p)}t(l)})})},s.prototype.lookup=function(t,e){var n=this;this.bbi.data.slice(this.offset,32).fetch(function(r){function o(r){n.bbi.data.slice(r,4+l*(u+c)).fetch(function(r){var a=new Uint8Array(r),s=new Uint16Array(r),l=(new Uint32Array(r),a[0]),h=s[1],d=4;if(0!=l){for(var f=0;h>f;++f){for(var p="",_=0;u>_;++_){var g=a[d++];0!=g&&(p+=String.fromCharCode(g))}if(p==t){var m=i(a,d),y=v(a,d+8);return n.bbi.getUnzoomedView().fetchFeatures(function(e,i,r,o){return o&&o.length>n.field-3?o[n.field-3]==t:void 0},[{offset:m,size:y}],e)}d+=c}return e([])}for(var b=null,f=0;h>f;++f){for(var p="",_=0;u>_;++_){var g=a[d++];0!=g&&(p+=String.fromCharCode(g))}var x=i(a,d);if(d+=8,t.localeCompare(p)<0&&b)return void o(b);b=x}o(b)})}var a=new Uint8Array(r),s=(new Int16Array(r),new Int32Array(r)),l=(s[0],s[1]),u=s[2],c=s[3],h=(i(a,16),32);o(n.offset+h)})},t.exports={makeBwg:a,BIG_BED_MAGIC:A,BIG_WIG_MAGIC:w}},function(t,e,n){function i(){}function r(){this.was=[0]}function o(t,e,n){this.hufts=new Int32Array(3*_),this.window=new Uint8Array(n),this.end=n,this.checkfn=e,this.mode=j,this.reset(t,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new a,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new s}function a(){}function s(){}function l(t,e,n,i,r){return t[0]=Q,e[0]=tt,n[0]=et,i[0]=nt,x}function u(t,e,n,i,r){if(0!=r){if(!t)throw"Undef src";if(!n)throw"Undef dest";0==e&&r==t.length?h(t,n,i):bt?h(t.subarray(e,e+r),n,i):1==t.BYTES_PER_ELEMENT&&r>100?h(new Uint8Array(t.buffer,t.byteOffset+e,r),n,i):c(t,e,n,i,r)}}function c(t,e,n,i,r){for(var o=0;r>o;++o)n[i+o]=t[e+o]}function h(t,e,n){e.set(t,n)}function d(t,e,n,r){t=e?n?new Uint8Array(t,e,n):new Uint8Array(t,e,t.byteLength-e):new Uint8Array(t);var o=new i;o.inflateInit(p,!0),o.next_in=t,o.next_in_index=0,o.avail_in=t.length;for(var a=[],s=0;;){var l=new Uint8Array(32e3);o.next_out=l,o.next_out_index=0,o.avail_out=l.length;var c=o.inflate(v);if(c!=x&&c!=w&&c!=T)throw o.msg;if(0!=o.avail_out){var h=new Uint8Array(l.length-o.avail_out);u(l,0,h,0,l.length-o.avail_out),l=h}if(a.push(l),s+=l.length,c==w||c==T)break}if(r&&(r[0]=(e||0)+o.next_in_index),1==a.length)return a[0].buffer;for(var d=new Uint8Array(s),f=0,_=0;_<a.length;++_){var g=a[_];u(g,0,d,f,g.length),f+=g.length}return d.buffer}var f=15,p=f,_=1440,g=15,m=32,v=0,y=4,b=8,x=0,w=1,S=2,A=-2,k=-3,C=-4,T=-5,E=0,M=1,L=2,R=3,O=4,P=5,D=6,I=7,N=8,F=9,B=10,z=11,H=12,q=13,G=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],j=0,U=1,V=2,W=3,X=4,K=5,Y=6,Z=7,$=8,J=9,Q=9,tt=5,et=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],nt=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],it=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],rt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],ot=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],at=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];
i.prototype.inflateInit=function(t,e){return t||(t=p),e&&(e=!1),this.istate=new r,this.istate.inflateInit(this,e?-t:t)},i.prototype.inflate=function(t){return null==this.istate?A:this.istate.inflate(this,t)},i.prototype.inflateEnd=function(){if(null==this.istate)return A;var t=istate.inflateEnd(this);return this.istate=null,t},i.prototype.inflateSync=function(){return istate.inflateSync(this)},i.prototype.inflateSetDictionary=function(t,e){return istate.inflateSetDictionary(this,t,e)},r.prototype.inflateReset=function(t){return null==t||null==t.istate?A:(t.total_in=t.total_out=0,t.msg=null,t.istate.mode=0!=t.istate.nowrap?I:E,t.istate.blocks.reset(t,null),x)},r.prototype.inflateEnd=function(t){return null!=this.blocks&&this.blocks.free(t),this.blocks=null,x},r.prototype.inflateInit=function(t,e){return t.msg=null,this.blocks=null,nowrap=0,0>e&&(e=-e,nowrap=1),8>e||e>15?(this.inflateEnd(t),A):(this.wbits=e,t.istate.blocks=new o(t,0!=t.istate.nowrap?null:this,1<<e),this.inflateReset(t),x)},r.prototype.inflate=function(t,e){var n,i;if(null==t||null==t.istate||null==t.next_in)return A;for(e=e==y?T:x,n=T;;)switch(t.istate.mode){case E:if(0==t.avail_in)return n;if(n=e,t.avail_in--,t.total_in++,(15&(t.istate.method=t.next_in[t.next_in_index++]))!=b){t.istate.mode=q,t.msg="unknown compression method",t.istate.marker=5;break}if((t.istate.method>>4)+8>t.istate.wbits){t.istate.mode=q,t.msg="invalid window size",t.istate.marker=5;break}t.istate.mode=M;case M:if(0==t.avail_in)return n;if(n=e,t.avail_in--,t.total_in++,i=255&t.next_in[t.next_in_index++],((t.istate.method<<8)+i)%31!=0){t.istate.mode=q,t.msg="incorrect header check",t.istate.marker=5;break}if(0==(i&m)){t.istate.mode=I;break}t.istate.mode=L;case L:if(0==t.avail_in)return n;n=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=R;case R:if(0==t.avail_in)return n;n=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=O;case O:if(0==t.avail_in)return n;n=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=P;case P:return 0==t.avail_in?n:(n=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.adler=t.istate.need,t.istate.mode=D,S);case D:return t.istate.mode=q,t.msg="need dictionary",t.istate.marker=0,A;case I:if(n=t.istate.blocks.proc(t,n),n==k){t.istate.mode=q,t.istate.marker=0;break}if(n==x&&(n=e),n!=w)return n;if(n=e,t.istate.blocks.reset(t,t.istate.was),0!=t.istate.nowrap){t.istate.mode=H;break}t.istate.mode=N;case N:if(0==t.avail_in)return n;n=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=F;case F:if(0==t.avail_in)return n;n=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=B;case B:if(0==t.avail_in)return n;n=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=z;case z:if(0==t.avail_in)return n;if(n=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.istate.was[0]!=t.istate.need){t.istate.mode=q,t.msg="incorrect data check",t.istate.marker=5;break}t.istate.mode=H;case H:return w;case q:return k;default:return A}},r.prototype.inflateSetDictionary=function(t,e,n){var i=0,r=n;return null==t||null==t.istate||t.istate.mode!=D?A:t._adler.adler32(1,e,0,n)!=t.adler?k:(t.adler=t._adler.adler32(0,null,0,0),r>=1<<t.istate.wbits&&(r=(1<<t.istate.wbits)-1,i=n-r),t.istate.blocks.set_dictionary(e,i,r),t.istate.mode=I,x)};var st=[0,0,255,255];r.prototype.inflateSync=function(t){var e,n,i,r,o;if(null==t||null==t.istate)return A;if(t.istate.mode!=q&&(t.istate.mode=q,t.istate.marker=0),0==(e=t.avail_in))return T;for(n=t.next_in_index,i=t.istate.marker;0!=e&&4>i;)t.next_in[n]==st[i]?i++:i=0!=t.next_in[n]?0:4-i,n++,e--;return t.total_in+=n-t.next_in_index,t.next_in_index=n,t.avail_in=e,t.istate.marker=i,4!=i?k:(r=t.total_in,o=t.total_out,this.inflateReset(t),t.total_in=r,t.total_out=o,t.istate.mode=I,x)},r.prototype.inflateSyncPoint=function(t){return null==t||null==t.istate||null==t.istate.blocks?A:t.istate.blocks.sync_point()};var lt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];o.prototype.reset=function(t,e){e&&(e[0]=this.check),this.mode==Y&&this.codes.free(t),this.mode=j,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(t.adler=this.check=t._adler.adler32(0,null,0,0))},o.prototype.proc=function(t,e){var n,i,r,o,a,s,c;for(o=t.next_in_index,a=t.avail_in,i=this.bitb,r=this.bitk,s=this.write,c=s<this.read?this.read-s-1:this.end-s;;)switch(this.mode){case j:for(;3>r;){if(0==a)return this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);e=x,a--,i|=(255&t.next_in[o++])<<r,r+=8}switch(n=7&i,this.last=1&n,n>>>1){case 0:i>>>=3,r-=3,n=7&r,i>>>=n,r-=n,this.mode=U;break;case 1:var h=new Int32Array(1),d=new Int32Array(1),f=[],p=[];l(h,d,f,p,t),this.codes.init(h[0],d[0],f[0],0,p[0],0,t),i>>>=3,r-=3,this.mode=Y;break;case 2:i>>>=3,r-=3,this.mode=W;break;case 3:return i>>>=3,r-=3,this.mode=q,t.msg="invalid block type",e=k,this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e)}break;case U:for(;32>r;){if(0==a)return this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);e=x,a--,i|=(255&t.next_in[o++])<<r,r+=8}if((~i>>>16&65535)!=(65535&i))return this.mode=q,t.msg="invalid stored block lengths",e=k,this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);this.left=65535&i,i=r=0,this.mode=0!=this.left?V:0!=this.last?Z:j;break;case V:if(0==a)return this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,write=s,this.inflate_flush(t,e);if(0==c&&(s==end&&0!=read&&(s=0,c=s<this.read?this.read-s-1:this.end-s),0==c&&(this.write=s,e=this.inflate_flush(t,e),s=this.write,c=s<this.read?this.read-s-1:this.end-s,s==this.end&&0!=this.read&&(s=0,c=s<this.read?this.read-s-1:this.end-s),0==c)))return this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);if(e=x,n=this.left,n>a&&(n=a),n>c&&(n=c),u(t.next_in,o,this.window,s,n),o+=n,a-=n,s+=n,c-=n,0!=(this.left-=n))break;this.mode=0!=this.last?Z:j;break;case W:for(;14>r;){if(0==a)return this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);e=x,a--,i|=(255&t.next_in[o++])<<r,r+=8}if(this.table=n=16383&i,(31&n)>29||(n>>5&31)>29)return this.mode=J,t.msg="too many length or distance symbols",e=k,this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);if(n=258+(31&n)+(n>>5&31),null==this.blens||this.blens.length<n)this.blens=new Int32Array(n);else for(var _=0;n>_;_++)this.blens[_]=0;i>>>=14,r-=14,this.index=0,mode=X;case X:for(;this.index<4+(this.table>>>10);){for(;3>r;){if(0==a)return this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);e=x,a--,i|=(255&t.next_in[o++])<<r,r+=8}this.blens[lt[this.index++]]=7&i,i>>>=3,r-=3}for(;this.index<19;)this.blens[lt[this.index++]]=0;if(this.bb[0]=7,n=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,t),n!=x)return e=n,e==k&&(this.blens=null,this.mode=J),this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,write=s,this.inflate_flush(t,e);this.index=0,this.mode=K;case K:for(;;){if(n=this.table,!(this.index<258+(31&n)+(n>>5&31)))break;var _,g,m;for(n=this.bb[0];n>r;){if(0==a)return this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);e=x,a--,i|=(255&t.next_in[o++])<<r,r+=8}if(n=this.hufts[3*(this.tb[0]+(i&G[n]))+1],m=this.hufts[3*(this.tb[0]+(i&G[n]))+2],16>m)i>>>=n,r-=n,this.blens[this.index++]=m;else{for(_=18==m?7:m-14,g=18==m?11:3;n+_>r;){if(0==a)return this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);e=x,a--,i|=(255&t.next_in[o++])<<r,r+=8}if(i>>>=n,r-=n,g+=i&G[_],i>>>=_,r-=_,_=this.index,n=this.table,_+g>258+(31&n)+(n>>5&31)||16==m&&1>_)return this.blens=null,this.mode=J,t.msg="invalid bit length repeat",e=k,this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);m=16==m?this.blens[_-1]:0;do this.blens[_++]=m;while(0!=--g);this.index=_}}this.tb[0]=-1;var h=new Int32Array(1),d=new Int32Array(1),f=new Int32Array(1),p=new Int32Array(1);if(h[0]=9,d[0]=6,n=this.table,n=this.inftree.inflate_trees_dynamic(257+(31&n),1+(n>>5&31),this.blens,h,d,f,p,this.hufts,t),n!=x)return n==k&&(this.blens=null,this.mode=q),e=n,this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);this.codes.init(h[0],d[0],this.hufts,f[0],this.hufts,p[0],t),this.mode=Y;case Y:if(this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,(e=this.codes.proc(this,t,e))!=w)return this.inflate_flush(t,e);if(e=x,this.codes.free(t),o=t.next_in_index,a=t.avail_in,i=this.bitb,r=this.bitk,s=this.write,c=s<this.read?this.read-s-1:this.end-s,0==this.last){this.mode=j;break}this.mode=Z;case Z:if(this.write=s,e=this.inflate_flush(t,e),s=this.write,c=s<this.read?this.read-s-1:this.end-s,this.read!=this.write)return this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);mode=H;case $:return e=w,this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);case J:return e=k,this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e);default:return e=A,this.bitb=i,this.bitk=r,t.avail_in=a,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=s,this.inflate_flush(t,e)}},o.prototype.free=function(t){this.reset(t,null),this.window=null,this.hufts=null},o.prototype.set_dictionary=function(t,e,n){u(t,e,window,0,n),this.read=this.write=n},o.prototype.sync_point=function(){return this.mode==U},o.prototype.inflate_flush=function(t,e){var n,i,r;return i=t.next_out_index,r=this.read,n=(r<=this.write?this.write:this.end)-r,n>t.avail_out&&(n=t.avail_out),0!=n&&e==T&&(e=x),t.avail_out-=n,t.total_out+=n,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,r,n)),u(this.window,r,t.next_out,i,n),i+=n,r+=n,r==this.end&&(r=0,this.write==this.end&&(this.write=0),n=this.write-r,n>t.avail_out&&(n=t.avail_out),0!=n&&e==T&&(e=x),t.avail_out-=n,t.total_out+=n,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,r,n)),u(this.window,r,t.next_out,i,n),i+=n,r+=n),t.next_out_index=i,this.read=r,e};var ut=0,ct=1,ht=2,dt=3,ft=4,pt=5,_t=6,gt=7,mt=8,vt=9;a.prototype.init=function(t,e,n,i,r,o,a){this.mode=ut,this.lbits=t,this.dbits=e,this.ltree=n,this.ltree_index=i,this.dtree=r,this.dtree_index=o,this.tree=null},a.prototype.proc=function(t,e,n){var i,r,o,a,s,l,u,c=0,h=0,d=0;for(d=e.next_in_index,a=e.avail_in,c=t.bitb,h=t.bitk,s=t.write,l=s<t.read?t.read-s-1:t.end-s;;)switch(this.mode){case ut:if(l>=258&&a>=10&&(t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,n=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,t,e),d=e.next_in_index,a=e.avail_in,c=t.bitb,h=t.bitk,s=t.write,l=s<t.read?t.read-s-1:t.end-s,n!=x)){this.mode=n==w?gt:vt;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=ct;case ct:for(i=this.need;i>h;){if(0==a)return t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);n=x,a--,c|=(255&e.next_in[d++])<<h,h+=8}if(r=3*(this.tree_index+(c&G[i])),c>>>=this.tree[r+1],h-=this.tree[r+1],o=this.tree[r],0==o){this.lit=this.tree[r+2],this.mode=_t;break}if(0!=(16&o)){this.get=15&o,this.len=this.tree[r+2],this.mode=ht;break}if(0==(64&o)){this.need=o,this.tree_index=r/3+this.tree[r+2];break}if(0!=(32&o)){this.mode=gt;break}return this.mode=vt,e.msg="invalid literal/length code",n=k,t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);case ht:for(i=this.get;i>h;){if(0==a)return t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);n=x,a--,c|=(255&e.next_in[d++])<<h,h+=8}this.len+=c&G[i],c>>=i,h-=i,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=dt;case dt:for(i=this.need;i>h;){if(0==a)return t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);n=x,a--,c|=(255&e.next_in[d++])<<h,h+=8}if(r=3*(this.tree_index+(c&G[i])),c>>=this.tree[r+1],h-=this.tree[r+1],o=this.tree[r],0!=(16&o)){this.get=15&o,this.dist=this.tree[r+2],this.mode=ft;break}if(0==(64&o)){this.need=o,this.tree_index=r/3+this.tree[r+2];break}return this.mode=vt,e.msg="invalid distance code",n=k,t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);case ft:for(i=this.get;i>h;){if(0==a)return t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);n=x,a--,c|=(255&e.next_in[d++])<<h,h+=8}this.dist+=c&G[i],c>>=i,h-=i,this.mode=pt;case pt:for(u=s-this.dist;0>u;)u+=t.end;for(;0!=this.len;){if(0==l&&(s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l&&(t.write=s,n=t.inflate_flush(e,n),s=t.write,l=s<t.read?t.read-s-1:t.end-s,s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l)))return t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);t.window[s++]=t.window[u++],l--,u==t.end&&(u=0),this.len--}this.mode=ut;break;case _t:if(0==l&&(s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l&&(t.write=s,n=t.inflate_flush(e,n),s=t.write,l=s<t.read?t.read-s-1:t.end-s,s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l)))return t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);n=x,t.window[s++]=this.lit,l--,this.mode=ut;break;case gt:if(h>7&&(h-=8,a++,d--),t.write=s,n=t.inflate_flush(e,n),s=t.write,l=s<t.read?t.read-s-1:t.end-s,t.read!=t.write)return t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);this.mode=mt;case mt:return n=w,t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);case vt:return n=k,t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n);default:return n=A,t.bitb=c,t.bitk=h,e.avail_in=a,e.total_in+=d-e.next_in_index,e.next_in_index=d,t.write=s,t.inflate_flush(e,n)}},a.prototype.free=function(t){},a.prototype.inflate_fast=function(t,e,n,i,r,o,a,s){var l,c,h,d,f,p,_,g,m,v,y,b,S,A,C,T;_=s.next_in_index,g=s.avail_in,f=a.bitb,p=a.bitk,m=a.write,v=m<a.read?a.read-m-1:a.end-m,y=G[t],b=G[e];do{for(;20>p;)g--,f|=(255&s.next_in[_++])<<p,p+=8;if(l=f&y,c=n,h=i,T=3*(h+l),0!=(d=c[T]))for(;;){if(f>>=c[T+1],p-=c[T+1],0!=(16&d)){for(d&=15,S=c[T+2]+(f&G[d]),f>>=d,p-=d;15>p;)g--,f|=(255&s.next_in[_++])<<p,p+=8;for(l=f&b,c=r,h=o,T=3*(h+l),d=c[T];;){if(f>>=c[T+1],p-=c[T+1],0!=(16&d)){for(d&=15;d>p;)g--,f|=(255&s.next_in[_++])<<p,p+=8;if(A=c[T+2]+(f&G[d]),f>>=d,p-=d,v-=S,m>=A)C=m-A,m-C>0&&2>m-C?(a.window[m++]=a.window[C++],a.window[m++]=a.window[C++],S-=2):(a.window[m++]=a.window[C++],a.window[m++]=a.window[C++],S-=2);else{C=m-A;do C+=a.end;while(0>C);if(d=a.end-C,S>d){if(S-=d,m-C>0&&d>m-C){do a.window[m++]=a.window[C++];while(0!=--d)}else u(a.window,C,a.window,m,d),m+=d,C+=d,d=0;C=0}}do a.window[m++]=a.window[C++];while(0!=--S);break}if(0!=(64&d))return s.msg="invalid distance code",S=s.avail_in-g,S=S>p>>3?p>>3:S,g+=S,_-=S,p-=S<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=_-s.next_in_index,s.next_in_index=_,a.write=m,k;l+=c[T+2],l+=f&G[d],T=3*(h+l),d=c[T]}break}if(0!=(64&d))return 0!=(32&d)?(S=s.avail_in-g,S=S>p>>3?p>>3:S,g+=S,_-=S,p-=S<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=_-s.next_in_index,s.next_in_index=_,a.write=m,w):(s.msg="invalid literal/length code",S=s.avail_in-g,S=S>p>>3?p>>3:S,g+=S,_-=S,p-=S<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=_-s.next_in_index,s.next_in_index=_,a.write=m,k);if(l+=c[T+2],l+=f&G[d],T=3*(h+l),0==(d=c[T])){f>>=c[T+1],p-=c[T+1],a.window[m++]=c[T+2],v--;break}}else f>>=c[T+1],p-=c[T+1],a.window[m++]=c[T+2],v--}while(v>=258&&g>=10);return S=s.avail_in-g,S=S>p>>3?p>>3:S,g+=S,_-=S,p-=S<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=_-s.next_in_index,s.next_in_index=_,a.write=m,x},s.prototype.huft_build=function(t,e,n,i,r,o,a,s,l,c,h){var d,f,p,m,v,y,b,w,S,A,C,E,M,L,R;A=0,v=n;do this.c[t[e+A]]++,A++,v--;while(0!=v);if(this.c[0]==n)return a[0]=-1,s[0]=0,x;for(w=s[0],y=1;g>=y&&0==this.c[y];y++);for(b=y,y>w&&(w=y),v=g;0!=v&&0==this.c[v];v--);for(p=v,w>v&&(w=v),s[0]=w,L=1<<y;v>y;y++,L<<=1)if((L-=this.c[y])<0)return k;if((L-=this.c[v])<0)return k;for(this.c[v]+=L,this.x[1]=y=0,A=1,M=2;0!=--v;)this.x[M]=y+=this.c[A],M++,A++;v=0,A=0;do 0!=(y=t[e+A])&&(this.v[this.x[y]++]=v),A++;while(++v<n);for(n=this.x[p],this.x[0]=v=0,A=0,m=-1,E=-w,this.u[0]=0,C=0,R=0;p>=b;b++)for(d=this.c[b];0!=d--;){for(;b>E+w;){if(m++,E+=w,R=p-E,R=R>w?w:R,(f=1<<(y=b-E))>d+1&&(f-=d+1,M=b,R>y))for(;++y<R&&!((f<<=1)<=this.c[++M]);)f-=this.c[M];if(R=1<<y,this.hn[0]+R>_)return k;this.u[m]=C=this.hn[0],this.hn[0]+=R,0!=m?(this.x[m]=v,this.r[0]=y,this.r[1]=w,y=v>>>E-w,this.r[2]=C-this.u[m-1]-y,u(this.r,0,l,3*(this.u[m-1]+y),3)):a[0]=C}for(this.r[1]=b-E,A>=n?this.r[0]=192:h[A]<i?(this.r[0]=this.v[A]<256?0:96,this.r[2]=this.v[A++]):(this.r[0]=o[this.v[A]-i]+16+64,this.r[2]=r[this.v[A++]-i]),f=1<<b-E,y=v>>>E;R>y;y+=f)u(this.r,0,l,3*(C+y),3);for(y=1<<b-1;0!=(v&y);y>>>=1)v^=y;for(v^=y,S=(1<<E)-1;(v&S)!=this.x[m];)m--,E-=w,S=(1<<E)-1}return 0!=L&&1!=p?T:x},s.prototype.inflate_trees_bits=function(t,e,n,i,r){var o;return this.initWorkArea(19),this.hn[0]=0,o=this.huft_build(t,0,19,19,null,null,n,e,i,this.hn,this.v),o==k?r.msg="oversubscribed dynamic bit lengths tree":(o==T||0==e[0])&&(r.msg="incomplete dynamic bit lengths tree",o=k),o},s.prototype.inflate_trees_dynamic=function(t,e,n,i,r,o,a,s,l){var u;return this.initWorkArea(288),this.hn[0]=0,u=this.huft_build(n,0,t,257,it,rt,o,i,s,this.hn,this.v),u!=x||0==i[0]?(u==k?l.msg="oversubscribed literal/length tree":u!=C&&(l.msg="incomplete literal/length tree",u=k),u):(this.initWorkArea(288),u=this.huft_build(n,t,e,0,ot,at,a,r,s,this.hn,this.v),u!=x||0==r[0]&&t>257?(u==k?l.msg="oversubscribed distance tree":u==T?(l.msg="incomplete distance tree",u=k):u!=C&&(l.msg="empty distance tree with lengths",u=k),u):x)},s.prototype.initWorkArea=function(t){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(t),this.c=new Int32Array(g+1),this.r=new Int32Array(3),this.u=new Int32Array(g),this.x=new Int32Array(g+1)),this.v.length<t&&(this.v=new Int32Array(t));for(var e=0;t>e;e++)this.v[e]=0;for(var e=0;g+1>e;e++)this.c[e]=0;for(var e=0;3>e;e++)this.r[e]=0;u(this.c,0,this.u,0,g),u(this.c,0,this.x,0,g+1)};var yt=new Uint8Array(1),bt="function"==typeof yt.subarray;t.exports={inflateBuffer:d,arrayCopy:u}},function(t,e,n){"use strict";function i(t){var e="bp";return t>1e9?(t/=1e9,e="Gb"):t>1e6?(t/=1e6,e="Mb"):t>1e3&&(t/=1e3,e="kb"),""+Math.round(t)+e}var r=n(247),o=r.Browser,a=n(248),s=a.makeElement,l=(a.removeChildren,n(272)),u=l.formatLongInt,c=n(281);n(282),n(283),n(284),n(285),n(286),n(287),o.prototype.initUI=function(t,e){this.noSourceCSS||["bootstrap-scoped.css","dalliance-scoped.css","font-awesome.min.css"].forEach(function(t){document.head.appendChild(s("link","",{rel:"stylesheet",href:this.resolveURL("$$css/"+t)}))}.bind(this));var n=this;n.disableDefaultFeaturePopup||this.addFeatureListener(function(t,e,i,r){n.featurePopup(t,e,i,r)}),t.classList.add("dalliance");var r=n.toolbar=s("div",null,{className:"btn-toolbar toolbar"}),o=n.coordSystem.speciesName+" "+n.nameForCoordSystem(n.coordSystem);this.setDocumentTitle&&(document.title=o+" :: dalliance");var a=s("input","",{className:"loc-field"});n.makeTooltip(a,"Enter a genomic location or gene name");var l=s("p","",{className:"loc-status"}),h=s("a",[s("i",null,{className:"fa fa-search-plus"})],{className:"btn"}),d=new c({width:n.zoomSliderWidth});n.makeTooltip(d,"Highlighted button shows current zoom level, gray button shows inactive zoom level (click or tap SPACE to toggle).");var f=s("a",[s("i",null,{className:"fa fa-search-minus"})],{className:"btn"}),p=s("a",[s("i",null,{className:"fa fa-eraser"})],{className:"btn"}),_=s("a",[s("i",null,{className:"fa fa-plus"})],{className:"btn"}),g=s("a",[s("i",null,{className:"fa fa-bookmark"})],{className:"btn"}),m=s("a",[s("i",null,{className:"fa fa-print"})],{className:"btn"}),v=(s("a",[s("i",null,{className:"fa fa-refresh"})],{className:"btn"}),s("a",[s("i",null,{className:"fa fa-cogs"})],{className:"btn"})),y=s("a",[s("i",null,{className:"fa fa-question"})],{className:"btn"}),b=s("a",[s("i",null,{className:"fa fa-road"})],{className:"btn"});n.makeTooltip(b,"Configure currently selected track(s) (E)");var x=s("a",[s("i",null,{className:"fa fa-angle-left"})],{className:"btn"},{width:"5px"}),w=s("a",[s("i",null,{className:"fa fa-angle-right"})],{className:"btn pull-right"},{width:"5px"}),S=s("div",null,{className:"btn-group pull-right"});this.noTrackAdder||S.appendChild(_),this.noTrackEditor||S.appendChild(b),this.noExport||S.appendChild(m),this.noOptions||S.appendChild(v),this.noHelp||S.appendChild(y),this.setUiMode=function(t){this.uiMode=t;var e={help:y,add:_,opts:v,"export":m,tier:b};for(var n in e)n==t?e[n].classList.add("active"):e[n].classList.remove("active")},this.noLeapButtons||r.appendChild(w),S.firstChild&&r.appendChild(S),this.noLeapButtons||r.appendChild(x),this.noTitle||r.appendChild(s("div",s("h4",o,{},{margin:"0px"}),{className:"btn-group title"})),this.noLocationField||r.appendChild(s("div",[a,l],{className:"btn-group loc-group"})),this.noClearHighlightsButton||r.appendChild(p),this.noZoomSlider||r.appendChild(s("div",[h,s("span",d,{className:"btn"}),f],{className:"btn-group"})),this.toolbarBelow?(t.appendChild(e),t.appendChild(r)):(t.appendChild(r),t.appendChild(e));var A=Math.log(2)/Math.log(10),k=Math.log(5)/Math.log(10),C=function(t){var e,i=(t/n.zoomExpt+Math.log(n.zoomBase))/Math.log(10),r=0|i,o=i-r;return e=.01>o?r:A+.01>=o?r+A:k+.01>=o?r+k:r+1,(e*Math.log(10)-Math.log(n.zoomBase))*n.zoomExpt},T=function(t){d.addLabel(t,i(Math.exp(t/n.zoomExpt)*n.zoomBase))};this.addViewListener(function(t,e,i,r,o){a.value=t+":"+u(e)+".."+u(i),d.min=0|o.min,d.max=0|o.max,o.isSnapZooming?(d.value=o.alternate,d.value2=o.current,d.active=2):(d.value=o.current,d.value2=o.alternate,d.active=1),o.current==o.min?h.classList.add("disabled"):h.classList.remove("disabled"),o.current==o.max?f.classList.add("disabled"):f.classList.remove("disabled"),d.removeLabels();var s=o.min,l=o.max,c=l-s,_=4;n.zoomSliderWidth&&n.zoomSliderWidth<150&&(_=3),T(C(s));for(var g=1;_-1>g;++g)T(C(s+1*g*c/(_-1)));T(C(l)),n.storeStatus&&n.storeViewStatus(),n.highlights.length>0?p.style.display="inline-block":p.style.display="none"}),this.addTierListener(function(){n.storeStatus&&n.storeTierStatus()}),a.addEventListener("keydown",function(t){if(40==t.keyCode&&(t.preventDefault(),t.stopPropagation(),n.setSelectedTier(0)),10==t.keyCode||13==t.keyCode){t.preventDefault();var e=a.value;n.search(e,function(t){t?l.textContent=""+t:l.textContent=""})}},!1);var E;_.addEventListener("click",function(t){E&&E.displayed?n.removeAllPopups():E=n.showTrackAdder(t)},!1),n.makeTooltip(_,"Add a new track from the registry or an indexed file. (A)"),h.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),n.zoomStep(-10)},!1),n.makeTooltip(h,"Zoom in (+)"),f.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),n.zoomStep(10)},!1),n.makeTooltip(f,"Zoom out (-)"),d.addEventListener("change",function(t){var e=2==d.active;e!=n.isSnapZooming&&(n.savedZoom=n.zoomSliderValue-n.zoomMin,n.isSnapZooming=e);var i=1==d.active?d.value:d.value2;n.zoomSliderValue=1*i,n.zoom(Math.exp(1*i/n.zoomExpt))},!1),g.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault()},!1),n.makeTooltip(g,"Favourite regions"),m.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),n.openExportPanel()},!1),n.makeTooltip(m,"Export publication-quality SVG. (X)");v.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),n.toggleOptsPopup(t)},!1),n.makeTooltip(v,"Configure options."),y.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),n.toggleHelpPopup(t)}),n.makeTooltip(y,"Help; Keyboard shortcuts. (H)"),b.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),1==n.selectedTiers.length&&n.openTierPanel(n.tiers[n.selectedTiers[0]])},!1),x.addEventListener("click",function(t){n.leap(n.reverseKeyScrolling?-1:1,!1)},!1),n.makeTooltip(x,function(t){var e,i=n.getSelectedTier();return i>=0&&(e=n.tiers[i]),e&&e.featureSource&&n.sourceAdapterIsCapable(e.featureSource,"quantLeap")&&"number"==typeof e.quantLeapThreshold?'Jump to the next region with a score above the threshold in the selected track "'+(e.config.name||e.dasSource.name)+'"" (ctrl+LEFT)':e&&e.featureSource&&n.sourceAdapterIsCapable(e.featureSource,"leap")?'Jump to the next feature in the selected track "'+(e.config.name||e.dasSource.name)+'" (ctrl+LEFT)':"Jump left (shift+LEFT)"}),w.addEventListener("click",function(t){n.leap(n.reverseKeyScrolling?1:-1,!1)},!1),n.makeTooltip(w,function(t){var e,i=n.getSelectedTier();return i>=0&&(e=n.tiers[i]),e&&e.featureSource&&n.sourceAdapterIsCapable(e.featureSource,"quantLeap")&&"number"==typeof e.quantLeapThreshold?'Jump to the next region with a score above the threshold in the selected track "'+(e.config.name||e.dasSource.name)+'"" (ctrl+RIGHT)':e&&e.featureSource&&n.sourceAdapterIsCapable(e.featureSource,"leap")?'Jump to the next feature in the selected track "'+(e.config.name||e.dasSource.name)+'" (ctrl+RIGHT)':"Jump right (shift+RIGHT)"}),n.addTierSelectionListener(function(){var t,e=n.getSelectedTier();e>=0&&(t=n.tiers[e]);var i=!1;t&&t.featureSource&&(n.sourceAdapterIsCapable(t.featureSource,"quantLeap")&&"number"==typeof t.quantLeapThreshold?i=!0:n.sourceAdapterIsCapable(t.featureSource,"leap")&&(i=!0)),x.firstChild.className=i?"fa fa-angle-double-left":"fa fa-angle-left",w.firstChild.className=i?"fa fa-angle-double-right":"fa fa-angle-right"}),p.addEventListener("click",function(t){n.clearHighlights()},!1),n.makeTooltip(p,"Clear highlights (C)"),n.addTierSelectionWrapListener(function(t){0>t&&(n.setSelectedTier(null),a.focus())}),n.addTierSelectionListener(function(t){if("tier"===n.uiMode)if(0==t.length)n.hideToolPanel(),n.manipulatingTier=null,n.uiMode="none";else{var e=n.tiers[t[0]];e!=n.manipulatingTier&&n.openTierPanel(e)}});var M=function(t){65==t.keyCode||97==t.keyCode?(t.preventDefault(),t.stopPropagation(),n.showTrackAdder()):72==t.keyCode||104==t.keyCode?(t.stopPropagation(),t.preventDefault(),n.toggleHelpPopup(t)):69==t.keyCode||101==t.keyCode?(t.stopPropagation(),t.preventDefault(),1==n.selectedTiers.length&&n.openTierPanel(n.tiers[n.selectedTiers[0]])):88==t.keyCode||120==t.keyCode?(t.stopPropagation(),t.preventDefault(),n.openExportPanel()):(67==t.keyCode||99==t.keyCode)&&(t.stopPropagation(),t.preventDefault(),n.clearHighlights())};t.addEventListener("focus",function(e){t.addEventListener("keydown",M,!1)},!1),t.addEventListener("blur",function(e){t.removeEventListener("keydown",M,!1)},!1),t.addEventListener("keydown",function(t){27===t.keyCode&&"none"!==n.uiMode&&(t.preventDefault(),t.stopPropagation(),n.setUiMode("none"),n.hideToolPanel(),n.selectedTiers&&n.selectedTiers.length>0&&n.browserHolder.focus())},!1)},o.prototype.showToolPanel=function(t,e){var n=this;this.activeToolPanel&&this.activeToolPanel.parentElement.removeChild(this.activeToolPanel);var i;i=e?t:s("div",t,{},{overflowY:"auto",width:"100%"});var r=s("div",s("i",null,{className:"fa fa-caret-right"}),{className:"tool-divider"});r.addEventListener("click",function(t){n.hideToolPanel(),n.setUiMode("none")},!1),this.makeTooltip(r,"Close tool panel (ESC)"),this.activeToolPanel=s("div",[r,i],{className:"tool-holder"}),this.svgHolder.appendChild(this.activeToolPanel),this.resizeViewer();var n=this},o.prototype.hideToolPanel=function(){this.activeToolPanel&&this.activeToolPanel.parentElement.removeChild(this.activeToolPanel),this.svgHolder.style.width="100%",this.activeToolPanel=null,this.resizeViewer()},o.prototype.toggleHelpPopup=function(t){if("help"===this.uiMode)this.hideToolPanel(),this.setUiMode("none");else{var e=s("iframe",null,{scrolling:"yes",seamless:"seamless",src:this.resolveURL("$$help/index.html"),className:"help-panel"});this.showToolPanel(e,!1),this.setUiMode("help")}},o.prototype.toggleOptsPopup=function(t){var e=this;if("opts"===this.uiMode)this.hideToolPanel(),this.setUiMode("none");else{var n=s("div",null,{className:"form-horizontal"},{boxSizing:"border-box",MozBoxSizing:"border-box",display:"inline-block",verticalAlign:"top"}),i=s("table");i.cellPadding=5;var r=s("input","",{type:"checkbox",checked:e.reverseScrolling});r.addEventListener("change",function(t){e.reverseScrolling=r.checked,e.storeStatus()},!1),i.appendChild(s("tr",[s("td","Reverse trackpad scrolling",{align:"right"}),s("td",r)]));var o=s("input","",{type:"checkbox",checked:e.reverseKeyScrolling});o.addEventListener("change",function(t){e.reverseKeyScrolling=o.checked,e.storeStatus()},!1),i.appendChild(s("tr",[s("td","Reverse scrolling buttons and keys",{align:"right"}),s("td",o)]));var a=s("select");a.appendChild(s("option","Left",{value:"left"})),a.appendChild(s("option","Center",{value:"center"})),a.appendChild(s("option","Right",{value:"right"})),a.appendChild(s("option","None",{value:"none"})),a.value=e.rulerLocation,a.addEventListener("change",function(t){e.rulerLocation=a.value,e.positionRuler();for(var n=0;n<e.tiers.length;++n)e.tiers[n].paintQuant();e.storeStatus()},!1),i.appendChild(s("tr",[s("td","Vertical guideline",{align:"right"}),s("td",a)]));var l=s("input","",{type:"checkbox",checked:e.singleBaseHighlight});l.addEventListener("change",function(t){e.singleBaseHighlight=l.checked,e.positionRuler(),e.storeStatus()},!1),l.setAttribute("id","singleBaseHightlightButton"),i.appendChild(s("tr",[s("td","Display and highlight current genome location",{align:"right"}),s("td",l)])),n.appendChild(i);var u=s("button","Reset browser",{className:"btn"},{marginLeft:"auto",marginRight:"auto",display:"block"});u.addEventListener("click",function(t){e.reset()},!1),n.appendChild(u),this.showToolPanel(n),this.setUiMode("opts")}}},function(t,e,n){"use strict";function i(t){function e(t){t=Math.min(t,r),t=Math.max(t,i),l=t,d.style.left=""+l+"px"}function n(t){t=Math.min(t,r),t=Math.max(t,i),u=t,f.style.left=""+u+"px"}t=t||{};var i=0,r=t.width||200,a=0,s=200,l=50,u=100,c=[],h=o("hr",null,{className:"slider-track"},{width:""+(0|r)+"px"}),d=o("hr",null,{className:"slider-thumb active"}),f=o("hr",null,{className:"slider-thumb"}),p=o("div",[h,d,f],{className:"slider"},{width:""+((0|r)+10)+"px"});p.removeLabels=function(){for(var t=0;t<c.length;++t)p.removeChild(c[t]);c=[]},p.addLabel=function(t,e){var n=o("div",e,{className:"slider-label"},{left:""+(i+(t-a)*(r-i)/(s-a)|0)+"px"});p.appendChild(n),c.push(n)};var _=document.createEvent("HTMLEvents");_.initEvent("change",!0,!1),Object.defineProperty(p,"value",{get:function(){return a+(l-i)*(s-a)/(r-i)},set:function(t){var n=i+(t-a)*(r-i)/(s-a);
e(n)}}),Object.defineProperty(p,"value2",{get:function(){return a+(u-i)*(s-a)/(r-i)},set:function(t){var e=i+(t-a)*(r-i)/(s-a);n(e)}}),Object.defineProperty(p,"active",{get:function(){return d.classList.contains("active")?1:2},set:function(t){1==t?(d.classList.add("active"),f.classList.remove("active")):(f.classList.add("active"),d.classList.remove("active"))}}),Object.defineProperty(p,"min",{get:function(){return a},set:function(t){a=t}}),Object.defineProperty(p,"max",{get:function(){return s},set:function(t){s=t}});var g,m,v=function(t){m=this==d?1:2,m!=p.active&&(p.active=m,p.dispatchEvent(_)),t.stopPropagation(),t.preventDefault(),window.addEventListener("mousemove",y,!1),window.addEventListener("mouseup",b,!1),g=t.clientX-(1==m?l:u)};d.addEventListener("mousedown",v,!1),f.addEventListener("mousedown",v,!1);var y=function(t){1==m?e(t.clientX-g):n(t.clientX-g),p.dispatchEvent(_)},b=function(t){window.removeEventListener("mousemove",y,!1),window.removeEventListener("mouseup",b,!1)};return p}var r=n(248),o=r.makeElement;t.exports=i},function(t,e,n){"use strict";function i(t){for(var e=0;e<t.styles.length;++e){var n=t.styles[e].style;if("__SEQUENCE"===n.glyph)return n}}var r=n(247),o=r.Browser,a=n(248),s=a.makeElement,l=n(251),u=l.isDasBooleanTrue,c=(l.isDasBooleanNotFalse,l.copyStylesheet),h=n(252),d=h.dasColourForName,f={DOT:!0,EX:!0,STAR:!0,SQUARE:!0,CROSS:!0,TRIANGLE:!0,PLIMSOLL:!0};o.prototype.openTierPanel=function(t){if("tier"===this.uiMode&&this.manipulatingTier===t)this.hideToolPanel(),this.setUiMode("none");else{var e=function(t){t.BGGRAD||(1==k?("LINEPLOT"==t.glyph||f[t.glyph]?t.FGCOLOR=g.value:t.BGCOLOR=g.value,t.COLOR1=t.COLOR2=t.COLOR3=null):(t.COLOR1=g.value,t.COLOR2=m.value,k>2?t.COLOR3=v.value:t.COLOR3=null),t._gradient=null,t._plusColor=y.value,t._minusColor=b.value)},n=function(e){for(var n=c(t.stylesheet),i=t.browser.zoomForCurrentScale(),r=0;r<n.styles.length;++r){var o=n.styles[r];o.zoom&&o.zoom!=i||e(o.style)}return n},r=function(i){t.mergeStylesheet(n(e))};this.manipulatingTier=t;var o=s("div",null,{className:"tier-edit"});if(t.dasSource.mapping){var a=this.chains[t.dasSource.mapping].coords;o.appendChild(s("div","Mapped from "+a.auth+a.version,null,{background:"gray",paddingBottom:"5px",marginBottom:"5px",textAlign:"center"}))}var l=s("div","Editing styles for current zoom level",null,{background:"gray",paddingBottom:"5px",marginBottom:"5px",textAlign:"center",display:"none"});o.appendChild(l);var h=s("input",null,{type:"text"}),p=s("input",null,{type:"checkbox",disabled:this.disablePinning}),_=s("select");_.appendChild(s("option","Histogram",{value:"HISTOGRAM"})),_.appendChild(s("option","Line Plot",{value:"LINEPLOT"})),_.appendChild(s("option","Ribbon",{value:"GRADIENT"})),_.appendChild(s("option","Scatter",{value:"SCATTER"}));var g=s("input",null,{type:"text",value:"#dd00dd"}),m=s("input",null,{type:"text",value:"#dd00dd"}),v=s("input",null,{type:"text",value:"#dd00dd"}),y=s("input",null,{type:"text",value:"#ffa07a"}),b=s("input",null,{type:"text",value:"#87cefa"});try{g.type=m.type=v.type="color",y.type=b.type="color"}catch(x){}var w=[g,m,v],S=s("i",null,{className:"fa fa-plus-circle"}),A=s("i",null,{className:"fa fa-minus-circle"}),k=1,C=s("td",w),T=function(t){k=t;for(var e=0;t>e;++e)w[e].style.display="block";for(var e=t;e<w.length;++e)w[e].style.display="none"};S.addEventListener("click",function(t){3>k&&(T(k+1),r(null))},!1),A.addEventListener("click",function(t){k>1&&(T(k-1),r(null))},!1);var E=s("input",null,{type:"text",value:"0.0"}),M=s("input",null,{type:"text",value:"10.0"}),L=s("input",null,{type:"checkbox"}),R=s("input",null,{type:"checkbox"}),O=s("input",null,{type:"checkbox",checked:void 0!==t.quantLeapThreshold}),P=s("input",null,{type:"text",value:t.quantLeapThreshold,disabled:!O.checked}),D=s("input",null,{type:"text",value:"50"}),I=s("input",null,{type:"checkbox"}),N=s("input",null,{type:"text"}),F=s("input",null,{type:"checkbox"}),B=null;if(t.stylesheet.styles.length>0){B=t.stylesheet.styles[0].style}var z=function(){if("string"==typeof t.config.name?h.value=t.config.name:h.value=t.dasSource.name,p.checked=t.pinned,t.forceHeight?D.value=""+t.forceHeight:B&&B.HEIGHT&&(D.value=""+B.HEIGHT),"number"==typeof t.quantLeapThreshold?(O.checked=!0,P.disabled=!1,parseFloat(P.value)!=t.quantLeapThreshold&&(P.value=t.quantLeapThreshold)):(O.checked=!1,P.disabled=!0),"number"==typeof t.subtierMax?N.value=""+t.subtierMax:N.value=""+(t.dasSource.subtierMax||t.browser.defaultSubtierMax),t.stylesheet.styles.length>0){for(var e=null,n=!1,r=!1,o=t.browser.zoomForCurrentScale(),a=0,s=0;s<t.stylesheet.styles.length;++s){var c=t.stylesheet.styles[s];if(!c.zoom||c.zoom==o){++a;var f=t.stylesheet.styles[s].style;e||(e=B=f),("LINEPLOT"==f.glyph||"HISTOGRAM"==f.glyph||"GRADIENT"==f.glyph||u(f.SCATTER))&&(n||(e=B=f),n=!0)}}if(!e)return;l.style.display=a==t.stylesheet.styles.length?"none":"block",r=n&&1==a;e.COLOR2||e.BGGRAD;n?(Z.style.display="table-row",$.style.display="table-row",Q.style.display="none",tt.style.display="none"):(Z.style.display="none",$.style.display="none",Q.style.display="table-row",I.checked=u(B.BUMP),N.disabled=!u(B.BUMP),tt.style.display="table-row",F.checked=u(B.LABEL)),r?(W.style.display="table-row",X.style.display="table-row"):(W.style.display="none",X.style.display="none");var x=1;e.COLOR1?(g.value=d(e.COLOR1).toHexString(),e.COLOR2&&(m.value=d(e.COLOR2).toHexString(),e.COLOR3?(v.value=d(e.COLOR3).toHexString(),x=3):x=2)):"LINEPLOT"==e.glyph||"DOT"==e.glyph&&e.FGCOLOR?g.value=d(e.FGCOLOR).toHexString():e.BGCOLOR&&(g.value=d(e.BGCOLOR).toHexString()),T(x),e._plusColor&&(y.value=d(e._plusColor).toHexString()||e._plusColor),e._minusColor&&(b.value=d(e._minusColor).toHexString()||e._minusColor),u(e.SCATTER)?_.value="SCATTER":_.value=e.glyph;var w,S;if(void 0!==e.MIN){var A=parseFloat(e.MIN);isNaN(A)||(w=A)}if(t.forceMinDynamic||void 0===e.MIN&&void 0===t.forceMin?(L.checked=!1,E.disabled=!0):(L.checked=!0,E.disabled=!1),void 0!==e.MAX){var A=parseFloat(e.MAX);isNaN(A)||(S=A)}t.forceMaxDynamic||void 0===e.MAX&&void 0===t.forceMax?(R.checked=!1,M.disabled=!0):(R.checked=!0,M.disabled=!1),void 0!=t.forceMin&&(w=t.forceMin),void 0!=t.forceMax&&(S=t.forceMax),"number"==typeof w&&w!=parseFloat(E.value)&&(E.value=w),"number"==typeof S&&S!=parseFloat(M.value)&&(M.value=S);var k=i(t.stylesheet);k?(q.style.display="table-row",H.checked="mismatch"===k.__SEQCOLOR,j.style.display="table-row",G.checked=u(k.__INSERTIONS),V.style.display="table-row",U.checked=void 0===k.__disableQuals||k.__disableQuals===!1,console.log(k.__disableQuals)):(q.style.display="none",j.style.display="none",V.style.display="none"),k&&H.checked&&!r?(K.style.display="table-row",Y.style.display="table-row"):(K.style.display="none",Y.style.display="none")}n&&t.browser.sourceAdapterIsCapable(t.featureSource,"quantLeap")?J.style.display="table-row":J.style.display="none"},H=s("input",null,{type:"checkbox"}),q=s("tr",[s("th","Highlight mismatches & strands"),s("td",H)]);H.addEventListener("change",function(e){var n=c(t.stylesheet),r=i(n);r.__SEQCOLOR=H.checked?"mismatch":"base",t.mergeStylesheet(n)});var G=s("input",null,{type:"checkbox"}),j=s("tr",[s("th","Show insertions"),s("td",G)]);G.addEventListener("change",function(e){var n=c(t.stylesheet),r=i(n);r.__INSERTIONS=G.checked?"yes":"no",t.mergeStylesheet(n)});var U=s("input",null,{type:"checkbox"}),V=s("tr",[s("th","Reflect base quality as base color transparency"),s("td",U)]);U.addEventListener("change",function(e){var n=c(t.stylesheet),r=i(n);r.__disableQuals=!U.checked,console.log(r.__disableQuals),t.mergeStylesheet(n)});var W=s("tr",[s("th","Style"),s("td",_)]),X=s("tr",[s("th",["Colour(s)",S,A]),C]),K=s("tr",[s("th","Plus Strand Color"),s("td",y)]),Y=s("tr",[s("th","Minus Strand Color"),s("td",b)]),Z=s("tr",[s("th","Min value"),s("td",[L," ",E])]),$=s("tr",[s("th","Max value"),s("td",[R," ",M])]),J=s("tr",[s("th","Threshold leap:"),s("td",[O," ",P])]),Q=s("tr",[s("th","Bump overlaps"),s("td",[I," limit: ",N])]),tt=s("tr",[s("th","Label features"),s("td",F)]),et=s("table",[s("tr",[s("th","Name",{},{width:"150px",textAlign:"right"}),h]),s("tr",[s("th","Pin to top"),p]),s("tr",[s("th","Height"),s("td",D)]),W,X,K,Y,Z,$,J,Q,tt,q,j,V]);z(),o.appendChild(et);var nt=s("button","Reset track",{className:"btn"},{marginLeft:"auto",marginRight:"auto",display:"block"});nt.addEventListener("click",function(e){t.setConfig({})},!1),o.appendChild(nt),h.addEventListener("input",function(e){t.mergeConfig({name:h.value})},!1),p.addEventListener("change",function(e){t.mergeConfig({pinned:p.checked})},!1);for(var it=0;it<w.length;++it)w[it].addEventListener("change",r,!1);y.addEventListener("change",r,!1),b.addEventListener("change",r,!1),_.addEventListener("change",function(i){var r=n(function(t){"SCATTER"===_.value?(t.SCATTER=!0,t.glyph="DOT",t.SIZE="3"):(t.glyph=_.value,t.SCATTER=void 0),e(t)});t.mergeStylesheet(r)},!1),L.addEventListener("change",function(e){var n={forceMinDynamic:!L.checked};E.disabled=!L.checked;var i=parseFloat(E.value);L.checked&&"number"==typeof i&&!isNaN(i)&&(n.forceMin=parseFloat(i)),t.mergeConfig(n)}),E.addEventListener("input",function(e){var n=parseFloat(E.value);"number"!=typeof n||isNaN(n)||t.mergeConfig({forceMin:n})},!1),R.addEventListener("change",function(e){var n={forceMaxDynamic:!R.checked};M.disabled=!R.checked;var i=parseFloat(M.value);R.checked&&"number"==typeof i&&!isNaN(i)&&(n.forceMax=parseFloat(i)),t.mergeConfig(n)}),M.addEventListener("input",function(e){var n=parseFloat(M.value);"number"!=typeof n||isNaN(n)||t.mergeConfig({forceMax:n})},!1),D.addEventListener("input",function(e){var n=parseFloat(D.value);"number"!=typeof n||isNaN(n)||t.mergeConfig({height:Math.min(500,0|n)})},!1);var rt=function(){if(P.disabled=!O.checked,O.checked){var e=parseFloat(P.value);"number"!=typeof e||isNaN(e)||t.mergeConfig({quantLeapThreshold:parseFloat(P.value)})}else t.mergeConfig({quantLeapThreshold:null})};O.addEventListener("change",function(t){rt()},!1),P.addEventListener("input",function(t){rt()},!1),F.addEventListener("change",function(e){var i=n(function(t){t.LABEL=F.checked?"yes":"no"});t.mergeStylesheet(i)},!1),I.addEventListener("change",function(e){var i=n(function(t){t.BUMP=I.checked?"yes":"no"});t.mergeStylesheet(i)},!1),N.addEventListener("input",function(e){var n=parseInt(N.value);"number"==typeof n&&n>0&&t.mergeConfig({subtierMax:n})},!1),this.showToolPanel(o),this.setUiMode("tier"),t.addTierListener(z);var ot=t.browser.scale;t.browser.addViewListener(function(){t.browser.scale!=ot&&(ot=t.browser.scale,z())})}}},function(t,e,n){var i=n(247),r=i.Browser,o=n(248),a=o.shallowCopy,s=n(249),l=s.hex_sha1,u=n(251),c=u.copyStylesheet;r.prototype.exportFullConfig=function(t){t=t||{};var e={chr:this.chr,viewStart:0|this.viewStart,viewEnd:0|this.viewEnd,cookieKey:"dalliance_"+l(Date.now()),coordSystem:this.coordSystem,sources:this.exportSourceConfig(),chains:this.exportChains()};return this.prefix&&(e.prefix=this.prefix),e},r.prototype.exportChains=function(){var t={},e=this.chains||{};for(var n in e)t[n]=e[n].exportConfig();return t},r.prototype.exportSourceConfig=function(t){t=t||{};for(var e=[],n=0;n<this.tiers.length;++n){var i=this.tiers[n],r=a(i.dasSource);r.noPersist||(r.coords=void 0,r.props=void 0,r.disabled||(r.disabled=void 0),i.config.stylesheet?(r.style=c(i.config.stylesheet).styles,r.stylesheet_uri=void 0):r.style&&(r.style=c({styles:r.style}).styles),"string"==typeof i.config.name&&(r.name=i.config.name),void 0!==i.config.height&&(r.forceHeight=i.config.height),void 0!==i.config.forceMin&&(r.forceMin=i.config.forceMin),i.config.forceMinDynamic&&(r.forceMinDynamic=i.config.forceMinDynamic),void 0!==i.config.forceMax&&(r.forceMax=i.config.forceMax),void 0!==i.config.bumped&&(r.bumped=i.config.bumped),i.config.forceMaxDynamic&&(r.forceMaxDynamic=i.config.forceMaxDynamic),e.push(r))}return e},r.prototype.exportPageTemplate=function(t){t=t||{};var e='<html>\n  <head>\n    <script language="javascript" src="'+this.resolveURL("$$dalliance-compiled.js")+'"></script>\n    <script language="javascript">\n      var dalliance_browser = new Browser('+JSON.stringify(this.exportFullConfig(t),null,2)+');\n    </script>\n  </head>\n  <body>\n    <div id="svgHolder">Dalliance goes here</div>\n  </body>\n<html>\n';return e}},function(t,e,n){var i=n(247),r=i.Browser,o=n(248),a=o.makeElement,s=o.removeChildren;r.prototype.openExportPanel=function(){var t=this;if("export"===this.uiMode)this.hideToolPanel(),this.setUiMode("none");else{var e=a("div",null,{className:"export-form"}),n=a("select");n.appendChild(a("option","SVG",{value:"svg"})),n.appendChild(a("option","Image",{value:"png"})),n.appendChild(a("option","Dalliance config",{value:"config"})),n.appendChild(a("option","Dalliance sources",{value:"sources"})),n.appendChild(a("option","Dalliance page",{value:"page"})),n.value="svg",n.addEventListener("change",function(t){s(u),p()},!1),e.appendChild(a("p",["Export as: ",n]));var i=a("input",null,{type:"checkbox",checked:this.exportHighlights});i.addEventListener("change",function(e){t.exportHighlights=i.checked,t.storeStatus()},!1);var r=a("input",null,{type:"checkbox",checked:this.exportRuler});r.addEventListener("change",function(e){t.exportRuler=r.checked,t.storeStatus()},!1);var o=a("input",null,{type:"text",value:"1.0"}),l=a("button","Export",{className:"btn btn-primary"});l.addEventListener("click",function(e){s(u);var l,c,h,d;if("svg"===n.value)l=URL.createObjectURL(t.makeSVG({highlights:i.checked,ruler:r.checked?t.rulerLocation:"none"})),c="SVG",h="image/svg",d="dalliance-view.svg";else if("png"===n.value){var f=parseFloat(o.value);if(.1>f||f>10)return void alert("bad scale "+f);l=t.exportImage({highlights:i.checked,ruler:r.checked?t.rulerLocation:"none",resolutionMultiplier:f}),c="Image",h="image/png",d="dalliance-view.png"}else if("config"===n.value){var p=JSON.stringify(t.exportFullConfig(),null,2),_=new Blob([p],{type:"text/plain"});l=URL.createObjectURL(_),c="Configuration",h="text/plain",d="dalliance-config.json"}else if("sources"===n.value){var p=JSON.stringify(t.exportSourceConfig(),null,2),_=new Blob([p],{type:"text/plain"});l=URL.createObjectURL(_),c="Source array",h="text/plain",d="dalliance-sources.json"}else if("page"===n.value){var g=t.exportPageTemplate(),h="text/html",_=new Blob([g],{type:h});l=URL.createObjectURL(_),c="Page template",d="dalliance-view.html"}if(l){var m=a("a","[Download]",{href:l,download:d,type:h}),v=a("a","[Preview in browser]",{href:l,type:h,target:"_new"});u.appendChild(a("p",[""+c+" created: ",m,v]))}},!1),t.addViewListener(function(){s(u)}),t.addTierListener(function(){s(u)});var u=a("p",""),c=a("tr",[a("th","Include highlights",{},{width:"200px",textAlign:"right"}),a("td",i)]),h=a("tr",[a("th","Include vertical guideline"),a("td",r)]),d=a("tr",[a("th","Scale multiplier"),a("td",o)]),f=a("table",[c,h,d]),p=function(){var t=n.value;c.style.display="svg"==t||"png"==t?"table-row":"none",h.style.display="svg"==t||"png"==t?"table-row":"none",d.style.display="png"==t?"table-row":"none"};p(),e.appendChild(f),e.appendChild(l),e.appendChild(u),"none"!==this.uiMode&&this.hideToolPanel(),this.browserHolder.insertBefore(e,this.svgHolder),this.activeToolPanel=e,this.setUiMode("export")}}},function(t,e,n){"use strict";function i(t,e,n,i){t.fillText(e,n-t.measureText(e).width,i)}var r=n(247),o=r.Browser,a=n(268),s=a.OverlayLabelCanvas,l=n(272),u=l.formatQuantLabel,c=n(273).drawSeqTierGC;o.prototype.exportImage=function(t){t=t||{};for(var e=this.featurePanelWidth,n=3,r=0,o=0;o<this.tiers.length;++o){o>0&&(r+=n);var a=this.tiers[o];void 0!==a.layoutHeight&&(r+=a.layoutHeight)}var l=t.resolutionMultiplier||1,h=200,d=(e+h)*l|0,f=r*l|0,p=makeElement("canvas",null,{width:d,height:f}),_=p.getContext("2d");_.fillStyle="white",_.fillRect(0,0,d,f),_.scale(l,l);for(var g=0,o=0;o<this.tiers.length;++o){var a=this.tiers[o],m=(a.glyphCacheOrigin-this.viewStart)*this.scale,v=new s;_.save(),_.translate(0,g),_.save(),_.beginPath(),_.moveTo(h,0),_.lineTo(h+e,0),_.lineTo(h+e,a.layoutHeight),_.lineTo(h,a.layoutHeight),_.closePath(),_.clip(),_.translate(h,0),_.save(),_.translate(m,0),a.subtiers?a.paintToContext(_,v,m+1e3):c(a,a.currentSequence,_),_.restore(),_.save(),_.translate(m,0),v.draw(_,-m,e-m),_.restore(),_.restore();for(var y=!1,b=0,x=a.subtiers||[],w=0;w<x.length;++w){var S=x[w];if(S.quant){y=!0;var A=S.quant,k=S.height,C=2;k>40&&(C=1+(k/20|0));var T=k/(C-1),E=(A.max-A.min)/(C-1);_.beginPath(),_.moveTo(h+5,b),_.lineTo(h,b),_.lineTo(h,b+S.height),_.lineTo(h+5,b+S.height);for(var M=1;C-1>M;++M){var L=M*T;_.moveTo(h,b+L),_.lineTo(h+3,b+L)}_.strokeStyle="black",_.strokeWidth=2,_.stroke(),_.fillStyle="black",i(_,u(A.max),h-3,b+7),i(_,u(A.min),h-3,b+S.height);for(var M=1;C-1>M;++M){var L=M*T;i(_,u(1*A.max-M*E),h-3,b+L+3)}}b+=S.height+n}var R;R="string"==typeof a.config.name?a.config.name:a.dasSource.name;var O=_.measureText(R).width;_.fillStyle="black",_.fillText(R,h-(y?22:12)-O,(a.layoutHeight+6)/2),_.restore(),g+=a.layoutHeight+n}if(t.highlights){_.save(),_.beginPath(),_.moveTo(h,0),_.lineTo(h+e,0),_.lineTo(h+e,g),_.lineTo(h,g),_.closePath(),_.clip(),_.translate(h+m,0);for(var P=this.viewStart,D=this.viewStart,I=this.viewEnd,N=0;N<this.highlights.length;++N){var k=this.highlights[N];(k.chr===this.chr||k.chr==="chr"+this.chr)&&k.min<I&&k.max>D&&(_.globalAlpha=this.defaultHighlightAlpha,_.fillStyle=this.defaultHighlightFill,_.fillRect((k.min-P)*this.scale,0,(k.max-k.min)*this.scale,g))}_.restore()}var F=-1;return"center"==t.ruler?F=h+(this.viewEnd-this.viewStart+1)*this.scale/2:"left"==t.ruler?F=h:"right"==t.ruler&&(F=h+(this.viewEnd-this.viewStart+1)*this.scale),F>=0&&(_.strokeStyle="blue",_.beginPath(),_.moveTo(F,0),_.lineTo(F,g),_.stroke()),p.toDataURL("image/png")}},function(t,e,n){var i=n(247),r=i.Browser,o=n(248),a=(o.makeElement,o.makeElementNS),s=n(275),l=n(273).svgSeqTier,u=n(270),c=u.NS_SVG,h=u.NS_XLINK,d=u.SVGPath,f=n(272),p=f.formatQuantLabel;r.prototype.makeSVG=function(t){t=t||{};var e=t.minTierHeight||20,n=3,i=this,r=document.implementation.createDocument(c,"svg",null),o=a(c,"g",null,{fontFamily:"helvetica",fontSize:"8pt"});r.documentElement.appendChild(o);var u=200,f=a(c,"a",a(c,"text","Graphics from Dalliance "+s,{x:(i.featurePanelWidth+u+20)/2,y:30,strokeWidth:0,fontSize:"12pt",textAnchor:"middle",fill:"blue"}));f.setAttribute("xmlns:xlink",h),f.setAttribute("xlink:href","http://www.biodalliance.org/"),o.appendChild(f);var _=a(c,"rect",null,{x:u,y:50,width:i.featurePanelWidth,height:1e5}),g=a(c,"clipPath",_,{id:"featureClip"});o.appendChild(g);for(var m=70,v=a(c,"g",null,{}),y=0;y<i.tiers.length;++y){var b=i.tiers[y],x=a(c,"g",null,{clipPath:"url(#featureClip)",clipRule:"nonzero"}),w=a(c,"g"),S=m,A=a(c,"rect",null,{x:0,y:S,width:"10000",height:50,fill:b.background});if(x.appendChild(A),b.sequenceSource){var k=l(b,b.currentSequence);x.appendChild(a(c,"g",k,{transform:"translate("+u+", "+m+")"})),m+=80}else{if(!b.subtiers)continue;for(var C=(b.glyphCacheOrigin-i.viewStart)*i.scale,T=!1,E=0;E<b.subtiers.length;++E){m+=n;for(var M=b.subtiers[E],L=[],R=0;R<M.glyphs.length;++R){var O=M.glyphs[R];L.push(O.toSVG())}if(x.appendChild(a(c,"g",L,{transform:"translate("+(u+C)+", "+m+")"})),M.quant){T=!0;var P=M.quant,D=M.height,I=2;D>40&&(I=1+(D/20|0));var N=D/(I-1),F=(P.max-P.min)/(I-1),B=new d;B.moveTo(u+5,m),B.lineTo(u,m),B.lineTo(u,m+M.height),B.lineTo(u+5,m+M.height);for(var z=1;I-1>z;++z){var H=z*N;B.moveTo(u,m+H),B.lineTo(u+3,m+H)}w.appendChild(a(c,"path",null,{d:B.toPathData(),fill:"none",stroke:"black",strokeWidth:"2px"})),w.appendChild(a(c,"text",p(P.max),{x:u-3,y:m+7,textAnchor:"end"})),w.appendChild(a(c,"text",p(P.min),{x:u-3,y:m+M.height,textAnchor:"end"}));for(var z=1;I-1>z;++z){var H=z*N;w.appendChild(a(c,"text",p(1*P.max-z*F),{x:u-3,y:m+H+3,textAnchor:"end"}))}}m+=M.height+n}e>m-S&&(m=S+e)}var q;q="string"==typeof b.config.name?b.config.name:b.dasSource.name,w.appendChild(a(c,"text",q,{x:u-(T?20:12),y:(m+S+8)/2,fontSize:"10pt",textAnchor:"end"})),A.setAttribute("height",m-S),v.appendChild(a(c,"g",[x,w]))}if(t.highlights)for(var G=this.highlights||[],j=0;j<G.length;++j){var D=G[j];if((D.chr==this.chr||D.chr=="chr"+this.chr)&&D.min<this.viewEnd&&D.max>this.viewStart){var U=(Math.max(D.min,this.viewStart)-this.viewStart)*this.scale,V=(Math.min(D.max,this.viewEnd)-this.viewStart)*this.scale;v.appendChild(a(c,"rect",null,{x:u+U,y:70,width:V-U,height:m-70,stroke:"none",fill:this.defaultHighlightFill,fillOpacity:this.defaultHighlightAlpha}))}}var W=-1;"center"==t.ruler?W=u+(this.viewEnd-this.viewStart)*this.scale/2:"left"==t.ruler?W=u:"right"==t.ruler&&(W=u+(this.viewEnd-this.viewStart)*this.scale),W>=0&&v.appendChild(a(c,"line",null,{x1:W,y1:70,x2:W,y2:m,stroke:"blue"})),o.appendChild(v),r.documentElement.setAttribute("width",i.featurePanelWidth+20+u),r.documentElement.setAttribute("height",m+50);var X=new Blob([(new XMLSerializer).serializeToString(r)],{type:"image/svg+xml"});return X}},function(t,e,n){"use strict";var i=n(247),r=i.Browser,o=n(254),a=o.sourceDataURI,s=o.sourcesAreEqual,l=n(275),u=n(248),c=u.miniJSONify,h=n(249),d=h.hex_sha1;r.prototype.nukeStatus=function(){delete localStorage["dalliance."+this.cookieKey+".view-chr"],delete localStorage["dalliance."+this.cookieKey+".view-start"],delete localStorage["dalliance."+this.cookieKey+".view-end"],delete localStorage["dalliance."+this.cookieKey+".current-seq-length"],delete localStorage["dalliance."+this.cookieKey+".showing-alt-zoom"],delete localStorage["dalliance."+this.cookieKey+".saved-zoom"],delete localStorage["dalliance."+this.cookieKey+".sources"],delete localStorage["dalliance."+this.cookieKey+".hubs"],delete localStorage["dalliance."+this.cookieKey+".version"],delete localStorage["dalliance."+this.cookieKey+".reverse-scrolling"],delete localStorage["dalliance."+this.cookieKey+".reverse-key-scrolling"],delete localStorage["dalliance."+this.cookieKey+".ruler-location"]},r.prototype.storeStatus=function(){this.storeViewStatus(),this.storeTierStatus()},r.prototype.storeViewStatus=function(){!this.cookieKey||this.noPersist||this.noPersistView||(localStorage["dalliance."+this.cookieKey+".view-chr"]=this.chr,localStorage["dalliance."+this.cookieKey+".view-start"]=0|this.viewStart,localStorage["dalliance."+this.cookieKey+".view-end"]=0|this.viewEnd,localStorage["dalliance."+this.cookieKey+".showing-alt-zoom"]=""+this.isSnapZooming,localStorage["dalliance."+this.cookieKey+".saved-zoom"]=this.savedZoom,this.currentSeqMax&&(localStorage["dalliance."+this.cookieKey+".current-seq-length"]=this.currentSeqMax))},r.prototype.storeTierStatus=function(){if(this.cookieKey&&!this.noPersist){for(var t=[],e=0;e<this.tiers.length;++e){var n=this.tiers[e],i=n.dasSource;i.noPersist||t.push({source:n.dasSource,config:n.config||{}})}localStorage["dalliance."+this.cookieKey+".sources"]=JSON.stringify(t);for(var r={},o=[],a=0;a<this.hubObjects.length;++a){var s=this.hubObjects[a],u={url:s.hub.url,genome:s.genome};s.credentials&&(u.credentials=s.credentials),s.mapping&&(u.mapping=s.mapping),r[u.url]=!0,o.push(u)}for(var a=0;a<this.hubs.length;++a){var u=this.hubs[a];"string"==typeof u&&(u={url:u}),r[u.url]||o.push(u)}localStorage["dalliance."+this.cookieKey+".hubs"]=JSON.stringify(o),localStorage["dalliance."+this.cookieKey+".reverse-scrolling"]=this.reverseScrolling,localStorage["dalliance."+this.cookieKey+".reverse-key-scrolling"]=this.reverseKeyScrolling,localStorage["dalliance."+this.cookieKey+".single-base-highlight"]=this.singleBaseHighlight,localStorage["dalliance."+this.cookieKey+".ruler-location"]=this.rulerLocation,localStorage["dalliance."+this.cookieKey+".export-ruler"]=this.exportRuler,localStorage["dalliance."+this.cookieKey+".export-highlights"]=this.exportHighlights,localStorage["dalliance."+this.cookieKey+".version"]=l.CONFIG}},r.prototype.restoreStatus=function(){if(!this.noPersist){var t=localStorage["dalliance."+this.cookieKey+".version"];if(t=t?0|t:-100,l.CONFIG==t){var e=localStorage["dalliance."+this.cookieKey+".configHash"]||"",n=d(c({sources:this.sources,hubs:this.hubs}));if(n!=e)return void(localStorage["dalliance."+this.cookieKey+".configHash"]=n);for(var i={},r=0;r<this.sources.length;++r){var o=this.sources[r];if(o){var u=a(o),h=i[u];h||(i[u]=h=[]),h.push(o)}}if(!this.noPersistView){var f=localStorage["dalliance."+this.cookieKey+".view-chr"],p=0|localStorage["dalliance."+this.cookieKey+".view-start"],_=0|localStorage["dalliance."+this.cookieKey+".view-end"];if(f&&p&&_){this.chr=f,this.viewStart=p,this.viewEnd=_;var g=localStorage["dalliance."+this.cookieKey+".current-seq-length"];g&&(this.currentSeqMax=0|g),this.isSnapZooming="true"==localStorage["dalliance."+this.cookieKey+".showing-alt-zoom"];var m=parseFloat(localStorage["dalliance."+this.cookieKey+".saved-zoom"]);"number"!=typeof m||isNaN(m)||(this.savedZoom=m)}}var v=localStorage["dalliance."+this.cookieKey+".reverse-scrolling"];this.reverseScrolling=v&&"true"==v;var y=localStorage["dalliance."+this.cookieKey+".reverse-key-scrolling"];this.reverseKeyScrolling=y&&"true"==y;var b=localStorage["dalliance."+this.cookieKey+".single-base-highlight"];this.singleBaseHighlight=b&&"true"==b;var x=localStorage["dalliance."+this.cookieKey+".ruler-location"];x&&(this.rulerLocation=x);var w=localStorage["dalliance."+this.cookieKey+".export-ruler"];w&&(this.exportRuler="true"===w);var w=localStorage["dalliance."+this.cookieKey+".export-highlights"];w&&(this.exportHighlights="true"===w);var S=localStorage["dalliance."+this.cookieKey+".sources"];if(S){var A=JSON.parse(S);this.sources=[],this.restoredConfigs=[];for(var r=0;r<A.length;++r){var o=this.sources[r]=A[r].source;this.restoredConfigs[r]=A[r].config;for(var u=a(o),h=i[u]||[],k=0;k<h.length;++k){var C=h[k];if(s(o,C))for(var T in C)C.hasOwnProperty(T)&&("function"==typeof C[T]||C[T]instanceof Blob)&&(o[T]=C[T])}}}var E=localStorage["dalliance."+this.cookieKey+".hubs"];return E&&(this.hubs=JSON.parse(E)),!0}}},r.prototype.reset=function(){for(var t=this.tiers.length-1;t>=0;--t)this.removeTier({index:t},!0);for(var t=0;t<this.defaultSources.length;++t){var e=this.defaultSources[t];e.disabled||this.addTier(this.defaultSources[t])}this.highlights.splice(0,this.highlights.length),this.setLocation(this.defaultChr,this.defaultStart,this.defaultEnd)}},function(t,e,n){"use strict";function i(t,e){for(var n=0;n<t.length;++n){var i=t[n];i===e?i.classList.add("active"):i.classList.remove("active")}}var r=n(247),o=r.Browser,a=n(254),s=a.sourcesAreEqual,l=n(248),u=l.makeElement,c=l.removeChildren,h=l.Observed,d=n(274),f=d.THUB_COMPARE,p=d.connectTrackHub,_=n(289),g=_.makeTreeTableSection,m=n(290).probeResource,v=n(277),y=v.URLFetchable,b=v.BlobFetchable,x=v.readInt,w=n(291),S=w.unbgzf,A=n(292),k=(A.BAM_MAGIC,A.BAI_MAGIC),C=n(293),T=C.TABIX_MAGIC,E=n(251),M=E.DASSource,L=E.DASSegment,R=E.DASRegistry,O=E.coordsMatch,P=n(294).EncodeFetchable;o.prototype.currentlyActive=function(t){for(var e=0;e<this.tiers.length;++e)if(s(this.tiers[e].dasSource,t))return this.tiers[e];return!1},o.prototype.makeButton=function(t,e){var n=u("a",t,{href:"#"});return e&&this.makeTooltip(n,e),u("li",n)},o.prototype.showTrackAdder=function(t){function e(t){wt.style.display="none",dt.style.display="none",xt.style.display="none",at=!1,c(ut);for(var e=u("div",null,{},{width:"100%"}),n=[],i=0;i<t.length;++i)n.push(t[i]);n.sort(function(t,e){return t.shortLabel.toLowerCase().trim().localeCompare(e.shortLabel.toLowerCase().trim())});for(var r=[],o=[],a=0;a<n.length;++a){var s=n[a];s.children&&s.children.length>0&&"multiWig"!=s.container?r.push(s):o.push(s)}o.length>0&&r.push({shortLabel:"Others",priority:-1e8,children:o}),r.sort(f);for(var l=[],h=0;h<r.length;++h){var d=r[h],p=d;!p.dimensions&&p._parent&&p._parent.dimensions&&(p=p._parent);var _={};if(p.dimensions)for(var m=p.dimensions.split(/(\w+)=(\w+)/),v=0;v<m.length-2;v+=3)_[m[v+1]]=m[v+2];if(_.dimX&&_.dimY){for(var y=_.dimX,b=_.dimY,x=p.subgroups[y],w=p.subgroups[b],S={},A=0;A<d.children.length;++A){var k=d.children[A],C=k.sgm[y],T=k.sgm[b];S[C]||(S[C]={}),S[C][T]=k}var E=u("table",null,{className:"table table-striped table-condensed"},{tableLayout:"fixed"}),M=u("tr");M.appendChild(u("th",null,{},{width:"150px",height:"100px"}));for(var L=0;L<x.titles.length;++L){var R=u("th",u("div",x.titles[L],{},{transform:"rotate(-60deg)",transformOrigin:"0% 100%",webkitTransform:"rotate(-60deg) translate(20px,10px)",webkitTransformOrigin:"0% 100%",textAlign:"left"}),{},{width:"35px",height:"100px",verticalAlign:"bottom"});M.appendChild(R)}E.appendChild(M);for(var O=u("tbody",null,{className:"table table-striped table-condensed"}),P=0;P<w.titles.length;++P){var T=w.tags[P],I=u("tr");I.appendChild(u("th",w.titles[P]),{});for(var N=0;N<x.titles.length;++N){var C=x.tags[N],F=u("td");if(S[C]&&S[C][T]){var s=S[C][T],B=s.toDallianceSource();if(!B)continue;var z=u("tr"),H=u("td");H.style.textAlign="center";var q=u("input");q.type="checkbox",q.dalliance_source=B,ct&&(q.dalliance_mapping=ct),l.push(q),F.appendChild(q),q.addEventListener("change",function(t){t.target.checked?D.addTier(t.target.dalliance_source):D.removeTier(t.target.dalliance_source)})}I.appendChild(F)}O.appendChild(I)}E.appendChild(O),e.appendChild(g(d.shortLabel,E,0==h))}else{var G=u("tbody",null,{className:"table table-striped table-condensed"}),j=u("table",G,{className:"table table-striped table-condensed"},{width:"100%",tableLayout:"fixed"}),U=0;d.children.sort(f);for(var i=0;i<d.children.length;++i){var s=d.children[i],B=s.toDallianceSource();if(B){var z=u("tr"),H=u("td",null,{},{width:"30px"});H.style.textAlign="center";var q=u("input");q.type="checkbox",q.dalliance_source=B,ct&&(q.dalliance_mapping=ct),l.push(q),H.appendChild(q),q.addEventListener("change",function(t){t.target.checked?D.addTier(t.target.dalliance_source):D.removeTier(t.target.dalliance_source)}),z.appendChild(H);var V=u("td");V.appendChild(document.createTextNode(s.shortLabel)),s.longLabel&&s.longLabel.length>0&&D.makeTooltip(V,s.longLabel),z.appendChild(V),G.appendChild(z),++U}}r.length>1||"Others"!==d.shortLabel?e.appendChild(g(d.shortLabel,j,0==h)):e.appendChild(j)}}var W=function(){for(var t=0;t<l.length;++t){var e=l[t],n=D.currentlyActive(e.dalliance_source);n?(e.checked=!0,e.disabled=null!=n.sequenceSource):e.checked=!1}};W(),D.addTierListener(function(t){W()}),ut.appendChild(e)}function n(){i(N,K),at="bin",wt.style.display="none",dt.style.display="inline",xt.style.display="none",c(ut);var t=u("div",null,{},{paddingLeft:"10px",paddingRight:"10px"});t.appendChild(u("h3","Add custom URL-based data")),t.appendChild(u("p",["You can add indexed binary data hosted on an web server that supports CORS (",u("a","full details",{href:"http://www.biodalliance.org/bin.html"}),").  Currently supported formats are bigwig, bigbed, and indexed BAM."])),t.appendChild(u("br")),t.appendChild(document.createTextNode("URL: ")),Q=u("input","",{size:80,value:"http://www.biodalliance.org/datasets/ensGene.bb"},{width:"100%"}),t.appendChild(Q),t.appendChild(u("br")),t.appendChild(u("b","- or -")),t.appendChild(u("br")),t.appendChild(document.createTextNode("File: ")),it=u("input",null,{type:"file",multiple:"multiple"}),t.appendChild(it),t.appendChild(u("p",'Clicking the "Add" button below will initiate a series of test queries.')),ut.appendChild(t),Q.focus()}function r(){i(N,$),wt.style.display="none",dt.style.display="inline",xt.style.display="none",at="hub-connect",wt.style.visibility="hidden",c(ut);var t=u("div",null,{},{paddingLeft:"10px",paddingRight:"10px"});t.appendChild(u("h3","Connect to a track hub.")),t.appendChild(u("p",['Enter the top-level URL (usually points to a file called "hub.txt") of a UCSC-style track hub'])),Q=u("input","",{size:120,value:"http://www.biodalliance.org/datasets/testhub/hub.txt"},{width:"100%"}),t.appendChild(Q),ut.appendChild(t),Q.focus()}function o(){i(N,X),wt.style.display="none",dt.style.display="inline",xt.style.display="none",at="das",c(ut);var t=u("div",null,{},{paddingLeft:"10px",
paddingRight:"10px"});t.appendChild(u("h3","Add custom DAS data")),t.appendChild(u("p","This interface is intended for adding custom or lab-specific data.  Public data can be added more easily via the registry interface.")),t.appendChild(document.createTextNode("URL: ")),t.appendChild(u("br")),Q=u("input","",{size:80,value:"http://www.derkholm.net:8080/das/medipseq_reads/"},{width:"100%"}),t.appendChild(Q),t.appendChild(u("p",'Clicking the "Add" button below will initiate a series of test queries.  If the source is password-protected, you may be prompted to enter credentials.')),ut.appendChild(t),Q.focus()}function a(){if(at){if("das"===at){var t=Q.value.trim();/^.+:\/\//.exec(t)||(t="http://"+t);var e=new M({name:"temporary",uri:t});ft(e)}else if("bin"===at){var i=it.files;if(i&&i.length>0)vt(i);else{var t=Q.value.trim();/^.+:\/\//.exec(t)||(t="http://"+t);var a={uri:t},l=t.toLowerCase();0==l.indexOf("https://www.encodeproject.org/")&&l.indexOf("@@download")>=0&&(a.transport="encode"),_t(a)}}else if("reset"===at)o();else if("reset-bin"===at)n();else if("reset-hub"===at)r();else if("prompt-bai"===at){var i=it.files;i&&i.length>0&&i[0]?(st.baiBlob=i[0],v(st)):d(st)}else if("prompt-tbi"===at){var i=it.files;i&&i.length>0&&i[0]?(st.indexBlob=i[0],w(st)):_(st)}else if("finalize"===at||"finalize-bin"===at){st.name=tt.value;var u=et.value;"__default__"!=u?st.mapping=u:st.mapping=void 0,nt&&(st.maxbins=nt.checked),rt.value.length>1&&ot.value.length>1&&(st.xUser=rt.value,st.xPass=ot.value),D.addTier(st),"finalize-bin"==at?n():o()}else if("hub-connect"===at){var t=Q.value.trim();/^.+:\/\//.exec(t)||(t="http://"+t),s(t)}else if("multiple"===at){for(var c=0;c<mt.length;++c){var h=mt[c];if(!h.hidden&&("bam"!=h.tier_type||h.indexBlob||h.indexUri)&&("tabix"!=h.tier_type||h.indexBlob||h.indexUri)){var e=pt(h);e&&(e.noPersist=!0,D.addTier(e))}}n()}}else D.removeAllPopups()}function s(t,n,r){n=n||{};for(var o=0;o<D.hubObjects.length;++o){var a=D.hubObjects[o];if(a.hub.url==t){for(var l=0;l<N.length;++l)N[l].hub==a&&i(N,N[l]);return void a.getTracks(function(t,n){n&&console.log(n),e(t)})}}p(t,function(o,a){if(a)return r?(c(ut),ut.appendChild(u("h2","Error connecting to track hub")),ut.appendChild(u("p",a)),void(at="reset-hub")):s(t,{credentials:!0},!0);var l=null,h=null;for(var d in o.genomes){var f=null,p=!1;if(d==D.coordSystem.ucscName)p=!0;else for(var _ in D.chains){var g=D.chains[_];d==g.coords.ucscName&&(f=_,p=!0)}if(p){var m={url:t,genome:d};n.credentials&&(m.credentials=!0),f&&(m.mapping=f,o.genomes[d].mapping=f),D.hubs.push(m),D.hubObjects.push(o.genomes[d]);var v=U(o.genomes[d]);J.appendChild(v),f&&l||(l=o.genomes[d],h=v)}}return l?(D.notifyTier(),i(N,h),l.getTracks(function(t,n){e(t)}),void 0):(c(ut),ut.appendChild(u("h2","No data for this genome")),ut.appendChild(u("p","This URL appears to be a valid track-hub, but it doesn't contain any data for the coordinate system of this browser")),ut.appendChild(u("p","coordSystem.ucscName = "+D.coordSystem.ucscName)),void(at="reset-hub"))},n)}function l(t,e){function n(){return e?gt(t):l(t,!0)}var i=t.uri;if(e){var r=/(.+)\/[^\/]+\/?/.exec(i);r&&(i=r[1]+"/sources")}new R(i,{credentials:t.credentials}).sources(function(e){if(!e||0==e.length)return n();var i=null;if(1==e.length)i=e[0];else for(var r=0;r<e.length;++r)if(e[r].uri===t.uri){i=e[r];break}var o=!1,a=!1;if(i&&(t.name=i.name,t.desc=i.desc,i.maxbins?t.maxbins=!0:t.maxbins=!1,i.capabilities&&(t.capabilities=i.capabilities),a=!0,i.coords&&1==i.coords.length)){var s=i.coords[0];if(O(s,D.coordSystem))o=!0;else if(D.chains)for(var l in D.chains)O(s,D.chains[l].coords)&&(t.mapping=l,o=!0)}return gt(t,o,a)},function(){return n()})}function d(t){wt.style.display="none",dt.style.display="inline",xt.style.display="inline",c(ut),at="prompt-bai",ut.appendChild(u("h2","Select an index file")),ut.appendChild(u("p","Dalliance requires a BAM index (.bai) file when displaying BAM data.  These normally accompany BAM files.  For security reasons, web applications like Dalliance can only access local files which you have explicity selected.  Please use the file chooser below to select the appropriate BAI file")),ut.appendChild(document.createTextNode("Index file: ")),it=u("input",null,{type:"file"}),ut.appendChild(it),st=t}function _(t){wt.style.display="none",dt.style.display="inline",xt.style.display="inline",c(ut),at="prompt-tbi",ut.appendChild(u("h2","Select an index file")),ut.appendChild(u("p","Dalliance requires a Tabix index (.tbi) file when displaying VCF data.  For security reasons, web applications like Dalliance can only access local files which you have explicity selected.  Please use the file chooser below to select the appropriate BAI file")),ut.appendChild(document.createTextNode("Index file: ")),it=u("input",null,{type:"file"}),ut.appendChild(it),st=t}function v(t){var e;e=t.baiBlob?new b(t.baiBlob):"encode"==t.transport?new P(t.bamURI+".bai"):new y(t.bamURI+".bai",{credentials:t.credentials}),e.slice(0,256).fetch(function(e){var n=!1;if(e){var i=new Uint8Array(e),r=x(i,0);n=r==k}return n?gt(t,!1,!1,!0):A("You have selected a valid BAM file, but a corresponding index (.bai) file was not found.  Please index your BAM (samtools index) and place the BAI file in the same directory")})}function w(t){var e;e=t.indexBlob?new b(t.indexBlob):new y(t.uri+".tbi"),e.slice(0,65536).fetch(function(e){var n=!1;if(e){var i=new Uint8Array(e);if(31==i[0]||139==i[1]){var r=S(e);i=new Uint8Array(r);var o=x(i,0);n=o==T}}return n?gt(t,!1,!1,!0):A('You have selected a valid VCF file, but a corresponding index (.tbi) file was not found.  Please index your VCF ("tabix -p vcf -f myfile.vcf.gz") and place the .tbi file in the same directory')})}function A(t){wt.style.display="none",dt.style.display="inline",xt.style.display="inline",c(ut),t=t||"Custom data format not recognized",ut.appendChild(u("h2","Error adding custom data")),ut.appendChild(u("p",t)),ut.appendChild(u("p","Currently supported formats are bigBed, bigWig, and BAM.")),at="reset-bin"}if("add"===this.uiMode)return this.hideToolPanel(),void this.setUiMode("none");var C,E,D=this,I=u("div",null,{className:"dalliance"},{width:"100%",display:"inline-block",boxSizing:"border-box",MozBoxSizing:"border-box",verticalAlign:"top",paddingRight:"15px"}),N=[];if(!this.noRegistryTabs){var F=this.makeButton("Registry","Browse compatible datasources from the DAS registry");N.push(F);for(var B in this.mappableSources){var z=function(t){var e=D.makeButton(D.chains[t].srcTag,"Browse datasources mapped from "+D.chains[t].srcTag);N.push(e),e.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),i(N,e),C(D.mappableSources[t],t)},!1)};z(B)}}for(var H={},q=0;q<this.defaultSources.length;++q){var G=this.defaultSources[q],j=G.group||"Defaults";H[j]?H[j].push(G):H[j]=[G]}var U=function(t){var n=t.hub,o=u("i",null,{className:"fa fa-list-alt"},{cursor:"context-menu"}),a=n.shortLabel||"Unknown";t.mapping&&(a=a+" ("+t.genome+")");var s=u("span",[a," ",o]),l=D.makeButton(s,n.longLabel);return l.hub=t,N.push(l),l.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),i(N,l),c(ut);var r=D.makeLoader(24);r.style.marginLeft="auto",r.style.marginRight="auto",r.style.marginTop="100px",ut.appendChild(u("div",r,null,{textAlign:"center"})),wt.style.display="none",dt.style.display="none",xt.style.display="none",t.getTracks(function(t,n){n&&console.log(n),e(t)})},!1),o.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var n=u("li",u("a","Remove hub")),o=u("li",u("a","Enable all")),a=u("li",u("a","Disable all")),s=u("ul",[n,o,a],{className:"dropdown-menu"},{display:"block"}),c=e.clientX,h=e.clientY;c+=document.documentElement.scrollLeft||document.body.scrollLeft,h+=document.documentElement.scrollTop||document.body.scrollTop,s.style.position="absolute",s.style.top=""+(h+10)+"px",s.style.left=""+(c-30)+"px",D.hPopupHolder.appendChild(s);var d=function(t){console.log("cc"),document.body.removeEventListener("click",d,!0),D.hPopupHolder.removeChild(s)};document.body.addEventListener("click",d,!0),n.addEventListener("click",function(e){for(var n=0;n<D.hubObjects.length;++n)if(D.hubObjects[n].absURL==t.absURL){D.hubObjects.splice(n,1);break}for(var n=0;n<D.hubs.length;++n){var o=D.hubs[n];if("string"==typeof o&&(o={url:o}),o.url==t.hub.url&&!o.genome||o.genome==t.genome){D.hubs.splice(n,1);break}}D.notifyTier(),J.removeChild(l),i(N,$),r()},!1),o.addEventListener("click",function(e){t.getTracks(function(t,e){e&&console.log(e);for(var n=0;n<t.length;++n){var i=t[n].toDallianceSource();D.currentlyActive(i)||D.addTier(i)}})},!1),a.addEventListener("click",function(e){t.getTracks(function(t,e){e&&console.log(e);for(var n=0;n<t.length;++n){var i=t[n].toDallianceSource();D.currentlyActive(i)&&D.removeTier(i)}})},!1)},!1),l},V=null,W=null;for(var j in H)!function(t,e){var n=D.makeButton(t,"Browse the default set of data for this browser");n.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),i(N,n),C(new h(e))},!1),N.push(n),V||(V=n,W=e)}(j,H[j]);var X=this.makeButton("DAS","Add arbitrary DAS data");N.push(X);var K=this.makeButton("Binary","Add data in bigwig or bigbed format");N.push(K);for(var Y=0;Y<this.hubObjects.length;++Y){var Z=this.hubObjects[Y];U(Z)}var $=this.makeButton("+","Connect to a new track-hub");N.push($);var J=u("ul",N,{className:"nav nav-tabs"},{marginBottom:"0px"});I.appendChild(J);var Q,tt,et,nt,it,rt,ot,at=!1,st=null,lt=u("form",null,{},{display:"inline-block",width:"100%"});lt.addEventListener("submit",function(t){return t.stopPropagation(),t.preventDefault(),a(),!1},!0);var ut=u("div");ut.style.position="relative",ut.style.overflow="scroll",lt.appendChild(ut);var ct,ht;C=function(t,e){wt.style.display="none",dt.style.display="none",xt.style.display="none",ht&&ht.removeListener(E),ct=e,ht=t,ht.addListenerAndFire(E)},E=function(t){at=!1;var e=[];if(c(ut),!t)return void ut.appendChild(u("p","Dalliance was unable to retrieve data source information from the DAS registry, please try again later"));for(var n=u("tbody",null,{className:"table table-striped table-condensed"},{width:"100%"}),i=u("table",n,{className:"table table-striped table-condensed"},{width:"100%",tableLayout:"fixed"}),r=0,o=[],a=0;a<t.length;++a)o.push(t[a]);o.sort(function(t,e){return t.name.toLowerCase().trim().localeCompare(e.name.toLowerCase().trim())});for(var a=0;a<o.length;++a){var s=o[a],l=u("tr"),h=u("td",null,{},{width:"30px"});if(h.style.textAlign="center",!s.props||s.props.cors){var d=u("input");d.type="checkbox",d.dalliance_source=s,ct&&(d.dalliance_mapping=ct),h.appendChild(d),e.push(d),d.addEventListener("change",function(t){t.target.checked?D.addTier(t.target.dalliance_source):D.removeTier(t.target.dalliance_source)})}else h.appendChild(document.createTextNode("!")),D.makeTooltip(h,u("span",["This data source isn't accessible because it doesn't support ",u("a","CORS",{href:"http://www.w3.org/TR/cors/"}),"."]));l.appendChild(h);var f=u("td");f.appendChild(document.createTextNode(s.name)),s.desc&&s.desc.length>0&&D.makeTooltip(f,s.desc),l.appendChild(f),n.appendChild(l),++r}var p=function(){for(var t=0;t<e.length;++t){var n=e[t],i=D.currentlyActive(n.dalliance_source);i?n.checked=!0:n.checked=!1}};p(),D.addTierListener(function(t){p()}),ut.appendChild(i)},F&&F.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),i(N,F),C(D.availableSources)},!1),K.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),n()},!1),$.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),r()},!1),X.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),o()},!1);var dt=u("button","Add",{className:"btn btn-primary"});dt.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),a()},!1);var ft=function(t,e){var n=D.knownSpace;if(!n)return void alert("Can't confirm track-addition to an uninit browser.");var i=0|Math.max(n.min,(n.min+n.max-100)/2),r=new L(n.chr,i,Math.min(i+99,n.max));t.features(r,{},function(n,i){if(!i){var r=new RegExp("/([^/]+)/?$"),o=r.exec(t.uri);return o&&(t.name=o[1]),void l(t)}return e?(c(ut),ut.appendChild(u("h2","Custom data not found")),ut.appendChild(u("p","DAS uri: "+t.uri+" is not answering features requests")),void(at="reset")):(t.credentials=!0,void ft(t,!0))})},pt=function(t){var e={name:t.name};return t.credentials&&(e.credentials=t.credentials),t.mapping&&"__default__"!=t.mapping&&(e.mapping=t.mapping),t.transport&&(e.transport=t.transport),"bwg"==t.tier_type?(t.blob?e.bwgBlob=t.blob:t.uri&&(e.bwgURI=t.uri),e):"bam"==t.tier_type?(t.blob?(e.bamBlob=t.blob,e.baiBlob=t.indexBlob):(e.bamURI=t.uri,e.baiURI=t.indexUri),e):"tabix"==t.tier_type?(e.tier_type="tabix",e.payload=t.payload,t.blob?(e.blob=t.blob,e.indexBlob=t.indexBlob):(e.uri=t.uri,e.indexUri=t.indexUri),e):"memstore"==t.tier_type?(e.tier_type="memstore",e.payload=t.payload,t.blob?e.blob=t.blob:e.uri=t.uri,e):void 0},_t=function(t){m(t,function(t,e){if(!e){var n=pt(t);return"bam"==t.tier_type?v(n):"tabix"==t.tier_type?w(n):gt(n,!1,!1,!0)}c(ut);var i=u("div");i.appendChild(u("h2","Couldn't access custom data")),i.appendChild(u("p",""+e)),ut.appendChild(i),console.log(t),"https:"===window.location.protocol&&0==t.uri.indexOf("http:")&&D.canFetchPlainHTTP().then(function(t){t||i.appendChild(u("p",[u("strong","HTTP warning: "),"you may not be able to access HTTP resources from an instance of Biodalliance which you are accessing via HTTPS.",u("a","[More info]",{href:D.httpWarningURL,target:"_blank"})]))}),at="reset-bin"})},gt=function(t,e,n,i){if(wt.style.display="none",dt.style.display="inline",xt.style.display="inline",c(ut),ut.appendChild(u("h2","Add custom data: step 2")),ut.appendChild(document.createTextNode("Label: ")),tt=u("input","",{value:t.name}),ut.appendChild(tt),rt=u("input",""),ot=u("input",""),ut.appendChild(u("br")),ut.appendChild(u("br")),ut.appendChild(u("h4","Coordinate system: ")),et=u("select",null),et.appendChild(u("option",D.nameForCoordSystem(D.coordSystem),{value:"__default__"})),D.chains)for(var r in D.chains){var o=D.chains[r].coords;et.appendChild(u("option",D.nameForCoordSystem(o),{value:r}))}et.value=t.mapping||"__default__",ut.appendChild(et),e?ut.appendChild(u("p","(Based on server response, probably doesn't need changing.)")):(ut.appendChild(u("p",[u("b","Warning: "),"unable to determine the correct value from server responses.  Please check carefully."])),ut.appendChild(u("p","If you don't see the mapping you're looking for, please contact thomas@biodalliance.org"))),i||(ut.appendChild(document.createTextNode("Quantitative: ")),nt=u("input",null,{type:"checkbox",checked:!0}),"undefined"!=typeof t.maxbins&&(nt.checked=t.maxbins),ut.appendChild(nt),n?ut.appendChild(u("p","(Based on server response, probably doesn't need changing.)")):ut.appendChild(u("p",[u("b","Warning: "),"unable to determine correct value.  If in doubt, leave checked."]))),t.bwgBlob&&ut.appendChild(u("p",[u("b","Warning: "),"data added from local file.  Due to the browser security model, the track will disappear if you reload Dalliance."])),tt.focus(),at="bin"===at||"prompt-bai"===at||"prompt-tbi"===at?"finalize-bin":"finalize",st=t},mt=null,vt=function(t){var e=mt=[];at="multiple";for(var n=0;n<t.length;++n){var i=t[n];i&&e.push({blob:i})}for(var n=0;n<e.length;++n)yt(e[n]);bt()},yt=function(t){m(t,function(t,e){e&&(t.error=e);for(var n=[],i={},r={},o=0;o<mt.length;++o){var a=mt[o];"bam"!=a.tier_type||a.indexBlob||(i[a.blob.name]=a),"tabix"!=a.tier_type||a.indexBlob||(r[a.blob.name]=a)}for(var o=0;o<mt.length;++o){var a=mt[o];if("bai"===a.tier_type){var s=new RegExp("(.+)\\.bai$"),l=s.exec(a.blob.name);l&&i[l[1]]&&(i[l[1]].indexBlob=a.blob,n.push(o))}else if("tabix-index"===a.tier_type){var u=new RegExp("(.+)\\.tbi$"),l=u.exec(a.blob.name);l&&r[l[1]]&&(r[l[1]].indexBlob=a.blob,n.push(o))}}for(var c=n.length-1;c>=0;--c)mt.splice(n[c],1);bt()})},bt=function(){c(ut);var t=!1,e=u("table",mt.filter(function(t){return!t.hidden}).map(function(e){var n=u("tr");n.appendChild(u("td",e.name||e.blob.name));var i;i=e.error?u("span","Error",null,{color:"red"}):e.tier_type?e.payload||e.tier_type:D.makeLoader(16);var r,o="unknown";if("bwg"==e.tier_type||"memstore"==e.tier_type?o="okay":"bam"==e.tier_type?o=e.indexBlob?"okay":"needs-index":"tabix"==e.tier_type&&(o=e.indexBlob?"okay":"needs-index"),"okay"==o){if(r=u("select",null,null,{width:"150px"}),r.appendChild(u("option",D.nameForCoordSystem(D.coordSystem),{value:"__default__"})),D.chains)for(var a in D.chains){var s=D.chains[a].coords;r.appendChild(u("option",D.nameForCoordSystem(s),{value:a}))}r.value=e.mapping||"__default__",r.addEventListener("change",function(t){e.mapping=r.value,console.log(e)},!1)}else"needs-index"==o&&(r=u("span","Needs index",{},{color:"red"}),t=!0);return u("tr",[u("td",e.name||e.blob.name),u("td",i),u("td",r)])}),{className:"table table-striped table-condensed"});if(ut.appendChild(e),t){ut.appendChild(u("p","Some of these files are missing required index (.bai or .tbi) files.  For security reasons, web applications like Dalliance can only access local files which you have explicity selected.  Please use the file chooser below to select the appropriate index file")),ut.appendChild(document.createTextNode("Index file(s): "));var n=u("input",null,{type:"file",multiple:"multiple"});ut.appendChild(n),n.addEventListener("change",function(t){console.log("fileset changed");for(var e=n.files||[],i=0;i<e.length;++i){var r=e[i];if(r){var o={blob:r,hidden:!0};mt.push(o),yt(o)}}},!1)}},xt=u("button","Cancel",{className:"btn"});xt.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),"finalize-bin"===at?n():o()},!1);var wt=u("button","Refresh",{className:"btn"});wt.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),D.queryRegistry(ct)},!1),this.makeTooltip(wt,"Click to re-fetch data from the DAS registry");var St=u("div",[dt," ",xt," ",wt]);St.style.margin="10px",lt.appendChild(St),I.appendChild(lt),C(D.availableSources),this.showToolPanel(I),this.setUiMode("add"),V&&(i(N,V),C(new h(W)))}},function(t,e,n){"use strict";function i(t,e,n){function i(){n?(r.className="fa fa-caret-down",e.style.display="table"):(r.className="fa fa-caret-right",e.style.display="none")}var r=s("i");i(),r.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),n=!n,i()},!1);var o=s("h6",[r," ",t],{},{display:"block",background:"gray",color:"white",width:"100%",padding:"5px 2px",margin:"0px"});return s("div",[o,e],{})}var r=n(247),o=r.Browser,a=n(248),s=a.makeElement,l=a.removeChildren;o.prototype.removeAllPopups=function(){l(this.hPopupHolder),l(this.popupHolder)},o.prototype.makeTooltip=function(t,e){var n,i=!1,r=this,o=null;n=function(e){i=!1,o&&(clearTimeout(o),o=null),t.removeEventListener("mouseout",n,!1)};var a=function(n){var l=n.clientX+window.scrollX,u=n.clientY+window.scrollY;o||(o=setTimeout(function(){var n;n="function"==typeof e?e():e;var c=s("div",[s("div",null,{className:"tooltip-arrow"}),s("div",n,{className:"tooltip-inner"})],{className:"tooltip bottom in"},{display:"block",top:""+(u+20)+"px",left:""+Math.max(l-30,20)+"px"});r.hPopupHolder.appendChild(c);var h;h=function(e){try{r.hPopupHolder.removeChild(c)}catch(n){}window.removeEventListener("mousemove",h,!1),i&&(null==t.offsetParent||a(e))},window.addEventListener("mousemove",h,!1),o=null},1e3))};t.addEventListener("mouseover",function(e){i=!0,t.addEventListener("mouseout",n,!1),a(e)},!1),t.addEventListener("DOMNodeRemovedFromDocument",function(t){i=!1,o&&(clearTimeout(o),o=null)},!1)},o.prototype.popit=function(t,e,n,i){var r=this;i||(i={}),t||(t={});var o,a,l=i.width||200;if(t.clientX)var o=t.clientX,a=t.clientY;else o=500,a=50;o+=document.documentElement.scrollLeft||document.body.scrollLeft,a+=document.documentElement.scrollTop||document.body.scrollTop;var u=window.innerWidth,c=a,h=Math.min(o-l/2-4,u-l-30),d=s("div");if(d.className="popover fade "+(t.clientX?"bottom ":"")+"in",d.style.display="block",d.style.position="absolute",d.style.top=""+c+"px",d.style.left=""+h+"px",d.style.width=l+"px",l>276&&(d.style.maxWidth=l+"px"),d.appendChild(s("div",null,{className:"arrow"})),e){var f=s("button","",{className:"close"});f.innerHTML="&times;",f.addEventListener("mouseover",function(t){f.style.color="red"},!1),f.addEventListener("mouseout",function(t){f.style.color="black"},!1),f.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),r.removeAllPopups()},!1);var p,_,g,m,v=s("h4",[s("span",e,null,{maxWidth:"200px"}),f],{},{paddingLeft:"10px",paddingRight:"10px"});g=function(t){t.stopPropagation(),t.preventDefault(),h+=t.clientX-p,8>h&&(h=8),h>u-l-32&&(h=u-l-26),c+=t.clientY-_,c=Math.max(10,c),d.style.top=""+c+"px",d.style.left=""+Math.min(h,u-l-10)+"px",p=t.clientX,_=t.clientY},m=function(t){t.stopPropagation(),t.preventDefault(),window.removeEventListener("mousemove",g,!1),window.removeEventListener("mouseup",m,!1)},v.addEventListener("mousedown",function(t){t.preventDefault(),t.stopPropagation(),p=t.clientX,_=t.clientY,window.addEventListener("mousemove",g,!1),window.addEventListener("mouseup",m,!1)},!1),d.appendChild(v)}d.appendChild(s("div",n,{className:"popover-content"},{padding:"0px"})),this.hPopupHolder.appendChild(d);var y={node:d,displayed:!0};return d.addEventListener("DOMNodeRemoved",function(t){t.target==d&&(y.displayed=!1)},!1),y},t.exports={makeTreeTableSection:i}},function(t,e,n){"use strict";function i(t,e,n){var o,u=new RegExp("^\\w+\\s[0-9]+\\s[0-9]+.*$"),d=/([^=]+)=\"?([^\"]+)\"?/,p=/^##\s*fileformat=VCFv4\..+/;o=t.blob?new s(t.blob):"encode"==t.transport?new y(t.uri):new a(t.uri,{credentials:t.credentials}),o.slice(0,65536).salted().fetch(function(o,a){if(!o)return n||(t.credentials=!0,i(t,e,!0)),e(t,"Couldn't fetch data");var s=new Uint8Array(o),m=new Uint32Array(o,0,1),y=m[0];if(y==c||y==h){t.tier_type="bwg";var b=new RegExp("/?([^/]+?)(.bw|.bb|.bigWig|.bigBed)?$"),x=b.exec(t.uri||t.blob.name);return x&&(t.name=x[1]),e(t,null)}if(y==g)return t.tier_type="bai",e(t,null);if(31==s[0]||139==s[1]){var w=f(o),S=new Uint8Array(w);if(y=l(S,0),y==_){t.tier_type="bam";var b=new RegExp("/?([^/]+?)(.bam)?$"),x=b.exec(t.uri||t.blob.name);return x&&(t.name=x[1]),e(t,null)}if(y==v)return t.tier_type="tabix-index",e(t,null);if(1768301347==y){t.tier_type="tabix",t.payload="vcf";var b=new RegExp("/?([^/]+?)(.vcf)?(.gz)?$"),x=b.exec(t.uri||t.blob.name);return x&&(t.name=x[1]),e(t,null)}return console.log("magic = "+y.toString(16)),e(t,"Unsupported format")}var A=String.fromCharCode.apply(null,s),k=A.split("\n");if(k.length>0&&p.test(k[0])){t.tier_type="memstore",t.payload="vcf";var b=new RegExp("/?([^/]+?)(.vcf)?$"),x=b.exec(t.uri||t.blob.name);return x&&!t.name&&(t.name=x[1]),e(t,null)}for(var C=0;C<k.length;++C){var T=k[C].replace("\r","");if(0!=T.length&&0!=T.indexOf("browser")){if(0==T.indexOf("track")){for(var E="bed",M=T.split(/\s/),L=1;L<M.length;++L){var R=d.exec(M[L]);R&&("type"==R[1]&&"wiggle_0"==R[2]?E="wig":"name"==R[0]&&(t.name=R[2]))}return r(t,E),e(t,null)}if(0==T.indexOf("fixedStep"))return r(t,"wig"),e(t,null);if(0==T.indexOf("variableStep"))return r(t,"wig"),e(t,null);if(u.test(T))return r(t,null),e(t,null);break}}return e(t,"Unsupported format")},{timeout:1500})}function r(t,e){t.tier_type="memstore";var n=new RegExp("/?([^/]+?)(.(bed|wig))?$"),i=n.exec(t.uri||t.blob.name);i&&(t.name||(t.name=i[1]),!e&&i[3]&&(e=i[3])),t.payload=e||"bed"}var o=n(277),a=o.URLFetchable,s=o.BlobFetchable,l=o.readInt,u=n(278),c=u.BIG_WIG_MAGIC,h=u.BIG_BED_MAGIC,d=n(291),f=d.unbgzf,p=n(292),_=p.BAM_MAGIC,g=p.BAI_MAGIC,m=n(293),v=m.TABIX_MAGIC,y=n(294).EncodeFetchable;t.exports={probeResource:i}},function(t,e,n){function i(t,e){this.block=t,this.offset=e}function r(t,e){var n=4294967296*(255&t[e+6])+16777216*(255&t[e+5])+65536*(255&t[e+4])+256*(255&t[e+3])+(255&t[e+2]),r=t[e+1]<<8|t[e];return 0==n&&0==r?null:new i(n,r)}function o(t,e){e=Math.min(e||1,t.byteLength-50);for(var n=[],i=[0],r=0;i[0]<e;){var o=new Uint8Array(t,i[0],12),a=o[11]<<8|o[10],s=c(t,12+a+i[0],Math.min(65536,t.byteLength-12-a-i[0]),i);i[0]+=8,r+=s.byteLength,n.push(s)}if(1==n.length)return n[0];for(var l=new Uint8Array(r),u=0,d=0;d<n.length;++d){var f=new Uint8Array(n[d]);h(f,0,l,u,f.length),u+=f.length}return l.buffer}function a(t,e){this.minv=t,this.maxv=e}function s(t,e){return--e,t>>14==e>>14?4681+(t>>14):t>>17==e>>17?585+(t>>17):t>>20==e>>20?73+(t>>20):t>>23==e>>23?9+(t>>23):t>>26==e>>26?1+(t>>26):0}function l(t,e){var n,i=[];for(--e,i.push(0),n=1+(t>>26);1+(e>>26)>=n;++n)i.push(n);for(n=9+(t>>23);9+(e>>23)>=n;++n)i.push(n);for(n=73+(t>>20);73+(e>>20)>=n;++n)i.push(n);for(n=585+(t>>17);585+(e>>17)>=n;++n)i.push(n);for(n=4681+(t>>14);4681+(e>>14)>=n;++n)i.push(n);return i}var u=n(279),c=u.inflateBuffer,h=u.arrayCopy;i.prototype.toString=function(){return""+this.block+":"+this.offset};t.exports={unbgzf:o,readVob:r,reg2bin:s,reg2bins:l,Chunk:a}},function(t,e,n){"use strict";function i(){}function r(t,e){var n=e,i=u(t,n);n+=4;for(var r=0;i>r;++r){var o=(u(t,n),u(t,n+4));n+=8+16*o}var a=u(t,n);n+=4;for(var s=1e9,l=n,c=0;a>c;++c){var h=p(t,l);if(l+=8,h){var d=h.block;h.offset>0&&(d+=65536),s>d&&(s=d);break}}return n+=8*a,{minBlockIndex:s,nbin:i,length:n-e}}function o(t,e,n,a,s){function l(t){if(!t)return a(null,"Couldn't access BAM");var e=_(t,t.byteLength),n=new Uint8Array(e),i=u(n,0);if(i!=v)return a(null,"Not a BAM file, magic=0x"+i.toString(16));for(var r=u(n,4),o="",s=0;r>s;++s)o+=String.fromCharCode(n[s+8]);var l=u(n,r+8),c=r+12;h.chrToIndex={},h.indexToChr=[];for(var s=0;l>s;++s){for(var d=u(n,c),f="",p=0;d-1>p;++p)f+=String.fromCharCode(n[c+4+p]);u(n,c+d+4);h.chrToIndex[f]=s,0==f.indexOf("chr")?h.chrToIndex[f.substring(3)]=s:h.chrToIndex["chr"+f]=s,h.indexToChr.push(f),c=c+8+d}return h.indices?a(h):void 0}function c(t){if(!t)return"Couldn't access BAI";var e=new Uint8Array(t),n=u(e,0);if(n!=y)return a(null,"Not a BAI file, magic=0x"+n.toString(16));var i=u(e,4);h.indices=[];for(var o=8,s=0;i>s;++s){var l=o,c=r(e,l);o+=c.length,d=Math.min(c.minBlockIndex,d);var f=c.nbin;f>0&&(h.indices[s]=new Uint8Array(t,l,o-l))}return!0}var h=new i;h.data=t,h.bai=e,h.indexChunks=n;var d=h.indexChunks?h.indexChunks.minBlockIndex:1e9;if(h.indexChunks){var f=h.indexChunks.chunks;h.indices=[];for(var p=0;p<f.length;p++)h.indices[p]=null;h.data.slice(0,d).fetch(l)}else h.bai.fetch(function(e){var i=c(e);i!==!0?h.bai.url&&"undefined"==typeof s?(h.bai.url=h.data.url.replace(new RegExp(".bam$"),".bai"),o(t,h.bai,n,a,!0)):a(null,i):h.data.slice(0,d).fetch(l,{timeout:5e3})},{timeout:5e3})}function a(){}var s=n(269),l=(s.Range,s.union,s.intersection,n(277)),u=l.readInt,c=l.readShort,h=l.readByte,d=(l.readInt64,l.readFloat),f=n(291),p=f.readVob,_=f.unbgzf,g=f.reg2bins,m=f.Chunk,v=21840194,y=21578050,b={MULTIPLE_SEGMENTS:1,ALL_SEGMENTS_ALIGN:2,SEGMENT_UNMAPPED:4,NEXT_SEGMENT_UNMAPPED:8,REVERSE_COMPLEMENT:16,NEXT_REVERSE_COMPLEMENT:32,FIRST_SEGMENT:64,LAST_SEGMENT:128,SECONDARY_ALIGNMENT:256,QC_FAIL:512,DUPLICATE:1024,SUPPLEMENTARY:2048};i.prototype.blocksForRange=function(t,e,n){var i=this.indices[t];if(!i)return[];for(var r=g(e,n),o=[],a=0;a<r.length;++a)o[r[a]]=!0;for(var s=[],l=[],c=u(i,0),h=4,d=0;c>d;++d){var f=u(i,h),_=u(i,h+4);if(h+=8,o[f])for(var v=0;_>v;++v){var y=p(i,h),b=p(i,h+8);(4681>f?l:s).push(new m(y,b)),h+=16}else h+=16*_}for(var x=u(i,h),w=null,S=Math.min(e>>14,x-1),A=Math.min(n>>14,x-1),a=S;A>=a;++a){var k=p(i,h+4+8*a);k&&(!w||k.block<w.block||k.offset<w.offset)&&(w=k)}var C=[];if(null!=w)for(var a=0;a<l.length;++a){var T=l[a];T.maxv.block>=w.block&&T.maxv.offset>=w.offset&&C.push(T)}l=C;for(var E=[],a=0;a<l.length;++a)E.push(l[a]);for(var a=0;a<s.length;++a)E.push(s[a]);E.sort(function(t,e){var n=t.minv.block-e.minv.block;return 0!=n?n:t.minv.offset-e.minv.offset});var M=[];if(E.length>0){for(var L=E[0],a=1;a<E.length;++a){var R=E[a];R.minv.block==L.maxv.block?L=new m(L.minv,R.maxv):(M.push(L),L=R)}M.push(L)}return M},i.prototype.fetch=function(t,e,n,i,r){function o(){if(d>=s.length)return i(h);if(c){var t=new Uint8Array(c),u=a.readBamRecords(t,s[d].minv.offset,h,e,n,l,r);return c=null,++d,u?i(h):o()}var f=s[d],p=f.minv.block,g=f.maxv.block+65536;a.data.slice(p,g-p).fetch(function(t){return c=_(t,f.maxv.block-f.minv.block+1),o()})}var a=this;r=r||{};var s,l=this.chrToIndex[t];if(void 0===l)s=[];else{if(null===this.indices[l]&&this.indexChunks.chunks[l]){var u=this.indexChunks.chunks[l];return this.bai.slice(u[0],u[1]).fetch(function(o){var a=new Uint8Array(o);return this.indices[l]=a,this.fetch(t,e,n,i,r)}.bind(this))}s=this.blocksForRange(l,e,n),s||i(null,"Error in index fetch")}var c,h=[],d=0;o()};var x=["=","A","C","x","G","x","x","x","T","x","x","x","x","x","x","N"],w=["M","I","D","N","S","H","P","=","X","?","?","?","?","?","?","?"];i.prototype.readBamRecords=function(t,e,n,i,r,o,s){for(;;){var l=u(t,e),f=e+l+4;if(f>=t.length)return!1;var p=new a,_=u(t,e+4),g=u(t,e+8),m=u(t,e+12),v=(65280&m)>>8,y=255&m,b=u(t,e+16),S=(4294901760&b)>>16,A=65535&b,k=u(t,e+20),C=u(t,e+24),T=u(t,e+28);u(t,e+32);if(p.segment=this.indexToChr[_],p.flag=S,p.pos=g,p.mq=v,s.light&&(p.seqLength=k),!s.light){C>=0&&(p.nextSegment=this.indexToChr[C],p.nextPos=T);for(var E="",M=0;y-1>M;++M)E+=String.fromCharCode(t[e+36+M]);p.readName=E;for(var L=e+36+y,R="",O=0;A>O;++O){var P=u(t,L);R=R+(P>>4)+w[15&P],L+=4}p.cigar=R;for(var D="",I=k+1>>1,M=0;I>M;++M){var N=t[L+M];D+=x[(240&N)>>4],D.length<k&&(D+=x[15&N])}L+=I,p.seq=D;for(var F="",M=0;k>M;++M)F+=String.fromCharCode(t[L+M]+33);for(L+=k,p.quals=F;f>L;){var B,z=String.fromCharCode(t[L],t[L+1]),H=String.fromCharCode(t[L+2]);if("A"==H)B=String.fromCharCode(t[L+3]),L+=4;else if("i"==H||"I"==H)B=u(t,L+3),L+=7;else if("c"==H||"C"==H)B=t[L+3],L+=4;else if("s"==H||"S"==H)B=c(t,L+3),L+=5;else if("f"==H)B=d(t,L+3),L+=7;else if("Z"==H||"H"==H)for(L+=3,B="";;){var q=t[L++];if(0==q)break;B+=String.fromCharCode(q)}else{if("B"!=H)throw"Unknown type "+H;var G,j,U=String.fromCharCode(t[L+3]),V=u(t,L+4);if("i"==U||"I"==U||"f"==U)G=4,j="f"==U?d:u;else if("s"==U||"S"==U)G=2,j=c;else{if("c"!=U&&"C"!=U)throw"Unknown array type "+U;G=1,j=h}L+=8,B=[];for(var W=0;V>W;++W)B.push(j(t,L)),L+=G}p[z]=B}}if((!i||p.pos<=r&&p.pos+k>=i)&&(void 0===o||_==o)&&n.push(p),p.pos>r)return!0;e=f}},t.exports={makeBam:o,BAM_MAGIC:v,BAI_MAGIC:y,BamFlags:b}},function(t,e,n){"use strict";function i(){}function r(t,e,n){var r=new i;r.data=t,r.tbi=e,r.tbi.fetch(function(t){if(!t)return n(null,"Couldn't access Tabix");var e=h(t,t.byteLength),i=new Uint8Array(e),a=l(i,0);if(a!=o)return n(null,"Not a tabix index");var s=l(i,4);r.format=l(i,8),r.colSeq=l(i,12),r.colStart=l(i,16),r.colEnd=l(i,20),r.meta=l(i,24),r.skip=l(i,28);l(i,32);r.indices=[];var u=36;r.chrToIndex={},r.indexToChr=[];for(var d=0;s>d;++d){for(var f="";;){var p=i[u++];if(0==p)break;f+=String.fromCharCode(p)}r.chrToIndex[f]=d,0==f.indexOf("chr")?r.chrToIndex[f.substring(3)]=d:r.chrToIndex["chr"+f]=d,r.indexToChr.push(f)}for(var _=1e9,g=0;s>g;++g){var m=u,v=l(i,u);u+=4;for(var y=0;v>y;++y){var b=(l(i,u),l(i,u+4));u+=8+16*b}var x=l(i,u);u+=4;for(var w=u,d=0;x>d;++d){var S=c(i,w);if(w+=8,S){var A=S.block;S.offset>0&&(A+=65536),_>A&&(_=A);break}}u+=8*x;v>0&&(r.indices[g]=new Uint8Array(e,m,u-m))}r.headerMax=_,n(r)},{timeout:5e3})}var o=21578324,a=n(269),s=(a.Range,a.union,a.intersection,n(277)),l=s.readInt,u=(s.readShort,s.readByte,s.readInt64,s.readFloat,n(291)),c=u.readVob,h=u.unbgzf,d=u.reg2bins,f=u.Chunk;i.prototype.blocksForRange=function(t,e,n){var i=this.indices[t];if(!i)return[];for(var r=d(e,n),o=[],a=0;a<r.length;++a)o[r[a]]=!0;for(var s=[],u=[],h=l(i,0),p=4,_=0;h>_;++_){var g=l(i,p),m=l(i,p+4);if(p+=8,o[g])for(var v=0;m>v;++v){var y=c(i,p),b=c(i,p+8);(4681>g?u:s).push(new f(y,b)),p+=16}else p+=16*m}for(var x=l(i,p),w=null,S=Math.min(e>>14,x-1),A=Math.min(n>>14,x-1),a=S;A>=a;++a){var k=c(i,p+4+8*a);k&&(!w||k.block<w.block||k.offset<w.offset)&&(w=k)}var C=[];if(null!=w)for(var a=0;a<u.length;++a){
var T=u[a];T.maxv.block>=w.block&&T.maxv.offset>=w.offset&&C.push(T)}u=C;for(var E=[],a=0;a<u.length;++a)E.push(u[a]);for(var a=0;a<s.length;++a)E.push(s[a]);E.sort(function(t,e){var n=t.minv.block-e.minv.block;return 0!=n?n:t.minv.offset-e.minv.offset});var M=[];if(E.length>0){for(var L=E[0],a=1;a<E.length;++a){var R=E[a];R.minv.block==L.maxv.block?L=new f(L.minv,R.maxv):(M.push(L),L=R)}M.push(L)}return M},i.prototype.fetch=function(t,e,n,i){function r(){if(d>=s.length)return i(c);if(u){var t=new Uint8Array(u);return o.readRecords(t,s[d].minv.offset,c,e,n,l),u=null,++d,r()}var a=s[d],f=a.minv.block,p=a.maxv.block+65536;o.data.slice(f,p-f).fetch(function(t){return u=h(t,a.maxv.block-a.minv.block+1),r()})}var o=this,a=this.chrToIndex[t];if(void 0==a)return i([]);var s,l=this.indexToChr[a];void 0===a?s=[]:(s=this.blocksForRange(a,e,n),s||i(null,"Error in index fetch"));var u,c=[],d=0;r()},i.prototype.readRecords=function(t,e,n,i,r,o){t:for(;;){for(var a="";e<t.length;){var s=t[e++];if(10==s){var l=a.split("	");if(l[this.colSeq-1]==o){var u=parseInt(l[this.colStart-1]),c=u;this.colEnd>0&&(c=parseInt(l[this.colEnd-1])),65536&this.format&&++u,r>=u&&c>=i&&n.push(a)}continue t}a+=String.fromCharCode(s)}return}},i.prototype.fetchHeader=function(t){var e=this;e.data.slice(0,e.headerMax).fetch(function(n){if(!n)return t(null,"Fetch failed");for(var i=new Uint8Array(h(n,n.byteLength)),r=0,o="",a=[];r<i.length;){var s=i[r++];if(10==s){if(o.charCodeAt(0)!=e.meta)return t(a);a.push(o),o=""}else o+=String.fromCharCode(s)}t(a)})},t.exports={connectTabix:r,TABIX_MAGIC:o}},function(t,e,n){"use strict";function i(t,e){return t.indexOf("?")<0&&(t+="?soft=true"),new s(function(n,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState)if(r.status>=300)i("Error code "+r.status);else{var t=JSON.parse(r.response);n(e?t:t.location)}},r.open("GET",t,!0),r.setRequestHeader("Accept","application/json"),r.responseType="text",r.send("")})}function r(t){this.rawurl=t}function o(t,e,n,i){i||("object"==typeof e?(i=e,e=void 0):i={}),this.url="string"==typeof t?new r(t):t,this.start=e||0,n&&(this.end=n),this.opts=i}function a(t){if(!t)return null;for(var e=new Uint8Array(t.length),n=0;n<e.length;++n)e[n]=t.charCodeAt(n);return e.buffer}var s=n(255).Promise;r.prototype.getURLPromise=function(){return this.urlPromise&&this.urlPromiseValidity>Date.now()?this.urlPromise:(this.urlPromise=i(this.rawurl,!0).then(function(t){return t.location}),this.urlPromiseValidity=Date.now()+432e5,this.urlPromise)},o.prototype.slice=function(t,e){if(0>t)throw"Bad slice "+t;var n=this.start,i=this.end;return n&&t?n+=t:n=t||n,i=e&&n?n+e-1:i||e-1,new o(this.url,n,i,this.opts)},o.prototype.fetchAsText=function(t){var e,n=this,i=new XMLHttpRequest;n.url.getURLPromise().then(function(r){if(i.open("GET",r,!0),n.end){if(n.end-n.start>1e8)throw"Monster fetch!";i.setRequestHeader("Range","bytes="+n.start+"-"+n.end),e=n.end-n.start+1}i.onreadystatechange=function(){return 4==i.readyState?t(200==i.status||206==i.status?i.responseText:null):void 0},n.opts.credentials&&(i.withCredentials=!0),i.send("")})["catch"](function(e){return console.log(e),t(null)})},o.prototype.salted=function(){return this},o.prototype.fetch=function(t,e,n){var i=this;return e=e||1,e>3?t(null):void i.url.getURLPromise().then(function(r){var o,s=new XMLHttpRequest;if(s.open("GET",r,!0),s.overrideMimeType("text/plain; charset=x-user-defined"),i.end){if(i.end-i.start>1e8)throw"Monster fetch!";s.setRequestHeader("Range","bytes="+i.start+"-"+i.end),o=i.end-i.start+1}s.responseType="arraybuffer",s.onreadystatechange=function(){if(4==s.readyState){if(200==s.status||206==s.status){if(s.response){var r=s.response.byteLength;return!o||o==r||n&&r==n?t(s.response):i.fetch(t,e+1,r)}if(s.mozResponseArrayBuffer)return t(s.mozResponseArrayBuffer);var l=s.responseText;return!o||o==l.length||n&&l.length==n?t(a(s.responseText)):i.fetch(t,e+1,l.length)}return i.fetch(t,e+1)}},i.opts.credentials&&(s.withCredentials=!0),s.send("")})["catch"](function(t){console.log(t)})},t.exports={lookupEncodeURI:i,EncodeFetchable:o}},function(t,e,n){"use strict";function i(t,e,n){var i=l(n.type,e.type),r=l(n.label,e.label,n.id,e.id);r&&0!=r.indexOf("__dazzle")&&(i=i+": "+r),this.hit=t,this.feature=e,this.group=n,this.title=i,this.sections=[]}function r(t,e){var n=[];if(t)for(var i=0;i<t.length;++i)u(n,t[i]);if(e)for(var i=0;i<e.length;++i)u(n,e[i]);return n}var o=n(247),a=o.Browser,s=n(248),l=s.pick,u=s.pushnew,c=s.makeElement,h=new RegExp("^([A-Za-z_-]+)=(.+)");a.prototype.addFeatureInfoPlugin=function(t){this.featureInfoPlugins||(this.featureInfoPlugins=[]),this.featureInfoPlugins.push(t)},i.prototype.setTitle=function(t){this.title=t},i.prototype.add=function(t,e){"string"==typeof e&&(e=c("span",e)),this.sections.push({label:t,info:e})},a.prototype.featurePopup=function(t,e,n,o){var a=n.length,s=--a>=0?n[a]:{},l=--a>=0?n[a]:{},u=new i(n,s,l);u.tier=o;for(var d=this.featureInfoPlugins||[],f=0;f<d.length;++f)try{d[f](s,u)}catch(p){console.log(p.stack||p)}for(d=o.featureInfoPlugins||[],f=0;f<d.length;++f)try{d[f](s,u)}catch(p){console.log(p.stack||p)}this.removeAllPopups();var _=c("table",null,{className:"table table-striped table-condensed"});_.style.width="100%",_.style.margin="0px";var g=0;if(s.method){var m=c("tr",[c("th","Method"),c("td",s.method)]);_.appendChild(m),++g}var v;v=l.segment?l:s;var m=c("tr",[c("th","Location"),c("td",v.segment+":"+v.min+"-"+v.max,{},{minWidth:"200px"})]);if(_.appendChild(m),++g,void 0!==s.score&&null!==s.score&&"-"!=s.score&&!s.suppressScore){var m=c("tr",[c("th","Score"),c("td",""+s.score)]);_.appendChild(m),++g}var y=r(l.links,s.links);if(y&&y.length>0){var m=c("tr",[c("th","Links"),c("td",y.map(function(t){return c("div",c("a",t.desc,{href:t.uri,target:"_new"}))}))]);_.appendChild(m),++g}for(var b=r(l.notes,s.notes),x=0;x<b.length;++x){var w="Note",S=b[x],A=S.match(h);A&&(w=A[1],S=A[2]);var m=c("tr",[c("th",w),c("td",S)]);_.appendChild(m),++g}for(var k=0;k<u.sections.length;++k){var C=u.sections[k];_.appendChild(c("tr",[c("th",C.label),c("td",C.info)]))}this.popit(t,u.title||"Feature",_,{width:450})}},function(t,e,n){"use strict";var i=n(247),r=i.Browser,o=n(248),a=o.shallowCopy;r.prototype.mergeSelectedTiers=function(){for(var t=[],e=[],n=0;n<this.selectedTiers.length;++n){var i=this.tiers[this.selectedTiers[n]];t.push(a(i.dasSource));for(var r=i.stylesheet.styles,o=0;o<r.length;++o){var s=r[o],l=a(s);l.method=i.dasSource.name.replace(/[()+*?]/g,"\\$&"),l._methodRE=null,l.style=a(s.style),void 0===l.style.ZINDEX&&(l.style.ZINDEX=n),i.forceMin&&(l.style.MIN=i.forceMin),i.forceMax&&(l.style.MAX=i.forceMax),e.push(l)}}this.addTier({name:"Merged",merge:"concat",overlay:t,noDownsample:!0,style:e}),this.setSelectedTier(this.tiers.length-1)}},function(t,e,n){"use strict";function i(t,e){var n=parseFloat(t.replace(/,/g,""));return"k"===e||"K"===e?1e3*n|0:"m"==e||"M"===e?1e6*n|0:0|n}var r=n(247),o=r.Browser,a=n(277),s=a.URLFetchable,l=n(298).connectTrix,u=/^([\d+,\w,\.,\_,\-]+):([0-9,\.]+?)([KkMmGg])?((-|\.\.)+([0-9,\.]+)([KkMmGg])?)?$/;o.prototype.search=function(t,e){var n=this,r=u.exec(t);if(r){var o,a,c=r[1];if(r[6])o=i(r[2],r[3]),a=i(r[6],r[7]);else{var h=this.viewEnd-this.viewStart+1;o=i(r[2],r[3])-h/2|0,a=o+h-1}this.setLocation(c,o,a,e)}else{if(!t||0==t.length)return!1;var d=0,f=!1,p=function(i,r){if(--d,r)return e(r);i||(i=[]);for(var o=5e8,a=-1e8,s=null,l=0;l<i.length;++l){var u=i[l];null==s&&(s=u.segment),o=Math.min(o,u.min),a=Math.max(a,u.max)}if(s){f=!0,n.highlightRegion(s,o,a);var c=Math.max(2500,.3*(a-o+1)|0);n.setLocation(s,o-c,a+c,e)}else if(0==d&&!f)return e("no match for '"+t+"'")},_=function(e,n){n.lookup(t,function(n,i){if(null==n||n.length<2)return e.featureSource.search(t,p);var r=n[1].split(",")[0];return e.featureSource.search(r,p)})};if(this.searchEndpoint)return d=1,this.doDasSearch(n.searchEndpoint,t,p);for(var g=0;g<this.tiers.length;++g)!function(e){n.sourceAdapterIsCapable(e.featureSource,"search")?e.dasSource.trixURI?(++d,e.trix?_(e,e.trix):l(new s(e.dasSource.trixURI),new s(e.dasSource.trixURI+"x"),function(t){e.trix=t,_(e,t)})):(++d,e.featureSource.search(t,p)):e.dasSource.provides_search&&(++d,n.doDasSearch(e.dasSource,t,p))}(this.tiers[g])}},o.prototype.doDasSearch=function(t,e,n){t.features(null,{group:e,type:"transcript"},function(t){t||(t=[]);for(var i=[],r=0;r<t.length;++r){var o=t[r];o.label.toLowerCase()==e.toLowerCase()&&i.push(o)}return n(i)},!1)}},function(t,e,n){"use strict";function i(t,e,n){e.fetchAsText(function(e){if(!e)return n(null,"Couldn't fetch index-index");for(var i=e.split(/(.+)([0-9A-F]{10})\n/),o=[],a=[],s=1;s<i.length;s+=3)o.push(i[s]),a.push(parseInt(i[s+1],16));return n(new r(o,a,t))})}function r(t,e,n){this.keys=t,this.offsets=e,this.ix=n}r.prototype.lookup=function(t,e){for(var n,i=(t+"     ").substring(0,5).toLowerCase(),r=0;r<this.keys.length;++r)if(i.localeCompare(this.keys[r])<0){n=this.ix.slice(this.offsets[r-1],this.offsets[r]-this.offsets[r-1]);break}n||(n=this.ix.slice(this.offsets[this.offsets.length-1])),n.fetchAsText(function(n){for(var i=n.split("\n"),r=0;r<i.length;++r)if(0==i[r].indexOf(t.toLowerCase()+" "))return e(i[r].split(" "));return e(null)})},t.exports={connectTrix:i}},function(t,e,n){"use strict";function i(t,e){nt[t]=e}function r(t,e){it[t]=e}function o(t){return it[t]?it[t](t):void 0}function a(t){var e=this;this.source=t,this.cfsid="cfs"+ ++rt,t.name&&(this.name=t.name),t.addChangeListener&&t.addChangeListener(function(){e.cfsid="cfs"+ ++rt})}function s(){this.busy=0,this.activityListeners=[],this.readinessListeners=[],this.readiness=null}function l(t){this.dasSource=new O(t),this.busy=0,this.activityListeners=[]}function u(t){this.dasSource=new O(t),this.awaitedEntryPoints=new k;var e=this;this.dasSource.entryPoints(function(t){e.awaitedEntryPoints.provide(t)})}function c(t){var e=this;this.source=t,this.twoBit=new k;var n;if(t.twoBitURI)n=new B(t.twoBitURI);else{if(!t.twoBitBlob)throw Error("No twoBitURI or twoBitBlob parameter");n=new z(t.twoBitBlob)}q(n,function(t,n){n?console.log(n):e.twoBit.provide(t)})}function h(t){s.call(this);var e=this;if(this.readiness="Connecting",this.bwgSource=this.opts=t,e.bwgHolder=new k,this.opts.preflight){var n=ot[this.opts.preflight];if(!n){n=new k,ot[this.opts.preflight]=n;var i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&(200==i.status?n.provide("success"):n.provide("failure"))},i.open("get",this.opts.preflight+"?"+hex_sha1("salt"+Date.now()),!0),this.opts.credentials&&(i.withCredentials=!0),i.send("")}n.await(function(t){"success"===t&&e.init()})}else e.init()}function d(t,e){s.call(this);this.worker=e,this.readiness="Connecting",this.bwgSource=this.opts=t,this.keyHolder=new k,this.init()}function f(t,e){if(!(t.flag&W.SEGMENT_UNMAPPED)){var n;if(n=t.seq?t.seq.length:t.seqLength,t.cigar){n=0;for(var i=Z(t.cigar),r=0;r<i.length;++r){var o=i[r];("M"==o.op||"D"==o.op)&&(n+=o.cnt)}}var a=new D;return a.min=t.pos+1,a.max=t.pos+n,a.segment=t.segment,a.type="bam",a.id=t.readName,a.notes=["MQ="+t.mq],a.cigar=t.cigar,a.seq=t.seq,a.quals=t.quals,a.orientation=t.flag&W.REVERSE_COMPLEMENT?"-":"+",a.bamRecord=t,e&&t.flag&W.MULTIPLE_SEGMENTS&&(a.groups=[{id:t.readName,type:"readpair"}]),a}}function p(t){s.call(this);var e=this;if(this.bamSource=t,this.opts={credentials:t.credentials,preflight:t.preflight,bamGroup:t.bamGroup},this.bamHolder=new k,this.opts.preflight){var n=ot[this.opts.preflight];if(!n){n=new k,ot[this.opts.preflight]=n;var i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&(200==i.status?n.provide("success"):n.provide("failure"))},i.open("get",this.opts.preflight+"?"+hex_sha1("salt"+Date.now()),!0),this.opts.credentials&&(i.withCredentials="true"),i.send("")}n.await(function(t){"success"===t&&e.init()})}else e.init()}function _(t,e){s.call(this);this.bamSource=t,this.worker=e,this.opts={credentials:t.credentials,preflight:t.preflight,bamGroup:t.bamGroup},this.keyHolder=new k,this.init()}function g(t,e){this.source=t,this.mapping=e,this.activityListeners=[],this.busy=0}function m(){}function v(){}function y(t){this.store=new J(t.jbURI,t.jbQuery)}var b=n(247),x=b.Browser,w=n(250),S=w.DasTier,A=n(248),k=A.Awaited,C=A.arrayIndexOf,T=A.shallowCopy,E=A.resolveUrlToPage,M=n(251),L=M.DASStylesheet,R=M.DASStyle,O=M.DASSource,P=M.DASSegment,D=M.DASFeature,I=M.DASSequence,N=M.DASLink,F=n(277),B=F.URLFetchable,z=F.BlobFetchable,H=n(300),q=H.makeTwoBit,G=n(278),j=G.makeBwg,U=n(292),V=U.makeBam,W=U.BamFlags,X=n(269),K=X.Range,Y=X.union,Z=n(271).parseCigar,$=n(301).OverlayFeatureSource,J=n(302).JBrowseStore,Q=n(276).Chainset,tt=n(253),et=(tt.StyleFilterSet,n(294).EncodeFetchable),nt={},it={};S.prototype.initSources=function(){var t=this,e=this.browser.createSources(this.dasSource);this.featureSource=e.features||new m,this.sequenceSource=e.sequence,this.featureSource&&this.featureSource.addChangeListener&&this.featureSource.addChangeListener(function(){t.browser.refreshTier(t)})},x.prototype.createSources=function(t){var e=this.sourceCache.get(t);if(e)return e;var n,i;if("sequence"==t.tier_type||t.twoBitURI||t.twoBitBlob)i=t.twoBitURI||t.twoBitBlob?new c(t):new u(t);else if(t.tier_type&&nt[t.tier_type]){var r=nt[t.tier_type],o=r(t);n=o.features,i=o.sequence}else if(t.bwgURI||t.bwgBlob){var s=this.getWorker();n=s?new d(t,s):new h(t)}else if(t.bamURI||t.bamBlob){var s=this.getWorker();n=s?new _(t,s):new p(t)}else t.jbURI?n=new y(t):(t.uri||t.features_uri)&&(n=new l(t));if(t.overlay){var e=[];n&&e.push(new a(n));for(var f=0;f<t.overlay.length;++f){var m=this.createSources(t.overlay[f]);m&&m.features&&e.push(m.features)}n=new $(e,t)}return t.sequenceAliases&&(n=new g(n,new Q({type:"alias",sequenceAliases:t.sequenceAliases}))),t.mapping&&(n=new g(n,this.chains[t.mapping])),t.name&&n&&!n.name&&(n.name=t.name),null!=n&&(n=new a(n)),(null!=n||null!=i)&&(e={features:n,sequence:i},this.sourceCache.put(t,e)),e},S.prototype.fetchStylesheet=function(t){var e;e=!this.dasSource.stylesheet_uri&&(this.dasSource.tier_type||this.dasSource.bwgURI||this.dasSource.bwgBlob||this.dasSource.bamURI||this.dasSource.bamBlob||this.dasSource.twoBitURI||this.dasSource.twoBitBlob||this.dasSource.jbURI||this.dasSource.overlay)?this.getSource():new l(this.dasSource),e.getStyleSheet(t)};var rt=0;a.prototype.addReadinessListener=function(t){return this.source.addReadinessListener?this.source.addReadinessListener(t):void t(null)},a.prototype.removeReadinessListener=function(t){return this.source.removeReadinessListener?this.source.removeReadinessListener(t):void 0},a.prototype.search=function(t,e){return this.source.search?this.source.search(t,e):void 0},a.prototype.getDefaultFIPs=function(t){return this.source.getDefaultFIPs?this.source.getDefaultFIPs(t):void 0},a.prototype.getStyleSheet=function(t){this.source.getStyleSheet(t)},a.prototype.getScales=function(){return this.source.getScales()},a.prototype.addActivityListener=function(t){this.source.addActivityListener&&this.source.addActivityListener(t)},a.prototype.removeActivityListener=function(t){this.source.removeActivityListener&&this.source.removeActivityListener(t)},a.prototype.addChangeListener=function(t){this.source.addChangeListener&&this.source.addChangeListener(t)},a.prototype.removeChangeListener=function(t){this.source.removeChangeListener&&this.source.removeChangeListener(t)},a.prototype.findNextFeature=function(t,e,n,i){this.source.findNextFeature(t,e,n,i)},a.prototype.quantFindNextFeature=function(t,e,n,i,r){this.source.quantFindNextFeature(t,e,n,i,r)},a.prototype.capabilities=function(){return this.source.capabilities?this.source.capabilities():{}},a.prototype.fetch=function(t,e,n,i,r,o,a,s){if(!o)throw Error("Fetch pool is null");var l=this,u=this.cfsid,c=o.awaitedFeatures[u];if(c&&c.started){if(c.styleFilters.doesNotContain(s))return void l.source.fetch(t,e,n,i,r,o,a,s)}else c?c.styleFilters.addAll(s):(c=new k,c.styleFilters=s,o.awaitedFeatures[u]=c,o.requestsIssued.then(function(){c.started=!0,l.source.fetch(t,e,n,i,c.styleFilters.typeList(),o,function(t,e,n,i){c.res||c.provide({status:t,features:e,scale:n,coverage:i})},c.styleFilters)})["catch"](function(t){console.log(t)}));c.await(function(t){a(t.status,t.features,t.scale,t.coverage)})},s.prototype.addReadinessListener=function(t){this.readinessListeners.push(t),t(this.readiness)},s.prototype.removeReadinessListener=function(t){var e=C(this.readinessListeners,t);e>=0&&this.readinessListeners.splice(e,1)},s.prototype.notifyReadiness=function(){for(var t=0;t<this.readinessListeners.length;++t)try{this.readinessListeners[t](this.readiness)}catch(e){console.log(e)}},s.prototype.addActivityListener=function(t){this.activityListeners.push(t)},s.prototype.removeActivityListener=function(t){var e=C(this.activityListeners,t);e>=0&&this.activityListeners.splice(e,1)},s.prototype.notifyActivity=function(){for(var t=0;t<this.activityListeners.length;++t)try{this.activityListeners[t](this.busy)}catch(e){console.log(e)}},s.prototype.getScales=function(){return null},s.prototype.fetch=function(t,e,n,i,r,o,a){return a(null,[],1e9)},s.prototype.getStyleSheet=function(t){var e=new L,n=new R;return n.glyph="BOX",n.BGCOLOR="blue",n.FGCOLOR="black",e.pushStyle({type:"default"},null,n),t(e)},l.prototype.addActivityListener=function(t){this.activityListeners.push(t)},l.prototype.removeActivityListener=function(t){var e=C(this.activityListeners,t);e>=0&&this.activityListeners.splice(e,1)},l.prototype.notifyActivity=function(){for(var t=0;t<this.activityListeners.length;++t)try{this.activityListeners[t](this.busy)}catch(e){console.log(e)}},l.prototype.getStyleSheet=function(t){this.dasSource.stylesheet(function(e){t(e)},function(){t(null,"Couldn't fetch DAS stylesheet")})},l.prototype.fetch=function(t,e,n,i,r,o,a){if(r&&0==r.length)return void a(null,[],i);if(this.dasSource.uri||this.dasSource.features_uri){if(this.dasSource.dasStaticFeatures&&this.cachedStaticFeatures)return a(null,this.cachedStaticFeatures,this.cachedStaticScale);var s=this.dasSource.maxbins!==!1,l={type:r};s&&(l.maxbins=1+((n-e)/i|0));var u=this;u.busy++,u.notifyActivity(),this.dasSource.features(new P(t,e,n),l,function(t,e){u.busy--,u.notifyActivity();var n=i;s||(n=.1),!e&&u.dasSource.dasStaticFeatures&&(u.cachedStaticFeatures=t,u.cachedStaticScale=n),a(e,t,n)})}},l.prototype.findNextFeature=this.sourceFindNextFeature=function(t,e,n,i){if(this.dasSource.capabilities&&C(this.dasSource.capabilities,"das1:adjacent-feature")>=0){var r=this;if(this.dasAdjLock)return console.log("Already looking for a next feature, be patient!");this.dasAdjLock=!0;var o={adjacent:t+":"+(0|e)+":"+(n>0?"F":"B")},a=thisTier.getDesiredTypes(thisTier.browser.scale);a&&(o.types=a),thisTier.dasSource.features(null,o,function(t){r.dasAdjLock=!1,t.length>0&&null!=t[0]&&i(t[0])})}},u.prototype.fetch=function(t,e,n,i,r){this.dasSource.sequence(new P(t,e,n),function(t){return 1==t.length?r(null,t[0]):r("Didn't get sequence")})},u.prototype.getSeqInfo=function(t,e){this.awaitedEntryPoints.await(function(n){for(var i=0;i<n.length;++i)if(n[i].name==t)return e({length:n[i].end});return e()})},c.prototype.fetch=function(t,e,n,i,r){this.twoBit.await(function(i){i.fetch(t,e,n,function(i,o){if(o)return r(o,null);var a=new I(t,e,n,"DNA",i);return r(null,a)})})},c.prototype.getSeqInfo=function(t,e){this.twoBit.await(function(n){var i=n.getSeq(t);i?n.getSeq(t).length(function(t){e({length:t})}):e()})},l.prototype.getScales=function(){return[]};var ot={};h.prototype=Object.create(s.prototype),h.prototype.init=function(){var t,e=this,n=this.bwgSource.uri||this.bwgSource.bwgURI;t=n?"encode"===this.bwgSource.transport?new et(n,{credentials:this.opts.credentials}):new B(n,{credentials:this.opts.credentials}):new z(this.bwgSource.bwgBlob),j(t,function(t,n){n?(e.error=n,e.readiness=null,e.notifyReadiness(),e.bwgHolder.provide(null)):(e.bwgHolder.provide(t),e.readiness=null,e.notifyReadiness(),"bigbed"==t.type&&t.getExtraIndices(function(t){e.extraIndices=t}))})},h.prototype.capabilities=function(){var t={leap:!0};if(this.bwgHolder.res&&"bigwig"==this.bwgHolder.res.type&&(t.quantLeap=!0),this.extraIndices&&this.extraIndices.length>0){t.search=[];for(var e=0;e<this.extraIndices.length;++e)t.search.push(this.extraIndices[e].field)}return t},h.prototype.fetch=function(t,e,n,i,r,o,a){var s=this;this.bwgHolder.await(function(o){if(null==o)return a(s.error||"Can't access binary file",null,null);var l,u=!r||0==r.length||C(r,"density")>=0;if(s.opts.clientBin&&(u=!1),"bigwig"==o.type||u||"undefined"!=typeof s.opts.forceReduction){for(var c=-1,h=0;h<o.zoomLevels.length&&o.zoomLevels[h].reduction<=i;++h)c=h;"undefined"!=typeof s.opts.forceReduction&&(c=s.opts.forceReduction),l=0>c?o.getUnzoomedView():o.getZoomedView(c)}else l=o.getUnzoomedView();s.busy++,s.notifyActivity(),l.readWigData(t,e,n,function(t){s.busy--,s.notifyActivity();var i=1e9;if("bigwig"===o.type){var r=(n-e)/t.length/2;i>r&&(i=r)}if(s.opts.link)for(var l=0;l<t.length;++l){var u=t[l];u.label&&(u.links=[new N("Link",s.opts.link.replace(/\$\$/,u.label))])}a(null,t,i)})})},h.prototype.quantFindNextFeature=function(t,e,n,i,r){var o=this;o.busy++,o.notifyActivity(),this.bwgHolder.res.thresholdSearch(t,e,n,i,function(t,e){return o.busy--,o.notifyActivity(),r(t,e)})},h.prototype.findNextFeature=function(t,e,n,i){var r=this;r.busy++,r.notifyActivity(),this.bwgHolder.res.getUnzoomedView().getFirstAdjacent(t,e,n,function(t){r.busy--,r.notifyActivity(),t.length>0&&null!=t[0]&&i(t[0])})},h.prototype.getScales=function(){var t=this.bwgHolder.res;if(t){for(var e=[1],n=0;n<t.zoomLevels.length;++n)e.push(t.zoomLevels[n].reduction);return e}return null},h.prototype.search=function(t,e){if(!this.extraIndices||0==this.extraIndices.length)return e(null,"No indices available");var n=this.extraIndices[0];return n.lookup(t,e)},h.prototype.getDefaultFIPs=function(t){return this.opts.noExtraFeatureInfo?!0:void this.bwgHolder.await(function(e){if(e&&e.schema&&e.definedFieldCount<e.schema.fields.length){var n=function(t,n){for(var i=0;i<n.hit.length;++i)if(n.hit[i].isSuperGroup)return;for(var r=e.definedFieldCount;r<e.schema.fields.length;++r){var o=e.schema.fields[r];n.add(o.comment,t[o.name])}};t(n)}})},h.prototype.getStyleSheet=function(t){this.bwgHolder.await(function(e){if(!e)return t(null,"bbi error");var n=new L;if("bigbed"==e.type){var i=new R;i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="blue",i.HEIGHT=8,i.BUMP=!0,i.LABEL=!0,i.ZINDEX=20,n.pushStyle({type:"bigwig"},null,i),i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="red",i.HEIGHT=10,i.BUMP=!0,i.ZINDEX=20,n.pushStyle({type:"translation"},null,i);var r=new R;r.glyph="BOX",r.FGCOLOR="black",r.BGCOLOR="white",r.HEIGHT=10,r.ZINDEX=10,r.BUMP=!0,r.LABEL=!0,n.pushStyle({type:"transcript"},null,r);var o=new R;o.glyph="HISTOGRAM",o.COLOR1="white",o.COLOR2="black",o.HEIGHT=30,n.pushStyle({type:"density"},null,o)}else{var i=new R;i.glyph="HISTOGRAM",i.COLOR1="white",i.COLOR2="black",i.HEIGHT=30,n.pushStyle({type:"default"},null,i)}return 12==e.definedFieldCount&&e.fieldCount>=14&&(n.geneHint=!0),t(n)})},d.prototype=Object.create(s.prototype),d.prototype.init=function(){var t=this,e=this.uri||this.bwgSource.uri||this.bwgSource.bwgURI,n=this.bwgSource.blob||this.bwgSource.bwgBlob,i=function(e,n){t.readiness=null,t.notifyReadiness(),e?t.worker.postCommand({command:"meta",connection:e},function(n,i){i?(t.error=i,t.keyHolder.provide(null)):(t.meta=n,t.keyHolder.provide(e))}):(t.error=n,t.keyHolder.provide(null))};n?this.worker.postCommand({command:"connectBBI",blob:n},i):this.worker.postCommand({command:"connectBBI",uri:E(e),transport:this.bwgSource.transport,credentials:this.bwgSource.credentials},i)},d.prototype.capabilities=function(){var t={leap:!0};if(this.meta&&"bigwig"==this.meta.type&&(t.quantLeap=!0),this.meta&&this.meta.extraIndices&&this.meta.extraIndices.length>0){t.search=[];for(var e=0;e<this.meta.extraIndices.length;++e)t.search.push(this.meta.extraIndices[e].field)}return t},d.prototype.fetch=function(t,e,n,i,r,o,a){var s=this;s.busy++,s.notifyActivity(),this.keyHolder.await(function(o){if(!o)return s.busy--,s.notifyActivity(),a(s.error||"Can't access binary file",null,null);var l=-1,u=!r||0==r.length||C(r,"density")>=0;if(s.opts.clientBin&&(u=!1),"bigwig"==s.meta.type||u||"undefined"!=typeof s.opts.forceReduction){for(var c=1;c<s.meta.zoomLevels.length&&s.meta.zoomLevels[c]<=i;++c)l=c-1;"undefined"!=typeof s.opts.forceReduction&&(l=s.opts.forceReduction)}s.worker.postCommand({command:"fetch",connection:o,chr:t,min:e,max:n,zoom:l},function(t,i){s.busy--,s.notifyActivity();var r=1e9;if("bigwig"===s.meta.type){var o=(n-e)/t.length/2;r>o&&(r=o)}if(s.opts.link)for(var l=0;l<t.length;++l){var u=t[l];u.label&&(u.links=[new N("Link",s.opts.link.replace(/\$\$/,u.label))])}a(i,t,r)})})},d.prototype.quantFindNextFeature=function(t,e,n,i,r){var o=this;this.busy++,this.notifyActivity(),this.worker.postCommand({command:"quantLeap",connection:this.keyHolder.res,chr:t,pos:e,dir:n,threshold:i,under:!1},function(t,e){return console.log(t,e),o.busy--,o.notifyActivity(),r(t,e)})},d.prototype.findNextFeature=function(t,e,n,i){var r=this;this.busy++,this.notifyActivity(),this.worker.postCommand({command:"leap",connection:this.keyHolder.res,chr:t,pos:e,dir:n},function(t,e){r.busy--,r.notifyActivity(),t.length>0&&null!=t[0]&&i(t[0])})},d.prototype.getScales=function(){var t=this.meta;return t?t.zoomLevels:null},d.prototype.search=function(t,e){if(!this.meta.extraIndices||0==this.meta.extraIndices.length)return e(null,"No indices available");var n=this;this.busy++,this.notifyActivity();var i=this.meta.extraIndices[0];this.worker.postCommand({command:"search",connection:this.keyHolder.res,query:t,index:i},function(t,i){n.busy--,n.notifyActivity(),e(t,i)})},d.prototype.getDefaultFIPs=function(t){if(this.opts.noExtraFeatureInfo)return!0;var e=this;this.keyHolder.await(function(n){var i=e.meta;if(i&&i.schema&&i.definedFieldCount<i.schema.fields.length){var r=function(t,e){for(var n=0;n<e.hit.length;++n)if(e.hit[n].isSuperGroup)return;for(var r=i.definedFieldCount;r<i.schema.fields.length;++r){var o=i.schema.fields[r];e.add(o.comment,t[o.name])}};t(r)}})},d.prototype.getStyleSheet=function(t){var e=this;this.keyHolder.await(function(n){var i=e.meta;if(!i)return t(null,"bbi error");var r=new L;if("bigbed"==i.type){var o=new R;o.glyph="BOX",o.FGCOLOR="black",o.BGCOLOR="blue",o.HEIGHT=8,o.BUMP=!0,o.LABEL=!0,o.ZINDEX=20,r.pushStyle({type:"bigwig"},null,o),o.glyph="BOX",o.FGCOLOR="black",o.BGCOLOR="red",o.HEIGHT=10,o.BUMP=!0,o.ZINDEX=20,r.pushStyle({type:"translation"},null,o);var a=new R;a.glyph="BOX",a.FGCOLOR="black",a.BGCOLOR="white",a.HEIGHT=10,a.ZINDEX=10,a.BUMP=!0,a.LABEL=!0,r.pushStyle({type:"transcript"},null,a);var s=new R;s.glyph="HISTOGRAM",s.COLOR1="white",s.COLOR2="black",s.HEIGHT=30,r.pushStyle({type:"density"},null,s)}else{var o=new R;o.glyph="HISTOGRAM",o.COLOR1="white",o.COLOR2="black",o.HEIGHT=30,r.pushStyle({type:"default"},null,o)}return 12==i.definedFieldCount&&i.fieldCount>=14&&(r.geneHint=!0),t(r)})},p.prototype=Object.create(s.prototype),p.prototype.init=function(){var t,e,n=this;this.bamSource.bamBlob?(t=new z(this.bamSource.bamBlob),e=new z(this.bamSource.baiBlob)):(t=new B(this.bamSource.bamURI,{credentials:this.opts.credentials}),e=new B(this.bamSource.baiURI||this.bamSource.bamURI+".bai",{credentials:this.opts.credentials})),V(t,e,null,function(t,e){n.readiness=null,n.notifyReadiness(),t?n.bamHolder.provide(t):(n.error=e,n.bamHolder.provide(null))})},p.prototype.fetch=function(t,e,n,i,r,o,a){var s=r&&1==r.length&&"density"==r[0],l=this;l.busy++,l.notifyActivity(),this.bamHolder.await(function(i){return i?void i.fetch(t,e,n,function(t,e){if(l.busy--,l.notifyActivity(),e)a(e,null,null);else{for(var n=[],i=0;i<t.length;++i){var r=t[i],o=f(r,l.opts.bamGroup);o&&n.push(o)}a(null,n,1e9)}},{light:s}):(l.busy--,l.notifyActivity(),a(l.error||"Couldn't fetch BAM"))})},p.prototype.getScales=function(){return 1e9},p.prototype.getStyleSheet=function(t){this.bamHolder.await(function(e){var n=new L,i=new R;i.glyph="HISTOGRAM",i.COLOR1="black",i.COLOR2="red",i.HEIGHT=30,n.pushStyle({type:"density"},"low",i),n.pushStyle({type:"density"},"medium",i);var r=new R;return r.glyph="__SEQUENCE",r.FGCOLOR="black",r.BGCOLOR="blue",r.HEIGHT=8,r.BUMP=!0,r.LABEL=!1,r.ZINDEX=20,n.pushStyle({type:"bam"},"high",r),t(n)})},_.prototype=Object.create(s.prototype),_.prototype.init=function(){var t=this,e=this.bamSource.uri||this.bamSource.bamURI,n=this.bamSource.indexUri||this.bamSource.baiURI||e+".bai",i=this.bamSource.bamBlob||this.bamSource.blob,r=this.bamSource.baiBlob||this.bamSource.indexBlob,o=function(e,n){t.readiness=null,t.notifyReadiness(),e?t.keyHolder.provide(e):(t.error=n,t.keyHolder.provide(null))};i?this.worker.postCommand({command:"connectBAM",blob:i,indexBlob:r},o):this.worker.postCommand({command:"connectBAM",uri:E(e),indexUri:E(n),credentials:this.bamSource.credentials,indexChunks:this.bamSource.indexChunks},o)},_.prototype.fetch=function(t,e,n,i,r,o,a){var s=r&&1==r.length&&"density"==r[0],l=this;l.busy++,l.notifyActivity(),this.keyHolder.await(function(i){return i?void l.worker.postCommand({command:"fetch",connection:i,chr:t,min:e,max:n,opts:{light:s}},function(t,e){if(l.busy--,l.notifyActivity(),e)a(e,null,null);else{for(var n=[],i=0;i<t.length;++i){var r=t[i],o=f(r,l.opts.bamGroup);o&&n.push(o)}a(null,n,1e9)}}):(l.busy--,l.notifyActivity(),a(l.error||"Couldn't fetch BAM"))})},_.prototype.getScales=function(){return 1e9},_.prototype.getStyleSheet=function(t){this.keyHolder.await(function(e){var n=new L,i=new R;i.glyph="HISTOGRAM",i.COLOR1="black",i.COLOR2="red",i.HEIGHT=30,n.pushStyle({type:"density"},"low",i),n.pushStyle({type:"density"},"medium",i);var r=new R;return r.glyph="__SEQUENCE",r.FGCOLOR="black",r.BGCOLOR="blue",r.HEIGHT=8,r.BUMP=!0,r.LABEL=!1,r.ZINDEX=20,n.pushStyle({type:"bam"},"high",r),t(n)})},g.prototype.addActivityListener=function(t){this.activityListeners.push(t)},g.prototype.removeActivityListener=function(t){var e=C(this.activityListeners,t);e>=0&&this.activityListeners.splice(e,0)},g.prototype.notifyActivity=function(){for(var t=0;t<this.activityListeners.length;++t)try{this.activityListeners[t](this.busy)}catch(e){console.log(e)}},g.prototype.getStyleSheet=function(t){return this.source.getStyleSheet(t)},g.prototype.getScales=function(){return this.source.getScales()},g.prototype.getDefaultFIPs=function(t){return this.source.getDefaultFIPs?this.source.getDefaultFIPs(t):void 0},g.prototype.simplifySegments=function(t,e){if(0==t.length)return t;t.sort(function(t,e){var n=t.name-e.name;return n?n:(n=t.start-e.start,n?n:t.end-e.end)});for(var n=[],i=t[0],r=0;r<t.length;++r){var o=t[r];o.name!=i.name||o.start>i.end+e?(n.push(i),i=o):i=new P(i.name,Math.min(i.start,o.start),Math.max(i.end,o.end))}return n.push(i),n},g.prototype.fetch=function(t,e,n,i,r,o,a,s){var l=this,u=n-e+1;l.busy++,l.notifyActivity(),this.mapping.sourceBlocksForRange(t,e,n,function(t){if(0==t.length)l.busy--,l.notifyActivity(),a("No mapping available for this regions",[],i);else{t=l.simplifySegments(t,Math.max(100,.05*u));var e,n=[],c=null,h=t.length;t.map(function(t){l.source.fetch(t.name,t.start,t.end,i,r,o,function(i,r,o){if(i&&!e&&(e=i),r)for(var s=0;s<r.length;++s){var u=r[s],d=u.segment;0==d.indexOf("chr")&&(d=d.substr(3));var f=l.mapping.mapSegment(d,u.min,u.max);if(0==f.length)u.parts&&u.parts.length>0&&n.push(u);else for(var p=0;p<f.length;++p){var _=f[p],g=T(u);g.segment=_.segment,g.min=_.min,g.max=_.max,_.partialMin&&(g.partialMin=_.partialMin),_.partialMax&&(g.partialMax=_.partialMax),_.flipped&&("-"==u.orientation?g.orientation="+":"+"==u.orientation&&(g.orientation="-")),n.push(g)}}var m=l.mapping.mapPoint(t.name,t.start),v=l.mapping.mapPoint(t.name,t.end);if(m&&v){var y=new K(m.pos,v.pos);c=c?Y(c,y):y}--h,0==h&&(l.busy--,l.notifyActivity(),a(e,n,o,c))},s)})}})},m.prototype.getScales=function(){return null},m.prototype.fetch=function(t,e,n,i,r,o,a){
return a(null,[],1e9)},m.prototype.getStyleSheet=function(t){var e=new L,n=new R;return n.glyph="BOX",n.BGCOLOR="blue",n.FGCOLOR="black",e.pushStyle({type:"default"},null,n),t(e)},v.prototype.fetch=function(t,e,n,i,r){return r(null,null)},y.prototype.getScales=function(){return null},y.prototype.getStyleSheet=function(t){var e=new L,n=new R;return n.glyph="BOX",n.FGCOLOR="black",n.BGCOLOR="green",n.HEIGHT=8,n.BUMP=!0,n.LABEL=!0,n.ZINDEX=20,e.pushStyle({type:"default"},null,n),t(e)},y.prototype.fetch=function(t,e,n,i,r,o,a){if(r&&0==r.length)return void a(null,[],i);var s={};this.store.features(new P(t,e,n),s,function(t,e){a(e,t,1e5)})},x.prototype.sourceAdapterIsCapable=function(t,e){return t.capabilities?t.capabilities()[e]:!1},t.exports={FeatureSourceBase:s,TwoBitSequenceSource:c,DASSequenceSource:u,MappedFeatureSource:g,CachingFeatureSource:a,BWGFeatureSource:h,RemoteBWGFeatureSource:d,BAMFeatureSource:p,RemoteBAMFeatureSource:_,DummyFeatureSource:m,DummySequenceSource:v,registerSourceAdapterFactory:i,registerParserFactory:r,makeParser:o},n(303),n(304),n(305),n(306),n(307)},function(t,e,n){"use strict";function i(){}function r(t,e){var n=new i;n.data=t;var r=12500;n.data.slice(0,r).fetch(function(t){if(!t)return e(null,"Couldn't access data");var i=new Uint8Array(t),a=s(i,0);if(a==f)n.readInt=s;else{if(a!=p)return e(null,"Not a .2bit file, magic=0x"+a.toString(16));n.readInt=l}var u=n.readInt(i,4);if(0!=u)return e(null,"Unsupported version "+u);n.seqCount=n.readInt(i,8),n.seqDict={};var c=16,h=0,d=0,_=function(){for(;h<n.seqCount;){var t=i[c];if(c+t+6>=i.length)return n.data.slice(d+c,r).fetch(function(t){d+=c,c=0,i=new Uint8Array(t),_()});++c;for(var a="",s=1;t>=s;++s)a+=String.fromCharCode(i[c++]);var l=n.readInt(i,c);c+=4,n.seqDict[a]=new o(n,l),++h}return e(n)};_()})}function o(t,e){this.tbf=t,this.offset=e}var a=n(277),s=a.readInt,l=a.readIntBE,u=n(269),c=u.Range,h=u.union,d=u.intersection,f=440477507,p=1126646042;i.prototype.getSeq=function(t){var e=this.seqDict[t];return e||(e=this.seqDict["chr"+t]),e},i.prototype.fetch=function(t,e,n,i){var r=this.getSeq(t);return r?e>=n?i(""):void r.fetch(e,n,i):i(null,"Couldn't find "+t)},o.prototype.init=function(t){if(this.seqOffset)return t();var e=this;e.tbf.data.slice(e.offset,8).fetch(function(n){if(!n)return t("Fetch failed");var i=new Uint8Array(n);e._length=e.tbf.readInt(i,0),e.nBlockCnt=e.tbf.readInt(i,4),e.tbf.data.slice(e.offset+8,8*e.nBlockCnt+4).fetch(function(n){if(!n)return t("Fetch failed");for(var i=new Uint8Array(n),r=null,o=0;o<e.nBlockCnt;++o){var a=e.tbf.readInt(i,4*o),s=e.tbf.readInt(i,4*(o+e.nBlockCnt)),l=new c(a,a+s-1);r=r?h(r,l):l}return e.nBlocks=r,e.mBlockCnt=e.tbf.readInt(i,8*e.nBlockCnt),e.seqLength=(e._length+3)/4|0,e.seqOffset=e.offset+16+8*(e.nBlockCnt+e.mBlockCnt),t()})})};var _=["T","C","A","G"];o.prototype.fetch=function(t,e,n){--t,--e;var i=this;this.init(function(r){if(r)return n(null,r);var o=t>>2,a=e+3>>2;return 0>o||a>i.seqLength?n("Coordinates out of bounds: "+t+":"+e):void i.tbf.data.slice(i.seqOffset+o,a-o).salted().fetch(function(r){function a(t){for(;t>=f;){var e,n=(f>>2)-o,i=3&f,r=s[n];e=0==i?r>>6&3:1==i?r>>4&3:2==i?r>>2&3:3&r,h+=_[e],++f}}if(null==r)return n("SeqFetch failed");var s=new Uint8Array(r),l=[];if(i.nBlocks){var u=d(new c(t,e),i.nBlocks);u&&(l=u.ranges())}for(var h="",f=t,p=0;p<l.length;++p){var g=l[p];if(f>g.min())throw"N mismatch...";for(f<g.min()&&a(g.min()-1);f<=g.max();)h+="N",++f}return e>=f&&a(e),n(h)})})},o.prototype.length=function(t){var e=this;this.init(function(n){return n?t(null,n):t(e._length)})},t.exports={makeTwoBit:r}},function(t,e,n){"use strict";function i(t,e){this.sources=t,this.opts=e||{},this.activityListeners=[],this.readinessListeners=[],this.changeListeners=[],this.business=[],this.readiness=[];for(var n=0;n<this.sources.length;++n)this.initN(n);"function"==typeof e.merge?this.merge=e.merge:"concat"==e.merge?this.merge=a:"alternates"==e.merge?(this.merge=a,this.filterDispatchOnMethod=!0):this.merge=o}function r(t,e,n){this.source=t,this.callback=e,this.sources=n,this.count=n.length,this.returnCount=0,this.statusCount=0,this.returns=[],this.features=[],this.statuses=[],this.scale=null}function o(t){for(var e=[],n=1;n<t.length;++n){for(var i={},r=t[n],o=0;o<r.length;++o)i[this.keyForFeature(r[o])]=r[o];e.push(i)}for(var a=[],s=t[0],o=0;o<s.length;++o){for(var l=s[o],u=0;u<e.length;++u){var i=e[u];if(r=i[this.keyForFeature(l)])for(var c in r)"score"===c?l.score2=r.score:"min"===c||"max"===c||"segment"===c||"_cachedStyle"===c||(l[c]=r[c])}a.push(l)}return a}function a(t,e){for(var n=[],i=0;i<t.length;++i)for(var r=t[i],o=e[i].name,a=0;a<r.length;++a){var s=r[a];s.method=o,n.push(s)}return n}function s(t,e){return t.capabilities?t.capabilities()[e]:!1}var l=n(248),u=l.shallowCopy,c=l.arrayIndexOf;i.prototype.initN=function(t){var e=this.sources[t],n=this;this.business[t]=0,e.addActivityListener&&e.addActivityListener(function(e){n.business[t]=e,n.notifyActivity()}),e.addChangeListener&&e.addChangeListener(function(){n.notifyChange()}),e.addReadinessListener&&e.addReadinessListener(function(e){n.readiness[t]=e,n.notifyReadiness()})},i.prototype.addReadinessListener=function(t){this.readinessListeners.push(t),this.notifyReadinessListener(t)},i.prototype.removeReadinessListener=function(t){var e=c(this.readinessListeners,t);e>=0&&this.readinessListeners.splice(e,1)},i.prototype.notifyReadiness=function(){for(var t=0;t<this.readinessListeners.length;++t)this.notifyReadinessListener(this.readinessListeners[t])},i.prototype.notifyReadinessListener=function(t){for(var e=null,n=0;n<this.readiness.length;++n)if(null!=this.readiness[n]){e=this.readiness[n];break}try{t(e)}catch(i){console.log(i)}},i.prototype.addActivityListener=function(t){this.activityListeners.push(t)},i.prototype.removeActivityListener=function(t){var e=c(this.activityListeners,t);e>=0&&this.activityListeners.splice(e,1)},i.prototype.notifyActivity=function(){for(var t=0,e=0;e<this.business.length;++e)t+=this.business[e];for(var n=0;n<this.activityListeners.length;++n)try{this.activityListeners[n](t)}catch(i){console.log(i)}},i.prototype.addChangeListener=function(t){this.changeListeners.push(t)},i.prototype.removeChangeListener=function(t){var e=c(this.changeListeners,t);e>=0&&this.changeListeners.splice(e,1)},i.prototype.notifyChange=function(){for(var t=0;t<this.changeListeners.length;++t)try{this.changeListeners[t](this.busy)}catch(e){console.log(e)}},i.prototype.getScales=function(){return this.sources[0].getScales()},i.prototype.getStyleSheet=function(t){return this.sources[0].getStyleSheet(t)},i.prototype.capabilities=function(){var t={},e=this.sources[0];e.capabilities&&(t=u(e.capabilities()));for(var n=1;n<this.sources.length;++n){var i=this.sources[n];if(i.capabilities){var r=i.capabilities();r.search&&(t.search=r.search)}}return t},i.prototype.search=function(t,e){for(var n=0;n<this.sources.length;++n)if(s(this.sources[n],"search"))return this.sources[n].search(t,e)},i.prototype.fetch=function(t,e,n,i,o,a,s,l){var u;if(this.filterDispatchOnMethod){u=[];for(var c=l.list(),h=0;h<this.sources.length;++h)for(var d=this.sources[h],f=0;f<c.length;++f){var p=c[f];if(!p.method||p.method==d.name){u.push(d);break}}}else u=this.sources;for(var _=new r(this,s,u),h=0;h<u.length;++h)this.fetchN(_,h,u[h],t,e,n,i,o,a,l)},i.prototype.fetchN=function(t,e,n,i,r,o,a,s,l,u){n.fetch(i,r,o,a,s,l,function(n,i,r){return t.completed(e,n,i,r)},u)},i.prototype.quantFindNextFeature=function(t,e,n,i,r){return this.sources[0].quantFindNextFeature(t,e,n,i,r)},i.prototype.findNextFeature=function(t,e,n,i){return this.sources[0].findNextFeature(t,e,n,i)},r.prototype.completed=function(t,e,n,i){if((null==this.scale||0==t)&&(this.scale=i),this.returns[t])throw"Multiple returns for source "+t;if(this.returns[t]=!0,this.returnCount++,this.features[t]=n,e&&(this.statuses[t]=e,this.statusCount++),this.returnCount==this.count){if(this.statusCount>0){for(var r="",o=0;o<this.count;++o){var a=this.statuses[o];a&&(r.length>0&&(r+=", "),r+=a)}return this.callback(r,null,this.scale)}this.callback(null,this.source.merge(this.features,this.sources),this.scale)}},i.prototype.getDefaultFIPs=function(t){for(var e=0;e<this.sources.length;++e){var n=this.sources[e];n.getDefaultFIPs&&n.getDefaultFIPs(t)}},i.prototype.keyForFeature=function(t){return""+t.min+".."+t.max},t.exports={OverlayFeatureSource:i}},function(t,e,n){function i(t,e){this.base=t,this.query=e}var r=n(251),o=(r.DASStylesheet,r.DASStyle,r.DASFeature);r.DASGroup;i.prototype.features=function(t,e,n){e=e||{},url=this.base+"/features/"+t.name;var i=[];this.query&&i.push(this.query),t.isBounded&&(i.push("start="+t.start),i.push("end="+t.end)),i.length>0&&(url=url+"?"+i.join("&"));var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState)if(r.status>=300)n(null,"Error code "+r.status);else{var e=JSON.parse(r.response).features,i=[];for(fi=0;fi<e.length;++fi){var a=e[fi],s=new o;s.segment=t,s.min=(0|a.start)+1,s.max=0|a.end,a.name&&(s.label=a.name),s.type=a.type||"unknown",i.push(s)}n(i)}},r.open("GET",url,!0),r.responseType="text",r.send("")},t.exports={JBrowseStore:i}},function(t,e,n){"use strict";function i(t){if(a.call(this),this.source=t,this.base=t.uri||"//rest.ensembl.org",0===this.base.indexOf("//")){var e=window.location.protocol;"http:"==e||"https:"==e||(this.base="http:"+this.base)}this.species=t.species||"human","string"==typeof t.type?this.type=[t.type]:this.type=t.type||["regulatory"]}var r=n(299),o=r.registerSourceAdapterFactory,a=r.FeatureSourceBase,s=n(251),l=s.DASStylesheet,u=s.DASStyle,c=s.DASFeature,h=s.DASGroup;i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i.prototype.getStyleSheet=function(t){var e=new l,n=new u;n.glyph="__NONE",this.type.indexOf("exon")>=0&&e.pushStyle({type:"transcript"},null,n),(this.type.indexOf("exon")>=0||this.type.indexOf("transcript")>=0)&&e.pushStyle({type:"gene"},null,n);var i=new u;i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="red",i.HEIGHT=8,i.BUMP=!0,i.LABEL=!0,i.ZINDEX=10,e.pushStyle({type:"cds"},null,i);var r=new u;r.glyph="SQUARE",r.BUMP="yes",r.LABEL="no",r.FGCOLOR="blue",e.pushStyle({type:"variation",method:".+_UTR_variant"},null,r);var r=new u;r.glyph="TRIANGLE",r.DIRECTION="S",r.BUMP="yes",r.LABEL="no",r.FGCOLOR="blue",e.pushStyle({type:"variation",method:"missense_variant"},null,r);var r=new u;r.glyph="TRIANGLE",r.DIRECTION="N",r.BUMP="yes",r.LABEL="no",r.FGCOLOR="blue",e.pushStyle({type:"variation",method:"splice_.+_variant"},null,r);var r=new u;r.glyph="STAR",r.POINTS=6,r.BUMP="yes",r.LABEL="no",r.FGCOLOR="blue",e.pushStyle({type:"variation",method:"regulatory_region_variant"},null,r);var r=new u;r.glyph="PLIMSOLL",r.BUMP="yes",r.LABEL="no",r.FGCOLOR="rgb(50,80,255)",r.STROKECOLOR="black",e.pushStyle({type:"variation"},null,r);var r=new u;r.glyph="SQUARE",r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",e.pushStyle({type:"indel",method:".+_UTR_variant"},null,r);var r=new u;r.glyph="TRIANGLE",r.DIRECTION="S",r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",e.pushStyle({type:"indel",method:"missense_variant"},null,r);var r=new u;r.glyph="TRIANGLE",r.DIRECTION="N",r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",e.pushStyle({type:"indel",method:"splice_.+_variant"},null,r);var r=new u;r.glyph="STAR",r.POINTS=6,r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",e.pushStyle({type:"indel",method:"regulatory_region_variant"},null,r);var r=new u;r.glyph="PLIMSOLL",r.BUMP="yes",r.LABEL="no",r.BGCOLOR="#888888",r.FGCOLOR="red",r.STROKECOLOR="black",e.pushStyle({type:"indel"},null,r);var o=new u;return o.glyph="BOX",o.FGCOLOR="black",o.BGCOLOR="orange",o.HEIGHT=8,o.BUMP=!0,o.LABEL=!0,o.ZINDEX=20,e.pushStyle({type:"default"},null,o),t(e)},i.prototype.getScales=function(){return[]},i.prototype.fetch=function(t,e,n,i,r,o,a){for(var s=this,l=this.base+"/overlap/region/"+this.species+"/"+t+":"+e+"-"+n,u=[],d=0;d<this.type.length;++d)u.push("feature="+this.type[d]);u.push("content-type=application/json"),l=l+"?"+u.join(";");var f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==f.readyState)if(s.busy--,s.notifyActivity(),f.status>=300){var e="Error code "+f.status;try{var n=JSON.parse(f.response);n.error&&(e=n.error)}catch(i){}a(e,null)}else{for(var r=JSON.parse(f.response),o=[],l=0;l<r.length;++l){var u=r[l],d=[],p=new c;if(p.segment=t,p.min=0|u.start,p.max=0|u.end,p.type=u.feature_type||"unknown",p.id=u.ID,u.Parent){var _=new h;_.id=u.Parent,p.groups=[_]}u.strand&&(u.strand<0?p.orientation="-":u.strand>0&&(p.orientation="+")),u.consequence_type&&(p.method=u.consequence_type),u.alt_alleles&&(d.push("Alleles="+u.alt_alleles.join("/")),u.alt_alleles.length>1&&(u.alt_alleles[1].length!=u.alt_alleles[0].length||"-"==u.alt_alleles[1])&&(p.type="indel")),d.length>0&&(p.notes=d),o.push(p)}a(null,o)}},s.busy++,s.notifyActivity(),f.open("GET",l,!0),f.responseType="text",f.send("")},o("ensembl",function(t){return{features:new i(t)}})},function(t,e,n){"use strict";function i(t){s.call(this),this.readiness="Connecting",this.source=t,this.tabixHolder=new d;var e=this,n=a(t.payload);if(!n)throw"Unsuported tabix payload "+t.payload;this.parser=n;var i,r;this.source.blob?(i=new c(this.source.blob),r=new c(this.source.indexBlob)):(i=new u(this.source.uri,{credentials:this.source.credentials}),r=new u(this.source.indexURI||this.source.uri+".tbi",{credentials:this.source.credentials})),f(i,r,function(t,i){e.tabixHolder.provide(t),t.fetchHeader(function(t,e){if(t){for(var i=n.createSession(function(){}),r=0;r<t.length;++r)i.parse(t[r]);i.flush()}}),e.readiness=null,e.notifyReadiness()})}var r=n(299),o=r.registerSourceAdapterFactory,a=r.makeParser,s=r.FeatureSourceBase,l=n(277),u=l.URLFetchable,c=l.BlobFetchable,h=n(248),d=h.Awaited,f=n(293).connectTabix;i.prototype=Object.create(s.prototype),i.prototype.fetch=function(t,e,n,i,r,o,a){var s=this;s.busy++,s.notifyActivity(),this.tabixHolder.await(function(i){i.fetch(t,e,n,function(t,e){s.busy--,s.notifyActivity();for(var n=[],i=s.parser.createSession(function(t){n.push(t)}),r=0;r<t.length;++r){i.parse(t[r])}i.flush(),a(null,n,1e9)})})},i.prototype.getStyleSheet=function(t){this.parser&&this.parser.getStyleSheet&&this.parser.getStyleSheet(t)},i.prototype.getDefaultFIPs=function(t){this.parser&&this.parser.getDefaultFIPs&&this.parser.getDefaultFIPs(t)},o("tabix",function(t){return{features:new i(t)}})},function(t,e,n){"use strict";function i(){this.featuresByChr={},this.maxLength=1,this.chrRing=null}function r(t){if(this.source=t,l.call(this),this.storeHolder=new h,this.parser=s(t.payload),!this.parser)throw"Unsupported memstore payload: "+t.payload;var e=this;this._load(function(t,n){if(t){for(var r=new i,o=[],a=t.split("\n"),s=e.parser.createSession(function(t){o.push(t)}),l=0;l<a.length;++l){var u=a[l];u.length>0&&s.parse(u)}s.flush(),r.addFeatures(o),e.storeHolder.provide(r)}else e.error=n||"No data",e.storeHolder.provide(null)})}var o=n(299),a=o.registerSourceAdapterFactory,s=o.makeParser,l=o.FeatureSourceBase,u=n(251),c=(u.DASStylesheet,u.DASStyle,u.DASFeature,u.DASGroup,n(248)),h=c.Awaited,d=c.textXHR;i.prototype.addFeatures=function(t){for(var e={},n=0;n<t.length;++n){var i=t[n],r=i.segment||i.chr,o=this.featuresByChr[r];o||(o=[],this.featuresByChr[r]=o),o.push(i),e[r]=!0;var a=i.max-i.min+1;a>this.maxLength&&(this.maxLength=a)}for(r in e){var o=this.featuresByChr[r];o.sort(function(t,e){var n=t.min-e.min;return 0!=n?n:t.max-e.max})}this.chrRing=null},i.prototype._indexFor=function(t,e){for(var n=0,i=t.length;i>n;){var r=(n+i)/2|0;if(r>=t.length)return t.length;var o=t[r];e<o.min?i=r:n=r+1}return i},i.prototype.fetch=function(t,e,n){var i=this.featuresByChr[t];if(i||(i=0==t.indexOf("chr")?this.featuresByChr[t.substring(3)]:this.featuresByChr["chr"+t]),!i)return[];for(var r=Math.max(0,this._indexFor(i,e-this.maxLength-1)),o=Math.min(i.length-1,this._indexFor(i,n)),a=[],s=r;o>=s;++s){var l=i[s];l.min<=n&&l.max>=e&&a.push(l)}return a},i.prototype.findNextFeature=function(t,e,n){if(null==this.chrRing){this.chrRing=[];for(var t in this.featuresByChr)this.chrRing.push(t);this.chrRing.sort()}var i=this.featuresByChr[t];if(i||(0==t.indexOf("chr")?(t=t.substring(3),i=this.featuresByChr[t]):(t="chr"+t,i=this.featuresByChr[t])),!i)return null;var r=Math.max(0,Math.min(this._indexFor(i,e),i.length-1));if(n>0){for(;r<i.length;){var o=i[r++];if(o.min>e)return o}var a=this.chrRing.indexOf(t)+1;return a>=this.chrRing.length&&(a=0),this.findNextFeature(this.chrRing[a],0,n)}for(;r>=0;){var o=i[r--];if(o.max<e)return o}var a=this.chrRing.indexOf(t)-1;return 0>a&&(a=this.chrRing.length-1),this.findNextFeature(this.chrRing[a],1e10,n)},r.prototype=Object.create(l.prototype),r.prototype._load=function(t){if(this.source.blob){var e=new FileReader;e.onloadend=function(){return t(e.result,e.error)},e.readAsText(this.source.blob)}else{if(this.source.credentials)var n={credentials:this.source.credentials};d(this.source.uri,t,n)}},r.prototype.fetch=function(t,e,n,i,r,o,a){var s=this;this.storeHolder.await(function(i){if(i){var r=i.fetch(t,e,n);return a(null,r,1e8)}return a(s.error)})},r.prototype.getStyleSheet=function(t){this.parser&&this.parser.getStyleSheet&&this.parser.getStyleSheet(t)},r.prototype.getDefaultFIPs=function(t){this.parser&&this.parser.getDefaultFIPs&&this.parser.getDefaultFIPs(t)},r.prototype.getScales=function(){return 1e8},r.prototype.findNextFeature=function(t,e,n,i){var r=this;this.storeHolder.await(function(o){return o?i(o.findNextFeature(t,e,n)):i(null,r.error)})},r.prototype.capabilities=function(){var t={leap:!0};return t},a("memstore",function(t){return{features:new r(t)}})},function(t,e,n){"use strict";function i(t){this.type=t}function r(t,e){this.parser=t,this.sink=e}function o(t,e){this.parser=t,this.sink=e,this.wigState=null}var a=n(269),s=a.Range,l=a.union,u=a.intersection,c=n(299),h=c.registerParserFactory,d=n(251),f=d.DASStylesheet,p=d.DASStyle,_=(d.DASFeature,d.DASGroup),g=n(248),m=g.shallowCopy;i.prototype.createSession=function(t){return"wig"==this.type?new o(this,t):new r(this,t)};var v=/([^=]+)=(.+)/,y=/\s/,b=new RegExp("^[0-9]+,[0-9]+,[0-9]+");r.prototype.parse=function(t){var e=t.split(y);if(!(e.length<3)){var n=parseInt(e[1])+1,i=parseInt(e[2]),r={segment:e[0],min:n,max:i};if(e.length>3&&"."!==e[3]&&(r.label=e[3]),e.length>4&&(r.score=parseFloat(e[4])),e.length>5&&(r.orientation=e[5]),e.length>8){var o=e[8];b.test(o)&&(r.itemRgb="rgb("+o+")")}if(e.length>=12){var a=parseInt(e[6]),c=parseInt(e[7]),h=parseInt(e[9]),d=e[10].split(",").map(function(t){return parseInt(t)}),f=e[11].split(",").map(function(t){return parseInt(t)});r.type="transcript";var p=new _;if(p.id=e[3],p.type="transcript",p.notes=[],r.groups=[p],e.length>12){var g=e[12],v=g;e.length>13&&(v=e[13]);var x=new _;x.id=g,x.label=v,x.type="gene",r.groups.push(x)}for(var w=null,S=0;h>S;++S){var A=f[S]+n,k=A+d[S],C=new s(A,k);w=w?l(w,C):C}for(var T=w.ranges(),E=0;E<T.length;++E){var M=T[E],L=m(r);L.min=M.min(),L.max=M.max(),this.sink(L)}if(c>a){var R="+"==r.orientation?new s(a,c+3):new s(a-3,c),O=u(w,R);if(O){r.type="translation";for(var P=O.ranges(),D=0,E=0;E<P.length;++E){var I=E;"-"==r.orientation&&(I=P.length-E-1);var M=P[I],L=m(r);L.min=M.min(),L.max=M.max(),r.readframe=D;var N=M.max()-M.min();D=(D+N)%3,this.sink(L)}}}}else this.sink(r)}},r.prototype.flush=function(){},o.prototype.parse=function(t){var e=t.split(y);if("fixedStep"==e[0]){this.wigState="fixedStep",this.chr=this.pos=this.step=null,this.span=1;for(var n=1;n<e.length;++n){var i=v.exec(e[n]);i&&("chrom"==i[1]?this.chr=i[2]:"start"==i[1]?this.pos=parseInt(i[2]):"step"==i[1]?this.step=parseInt(i[2]):"span"==i[1]&&(this.span=parseInt(i[2])))}}else if("variableStep"==e[0]){this.wigState="variableStep",this.chr=null,this.span=1;for(var n=1;n<e.length;++n){var i=v.exec(e[n]);"chrom"==i[1]?this.chr=i[2]:"span"==i[1]&&(this.span=parseInt(i[2]))}}else if(this.wigState){if("fixedStep"==this.wigState){if(1!=e.length)return;var r=parseFloat(e[0]),o={segment:this.chr,min:this.pos,max:this.pos+this.span-1,score:r};this.pos+=this.step,this.sink(o)}else if("variableStep"==this.wigState){if(2!=e.length)return;var a=parseInt(e[0]),r=parseFloat(e[1]),o={segment:this.chr,min:a,max:a+this.span-1,score:r};this.sink(o)}}else{if(e.length<4)return;var o={segment:e[0],min:parseInt(e[1])+1,max:parseInt(e[2]),score:parseFloat(e[3])};this.sink(o)}},o.prototype.flush=function(){},i.prototype.getStyleSheet=function(t){var e=new f;if("wig"==this.type){var n=new p;n.glyph="HISTOGRAM",n.BGCOLOR="blue",n.HEIGHT=30,e.pushStyle({type:"default"},null,n)}else{var n=new p;n.glyph="BOX",n.FGCOLOR="black",n.BGCOLOR="blue",n.HEIGHT=8,n.BUMP=!0,n.LABEL=!0,n.ZINDEX=20,e.pushStyle({type:"default"},null,n);var n=new p;n.glyph="BOX",n.FGCOLOR="black",n.BGCOLOR="red",n.HEIGHT=10,n.BUMP=!0,n.ZINDEX=20,e.pushStyle({type:"translation"},null,n);var i=new p;i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="white",i.HEIGHT=10,i.ZINDEX=10,i.BUMP=!0,i.LABEL=!0,e.pushStyle({type:"transcript"},null,i);var r=new p;r.glyph="HISTOGRAM",r.COLOR1="white",r.COLOR2="black",r.HEIGHT=30,e.pushStyle({type:"density"},null,r)}return t(e)},h("bed",function(t){return new i(t)}),h("wig",function(t){return new i(t)})},function(t,e,n){"use strict";function i(){this.info=[]}function r(t,e){this.parser=t,this.sink=e}var o=n(299),a=o.registerParserFactory,s=n(251),l=s.DASStylesheet,u=s.DASStyle,c=s.DASFeature,h=(s.DASGroup,/([^;=]+)(=([^;]+))?;?/),d=/##INFO=<([^>]+)>/,f=/([^,=]+)=([^,]+|"[^"]+"),?/;i.prototype.createSession=function(t){return new r(this,t)},r.prototype.parse=function(t){if(0!=t.length)if("#"!=t[0]){var e=t.split("	"),n=new c;n.segment=e[0],n.id=e[2],n.refAllele=e[3],n.altAlleles=e[4].split(","),n.min=parseInt(e[1]),n.max=n.min+n.refAllele.length-1;var i=e[7].split(h);n.info={};for(var r=0;r<i.length;r+=4)n.info[i[r+1]]=i[r+3];var o=n.altAlleles[0],a=n.refAllele;o.length>a.length?(n.type="insertion",0==o.indexOf(a)?(n.insertion=o.substr(a.length),n.min+=a.length,n.max=n.min-1):n.insertion=o):o.length<a.length?n.type="deletion":n.type="substitution",this.sink(n)}else if(t.length>1&&"#"==t[1]){var s=d.exec(t);if(s){for(var e=s[1].split(f),l=null,u=null,r=0;r<e.length-1;r+=3){var p=e[r+1],_=e[r+2].replace(/"/g,"");"ID"==p?l=_:"Description"==p&&(u=_)}l&&u&&this.parser.info.push({id:l,desc:u})}return}},r.prototype.flush=function(){},i.prototype.getStyleSheet=function(t){var e=new l,n=new u;n.glyph="__INSERTION",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="rgb(50,80,255)",n.BGCOLOR="#888888",n.STROKECOLOR="black",e.pushStyle({type:"insertion"},null,n);var n=new u;n.glyph="PLIMSOLL",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="rgb(255, 60, 60)",n.BGCOLOR="#888888",n.STROKECOLOR="black",e.pushStyle({type:"deletion"},null,n);var n=new u;return n.glyph="PLIMSOLL",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="rgb(50,80,255)",n.BGCOLOR="#888888",n.STROKECOLOR="black",e.pushStyle({type:"default"},null,n),t(e)},i.prototype.getDefaultFIPs=function(t){var e=this,n=function(t,n){if(n.add("Ref. allele",t.refAllele),n.add("Alt. alleles",t.altAlleles.join(",")),t.info)for(var i=0;i<e.info.length;++i){var r=e.info[i],o=t.info[r.id];void 0!==o&&n.add(r.desc,o)}};t(n)},a("vcf",function(){return new i})},function(t,e,n){"use strict";function i(){var t=this;this.reqs=[],this.awaitedFeatures={},this.requestsIssued=new E(function(e,n){t.notifyRequestsIssued=e})}function r(t,e,n,i,r,o,a){this.chr=t,this.min=e,this.max=n,this.coverage=a,this.scale=i,this.features=r||[],this.status=o}function o(t,e,n,i,r,o){this.tierMap=t,this.chr=e,this.min=n,this.max=i,this.scale=r,this.seqSource=o||new m,this.viewCount=0,this.featureCache={},this.latestViews={}}function a(t,e,n){for(var i=[],r={},o=0;o<t.length;++o){var a=t[o];a.min&&a.max?a.groups&&a.groups.length>0?u(r,a.groups[0].id,a):a.min<=n&&a.max>=e&&i.push(a):i.push(a)}for(var s in r){for(var l=r[s],c=1e11,h=-1e11,o=0;o<l.length;++o){var a=l[o];c=Math.min(c,a.min),h=Math.max(h,a.max)}if(n>=c||h>=e)for(var o=0;o<l.length;++o)i.push(l[o])}return i}var s=n(248),l=s.Awaited,u=s.pusho,c=n(299),h=c.MappedFeatureSource,d=c.CachingFeatureSource,f=c.BWGFeatureSource,p=c.RemoteBWGFeatureSource,_=c.BAMFeatureSource,g=c.RemoteBAMFeatureSource,m=c.DummySequenceSource,v=c.DummyFeatureSource,y=n(301).OverlayFeatureSource,b=n(269),x=b.Range,w=(b.union,b.intersection),S=n(309),A=S.downsample,k=S.getBaseCoverage,C=n(251),T=C.DASSequence,E=n(255).Promise;i.prototype.addRequest=function(t){this.reqs.push(t)},i.prototype.abortAll=function(){for(var t=0;t<this.reqs.length;++t)this.reqs[t].abort()},r.prototype.toString=function(){return this.chr+":"+this.min+".."+this.max+";scale="+this.scale},o.prototype.cancel=function(){this.cancelled=!0},o.prototype.bestCacheOverlapping=function(t,e,n){var i=this.featureCache[this.tierMap[0]];return i?i:null},o.prototype.retrieveFeatures=function(t,e,n,r,o,a){if(o!=o)throw"retrieveFeatures called with silly scale";if(e!=this.chr)throw"Can't extend Known Space to a new chromosome";1>n&&(n=1),this.min=n,this.max=r,this.scale=o,this.pool&&this.pool.abortAll(),this.pool=new i,this.awaitedSeq=new l,this.seqWasFetched=!1,this.viewCount++,this.startFetchesForTiers(t,a),this.pool.notifyRequestsIssued()},o.prototype.invalidate=function(t,e){this.pool&&(this.featureCache[t]=null,this.startFetchesForTiers([t],e))},o.prototype.startFetchesForTiers=function(t,e){for(var n,i=this,r=this.awaitedSeq,o=!1,a=0;a<t.length;++a)try{this.startFetchesFor(t[a],r,e)&&(o=!0)}catch(s){var l=t[a];l.currentFeatures=[],l.currentSequence=null,console.log("Error fetching tier source"),console.log(s),n=s,e(s,l)}if(o&&!this.seqWasFetched){this.seqWasFetched=!0;var u=this.min,c=this.max;if(this.cs&&this.cs.start<=u&&this.cs.end>=c){var h;return h=this.cs.start==u&&this.cs.end==c?this.cs:new T(this.cs.name,u,c,this.cs.alphabet,this.cs.seq.substring(u-this.cs.start,c+1-this.cs.start)),r.provide(h)}this.seqSource.fetch(this.chr,u,c,this.pool,function(t,e){e?((!i.cs||u<=i.cs.start&&c>=i.cs.end||u>=i.cs.end||c<=i.cs.start||c-u>i.cs.end-i.cs.start)&&(i.cs=e),r.provide(e)):(console.log("Sequence loading failed",t),r.provide(null))})}if(n)throw n},o.prototype.startFetchesFor=function(t,e,n){var i,o=this,s=this.viewCount,l=t.getSource()||new v,u=t.needsSequence(this.scale),c=o.featureCache[t],h=t.getActiveStyleFilters(this.scale);h&&(i=h.typeList());var d=this.chr,f=this.min,p=this.max;if(void 0===i)return!1;if(c&&c.chr===this.chr&&c.min<=f&&c.max>=p){var _=c.features;(c.min<f||c.max>p)&&(_=a(_,f,p)),o.provision(t,c.chr,w(c.coverage,new x(f,p)),c.scale,i,_,c.status,u?e:null,n);var g=l.getScales();if(c.scale<=this.scale||!g)return u}return l.instrument&&console.log("Starting  fetch "+s+" ("+f+", "+p+")"),l.fetch(d,f,p,this.scale,i,this.pool,function(a,h,_,g){l.instrument&&console.log("Finishing fetch "+s);var m=o.latestViews[t]||-1;o.cancelled||m>s||(g||(g=new x(f,p)),(!c||f<c.min||p>c.max)&&(o.featureCache[t]=new r(d,f,p,_,h,a,g)),o.latestViews[t]=s,o.provision(t,d,g,_,i,h,a,u?e:null,n))},h),u},o.prototype.provision=function(t,e,n,i,r,o,a,s,l){if(a&&t.setFeatures(e,n,i,[],null),!a){for(var u=!1,c=!1,m=t.getSource();h.prototype.isPrototypeOf(m)||d.prototype.isPrototypeOf(m)||y.prototype.isPrototypeOf(m);)m=y.prototype.isPrototypeOf(m)?m.sources[0]:m.source;(f.prototype.isPrototypeOf(m)||p.prototype.isPrototypeOf(m)||_.prototype.isPrototypeOf(m)||g.prototype.isPrototypeOf(m))&&(u=!0),m.opts&&(m.opts.forceReduction||m.opts.noDownsample)||u&&r&&1==r.length&&r.indexOf("density")>=0&&(o=A(o,this.scale)),r&&1==r.length&&r.indexOf("base-coverage")>=0&&(c=!0),s?s.await(function(r){c&&(o=k(o,r,t.browser.baseColors)),t.setFeatures(e,n,i,o,r)}):t.setFeatures(e,n,i,o)}l(a,t)},t.exports={KnownSpace:o}},function(t,e,n){"use strict";function i(t){return _[t%_.length]*Math.pow(10,t/_.length|0)}function r(t,e,n){this.scale=t,this.tot=0,this.cnt=0,this.hasScore=!1,this.min=e,this.max=n,this.features=[]}function o(t,e){return t.min<e.min?-1:t.min>e.min?1:t.max<e.max?-1:e.max>t.max?1:0}function a(t,e){for(var n=0;i(n+1)<e;)++n;for(var o=i(n),a=[],s=-1e10,l=1e10,u=0;u<t.length;++u){var c=t[u];if(c.groups&&c.groups.length>0)return t;var h=c.min/o|0,f=c.max/o|0;s=Math.max(s,f),l=Math.min(l,h);for(var p=h;f>=p;++p){var _=a[p];_||(_=new r(o,p*o,(p+1)*o-1),a[p]=_),_.feature(c)}}for(var g=[],p=l;s>=p;++p){var _=a[p];if(_){var c=new d;c.segment=t[0].segment,c.min=p*o+1,c.max=(p+1)*o,c.score=_.score(),c.type="density",g.push(c)}}Date.now();return g}function s(t){this._pos=t,this._bases={},this._totalCount=0}function l(t,e,n){for(var i=f(n),r=[],o=[],a=0,s=0;s<i.length;++s){var l=i[s];if("M"==l.op)r.push(t.substr(a,l.cnt)),o.push(e.substr(a,l.cnt)),a+=l.cnt;else if("D"==l.op)for(var u=0;u<l.cnt;++u)r.push("-"),o.push("Z");else"I"==l.op?a+=l.cnt:"S"==l.op?a+=l.cnt:console.log("unknown cigop"+l.op)}var c={seq:r.join(""),quals:o.join("")};return c}function u(t,e,n){var i=[];if(t){var r=0|t.start,o=0|t.end;if(n>=r&&o>=e){for(var a=Math.max(e,r),s=Math.min(n,o),l=0;a-e>l;l++)i.push("N");i.push(t.seq.substr(a-r,s-a+1));for(var l=0;n-s>l;l++)i.push("N")}}return i.join("")}function c(t,e,n){for(var i=null,r=null,o=[],a=0;a<t.length;++a){var c=t[a];if(c.groups&&c.groups.length>0)return t;for(var h=l(c.seq,c.quals,c.cigar),f=h.seq,_=h.quals,g=c.orientation,m=c.min||0,v=c.max||0,y=0,b=m;v>=b;++b){var x=o[b];x||(x=new s(b),o[b]=x);var w=f.charAt(y),S=_.charCodeAt(y)-33;x.recordBase(w,S,g),y++}i=i?Math.min(i,m):m,r=r?Math.max(r,v):v}for(var A=u(e,i,r),k=[],y=0,b=i;r>=b;++b){var x=o[b];if(x){var c=new d;if(c.segment=t[0].segment,c.min=x.pos(),c.max=c.min,c.notes=[],c.notes=c.notes.concat(x.infoList()),c.type="base-coverage",c.suppressScore=!0,A){var C=A.charAt(y),T="Ref="+C;c.notes.unshift(T);for(var E=x.baseScoreList(C,.2),M=0;M<E.length;M++){var w=E[M].base,L=E[M].score,R=p(c);R.score=L,(E.length>1||w!=C)&&(R.itemRgb=n[w]),k.push(R)}}else k.push(c)}y++}return k}var h=n(251),d=h.DASFeature,f=n(271).parseCigar,p=n(248).shallowCopy,_=[1,2,5];r.prototype.score=function(){if(0==this.cnt)return 0;if(this.hasScore)return this.tot/this.cnt;var t=this.features;t.sort(o);for(var e=-1e10,n=0,i=0,r=1;r<t.length;++r){var a=t[r],s=Math.max(a.min,this.min),l=Math.min(a.max,this.max);i+=l-s+1,s>e?(n+=l-s+1,e=l):l>e&&(n+=l-e,e=l)}return n>0?1*i/n:0},r.prototype.feature=function(t){void 0!==t.score&&(this.tot+=t.score,this.hasScore=!0),++this.cnt,this.features.push(t)},s.prototype.recordBase=function(t,e,n){if(this._bases[t]){var i=this._bases[t];i.cnt++,i.totalQual+=e,i.strandCnt[n]++}else{var r={"+":0,"-":0};r[n]++,this._bases[t]={cnt:1,totalQual:e,strandCnt:r}}this._totalCount++},s.prototype.totalCount=function(){return this._totalCount},s.prototype.pos=function(){return this._pos},s.prototype.infoList=function(){var t=[],e=this._totalCount,n="Depth="+e.toString();t.push(n);for(var i in this._bases){var r=this._bases[i],o=r.cnt,a=100*o/e,s=r.strandCnt["+"],l=r.strandCnt["-"],u=r.totalQual/o,c=[i,"=",o," (",a.toFixed(0),"%, ",s," +, ",l," -, Qual: ",u.toFixed(0),")"];t.push(c.join(""))}return t},s.prototype.baseScoreList=function(t,e){var n=[],i=this._totalCount,r=e*i;for(var o in this._bases){var a=this._bases[o].cnt;if(!(r>a||o==t)){var s={base:o,score:i};n.push(s),i-=a}}return n.push({base:t,score:i}),n},t.exports={downsample:a,getBaseCoverage:c}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.update=e.getReducer=e.changeReducer=e.actionCreators=e.init=e.CHANGE=void 0;var o=n(231),a=i(o),s=n(232),l=e.CHANGE="@CHANGE",u=(e.init=function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{index:t,currentIndex:e,lastCurrentIndex:null}},e.actionCreators=r({},l,function(t){return r({type:l,payload:t},s.GLOBAL_ACTION,!0)}),e.changeReducer=function(t,e){return Object.assign({},t,{
lastCurrentIndex:t.currentIndex,currentIndex:e.payload})});e.getReducer=function(t){return(0,s.createReducer)(r({},l,u))},e.update=function(t,e,n){var i=a["default"].select(n),r=2e3;t.currentIndex===t.lastCurrentIndex?i.style("display",t.index===t.currentIndex?"block":"none").style("transform",null).style("opacity",null):t.index===t.lastCurrentIndex?i.style("transform","scale(1)").style("opacity","1").transition().duration(r).ease("cubic-in-out").style("transform",t.currentIndex>t.lastCurrentIndex?"scale(10)":"scale(0.1)").style("opacity","0").each("end",function(){i.style("display","none").style("transform",null).style("opacity",null)}):t.index===t.currentIndex?null===t.lastCurrentIndex?i.style("display","block").style("transform",null).style("opacity",null):i.style("display","block").style("transform",t.currentIndex<t.lastCurrentIndex?"scale(10)":"scale(0.1)").style("opacity","0").transition().duration(r).ease("cubic-in-out").style("transform","scale(1)").style("opacity","1").each("end",function(){i.style("display","block").style("transform",null).style("opacity",null)}):i.style("display","none").style("transform",null).style("opacity",null)}},function(t,e,n){var i=n(312);"string"==typeof i&&(i=[[t.id,i,""]]);n(314)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(313)(),e.push([t.id,".btn,body{font-family:Helvetica Neue,Helvetica,Arial,sans-serif!important}body{font-size:14px}.escher-container{background-color:#f3f3f3;text-align:center;position:relative}body.fill-screen,html.fill-screen{height:100%;width:100%}body.fill-screen{overflow:hidden}.fill-screen-div{margin:0;padding:0;position:fixed;top:0;bottom:0;left:0;right:0}.escher-3d-transform-container,.escher-zoom-container,.full-screen-on,svg.escher-svg{height:100%!important;width:100%!important;overflow:hidden}.escher-container #status{position:absolute;bottom:10px;left:20px;color:red;background-color:#fff;font-size:16px}.escher-container #menu{display:block;margin:5px auto 0;border:1px solid #ddd;background-color:hsla(0,0%,100%,.95);border-radius:0}.escher-container .help-button{float:right;padding:0 5px;font-size:12px;background-color:#f5f5f5}.escher-container .dropdown-menu{border:1px solid #ddd;background-color:hsla(0,0%,100%,.95);border-radius:0;margin:0;text-align:left}.escher-container .dropdown-menu>li>a{font-size:15px}.escher-container .dropdown-menu>.escher-disabled>a{color:#e0e0e0;pointer-events:none}.escher-container .dropdown{background-color:hsla(0,0%,100%,.95)}@media (max-width:550px){.escher-container .dropdown-button{padding:5px 9px}}@media (min-width:550px){.escher-container .dropdown-button{font-size:18px}.escher-container .help-button{font-size:16px}}.escher-container .search-menu-container{position:absolute;width:100%;top:0;left:0;margin:0;text-align:center;pointer-events:none}.escher-container .search-menu-container-inline{width:320px;display:inline-block;text-align:left;pointer-events:auto}@media (min-width:550px){.escher-container .search-menu-container-inline{width:410px}}.escher-container .search-container{display:block;background:hsla(0,0%,100%,.95);padding:3px;border:1px solid #ddd;margin:2px 0 0}.escher-container .search-bar{display:inline-block;border:1px solid #ddd;margin-right:4px;width:114px;height:29px;border-radius:3px}.escher-container .search-counter{display:inline-block;padding:0 8px}.escher-container .settings-box-background{display:block;position:absolute;top:0;left:0;width:100%;height:100%;z-index:9;background:rgba(0,0,0,.4);padding:5% 0;text-align:center}.escher-container .settings-box-container{display:inline-block;position:relative;width:90%;max-width:520px;height:100%;z-index:10}.escher-container .settings-button{position:absolute;top:5px;right:20px;z-index:10}.escher-container .settings-button-close{right:60px}.escher-container .settings-box{display:inline-block;max-height:100%;width:100%;overflow-y:scroll;overflow-x:hidden;background:hsla(0,0%,100%,.95);padding:8px;margin:0;border:1px solid #ddd;text-align:left}.escher-container .settings-section-heading-large{font-size:17px;font-weight:700;margin-top:15px}.escher-container .settings-section-heading{font-weight:700;margin-top:15px}.escher-container .settings-table{width:100%}.escher-container .settings-table td{padding:3px 5px}.escher-container td.options-label{width:88px}.escher-container td.options-label-wide{width:192px}.escher-container .settings-number{text-align:center;color:#aaa;font-style:italic}.escher-container .input-cell{width:23%;font-size:13px}.escher-container .scale-bar-input{width:100%;text-align:left}.escher-container .no-data-input{width:23%;margin:0 4px}.escher-container label.option-group{margin:0 10px 0 0}.escher-container label.option-group span{margin:0 0 0 4px}.escher-container label.full-line{width:100%}.escher-container label{font-weight:inherit}.escher-container .settings-tip{font-style:italic}.escher-container .scale-editor{position:relative;width:100%;height:190px;font-size:12px}.escher-container .scale-editor .centered{position:absolute;width:440px;left:35px;top:0}.escher-container .scale-editor .data-not-loaded{position:absolute;z-index:5;left:60px;top:25px;text-align:center;width:400px;font-size:15px;color:#b19ec0}.escher-container .scale-editor .add{position:absolute;top:0;right:0;width:20px;cursor:pointer}.escher-container .scale-editor .trash-container{position:absolute;top:0;left:0;width:420px;height:20px}.escher-container .scale-editor .trash{position:absolute;top:0;left:0;cursor:pointer}.escher-container .scale-editor .scale-svg{position:absolute;width:440px;height:80px;top:20px;left:0}.escher-container .scale-editor .input-container{position:absolute;top:56px;left:0;width:420px}.escher-container .scale-editor .input-container input{position:absolute;left:0;top:0}.escher-container .scale-editor input[disabled]{background-color:#f1ecfa}.escher-container .scale-editor .row-label{position:absolute;left:0}.escher-container .scale-editor .input-set{position:absolute;top:0;box-shadow:0 2px 14px #c5c5c5}.escher-container .scale-editor .input-set.selected-set{z-index:5}.escher-container .scale-editor .domain-type-picker{position:absolute;top:0;right:0;height:14px;background-color:#e8e8e8}.escher-container .scale-editor .picker rect{color:#000;opacity:.4}.escher-container .scale-editor .no-data{position:absolute;left:0;width:100%}.escher-container .scale-editor .no-data-heading{font-weight:700}.escher-container .scale-editor .no-data .input-group{position:absolute;top:0;left:0}.escher-container .scale-editor .no-data .input-group input,.escher-container .scale-editor .no-data .input-group span{position:absolute;top:17px}.escher-container .close-button{margin-left:4px;float:right}.escher-container ul#button-panel{position:absolute;left:4px;top:20%;margin-top:-30px;pointer-events:none;padding-left:0}.escher-container ul#button-panel li{pointer-events:auto;list-style:none}.escher-container .input-close-button{position:absolute;right:0;width:18px;bottom:0;padding:0;border-width:0;margin:0;background:none;font-size:16px;font-weight:400}.escher-container .simple-button{width:40px;height:40px;border:1px solid #2e2f2f;background-image:linear-gradient(#4f5151,#474949 6%,#3f4141);color:#fff;background-color:#474949;border-color:#474949;padding:6px 0 9px;font-size:17px;line-height:1.42857143;border-radius:4px;text-align:center;vertical-align:middle;cursor:pointer;margin:3px 0 0}.escher-container #rxn-input{z-index:10}.escher-container .input-close-button:hover{color:#f33;font-weight:700}.escher-container .light{color:#8b8b8be;font-weight:400}.escher-container #text-edit-input input{width:500px;border:1px solid #ccc;font-size:22px}.escher-container #quick-jump-menu{position:absolute;right:10px;bottom:10px;width:300px}@media (max-width:550px){.escher-container #quick-jump-menu{display:none}}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(t,e,n){function i(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=f[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(u(i.parts[o],e))}else{for(var a=[],o=0;o<i.parts.length;o++)a.push(u(i.parts[o],e));f[i.id]={id:i.id,refs:1,parts:a}}}}function r(t){for(var e=[],n={},i=0;i<t.length;i++){var r=t[i],o=r[0],a=r[1],s=r[2],l=r[3],u={css:a,media:s,sourceMap:l};n[o]?n[o].parts.push(u):e.push(n[o]={id:o,parts:[u]})}return e}function o(t,e){var n=g(),i=y[y.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function a(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function s(t){var e=document.createElement("style");return e.type="text/css",o(t,e),e}function l(t){var e=document.createElement("link");return e.rel="stylesheet",o(t,e),e}function u(t,e){var n,i,r;if(e.singleton){var o=v++;n=m||(m=s(e)),i=c.bind(null,n,o,!1),r=c.bind(null,n,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(e),i=d.bind(null,n),r=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(e),i=h.bind(null,n),r=function(){a(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}function c(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=b(e,r);else{var o=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function h(t,e){var n=e.css,i=e.media;e.sourceMap;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function d(t,e){var n=e.css,i=(e.media,e.sourceMap);i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var r=new Blob([n],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}var f={},p=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},_=p(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),g=p(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,v=0,y=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=_()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=r(t);return i(n,e),function(t){for(var o=[],a=0;a<n.length;a++){var s=n[a],l=f[s.id];l.refs--,o.push(l)}if(t){var u=r(t);i(u,e)}for(var a=0;a<o.length;a++){var l=o[a];if(0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete f[l.id]}}}};var b=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=[{map_name:"e_coli_core.Core metabolism",map_id:"0df3827fde8464e80f455a773a52c274",map_description:"E. coli core metabolic network\nLast Modified Fri Dec 05 2014 16:39:44 GMT-0800 (PST)",homepage:"https://escher.github.io",schema:"https://escher.github.io/escher/jsonschema/1-0-0#"},{reactions:{1576693:{name:"Phosphoglycerate kinase",bigg_id:"PGK",segments:{291:{to_node_id:"1576836",from_node_id:"1576835",b2:null,b1:null},292:{to_node_id:"1576834",from_node_id:"1576836",b2:null,b1:null},293:{to_node_id:"1576835",from_node_id:"1576485",b2:{y:2789.230249470758,x:1055},b1:{y:2822.4341649025255,x:1055}},294:{to_node_id:"1576835",from_node_id:"1576486",b2:{y:2790,x:1055},b1:{y:2825,x:1055}},295:{to_node_id:"1576487",from_node_id:"1576834",b2:{y:2615,x:1055},b1:{y:2650,x:1055}},296:{to_node_id:"1576488",from_node_id:"1576834",b2:{y:2617.5658350974745,x:1055},b1:{y:2650.769750529242,x:1055}}},genes:[{bigg_id:"b2926",name:"pgk"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"3pg_c"},{coefficient:1,bigg_id:"13dpg_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:1,bigg_id:"adp_c"}],label_x:1065,label_y:2715,gene_reaction_rule:"b2926"},1576694:{name:"Phosphogluconate dehydrogenase",bigg_id:"GND",segments:{297:{to_node_id:"1576837",from_node_id:"1576838",b2:null,b1:null},298:{to_node_id:"1576839",from_node_id:"1576837",b2:null,b1:null},299:{to_node_id:"1576838",from_node_id:"1576489",b2:{y:1265,x:1921.339540236634},b1:{y:1265,x:1884.7984674554473}},300:{to_node_id:"1576838",from_node_id:"1576490",b2:{y:1265,x:1920.5},b1:{y:1265,x:1882}},301:{to_node_id:"1576491",from_node_id:"1576839",b2:{y:1265,x:2029.2015325445527},b1:{y:1265,x:1992.660459763366}},302:{to_node_id:"1576492",from_node_id:"1576839",b2:{y:1265,x:2041.0312423743285},b1:{y:1265,x:1996.2093727122985}},303:{to_node_id:"1576493",from_node_id:"1576839",b2:{y:1265,x:2066},b1:{y:1265,x:2003.7}}},genes:[{bigg_id:"b2029",name:"gnd"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"ru5p__D_c"},{coefficient:1,bigg_id:"nadph_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"6pgc_c"}],label_x:1930.5045166015625,label_y:1313.710205078125,gene_reaction_rule:"b2029"},1576695:{name:"O2 transport  diffusion ",bigg_id:"O2t",segments:{304:{to_node_id:"1576840",from_node_id:"1576494",b2:{y:1660,x:4755},b1:{y:1660,x:4821.5}},305:{to_node_id:"1576495",from_node_id:"1576840",b2:{y:1660,x:4495},b1:{y:1660,x:4610.5}}},genes:[{bigg_id:"s0001",name:"None"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"o2_c"},{coefficient:-1,bigg_id:"o2_e"}],label_x:4557.1943359375,label_y:1635.4964599609375,gene_reaction_rule:"s0001"},1576696:{name:"NAD P  transhydrogenase",bigg_id:"THD2",segments:{306:{to_node_id:"1576841",from_node_id:"1576842",b2:null,b1:null},307:{to_node_id:"1576843",from_node_id:"1576841",b2:null,b1:null},308:{to_node_id:"1576842",from_node_id:"1576496",b2:{y:724.5066228070302,x:3510},b1:{y:580.5856339661426,x:3331.1220703125}},309:{to_node_id:"1576842",from_node_id:"1576497",b2:{y:750.137689584216,x:3510},b1:{y:654.7419446101471,x:3418.143798828125}},310:{to_node_id:"1576842",from_node_id:"1576498",b2:{y:777.5,x:3510},b1:{y:725,x:3510}},311:{to_node_id:"1576499",from_node_id:"1576843",b2:{y:995.287841796875,x:3510},b1:{y:921.2841796875,x:3510}},312:{to_node_id:"1576500",from_node_id:"1576843",b2:{y:1078.144282674624,x:3740.4462890625},b1:{y:1061.6865465211372,x:3508.388671875}},313:{to_node_id:"1576501",from_node_id:"1576843",b2:{y:1081.817596989458,x:3624.41748046875},b1:{y:1038.7769502394156,x:3506.777099609375}}},genes:[{bigg_id:"b1602",name:"pntB"},{bigg_id:"b1603",name:"pntA"}],reversibility:!1,metabolites:[{coefficient:-2,bigg_id:"h_e"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"nadh_c"},{coefficient:1,bigg_id:"nadph_c"},{coefficient:2,bigg_id:"h_c"},{coefficient:1,bigg_id:"nad_c"}],label_x:3532.891845703125,label_y:872.8489990234375,gene_reaction_rule:"b1602 and b1603"},1576697:{name:"Fumarase",bigg_id:"FUM",segments:{314:{to_node_id:"1576845",from_node_id:"1576844",b2:null,b1:null},315:{to_node_id:"1576504",from_node_id:"1576845",b2:{y:3134,x:2652.5},b1:{y:3093.4,x:2674.55}},316:{to_node_id:"1576844",from_node_id:"1576502",b2:{y:3010.0650991921693,x:2736.5037173099395},b1:{y:2982.216997307231,x:2758.679057699798}},317:{to_node_id:"1576844",from_node_id:"1576503",b2:{y:3003.8745504813855,x:2741.433228320378},b1:{y:2961.5818349379524,x:2775.110761067927}}},genes:[{bigg_id:"b4122",name:"fumB"},{bigg_id:"b1611",name:"fumC"},{bigg_id:"b1612",name:"fumA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"fum_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"mal__L_c"}],label_x:2759.057373046875,label_y:3066,gene_reaction_rule:"b1612 or b4122 or b1611"},1576698:{name:"Isocitrate dehydrogenase (NADP)",bigg_id:"ICDHyr",segments:{318:{to_node_id:"1576846",from_node_id:"1576847",b2:null,b1:null},319:{to_node_id:"1576848",from_node_id:"1576846",b2:null,b1:null},320:{to_node_id:"1576847",from_node_id:"1576505",b2:{y:3933.673891941737,x:3498.9695345126847},b1:{y:3958.5796398057905,x:3468.565115042282}},321:{to_node_id:"1576847",from_node_id:"1576506",b2:{y:3936.593890513596,x:3495.4048609314546},b1:{y:3968.312968378653,x:3456.6828697715146}},322:{to_node_id:"1576507",from_node_id:"1576848",b2:{y:3735.4876397766343,x:3702.9108389651055},b1:{y:3767.3462919329904,x:3674.9732516895315}},323:{to_node_id:"1576508",from_node_id:"1576848",b2:{y:3749.7955576929353,x:3690.36389556158},b1:{y:3771.6386673078805,x:3671.209168668474}},324:{to_node_id:"1576509",from_node_id:"1576848",b2:{y:3715.2337610392046,x:3720.671932627159},b1:{y:3761.2701283117613,x:3680.3015797881476}}},genes:[{bigg_id:"b1136",name:"icd"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"nadph_c"},{coefficient:1,bigg_id:"akg_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"icit_c"}],label_x:3616,label_y:3836,gene_reaction_rule:"b1136"},1576699:{name:"Pyruvate dehydrogenase",bigg_id:"PDH",segments:{325:{to_node_id:"1576850",from_node_id:"1576849",b2:null,b1:null},326:{to_node_id:"1576851",from_node_id:"1576850",b2:null,b1:null},327:{to_node_id:"1576849",from_node_id:"1576510",b2:{y:3945,x:1413.3472975166192},b1:{y:3945,x:1374.4909917220637}},328:{to_node_id:"1576849",from_node_id:"1576511",b2:{y:3945,x:1373.75},b1:{y:3945,x:1242.5}},329:{to_node_id:"1576849",from_node_id:"1576512",b2:{y:3945,x:1411.736306507171},b1:{y:3945,x:1369.1210216905704}},330:{to_node_id:"1576513",from_node_id:"1576851",b2:{y:3945,x:1606.478150704935},b1:{y:3945,x:1570.4434452114806}},331:{to_node_id:"1576514",from_node_id:"1576851",b2:{y:3945,x:1635},b1:{y:3945,x:1579}},332:{to_node_id:"1576515",from_node_id:"1576851",b2:{y:3945,x:1613.309518948453},b1:{y:3945,x:1572.492855684536}}},genes:[{bigg_id:"b0114",name:"aceE"},{bigg_id:"b0115",name:"aceF"},{bigg_id:"b0116",name:"lpd"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"nadh_c"},{coefficient:-1,bigg_id:"coa_c"},{coefficient:-1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"accoa_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"co2_c"}],label_x:1417.72802734375,label_y:3920.71923828125,gene_reaction_rule:"b0114 and b0115 and b0116"},1576700:{name:"Phosphoenolpyruvate carboxylase",bigg_id:"PPC",segments:{333:{to_node_id:"1576852",from_node_id:"1576854",b2:null,b1:null},334:{to_node_id:"1576853",from_node_id:"1576852",b2:null,b1:null},335:{to_node_id:"1576854",from_node_id:"1576516",b2:{y:3452.2308899862983,x:1334.4013835391315},b1:{y:3438.769633287661,x:1302.6712784637714}},336:{to_node_id:"1576854",from_node_id:"1576517",b2:{y:3440.1599283734054,x:1305.9484025944557},b1:{y:3398.5330945780183,x:1207.828008648186}},337:{to_node_id:"1576854",from_node_id:"1576518",b2:{y:3447.322871456709,x:1322.8324827193853},b1:{y:3422.409571522363,x:1264.1082757312843}},338:{to_node_id:"1576519",from_node_id:"1576853",b2:{y:3543.994528732819,x:1552.8353869664456},b1:{y:3526.498358619846,x:1510.9506160899336}},339:{to_node_id:"1576520",from_node_id:"1576853",b2:{y:3552.157197214914,x:1572.3763206054002},b1:{y:3528.947159164474,x:1516.81289618162}},340:{to_node_id:"1576521",from_node_id:"1576853",b2:{y:3691.624192938869,x:2580.289220436279},b1:{y:3708.0419942097856,x:1966.279649431665}}},genes:[{bigg_id:"b3956",name:"ppc"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"oaa_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"pep_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:-1,bigg_id:"co2_c"}],label_x:1490.0008544921875,label_y:3479.666748046875,gene_reaction_rule:"b3956"},1576701:{name:"Enolase",bigg_id:"ENO",segments:{341:{to_node_id:"1576856",from_node_id:"1576522",b2:{y:3175,x:1055},b1:{y:3173.322021484375,x:1055}},342:{to_node_id:"1576855",from_node_id:"1576856",b2:null,b1:null},343:{to_node_id:"1576517",from_node_id:"1576855",b2:{y:3320,x:1055},b1:{y:3281.5,x:1055}},344:{to_node_id:"1576523",from_node_id:"1576855",b2:{y:3319.0832691319597,x:1055},b1:{y:3281.224980739588,x:1055}}},genes:[{bigg_id:"b2779",name:"eno"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"pep_c"},{coefficient:1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"2pg_c"}],label_x:1065,label_y:3215,gene_reaction_rule:"b2779"},1576702:{name:"Glucose-6-phosphate isomerase",bigg_id:"PGI",segments:{345:{to_node_id:"1576857",from_node_id:"1576524",b2:{y:1330,x:1055},b1:{y:1284.5,x:1055}},346:{to_node_id:"1576525",from_node_id:"1576857",b2:{y:1470,x:1055},b1:{y:1417.5,x:1055}}},genes:[{bigg_id:"b4025",name:"pgi"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"g6p_c"},{coefficient:1,bigg_id:"f6p_c"}],label_x:1065,label_y:1385,gene_reaction_rule:"b4025"},1576703:{name:"Ammonia reversible transport",bigg_id:"NH4t",segments:{347:{to_node_id:"1576858",from_node_id:"1576526",b2:{y:4677.5,x:3989},b1:{y:4733.15,x:3989}},348:{to_node_id:"1576527",from_node_id:"1576858",b2:{y:4519.5,x:3989},b1:{y:4574.45,x:3989}}},genes:[{bigg_id:"b0451",name:"amtB"},{bigg_id:"s0001",name:"None"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"nh4_e"},{coefficient:1,bigg_id:"nh4_c"}],label_x:3999,label_y:4588,gene_reaction_rule:"s0001 or b0451"},1576704:{name:"Fructose-bisphosphatase",bigg_id:"FBP",segments:{349:{to_node_id:"1576859",from_node_id:"1576861",b2:null,b1:null},350:{to_node_id:"1576860",from_node_id:"1576859",b2:null,b1:null},351:{to_node_id:"1576861",from_node_id:"1576528",b2:{y:1782.1026313764871,x:835},b1:{y:1822.0087712549569,x:835}},352:{to_node_id:"1576861",from_node_id:"1576529",b2:{y:1805.8044115262064,x:835},b1:{y:1901.0147050873545,x:835}},353:{to_node_id:"1576525",from_node_id:"1576860",b2:{y:1539.7003591385833,x:835},b1:{y:1627.410107741575,x:835}},354:{to_node_id:"1576530",from_node_id:"1576860",b2:{y:1600.9687576256715,x:835},b1:{y:1645.7906272877015,x:835}}},genes:[{bigg_id:"b4232",name:"fbp"},{bigg_id:"b3925",name:"glpX"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"fdp_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"f6p_c"}],label_x:751.3809814453125,label_y:1733.561767578125,gene_reaction_rule:"b3925 or b4232"},1576705:{name:"Succinate exchange",bigg_id:"EX_succ_e",segments:{355:{to_node_id:"1576863",from_node_id:"1576531",b2:{y:2880,x:4978.5},b1:{y:2880,x:4945.95}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"succ_e"}],label_x:4968.927734375,label_y:2845.8271484375,gene_reaction_rule:""},1576706:{name:"Isocitrate lyase",bigg_id:"ICL",segments:{357:{to_node_id:"1576865",from_node_id:"1576505",b2:{y:3916.5,x:3415},b1:{y:3958.15,x:3413.6}},358:{to_node_id:"1576864",from_node_id:"1576865",b2:null,b1:null},359:{to_node_id:"1576532",from_node_id:"1576864",b2:{y:3612.2266277927156,x:3417},b1:{y:3719.8679883378145,x:3417}},360:{to_node_id:"1576533",from_node_id:"1576864",b2:{y:3316.4974972260998,x:3417},b1:{y:3631.14924916783,x:3417}}},genes:[{bigg_id:"b4015",name:"aceA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"succ_c"},{coefficient:1,bigg_id:"glx_c"},{coefficient:-1,bigg_id:"icit_c"}],label_x:3427,label_y:3847,gene_reaction_rule:"b4015"},1576707:{name:"Adenylate kinase",bigg_id:"ADK1",segments:{361:{to_node_id:"1576866",from_node_id:"1576867",b2:null,b1:null},362:{to_node_id:"1576536",from_node_id:"1576866",b2:{y:1441.4029541015625,x:4146.15869140625},b1:{y:1352.2913818359375,x:4145.83056640625}},363:{to_node_id:"1576867",from_node_id:"1576534",b2:{y:1173.8036262051405,x:4145},b1:{y:1112.6787540171351,x:4145}},364:{to_node_id:"1576867",from_node_id:"1576535",b2:{y:1177.1034937162894,x:4145},b1:{y:1123.6783123876312,x:4145}}},genes:[{bigg_id:"b0474",name:"adk"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"amp_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:2,bigg_id:"adp_c"}],label_x:3997.07177734375,label_y:1251.6114501953125,gene_reaction_rule:"b0474"},1576708:{name:"L-Glutamine exchange",bigg_id:"EX_gln__L_e",segments:{365:{to_node_id:"1576868",from_node_id:"1576537",b2:{y:4158,x:4951},b1:{y:4158,x:4902.7}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"gln__L_e"}],label_x:4933.3095703125,label_y:4131.884765625,gene_reaction_rule:""},1576710:{name:"CO2 exchange",bigg_id:"EX_co2_e",segments:{367:{to_node_id:"1576871",from_node_id:"1576544",b2:{y:4834,x:3621},b1:{y:4778,x:3621}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"co2_e"}],label_x:3631,label_y:4904,gene_reaction_rule:""},1576711:{name:"Transaldolase",bigg_id:"TALA",segments:{369:{to_node_id:"1576872",from_node_id:"1576873",b2:null,b1:null},370:{to_node_id:"1576874",from_node_id:"1576872",b2:null,b1:null},371:{to_node_id:"1576873",from_node_id:"1576545",b2:{y:1856.1727017464573,x:2173.815906732547},b1:{y:1892.1518443631908,x:2283.184776999114}},372:{to_node_id:"1576873",from_node_id:"1576546",b2:{y:1856.1728238167698,x:2175.402576654422},b1:{y:1890.5651744413158,x:2064.2112662569266}},373:{to_node_id:"1576547",from_node_id:"1576874",b2:{y:2171.7496092324754,x:2178},b1:{y:2076.976957965055,x:2178}},374:{to_node_id:"1576548",from_node_id:"1576874",b2:{y:2170.2455578331073,x:2178.000244140625},b1:{y:2077.4778177405574,x:2178}}},genes:[{bigg_id:"b2464",name:"talA"},{bigg_id:"b0008",name:"talB"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"s7p_c"},{coefficient:-1,bigg_id:"g3p_c"},{coefficient:1,bigg_id:"f6p_c"},{coefficient:1,bigg_id:"e4p_c"}],label_x:2197.5205078125,label_y:2008.8013916015625,gene_reaction_rule:"b2464 or b0008"},1576712:{name:"Pyruvate kinase",bigg_id:"PYK",segments:{375:{to_node_id:"1576876",from_node_id:"1576875",b2:null,b1:null},376:{to_node_id:"1576877",from_node_id:"1576876",b2:null,b1:null},377:{to_node_id:"1576875",from_node_id:"1576549",b2:{y:3640.769750529242,x:1055},b1:{y:3607.5658350974745,x:1055}},378:{to_node_id:"1576875",from_node_id:"1576550",b2:{y:3634.8195639293895,x:1055},b1:{y:3587.7318797646312,x:1055}},379:{to_node_id:"1576875",from_node_id:"1576517",b2:{y:3613,x:1055},b1:{y:3515,x:1055}},380:{to_node_id:"1576511",from_node_id:"1576877",b2:{y:3845,x:1055},b1:{y:3775,x:1055}},381:{to_node_id:"1576551",from_node_id:"1576877",b2:{y:3802.008771254957,x:1055},b1:{y:3762.102631376487,x:1055}}},genes:[{bigg_id:"b1854",name:"pykA"},{bigg_id:"b1676",name:"pykF"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pep_c"},{coefficient:-1,bigg_id:"adp_c"},{coefficient:1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"h_c"}],label_x:1065,label_y:3695,gene_reaction_rule:"b1854 or b1676"},1576713:{name:"L glutamate transport via proton symport  reversible",bigg_id:"GLUt2r",segments:{382:{to_node_id:"1576878",from_node_id:"1576880",b2:null,b1:null},383:{to_node_id:"1576879",from_node_id:"1576878",b2:null,b1:null},384:{to_node_id:"1576880",from_node_id:"1576552",b2:{y:3635,x:4794.600721137178},b1:{y:3635,x:4831.002403790594}},385:{to_node_id:"1576880",from_node_id:"1576553",b2:{y:3635,x:4791.314625451064},b1:{y:3635,x:4820.0487515035475}},386:{to_node_id:"1576554",from_node_id:"1576879",b2:{y:3635,x:4394.492321020364},b1:{y:3635,x:4497.047696306109}},387:{to_node_id:"1576555",from_node_id:"1576879",b2:{y:3635,x:4499.835695074495},b1:{y:3635,x:4528.650708522348}}},genes:[{bigg_id:"b4077",name:"gltP"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"glu__L_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"glu__L_e"},{coefficient:-1,bigg_id:"h_e"}],label_x:4655,label_y:3625,gene_reaction_rule:"b4077"},1576714:{name:"D-lactate exchange",bigg_id:"EX_lac__D_e",segments:{388:{to_node_id:"1576881",from_node_id:"1576556",b2:{y:4880,x:1055},b1:{y:4861.19384765625,x:1055}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"lac__D_e"}],label_x:1065,label_y:4915,gene_reaction_rule:""},1576715:{name:"Pyruvate exchange",bigg_id:"EX_pyr_e",segments:{390:{to_node_id:"1576884",from_node_id:"1576557",b2:{y:3945,x:215},b1:{y:3945,x:257}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pyr_e"}],label_x:96.76921081542969,label_y:3904.851318359375,gene_reaction_rule:""},1576716:{name:"Ribulose 5-phosphate 3-epimerase",bigg_id:"RPE",segments:{392:{to_node_id:"1576885",from_node_id:"1576493",b2:{y:1340,x:2100},b1:{y:1287.5,x:2138.5}},393:{to_node_id:"1576558",from_node_id:"1576885",b2:{y:1485,x:1995},b1:{y:1436,x:2030}}},genes:[{bigg_id:"b4301",name:"sgcE"},{bigg_id:"b3386",name:"rpe"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"xu5p__D_c"},{coefficient:-1,bigg_id:"ru5p__D_c"}],label_x:1937.57958984375,label_y:1422.4544677734375,gene_reaction_rule:"b3386 or b4301"},1576717:{name:"H+ exchange",bigg_id:"EX_h_e",segments:{394:{to_node_id:"1576887",from_node_id:"1576559",b2:{y:2229.5,x:4918},b1:{y:2229.15,x:4870.4}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"}],label_x:4920.2587890625,label_y:2195.827392578125,gene_reaction_rule:""},1576720:{name:"Succinyl-CoA synthetase (ADP-forming)",bigg_id:"SUCOAS",segments:{396:{to_node_id:"1576888",from_node_id:"1576889",b2:null,b1:null},397:{to_node_id:"1576890",from_node_id:"1576888",b2:null,b1:null},398:{to_node_id:"1576889",from_node_id:"1576567",b2:{y:2962.1615434463,x:3574.4760538225205},b1:{y:2929.871811487667,x:3542.920179408402}},399:{to_node_id:"1576889",from_node_id:"1576568",b2:{y:2964.923830429043,x:3577.1755615556553},b1:{y:2939.079434763476,x:3551.9185385188516}},400:{to_node_id:"1576889",from_node_id:"1576533",b2:{y:2954.5162418879845,x:3567.004509117803},b1:{y:2904.387472959949,x:3518.015030392677}},401:{to_node_id:"1576569",from_node_id:"1576890",b2:{y:3112.853617863234,x:3706.5785261677484},b1:{y:3077.95608535897,x:3678.1735578503244}},402:{to_node_id:"1576570",from_node_id:"1576890",b2:{y:3120.815793594307,x:3713.059366879087},b1:{y:3080.344738078292,x:3680.117810063726}},403:{to_node_id:"1576571",from_node_id:"1576890",b2:{y:3107.574578569538,x:3702.2816337193913},b1:{y:3076.3723735708613,x:3676.8844901158172}}},genes:[{bigg_id:"b0729",name:"sucD"},{bigg_id:"b0728",name:"sucC"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"coa_c"},{coefficient:1,bigg_id:"adp_c"},{coefficient:-1,bigg_id:"succ_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:1,bigg_id:"succoa_c"},{coefficient:1,bigg_id:"pi_c"}],label_x:3641,label_y:3010,gene_reaction_rule:"b0728 and b0729"},1576721:{name:"Phosphofructokinase",bigg_id:"PFK",segments:{404:{to_node_id:"1576891",from_node_id:"1576893",b2:null,b1:null},405:{to_node_id:"1576892",from_node_id:"1576891",b2:null,b1:null},406:{to_node_id:"1576893",from_node_id:"1576525",b2:{y:1668.25,x:1055},b1:{y:1617.5,x:1055}},407:{to_node_id:"1576893",from_node_id:"1576572",b2:{y:1674.9065411518764,x:1055},b1:{y:1639.6884705062548,x:1055}},408:{to_node_id:"1576573",from_node_id:"1576892",b2:{y:1822.4341649025257,x:1055},b1:{y:1789.2302494707578,x:1055}},409:{to_node_id:"1576529",from_node_id:"1576892",b2:{y:1850,x:1055},b1:{y:1797.5,x:1055}},410:{to_node_id:"1576574",from_node_id:"1576892",b2:{y:1835.2079728939614,x:1055},b1:{y:1793.0623918681883,x:1055}}},genes:[{bigg_id:"b1723",name:"pfkB"},{bigg_id:"b3916",name:"pfkA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"adp_c"},{coefficient:-1,bigg_id:"f6p_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:1,bigg_id:"fdp_c"}],label_x:1065,label_y:1725,gene_reaction_rule:"b3916 or b1723"},1576722:{name:"L-Glutamate exchange",bigg_id:"EX_glu__L_e",segments:{411:{to_node_id:"1576895",from_node_id:"1576552",b2:{y:3635,x:4949},b1:{y:3634.3,x:4902.8}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"glu__L_e"}],label_x:4936.36669921875,label_y:3680.79150390625,
gene_reaction_rule:""},1576723:{name:"Transketolase",bigg_id:"TKT2",segments:{413:{to_node_id:"1576896",from_node_id:"1576897",b2:null,b1:null},414:{to_node_id:"1576898",from_node_id:"1576896",b2:null,b1:null},415:{to_node_id:"1576897",from_node_id:"1576547",b2:{y:1735,x:1772.8736958157247},b1:{y:1735,x:1954.5789860524153}},416:{to_node_id:"1576897",from_node_id:"1576558",b2:{y:1735,x:1741.208765402248},b1:{y:1735,x:1849.0292180074937}},417:{to_node_id:"1576525",from_node_id:"1576898",b2:{y:1587.43115234375,x:1280.4546812716637},b1:{y:1741.3470458984375,x:1235.776382408843}},418:{to_node_id:"1576575",from_node_id:"1576898",b2:{y:1735,x:1312.7516245895065},b1:{y:1735,x:1318.2979239002893}}},genes:[{bigg_id:"b2465",name:"tktB"},{bigg_id:"b2935",name:"tktA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"xu5p__D_c"},{coefficient:-1,bigg_id:"e4p_c"},{coefficient:1,bigg_id:"g3p_c"},{coefficient:1,bigg_id:"f6p_c"}],label_x:1520.71923828125,label_y:1702.785400390625,gene_reaction_rule:"b2935 or b2465"},1576724:{name:"Glutamine synthetase",bigg_id:"GLNS",segments:{419:{to_node_id:"1576900",from_node_id:"1576901",b2:null,b1:null},420:{to_node_id:"1576899",from_node_id:"1576900",b2:null,b1:null},421:{to_node_id:"1576901",from_node_id:"1576554",b2:{y:3812.091159595566,x:4364},b1:{y:3725.970531985219,x:4364}},422:{to_node_id:"1576901",from_node_id:"1576576",b2:{y:3830.8679841164862,x:4364},b1:{y:3788.5599470549537,x:4364}},423:{to_node_id:"1576901",from_node_id:"1576577",b2:{y:3835.8273009599397,x:4364},b1:{y:3805.0910031997996,x:4364}},424:{to_node_id:"1576578",from_node_id:"1576899",b2:{y:4007.2677048056653,x:4364},b1:{y:3924.4803114416995,x:4364}},425:{to_node_id:"1576579",from_node_id:"1576899",b2:{y:3936.762432936357,x:4364},b1:{y:3903.3287298809073,x:4364}},426:{to_node_id:"1576580",from_node_id:"1576899",b2:{y:3956.314560089181,x:4364},b1:{y:3909.1943680267545,x:4364}},427:{to_node_id:"1576581",from_node_id:"1576899",b2:{y:3978.617241644675,x:4364},b1:{y:3915.8851724934025,x:4364}}},genes:[{bigg_id:"b3870",name:"glnA"},{bigg_id:"b1297",name:"puuA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"glu__L_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"nh4_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"adp_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"gln__L_c"}],label_x:4377.22314453125,label_y:3875.114990234375,gene_reaction_rule:"b3870 or b1297"},1576726:{name:"NAD transhydrogenase",bigg_id:"NADTRHD",segments:{434:{to_node_id:"1576907",from_node_id:"1576906",b2:null,b1:null},435:{to_node_id:"1576905",from_node_id:"1576907",b2:null,b1:null},436:{to_node_id:"1576906",from_node_id:"1576501",b2:{y:1270,x:3592.9455878111676},b1:{y:1270.0001220703125,x:3627.146913797642}},437:{to_node_id:"1576906",from_node_id:"1576500",b2:{y:1270,x:3595.5},b1:{y:1270,x:3655}},438:{to_node_id:"1576496",from_node_id:"1576905",b2:{y:1270,x:3400},b1:{y:1270,x:3449}},439:{to_node_id:"1576497",from_node_id:"1576905",b2:{y:1270,x:3418.3388104489154},b1:{y:1270,x:3446.2829175487373}}},genes:[{bigg_id:"b1602",name:"pntB"},{bigg_id:"b3962",name:"sthA"},{bigg_id:"b1603",name:"pntA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"nadh_c"},{coefficient:1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:-1,bigg_id:"nadph_c"}],label_x:3478.431396484375,label_y:1319.6259765625,gene_reaction_rule:"b3962 or (b1602 and b1603)"},1576727:{name:"2-Oxogluterate dehydrogenase",bigg_id:"AKGDH",segments:{440:{to_node_id:"1576909",from_node_id:"1576908",b2:null,b1:null},441:{to_node_id:"1576910",from_node_id:"1576909",b2:null,b1:null},442:{to_node_id:"1576908",from_node_id:"1576509",b2:{y:3502.6153909632244,x:3779.130177270645},b1:{y:3555.384636544082,x:3777.1005909021505}},443:{to_node_id:"1576908",from_node_id:"1576585",b2:{y:3494.907757737772,x:3779.4266247023934},b1:{y:3529.6925257925727,x:3778.088749007978}},444:{to_node_id:"1576908",from_node_id:"1576586",b2:{y:3498.5402671676266,x:3779.2869128012453},b1:{y:3541.8008905587553,x:3777.623042670817}},445:{to_node_id:"1576570",from_node_id:"1576910",b2:{y:3259.378766045427,x:3769.134046698861},b1:{y:3308.813629813628,x:3773.940214009658}},446:{to_node_id:"1576587",from_node_id:"1576910",b2:{y:3277.236984619066,x:3770.8702623935205},b1:{y:3314.1710953857196,x:3774.4610787180563}},447:{to_node_id:"1576588",from_node_id:"1576910",b2:{y:3276.99346892041,x:3770.846587256151},b1:{y:3314.098040676123,x:3774.453976176845}}},genes:[{bigg_id:"b0116",name:"lpd"},{bigg_id:"b0726",name:"sucA"},{bigg_id:"b0727",name:"sucB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"nadh_c"},{coefficient:-1,bigg_id:"coa_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:1,bigg_id:"succoa_c"},{coefficient:-1,bigg_id:"akg_c"}],label_x:3793,label_y:3392,gene_reaction_rule:"b0116 and b0726 and b0727"},1576728:{name:"Pyruvate formate lyase",bigg_id:"PFL",segments:{448:{to_node_id:"1576911",from_node_id:"1576912",b2:null,b1:null},449:{to_node_id:"1576913",from_node_id:"1576911",b2:null,b1:null},450:{to_node_id:"1576912",from_node_id:"1576589",b2:{y:3995,x:1239.5565547885194},b1:{y:3995,x:1203.521849295065}},451:{to_node_id:"1576912",from_node_id:"1576511",b2:{y:3995,x:1224.0767078078675},b1:{y:3995,x:1151.9223593595584}},452:{to_node_id:"1576514",from_node_id:"1576913",b2:{y:3995,x:1567.0690632574556},b1:{y:3995,x:1460.6207189772367}},453:{to_node_id:"1576590",from_node_id:"1576913",b2:{y:3995,x:1469.8292804986534},b1:{y:3995,x:1431.4487841495961}}},genes:[{bigg_id:"b3114",name:"tdcE"},{bigg_id:"b3951",name:"pflD"},{bigg_id:"b3952",name:"pflC"},{bigg_id:"b0903",name:"pflB"},{bigg_id:"b0902",name:"pflA"},{bigg_id:"b2579",name:"grcA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pyr_c"},{coefficient:-1,bigg_id:"coa_c"},{coefficient:1,bigg_id:"accoa_c"},{coefficient:1,bigg_id:"for_c"}],label_x:1310.09130859375,label_y:4046.8837890625,gene_reaction_rule:"((b0902 and b0903) and b2579) or (b0902 and b0903) or (b0902 and b3114) or (b3951 and b3952)"},1576729:{name:"O2 exchange",bigg_id:"EX_o2_e",segments:{454:{to_node_id:"1576914",from_node_id:"1576494",b2:{y:1660,x:4910},b1:{y:1660,x:4868}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"o2_e"}],label_x:4894.58984375,label_y:1633.8848876953125,gene_reaction_rule:""},1576730:{name:"Phosphoenolpyruvate carboxykinase",bigg_id:"PPCK",segments:{456:{to_node_id:"1576916",from_node_id:"1576917",b2:null,b1:null},457:{to_node_id:"1576918",from_node_id:"1576916",b2:null,b1:null},458:{to_node_id:"1576917",from_node_id:"1576591",b2:{y:3557.6148705803193,x:1495.4573041787805},b1:{y:3566.049568601064,x:1519.8576805959353}},459:{to_node_id:"1576917",from_node_id:"1576521",b2:{y:3678.777694102544,x:1757.8986662821364},b1:{y:3758.886258987647,x:2521.6033016696215}},460:{to_node_id:"1576592",from_node_id:"1576918",b2:{y:3492.675272400688,x:1304.0258172020633},b1:{y:3499.9025817202064,x:1325.707745160619}},461:{to_node_id:"1576593",from_node_id:"1576918",b2:{y:3483.931701701515,x:1277.7951051045454},b1:{y:3497.2795105104547,x:1317.8385315313635}},462:{to_node_id:"1576517",from_node_id:"1576918",b2:{y:3454.321462634956,x:1188.9643879048676},b1:{y:3488.3964387904866,x:1291.1893163714603}}},genes:[{bigg_id:"b3403",name:"pck"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"pep_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"oaa_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:1,bigg_id:"adp_c"}],label_x:1377.3328857421875,label_y:3600.33447265625,gene_reaction_rule:"b3403"},1576731:{name:"Phosphate reversible transport via symport",bigg_id:"PIt2r",segments:{463:{to_node_id:"1576920",from_node_id:"1576921",b2:null,b1:null},464:{to_node_id:"1576919",from_node_id:"1576920",b2:null,b1:null},465:{to_node_id:"1576921",from_node_id:"1576594",b2:{y:4742.1,x:2880},b1:{y:4782,x:2880}},466:{to_node_id:"1576921",from_node_id:"1576595",b2:{y:4740.280870394058,x:2880},b1:{y:4775.936234646861,x:2880}},467:{to_node_id:"1576596",from_node_id:"1576919",b2:{y:4464.789040942943,x:2880},b1:{y:4503.436712282883,x:2880}},468:{to_node_id:"1576597",from_node_id:"1576919",b2:{y:4475,x:2880},b1:{y:4506.5,x:2880}}},genes:[{bigg_id:"b3493",name:"pitA"},{bigg_id:"b2987",name:"pitB"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:-1,bigg_id:"pi_e"}],label_x:2916.97509765625,label_y:4649.33837890625,gene_reaction_rule:"b2987 or b3493"},1576732:{name:"2 oxoglutarate reversible transport via symport",bigg_id:"AKGt2r",segments:{469:{to_node_id:"1576924",from_node_id:"1576923",b2:null,b1:null},470:{to_node_id:"1576922",from_node_id:"1576924",b2:null,b1:null},471:{to_node_id:"1576923",from_node_id:"1576598",b2:{y:3228,x:4811.5},b1:{y:3228,x:4857}},472:{to_node_id:"1576923",from_node_id:"1576599",b2:{y:3228,x:4807.306616216525},b1:{y:3228,x:4843.0220540550845}},473:{to_node_id:"1576509",from_node_id:"1576922",b2:{y:3228,x:4074.584218822},b1:{y:3228,x:4373.7752656466}},474:{to_node_id:"1576600",from_node_id:"1576922",b2:{y:3228,x:4449.798467455447},b1:{y:3228,x:4486.339540236634}}},genes:[{bigg_id:"b2587",name:"kgtP"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"},{coefficient:1,bigg_id:"akg_c"},{coefficient:-1,bigg_id:"akg_e"},{coefficient:1,bigg_id:"h_c"}],label_x:4594.6474609375,label_y:3197.05029296875,gene_reaction_rule:"b2587"},1576733:{name:"Fructose-bisphosphate aldolase",bigg_id:"FBA",segments:{53:{to_node_id:"1576925",from_node_id:"1576926",b2:null,b1:null},54:{to_node_id:"1576575",from_node_id:"1576925",b2:{y:2120,x:1055},b1:{y:2067.5,x:1055}},55:{to_node_id:"1576601",from_node_id:"1576925",b2:{y:2081.141357421875,x:929.645751953125},b1:{y:2082.5,x:1055}},475:{to_node_id:"1576926",from_node_id:"1576529",b2:{y:1974.28076171875,x:1055},b1:{y:1970.4088134765625,x:1055}}},genes:[{bigg_id:"b2097",name:"fbaB"},{bigg_id:"b2925",name:"fbaA"},{bigg_id:"b1773",name:"ydjI"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"dhap_c"},{coefficient:1,bigg_id:"g3p_c"},{coefficient:-1,bigg_id:"fdp_c"}],label_x:969.7942504882812,label_y:2031.01611328125,gene_reaction_rule:"b2097 or b1773 or b2925"},1576734:{name:"Triose-phosphate isomerase",bigg_id:"TPI",segments:{56:{to_node_id:"1576927",from_node_id:"1576601",b2:{y:2195,x:911.3470458984375},b1:{y:2195,x:911.255859375}},57:{to_node_id:"1576575",from_node_id:"1576927",b2:{y:2195,x:1005},b1:{y:2195,x:970}}},genes:[{bigg_id:"b3919",name:"tpiA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"dhap_c"},{coefficient:1,bigg_id:"g3p_c"}],label_x:936.438232421875,label_y:2245.297119140625,gene_reaction_rule:"b3919"},1576735:{name:"Cytochrome oxidase bd (ubiquinol-8: 2 protons)",bigg_id:"CYTBD",segments:{58:{to_node_id:"1576928",from_node_id:"1576930",b2:null,b1:null},59:{to_node_id:"1576929",from_node_id:"1576928",b2:null,b1:null},60:{to_node_id:"1576930",from_node_id:"1576602",b2:{y:1900,x:4595.5},b1:{y:1895.1654052734375,x:4416.69775390625}},61:{to_node_id:"1576930",from_node_id:"1576495",b2:{y:1900,x:4572.371881863104},b1:{y:1900,x:4437.906272877015}},62:{to_node_id:"1576930",from_node_id:"1576542",b2:{y:1900,x:4581.906341374356},b1:{y:1890.3310546875,x:4368.162902237436}},63:{to_node_id:"1576539",from_node_id:"1576929",b2:{y:1903.22314453125,x:4842.38515985191},b1:{y:1900,x:4715.894014752448}},64:{to_node_id:"1576603",from_node_id:"1576929",b2:{y:1900,x:4775},b1:{y:1900,x:4715.5}},65:{to_node_id:"1576604",from_node_id:"1576929",b2:{y:1758.1868896484375,x:4884.545828600423},b1:{y:1901.611572265625,x:4821.203885298877}}},genes:[{bigg_id:"b0978",name:"cbdA"},{bigg_id:"b0734",name:"cydB"},{bigg_id:"b0979",name:"cbdB"},{bigg_id:"b0733",name:"cydA"}],reversibility:!1,metabolites:[{coefficient:-.5,bigg_id:"o2_c"},{coefficient:1,bigg_id:"q8_c"},{coefficient:2,bigg_id:"h_e"},{coefficient:-1,bigg_id:"q8h2_c"},{coefficient:-2,bigg_id:"h_c"},{coefficient:1,bigg_id:"h2o_c"}],label_x:4560.4169921875,label_y:1954.46044921875,gene_reaction_rule:"(b0978 and b0979) or (b0733 and b0734)"},1576736:{name:"Ribose-5-phosphate isomerase",bigg_id:"RPI",segments:{66:{to_node_id:"1576931",from_node_id:"1576605",b2:{y:1490,x:2362},b1:{y:1535.5,x:2401.9}},67:{to_node_id:"1576493",from_node_id:"1576931",b2:{y:1345,x:2230},b1:{y:1401,x:2282.5}}},genes:[{bigg_id:"b2914",name:"rpiA"},{bigg_id:"b4090",name:"rpiB"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"ru5p__D_c"},{coefficient:-1,bigg_id:"r5p_c"}],label_x:2315,label_y:1415,gene_reaction_rule:"b2914 or b4090"},1576737:{name:"Malate synthase",bigg_id:"MALS",segments:{68:{to_node_id:"1576934",from_node_id:"1576933",b2:null,b1:null},69:{to_node_id:"1576932",from_node_id:"1576934",b2:null,b1:null},70:{to_node_id:"1576933",from_node_id:"1576532",b2:{y:3464.029731004742,x:3021.7099591823435},b1:{y:3508.4324366824735,x:3086.3665306078124}},71:{to_node_id:"1576933",from_node_id:"1576606",b2:{y:3455.108224908018,x:3008.7189941643073},b1:{y:3478.694083026728,x:3043.063313881025}},72:{to_node_id:"1576933",from_node_id:"1576607",b2:{y:3460.23788356471,x:3016.1884971205427},b1:{y:3495.7929452157005,x:3067.961657068476}},73:{to_node_id:"1576608",from_node_id:"1576932",b2:{y:3305.691868266011,x:2791.915894512527},b1:{y:3330.4075604798036,x:2827.674768353758}},74:{to_node_id:"1576609",from_node_id:"1576932",b2:{y:3288.6581354094164,x:2767.2713448476666},b1:{y:3325.297440622825,x:2820.2814034543}},75:{to_node_id:"1576504",from_node_id:"1576932",b2:{y:3264.9901959981144,x:2733.0283686781227},b1:{y:3318.197058799434,x:2810.0085106034367}}},genes:[{bigg_id:"b2976",name:"glcB"},{bigg_id:"b4014",name:"aceB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"coa_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"mal__L_c"},{coefficient:-1,bigg_id:"accoa_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"glx_c"}],label_x:2921,label_y:3378,gene_reaction_rule:"b4014 or b2976"},1576739:{name:"Phosphotransacetylase",bigg_id:"PTAr",segments:{76:{to_node_id:"1576937",from_node_id:"1576935",b2:null,b1:null},77:{to_node_id:"1576936",from_node_id:"1576937",b2:null,b1:null},78:{to_node_id:"1576935",from_node_id:"1576514",b2:{y:4047,x:1715},b1:{y:4005,x:1715}},79:{to_node_id:"1576935",from_node_id:"1576612",b2:{y:4049.339540236634,x:1715},b1:{y:4012.7984674554473,x:1715}},80:{to_node_id:"1576613",from_node_id:"1576936",b2:{y:4140,x:1715},b1:{y:4115.5,x:1715}},81:{to_node_id:"1576614",from_node_id:"1576936",b2:{y:4157.201532544553,x:1715},b1:{y:4120.660459763366,x:1715}}},genes:[{bigg_id:"b2297",name:"pta"},{bigg_id:"b2458",name:"eutD"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"accoa_c"},{coefficient:1,bigg_id:"actp_c"},{coefficient:-1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"coa_c"}],label_x:1725,label_y:4075,gene_reaction_rule:"b2297 or b2458"},1576741:{name:"GLNabc",bigg_id:"GLNabc",segments:{82:{to_node_id:"1576939",from_node_id:"1576940",b2:null,b1:null},83:{to_node_id:"1576938",from_node_id:"1576939",b2:null,b1:null},84:{to_node_id:"1576940",from_node_id:"1576537",b2:{y:4158,x:4519.05},b1:{y:4158,x:4668.5}},85:{to_node_id:"1576940",from_node_id:"1576615",b2:{y:4158,x:4474.209372712298},b1:{y:4158,x:4519.031242374329}},86:{to_node_id:"1576940",from_node_id:"1576616",b2:{y:4158,x:4470.660459763366},b1:{y:4158,x:4507.201532544553}},87:{to_node_id:"1576578",from_node_id:"1576938",b2:{y:4158,x:4324.643760591755},b1:{y:4158,x:4387.893128177527}},88:{to_node_id:"1576617",from_node_id:"1576938",b2:{y:4158,x:4332.993902665717},b1:{y:4158,x:4390.398170799715}},89:{to_node_id:"1576618",from_node_id:"1576938",b2:{y:4158,x:4362.798467455447},b1:{y:4158,x:4399.339540236634}},90:{to_node_id:"1576619",from_node_id:"1576938",b2:{y:4158,x:4350.968757625671},b1:{y:4158,x:4395.790627287702}}},genes:[{bigg_id:"b0811",name:"glnH"},{bigg_id:"b0810",name:"glnP"},{bigg_id:"b0809",name:"glnQ"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"gln__L_e"},{coefficient:1,bigg_id:"adp_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"gln__L_c"}],label_x:4535.24462890625,label_y:4133.49658203125,gene_reaction_rule:"b0811 and b0810 and b0809"},1576742:{name:"Malic enzyme (NAD)",bigg_id:"ME1",segments:{91:{to_node_id:"1576942",from_node_id:"1576941",b2:null,b1:null},92:{to_node_id:"1576943",from_node_id:"1576942",b2:null,b1:null},93:{to_node_id:"1576941",from_node_id:"1576504",b2:{y:3307.175835174097,x:2355.6483296518063},b1:{y:3253.9194505803225,x:2462.161098839355}},94:{to_node_id:"1576941",from_node_id:"1576620",b2:{y:3321.8944463483363,x:2326.2111073033275},b1:{y:3302.9814878277875,x:2364.0370243444254}},95:{to_node_id:"1576511",from_node_id:"1576943",b2:{y:3870.856276574083,x:1117.2138384533964},b1:{y:3474.7533185191,x:2020.4933629618001}},96:{to_node_id:"1576621",from_node_id:"1576943",b2:{y:3419.8328677803524,x:2130.3342644392947},b1:{y:3398.949860334106,x:2172.1002793317884}},97:{to_node_id:"1576622",from_node_id:"1576943",b2:{y:3415,x:2140},b1:{y:3397.5,x:2175}}},genes:[{bigg_id:"b1479",name:"maeA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"mal__L_c"},{coefficient:1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"nadh_c"}],label_x:2188.595703125,label_y:3321.438232421875,gene_reaction_rule:"b1479"},1576743:{name:"Glucose 6-phosphate dehydrogenase",bigg_id:"G6PDH2r",segments:{98:{to_node_id:"1576945",from_node_id:"1576946",b2:null,b1:null},99:{to_node_id:"1576944",from_node_id:"1576945",b2:null,b1:null},100:{to_node_id:"1576946",from_node_id:"1576623",b2:{y:1265,x:1270.6197527491188},b1:{y:1265,x:1232.3991758303962}},101:{to_node_id:"1576946",from_node_id:"1576524",b2:{y:1265,x:1252.2},b1:{y:1265,x:1171}},102:{to_node_id:"1576624",from_node_id:"1576944",b2:{y:1265,x:1393.0018939122203},b1:{y:1265,x:1346.800568173666}},103:{to_node_id:"1576625",from_node_id:"1576944",b2:{y:1265,x:1381.6008241696038},b1:{y:1265,x:1343.3802472508812}},104:{to_node_id:"1576626",from_node_id:"1576944",b2:{y:1265,x:1417},b1:{y:1265,x:1354}}},genes:[{bigg_id:"b1852",name:"zwf"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"g6p_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:1,bigg_id:"nadph_c"},{coefficient:1,bigg_id:"6pgl_c"}],label_x:1261.46337890625,label_y:1320.0572509765625,gene_reaction_rule:"b1852"},1576744:{name:"Acetate exchange",bigg_id:"EX_ac_e",segments:{105:{to_node_id:"1576947",from_node_id:"1576627",b2:{y:4890,x:1715},b1:{y:4888.64794921875,x:1715}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"ac_e"}],label_x:1742.4544677734375,label_y:4917.06640625,gene_reaction_rule:""},1576745:{name:"Glutaminase",bigg_id:"GLUN",segments:{107:{to_node_id:"1576951",from_node_id:"1576950",b2:null,b1:null},108:{to_node_id:"1576949",from_node_id:"1576951",b2:null,b1:null},109:{to_node_id:"1576950",from_node_id:"1576628",b2:{y:3888.700961498954,x:4247},b1:{y:3916.003204996513,x:4247}},110:{to_node_id:"1576950",from_node_id:"1576578",b2:{y:3909.550345620285,x:4247},b1:{y:3985.501152067616,x:4247}},111:{to_node_id:"1576629",from_node_id:"1576949",b2:{y:3777.1681351239463,x:4247},b1:{y:3803.650440537184,x:4247}},112:{to_node_id:"1576554",from_node_id:"1576949",b2:{y:3723.4986338899794,x:4247},b1:{y:3787.5495901669938,x:4247}}},genes:[{bigg_id:"b1524",name:"glsB"},{bigg_id:"b0485",name:"glsA"},{bigg_id:"b1812",name:"pabB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"glu__L_c"},{coefficient:-1,bigg_id:"gln__L_c"},{coefficient:1,bigg_id:"nh4_c"},{coefficient:-1,bigg_id:"h2o_c"}],label_x:4253.77685546875,label_y:3866.338134765625,gene_reaction_rule:"b1812 or b0485 or b1524"},1576746:{name:"ATP maintenance requirement",bigg_id:"ATPM",segments:{113:{to_node_id:"1576953",from_node_id:"1576952",b2:null,b1:null},114:{to_node_id:"1576954",from_node_id:"1576953",b2:null,b1:null},115:{to_node_id:"1576952",from_node_id:"1576534",b2:{y:1176,x:4215},b1:{y:1120,x:4215}},116:{to_node_id:"1576952",from_node_id:"1576630",b2:{y:1187.2720779386423,x:4215},b1:{y:1157.5735931288073,x:4215}},117:{to_node_id:"1576631",from_node_id:"1576954",b2:{y:1411.0327780786686,x:4215},b1:{y:1368.3098334236006,x:4215}},118:{to_node_id:"1576632",from_node_id:"1576954",b2:{y:1388.0788655293195,x:4215},b1:{y:1361.423659658796,x:4215}},119:{to_node_id:"1576536",from_node_id:"1576954",b2:{y:1430,x:4215},b1:{y:1374,x:4215}}},genes:[],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"adp_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"pi_c"}],label_x:4241.11474609375,label_y:1266.1151123046875,gene_reaction_rule:""},1576747:{name:"D-lactate dehydrogenase",bigg_id:"LDH_D",segments:{120:{to_node_id:"1576957",from_node_id:"1576956",b2:null,b1:null},121:{to_node_id:"1576955",from_node_id:"1576957",b2:null,b1:null},122:{to_node_id:"1576956",from_node_id:"1576633",b2:{y:4240.660459763366,x:1055},b1:{y:4277.201532544553,x:1055}},123:{to_node_id:"1576956",from_node_id:"1576584",b2:{y:4243,x:1055},b1:{y:4285,x:1055}},124:{to_node_id:"1576634",from_node_id:"1576955",b2:{y:4060.9687576256715,x:1055},b1:{y:4105.790627287702,x:1055}},125:{to_node_id:"1576511",from_node_id:"1576955",b2:{y:4035,x:1055},b1:{y:4098,x:1055}},126:{to_node_id:"1576635",from_node_id:"1576955",b2:{y:4072.7984674554473,x:1055},b1:{y:4109.339540236634,x:1055}}},genes:[{bigg_id:"b1380",name:"ldhA"},{bigg_id:"b2133",name:"dld"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"lac__D_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"nadh_c"}],label_x:1065,label_y:4165,gene_reaction_rule:"b2133 or b1380"},1576748:{name:"Malate dehydrogenase",bigg_id:"MDH",segments:{127:{to_node_id:"1576959",from_node_id:"1576960",b2:null,b1:null},128:{to_node_id:"1576958",from_node_id:"1576959",b2:null,b1:null},129:{to_node_id:"1576960",from_node_id:"1576504",b2:{y:3317.969496697346,x:2583.827817722433},b1:{y:3264.23165565782,x:2588.092725741443}},130:{to_node_id:"1576960",from_node_id:"1576636",b2:{y:3327.0487806839114,x:2583.107239628261},b1:{y:3294.4959356130375,x:2585.69079876087}},131:{to_node_id:"1576637",from_node_id:"1576958",b2:{y:3538.2116199944217,x:2579.5809926922},b1:{y:3480.6634859983265,x:2578.47429780766}},132:{to_node_id:"1576638",from_node_id:"1576958",b2:{y:3505.0826757349405,x:2578.9438976102874},b1:{y:3470.7248027204823,x:2578.2831692830864}},133:{to_node_id:"1576521",from_node_id:"1576958",b2:{y:3595.960728582294,x:2580.6915524727365},b1:{y:3497.9882185746883,x:2578.807465741821}}},genes:[{bigg_id:"b3236",name:"mdh"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"mal__L_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"oaa_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"nadh_c"}],label_x:2587,label_y:3394,gene_reaction_rule:"b3236"},1576749:{name:"H2O transport via diffusion",bigg_id:"H2Ot",segments:{134:{to_node_id:"1576961",from_node_id:"1576639",b2:{y:4684,x:3257},b1:{y:4733,x:3257}},135:{to_node_id:"1576640",from_node_id:"1576961",b2:{y:4524,x:3257},b1:{y:4587,x:3257}}},genes:[{bigg_id:"s0001",name:"None"},{bigg_id:"b0875",name:"aqpZ"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"h2o_e"}],label_x:3267,label_y:4604,gene_reaction_rule:"b0875 or s0001"},1576750:{name:"H2O exchange",bigg_id:"EX_h2o_e",segments:{136:{to_node_id:"1576962",from_node_id:"1576639",b2:{y:4839,x:3257},b1:{y:4779.5,x:3257}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h2o_e"}],label_x:3267,label_y:4914,gene_reaction_rule:""},1576751:{name:"Transketolase",bigg_id:"TKT1",segments:{138:{to_node_id:"1576965",from_node_id:"1576964",b2:null,b1:null},139:{to_node_id:"1576966",from_node_id:"1576965",b2:null,b1:null},140:{to_node_id:"1576964",from_node_id:"1576605",b2:{y:1605.9896167668144,x:2175},b1:{y:1557.80791851959,x:2171.826416015625}},141:{to_node_id:"1576964",from_node_id:"1576558",b2:{y:1607.9527328943145,x:2175},b1:{y:1558.0047151164654,x:2171.82666015625}},142:{to_node_id:"1576546",from_node_id:"1576966",b2:{y:1816.322080948729,x:2070.2734375},b1:{y:1823.819109636181,x:2173.413330078125}},143:{to_node_id:"1576545",from_node_id:"1576966",b2:{y:1821.0824569252916,x:2297.1806640625},b1:{y:1822.232439714306,x:2175}}},genes:[{bigg_id:"b2465",name:"tktB"},{bigg_id:"b2935",name:"tktA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"xu5p__D_c"},{coefficient:-1,bigg_id:"r5p_c"},{coefficient:1,bigg_id:"g3p_c"},{coefficient:1,bigg_id:"s7p_c"}],label_x:2185,label_y:1685,gene_reaction_rule:"b2935 or b2465"},1576752:{name:"CO2 transporter via diffusion",bigg_id:"CO2t",segments:{144:{to_node_id:"1576967",from_node_id:"1576544",b2:{y:4679,x:3621},b1:{y:4731.5,x:3621}},145:{to_node_id:"1576641",from_node_id:"1576967",b2:{y:4519,x:3621},b1:{y:4578.5,x:3621}}},genes:[{bigg_id:"s0001",name:"None"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"co2_e"},{coefficient:1,bigg_id:"co2_c"}],label_x:3631,label_y:4594,gene_reaction_rule:"s0001"},1576753:{name:"2-Oxoglutarate exchange",bigg_id:"EX_akg_e",segments:{146:{to_node_id:"1576969",from_node_id:"1576598",b2:{y:3228,x:4977},b1:{y:3228,x:4938.5}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"akg_e"}],label_x:5042,label_y:3218,gene_reaction_rule:""},1576754:{name:"Phosphoenolpyruvate synthase",bigg_id:"PPS",segments:{148:{to_node_id:"1576972",from_node_id:"1576970",b2:null,b1:null},149:{to_node_id:"1576971",from_node_id:"1576972",b2:null,b1:null},150:{to_node_id:"1576970",from_node_id:"1576642",b2:{y:3821.7705098312485,x:835},b1:{y:3860.9016994374947,x:835}},151:{to_node_id:"1576970",from_node_id:"1576511",b2:{y:3844.115214431216,x:835},b1:{y:3935.384048104053,x:835}},152:{to_node_id:"1576970",from_node_id:"1576643",b2:{y:3820,x:835},b1:{y:3855,x:835}},153:{to_node_id:"1576517",from_node_id:"1576971",b2:{y:3391.8647304430565,x:835},b1:{y:3485.059419132917,x:835}},154:{to_node_id:"1576644",from_node_id:"1576971",b2:{y:3469.0983005625053,x:835},b1:{y:3508.2294901687515,x:835}},155:{to_node_id:"1576645",from_node_id:"1576971",b2:{y:3475,x:835},b1:{y:3510,x:835}},156:{to_node_id:"1576646",from_node_id:"1576971",b2:{y:3454.289321881345,x:835},b1:{y:3503.7867965644036,x:835}}},genes:[{bigg_id:"b1702",name:"ppsA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pyr_c"},{coefficient:-1,bigg_id:"atp_c"},{coefficient:1,bigg_id:"amp_c"},{coefficient:1,bigg_id:"pep_c"},{coefficient:2,bigg_id:"h_c"},{coefficient:1,bigg_id:"pi_c"},{coefficient:-1,bigg_id:"h2o_c"}],label_x:741.8604125976562,label_y:3669.90869140625,gene_reaction_rule:"b1702"},1576755:{name:"D-Glucose exchange",bigg_id:"EX_glc__D_e",segments:{157:{to_node_id:"1576974",from_node_id:"1576647",b2:{y:623.4132690429688,x:1056.6529541015625},b1:{y:625.4632568359375,x:1055.066162109375}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"glc__D_e"}],label_x:1082.5206298828125,label_y:598.4705200195312,gene_reaction_rule:""},1576756:{name:"ETOHt2r",bigg_id:"ETOHt2r",segments:{159:{to_node_id:"1576976",from_node_id:"1576977",b2:null,b1:null},160:{to_node_id:"1576975",from_node_id:"1576976",b2:null,b1:null},161:{to_node_id:"1576977",from_node_id:"1576648",b2:{y:4745.660459763366,x:2500},b1:{y:4782.201532544553,x:2500}},162:{to_node_id:"1576977",from_node_id:"1576649",b2:{y:4745,x:2500},b1:{y:4780,x:2500}},163:{to_node_id:"1576650",from_node_id:"1576975",b2:{y:4377.798467455447,x:2500},b1:{y:4414.339540236634,x:2500}},164:{to_node_id:"1576829",from_node_id:"1576975",b2:{y:4328.998762383821,x:2500},b1:{y:4399.699628715146,x:2500}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"},{coefficient:1,bigg_id:"etoh_c"},{coefficient:-1,bigg_id:"etoh_e"},{coefficient:1,bigg_id:"h_c"}],label_x:2530.6279296875,label_y:4611.404296875,gene_reaction_rule:""},1576757:{name:"Phosphoglycerate mutase",bigg_id:"PGM",segments:{165:{to_node_id:"1576978",from_node_id:"1576522",b2:{y:3060,x:1055},b1:{y:3105.5,x:1055}},166:{to_node_id:"1576486",from_node_id:"1576978",b2:{y:2935,x:1055},b1:{y:2977,x:1055}}},genes:[{bigg_id:"b3612",name:"gpmM"},{bigg_id:"b4395",name:"ytjC"},{bigg_id:"b0755",name:"gpmA"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"3pg_c"},{coefficient:-1,bigg_id:"2pg_c"}],label_x:1065,label_y:2985,gene_reaction_rule:"b3612 or b4395 or b0755"},1576758:{name:"Ethanol exchange",bigg_id:"EX_etoh_e",segments:{167:{to_node_id:"1576980",from_node_id:"1576649",b2:{y:4887.93359375,x:2500},b1:{y:4875.1484375,x:2500}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"etoh_e"}],label_x:2519.520751953125,label_y:4934.28076171875,gene_reaction_rule:""},1576759:{name:"Acetate kinase",bigg_id:"ACKr",segments:{169:{to_node_id:"1576982",from_node_id:"1576981",b2:null,b1:null},170:{to_node_id:"1576983",from_node_id:"1576982",b2:null,b1:null},171:{to_node_id:"1576981",from_node_id:"1576651",b2:{y:4320.660459763366,x:1715},b1:{y:4357.201532544553,x:1715}},172:{to_node_id:"1576981",from_node_id:"1576652",b2:{y:4317,x:1715},b1:{y:4345,x:1715}},173:{to_node_id:"1576653",from_node_id:"1576983",b2:{y:4202.798467455447,x:1715},b1:{y:4239.339540236634,x:1715}},174:{to_node_id:"1576613",from_node_id:"1576983",b2:{y:4215,x:1715},b1:{y:4243,x:1715}}},genes:[{bigg_id:"b2296",name:"ackA"},{bigg_id:"b3115",name:"tdcD"},{bigg_id:"b1849",name:"purT"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"adp_c"},{coefficient:-1,bigg_id:"ac_c"},{coefficient:1,bigg_id:"actp_c"},{coefficient:-1,bigg_id:"atp_c"}],label_x:1737.694091796875,label_y:4293.5615234375,gene_reaction_rule:"b3115 or b2296 or b1849"},1576760:{name:"Ammonia exchange",bigg_id:"EX_nh4_e",segments:{175:{to_node_id:"1576985",from_node_id:"1576526",b2:{y:4837.5,x:3990},b1:{y:4781.15,x:3989.3}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"nh4_e"}],label_x:4001,label_y:4908,gene_reaction_rule:""},1576761:{name:"Glutamate synthase (NADPH)",bigg_id:"GLUSy",segments:{177:{to_node_id:"1576988",from_node_id:"1576986",b2:null,b1:null},178:{to_node_id:"1576987",from_node_id:"1576988",b2:null,b1:null},179:{to_node_id:"1576986",from_node_id:"1576509",b2:{y:4155.746259618145,x:4119.22314453125},b1:{y:4145.014875810485,x:3943.568359375}},180:{to_node_id:"1576986",from_node_id:"1576654",b2:{y:3902.6240384299276,x:4116},b1:{y:3936.7467947664254,x:4116}},181:{to_node_id:"1576986",from_node_id:"1576578",b2:{y:3924.538472874492,x:4116},b1:{y:4009.7949095816407,x:4116}},182:{to_node_id:"1576986",from_node_id:"1576655",b2:{y:3907.2123007471773,x:4116},b1:{y:3952.041002490592,x:4116}},183:{to_node_id:"1576656",from_node_id:"1576987",b2:{y:3790.445677833893,x:4116},b1:{y:3830.733703350168,x:4116}},184:{to_node_id:"1576554",from_node_id:"1576987",b2:{y:3721.4298613416263,x:4116},b1:{y:3810.0289584024877,x:4116}}},genes:[{bigg_id:"b3212",name:"gltB"},{bigg_id:"b3213",name:"gltD"}],reversibility:!1,metabolites:[{coefficient:2,bigg_id:"glu__L_c"},{coefficient:1,bigg_id:"nadp_c"},{coefficient:-1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nadph_c"},{coefficient:-1,bigg_id:"gln__L_c"},{coefficient:-1,bigg_id:"akg_c"}],label_x:3984.18701171875,label_y:3851.553955078125,gene_reaction_rule:"b3212 and b3213"},1576762:{name:"Phosphate exchange",bigg_id:"EX_pi_e",segments:{185:{to_node_id:"1576989",from_node_id:"1576594",b2:{y:4909.82177734375,x:2880},b1:{y:4896.2666015625,x:2879.999755859375}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"pi_e"}],label_x:2902.694091796875,label_y:4926.21484375,gene_reaction_rule:""},1576763:{name:"Fumarate transport via proton symport  2 H ",bigg_id:"FUMt2_2",segments:{187:{to_node_id:"1576993",from_node_id:"1576991",b2:null,b1:null},188:{to_node_id:"1576992",from_node_id:"1576993",b2:null,b1:null},189:{to_node_id:"1576991",from_node_id:"1576657",b2:{y:718,x:2840},b1:{y:690,x:2840}},190:{to_node_id:"1576991",from_node_id:"1576658",
b2:{y:714.3395402366342,x:2840},b1:{y:677.7984674554473,x:2840}},191:{to_node_id:"1576659",from_node_id:"1576992",b2:{y:1032.2015325445527,x:2840},b1:{y:995.6604597633658,x:2840}},192:{to_node_id:"1576503",from_node_id:"1576992",b2:{y:1950.0011597931211,x:2840},b1:{y:1271.0003479379363,x:2840}}},genes:[{bigg_id:"b3528",name:"dctA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"fum_c"},{coefficient:2,bigg_id:"h_c"},{coefficient:-1,bigg_id:"fum_e"},{coefficient:-2,bigg_id:"h_e"}],label_x:2851.586669921875,label_y:845.8676147460938,gene_reaction_rule:"b3528"},1576764:{name:"Acetate reversible transport via proton symport",bigg_id:"ACt2r",segments:{193:{to_node_id:"1576995",from_node_id:"1576994",b2:null,b1:null},194:{to_node_id:"1576996",from_node_id:"1576995",b2:null,b1:null},195:{to_node_id:"1576994",from_node_id:"1576627",b2:{y:4760,x:1715},b1:{y:4779.13232421875,x:1716.5867919921875}},196:{to_node_id:"1576994",from_node_id:"1576660",b2:{y:4760.660459763366,x:1715},b1:{y:4787.680536450803,x:1715}},197:{to_node_id:"1576652",from_node_id:"1576996",b2:{y:4450.38818359375,x:1715},b1:{y:4489.49560546875,x:1715}},198:{to_node_id:"1576661",from_node_id:"1576996",b2:{y:4430.253057299197,x:1719.76025390625},b1:{y:4485.835145705384,x:1715}}},genes:[],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"h_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"ac_e"},{coefficient:1,bigg_id:"ac_c"}],label_x:1740.8675537109375,label_y:4638.470703125,gene_reaction_rule:""},1576765:{name:"D-glucose transport via PEP:Pyr PTS",bigg_id:"GLCpts",segments:{199:{to_node_id:"1576997",from_node_id:"1576998",b2:null,b1:null},200:{to_node_id:"1576999",from_node_id:"1576997",b2:null,b1:null},201:{to_node_id:"1576998",from_node_id:"1576662",b2:{y:830.8607140720374,x:1056.2982974892807},b1:{y:817.6128620109578,x:962.100078544998}},202:{to_node_id:"1576998",from_node_id:"1576647",b2:{y:852.0646158583277,x:1054.6540059434642},b1:{y:841.218336226978,x:1054.4691636917553}},203:{to_node_id:"1576663",from_node_id:"1576999",b2:{y:1091.99109457335,x:1162.89990234375},b1:{y:1155.6497636747395,x:1056.5867919921875}},204:{to_node_id:"1576524",from_node_id:"1576999",b2:{y:1159.3526000976562,x:1055},b1:{y:1156.4998046875,x:1056.5867919921875}}},genes:[{bigg_id:"b1621",name:"malX"},{bigg_id:"b2416",name:"ptsI"},{bigg_id:"b1817",name:"manX"},{bigg_id:"b1101",name:"ptsG"},{bigg_id:"b1818",name:"manY"},{bigg_id:"b1819",name:"manZ"},{bigg_id:"b2415",name:"ptsH"},{bigg_id:"b2417",name:"crr"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pep_c"},{coefficient:1,bigg_id:"pyr_c"},{coefficient:-1,bigg_id:"glc__D_e"},{coefficient:1,bigg_id:"g6p_c"}],label_x:1074.520263671875,label_y:929.0499877929688,gene_reaction_rule:"(b2417 and b1101 and b2415 and b2416) or (b1817 and b1818 and b1819 and b2415 and b2416) or (b2417 and b1621 and b2415 and b2416)"},1576766:{name:"Succinate transport out via proton antiport",bigg_id:"SUCCt3",segments:{205:{to_node_id:"1577000",from_node_id:"1577002",b2:null,b1:null},206:{to_node_id:"1577001",from_node_id:"1577000",b2:null,b1:null},207:{to_node_id:"1577002",from_node_id:"1576664",b2:{y:2844.388427734375,x:4392.512762612581},b1:{y:2928.186767578125,x:4395.992900114855}},208:{to_node_id:"1577002",from_node_id:"1576533",b2:{y:2846,x:4388.970989302984},b1:{y:2846,x:3989.9032976766134}},209:{to_node_id:"1576531",from_node_id:"1577001",b2:{y:2846,x:4852.764726786234},b1:{y:2844.388427734375,x:4830.28303131712}},210:{to_node_id:"1576665",from_node_id:"1577001",b2:{y:2757.366943359375,x:4896.373608481642},b1:{y:2844.388427734375,x:4895.4172094976175}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"succ_c"},{coefficient:1,bigg_id:"succ_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"h_e"}],label_x:4451.38818359375,label_y:2819.884765625,gene_reaction_rule:""},1576768:{name:"6-phosphogluconolactonase",bigg_id:"PGL",segments:{211:{to_node_id:"1577003",from_node_id:"1577005",b2:null,b1:null},212:{to_node_id:"1577004",from_node_id:"1577003",b2:null,b1:null},213:{to_node_id:"1577005",from_node_id:"1576626",b2:{y:1265,x:1600.5},b1:{y:1265,x:1562}},214:{to_node_id:"1577005",from_node_id:"1576667",b2:{y:1265,x:1600.6197527491188},b1:{y:1265,x:1562.3991758303962}},215:{to_node_id:"1576668",from_node_id:"1577004",b2:{y:1265,x:1711.6008241696038},b1:{y:1265,x:1673.3802472508812}},216:{to_node_id:"1576490",from_node_id:"1577004",b2:{y:1265,x:1742},b1:{y:1265,x:1682.5}}},genes:[{bigg_id:"b0767",name:"pgl"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"6pgl_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"6pgc_c"}],label_x:1599.3970947265625,label_y:1312.1234130859375,gene_reaction_rule:"b0767"},1576769:{name:"Glyceraldehyde-3-phosphate dehydrogenase",bigg_id:"GAPD",segments:{217:{to_node_id:"1577008",from_node_id:"1577006",b2:null,b1:null},218:{to_node_id:"1577007",from_node_id:"1577008",b2:null,b1:null},219:{to_node_id:"1577006",from_node_id:"1576575",b2:{y:2322.5,x:1055},b1:{y:2270,x:1055}},220:{to_node_id:"1577006",from_node_id:"1576669",b2:{y:2326.9376081318114,x:1055},b1:{y:2284.7920271060384,x:1055}},221:{to_node_id:"1577006",from_node_id:"1576670",b2:{y:2330.769750529242,x:1055},b1:{y:2297.5658350974745,x:1055}},222:{to_node_id:"1576487",from_node_id:"1577007",b2:{y:2500,x:1055},b1:{y:2454.5,x:1055}},223:{to_node_id:"1576671",from_node_id:"1577007",b2:{y:2495.2079728939616,x:1055},b1:{y:2453.0623918681886,x:1055}},224:{to_node_id:"1576672",from_node_id:"1577007",b2:{y:2482.4341649025255,x:1055},b1:{y:2449.230249470758,x:1055}}},genes:[{bigg_id:"b1779",name:"gapA"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"13dpg_c"},{coefficient:-1,bigg_id:"g3p_c"},{coefficient:1,bigg_id:"nadh_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:-1,bigg_id:"pi_c"}],label_x:1065,label_y:2385,gene_reaction_rule:"b1779"},1576770:{name:"Fumarate exchange",bigg_id:"EX_fum_e",segments:{225:{to_node_id:"1577009",from_node_id:"1576657",b2:{y:560,x:2840},b1:{y:623,x:2840}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"fum_e"}],label_x:2915.057373046875,label_y:529.8175659179688,gene_reaction_rule:""},1576771:{name:"Succinate transport via proton symport  2 H ",bigg_id:"SUCCt2_2",segments:{227:{to_node_id:"1577011",from_node_id:"1577013",b2:null,b1:null},228:{to_node_id:"1577012",from_node_id:"1577011",b2:null,b1:null},229:{to_node_id:"1577013",from_node_id:"1576673",b2:{y:3027,x:4806.816653826392},b1:{y:3027,x:4832.0555127546395}},230:{to_node_id:"1577013",from_node_id:"1576531",b2:{y:3027,x:4826.039349194016},b1:{y:3027,x:4896.1311639800515}},231:{to_node_id:"1576533",from_node_id:"1577012",b2:{y:3027,x:3972.294403079054},b1:{y:3027,x:4366.8883209237165}},232:{to_node_id:"1576674",from_node_id:"1577012",b2:{y:3027,x:4486},b1:{y:3027,x:4521}}},genes:[{bigg_id:"b3528",name:"dctA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"succ_c"},{coefficient:-1,bigg_id:"succ_e"},{coefficient:2,bigg_id:"h_c"},{coefficient:-2,bigg_id:"h_e"}],label_x:4501.95703125,label_y:2997.661865234375,gene_reaction_rule:"b3528"},1576772:{name:"Glutamate dehydrogenase (NADP)",bigg_id:"GLUDy",segments:{233:{to_node_id:"1577015",from_node_id:"1577016",b2:null,b1:null},234:{to_node_id:"1577014",from_node_id:"1577015",b2:null,b1:null},235:{to_node_id:"1577016",from_node_id:"1576675",b2:{y:3632,x:4133.6977705423415},b1:{y:3632,x:4170.325901807804}},236:{to_node_id:"1577016",from_node_id:"1576554",b2:{y:3632,x:4137.5},b1:{y:3632,x:4183}},237:{to_node_id:"1577016",from_node_id:"1576676",b2:{y:3632,x:4129.669190203266},b1:{y:3632,x:4156.897300677553}},238:{to_node_id:"1576677",from_node_id:"1577014",b2:{y:3632,x:4021.2725815852687},b1:{y:3632,x:4060.9817744755806}},239:{to_node_id:"1576678",from_node_id:"1577014",b2:{y:3632,x:4000.5855310681522},b1:{y:3632,x:4054.775659320446}},240:{to_node_id:"1576509",from_node_id:"1577014",b2:{y:3632,x:3911.98117576612},b1:{y:3632,x:4028.194352729836}},241:{to_node_id:"1576679",from_node_id:"1577014",b2:{y:3632,x:4036.853918777118},b1:{y:3632,x:4065.6561756331353}}},genes:[{bigg_id:"b1761",name:"gdhA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"glu__L_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:1,bigg_id:"nh4_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"nadph_c"},{coefficient:1,bigg_id:"akg_c"},{coefficient:-1,bigg_id:"h2o_c"}],label_x:4025.81298828125,label_y:3671.95703125,gene_reaction_rule:"b1761"},1576773:{name:"ATP synthase (four protons for one ATP)",bigg_id:"ATPS4r",segments:{242:{to_node_id:"1577019",from_node_id:"1577017",b2:null,b1:null},243:{to_node_id:"1577018",from_node_id:"1577019",b2:null,b1:null},244:{to_node_id:"1577017",from_node_id:"1576680",b2:{y:1150,x:4729},b1:{y:1150,x:4785}},245:{to_node_id:"1577017",from_node_id:"1576681",b2:{y:1150,x:4746.487950057818},b1:{y:1332.100830078125,x:4877.134963734394}},246:{to_node_id:"1577017",from_node_id:"1576536",b2:{y:1150,x:4796.204440681362},b1:{y:1523.8707275390625,x:4965.504060083706}},247:{to_node_id:"1576682",from_node_id:"1577018",b2:{y:1150,x:4520},b1:{y:1148.3885498046875,x:4558.046875}},248:{to_node_id:"1576683",from_node_id:"1577018",b2:{y:1150,x:4542.7265625},b1:{y:1148.388427734375,x:4575.66162109375}},249:{to_node_id:"1576534",from_node_id:"1577018",b2:{y:1043.64013671875,x:4324.116846450839},b1:{y:1148.3885498046875,x:4366.332368388376}}},genes:[{bigg_id:"b3731",name:"atpC"},{bigg_id:"b3738",name:"atpB"},{bigg_id:"b3733",name:"atpG"},{bigg_id:"b3739",name:"atpI"},{bigg_id:"b3734",name:"atpA"},{bigg_id:"b3736",name:"atpF"},{bigg_id:"b3737",name:"atpE"},{bigg_id:"b3735",name:"atpH"},{bigg_id:"b3732",name:"atpD"}],reversibility:!0,metabolites:[{coefficient:-4,bigg_id:"h_e"},{coefficient:1,bigg_id:"atp_c"},{coefficient:3,bigg_id:"h_c"},{coefficient:-1,bigg_id:"adp_c"},{coefficient:-1,bigg_id:"pi_c"},{coefficient:1,bigg_id:"h2o_c"}],label_x:4558.97119140625,label_y:1122.273193359375,gene_reaction_rule:"((b3736 and b3737 and b3738) and (b3731 and b3732 and b3733 and b3734 and b3735)) or ((b3736 and b3737 and b3738) and (b3731 and b3732 and b3733 and b3734 and b3735) and b3739)"},1576774:{name:"Citrate synthase",bigg_id:"CS",segments:{250:{to_node_id:"1577022",from_node_id:"1577020",b2:null,b1:null},251:{to_node_id:"1577021",from_node_id:"1577022",b2:null,b1:null},252:{to_node_id:"1577020",from_node_id:"1576514",b2:{y:3745.4027250468985,x:2627.479742988546},b1:{y:3679.773731927161,x:1727.7705707040077}},253:{to_node_id:"1577020",from_node_id:"1576684",b2:{y:3823.2954829227556,x:2728.8970628128327},b1:{y:3791.3182764091857,x:2693.656876042776}},254:{to_node_id:"1577020",from_node_id:"1576521",b2:{y:3822.7470798256522,x:2728.292700216025},b1:{y:3789.4902660855073,x:2691.642334053416}},255:{to_node_id:"1576685",from_node_id:"1577021",b2:{y:3962.7252091426644,x:2898.7018369997472},b1:{y:3931.4175627427994,x:2857.610551099924}},256:{to_node_id:"1576686",from_node_id:"1577021",b2:{y:3971.425553937104,x:2910.1210395424487},b1:{y:3934.0276661811313,x:2861.0363118627347}},257:{to_node_id:"1576687",from_node_id:"1577021",b2:{y:3980.7262047116856,x:2922.328143684087},b1:{y:3936.817861413506,x:2864.698443105226}}},genes:[{bigg_id:"b0720",name:"gltA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"coa_c"},{coefficient:-1,bigg_id:"oaa_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"cit_c"},{coefficient:-1,bigg_id:"accoa_c"},{coefficient:-1,bigg_id:"h2o_c"}],label_x:2808,label_y:3876,gene_reaction_rule:"b0720"},1576775:{name:"Pyruvate transport in via proton symport",bigg_id:"PYRt2",segments:{258:{to_node_id:"1577025",from_node_id:"1577023",b2:null,b1:null},259:{to_node_id:"1577024",from_node_id:"1577025",b2:null,b1:null},260:{to_node_id:"1577023",from_node_id:"1576688",b2:{y:3945,x:359.3395402366342},b1:{y:3945,x:322.7984674554473}},261:{to_node_id:"1577023",from_node_id:"1576557",b2:{y:3945,x:360},b1:{y:3945,x:325}},262:{to_node_id:"1576511",from_node_id:"1577024",b2:{y:3945,x:850},b1:{y:3945,x:706.5}},263:{to_node_id:"1576689",from_node_id:"1577024",b2:{y:3945,x:697.2015325445527},b1:{y:3945,x:660.6604597633658}}},genes:[],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"pyr_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"pyr_e"},{coefficient:-1,bigg_id:"h_e"}],label_x:462.6368408203125,label_y:3908.02490234375,gene_reaction_rule:""},1576776:{name:"Malic enzyme (NADP)",bigg_id:"ME2",segments:{264:{to_node_id:"1577026",from_node_id:"1577028",b2:null,b1:null},265:{to_node_id:"1577027",from_node_id:"1577026",b2:null,b1:null},266:{to_node_id:"1577028",from_node_id:"1576690",b2:{y:3350.7069760509485,x:2325.4883732484195},b1:{y:3329.0232535031614,x:2361.6279108280646}},267:{to_node_id:"1577028",from_node_id:"1576504",b2:{y:3332.720745600581,x:2355.4654239990323},b1:{y:3269.069152001936,x:2461.551413330107}},268:{to_node_id:"1576691",from_node_id:"1577027",b2:{y:3434.0831891575845,x:2171.8336216848306},b1:{y:3417.2249567472754,x:2205.550086505449}},269:{to_node_id:"1576511",from_node_id:"1577027",b2:{y:3895.002675936253,x:1164.309223322806},b1:{y:3495.997238327751,x:2048.005523344498}},270:{to_node_id:"1576692",from_node_id:"1577027",b2:{y:3439.4108823397055,x:2161.178235320589},b1:{y:3418.8232647019117,x:2202.3534705961765}}},genes:[{bigg_id:"b2463",name:"maeB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"pyr_c"},{coefficient:-1,bigg_id:"mal__L_c"},{coefficient:1,bigg_id:"co2_c"},{coefficient:-1,bigg_id:"nadp_c"},{coefficient:1,bigg_id:"nadph_c"}],label_x:2281.107177734375,label_y:3432.36328125,gene_reaction_rule:"b2463"},1576777:{name:"Formate exchange",bigg_id:"EX_for_e",segments:{271:{to_node_id:"1577030",from_node_id:"1576666",b2:{y:4884.95458984375,x:1460},b1:{y:4885.96044921875,x:1461.5867919921875}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"for_e"}],label_x:1476.3470458984375,label_y:4913.4130859375,gene_reaction_rule:""},1577490:{name:"Acetaldehyde dehydrogenase (acetylating)",bigg_id:"ACALD",segments:{273:{to_node_id:"1577032",from_node_id:"1577031",b2:null,b1:null},274:{to_node_id:"1577033",from_node_id:"1577032",b2:null,b1:null},275:{to_node_id:"1577031",from_node_id:"1576817",b2:{y:3945,x:2065.5},b1:{y:3945,x:2125}},276:{to_node_id:"1577031",from_node_id:"1576825",b2:{y:3945,x:2058.56912760471},b1:{y:3945,x:2101.8970920157}},277:{to_node_id:"1577031",from_node_id:"1576828",b2:{y:3945,x:2053.52081728299},b1:{y:3945,x:2085.0693909433}},278:{to_node_id:"1576514",from_node_id:"1577033",b2:{y:3945,x:1847.5},b1:{y:3945,x:1940.25}},279:{to_node_id:"1576832",from_node_id:"1577033",b2:{y:3945,x:1934.9306090567002},b1:{y:3945,x:1966.47918271701}},280:{to_node_id:"1576812",from_node_id:"1577033",b2:{y:3945,x:1918.1029079843004},b1:{y:3945,x:1961.4308723952902}}},genes:[{bigg_id:"b1241",name:"adhE"},{bigg_id:"b0351",name:"mhpF"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"nadh_c"},{coefficient:-1,bigg_id:"coa_c"},{coefficient:-1,bigg_id:"acald_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"accoa_c"}],label_x:1939.0750732421875,label_y:3998.470458984375,gene_reaction_rule:"b0351 or b1241"},1577497:{name:"Acetaldehyde reversible transport",bigg_id:"ACALDt",segments:{281:{to_node_id:"1577034",from_node_id:"1576815",b2:{y:4707,x:2210},b1:{y:4796.55283203125,x:2210}},282:{to_node_id:"1576817",from_node_id:"1577034",b2:{y:4257.5,x:2210},b1:{y:4476.25,x:2210}}},genes:[{bigg_id:"s0001",name:"None"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"acald_c"},{coefficient:-1,bigg_id:"acald_e"}],label_x:2248.561767578125,label_y:4579.041015625,gene_reaction_rule:"s0001"},1577498:{name:"Acetaldehyde exchange",bigg_id:"EX_acald_e",segments:{283:{to_node_id:"1577035",from_node_id:"1576815",b2:{y:4894,x:2210.5},b1:{y:4889.1484375,x:2210.15}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"acald_e"}],label_x:2227.346923828125,label_y:4922.892578125,gene_reaction_rule:""},1577507:{name:"Alcohol dehydrogenase (ethanol)",bigg_id:"ALCD2x",segments:{2:{to_node_id:"1577042",from_node_id:"1577041",b2:null,b1:null},3:{to_node_id:"1577043",from_node_id:"1577042",b2:null,b1:null},4:{to_node_id:"1577041",from_node_id:"1576829",b2:{y:4118.6722220553565,x:2391.0059522021684},b1:{y:4162.240740184523,x:2437.6865073405606}},5:{to_node_id:"1577041",from_node_id:"1576822",b2:{y:4111.911975251582,x:2383.7628306266947},b1:{y:4139.7065841719395,x:2413.5427687556494}},6:{to_node_id:"1576817",from_node_id:"1577043",b2:{y:4004.2974661013272,x:2279.744301694572},b1:{y:4050.989239830398,x:2323.3232905083714}},7:{to_node_id:"1576813",from_node_id:"1577043",b2:{y:4033.046682944248,x:2306.576904081298},b1:{y:4059.6140048832744,x:2331.3730712243896}},8:{to_node_id:"1576824",from_node_id:"1577043",b2:{y:4021.1795086945217,x:2295.5008747815536},b1:{y:4056.0538526083565,x:2328.0502624344663}}},genes:[{bigg_id:"b1241",name:"adhE"},{bigg_id:"b0356",name:"frmA"},{bigg_id:"b1478",name:"adhP"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"acald_c"},{coefficient:1,bigg_id:"h_c"},{coefficient:-1,bigg_id:"nad_c"},{coefficient:1,bigg_id:"nadh_c"},{coefficient:-1,bigg_id:"etoh_c"}],label_x:2356.4794921875,label_y:4047.4384765625,gene_reaction_rule:"b0356 or b1478 or b1241"},1577514:{name:"Formate transport in via proton symport",bigg_id:"FORt2",segments:{9:{to_node_id:"1577045",from_node_id:"1577044",b2:null,b1:null},10:{to_node_id:"1577046",from_node_id:"1577045",b2:null,b1:null},11:{to_node_id:"1577044",from_node_id:"1576666",b2:{y:4749.209372712298,x:1360},b1:{y:4827.353507999329,x:1360}},12:{to_node_id:"1577044",from_node_id:"1576833",b2:{y:4744.773286702694,x:1360},b1:{y:4779.244289008981,x:1360}},13:{to_node_id:"1576590",from_node_id:"1577046",b2:{y:4275.94781629675,x:1360},b1:{y:4411.784344889025,x:1360}},14:{to_node_id:"1576811",from_node_id:"1577046",b2:{y:4422.5658350974745,x:1360},b1:{y:4455.769750529243,x:1360}}},genes:[{bigg_id:"b2492",name:"focB"},{bigg_id:"b0904",name:"focA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"for_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"for_c"},{coefficient:-1,bigg_id:"h_e"}],label_x:1255.7530517578125,label_y:4574.13232421875,gene_reaction_rule:"b0904 or b2492"},1577518:{name:"Formate transport via diffusion",bigg_id:"FORti",segments:{15:{to_node_id:"1577047",from_node_id:"1576590",b2:{y:4263.5,x:1460},b1:{y:4145.55,x:1460}},16:{to_node_id:"1576666",from_node_id:"1577047",b2:{y:4654.322265625,x:1460},b1:{y:4488.7,x:1460}}},genes:[{bigg_id:"b2492",name:"focB"},{bigg_id:"b0904",name:"focA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"for_e"},{coefficient:-1,bigg_id:"for_c"}],label_x:1479.5206298828125,label_y:4509.27197265625,gene_reaction_rule:"b0904 or b2492"},1577520:{name:"Fumarate reductase",bigg_id:"FRD7",segments:{17:{to_node_id:"1577049",from_node_id:"1577048",b2:null,b1:null},18:{to_node_id:"1577050",from_node_id:"1577049",b2:null,b1:null},19:{to_node_id:"1577048",from_node_id:"1576503",b2:{y:2600,x:3020.2689151278832},b1:{y:2600,x:2880.896383759611}},20:{to_node_id:"1577048",from_node_id:"1576830",b2:{y:2600,x:3057.152680682408},b1:{y:2600,x:3003.842268941361}},21:{to_node_id:"1576814",from_node_id:"1577050",b2:{y:2600,x:3213.824115301167},b1:{y:2600,x:3162.14723459035}},22:{to_node_id:"1576533",from_node_id:"1577050",b2:{y:2600,x:3333.4483135103533},b1:{y:2600,x:3198.034494053106}}},genes:[{bigg_id:"b4152",name:"frdC"},{bigg_id:"b4151",name:"frdD"},{bigg_id:"b4154",name:"frdA"},{bigg_id:"b4153",name:"frdB"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"succ_c"},{coefficient:-1,bigg_id:"fum_c"},{coefficient:1,bigg_id:"q8_c"},{coefficient:-1,bigg_id:"q8h2_c"}],label_x:3078.744384765625,label_y:2572.54541015625,gene_reaction_rule:"b4151 and b4152 and b4153 and b4154"},1577524:{name:"Fructose transport via PEPPyr PTS  f6p generating ",bigg_id:"FRUpts2",segments:{23:{to_node_id:"1577052",from_node_id:"1577051",b2:null,b1:null},24:{to_node_id:"1577053",from_node_id:"1577052",b2:null,b1:null},25:{to_node_id:"1577051",from_node_id:"1576826",b2:{y:1361.5867919921875,x:526.550048828125},b1:{y:1360,x:465}},26:{to_node_id:"1577051",from_node_id:"1576819",b2:{y:1360,x:396.1378949970459},b1:{y:1452.0322265625,x:400.008457770101}},27:{to_node_id:"1576525",from_node_id:"1577053",b2:{y:1361.586669921875,x:917.1118252292455},b1:{y:1363.1734619140625,x:860.370260215258}},28:{to_node_id:"1576821",from_node_id:"1577053",b2:{y:1240.992919921875,x:861.106575008484},b1:{y:1364.76025390625,x:861.4990623462952}}},genes:[{bigg_id:"b1819",name:"manZ"},{bigg_id:"b1817",name:"manX"},{bigg_id:"b2415",name:"ptsH"},{bigg_id:"b2416",name:"ptsI"},{bigg_id:"b1818",name:"manY"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"pep_c"},{coefficient:1,bigg_id:"f6p_c"},{coefficient:-1,bigg_id:"fru_e"},{coefficient:1,bigg_id:"pyr_c"}],label_x:456.41497802734375,label_y:1327.7852783203125,gene_reaction_rule:"b1817 and b1818 and b1819 and b2415 and b2416"},1577529:{name:"D-Fructose exchange",bigg_id:"EX_fru_e",segments:{29:{to_node_id:"1577054",from_node_id:"1576826",b2:{y:1360,x:241},b1:{y:1360,x:282.3}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"fru_e"}],label_x:125.35597229003906,label_y:1321.438232421875,gene_reaction_rule:""},1577532:{name:"Malate transport via proton symport  2 H ",bigg_id:"MALt2_2",segments:{31:{to_node_id:"1577057",from_node_id:"1577056",b2:null,b1:null},32:{to_node_id:"1577058",from_node_id:"1577057",b2:null,b1:null},33:{to_node_id:"1577056",from_node_id:"1576831",b2:{y:720.0576036932963,x:2610},b1:{y:682.8586789776543,x:2610}},34:{to_node_id:"1577056",from_node_id:"1576816",b2:{y:723.1,x:2610},b1:{y:693,x:2610}},35:{to_node_id:"1576810",from_node_id:"1577058",b2:{y:1032.2015325445527,x:2610},b1:{y:995.6604597633658,x:2610}},36:{to_node_id:"1576504",from_node_id:"1577058",b2:{y:2086.013675322326,x:2610},b1:{y:1311.8041025966977,x:2610}}},genes:[{bigg_id:"b3528",name:"dctA"}],reversibility:!1,metabolites:[{coefficient:1,bigg_id:"mal__L_c"},{coefficient:2,bigg_id:"h_c"},{coefficient:-1,bigg_id:"mal__L_e"},{coefficient:-2,bigg_id:"h_e"}],label_x:2623.173583984375,label_y:844.3793334960938,gene_reaction_rule:"b3528"},1577537:{name:"L-Malate exchange",bigg_id:"EX_mal__L_e",segments:{37:{to_node_id:"1577059",from_node_id:"1576816",b2:{y:560,x:2610},b1:{y:623,x:2610}}},genes:[],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"mal__L_e"}],label_x:2356.597412109375,label_y:513.949951171875,gene_reaction_rule:""},1577540:{name:"NADH dehydrogenase (ubiquinone-8 & 3 protons)",bigg_id:"NADH16",segments:{39:{to_node_id:"1577062",from_node_id:"1577061",b2:null,b1:null},40:{to_node_id:"1577063",from_node_id:"1577062",b2:null,b1:null},41:{to_node_id:"1577061",from_node_id:"1576820",b2:{y:2570,x:4582},b1:{y:2570,x:4470}},42:{to_node_id:"1577061",from_node_id:"1576827",b2:{y:2570,x:4595.729021023612},b1:{y:2567.302001953125,x:4458.799047943291}},43:{to_node_id:"1577061",from_node_id:"1576539",b2:{y:2570,x:4542.513923505967},b1:{y:2375.007080078125,x:4706.342147363639}},44:{to_node_id:"1576808",from_node_id:"1577063",b2:{y:2570,x:4780},b1:{y:2568.388427734375,x:4766.45361328125}},45:{to_node_id:"1576809",from_node_id:"1577063",b2:{y:2655.409912109375,x:4928.099683314913},b1:{y:2570.000244140625,x:4798.6355690569735}},46:{to_node_id:"1576542",from_node_id:"1577063",b2:{y:2507.151123046875,x:4630.938294107013},b1:{y:2571.611572265625,x:4800.053949169604}}},genes:[{bigg_id:"b2284",name:"nuoF"},{bigg_id:"b2279",name:"nuoK"},{bigg_id:"b2287",name:"nuoB"},{bigg_id:"b2286",name:"nuoC"},{bigg_id:"b2288",name:"nuoA"},{bigg_id:"b2283",name:"nuoG"},{bigg_id:"b2277",name:"nuoM"},{bigg_id:"b2281",name:"nuoI"},{bigg_id:"b2280",name:"nuoJ"},{bigg_id:"b2276",name:"nuoN"},{bigg_id:"b2282",name:"nuoH"},{bigg_id:"b2278",name:"nuoL"},{bigg_id:"b2285",name:"nuoE"}],reversibility:!1,metabolites:[{coefficient:3,bigg_id:"h_e"},{coefficient:-1,bigg_id:"q8_c"},{coefficient:-1,bigg_id:"nadh_c"},{coefficient:1,bigg_id:"q8h2_c"},{coefficient:-4,bigg_id:"h_c"},{coefficient:1,bigg_id:"nad_c"}],label_x:4589.75537109375,label_y:2624.46044921875,gene_reaction_rule:"b2276 and b2277 and b2278 and b2279 and b2280 and b2281 and b2282 and b2283 and b2284 and b2285 and b2286 and b2287 and b2288"},1577545:{name:"Succinate dehydrogenase (irreversible)",bigg_id:"SUCDi",segments:{47:{to_node_id:"1577065",from_node_id:"1577064",b2:null,b1:null},48:{to_node_id:"1577066",from_node_id:"1577065",b2:null,b1:null},49:{to_node_id:"1577064",from_node_id:"1576814",b2:{y:2816.4590794794085,x:3193.7934732750823},b1:{y:2815.1969315980286,x:3225.9782442502737}},50:{to_node_id:"1577064",from_node_id:"1576533",b2:{y:2815.5590310361767,x:3216.7447085774984},b1:{y:2812.1967701205886,x:3302.482361924995}},51:{to_node_id:"1576503",from_node_id:"1577066",b2:{y:2843.2084583195547,x:2952.624089386102},b1:{y:2831.162537495866,x:3040.3872268158307}},52:{to_node_id:"1576830",from_node_id:"1577066",b2:{y:2833.0526323200284,x:3026.6165359540787},b1:{y:2828.1157896960085,x:3062.5849607862237}}},genes:[{bigg_id:"b0724",name:"sdhB"},{bigg_id:"b0721",name:"sdhC"},{bigg_id:"b0722",name:"sdhD"},{bigg_id:"b0723",name:"sdhA"}],reversibility:!1,metabolites:[{coefficient:-1,bigg_id:"succ_c"},{coefficient:1,bigg_id:"fum_c"},{coefficient:-1,bigg_id:"q8_c"},{coefficient:1,bigg_id:"q8h2_c"}],label_x:3108.851318359375,label_y:2862.949951171875,gene_reaction_rule:"b0721 and b0722 and b0723 and b0724"},1577546:{name:"D lactate transport via proton symport",bigg_id:"D_LACt2",segments:{476:{to_node_id:"1577068",from_node_id:"1577067",b2:null,b1:null},477:{to_node_id:"1577068",from_node_id:"1577069",b2:null,b1:null},478:{to_node_id:"1576556",from_node_id:"1577067",b2:{y:4736.89501953125,x:1054.9998779296875},b1:{y:4692.98193359375,x:1055}},479:{to_node_id:"1577071",from_node_id:"1577067",b2:{y:4715.98193359375,x:1076},b1:{y:4696.98193359375,x:1055}},480:{to_node_id:"1576584",from_node_id:"1577069",b2:{y:4413.36767578125,x:1055},b1:{y:4474.7353515625,x:1053.4132080078125}},481:{to_node_id:"1577072",from_node_id:"1577069",b2:{y:4451.7353515625,x:1074.4132080078125},b1:{y:4470.7353515625,x:1053.4132080078125}}},genes:[{bigg_id:"b3603",name:"lldP"},{bigg_id:"b2975",name:"glcA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"lac__D_e"},{coefficient:1,bigg_id:"h_c"},{coefficient:1,bigg_id:"lac__D_c"},{coefficient:-1,bigg_id:"h_e"}],label_x:1078.65283203125,label_y:4609.72607421875,gene_reaction_rule:"b2975 or b3603"},1577547:{name:"Biomass Objective Function with GAM",bigg_id:"BIOMASS_Ecoli_core_w_GAM",segments:{482:{to_node_id:"1577075",from_node_id:"1577074",b2:null,b1:null},483:{to_node_id:"1577075",from_node_id:"1577076",b2:null,b1:null},484:{to_node_id:"1577073",from_node_id:"1577074",b2:{y:4573.30322265625,x:5455.328125},b1:{y:4685.48193359375,x:5334.0517578125}},485:{to_node_id:"1577077",from_node_id:"1577076",b2:{y:4926.6220703125,x:5391.197265625},b1:{y:4793.48193359375,x:5334.0517578125}},486:{to_node_id:"1577078",from_node_id:"1577074",b2:{y:4630.19921875,x:5427.28515625},b1:{y:4681.48193359375,x:5334.0517578125}},487:{to_node_id:"1577079",from_node_id:"1577074",b2:{y:4516.16943359375,x:5423.4208984375},b1:{y:4681.48193359375,x:5334.0517578125}},488:{to_node_id:"1577080",from_node_id:"1577074",b2:{y:4453.01611328125,x:5350.98828125},b1:{y:4681.48193359375,x:5334.0517578125}},489:{to_node_id:"1577081",from_node_id:"1577076",b2:{y:5001.37158203125,x:5337.27587890625},b1:{y:4793.48193359375,x:5334.0517578125}},490:{to_node_id:"1577082",from_node_id:"1577074",b2:{y:4413.09912109375,x:5307.541015625},b1:{y:4681.48193359375,x:5334.0517578125}},491:{to_node_id:"1577083",from_node_id:"1577074",b2:{y:4523.05615234375,x:5316.9716796875},b1:{y:4681.48193359375,x:5334.0517578125}},492:{to_node_id:"1577084",from_node_id:"1577074",b2:{y:4533.61865234375,x:5258.0712890625},b1:{y:4681.48193359375,x:5334.0517578125}},493:{to_node_id:"1577085",from_node_id:"1577074",b2:{y:4544.18115234375,x:5197.05859375},b1:{y:4681.48193359375,x:5334.0517578125}},494:{to_node_id:"1577086",from_node_id:"1577074",b2:{y:4564.25048828125,x:5140.27099609375},b1:{y:4681.48193359375,x:5334.0517578125}},495:{to_node_id:"1577087",from_node_id:"1577076",b2:{y:4938.26416015625,x:5273.55517578125},b1:{y:4793.48193359375,x:5334.0517578125}},496:{to_node_id:"1577088",from_node_id:"1577074",b2:{y:4579.03759765625,x:5068.69580078125},b1:{y:4681.48193359375,x:5334.0517578125}},497:{to_node_id:"1577089",from_node_id:"1577074",b2:{y:4594.88134765625,x:5023.52734375},b1:{y:4681.48193359375,x:5334.0517578125}},498:{to_node_id:"1577090",from_node_id:"1577076",b2:{y:4899.2412109375,x:5215.0458984375},b1:{y:4793.48193359375,x:5334.0517578125}},499:{to_node_id:"1577091",from_node_id:"1577076",b2:{y:4977.43115234375,x:5353.5947265625},b1:{y:4789.48193359375,x:5334.0517578125}},500:{to_node_id:"1577092",from_node_id:"1577074",b2:{y:4611.78173828125,x:4962.51416015625},b1:{y:4681.48193359375,x:5334.0517578125}},501:{to_node_id:"1577093",from_node_id:"1577074",b2:{y:4637.1318359375,x:4907.83935546875},b1:{y:4681.48193359375,x:5334.0517578125}},502:{to_node_id:"1577094",from_node_id:"1577074",b2:{y:4664.59423828125,x:4851.0517578125},b1:{y:4681.48193359375,x:5334.0517578125}},503:{to_node_id:"1577095",from_node_id:"1577074",b2:{y:4685.7197265625,x:4807.9951171875},b1:{y:4681.48193359375,x:5334.0517578125}},504:{to_node_id:"1577096",from_node_id:"1577076",b2:{y:4868.333984375,x:5114.79541015625},b1:{y:4793.48193359375,x:5334.0517578125}},505:{to_node_id:"1577097",from_node_id:"1577074",b2:{y:4717.4072265625,x:4780.78271484375},b1:{y:4681.48193359375,x:5334.0517578125}},506:{to_node_id:"1577098",from_node_id:"1577076",b2:{y:4820.185546875,x:5099.533203125},b1:{y:4793.48193359375,x:5334.0517578125}}},genes:[],reversibility:!1,metabolites:[{coefficient:3.7478,bigg_id:"coa_c"},{coefficient:-.8977,bigg_id:"r5p_c"},{coefficient:-1.496,bigg_id:"3pg_c"},{coefficient:-.361,bigg_id:"e4p_c"},{coefficient:-.2557,bigg_id:"gln__L_c"},{coefficient:3.547,bigg_id:"nadh_c"},{coefficient:-2.8328,bigg_id:"pyr_c"},{coefficient:-.0709,bigg_id:"f6p_c"},{coefficient:-13.0279,bigg_id:"nadph_c"},{coefficient:-3.7478,bigg_id:"accoa_c"},{coefficient:-1.7867,bigg_id:"oaa_c"},{coefficient:-.129,bigg_id:"g3p_c"},{coefficient:-3.547,bigg_id:"nad_c"},{coefficient:59.81,bigg_id:"pi_c"},{coefficient:-.205,bigg_id:"g6p_c"},{coefficient:4.1182,bigg_id:"akg_c"},{coefficient:-.5191,bigg_id:"pep_c"},{coefficient:-4.9414,bigg_id:"glu__L_c"},{coefficient:-59.81,bigg_id:"atp_c"},{coefficient:59.81,bigg_id:"adp_c"},{coefficient:59.81,bigg_id:"h_c"},{coefficient:-59.81,bigg_id:"h2o_c"},{coefficient:13.0279,bigg_id:"nadp_c"}],label_x:5392.94580078125,label_y:4746.6962890625,gene_reaction_rule:""},1577548:{name:"Aconitase (half-reaction A, Citrate hydro-lyase)",bigg_id:"ACONTa",segments:{507:{to_node_id:"1577100",from_node_id:"1577099",b2:null,b1:null},508:{to_node_id:"1577100",from_node_id:"1577101",b2:null,b1:null},509:{to_node_id:"1577102",from_node_id:"1577101",b2:{y:3993.9154608910203,x:3112.4765239553985},b1:{y:4044.558477078102,x:3125.4142208172407}},510:{to_node_id:"1577103",from_node_id:"1577101",b2:{y:4045.94073519232,x:3126.6630443215304},b1:{y:4044.2013827305695,x:3108.646756937047}},511:{to_node_id:"1576685",from_node_id:"1577099",b2:{y:4010.3555557486548,x:3025.1432055426353},b1:{y:4012.0956406322803,x:3025.7810749583687}}},genes:[{bigg_id:"b0118",name:"acnB"},{bigg_id:"b1276",name:"acnA"}],reversibility:!0,metabolites:[{coefficient:-1,bigg_id:"cit_c"},{coefficient:1,bigg_id:"h2o_c"},{coefficient:1,bigg_id:"acon_C_c"}],label_x:2982.991259697708,label_y:4088.6436288689247,gene_reaction_rule:"b0118 or b1276"},1577549:{name:"Aconitase (half-reaction B, Isocitrate hydro-lyase)",bigg_id:"ACONTb",segments:{512:{to_node_id:"1577105",from_node_id:"1577104",b2:null,b1:null},513:{to_node_id:"1577105",from_node_id:"1577106",b2:null,b1:null},514:{to_node_id:"1577102",from_node_id:"1577104",
b2:{y:3991.5491179659602,x:3266.0226278968735},b1:{y:4044.360816430351,x:3261.354277099013}},515:{to_node_id:"1576505",from_node_id:"1577106",b2:{y:4013.1918298584474,x:3345.4226198631072},b1:{y:4014.8024620364417,x:3344.105236291347}},516:{to_node_id:"1577103",from_node_id:"1577104",b2:{y:4046.222560627323,x:3260.813883986344},b1:{y:4046.056264386829,x:3262.862957011229}}},genes:[{bigg_id:"b1276",name:"acnA"},{bigg_id:"b0118",name:"acnB"}],reversibility:!0,metabolites:[{coefficient:1,bigg_id:"icit_c"},{coefficient:-1,bigg_id:"h2o_c"},{coefficient:-1,bigg_id:"acon_C_c"}],label_x:3291.833217745038,label_y:4081.35343547726,gene_reaction_rule:"b0118 or b1276"}},nodes:{1576485:{node_is_primary:!1,name:"ATP",label_x:1165,node_type:"metabolite",y:2805,x:1145,bigg_id:"atp_c",label_y:2805},1576486:{node_is_primary:!0,name:"3-Phospho-D-glycerate",label_x:1085,node_type:"metabolite",y:2875,x:1055,bigg_id:"3pg_c",label_y:2875},1576487:{node_is_primary:!0,name:"3-Phospho-D-glyceroyl phosphate",label_x:1085,node_type:"metabolite",y:2565,x:1055,bigg_id:"13dpg_c",label_y:2565},1576488:{node_is_primary:!1,name:"ADP",label_x:1165,node_type:"metabolite",y:2635,x:1145,bigg_id:"adp_c",label_y:2635},1576489:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:1907,node_type:"metabolite",y:1165,x:1907,bigg_id:"nadp_c",label_y:1145},1576490:{node_is_primary:!0,name:"6-Phospho-D-gluconate",label_x:1800.0250244140625,node_type:"metabolite",y:1265,x:1827,bigg_id:"6pgc_c",label_y:1235},1576491:{node_is_primary:!1,name:"CO2",label_x:2007,node_type:"metabolite",y:1165,x:2007,bigg_id:"co2_c",label_y:1145},1576492:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:2080,node_type:"metabolite",y:1165,x:2057,bigg_id:"nadph_c",label_y:1140},1576493:{node_is_primary:!0,name:"D-Ribulose 5-phosphate",label_x:2155,node_type:"metabolite",y:1265,x:2155,bigg_id:"ru5p__D_c",label_y:1235},1576494:{node_is_primary:!0,name:"O2",label_x:4840.3310546875,node_type:"metabolite",y:1660,x:4850,bigg_id:"o2_e",label_y:1702.89208984375},1576495:{node_is_primary:!0,name:"O2",label_x:4259.09326171875,node_type:"metabolite",y:1660,x:4330,bigg_id:"o2_c",label_y:1677.4388427734375},1576496:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide phosphate",label_x:3330,node_type:"metabolite",y:1270,x:3330,bigg_id:"nadp_c",label_y:1310},1576497:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide - reduced",label_x:3450,node_type:"metabolite",y:1120,x:3420,bigg_id:"nadh_c",label_y:1150},1576498:{node_is_primary:!1,name:"H+",label_x:3529.338134765625,node_type:"metabolite",y:650,x:3510,bigg_id:"h_e",label_y:639.6690673828125},1576499:{node_is_primary:!1,name:"H+",label_x:3522.892333984375,node_type:"metabolite",y:1080.287841796875,x:3510,bigg_id:"h_c",label_y:1099.0072021484375},1576500:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:3740,node_type:"metabolite",y:1270,x:3740,bigg_id:"nadph_c",label_y:1310},1576501:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide",label_x:3556.820068359375,node_type:"metabolite",y:1147.3958740234375,x:3625.7841796875,bigg_id:"nad_c",label_y:1187.06494140625},1576502:{node_is_primary:!1,name:"H2O",label_x:2693.4130859375,node_type:"metabolite",y:2921,x:2715,bigg_id:"h2o_c",label_y:2896.71923828125},1576503:{node_is_primary:!0,name:"Fumarate",label_x:2867.189453125,node_type:"metabolite",y:2920,x:2843,bigg_id:"fum_c",label_y:2939.602783203125},1576504:{node_is_primary:!0,name:"L-Malate",label_x:2506.83544921875,node_type:"metabolite",y:3192,x:2621,bigg_id:"mal__L_c",label_y:3174.826416015625},1576505:{node_is_primary:!0,name:"Isocitrate",label_x:3344.32373046875,node_type:"metabolite",y:3976,x:3413,bigg_id:"icit_c",label_y:3949.222900390625},1576506:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:3495,node_type:"metabolite",y:4065,x:3495,bigg_id:"nadp_c",label_y:4098},1576507:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:3557.6474609375,node_type:"metabolite",y:3660,x:3659,bigg_id:"nadph_c",label_y:3655.388427734375},1576508:{node_is_primary:!1,name:"CO2",label_x:3539.820068359375,node_type:"metabolite",y:3710,x:3620,bigg_id:"co2_c",label_y:3711.611572265625},1576509:{node_is_primary:!0,name:"2-Oxoglutarate",label_x:3669.712158203125,node_type:"metabolite",y:3627,x:3746,bigg_id:"akg_c",label_y:3611.942626953125},1576510:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:1394.189697265625,node_type:"metabolite",y:3855,x:1365,bigg_id:"nad_c",label_y:3851.826416015625},1576511:{node_is_primary:!0,name:"Pyruvate",label_x:1025,node_type:"metabolite",y:3945,x:1055,bigg_id:"pyr_c",label_y:3965},1576512:{node_is_primary:!1,name:"Coenzyme A",label_x:1287.066162109375,node_type:"metabolite",y:3905,x:1315,bigg_id:"coa_c",label_y:3887.545654296875},1576513:{node_is_primary:!1,name:"CO2",label_x:1595,node_type:"metabolite",y:3855,x:1605,bigg_id:"co2_c",label_y:3835},1576514:{node_is_primary:!0,name:"Acetyl-CoA",label_x:1695,node_type:"metabolite",y:3945,x:1715,bigg_id:"accoa_c",label_y:3965},1576515:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:1647.545654296875,node_type:"metabolite",y:3885,x:1655,bigg_id:"nadh_c",label_y:3855.4794921875},1576516:{node_is_primary:!1,name:"H2O",label_x:1315,node_type:"metabolite",y:3375,x:1295,bigg_id:"h2o_c",label_y:3375},1576517:{node_is_primary:!0,name:"Phosphoenolpyruvate",label_x:1085,node_type:"metabolite",y:3375,x:1055,bigg_id:"pep_c",label_y:3355},1576518:{node_is_primary:!1,name:"CO2",label_x:1215,node_type:"metabolite",y:3345,x:1205,bigg_id:"co2_c",label_y:3325},1576519:{node_is_primary:!1,name:"H+",label_x:1635,node_type:"metabolite",y:3475,x:1615,bigg_id:"h_c",label_y:3475},1576520:{node_is_primary:!1,name:"Phosphate",label_x:1685,node_type:"metabolite",y:3515,x:1665,bigg_id:"pi_c",label_y:3515},1576521:{node_is_primary:!0,name:"Oxaloacetate",label_x:2692,node_type:"metabolite",y:3724,x:2659,bigg_id:"oaa_c",label_y:3724},1576522:{node_is_primary:!0,name:"D-Glycerate 2-phosphate",label_x:1093,node_type:"metabolite",y:3125,x:1055,bigg_id:"2pg_c",label_y:3125},1576523:{node_is_primary:!1,name:"H2O",label_x:886.289794921875,node_type:"metabolite",y:3325,x:965,bigg_id:"h2o_c",label_y:3307.958740234375},1576524:{node_is_primary:!0,name:"D-Glucose 6-phosphate",label_x:1075,node_type:"metabolite",y:1265,x:1055,bigg_id:"g6p_c",label_y:1245},1576525:{node_is_primary:!0,name:"D-Fructose 6-phosphate",label_x:1075,node_type:"metabolite",y:1545,x:1055,bigg_id:"f6p_c",label_y:1525},1576526:{node_is_primary:!0,name:"Ammonium",label_x:4019,node_type:"metabolite",y:4757,x:3989,bigg_id:"nh4_e",label_y:4757},1576527:{node_is_primary:!0,name:"Ammonium",label_x:4019,node_type:"metabolite",y:4441,x:3989,bigg_id:"nh4_c",label_y:4441},1576528:{node_is_primary:!1,name:"H2O",label_x:672.9427490234375,node_type:"metabolite",y:1855,x:765,bigg_id:"h2o_c",label_y:1861.3470458984375},1576529:{node_is_primary:!0,name:"D-Fructose 1,6-bisphosphate",label_x:1096.404296875,node_type:"metabolite",y:1925,x:1055,bigg_id:"fdp_c",label_y:1928.173583984375},1576530:{node_is_primary:!1,name:"Phosphate",label_x:686.744140625,node_type:"metabolite",y:1565,x:755,bigg_id:"pi_c",label_y:1563.4132080078125},1576531:{node_is_primary:!0,name:"Succinate",label_x:4950.4462890625,node_type:"metabolite",y:2880,x:4932,bigg_id:"succ_e",label_y:2915.280517578125},1576532:{node_is_primary:!0,name:"Glyoxylate",label_x:3211.3271484375,node_type:"metabolite",y:3570,x:3180,bigg_id:"glx_c",label_y:3543.267578125},1576533:{node_is_primary:!0,name:"Succinate",label_x:3439.01611328125,node_type:"metabolite",y:2867,x:3420,bigg_id:"succ_c",label_y:2838.810302734375},1576534:{node_is_primary:!0,name:"ATP",label_x:4215,node_type:"metabolite",y:1040,x:4215,bigg_id:"atp_c",label_y:1010},1576535:{node_is_primary:!0,name:"AMP",label_x:4033.388427734375,node_type:"metabolite",y:1070,x:4065,bigg_id:"amp_c",label_y:1030.661865234375},1576536:{node_is_primary:!0,name:"ADP",label_x:4196.611328125,node_type:"metabolite",y:1510,x:4215,bigg_id:"adp_c",label_y:1556.1151123046875},1576537:{node_is_primary:!0,name:"L-Glutamine",label_x:4851.38134765625,node_type:"metabolite",y:4158,x:4882,bigg_id:"gln__L_e",label_y:4199.2802734375},1576539:{node_is_primary:!0,name:"Ubiquinone-8",label_x:4686.61181640625,node_type:"metabolite",y:2215.0361328125,x:4758.67626953125,bigg_id:"q8_c",label_y:2192.47509765625},1576542:{node_is_primary:!0,name:"Ubiquinol-8",label_x:4411.00048828125,node_type:"metabolite",y:2210.3310546875,x:4508.47509765625,bigg_id:"q8h2_c",label_y:2217.395751953125},1576544:{node_is_primary:!0,name:"CO2",label_x:3651,node_type:"metabolite",y:4754,x:3621,bigg_id:"co2_e",label_y:4754},1576545:{node_is_primary:!0,name:"Glyceraldehyde 3-phosphate",label_x:2375.091552734375,node_type:"metabolite",y:1865,x:2358.984130859375,bigg_id:"g3p_c",label_y:1898.4132080078125},1576546:{node_is_primary:!0,name:"Sedoheptulose 7-phosphate",label_x:1955.8675537109375,node_type:"metabolite",y:1865,x:1983.082275390625,bigg_id:"s7p_c",label_y:1814.314697265625},1576547:{node_is_primary:!0,name:"D-Erythrose 4-phosphate",label_x:1922.7852783203125,node_type:"metabolite",y:2190,x:1945,bigg_id:"e4p_c",label_y:2242.214599609375},1576548:{node_is_primary:!0,name:"D-Fructose 6-phosphate",label_x:2367.636962890625,node_type:"metabolite",y:2186.826416015625,x:2362.636962890625,bigg_id:"f6p_c",label_y:2216.826416015625},1576549:{node_is_primary:!1,name:"H+",label_x:911.677978515625,node_type:"metabolite",y:3625,x:965,bigg_id:"h_c",label_y:3612.305908203125},1576550:{node_is_primary:!1,name:"ADP",label_x:903.744140625,node_type:"metabolite",y:3555,x:965,bigg_id:"adp_c",label_y:3528.02490234375},1576551:{node_is_primary:!1,name:"ATP",label_x:929.1323852539062,node_type:"metabolite",y:3815,x:965,bigg_id:"atp_c",label_y:3794.372314453125},1576552:{node_is_primary:!0,name:"L-Glutamate",label_x:4883,node_type:"metabolite",y:3634,x:4883,bigg_id:"glu__L_e",label_y:3604},1576553:{node_is_primary:!1,name:"H+",label_x:4857.23046875,node_type:"metabolite",y:3703,x:4825,bigg_id:"h_e",label_y:3723},1576554:{node_is_primary:!0,name:"L-Glutamate",label_x:4221.2158203125,node_type:"metabolite",y:3632,x:4248,bigg_id:"glu__L_c",label_y:3601},1576555:{node_is_primary:!1,name:"H+",label_x:4503.1796875,node_type:"metabolite",y:3688,x:4478,bigg_id:"h_c",label_y:3696.834716796875},1576556:{node_is_primary:!0,name:"D-Lactate",label_x:1088.470458984375,node_type:"metabolite",y:4835,x:1055,bigg_id:"lac__D_e",label_y:4857.21484375},1576557:{node_is_primary:!0,name:"Pyruvate",label_x:249.61181640625,node_type:"metabolite",y:3945,x:275,bigg_id:"pyr_e",label_y:3994.041015625},1576558:{node_is_primary:!0,name:"D-Xylulose 5-phosphate",label_x:1944.76025390625,node_type:"metabolite",y:1555,x:1945,bigg_id:"xu5p__D_c",label_y:1599.5205078125},1576559:{node_is_primary:!0,name:"H+",label_x:4867.7265625,node_type:"metabolite",y:2229,x:4850,bigg_id:"h_e",label_y:2273.503662109375},1576567:{node_is_primary:!1,name:"Coenzyme A",label_x:3448.892578125,node_type:"metabolite",y:2960,x:3460,bigg_id:"coa_c",label_y:2991.107421875},1576568:{node_is_primary:!1,name:"ATP",label_x:3496.826416015625,node_type:"metabolite",y:3030,x:3500,bigg_id:"atp_c",label_y:3062.694091796875},1576569:{node_is_primary:!1,name:"Phosphate",label_x:3814,node_type:"metabolite",y:3051,x:3794,bigg_id:"pi_c",label_y:3051},1576570:{node_is_primary:!0,name:"Succinyl-CoA",label_x:3772.230712890625,node_type:"metabolite",y:3193,x:3739,bigg_id:"succoa_c",label_y:3193.479248046875},1576571:{node_is_primary:!1,name:"ADP",label_x:3788,node_type:"metabolite",y:3116,x:3768,bigg_id:"adp_c",label_y:3126},1576572:{node_is_primary:!1,name:"ATP",label_x:1165,node_type:"metabolite",y:1645,x:1145,bigg_id:"atp_c",label_y:1645},1576573:{node_is_primary:!1,name:"ADP",label_x:1165,node_type:"metabolite",y:1805,x:1145,bigg_id:"adp_c",label_y:1805},1576574:{node_is_primary:!1,name:"H+",label_x:1165,node_type:"metabolite",y:1855,x:1145,bigg_id:"h_c",label_y:1855},1576575:{node_is_primary:!0,name:"Glyceraldehyde 3-phosphate",label_x:1085,node_type:"metabolite",y:2195,x:1055,bigg_id:"g3p_c",label_y:2195},1576576:{node_is_primary:!1,name:"ATP",label_x:4474,node_type:"metabolite",y:3755,x:4440,bigg_id:"atp_c",label_y:3753},1576577:{node_is_primary:!1,name:"Ammonium",label_x:4477,node_type:"metabolite",y:3805,x:4440,bigg_id:"nh4_c",label_y:3811},1576578:{node_is_primary:!0,name:"L-Glutamine",label_x:4245,node_type:"metabolite",y:4094,x:4246,bigg_id:"gln__L_c",label_y:4130},1576579:{node_is_primary:!1,name:"ADP",label_x:4454,node_type:"metabolite",y:3954,x:4434,bigg_id:"adp_c",label_y:3954},1576580:{node_is_primary:!1,name:"H+",label_x:4454,node_type:"metabolite",y:4004,x:4434,bigg_id:"h_c",label_y:4004},1576581:{node_is_primary:!1,name:"Phosphate",label_x:4454,node_type:"metabolite",y:4054,x:4434,bigg_id:"pi_c",label_y:4054},1576584:{node_is_primary:!0,name:"D-Lactate",label_x:1089,node_type:"metabolite",y:4345,x:1055,bigg_id:"lac__D_c",label_y:4349},1576585:{node_is_primary:!1,name:"Coenzyme A",label_x:3628.99267578125,node_type:"metabolite",y:3506,x:3684,bigg_id:"coa_c",label_y:3483.05029296875},1576586:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:3606.208740234375,node_type:"metabolite",y:3558,x:3684,bigg_id:"nad_c",label_y:3539.885009765625},1576587:{node_is_primary:!1,name:"CO2",label_x:3898,node_type:"metabolite",y:3285,x:3872,bigg_id:"co2_c",label_y:3285},1576588:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:3846,node_type:"metabolite",y:3233,x:3820,bigg_id:"nadh_c",label_y:3233},1576589:{node_is_primary:!1,name:"Coenzyme A",label_x:1165,node_type:"metabolite",y:4045,x:1165,bigg_id:"coa_c",label_y:4065},1576590:{node_is_primary:!0,name:"Formate",label_x:1495.230712890625,node_type:"metabolite",y:4095,x:1460,bigg_id:"for_c",label_y:4083.958984375},1576591:{node_is_primary:!1,name:"ATP",label_x:1525,node_type:"metabolite",y:3625,x:1505,bigg_id:"atp_c",label_y:3625},1576592:{node_is_primary:!1,name:"ADP",label_x:1285,node_type:"metabolite",y:3545,x:1285,bigg_id:"adp_c",label_y:3575},1576593:{node_is_primary:!1,name:"CO2",label_x:1215,node_type:"metabolite",y:3515,x:1215,bigg_id:"co2_c",label_y:3535},1576594:{node_is_primary:!0,name:"Phosphate",label_x:2910,node_type:"metabolite",y:4839,x:2880,bigg_id:"pi_e",label_y:4839},1576595:{node_is_primary:!1,name:"H+",label_x:2733.83544921875,node_type:"metabolite",y:4778,x:2793,bigg_id:"h_e",label_y:4763.8515625},1576596:{node_is_primary:!1,name:"H+",label_x:2754.13232421875,node_type:"metabolite",y:4452,x:2793,bigg_id:"h_c",label_y:4426.61181640625},1576597:{node_is_primary:!0,name:"Phosphate",label_x:2921,node_type:"metabolite",y:4430,x:2880,bigg_id:"pi_c",label_y:4428},1576598:{node_is_primary:!0,name:"2-Oxoglutarate",label_x:4922,node_type:"metabolite",y:3228,x:4922,bigg_id:"akg_e",label_y:3268},1576599:{node_is_primary:!1,name:"H+",label_x:4861.39599609375,node_type:"metabolite",y:3321,x:4834,bigg_id:"h_e",label_y:3334.553955078125},1576600:{node_is_primary:!1,name:"H+",label_x:4490.337890625,node_type:"metabolite",y:3328,x:4472,bigg_id:"h_c",label_y:3342.330810546875},1576601:{node_is_primary:!0,name:"Dihydroxyacetone phosphate",label_x:739.3148193359375,node_type:"metabolite",y:2195,x:855,bigg_id:"dhap_c",label_y:2179.132568359375},1576602:{node_is_primary:!1,name:"H+",label_x:4234.01416015625,node_type:"metabolite",y:1895.1654052734375,x:4301.69775390625,bigg_id:"h_c",label_y:1903.8848876953125},1576603:{node_is_primary:!1,name:"H+",label_x:4858.38818359375,node_type:"metabolite",y:1900,x:4860,bigg_id:"h_e",label_y:1950.6187744140625},1576604:{node_is_primary:!1,name:"H2O",label_x:4452.77001953125,node_type:"metabolite",y:1760.9495849609375,x:4439.09375,bigg_id:"h2o_c",label_y:1736.77685546875},1576605:{node_is_primary:!0,name:"Alpha-D-Ribose 5-phosphate",label_x:2418.413330078125,node_type:"metabolite",y:1555,x:2419,bigg_id:"r5p_c",label_y:1601.1072998046875},1576606:{node_is_primary:!1,name:"Acetyl-CoA",label_x:3125,node_type:"metabolite",y:3402,x:3105,bigg_id:"accoa_c",label_y:3402},1576607:{node_is_primary:!1,name:"H2O",label_x:3190,node_type:"metabolite",y:3480,x:3170,bigg_id:"h2o_c",label_y:3480},1576608:{node_is_primary:!1,name:"H+",label_x:2891,node_type:"metabolite",y:3220,x:2871,bigg_id:"h_c",label_y:3220},1576609:{node_is_primary:!1,name:"Coenzyme A",label_x:2800,node_type:"metabolite",y:3168,x:2780,bigg_id:"coa_c",label_y:3168},1576612:{node_is_primary:!1,name:"Phosphate",label_x:1835,node_type:"metabolite",y:4035,x:1815,bigg_id:"pi_c",label_y:4035},1576613:{node_is_primary:!0,name:"Acetyl phosphate",label_x:1745,node_type:"metabolite",y:4175,x:1715,bigg_id:"actp_c",label_y:4175},1576614:{node_is_primary:!1,name:"Coenzyme A",label_x:1835,node_type:"metabolite",y:4135,x:1815,bigg_id:"coa_c",label_y:4135},1576615:{node_is_primary:!1,name:"ATP",label_x:4552.7265625,node_type:"metabolite",y:4258,x:4535,bigg_id:"atp_c",label_y:4269.94287109375},1576616:{node_is_primary:!1,name:"H2O",label_x:4481.77685546875,node_type:"metabolite",y:4258,x:4485,bigg_id:"h2o_c",label_y:4287.6689453125},1576617:{node_is_primary:!1,name:"Phosphate",label_x:4268.884765625,node_type:"metabolite",y:4258,x:4285,bigg_id:"pi_c",label_y:4287.6689453125},1576618:{node_is_primary:!1,name:"ADP",label_x:4381.77685546875,node_type:"metabolite",y:4258,x:4385,bigg_id:"adp_c",label_y:4290.89208984375},1576619:{node_is_primary:!1,name:"H+",label_x:4331.77734375,node_type:"metabolite",y:4258,x:4335,bigg_id:"h_c",label_y:4286.0576171875},1576620:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:2380,node_type:"metabolite",y:3220,x:2360,bigg_id:"nad_c",label_y:3220},1576621:{node_is_primary:!1,name:"CO2",label_x:1979.703125,node_type:"metabolite",y:3420,x:2060,bigg_id:"co2_c",label_y:3415.23974609375},1576622:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:1994.9427490234375,node_type:"metabolite",y:3370,x:2080,bigg_id:"nadh_c",label_y:3350.958740234375},1576623:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:1257,node_type:"metabolite",y:1160,x:1257,bigg_id:"nadp_c",label_y:1140},1576624:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:1430,node_type:"metabolite",y:1160,x:1407,bigg_id:"nadph_c",label_y:1140},1576625:{node_is_primary:!1,name:"H+",label_x:1357,node_type:"metabolite",y:1160,x:1357,bigg_id:"h_c",label_y:1140},1576626:{node_is_primary:!0,name:"6-phospho-D-glucono-1,5-lactone",label_x:1507,node_type:"metabolite",y:1265,x:1507,bigg_id:"6pgl_c",label_y:1235},1576627:{node_is_primary:!0,name:"Acetate",label_x:1759.0985107421875,node_type:"metabolite",y:4845,x:1715,bigg_id:"ac_e",label_y:4848.173828125},1576628:{node_is_primary:!1,name:"H2O",label_x:4175.82763671875,node_type:"metabolite",y:3940,x:4201,bigg_id:"h2o_c",label_y:3972.89208984375},1576629:{node_is_primary:!1,name:"Ammonium",label_x:4160.99267578125,node_type:"metabolite",y:3762,x:4193,bigg_id:"nh4_c",label_y:3793.22314453125},1576630:{node_is_primary:!1,name:"H2O",label_x:4295,node_type:"metabolite",y:1140,x:4275,bigg_id:"h2o_c",label_y:1140},1576631:{node_is_primary:!1,name:"Phosphate",label_x:4305,node_type:"metabolite",y:1450,x:4285,bigg_id:"pi_c",label_y:1450},1576632:{node_is_primary:!1,name:"H+",label_x:4305,node_type:"metabolite",y:1380,x:4285,bigg_id:"h_c",label_y:1380},1576633:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:935,node_type:"metabolite",y:4255,x:955,bigg_id:"nad_c",label_y:4255},1576634:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:935,node_type:"metabolite",y:4045,x:955,bigg_id:"nadh_c",label_y:4045},1576635:{node_is_primary:!1,name:"H+",label_x:935,node_type:"metabolite",y:4095,x:955,bigg_id:"h_c",label_y:4095},1576636:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:2690,node_type:"metabolite",y:3310,x:2670,bigg_id:"nad_c",label_y:3320},1576637:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:2710,node_type:"metabolite",y:3585,x:2680,bigg_id:"nadh_c",label_y:3590},1576638:{node_is_primary:!1,name:"H+",label_x:2692,node_type:"metabolite",y:3510,x:2660,bigg_id:"h_c",label_y:3510},1576639:{node_is_primary:!0,name:"H2O",label_x:3287,node_type:"metabolite",y:4754,x:3257,bigg_id:"h2o_e",label_y:4754},1576640:{node_is_primary:!0,name:"H2O",label_x:3287,node_type:"metabolite",y:4434,x:3257,bigg_id:"h2o_c",label_y:4434},1576641:{node_is_primary:!0,name:"CO2",label_x:3651,node_type:"metabolite",y:4434,x:3621,bigg_id:"co2_c",label_y:4434},1576642:{node_is_primary:!1,name:"ATP",label_x:670.5706176757812,node_type:"metabolite",y:3855,x:735,bigg_id:"atp_c",label_y:3840.71923828125},1576643:{node_is_primary:!1,name:"H2O",label_x:681.677978515625,node_type:"metabolite",y:3805,x:735,bigg_id:"h2o_c",label_y:3787.545654296875},1576644:{node_is_primary:!1,name:"H+",label_x:672.1574096679688,node_type:"metabolite",y:3475,x:735,bigg_id:"h_c",label_y:3478.173583984375},1576645:{node_is_primary:!1,name:"AMP",label_x:640.4221801757812,node_type:"metabolite",y:3525,x:735,bigg_id:"amp_c",label_y:3545.6279296875},1576646:{node_is_primary:!1,name:"Phosphate",label_x:684.8515014648438,node_type:"metabolite",y:3425,x:735,bigg_id:"pi_c",label_y:3409.13232421875},1576647:{node_is_primary:!0,name:"D-Glucose",label_x:1085.066162109375,node_type:"metabolite",y:705,x:1055.066162109375,bigg_id:"glc__D_e",label_y:705},1576648:{node_is_primary:!1,name:"H+",label_x:2620,node_type:"metabolite",y:4760,x:2600,bigg_id:"h_e",label_y:4760},1576649:{node_is_primary:!0,name:"Ethanol",label_x:2530,node_type:"metabolite",y:4830,x:2500,bigg_id:"etoh_e",label_y:4830},1576650:{node_is_primary:!1,name:"H+",label_x:2620,node_type:"metabolite",y:4400,x:2600,bigg_id:"h_c",label_y:4400},1576651:{node_is_primary:!1,name:"ATP",label_x:1835,node_type:"metabolite",y:4335,x:1815,bigg_id:"atp_c",label_y:4335},1576652:{node_is_primary:!0,name:"Acetate",label_x:1745,node_type:"metabolite",y:4385,x:1715,bigg_id:"ac_c",label_y:4385},1576653:{node_is_primary:!1,name:"ADP",label_x:1835,node_type:"metabolite",y:4225,x:1815,bigg_id:"adp_c",label_y:4225},1576654:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:3993.9423828125,node_type:"metabolite",y:3932,x:4029,bigg_id:"nadph_c",label_y:3909.05029296875},1576655:{node_is_primary:!1,name:"H+",label_x:4002,node_type:"metabolite",y:3982,x:4029,bigg_id:"h_c",label_y:3986},1576656:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:3957.985595703125,node_type:"metabolite",y:3759,x:4043,bigg_id:"nadp_c",label_y:3736.215576171875},1576657:{node_is_primary:!0,name:"Fumarate",label_x:2879.817626953125,node_type:"metabolite",y:650,x:2840,bigg_id:"fum_e",label_y:635.0911865234375},1576658:{node_is_primary:!1,name:"H+",label_x:2962.214599609375,node_type:"metabolite",y:700,x:2940,bigg_id:"h_e",label_y:718.4132080078125},1576659:{node_is_primary:!1,name:"H+",label_x:2954.28076171875,node_type:"metabolite",y:1010,x:2940,bigg_id:"h_c",label_y:1038.4132080078125},1576660:{node_is_primary:!1,name:"H+",label_x:1835,node_type:"metabolite",y:4775,x:1815,bigg_id:"h_e",label_y:4775},1576661:{node_is_primary:!1,name:"H+",label_x:1839.76025390625,node_type:"metabolite",y:4452.45458984375,x:1819.76025390625,bigg_id:"h_c",label_y:4452.45458984375},1576662:{node_is_primary:!1,name:"Phosphoenolpyruvate",label_x:877.8765258789062,node_type:"metabolite",y:974.4060668945312,x:957.694091796875,bigg_id:"pep_c",label_y:976.9517211914062},1576663:{node_is_primary:!1,name:"Pyruvate",label_x:1193.082275390625,node_type:"metabolite",y:972.8192138671875,x:1161.3470458984375,bigg_id:"pyr_c",label_y:986.47216796875},1576664:{node_is_primary:!1,name:"H+",label_x:4818.7197265625,node_type:"metabolite",y:2921.942138671875,x:4791.7197265625,bigg_id:"h_e",label_y:2921.942138671875},1576665:{node_is_primary:!1,name:"H+",label_x:4389.423828125,node_type:"metabolite",y:2763.553955078125,x:4461.380859375,bigg_id:"h_c",label_y:2763.9423828125},1576666:{node_is_primary:!0,name:"Formate",label_x:1500,node_type:"metabolite",y:4843.322265625,x:1460,bigg_id:"for_e",label_y:4843.322265625},1576667:{node_is_primary:!1,name:"H2O",label_x:1587,node_type:"metabolite",y:1160,x:1587,bigg_id:"h2o_c",label_y:1140},1576668:{node_is_primary:!1,name:"H+",label_x:1687,node_type:"metabolite",y:1160,x:1687,bigg_id:"h_c",label_y:1140},1576669:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:1165,node_type:"metabolite",y:2265,x:1145,bigg_id:"nad_c",label_y:2265},1576670:{node_is_primary:!1,name:"Phosphate",label_x:1165,node_type:"metabolite",y:2315,x:1145,bigg_id:"pi_c",label_y:2315},1576671:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:1165,node_type:"metabolite",y:2515,x:1145,bigg_id:"nadh_c",label_y:2515},1576672:{node_is_primary:!1,name:"H+",label_x:1169,node_type:"metabolite",y:2465,x:1145,bigg_id:"h_c",label_y:2465},1576673:{node_is_primary:!1,name:"H+",label_x:4836,node_type:"metabolite",y:3087,x:4836,bigg_id:"h_e",label_y:3115},1576674:{node_is_primary:!1,name:"H+",label_x:4456,node_type:"metabolite",y:3087,x:4456,bigg_id:"h_c",label_y:3109},1576675:{node_is_primary:!1,name:"H2O",label_x:4210,node_type:"metabolite",y:3558,x:4192,bigg_id:"h2o_c",label_y:3530},1576676:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:4142,node_type:"metabolite",y:3558,x:4142,bigg_id:"nadp_c",label_y:3528},1576677:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:3935.431640625,node_type:"metabolite",y:3558,x:3992,bigg_id:"nadph_c",label_y:3532.22314453125},1576678:{node_is_primary:!1,name:"Ammonium",label_x:3856.820068359375,node_type:"metabolite",y:3558,x:3942,bigg_id:"nh4_c",label_y:3573.222900390625},1576679:{node_is_primary:!1,name:"H+",label_x:4050,node_type:"metabolite",y:3558,x:4042,bigg_id:"h_c",label_y:3530},1576680:{node_is_primary:!1,name:"H+",label_x:4865,node_type:"metabolite",y:1150,x:4865,bigg_id:"h_e",label_y:1180},1576681:{node_is_primary:!1,name:"Phosphate",label_x:4459.546875,node_type:"metabolite",y:1330,x:4495,bigg_id:"pi_c",label_y:1293.5970458984375},1576682:{node_is_primary:!1,name:"H+",label_x:4398.884765625,node_type:"metabolite",y:1150,x:4415,bigg_id:"h_c",label_y:1187.7266845703125},1576683:{node_is_primary:!1,name:"H2O",label_x:4482.7265625,node_type:"metabolite",y:1030,x:4482.7265625,bigg_id:"h2o_c",label_y:1010},1576684:{node_is_primary:!1,name:"H2O",label_x:2599.520751953125,node_type:"metabolite",y:3860,x:2610,bigg_id:"h2o_c",label_y:3890.1484375},1576685:{node_is_primary:!0,name:"Citrate",label_x:2972.653076171875,node_type:"metabolite",y:3986,x:2971,bigg_id:"cit_c",label_y:3943.1826171875},1576686:{node_is_primary:!1,name:"Coenzyme A",label_x:2786.826416015625,node_type:"metabolite",y:4091,x:2806,bigg_id:"coa_c",label_y:4132.21484375},1576687:{node_is_primary:!1,name:"H+",label_x:2899.041015625,node_type:"metabolite",y:4117,x:2897,bigg_id:"h_c",label_y:4155.8671875},1576688:{node_is_primary:!1,name:"H+",label_x:351.3470764160156,node_type:"metabolite",y:4045,x:345,bigg_id:"h_e",label_y:4072.933837890625},1576689:{node_is_primary:!1,name:"H+",label_x:675,node_type:"metabolite",y:4045,x:675,bigg_id:"h_c",label_y:4077.694091796875},1576690:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:2450,node_type:"metabolite",y:3370,x:2430,bigg_id:"nadp_c",label_y:3370},1576691:{node_is_primary:!1,name:"CO2",label_x:2280,node_type:"metabolite",y:3510,x:2260,bigg_id:"co2_c",label_y:3510},1576692:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:2220,node_type:"metabolite",y:3540,x:2200,bigg_id:"nadph_c",label_y:3550},1576808:{node_is_primary:!1,name:"H+",label_x:4874.1728515625,node_type:"metabolite",y:2570,x:4850,bigg_id:"h_e",label_y:2601.280517578125},1576809:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide",label_x:4356.72412109375,node_type:"metabolite",y:2646.77685546875,x:4449.00732421875,bigg_id:"nad_c",label_y:2646.95849609375},1576810:{node_is_primary:!1,name:"H+",label_x:2473.50439453125,node_type:"metabolite",y:1010,x:2510,bigg_id:"h_c",label_y:1043.1734619140625},1576811:{node_is_primary:!1,name:"H+",label_x:1245.23974609375,node_type:"metabolite",y:4440,x:1270,bigg_id:"h_c",label_y:4424.13232421875},1576812:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:1868.892578125,node_type:"metabolite",y:3860,x:1890,bigg_id:"nadh_c",label_y:3840.810302734375},1576813:{node_is_primary:!1,name:"H+",label_x:2406,node_type:"metabolite",y:3980,x:2392,bigg_id:"h_c",label_y:3965},1576814:{node_is_primary:!1,name:"Ubiquinone-8",label_x:3228.082275390625,node_type:"metabolite",y:2730,x:3210,bigg_id:"q8_c",label_y:2736.34716796875},1576815:{node_is_primary:!0,name:"Acetaldehyde",label_x:2240,node_type:"metabolite",y:4837.65283203125,x:2210,bigg_id:"acald_e",label_y:4837.65283203125},1576816:{node_is_primary:!0,name:"L-Malate",label_x:2640,node_type:"metabolite",y:650,x:2610,bigg_id:"mal__L_e",label_y:630},1576817:{node_is_primary:!0,name:"Acetaldehyde",label_x:2210,node_type:"metabolite",y:3945,x:2210,bigg_id:"acald_c",label_y:3905},1576819:{node_is_primary:!1,name:"Phosphoenolpyruvate",label_x:554.497314453125,node_type:"metabolite",y:1448.4132080078125,x:565.6046142578125,bigg_id:"pep_c",label_y:1479.5206298828125},1576820:{node_is_primary:!1,name:"H+",label_x:4273.546875,node_type:"metabolite",y:2570,x:4310,bigg_id:"h_c",label_y:2604.6689453125},1576821:{node_is_primary:!1,name:"Pyruvate",label_x:692.5455932617188,node_type:"metabolite",y:1237.785400390625,x:714.76025390625,bigg_id:"pyr_c",label_y:1207.785400390625},1576822:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:2496,node_type:"metabolite",y:4065,x:2482,bigg_id:"nad_c",label_y:4051},1576824:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:2347,node_type:"metabolite",y:3935,x:2333,bigg_id:"nadh_c",label_y:3921},1576825:{node_is_primary:!1,name:"Coenzyme A",label_x:2140,node_type:"metabolite",y:3860,x:2130,bigg_id:"coa_c",label_y:3840},1576826:{node_is_primary:!0,name:"D-Fructose",label_x:284.1323547363281,node_type:"metabolite",y:1360,x:300,bigg_id:"fru_e",label_y:1405.8675537109375},1576827:{node_is_primary:!0,name:"Nicotinamide adenine dinucleotide - reduced",label_x:4322.0859375,node_type:"metabolite",y:2478.91357421875,x:4417.8271484375,bigg_id:"nadh_c",label_y:2462.79833984375},1576828:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:2070,node_type:"metabolite",y:3860,x:2070,bigg_id:"nad_c",label_y:3840},1576829:{node_is_primary:!0,name:"Ethanol",label_x:2522,node_type:"metabolite",y:4228,x:2501,bigg_id:"etoh_c",label_y:4206},1576830:{node_is_primary:!1,name:"Ubiquinol-8",label_x:3041.5869140625,node_type:"metabolite",y:2740,x:3020,bigg_id:"q8h2_c",label_y:2740},1576831:{node_is_primary:!1,name:"H+",label_x:2460.1826171875,node_type:"metabolite",y:700,x:2510,bigg_id:"h_e",label_y:722.5455932617188},1576832:{node_is_primary:!1,name:"H+",label_x:1950,node_type:"metabolite",y:3860,x:1950,bigg_id:"h_c",label_y:3840},1576833:{node_is_primary:!1,name:"H+",label_x:1228.8927001953125,node_type:"metabolite",y:4770,x:1270,bigg_id:"h_e",label_y:4750.95849609375},1576834:{y:2665,x:1055,node_type:"multimarker"},1576835:{y:2775,x:1055,node_type:"multimarker"},1576836:{y:2725,x:1055,node_type:"midmarker"},1576837:{y:1265,x:1957,node_type:"midmarker"},1576838:{y:1265,x:1937,node_type:"multimarker"},1576839:{y:1265,x:1977,node_type:"multimarker"},1576840:{y:1660,x:4660,node_type:"midmarker"},1576841:{y:820,x:3510,node_type:"midmarker"},1576842:{y:800,x:3510,node_type:"multimarker"},1576843:{y:870,x:3510,node_type:"multimarker"},
1576844:{y:3022,x:2727,node_type:"multimarker"},1576845:{y:3076,x:2684,node_type:"midmarker"},1576846:{y:3846,x:3606,node_type:"midmarker"},1576847:{y:3923,x:3512,node_type:"multimarker"},1576848:{y:3781,x:3663,node_type:"multimarker"},1576849:{y:3945,x:1430,node_type:"multimarker"},1576850:{y:3945,x:1495,node_type:"midmarker"},1576851:{y:3945,x:1555,node_type:"multimarker"},1576852:{y:3486,x:1414,node_type:"midmarker"},1576853:{y:3519,x:1493,node_type:"multimarker"},1576854:{y:3458,x:1348,node_type:"multimarker"},1576855:{y:3265,x:1055,node_type:"multimarker"},1576856:{y:3225,x:1055,node_type:"midmarker"},1576857:{y:1395,x:1055,node_type:"midmarker"},1576858:{y:4598,x:3989,node_type:"midmarker"},1576859:{y:1715,x:835,node_type:"midmarker"},1576860:{y:1665,x:835,node_type:"multimarker"},1576861:{y:1765,x:835,node_type:"multimarker"},1576863:{y:2880,x:5025,node_type:"midmarker"},1576864:{y:3766,x:3417,node_type:"multimarker"},1576865:{y:3857,x:3417,node_type:"midmarker"},1576866:{y:1260,x:4145,node_type:"midmarker"},1576867:{y:1200,x:4145,node_type:"multimarker"},1576868:{y:4158,x:5020,node_type:"midmarker"},1576871:{y:4914,x:3621,node_type:"midmarker"},1576872:{y:1995,x:2178,node_type:"midmarker"},1576873:{y:1955,x:2175,node_type:"multimarker"},1576874:{y:2035,x:2178,node_type:"multimarker"},1576875:{y:3655,x:1055,node_type:"multimarker"},1576876:{y:3705,x:1055,node_type:"midmarker"},1576877:{y:3745,x:1055,node_type:"multimarker"},1576878:{y:3635,x:4645,node_type:"midmarker"},1576879:{y:3635,x:4541,node_type:"multimarker"},1576880:{y:3635,x:4779,node_type:"multimarker"},1576881:{y:4925,x:1055,node_type:"midmarker"},1576884:{y:3945,x:155,node_type:"midmarker"},1576885:{y:1415,x:2045,node_type:"midmarker"},1576887:{y:2230,x:4986,node_type:"midmarker"},1576888:{y:3020,x:3631,node_type:"midmarker"},1576889:{y:2976,x:3588,node_type:"multimarker"},1576890:{y:3063,x:3666,node_type:"multimarker"},1576891:{y:1735,x:1055,node_type:"midmarker"},1576892:{y:1775,x:1055,node_type:"multimarker"},1576893:{y:1690,x:1055,node_type:"multimarker"},1576895:{y:3636,x:5015,node_type:"midmarker"},1576896:{y:1735,x:1525,node_type:"midmarker"},1576897:{y:1735,x:1695,node_type:"multimarker"},1576898:{y:1735,x:1405,node_type:"multimarker"},1576899:{y:3889,x:4364,node_type:"multimarker"},1576900:{y:3869,x:4364,node_type:"midmarker"},1576901:{y:3849,x:4364,node_type:"multimarker"},1576905:{y:1270,x:3470,node_type:"multimarker"},1576906:{y:1270,x:3570,node_type:"multimarker"},1576907:{y:1270,x:3520,node_type:"midmarker"},1576908:{y:3480,x:3780,node_type:"multimarker"},1576909:{y:3402,x:3783,node_type:"midmarker"},1576910:{y:3330,x:3776,node_type:"multimarker"},1576911:{y:3995,x:1335,node_type:"midmarker"},1576912:{y:3995,x:1255,node_type:"multimarker"},1576913:{y:3995,x:1415,node_type:"multimarker"},1576914:{y:1660,x:4970,node_type:"midmarker"},1576916:{y:3526,x:1404,node_type:"midmarker"},1576917:{y:3554,x:1485,node_type:"multimarker"},1576918:{y:3503,x:1335,node_type:"multimarker"},1576919:{y:4520,x:2880,node_type:"multimarker"},1576920:{y:4580,x:2880,node_type:"midmarker"},1576921:{y:4725,x:2880,node_type:"multimarker"},1576922:{y:3228,x:4502,node_type:"multimarker"},1576923:{y:3228,x:4792,node_type:"multimarker"},1576924:{y:3228,x:4662,node_type:"midmarker"},1576925:{y:2045,x:1055,node_type:"multimarker"},1576926:{y:1995,x:1055,node_type:"midmarker"},1576927:{y:2195,x:955,node_type:"midmarker"},1576928:{y:1900,x:4660,node_type:"midmarker"},1576929:{y:1900,x:4690,node_type:"multimarker"},1576930:{y:1900,x:4630,node_type:"multimarker"},1576931:{y:1425,x:2305,node_type:"midmarker"},1576932:{y:3341,x:2843,node_type:"multimarker"},1576933:{y:3445,x:2994,node_type:"multimarker"},1576934:{y:3388,x:2911,node_type:"midmarker"},1576935:{y:4065,x:1715,node_type:"multimarker"},1576936:{y:4105,x:1715,node_type:"multimarker"},1576937:{y:4085,x:1715,node_type:"midmarker"},1576938:{y:4158,x:4415,node_type:"multimarker"},1576939:{y:4158,x:4435,node_type:"midmarker"},1576940:{y:4158,x:4455,node_type:"multimarker"},1576941:{y:3330,x:2310,node_type:"multimarker"},1576942:{y:3360,x:2250,node_type:"midmarker"},1576943:{y:3390,x:2190,node_type:"multimarker"},1576944:{y:1265,x:1327,node_type:"multimarker"},1576945:{y:1265,x:1307,node_type:"midmarker"},1576946:{y:1265,x:1287,node_type:"multimarker"},1576947:{y:4935,x:1715,node_type:"midmarker"},1576949:{y:3815,x:4247,node_type:"multimarker"},1576950:{y:3877,x:4247,node_type:"multimarker"},1576951:{y:3857,x:4247,node_type:"midmarker"},1576952:{y:1200,x:4215,node_type:"multimarker"},1576953:{y:1260,x:4215,node_type:"midmarker"},1576954:{y:1350,x:4215,node_type:"multimarker"},1576955:{y:4125,x:1055,node_type:"multimarker"},1576956:{y:4225,x:1055,node_type:"multimarker"},1576957:{y:4175,x:1055,node_type:"midmarker"},1576958:{y:3456,x:2578,node_type:"multimarker"},1576959:{y:3404,x:2577,node_type:"midmarker"},1576960:{y:3341,x:2582,node_type:"multimarker"},1576961:{y:4614,x:3257,node_type:"midmarker"},1576962:{y:4924,x:3257,node_type:"midmarker"},1576964:{y:1645,x:2175,node_type:"multimarker"},1576965:{y:1695,x:2175,node_type:"midmarker"},1576966:{y:1735,x:2175,node_type:"multimarker"},1576967:{y:4604,x:3621,node_type:"midmarker"},1576969:{y:3228,x:5032,node_type:"midmarker"},1576970:{y:3805,x:835,node_type:"multimarker"},1576971:{y:3525,x:835,node_type:"multimarker"},1576972:{y:3645,x:835,node_type:"midmarker"},1576974:{y:543.4132690429688,x:1056.6529541015625,node_type:"midmarker"},1576975:{y:4430,x:2500,node_type:"multimarker"},1576976:{y:4550,x:2500,node_type:"midmarker"},1576977:{y:4730,x:2500,node_type:"multimarker"},1576978:{y:2995,x:1055,node_type:"midmarker"},1576980:{y:4937.93359375,x:2500,node_type:"midmarker"},1576981:{y:4305,x:1715,node_type:"multimarker"},1576982:{y:4275,x:1715,node_type:"midmarker"},1576983:{y:4255,x:1715,node_type:"multimarker"},1576985:{y:4918,x:3991,node_type:"midmarker"},1576986:{y:3888,x:4116,node_type:"multimarker"},1576987:{y:3848,x:4116,node_type:"multimarker"},1576988:{y:3868,x:4116,node_type:"midmarker"},1576989:{y:4925.107421875,x:2880,node_type:"midmarker"},1576991:{y:730,x:2840,node_type:"multimarker"},1576992:{y:980,x:2840,node_type:"multimarker"},1576993:{y:840,x:2840,node_type:"midmarker"},1576994:{y:4745,x:1715,node_type:"multimarker"},1576995:{y:4585,x:1715,node_type:"midmarker"},1576996:{y:4501.49560546875,x:1715,node_type:"multimarker"},1576997:{y:1008.8675537109375,x:1056.5865478515625,node_type:"midmarker"},1576998:{y:976.1735229492188,x:1057,node_type:"multimarker"},1576999:{y:1041.710205078125,x:1056.5867919921875,node_type:"multimarker"},1577000:{y:2846,x:4667,node_type:"midmarker"},1577001:{y:2846,x:4770,node_type:"multimarker"},1577002:{y:2846,x:4560,node_type:"multimarker"},1577003:{y:1265,x:1637,node_type:"midmarker"},1577004:{y:1265,x:1657,node_type:"multimarker"},1577005:{y:1265,x:1617,node_type:"multimarker"},1577006:{y:2345,x:1055,node_type:"multimarker"},1577007:{y:2435,x:1055,node_type:"multimarker"},1577008:{y:2395,x:1055,node_type:"midmarker"},1577009:{y:470,x:2840,node_type:"midmarker"},1577011:{y:3027,x:4666,node_type:"midmarker"},1577012:{y:3027,x:4536,node_type:"multimarker"},1577013:{y:3027,x:4796,node_type:"multimarker"},1577014:{y:3632,x:4078,node_type:"multimarker"},1577015:{y:3632,x:4098,node_type:"midmarker"},1577016:{y:3632,x:4118,node_type:"multimarker"},1577017:{y:1150,x:4705,node_type:"multimarker"},1577018:{y:1150,x:4625,node_type:"multimarker"},1577019:{y:1150,x:4665,node_type:"midmarker"},1577020:{y:3837,x:2744,node_type:"multimarker"},1577021:{y:3918,x:2840,node_type:"multimarker"},1577022:{y:3886,x:2798,node_type:"midmarker"},1577023:{y:3945,x:375,node_type:"multimarker"},1577024:{y:3945,x:645,node_type:"multimarker"},1577025:{y:3945,x:505,node_type:"midmarker"},1577026:{y:3390,x:2260,node_type:"midmarker"},1577027:{y:3410,x:2220,node_type:"multimarker"},1577028:{y:3360,x:2310,node_type:"multimarker"},1577030:{y:4925,x:1460,node_type:"midmarker"},1577031:{y:3945,x:2040,node_type:"multimarker"},1577032:{y:3945,x:2010,node_type:"midmarker"},1577033:{y:3945,x:1980,node_type:"multimarker"},1577034:{y:4570,x:2210,node_type:"midmarker"},1577035:{y:4944,x:2211,node_type:"midmarker"},1577041:{y:4100,x:2371,node_type:"multimarker"},1577042:{y:4086,x:2356,node_type:"midmarker"},1577043:{y:4071,x:2342,node_type:"multimarker"},1577044:{y:4730,x:1360,node_type:"multimarker"},1577045:{y:4600,x:1360,node_type:"midmarker"},1577046:{y:4470,x:1360,node_type:"multimarker"},1577047:{y:4432,x:1460,node_type:"midmarker"},1577048:{y:2600,x:3080,node_type:"multimarker"},1577049:{y:2600,x:3110,node_type:"midmarker"},1577050:{y:2600,x:3140,node_type:"multimarker"},1577051:{y:1361.5867919921875,x:576.050048828125,node_type:"multimarker"},1577052:{y:1361.586669921875,x:640,node_type:"midmarker"},1577053:{y:1361.586669921875,x:704.5778198242188,node_type:"multimarker"},1577054:{y:1360,x:182,node_type:"midmarker"},1577056:{y:736,x:2610,node_type:"multimarker"},1577057:{y:756,x:2610,node_type:"midmarker"},1577058:{y:980,x:2610,node_type:"multimarker"},1577059:{y:470,x:2610,node_type:"midmarker"},1577061:{y:2570,x:4630,node_type:"multimarker"},1577062:{y:2570,x:4670,node_type:"midmarker"},1577063:{y:2570,x:4710,node_type:"multimarker"},1577064:{y:2817,x:3180,node_type:"multimarker"},1577065:{y:2819,x:3129,node_type:"midmarker"},1577066:{y:2826,x:3078,node_type:"multimarker"},1577067:{y:4660.98193359375,x:1055,node_type:"multimarker"},1577068:{y:4583.8583984375,x:1055,node_type:"midmarker"},1577069:{y:4506.7353515625,x:1053.4132080078125,node_type:"multimarker"},1577071:{node_is_primary:!1,name:"H+",label_x:1125,node_type:"metabolite",y:4750.98193359375,x:1095,bigg_id:"h_e",label_y:4760.98193359375},1577072:{node_is_primary:!1,name:"H+",label_x:1123.4132080078125,node_type:"metabolite",y:4416.7353515625,x:1093.4132080078125,bigg_id:"h_c",label_y:4426.7353515625},1577073:{node_is_primary:!1,name:"H2O",label_x:5539.50146484375,node_type:"metabolite",y:4574.02490234375,x:5527.4580078125,bigg_id:"h2o_c",label_y:4562.89990234375},1577074:{y:4717.48193359375,x:5334.0517578125,node_type:"multimarker"},1577075:{y:4737.48193359375,x:5334.0517578125,node_type:"midmarker"},1577076:{y:4757.48193359375,x:5334.0517578125,node_type:"multimarker"},1577077:{node_is_primary:!1,name:"ADP",label_x:5529.1103515625,node_type:"metabolite",y:4924.5068359375,x:5503.33544921875,bigg_id:"adp_c",label_y:4931.337890625},1577078:{node_is_primary:!1,name:"L-Glutamate",label_x:5555.015625,node_type:"metabolite",y:4651.92236328125,x:5534.521484375,bigg_id:"glu__L_c",label_y:4645.02197265625},1577079:{node_is_primary:!1,name:"Glyceraldehyde 3-phosphate",label_x:5534.87109375,node_type:"metabolite",y:4517.58447265625,x:5512.26513671875,bigg_id:"g3p_c",label_y:4508.57177734375},1577080:{node_is_primary:!1,name:"D-Erythrose 4-phosphate",label_x:5442.19677734375,node_type:"metabolite",y:4466.33544921875,x:5437.546875,bigg_id:"e4p_c",label_y:4450.9853515625},1577081:{node_is_primary:!1,name:"H+",label_x:5204.56640625,node_type:"metabolite",y:4994.3544921875,x:5262.95361328125,bigg_id:"h_c",label_y:5025.4677734375},1577082:{node_is_primary:!1,name:"Alpha-D-Ribose 5-phosphate",label_x:5390.7685546875,node_type:"metabolite",y:4418.7158203125,x:5403.0185546875,bigg_id:"r5p_c",label_y:4391.7470703125},1577083:{node_is_primary:!1,name:"ATP",label_x:5152.708984375,node_type:"metabolite",y:4488.05615234375,x:5183.9716796875,bigg_id:"atp_c",label_y:4461.08740234375},1577084:{node_is_primary:!1,name:"D-Fructose 6-phosphate",label_x:5052.6396484375,node_type:"metabolite",y:4498.61865234375,x:5087.0712890625,bigg_id:"f6p_c",label_y:4477.9873046875},1577085:{node_is_primary:!1,name:"Pyruvate",label_x:4962.07666015625,node_type:"metabolite",y:4509.18115234375,x:4988.05859375,bigg_id:"pyr_c",label_y:4488.5498046875},1577086:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide",label_x:4860.95166015625,node_type:"metabolite",y:4529.25048828125,x:4893.27099609375,bigg_id:"nad_c",label_y:4501.22509765625},1577087:{node_is_primary:!1,name:"Coenzyme A",label_x:5175.48828125,node_type:"metabolite",y:4931.947265625,x:5208.85205078125,bigg_id:"coa_c",label_y:4975.3330078125},1577088:{node_is_primary:!1,name:"Oxaloacetate",label_x:4770.38916015625,node_type:"metabolite",y:4544.03759765625,x:4783.69580078125,bigg_id:"oaa_c",label_y:4522.349609375},1577089:{node_is_primary:!1,name:"D-Glucose 6-phosphate",label_x:4679.8271484375,node_type:"metabolite",y:4559.88134765625,x:4700.52734375,bigg_id:"g6p_c",label_y:4537.1376953125},1577090:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide - reduced",label_x:5078.88623046875,node_type:"metabolite",y:4897.1259765625,x:5134.0517578125,bigg_id:"nadh_c",label_y:4936.322265625},1577091:{node_is_primary:!1,name:"2-Oxoglutarate",label_x:5497.31591796875,node_type:"metabolite",y:4979.51025390625,x:5481.046875,bigg_id:"akg_c",label_y:5004.2978515625},1577092:{node_is_primary:!1,name:"Acetyl-CoA",label_x:4556.52001953125,node_type:"metabolite",y:4576.78173828125,x:4601.51416015625,bigg_id:"accoa_c",label_y:4549.81298828125},1577093:{node_is_primary:!1,name:"3-Phospho-D-glycerate",label_x:4459.6201171875,node_type:"metabolite",y:4602.1318359375,x:4508.83935546875,bigg_id:"3pg_c",label_y:4576.21923828125},1577094:{node_is_primary:!1,name:"Phosphoenolpyruvate",label_x:4379.6201171875,node_type:"metabolite",y:4629.59423828125,x:4414.0517578125,bigg_id:"pep_c",label_y:4607.90673828125},1577095:{node_is_primary:!1,name:"L-Glutamine",label_x:4253.14453125,node_type:"metabolite",y:4650.7197265625,x:4332.9951171875,bigg_id:"gln__L_c",label_y:4627.97607421875},1577096:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate",label_x:4968.08447265625,node_type:"metabolite",y:4864.818359375,x:5028.71435546875,bigg_id:"nadp_c",label_y:4902.36181640625},1577097:{node_is_primary:!1,name:"Nicotinamide adenine dinucleotide phosphate - reduced",label_x:4203.775390625,node_type:"metabolite",y:4682.4072265625,x:4267.78271484375,bigg_id:"nadph_c",label_y:4664.94482421875},1577098:{node_is_primary:!1,name:"Phosphate",label_x:4884.8583984375,node_type:"metabolite",y:4831.37548828125,x:4933.43505859375,bigg_id:"pi_c",label_y:4859.1142578125},1577099:{y:4023.6457547875243,x:3055.6239109998846,node_type:"multimarker"},1577100:{y:4030.8645761345497,x:3074.275683525833,node_type:"midmarker"},1577101:{y:4038.0833974815746,x:3092.9274560517806,node_type:"multimarker"},1577102:{node_is_primary:!1,name:"H2O",label_x:3189.1795476587818,node_type:"metabolite",y:3976.144484067998,x:3188.1170476587818,bigg_id:"h2o_c",label_y:3930.712355161748},1577103:{node_is_primary:!0,name:"Cis-Aconitate",label_x:3156.1556150985407,node_type:"metabolite",y:4053.2845721909744,x:3197.4642088485407,bigg_id:"acon_C_c",label_y:4098.026271409724},1577104:{y:4035.7165277261324,x:3294.488060371458,node_type:"multimarker"},1577105:{y:4027.896160086635,x:3312.895717745038,node_type:"midmarker"},1577106:{y:4020.0757924471372,x:3331.3033751186185,node_type:"multimarker"}},canvas:{y:314.36893920898433,x:7.857062530517567,height:4860.457037353515,width:5894.515691375733},text_labels:{}}]},function(t,e){t.exports={PMEACPE:104e-8,GLYCLTtex:-34642e-8,"D-LACt2pp":6.33e-26,UAMAGS:.014389,RNTR3c2:.01399,DDPA:.19735,Htex:-55.4374,ADNtex:-9.35e-26,DHPS2:34642e-8,UPP3MT:11547e-8,BMOCOS:632e-7,ACACT4r:.18428,EX_lac__D_e:-6.33e-26,P5CR:.11447,TMPPP:11547e-8,ATPM:3.15,EX_glyclt_e:34642e-8,GLUTRR:.0018476,GLUTRS:.0018476,MN2tpp:35781e-8,G1PACT:.048928,KAS15:-2.1e-18,HBZOPT:11547e-8,G5SADs:.11447,MOADSUx:2527e-7,ACACT3r:.18428,THRt4pp:.0026952,THDPS:.19208,PANTS:29826e-8,E4PD:11547e-8,PPNCL2:29826e-8,ACOAD1f:-.18428,ACLS:.45271,NTPP9:5.98e-29,DM_4CRSOL:11547e-8,ACODA:.15317,CITtex:-3.68e-27,EX_h_e:55.4374,APRAUR:23095e-8,IG3PS:.049057,EX_nh4_e:-5.5929,PE160abcpp:.023792,PPND:.071521,ADSL2r:.23199,DNMPPA:34642e-8,UAGPT3:.014389,ASPTA:-1.516,GART:.057821,ADNt2rpp:-9.35e-26,THD2pp:6.3354,TDSK:.010075,TYRL:11547e-8,LEUTAi:.23329,MG2t3_2pp:.0044921,NNATr:.0011796,PIt2rpp:.4995,PE161abcpp:.010905,GSNK:9.17e-27,SDPDS:.19208,HMBS:23095e-8,MDH:.36955,PPBNGS:92379e-8,PPPGO3:11547e-8,FCLT:11547e-8,ASPK:.55359,PTAr:15.8552,H2Otpp:2.2223,EX_succ_e:.17164,EX_meoh_e:104e-8,PPKr:-1.8145,MOHMT:29826e-8,SADT2:.12835,DHDPS:.19208,UDCPDP:.014389,ACtex:-16.1569,HACD5:.18428,DHAD1:.45271,DHAD2:.15044,HACD4:.18428,PDX5PS:11547e-8,MNtex:35781e-8,HSTPT:.049057,MEPCT:.0012371,CO2tex:.18918,ACOAD5f:-.18428,PRPPS:.48307,DPR:29826e-8,DHFR:.013896,DHFS:34642e-8,NH4tpp:5.5929,VALTA:-.21912,MPTSS:2527e-7,OGMEACPD:104e-8,PPNDH:.095934,PGM:-37.8918,THRt2rpp:-.0026952,ADK1:1.3595,GLUPRT:.23211,OGMEACPS:104e-8,SUCOAS:.27178,CHORS:.19735,ETOHtrpp:-15.8782,FE2tpp:.0042736,EPMEACPR:104e-8,DHNPA2r:34642e-8,KDOPP:.020149,KDOPS:.020149,OCBT:.15317,FADRx:1.1319,ORPT:-.17129,EX_ac_e:16.1569,USHD:.010075,GMPS2:.1262,UAAGDS:.014389,PRAMPC:.049057,I2FE2SS2:13463e-8,RHCCE:23198e-8,CYSS:.12835,DUTPDP:.013549,ADEt2rpp:-1.41e-27,IPMD:.23329,PRATPP:.049057,BMOGDS1:632e-7,PAPSR:.12835,"5DOAN":34746e-8,BMOGDS2:632e-7,INSt2rpp:9.27e-26,DHDPRy:.19208,PRAIS:.23211,MECDPS:.0012371,MPTAT:12635e-8,SO4tex:.1306,IMPC:-.28105,PGCD:.86143,EX_k_e:-.10107,EX_cu2_e:-36713e-8,IMPD:.1262,ACOAD2f:-.18428,PHETA1:-.095934,MALCOAMT:104e-8,PSD161:.038947,OGMEACPR:104e-8,Eciomass_iJO1366_core_53p95M:-.51782,H2Otex:2.2223,ACONTa:.55675,ACONTb:.55675,DURIPP:2.08e-28,DALAt2pp:.0071946,PRFGS:.23211,DAPDC:.1777,GLCptspp:20,PSCVT:.19735,"3OAS140":.040299,PSSA161:.038947,PSSA160:.033044,ASPCT:.17129,ADNK1:57944e-8,CLtex:.0026952,AGPAT160:.033044,AGPAT161:.038947,DXPS:.001468,CAt6pp:-.0026952,FUM:.36837,PRMICI:.049057,OPHHX3:11547e-8,EX_ca2_e:-.0026952,DAPE:.19208,DBTS:104e-8,KARA1:-.45271,KARA2:.15044,ZN2tpp:17658e-8,ILETA:-.15044,FMNAT:11547e-8,ENO:37.8918,IPPMIb:-.23329,IPPMIa:-.23329,HACD1:.18428,AOXSr2:104e-8,HACD3:.18428,HACD2:.18428,CITt3pp:3.68e-27,G1SAT:.0018476,HACD7:.14398,HACD6:.14398,SHCHF:11547e-8,ACACT5r:.18428,MCTP1App:.0071946,EX_zn2_e:-17658e-8,DHPPDA2:23095e-8,UPP3S:23095e-8,ACOAD6f:-.14398,ADSS:.15485,SHSL1:.079698,MTHFR2:.07993,PSP_L:.86143,G5SD:.11447,IGPS:.029434,ADSK:.12835,DNTPPA:34642e-8,ALATA_L:-.30104,EX_etoh_e:15.8782,UAGAAT:.020149,AIRC2:.23199,AIRC3:-.23199,MPTS:12635e-8,DB4PS:46189e-8,HISTP:.049057,TRPAS2:-.029434,MPTG:.0071946,TMDS:.013549,IGPDH:.049057,PDH:-3.88e-11,HISTD:.049057,ASP1DC:29826e-8,OHPBAT:11547e-8,I2FE2SR:104e-8,I2FE2SS:1481e-7,NI2tpp:16726e-8,I2FE2ST:145e-7,PGAMT:-.048928,I4FE4ST:13463e-8,I4FE4SR:13463e-8,OPMEACPD:104e-8,DXPRIi:.0012371,OPMEACPS:104e-8,OPMEACPR:104e-8,DM_MTHTHF:23198e-8,DHORDfum:.17129,CLt3_2pp:.0013476,PRASCSi:.23199,NDPK8:9.24e-27,RPE:-.402,NDPK2:.22022,NDPK3:.093676,NDPK1:.4094,TRDR:.12835,NDPK7:8.42e-30,NDPK4:.013549,NDPK5:-9.17e-27,MCOATA:.040301,HPPK2:34642e-8,G3PD2:-.071991,CO2tpp:.18918,DTMPK:.013549,PGI:20,FACOAE120:.040299,AACPS4:.077894,AACPS7:.040299,MGSA:-7.3e-26,GLCtex:20,BTS5:104e-8,AACPS3:.066088,NI2tex:16726e-8,"3HAD40":-2.1e-18,FORtppi:34.175,G3PAT160:.033044,G3PAT161:.038947,MECDPDH5:.0012371,ACCOAC:.040302,GHMT2r:.54934,MOAT2:.010075,RNTR1c2:.013549,UPPDC1:11547e-8,AMPMS2:11547e-8,UDCPDPS:285e-7,DHQTi:.19735,PERD:11547e-8,HSK:.28181,IPDPS:.0010931,EX_co2_e:-.18918,ACOTA:-.15317,RBFSb:23095e-8,SULRi:.12835,RBFSa:46189e-8,ALCD2x:-15.8782,UAPGR:.014389,THRS:.28181,GAPD:38.7532,QULNS:.0011796,OCTDPS:11547e-8,ASNS2:.12482,ATPPRT:.049057,CU2tex:36713e-8,Kt2pp:.10107,EGMEACPR:104e-8,THRD_L:.15044,DHQS:.19735,ACGS:.15317,DM_AMOB:104e-8,PRAIi:.029434,MEOHtex:-104e-8,ACGK:.15317,CBMKr:.32446,GK1:.1262,ACACT6r:.14398,FE2tex:.0042736,FACOAE161:.077894,FACOAE160:.066088,CU2tpp:36713e-8,GRTT:14395e-8,UMPK:.19576,EX_pi_e:-.4995,GCALDD:34642e-8,ECOAH6:.14398,ECOAH7:.14398,ECOAH4:.18428,ECOAH5:.18428,ECOAH2:.18428,ECOAH3:.18428,ECOAH1:.18428,ANPRT:.029434,ANS:.029434,ACOAD3f:-.18428,POR5:.056315,NADK:23147e-8,FORtex:-34.175,PNTK:29826e-8,EX_cobalt2_e:-129e-7,UAGCVT:.014389,"D-LACtex":6.33e-26,ACHBS:.15044,DHPTDCs2:23198e-8,A5PISO:.020149,ARGSL:.15317,CTPS2:.083123,EX_mg2_e:-.0044921,TALA:-.10226,GARFT:.17429,UAMAS:.014389,ARGSS:.15317,PPCDC:29826e-8,HSST:.079698,"3OAR140":.040299,EXe3_e:-.0040431,MOX:-.0011796,AMAOTr:104e-8,CS:.55675,UGMDDS:.014389,PUNP4:9.17e-27,PUNP5:4.04e-26,PUNP6:-6.27e-27,ACOAD7f:-.066088,PUNP1:-57944e-8,PUNP3:-9.17e-27,SO4t2pp:.1306,PMPK:11547e-8,CPPPGO2:11547e-8,ASPO6:.0011796,ADEtex:-1.41e-27,TMPK:11547e-8,INSH:-1.05e-30,INSK:5.23e-26,DMPPS:14395e-8,CPMPS:12635e-8,ACKr:-15.8552,DHORTS:-.17129,ACACT2r:.18428,PPC:1.7044,netFlux:796.663,EX_mobd_e:-668e-7,PPM:-57944e-8,PRAGSr:.23211,IPPS:.23329,EXor_e:34.175,TPI:19.4759,DADK:8.72e-27,SDPTA:-.19208,SUCCtex:-.17164,ALAALAr:.014389,BPNT:.12835,Zn2tex:17658e-8,CA2tex:.0026952,DASYN160:.033044,PSERT:.86143,GLNS:.93757,"3OAR40":-2.1e-18,AICART:.28105,URIH:1.05e-30,THZPSN3:11547e-8,LPADSS:.010075,EX_so4_e:-.1306,NNDPR:.0011796,RBFK:11547e-8,PTPATi:29826e-8,RPI:-.38138,ETOHtex:-15.8782,MG2tex:.0044921,AHCYSNS:23198e-8,DASYN161:.038947,EX_h2o_e:-2.2223,NADS1:.0011796,TKT2:-.29973,TKT1:-.10226,EX_ni2_e:-16726e-8,PPM2:5.06e-28,MTHTHFSs:23198e-8,METS:.07993,KDOCT2:.020149,SERAT:.12835,K2L4Aabcpp:.010075,GLUR:-.014389,NH4tex:5.5929,RNTR2c2:.01399,CHRPL:11547e-8,EX_glc_e:-20,PMDPHT:23095e-8,ACALD:-15.8782,ACOAD4f:-.18428,ACt2rpp:-16.1569,GLYCLTt2rpp:-34642e-8,GLU5K:.11447,SHKK:.19735,GTPCI:34642e-8,PDX5PO2:11547e-8,ATPS4rpp:-13.212,U23GAAT:.020149,RNTR4c2:.013549,PAPPT3:.014389,CHORM:.16745,ACACT1r:.18428,Ktex:.10107,DHAPT:15.7582,ICYSDS:93466e-8,FE3abcpp:.0040431,HCO3E:.27229,DM_5DRIB:34746e-8,OMCDC:.23329,AGPR:-.15317,SHK3Dr:.19735,CYTK1:.093676,PSD160:.033044,FE3tex:.0040431,TYRTA:-.071521,EXe2_e:-.0042736,ALAR:.021584,UHGADA:.020149,PItex:.4995,GLUDy:-4.4,DMATT:14395e-8,MOCOS:632e-7,F6PA:15.7582,MEOHtrpp:-104e-8,ICDHyr:.55675,MOBDtex:668e-7,ACACT7r:.14398,XPPT:-6.24e-29,MTHFC:.45545,MTHFD:.45545,TRPS3:.029434,COBALT2tpp:129e-7,OPHBDC:11547e-8,FBA:3.7909,K2L4Aabctex:.010075,OMPDC:.17129,MOAT:.010075,PFK:3.7909,CYSTL:.079698,GTPCII2:23095e-8,UAGDP:.048928,ASAD:-.55359,SHCHD2:11547e-8,SUCCt3pp:.17164,EX_cl_e:-.0026952,NTD8:9.17e-27,MOBDabcpp:668e-7,NTD6:-8.72e-27,ADCL:34642e-8,DGK1:-9.17e-27,NTD1:7.23e-29,DPCOAK:29826e-8,HSDy:-.3615,EX_mn2_e:-35781e-8,METAT:69595e-8,ADCS:34642e-8,PGK:-38.7532,INStex:9.27e-26,COBALT2tex:129e-7,PFL:34.2315,GF6PTA:.048928,CTECOAI7:-.077894,ADSL1r:.15485,CDPMEK:.0012371}},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=e.NavButtons=void 0;var o=n(231),a=r(o),s=n(232),l=n(310),u=i(l),c=e.NavButtons=(0,s.createView)({init:function(t,e,n){return{addressedActionIn:t,addressedActionOut:e,currentIndex:n,lastCurrentIndex:null}},getReducer:u.getReducer,create:function(t,e,n,i,r){var o=a["default"].select(n);o.append("button").attr("id","button-in").attr("class","my-button").text("⬆︎").on("click",r(t.addressedActionIn)||null),o.append("button").attr("id","button-out").attr("class","my-button").text("⬇︎").on("click",r(t.addressedActionOut)||null)},update:function(t,e,n){var i=a["default"].select(n);i.select("#button-in").classed("my-button-disabled",t.currentIndex===e.pages.length-1),i.select("#button-out").classed("my-button-disabled",0===t.currentIndex)}});e["default"]=c},function(t,e,n){var i=n(319);"string"==typeof i&&(i=[[t.id,i,""]]);n(314)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(313)(),e.push([t.id,"#app{perspective:200px}.fill,.page{height:100%;width:100%;position:absolute;top:0;left:0}.page{will-change:transform,opacity}.genome-center,.webgl-message{height:60%;width:90%;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.webgl-message{text-align:center}img.title-img{width:90%}img.title-questions-img{width:60%}img.start-img{top:20px;left:175px;width:150px}img.cell-img{width:50%}img.protein-screen{position:relative;top:0;left:0;transform:none;width:100%}img{top:50%;left:50%;transform:translate(-50%,-50%)}#nav-buttons,img{position:absolute}#nav-buttons{transform:rotateX(10deg) translateZ(10px);left:80px;top:50px;z-index:10}span.hidden{display:block!important}.my-button{display:inline-block;zoom:1;line-height:normal;white-space:nowrap;vertical-align:middle;text-align:center;cursor:pointer;font-family:inherit;font-size:32px;padding:.5em 1em;color:rgba(0,0,0,.8);border:none transparent;background-color:#e6e6e6;text-decoration:none;border-radius:2px}.my-button:hover{background-image:linear-gradient(transparent,rgba(0,0,0,.05) 40%,rgba(0,0,0,.1))}.my-button-disabled{border:none;background-image:none;filter:alpha(opacity=40);opacity:.4;cursor:not-allowed;box-shadow:none}.overlay{position:absolute;background-color:rgba(245,226,229,.91);font-size:2em;padding:30px;font-weight:200;width:60%;text-align:justify;border-radius:4px}@media (max-width:850px){.overlay{font-size:1.6em}}.bottom{bottom:5%}.top{top:5%}.left{left:5%}.right{right:5%}.center{left:50%;transform:translate(-50%)}",""])}]);
//# sourceMappingURL=bundle.min.js.map